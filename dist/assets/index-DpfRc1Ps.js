var zO=Object.defineProperty;var KS=t=>{throw TypeError(t)};var qO=(t,e,n)=>e in t?zO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var lr=(t,e,n)=>qO(t,typeof e!="symbol"?e+"":e,n),G1=(t,e,n)=>e.has(t)||KS("Cannot "+n);var pt=(t,e,n)=>(G1(t,e,"read from private field"),n?n.call(t):e.get(t)),sn=(t,e,n)=>e.has(t)?KS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),As=(t,e,n,r)=>(G1(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),En=(t,e,n)=>(G1(t,e,"access private method"),n);var Rp=(t,e,n,r)=>({set _(i){As(t,e,i,n)},get _(){return pt(t,e,r)}});function XO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const l=Object.getOwnPropertyDescriptor(r,i);l&&Object.defineProperty(t,i,l.get?l:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();var NQ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Y1={exports:{}},ym={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QS;function JO(){if(QS)return ym;QS=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,l){var c=null;if(l!==void 0&&(c=""+l),i.key!==void 0&&(c=""+i.key),"key"in i){l={};for(var d in i)d!=="key"&&(l[d]=i[d])}else l=i;return i=l.ref,{$$typeof:t,type:r,key:c,ref:i!==void 0?i:null,props:l}}return ym.Fragment=e,ym.jsx=n,ym.jsxs=n,ym}var GS;function ZO(){return GS||(GS=1,Y1.exports=JO()),Y1.exports}var s=ZO(),V1={exports:{}},yn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS;function eM(){if(YS)return yn;YS=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),y=Symbol.iterator;function g(T){return T===null||typeof T!="object"?null:(T=y&&T[y]||T["@@iterator"],typeof T=="function"?T:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,v={};function R(T,j,k){this.props=T,this.context=j,this.refs=v,this.updater=k||N}R.prototype.isReactComponent={},R.prototype.setState=function(T,j){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,j,"setState")},R.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function U(){}U.prototype=R.prototype;function L(T,j,k){this.props=T,this.context=j,this.refs=v,this.updater=k||N}var w=L.prototype=new U;w.constructor=L,C(w,R.prototype),w.isPureReactComponent=!0;var P=Array.isArray;function G(){}var K={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function O(T,j,k){var Q=k.ref;return{$$typeof:t,type:T,key:j,ref:Q!==void 0?Q:null,props:k}}function S(T,j){return O(T.type,j,T.props)}function A(T){return typeof T=="object"&&T!==null&&T.$$typeof===t}function Y(T){var j={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(k){return j[k]})}var te=/\/+/g;function J(T,j){return typeof T=="object"&&T!==null&&T.key!=null?Y(""+T.key):j.toString(36)}function q(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(G,G):(T.status="pending",T.then(function(j){T.status==="pending"&&(T.status="fulfilled",T.value=j)},function(j){T.status==="pending"&&(T.status="rejected",T.reason=j)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function V(T,j,k,Q,H){var $=typeof T;($==="undefined"||$==="boolean")&&(T=null);var ie=!1;if(T===null)ie=!0;else switch($){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(T.$$typeof){case t:case e:ie=!0;break;case m:return ie=T._init,V(ie(T._payload),j,k,Q,H)}}if(ie)return H=H(T),ie=Q===""?"."+J(T,0):Q,P(H)?(k="",ie!=null&&(k=ie.replace(te,"$&/")+"/"),V(H,j,k,"",function(de){return de})):H!=null&&(A(H)&&(H=S(H,k+(H.key==null||T&&T.key===H.key?"":(""+H.key).replace(te,"$&/")+"/")+ie)),j.push(H)),1;ie=0;var fe=Q===""?".":Q+":";if(P(T))for(var pe=0;pe<T.length;pe++)Q=T[pe],$=fe+J(Q,pe),ie+=V(Q,j,k,$,H);else if(pe=g(T),typeof pe=="function")for(T=pe.call(T),pe=0;!(Q=T.next()).done;)Q=Q.value,$=fe+J(Q,pe++),ie+=V(Q,j,k,$,H);else if($==="object"){if(typeof T.then=="function")return V(q(T),j,k,Q,H);throw j=String(T),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return ie}function F(T,j,k){if(T==null)return T;var Q=[],H=0;return V(T,Q,"","",function($){return j.call(k,$,H++)}),Q}function I(T){if(T._status===-1){var j=T._result;j=j(),j.then(function(k){(T._status===0||T._status===-1)&&(T._status=1,T._result=k)},function(k){(T._status===0||T._status===-1)&&(T._status=2,T._result=k)}),T._status===-1&&(T._status=0,T._result=j)}if(T._status===1)return T._result.default;throw T._result}var ee=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},ae={map:F,forEach:function(T,j,k){F(T,function(){j.apply(this,arguments)},k)},count:function(T){var j=0;return F(T,function(){j++}),j},toArray:function(T){return F(T,function(j){return j})||[]},only:function(T){if(!A(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return yn.Activity=_,yn.Children=ae,yn.Component=R,yn.Fragment=n,yn.Profiler=i,yn.PureComponent=L,yn.StrictMode=r,yn.Suspense=u,yn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=K,yn.__COMPILER_RUNTIME={__proto__:null,c:function(T){return K.H.useMemoCache(T)}},yn.cache=function(T){return function(){return T.apply(null,arguments)}},yn.cacheSignal=function(){return null},yn.cloneElement=function(T,j,k){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var Q=C({},T.props),H=T.key;if(j!=null)for($ in j.key!==void 0&&(H=""+j.key),j)!B.call(j,$)||$==="key"||$==="__self"||$==="__source"||$==="ref"&&j.ref===void 0||(Q[$]=j[$]);var $=arguments.length-2;if($===1)Q.children=k;else if(1<$){for(var ie=Array($),fe=0;fe<$;fe++)ie[fe]=arguments[fe+2];Q.children=ie}return O(T.type,H,Q)},yn.createContext=function(T){return T={$$typeof:c,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},yn.createElement=function(T,j,k){var Q,H={},$=null;if(j!=null)for(Q in j.key!==void 0&&($=""+j.key),j)B.call(j,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(H[Q]=j[Q]);var ie=arguments.length-2;if(ie===1)H.children=k;else if(1<ie){for(var fe=Array(ie),pe=0;pe<ie;pe++)fe[pe]=arguments[pe+2];H.children=fe}if(T&&T.defaultProps)for(Q in ie=T.defaultProps,ie)H[Q]===void 0&&(H[Q]=ie[Q]);return O(T,$,H)},yn.createRef=function(){return{current:null}},yn.forwardRef=function(T){return{$$typeof:d,render:T}},yn.isValidElement=A,yn.lazy=function(T){return{$$typeof:m,_payload:{_status:-1,_result:T},_init:I}},yn.memo=function(T,j){return{$$typeof:f,type:T,compare:j===void 0?null:j}},yn.startTransition=function(T){var j=K.T,k={};K.T=k;try{var Q=T(),H=K.S;H!==null&&H(k,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(G,ee)}catch($){ee($)}finally{j!==null&&k.types!==null&&(j.types=k.types),K.T=j}},yn.unstable_useCacheRefresh=function(){return K.H.useCacheRefresh()},yn.use=function(T){return K.H.use(T)},yn.useActionState=function(T,j,k){return K.H.useActionState(T,j,k)},yn.useCallback=function(T,j){return K.H.useCallback(T,j)},yn.useContext=function(T){return K.H.useContext(T)},yn.useDebugValue=function(){},yn.useDeferredValue=function(T,j){return K.H.useDeferredValue(T,j)},yn.useEffect=function(T,j){return K.H.useEffect(T,j)},yn.useEffectEvent=function(T){return K.H.useEffectEvent(T)},yn.useId=function(){return K.H.useId()},yn.useImperativeHandle=function(T,j,k){return K.H.useImperativeHandle(T,j,k)},yn.useInsertionEffect=function(T,j){return K.H.useInsertionEffect(T,j)},yn.useLayoutEffect=function(T,j){return K.H.useLayoutEffect(T,j)},yn.useMemo=function(T,j){return K.H.useMemo(T,j)},yn.useOptimistic=function(T,j){return K.H.useOptimistic(T,j)},yn.useReducer=function(T,j,k){return K.H.useReducer(T,j,k)},yn.useRef=function(T){return K.H.useRef(T)},yn.useState=function(T){return K.H.useState(T)},yn.useSyncExternalStore=function(T,j,k){return K.H.useSyncExternalStore(T,j,k)},yn.useTransition=function(){return K.H.useTransition()},yn.version="19.2.3",yn}var VS;function ob(){return VS||(VS=1,V1.exports=eM()),V1.exports}var x=ob();const Gi=lb(x),WT=XO({__proto__:null,default:Gi},[x]);var $1={exports:{}},bm={},H1={exports:{}},z1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $S;function tM(){return $S||($S=1,(function(t){function e(V,F){var I=V.length;V.push(F);e:for(;0<I;){var ee=I-1>>>1,ae=V[ee];if(0<i(ae,F))V[ee]=F,V[I]=ae,I=ee;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var F=V[0],I=V.pop();if(I!==F){V[0]=I;e:for(var ee=0,ae=V.length,T=ae>>>1;ee<T;){var j=2*(ee+1)-1,k=V[j],Q=j+1,H=V[Q];if(0>i(k,I))Q<ae&&0>i(H,k)?(V[ee]=H,V[Q]=I,ee=Q):(V[ee]=k,V[j]=I,ee=j);else if(Q<ae&&0>i(H,I))V[ee]=H,V[Q]=I,ee=Q;else break e}}return F}function i(V,F){var I=V.sortIndex-F.sortIndex;return I!==0?I:V.id-F.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var u=[],f=[],m=1,_=null,y=3,g=!1,N=!1,C=!1,v=!1,R=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function w(V){for(var F=n(f);F!==null;){if(F.callback===null)r(f);else if(F.startTime<=V)r(f),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(f)}}function P(V){if(C=!1,w(V),!N)if(n(u)!==null)N=!0,G||(G=!0,Y());else{var F=n(f);F!==null&&q(P,F.startTime-V)}}var G=!1,K=-1,B=5,O=-1;function S(){return v?!0:!(t.unstable_now()-O<B)}function A(){if(v=!1,G){var V=t.unstable_now();O=V;var F=!0;try{e:{N=!1,C&&(C=!1,U(K),K=-1),g=!0;var I=y;try{t:{for(w(V),_=n(u);_!==null&&!(_.expirationTime>V&&S());){var ee=_.callback;if(typeof ee=="function"){_.callback=null,y=_.priorityLevel;var ae=ee(_.expirationTime<=V);if(V=t.unstable_now(),typeof ae=="function"){_.callback=ae,w(V),F=!0;break t}_===n(u)&&r(u),w(V)}else r(u);_=n(u)}if(_!==null)F=!0;else{var T=n(f);T!==null&&q(P,T.startTime-V),F=!1}}break e}finally{_=null,y=I,g=!1}F=void 0}}finally{F?Y():G=!1}}}var Y;if(typeof L=="function")Y=function(){L(A)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,J=te.port2;te.port1.onmessage=A,Y=function(){J.postMessage(null)}}else Y=function(){R(A,0)};function q(V,F){K=R(function(){V(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(V){switch(y){case 1:case 2:case 3:var F=3;break;default:F=y}var I=y;y=F;try{return V()}finally{y=I}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(V,F){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var I=y;y=V;try{return F()}finally{y=I}},t.unstable_scheduleCallback=function(V,F,I){var ee=t.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?ee+I:ee):I=ee,V){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=I+ae,V={id:m++,callback:F,priorityLevel:V,startTime:I,expirationTime:ae,sortIndex:-1},I>ee?(V.sortIndex=I,e(f,V),n(u)===null&&V===n(f)&&(C?(U(K),K=-1):C=!0,q(P,I-ee))):(V.sortIndex=ae,e(u,V),N||g||(N=!0,G||(G=!0,Y()))),V},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(V){var F=y;return function(){var I=y;y=F;try{return V.apply(this,arguments)}finally{y=I}}}})(z1)),z1}var HS;function sM(){return HS||(HS=1,H1.exports=tM()),H1.exports}var q1={exports:{}},ya={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zS;function nM(){if(zS)return ya;zS=1;var t=ob();function e(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(u,f,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:u,containerInfo:f,implementation:m}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ya.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,ya.createPortal=function(u,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return l(u,f,null,m)},ya.flushSync=function(u){var f=c.T,m=r.p;try{if(c.T=null,r.p=2,u)return u()}finally{c.T=f,r.p=m,r.d.f()}},ya.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(u,f))},ya.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},ya.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var m=f.as,_=d(m,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?r.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:_,integrity:y,fetchPriority:g}):m==="script"&&r.d.X(u,{crossOrigin:_,integrity:y,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ya.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=d(f.as,f.crossOrigin);r.d.M(u,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(u)},ya.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,_=d(m,f.crossOrigin);r.d.L(u,m,{crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ya.preloadModule=function(u,f){if(typeof u=="string")if(f){var m=d(f.as,f.crossOrigin);r.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(u)},ya.requestFormReset=function(u){r.d.r(u)},ya.unstable_batchedUpdates=function(u,f){return u(f)},ya.useFormState=function(u,f,m){return c.H.useFormState(u,f,m)},ya.useFormStatus=function(){return c.H.useHostTransitionStatus()},ya.version="19.2.3",ya}var qS;function FT(){if(qS)return q1.exports;qS=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),q1.exports=nM(),q1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XS;function rM(){if(XS)return bm;XS=1;var t=sM(),e=ob(),n=FT();function r(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var o=a,h=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(h=o.return),a=o.return;while(a)}return o.tag===3?h:null}function c(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function d(a){if(a.tag===31){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function u(a){if(l(a)!==a)throw Error(r(188))}function f(a){var o=a.alternate;if(!o){if(o=l(a),o===null)throw Error(r(188));return o!==a?null:a}for(var h=a,p=o;;){var D=h.return;if(D===null)break;var M=D.alternate;if(M===null){if(p=D.return,p!==null){h=p;continue}break}if(D.child===M.child){for(M=D.child;M;){if(M===h)return u(D),a;if(M===p)return u(D),o;M=M.sibling}throw Error(r(188))}if(h.return!==p.return)h=D,p=M;else{for(var oe=!1,Ae=D.child;Ae;){if(Ae===h){oe=!0,h=D,p=M;break}if(Ae===p){oe=!0,p=D,h=M;break}Ae=Ae.sibling}if(!oe){for(Ae=M.child;Ae;){if(Ae===h){oe=!0,h=M,p=D;break}if(Ae===p){oe=!0,p=M,h=D;break}Ae=Ae.sibling}if(!oe)throw Error(r(189))}}if(h.alternate!==p)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var _=Object.assign,y=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),L=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),S=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function Y(a){return a===null||typeof a!="object"?null:(a=A&&a[A]||a["@@iterator"],typeof a=="function"?a:null)}var te=Symbol.for("react.client.reference");function J(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===te?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case C:return"Fragment";case R:return"Profiler";case v:return"StrictMode";case P:return"Suspense";case G:return"SuspenseList";case O:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case N:return"Portal";case L:return a.displayName||"Context";case U:return(a._context.displayName||"Context")+".Consumer";case w:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case K:return o=a.displayName||null,o!==null?o:J(a.type)||"Memo";case B:o=a._payload,a=a._init;try{return J(a(o))}catch{}}return null}var q=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},ee=[],ae=-1;function T(a){return{current:a}}function j(a){0>ae||(a.current=ee[ae],ee[ae]=null,ae--)}function k(a,o){ae++,ee[ae]=a.current,a.current=o}var Q=T(null),H=T(null),$=T(null),ie=T(null);function fe(a,o){switch(k($,o),k(H,a),k(Q,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?uS(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=uS(o),a=hS(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}j(Q),k(Q,a)}function pe(){j(Q),j(H),j($)}function de(a){a.memoizedState!==null&&k(ie,a);var o=Q.current,h=hS(o,a.type);o!==h&&(k(H,a),k(Q,h))}function Re(a){H.current===a&&(j(Q),j(H)),ie.current===a&&(j(ie),pm._currentValue=I)}var X,_e;function me(a){if(X===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);X=o&&o[1]||"",_e=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+X+a+_e}var Z=!1;function le(a,o){if(!a||Z)return"";Z=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var us=function(){throw Error()};if(Object.defineProperty(us.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(us,[])}catch(zt){var Vt=zt}Reflect.construct(a,[],us)}else{try{us.call()}catch(zt){Vt=zt}a.call(us.prototype)}}else{try{throw Error()}catch(zt){Vt=zt}(us=a())&&typeof us.catch=="function"&&us.catch(function(){})}}catch(zt){if(zt&&Vt&&typeof zt.stack=="string")return[zt.stack,Vt.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=p.DetermineComponentFrameRoot(),oe=M[0],Ae=M[1];if(oe&&Ae){var gt=oe.split(`
`),Gt=Ae.split(`
`);for(D=p=0;p<gt.length&&!gt[p].includes("DetermineComponentFrameRoot");)p++;for(;D<Gt.length&&!Gt[D].includes("DetermineComponentFrameRoot");)D++;if(p===gt.length||D===Gt.length)for(p=gt.length-1,D=Gt.length-1;1<=p&&0<=D&&gt[p]!==Gt[D];)D--;for(;1<=p&&0<=D;p--,D--)if(gt[p]!==Gt[D]){if(p!==1||D!==1)do if(p--,D--,0>D||gt[p]!==Gt[D]){var ns=`
`+gt[p].replace(" at new "," at ");return a.displayName&&ns.includes("<anonymous>")&&(ns=ns.replace("<anonymous>",a.displayName)),ns}while(1<=p&&0<=D);break}}}finally{Z=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?me(h):""}function se(a,o){switch(a.tag){case 26:case 27:case 5:return me(a.type);case 16:return me("Lazy");case 13:return a.child!==o&&o!==null?me("Suspense Fallback"):me("Suspense");case 19:return me("SuspenseList");case 0:case 15:return le(a.type,!1);case 11:return le(a.type.render,!1);case 1:return le(a.type,!0);case 31:return me("Activity");default:return""}}function Ee(a){try{var o="",h=null;do o+=se(a,h),h=a,a=a.return;while(a);return o}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Ne=Object.prototype.hasOwnProperty,ye=t.unstable_scheduleCallback,ne=t.unstable_cancelCallback,ue=t.unstable_shouldYield,xe=t.unstable_requestPaint,et=t.unstable_now,bt=t.unstable_getCurrentPriorityLevel,it=t.unstable_ImmediatePriority,At=t.unstable_UserBlockingPriority,at=t.unstable_NormalPriority,We=t.unstable_LowPriority,Dt=t.unstable_IdlePriority,Tt=t.log,St=t.unstable_setDisableYieldValue,ze=null,dt=null;function Ke(a){if(typeof Tt=="function"&&St(a),dt&&typeof dt.setStrictMode=="function")try{dt.setStrictMode(ze,a)}catch{}}var rt=Math.clz32?Math.clz32:mt,ft=Math.log,Ot=Math.LN2;function mt(a){return a>>>=0,a===0?32:31-(ft(a)/Ot|0)|0}var Ze=256,De=262144,Ye=4194304;function Ce(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function ge(a,o,h){var p=a.pendingLanes;if(p===0)return 0;var D=0,M=a.suspendedLanes,oe=a.pingedLanes;a=a.warmLanes;var Ae=p&134217727;return Ae!==0?(p=Ae&~M,p!==0?D=Ce(p):(oe&=Ae,oe!==0?D=Ce(oe):h||(h=Ae&~a,h!==0&&(D=Ce(h))))):(Ae=p&~M,Ae!==0?D=Ce(Ae):oe!==0?D=Ce(oe):h||(h=p&~a,h!==0&&(D=Ce(h)))),D===0?0:o!==0&&o!==D&&(o&M)===0&&(M=D&-D,h=o&-o,M>=h||M===32&&(h&4194048)!==0)?o:D}function Be(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function ce(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Le(){var a=Ye;return Ye<<=1,(Ye&62914560)===0&&(Ye=4194304),a}function Xe(a){for(var o=[],h=0;31>h;h++)o.push(a);return o}function Pe(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Ct(a,o,h,p,D,M){var oe=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var Ae=a.entanglements,gt=a.expirationTimes,Gt=a.hiddenUpdates;for(h=oe&~h;0<h;){var ns=31-rt(h),us=1<<ns;Ae[ns]=0,gt[ns]=-1;var Vt=Gt[ns];if(Vt!==null)for(Gt[ns]=null,ns=0;ns<Vt.length;ns++){var zt=Vt[ns];zt!==null&&(zt.lane&=-536870913)}h&=~us}p!==0&&Me(a,p,0),M!==0&&D===0&&a.tag!==0&&(a.suspendedLanes|=M&~(oe&~o))}function Me(a,o,h){a.pendingLanes|=o,a.suspendedLanes&=~o;var p=31-rt(o);a.entangledLanes|=o,a.entanglements[p]=a.entanglements[p]|1073741824|h&261930}function lt(a,o){var h=a.entangledLanes|=o;for(a=a.entanglements;h;){var p=31-rt(h),D=1<<p;D&o|a[p]&o&&(a[p]|=o),h&=~D}}function ut(a,o){var h=o&-o;return h=(h&42)!==0?1:jt(h),(h&(a.suspendedLanes|o))!==0?0:h}function jt(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ve(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function $t(){var a=F.p;return a!==0?a:(a=window.event,a===void 0?32:PS(a.type))}function Ue(a,o){var h=F.p;try{return F.p=a,o()}finally{F.p=h}}var ss=Math.random().toString(36).slice(2),ls="__reactFiber$"+ss,ds="__reactProps$"+ss,Ss="__reactContainer$"+ss,Ns="__reactEvents$"+ss,ke="__reactListeners$"+ss,ct="__reactHandles$"+ss,st="__reactResources$"+ss,Kt="__reactMarker$"+ss;function ht(a){delete a[ls],delete a[ds],delete a[Ns],delete a[ke],delete a[ct]}function qt(a){var o=a[ls];if(o)return o;for(var h=a.parentNode;h;){if(o=h[Ss]||h[ls]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(a=CS(a);a!==null;){if(h=a[ls])return h;a=CS(a)}return o}a=h,h=a.parentNode}return null}function It(a){if(a=a[ls]||a[Ss]){var o=a.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return a}return null}function he(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(r(33))}function be(a){var o=a[st];return o||(o=a[st]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Oe(a){a[Kt]=!0}var je=new Set,tt={};function Te(a,o){_t(a,o),_t(a+"Capture",o)}function _t(a,o){for(tt[a]=o,a=0;a<o.length;a++)je.add(o[a])}var Qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yt={},vt={};function $e(a){return Ne.call(vt,a)?!0:Ne.call(yt,a)?!1:Qe.test(a)?vt[a]=!0:(yt[a]=!0,!1)}function ot(a,o,h){if($e(o))if(h===null)a.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+h)}}function wt(a,o,h){if(h===null)a.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+h)}}function Bt(a,o,h,p){if(p===null)a.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(o,h,""+p)}}function Yt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Xt(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ts(a,o,h){var p=Object.getOwnPropertyDescriptor(a.constructor.prototype,o);if(!a.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var D=p.get,M=p.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return D.call(this)},set:function(oe){h=""+oe,M.call(this,oe)}}),Object.defineProperty(a,o,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(oe){h=""+oe},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Ut(a){if(!a._valueTracker){var o=Xt(a)?"checked":"value";a._valueTracker=ts(a,o,""+a[o])}}function Es(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var h=o.getValue(),p="";return a&&(p=Xt(a)?a.checked?"true":"false":a.value),a=p,a!==h?(o.setValue(a),!0):!1}function ys(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Ps=/[\n"\\]/g;function ps(a){return a.replace(Ps,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function vs(a,o,h,p,D,M,oe,Ae){a.name="",oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"?a.type=oe:a.removeAttribute("type"),o!=null?oe==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+Yt(o)):a.value!==""+Yt(o)&&(a.value=""+Yt(o)):oe!=="submit"&&oe!=="reset"||a.removeAttribute("value"),o!=null?cs(a,oe,Yt(o)):h!=null?cs(a,oe,Yt(h)):p!=null&&a.removeAttribute("value"),D==null&&M!=null&&(a.defaultChecked=!!M),D!=null&&(a.checked=D&&typeof D!="function"&&typeof D!="symbol"),Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?a.name=""+Yt(Ae):a.removeAttribute("name")}function Ms(a,o,h,p,D,M,oe,Ae){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(a.type=M),o!=null||h!=null){if(!(M!=="submit"&&M!=="reset"||o!=null)){Ut(a);return}h=h!=null?""+Yt(h):"",o=o!=null?""+Yt(o):h,Ae||o===a.value||(a.value=o),a.defaultValue=o}p=p??D,p=typeof p!="function"&&typeof p!="symbol"&&!!p,a.checked=Ae?a.checked:!!p,a.defaultChecked=!!p,oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"&&(a.name=oe),Ut(a)}function cs(a,o,h){o==="number"&&ys(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function ms(a,o,h,p){if(a=a.options,o){o={};for(var D=0;D<h.length;D++)o["$"+h[D]]=!0;for(h=0;h<a.length;h++)D=o.hasOwnProperty("$"+a[h].value),a[h].selected!==D&&(a[h].selected=D),D&&p&&(a[h].defaultSelected=!0)}else{for(h=""+Yt(h),o=null,D=0;D<a.length;D++){if(a[D].value===h){a[D].selected=!0,p&&(a[D].defaultSelected=!0);return}o!==null||a[D].disabled||(o=a[D])}o!==null&&(o.selected=!0)}}function Ks(a,o,h){if(o!=null&&(o=""+Yt(o),o!==a.value&&(a.value=o),h==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=h!=null?""+Yt(h):""}function Ls(a,o,h,p){if(o==null){if(p!=null){if(h!=null)throw Error(r(92));if(q(p)){if(1<p.length)throw Error(r(93));p=p[0]}h=p}h==null&&(h=""),o=h}h=Yt(o),a.defaultValue=h,p=a.textContent,p===h&&p!==""&&p!==null&&(a.value=p),Ut(a)}function nt(a,o){if(o){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=o;return}}a.textContent=o}var Ft=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cs(a,o,h){var p=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":p?a.setProperty(o,h):typeof h!="number"||h===0||Ft.has(o)?o==="float"?a.cssFloat=h:a[o]=(""+h).trim():a[o]=h+"px"}function Ht(a,o,h){if(o!=null&&typeof o!="object")throw Error(r(62));if(a=a.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?a.setProperty(p,""):p==="float"?a.cssFloat="":a[p]="");for(var D in o)p=o[D],o.hasOwnProperty(D)&&h[D]!==p&&Cs(a,D,p)}else for(var M in o)o.hasOwnProperty(M)&&Cs(a,M,o[M])}function Os(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ds=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function js(a){return Ds.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function hs(){}var Us=null;function Qs(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Is=null,_s=null;function Lr(a){var o=It(a);if(o&&(a=o.stateNode)){var h=a[ds]||null;e:switch(a=o.stateNode,o.type){case"input":if(vs(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+ps(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var p=h[o];if(p!==a&&p.form===a.form){var D=p[ds]||null;if(!D)throw Error(r(90));vs(p,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(o=0;o<h.length;o++)p=h[o],p.form===a.form&&Es(p)}break e;case"textarea":Ks(a,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&ms(a,!!h.multiple,o,!1)}}}var Ir=!1;function qr(a,o,h){if(Ir)return a(o,h);Ir=!0;try{var p=a(o);return p}finally{if(Ir=!1,(Is!==null||_s!==null)&&(rp(),Is&&(o=Is,a=_s,_s=Is=null,Lr(o),a)))for(o=0;o<a.length;o++)Lr(a[o])}}function vr(a,o){var h=a.stateNode;if(h===null)return null;var p=h[ds]||null;if(p===null)return null;h=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(r(231,o,typeof h));return h}var cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cr=!1;if(cn)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){cr=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{cr=!1}var Fr=null,Hi=null,Or=null;function zi(){if(Or)return Or;var a,o=Hi,h=o.length,p,D="value"in Fr?Fr.value:Fr.textContent,M=D.length;for(a=0;a<h&&o[a]===D[a];a++);var oe=h-a;for(p=1;p<=oe&&o[h-p]===D[M-p];p++);return Or=D.slice(a,1<p?1-p:void 0)}function Dr(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function Ta(){return!0}function Fa(){return!1}function Rs(a){function o(h,p,D,M,oe){this._reactName=h,this._targetInst=D,this.type=p,this.nativeEvent=M,this.target=oe,this.currentTarget=null;for(var Ae in a)a.hasOwnProperty(Ae)&&(h=a[Ae],this[Ae]=h?h(M):M[Ae]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Ta:Fa,this.isPropagationStopped=Fa,this}return _(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Ta)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Ta)},persist:function(){},isPersistent:Ta}),o}var Pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qn=Rs(Pn),Xr=_({},Pn,{view:0,detail:0}),Ni=Rs(Xr),so,ml,ws,Hn=_({},Xr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:un,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ws&&(ws&&a.type==="mousemove"?(so=a.screenX-ws.screenX,ml=a.screenY-ws.screenY):ml=so=0,ws=a),so)},movementY:function(a){return"movementY"in a?a.movementY:ml}}),Kr=Rs(Hn),Si=_({},Hn,{dataTransfer:0}),Oi=Rs(Si),Wh=_({},Xr,{relatedTarget:0}),no=Rs(Wh),Fh=_({},Pn,{animationName:0,elapsedTime:0,pseudoElement:0}),W=Rs(Fh),Se=_({},Pn,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Je=Rs(Se),xt=_({},Pn,{data:0}),Mt=Rs(xt),rs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ys={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xs(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=Ys[a])?!!o[a]:!1}function un(){return Xs}var xn=_({},Xr,{key:function(a){if(a.key){var o=rs[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=Dr(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?gs[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:un,charCode:function(a){return a.type==="keypress"?Dr(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Dr(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Bn=Rs(xn),wr=_({},Hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jr=Rs(wr),xr=_({},Xr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:un}),mi=Rs(xr),ri=_({},Pn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mi=Rs(ri),ro=_({},Hn,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),gl=Rs(ro),io=_({},Pn,{newState:0,oldState:0}),Ru=Rs(io),ud=[9,13,27,32],Rl=cn&&"CompositionEvent"in window,pl=null;cn&&"documentMode"in document&&(pl=document.documentMode);var _c=cn&&"TextEvent"in window&&!pl,ao=cn&&(!Rl||pl&&8<pl&&11>=pl),vi=" ",Ao=!1;function ko(a,o){switch(a){case"keyup":return ud.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hd(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Tl=!1;function ca(a,o){switch(a){case"compositionend":return hd(o);case"keypress":return o.which!==32?null:(Ao=!0,vi);case"textInput":return a=o.data,a===vi&&Ao?null:a;default:return null}}function lo(a,o){if(Tl)return a==="compositionend"||!Rl&&ko(a,o)?(a=zi(),Or=Hi=Fr=null,Tl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ao&&o.locale!=="ko"?null:o.data;default:return null}}var fd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tu(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!fd[a.type]:o==="textarea"}function Ea(a,o,h,p){Is?_s?_s.push(p):_s=[p]:Is=p,o=up(o,"onChange"),0<o.length&&(h=new Qn("onChange","change",null,h,p),a.push({event:h,listeners:o}))}var _l=null,oo=null;function Eu(a){iS(a,0)}function xl(a){var o=he(a);if(Es(o))return a}function Uo(a,o){if(a==="change")return o}var xa=!1;if(cn){var da;if(cn){var El="oninput"in document;if(!El){var jl=document.createElement("div");jl.setAttribute("oninput","return;"),El=typeof jl.oninput=="function"}da=El}else da=!1;xa=da&&(!document.documentMode||9<document.documentMode)}function co(){_l&&(_l.detachEvent("onpropertychange",md),oo=_l=null)}function md(a){if(a.propertyName==="value"&&xl(oo)){var o=[];Ea(o,oo,a,Qs(a)),qr(Eu,o)}}function gd(a,o,h){a==="focusin"?(co(),_l=o,oo=h,_l.attachEvent("onpropertychange",md)):a==="focusout"&&co()}function Zr(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return xl(oo)}function Kh(a,o){if(a==="click")return xl(o)}function Il(a,o){if(a==="input"||a==="change")return xl(o)}function Ol(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var Li=typeof Object.is=="function"?Object.is:Ol;function uo(a,o){if(Li(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var h=Object.keys(a),p=Object.keys(o);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var D=h[p];if(!Ne.call(o,D)||!Li(a[D],o[D]))return!1}return!0}function pd(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function _d(a,o){var h=pd(a);a=0;for(var p;h;){if(h.nodeType===3){if(p=a+h.textContent.length,a<=o&&p>=o)return{node:h,offset:o-a};a=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=pd(h)}}function ho(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?ho(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function fo(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=ys(a.document);o instanceof a.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)a=o.contentWindow;else break;o=ys(a.document)}return o}function Ml(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var xc=cn&&"documentMode"in document&&11>=document.documentMode,ja=null,mo=null,qi=null,Ka=!1;function zn(a,o,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ka||ja==null||ja!==ys(p)||(p=ja,"selectionStart"in p&&Ml(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),qi&&uo(qi,p)||(qi=p,p=up(mo,"onSelect"),0<p.length&&(o=new Qn("onSelect","select",null,o,h),a.push({event:o,listeners:p}),o.target=ja)))}function Wn(a,o){var h={};return h[a.toLowerCase()]=o.toLowerCase(),h["Webkit"+a]="webkit"+o,h["Moz"+a]="moz"+o,h}var Cr={animationend:Wn("Animation","AnimationEnd"),animationiteration:Wn("Animation","AnimationIteration"),animationstart:Wn("Animation","AnimationStart"),transitionrun:Wn("Transition","TransitionRun"),transitionstart:Wn("Transition","TransitionStart"),transitioncancel:Wn("Transition","TransitionCancel"),transitionend:Wn("Transition","TransitionEnd")},ei={},Ll={};cn&&(Ll=document.createElement("div").style,"AnimationEvent"in window||(delete Cr.animationend.animation,delete Cr.animationiteration.animation,delete Cr.animationstart.animation),"TransitionEvent"in window||delete Cr.transitionend.transition);function Cl(a){if(ei[a])return ei[a];if(!Cr[a])return a;var o=Cr[a],h;for(h in o)if(o.hasOwnProperty(h)&&h in Ll)return ei[a]=o[h];return a}var Cc=Cl("animationend"),ju=Cl("animationiteration"),Bf=Cl("animationstart"),wg=Cl("transitionrun"),Pg=Cl("transitionstart"),Ag=Cl("transitioncancel"),Wf=Cl("transitionend"),Ff=new Map,yc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");yc.push("scrollEnd");function Qa(a,o){Ff.set(a,o),Te(o,[a])}var Iu=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Ia=[],bc=0,Qh=0;function Ou(){for(var a=bc,o=Qh=bc=0;o<a;){var h=Ia[o];Ia[o++]=null;var p=Ia[o];Ia[o++]=null;var D=Ia[o];Ia[o++]=null;var M=Ia[o];if(Ia[o++]=null,p!==null&&D!==null){var oe=p.pending;oe===null?D.next=D:(D.next=oe.next,oe.next=D),p.pending=D}M!==0&&Lu(h,D,M)}}function Mu(a,o,h,p){Ia[bc++]=a,Ia[bc++]=o,Ia[bc++]=h,Ia[bc++]=p,Qh|=p,a.lanes|=p,a=a.alternate,a!==null&&(a.lanes|=p)}function Gh(a,o,h,p){return Mu(a,o,h,p),Xi(a)}function go(a,o){return Mu(a,null,null,o),Xi(a)}function Lu(a,o,h){a.lanes|=h;var p=a.alternate;p!==null&&(p.lanes|=h);for(var D=!1,M=a.return;M!==null;)M.childLanes|=h,p=M.alternate,p!==null&&(p.childLanes|=h),M.tag===22&&(a=M.stateNode,a===null||a._visibility&1||(D=!0)),a=M,M=M.return;return a.tag===3?(M=a.stateNode,D&&o!==null&&(D=31-rt(h),a=M.hiddenUpdates,p=a[D],p===null?a[D]=[o]:p.push(o),o.lane=h|536870912),M):null}function Xi(a){if(50<cm)throw cm=0,m1=null,Error(r(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var wi={};function Yh(a,o,h,p){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ji(a,o,h,p){return new Yh(a,o,h,p)}function Vh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ga(a,o){var h=a.alternate;return h===null?(h=Ji(a.tag,o,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=o,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,o=a.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function wu(a,o){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,o=h.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function xd(a,o,h,p,D,M){var oe=0;if(p=a,typeof a=="function")Vh(a)&&(oe=1);else if(typeof a=="string")oe=kO(a,h,Q.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case O:return a=Ji(31,h,o,D),a.elementType=O,a.lanes=M,a;case C:return Bo(h.children,D,M,o);case v:oe=8,D|=24;break;case R:return a=Ji(12,h,o,D|2),a.elementType=R,a.lanes=M,a;case P:return a=Ji(13,h,o,D),a.elementType=P,a.lanes=M,a;case G:return a=Ji(19,h,o,D),a.elementType=G,a.lanes=M,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case L:oe=10;break e;case U:oe=9;break e;case w:oe=11;break e;case K:oe=14;break e;case B:oe=16,p=null;break e}oe=29,h=Error(r(130,a===null?"null":typeof a,"")),p=null}return o=Ji(oe,h,o,D),o.elementType=a,o.type=p,o.lanes=M,o}function Bo(a,o,h,p){return a=Ji(7,a,p,o),a.lanes=h,a}function Pu(a,o,h){return a=Ji(6,a,null,o),a.lanes=h,a}function $h(a){var o=Ji(18,null,null,0);return o.stateNode=a,o}function Cd(a,o,h){return o=Ji(4,a.children!==null?a.children:[],a.key,o),o.lanes=h,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var Hh=new WeakMap;function Ya(a,o){if(typeof a=="object"&&a!==null){var h=Hh.get(a);return h!==void 0?h:(o={value:a,source:o,stack:Ee(o)},Hh.set(a,o),o)}return{value:a,source:o,stack:Ee(o)}}var yd=[],Nc=0,zh=null,Au=0,Va=[],$a=0,Wo=null,Ha=1,za="";function Oa(a,o){yd[Nc++]=Au,yd[Nc++]=zh,zh=a,Au=o}function kg(a,o,h){Va[$a++]=Ha,Va[$a++]=za,Va[$a++]=Wo,Wo=a;var p=Ha;a=za;var D=32-rt(p)-1;p&=~(1<<D),h+=1;var M=32-rt(o)+D;if(30<M){var oe=D-D%5;M=(p&(1<<oe)-1).toString(32),p>>=oe,D-=oe,Ha=1<<32-rt(o)+D|h<<D|p,za=M+a}else Ha=1<<M|h<<D|p,za=a}function Kf(a){a.return!==null&&(Oa(a,1),kg(a,1,0))}function qh(a){for(;a===zh;)zh=yd[--Nc],yd[Nc]=null,Au=yd[--Nc],yd[Nc]=null;for(;a===Wo;)Wo=Va[--$a],Va[$a]=null,za=Va[--$a],Va[$a]=null,Ha=Va[--$a],Va[$a]=null}function Ug(a,o){Va[$a++]=Ha,Va[$a++]=za,Va[$a++]=Wo,Ha=o.id,za=o.overflow,Wo=a}var Pi=null,Rr=null,Mn=!1,ua=null,Qr=!1,yl=Error(r(519));function Fo(a){var o=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bd(Ya(o,a)),yl}function Qf(a){var o=a.stateNode,h=a.type,p=a.memoizedProps;switch(o[ls]=a,o[ds]=p,h){case"dialog":wn("cancel",o),wn("close",o);break;case"iframe":case"object":case"embed":wn("load",o);break;case"video":case"audio":for(h=0;h<um.length;h++)wn(um[h],o);break;case"source":wn("error",o);break;case"img":case"image":case"link":wn("error",o),wn("load",o);break;case"details":wn("toggle",o);break;case"input":wn("invalid",o),Ms(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":wn("invalid",o);break;case"textarea":wn("invalid",o),Ls(o,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||p.suppressHydrationWarning===!0||cS(o.textContent,h)?(p.popover!=null&&(wn("beforetoggle",o),wn("toggle",o)),p.onScroll!=null&&wn("scroll",o),p.onScrollEnd!=null&&wn("scrollend",o),p.onClick!=null&&(o.onclick=hs),o=!0):o=!1,o||Fo(a,!0)}function po(a){for(Pi=a.return;Pi;)switch(Pi.tag){case 5:case 31:case 13:Qr=!1;return;case 27:case 3:Qr=!0;return;default:Pi=Pi.return}}function Ai(a){if(a!==Pi)return!1;if(!Mn)return po(a),Mn=!0,!1;var o=a.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||j1(a.type,a.memoizedProps)),h=!h),h&&Rr&&Fo(a),po(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Rr=xS(a)}else if(o===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Rr=xS(a)}else o===27?(o=Rr,Pd(a.type)?(a=w1,w1=null,Rr=a):Rr=o):Rr=Pi?kl(a.stateNode.nextSibling):null;return!0}function Sc(){Rr=Pi=null,Mn=!1}function Gf(){var a=ua;return a!==null&&(tl===null?tl=a:tl.push.apply(tl,a),ua=null),a}function bd(a){ua===null?ua=[a]:ua.push(a)}var Xh=T(null),Ko=null,wl=null;function Qo(a,o,h){k(Xh,o._currentValue),o._currentValue=h}function qa(a){a._currentValue=Xh.current,j(Xh)}function Nd(a,o,h){for(;a!==null;){var p=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),a===h)break;a=a.return}}function vc(a,o,h,p){var D=a.child;for(D!==null&&(D.return=a);D!==null;){var M=D.dependencies;if(M!==null){var oe=D.child;M=M.firstContext;e:for(;M!==null;){var Ae=M;M=D;for(var gt=0;gt<o.length;gt++)if(Ae.context===o[gt]){M.lanes|=h,Ae=M.alternate,Ae!==null&&(Ae.lanes|=h),Nd(M.return,h,a),p||(oe=null);break e}M=Ae.next}}else if(D.tag===18){if(oe=D.return,oe===null)throw Error(r(341));oe.lanes|=h,M=oe.alternate,M!==null&&(M.lanes|=h),Nd(oe,h,a),oe=null}else oe=D.child;if(oe!==null)oe.return=D;else for(oe=D;oe!==null;){if(oe===a){oe=null;break}if(D=oe.sibling,D!==null){D.return=oe.return,oe=D;break}oe=oe.return}D=oe}}function Go(a,o,h,p){a=null;for(var D=o,M=!1;D!==null;){if(!M){if((D.flags&524288)!==0)M=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var oe=D.alternate;if(oe===null)throw Error(r(387));if(oe=oe.memoizedProps,oe!==null){var Ae=D.type;Li(D.pendingProps.value,oe.value)||(a!==null?a.push(Ae):a=[Ae])}}else if(D===ie.current){if(oe=D.alternate,oe===null)throw Error(r(387));oe.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(a!==null?a.push(pm):a=[pm])}D=D.return}a!==null&&vc(o,a,h,p),o.flags|=262144}function Jh(a){for(a=a.firstContext;a!==null;){if(!Li(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Yo(a){Ko=a,wl=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function ki(a){return Bg(Ko,a)}function Zh(a,o){return Ko===null&&Yo(a),Bg(a,o)}function Bg(a,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},wl===null){if(a===null)throw Error(r(308));wl=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else wl=wl.next=o;return h}var Lx=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(h,p){a.push(p)}};this.abort=function(){o.aborted=!0,a.forEach(function(h){return h()})}},wx=t.unstable_scheduleCallback,Px=t.unstable_NormalPriority,ti={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sd(){return{controller:new Lx,data:new Map,refCount:0}}function ku(a){a.refCount--,a.refCount===0&&wx(Px,function(){a.controller.abort()})}var Uu=null,e0=0,b=0,E=null;function z(a,o){if(Uu===null){var h=Uu=[];e0=0,b=y1(),E={status:"pending",value:void 0,then:function(p){h.push(p)}}}return e0++,o.then(re,re),o}function re(){if(--e0===0&&Uu!==null){E!==null&&(E.status="fulfilled");var a=Uu;Uu=null,b=0,E=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function ve(a,o){var h=[],p={status:"pending",value:null,reason:null,then:function(D){h.push(D)}};return a.then(function(){p.status="fulfilled",p.value=o;for(var D=0;D<h.length;D++)(0,h[D])(o)},function(D){for(p.status="rejected",p.reason=D,D=0;D<h.length;D++)(0,h[D])(void 0)}),p}var Ie=V.S;V.S=function(a,o){L2=et(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&z(a,o),Ie!==null&&Ie(a,o)};var we=T(null);function Fe(){var a=we.current;return a!==null?a:Er.pooledCache}function Ge(a,o){o===null?k(we,we.current):k(we,o.pool)}function qe(){var a=Fe();return a===null?null:{parent:ti._currentValue,pool:a}}var Nt=Error(r(460)),Wt=Error(r(474)),He=Error(r(542)),Et={then:function(){}};function Pt(a){return a=a.status,a==="fulfilled"||a==="rejected"}function es(a,o,h){switch(h=a[h],h===void 0?a.push(o):h!==o&&(o.then(hs,hs),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,xs(a),a;default:if(typeof o.status=="string")o.then(hs,hs);else{if(a=Er,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=o,a.status="pending",a.then(function(p){if(o.status==="pending"){var D=o;D.status="fulfilled",D.value=p}},function(p){if(o.status==="pending"){var D=o;D.status="rejected",D.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,xs(a),a}throw Jt=o,Nt}}function kt(a){try{var o=a._init;return o(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Jt=h,Nt):h}}var Jt=null;function is(){if(Jt===null)throw Error(r(459));var a=Jt;return Jt=null,a}function xs(a){if(a===Nt||a===He)throw Error(r(483))}var fs=null,$s=0;function Bs(a){var o=$s;return $s+=1,fs===null&&(fs=[]),es(fs,a,o)}function mn(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Gs(a,o){throw o.$$typeof===y?Error(r(525)):(a=Object.prototype.toString.call(o),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function On(a){function o(Lt,Rt){if(a){var Qt=Lt.deletions;Qt===null?(Lt.deletions=[Rt],Lt.flags|=16):Qt.push(Rt)}}function h(Lt,Rt){if(!a)return null;for(;Rt!==null;)o(Lt,Rt),Rt=Rt.sibling;return null}function p(Lt){for(var Rt=new Map;Lt!==null;)Lt.key!==null?Rt.set(Lt.key,Lt):Rt.set(Lt.index,Lt),Lt=Lt.sibling;return Rt}function D(Lt,Rt){return Lt=Ga(Lt,Rt),Lt.index=0,Lt.sibling=null,Lt}function M(Lt,Rt,Qt){return Lt.index=Qt,a?(Qt=Lt.alternate,Qt!==null?(Qt=Qt.index,Qt<Rt?(Lt.flags|=67108866,Rt):Qt):(Lt.flags|=67108866,Rt)):(Lt.flags|=1048576,Rt)}function oe(Lt){return a&&Lt.alternate===null&&(Lt.flags|=67108866),Lt}function Ae(Lt,Rt,Qt,os){return Rt===null||Rt.tag!==6?(Rt=Pu(Qt,Lt.mode,os),Rt.return=Lt,Rt):(Rt=D(Rt,Qt),Rt.return=Lt,Rt)}function gt(Lt,Rt,Qt,os){var rn=Qt.type;return rn===C?ns(Lt,Rt,Qt.props.children,os,Qt.key):Rt!==null&&(Rt.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===B&&kt(rn)===Rt.type)?(Rt=D(Rt,Qt.props),mn(Rt,Qt),Rt.return=Lt,Rt):(Rt=xd(Qt.type,Qt.key,Qt.props,null,Lt.mode,os),mn(Rt,Qt),Rt.return=Lt,Rt)}function Gt(Lt,Rt,Qt,os){return Rt===null||Rt.tag!==4||Rt.stateNode.containerInfo!==Qt.containerInfo||Rt.stateNode.implementation!==Qt.implementation?(Rt=Cd(Qt,Lt.mode,os),Rt.return=Lt,Rt):(Rt=D(Rt,Qt.children||[]),Rt.return=Lt,Rt)}function ns(Lt,Rt,Qt,os,rn){return Rt===null||Rt.tag!==7?(Rt=Bo(Qt,Lt.mode,os,rn),Rt.return=Lt,Rt):(Rt=D(Rt,Qt),Rt.return=Lt,Rt)}function us(Lt,Rt,Qt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return Rt=Pu(""+Rt,Lt.mode,Qt),Rt.return=Lt,Rt;if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case g:return Qt=xd(Rt.type,Rt.key,Rt.props,null,Lt.mode,Qt),mn(Qt,Rt),Qt.return=Lt,Qt;case N:return Rt=Cd(Rt,Lt.mode,Qt),Rt.return=Lt,Rt;case B:return Rt=kt(Rt),us(Lt,Rt,Qt)}if(q(Rt)||Y(Rt))return Rt=Bo(Rt,Lt.mode,Qt,null),Rt.return=Lt,Rt;if(typeof Rt.then=="function")return us(Lt,Bs(Rt),Qt);if(Rt.$$typeof===L)return us(Lt,Zh(Lt,Rt),Qt);Gs(Lt,Rt)}return null}function Vt(Lt,Rt,Qt,os){var rn=Rt!==null?Rt.key:null;if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint")return rn!==null?null:Ae(Lt,Rt,""+Qt,os);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case g:return Qt.key===rn?gt(Lt,Rt,Qt,os):null;case N:return Qt.key===rn?Gt(Lt,Rt,Qt,os):null;case B:return Qt=kt(Qt),Vt(Lt,Rt,Qt,os)}if(q(Qt)||Y(Qt))return rn!==null?null:ns(Lt,Rt,Qt,os,null);if(typeof Qt.then=="function")return Vt(Lt,Rt,Bs(Qt),os);if(Qt.$$typeof===L)return Vt(Lt,Rt,Zh(Lt,Qt),os);Gs(Lt,Qt)}return null}function zt(Lt,Rt,Qt,os,rn){if(typeof os=="string"&&os!==""||typeof os=="number"||typeof os=="bigint")return Lt=Lt.get(Qt)||null,Ae(Rt,Lt,""+os,rn);if(typeof os=="object"&&os!==null){switch(os.$$typeof){case g:return Lt=Lt.get(os.key===null?Qt:os.key)||null,gt(Rt,Lt,os,rn);case N:return Lt=Lt.get(os.key===null?Qt:os.key)||null,Gt(Rt,Lt,os,rn);case B:return os=kt(os),zt(Lt,Rt,Qt,os,rn)}if(q(os)||Y(os))return Lt=Lt.get(Qt)||null,ns(Rt,Lt,os,rn,null);if(typeof os.then=="function")return zt(Lt,Rt,Qt,Bs(os),rn);if(os.$$typeof===L)return zt(Lt,Rt,Qt,Zh(Rt,os),rn);Gs(Rt,os)}return null}function Vs(Lt,Rt,Qt,os){for(var rn=null,Xn=null,Js=Rt,vn=Rt=0,kn=null;Js!==null&&vn<Qt.length;vn++){Js.index>vn?(kn=Js,Js=null):kn=Js.sibling;var Jn=Vt(Lt,Js,Qt[vn],os);if(Jn===null){Js===null&&(Js=kn);break}a&&Js&&Jn.alternate===null&&o(Lt,Js),Rt=M(Jn,Rt,vn),Xn===null?rn=Jn:Xn.sibling=Jn,Xn=Jn,Js=kn}if(vn===Qt.length)return h(Lt,Js),Mn&&Oa(Lt,vn),rn;if(Js===null){for(;vn<Qt.length;vn++)Js=us(Lt,Qt[vn],os),Js!==null&&(Rt=M(Js,Rt,vn),Xn===null?rn=Js:Xn.sibling=Js,Xn=Js);return Mn&&Oa(Lt,vn),rn}for(Js=p(Js);vn<Qt.length;vn++)kn=zt(Js,Lt,vn,Qt[vn],os),kn!==null&&(a&&kn.alternate!==null&&Js.delete(kn.key===null?vn:kn.key),Rt=M(kn,Rt,vn),Xn===null?rn=kn:Xn.sibling=kn,Xn=kn);return a&&Js.forEach(function(Wd){return o(Lt,Wd)}),Mn&&Oa(Lt,vn),rn}function dn(Lt,Rt,Qt,os){if(Qt==null)throw Error(r(151));for(var rn=null,Xn=null,Js=Rt,vn=Rt=0,kn=null,Jn=Qt.next();Js!==null&&!Jn.done;vn++,Jn=Qt.next()){Js.index>vn?(kn=Js,Js=null):kn=Js.sibling;var Wd=Vt(Lt,Js,Jn.value,os);if(Wd===null){Js===null&&(Js=kn);break}a&&Js&&Wd.alternate===null&&o(Lt,Js),Rt=M(Wd,Rt,vn),Xn===null?rn=Wd:Xn.sibling=Wd,Xn=Wd,Js=kn}if(Jn.done)return h(Lt,Js),Mn&&Oa(Lt,vn),rn;if(Js===null){for(;!Jn.done;vn++,Jn=Qt.next())Jn=us(Lt,Jn.value,os),Jn!==null&&(Rt=M(Jn,Rt,vn),Xn===null?rn=Jn:Xn.sibling=Jn,Xn=Jn);return Mn&&Oa(Lt,vn),rn}for(Js=p(Js);!Jn.done;vn++,Jn=Qt.next())Jn=zt(Js,Lt,vn,Jn.value,os),Jn!==null&&(a&&Jn.alternate!==null&&Js.delete(Jn.key===null?vn:Jn.key),Rt=M(Jn,Rt,vn),Xn===null?rn=Jn:Xn.sibling=Jn,Xn=Jn);return a&&Js.forEach(function(HO){return o(Lt,HO)}),Mn&&Oa(Lt,vn),rn}function Sr(Lt,Rt,Qt,os){if(typeof Qt=="object"&&Qt!==null&&Qt.type===C&&Qt.key===null&&(Qt=Qt.props.children),typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case g:e:{for(var rn=Qt.key;Rt!==null;){if(Rt.key===rn){if(rn=Qt.type,rn===C){if(Rt.tag===7){h(Lt,Rt.sibling),os=D(Rt,Qt.props.children),os.return=Lt,Lt=os;break e}}else if(Rt.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===B&&kt(rn)===Rt.type){h(Lt,Rt.sibling),os=D(Rt,Qt.props),mn(os,Qt),os.return=Lt,Lt=os;break e}h(Lt,Rt);break}else o(Lt,Rt);Rt=Rt.sibling}Qt.type===C?(os=Bo(Qt.props.children,Lt.mode,os,Qt.key),os.return=Lt,Lt=os):(os=xd(Qt.type,Qt.key,Qt.props,null,Lt.mode,os),mn(os,Qt),os.return=Lt,Lt=os)}return oe(Lt);case N:e:{for(rn=Qt.key;Rt!==null;){if(Rt.key===rn)if(Rt.tag===4&&Rt.stateNode.containerInfo===Qt.containerInfo&&Rt.stateNode.implementation===Qt.implementation){h(Lt,Rt.sibling),os=D(Rt,Qt.children||[]),os.return=Lt,Lt=os;break e}else{h(Lt,Rt);break}else o(Lt,Rt);Rt=Rt.sibling}os=Cd(Qt,Lt.mode,os),os.return=Lt,Lt=os}return oe(Lt);case B:return Qt=kt(Qt),Sr(Lt,Rt,Qt,os)}if(q(Qt))return Vs(Lt,Rt,Qt,os);if(Y(Qt)){if(rn=Y(Qt),typeof rn!="function")throw Error(r(150));return Qt=rn.call(Qt),dn(Lt,Rt,Qt,os)}if(typeof Qt.then=="function")return Sr(Lt,Rt,Bs(Qt),os);if(Qt.$$typeof===L)return Sr(Lt,Rt,Zh(Lt,Qt),os);Gs(Lt,Qt)}return typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint"?(Qt=""+Qt,Rt!==null&&Rt.tag===6?(h(Lt,Rt.sibling),os=D(Rt,Qt),os.return=Lt,Lt=os):(h(Lt,Rt),os=Pu(Qt,Lt.mode,os),os.return=Lt,Lt=os),oe(Lt)):h(Lt,Rt)}return function(Lt,Rt,Qt,os){try{$s=0;var rn=Sr(Lt,Rt,Qt,os);return fs=null,rn}catch(Js){if(Js===Nt||Js===He)throw Js;var Xn=Ji(29,Js,null,Lt.mode);return Xn.lanes=os,Xn.return=Lt,Xn}finally{}}}var Tr=On(!0),Cn=On(!1),Ws=!1;function Ts(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pr(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function on(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Nn(a,o,h){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(ar&2)!==0){var D=p.pending;return D===null?o.next=o:(o.next=D.next,D.next=o),p.pending=o,o=Xi(a),Lu(a,null,h),o}return Mu(a,p,o,h),Xi(a)}function rr(a,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var p=o.lanes;p&=a.pendingLanes,h|=p,o.lanes=h,lt(a,h)}}function gi(a,o){var h=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var D=null,M=null;if(h=h.firstBaseUpdate,h!==null){do{var oe={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};M===null?D=M=oe:M=M.next=oe,h=h.next}while(h!==null);M===null?D=M=o:M=M.next=o}else D=M=o;h={baseState:p.baseState,firstBaseUpdate:D,lastBaseUpdate:M,shared:p.shared,callbacks:p.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=o:a.next=o,h.lastBaseUpdate=o}var Ui=!1;function yr(){if(Ui){var a=E;if(a!==null)throw a}}function ii(a,o,h,p){Ui=!1;var D=a.updateQueue;Ws=!1;var M=D.firstBaseUpdate,oe=D.lastBaseUpdate,Ae=D.shared.pending;if(Ae!==null){D.shared.pending=null;var gt=Ae,Gt=gt.next;gt.next=null,oe===null?M=Gt:oe.next=Gt,oe=gt;var ns=a.alternate;ns!==null&&(ns=ns.updateQueue,Ae=ns.lastBaseUpdate,Ae!==oe&&(Ae===null?ns.firstBaseUpdate=Gt:Ae.next=Gt,ns.lastBaseUpdate=gt))}if(M!==null){var us=D.baseState;oe=0,ns=Gt=gt=null,Ae=M;do{var Vt=Ae.lane&-536870913,zt=Vt!==Ae.lane;if(zt?(An&Vt)===Vt:(p&Vt)===Vt){Vt!==0&&Vt===b&&(Ui=!0),ns!==null&&(ns=ns.next={lane:0,tag:Ae.tag,payload:Ae.payload,callback:null,next:null});e:{var Vs=a,dn=Ae;Vt=o;var Sr=h;switch(dn.tag){case 1:if(Vs=dn.payload,typeof Vs=="function"){us=Vs.call(Sr,us,Vt);break e}us=Vs;break e;case 3:Vs.flags=Vs.flags&-65537|128;case 0:if(Vs=dn.payload,Vt=typeof Vs=="function"?Vs.call(Sr,us,Vt):Vs,Vt==null)break e;us=_({},us,Vt);break e;case 2:Ws=!0}}Vt=Ae.callback,Vt!==null&&(a.flags|=64,zt&&(a.flags|=8192),zt=D.callbacks,zt===null?D.callbacks=[Vt]:zt.push(Vt))}else zt={lane:Vt,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},ns===null?(Gt=ns=zt,gt=us):ns=ns.next=zt,oe|=Vt;if(Ae=Ae.next,Ae===null){if(Ae=D.shared.pending,Ae===null)break;zt=Ae,Ae=zt.next,zt.next=null,D.lastBaseUpdate=zt,D.shared.pending=null}}while(!0);ns===null&&(gt=us),D.baseState=gt,D.firstBaseUpdate=Gt,D.lastBaseUpdate=ns,M===null&&(D.shared.lanes=0),Id|=oe,a.lanes=oe,a.memoizedState=us}}function Zi(a,o){if(typeof a!="function")throw Error(r(191,a));a.call(o)}function ai(a,o){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)Zi(h[a],o)}var Tn=T(null),Gn=T(0);function Ar(a,o){a=wc,k(Gn,a),k(Tn,o),wc=a|o.baseLanes}function qn(){k(Gn,wc),k(Tn,Tn.current)}function pi(){wc=Gn.current,j(Tn),j(Gn)}var kr=T(null),Yn=null;function si(a){var o=a.alternate;k(Fn,Fn.current&1),k(kr,a),Yn===null&&(o===null||Tn.current!==null||o.memoizedState!==null)&&(Yn=a)}function ir(a){k(Fn,Fn.current),k(kr,a),Yn===null&&(Yn=a)}function li(a){a.tag===22?(k(Fn,Fn.current),k(kr,a),Yn===null&&(Yn=a)):oi()}function oi(){k(Fn,Fn.current),k(kr,kr.current)}function hr(a){j(kr),Yn===a&&(Yn=null),j(Fn)}var Fn=T(0);function ea(a){for(var o=a;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||M1(h)||L1(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Gr=0,tn=null,nn=null,Vn=null,Ca=!1,Xa=!1,ha=!1,ci=0,Vo=0,$o=null,t0=0;function br(){throw Error(r(321))}function Yf(a,o){if(o===null)return!1;for(var h=0;h<o.length&&h<a.length;h++)if(!Li(a[h],o[h]))return!1;return!0}function Vf(a,o,h,p,D,M){return Gr=M,tn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,V.H=a===null||a.memoizedState===null?GN:Qx,ha=!1,M=h(p,D),ha=!1,Xa&&(M=_o(o,h,p,D)),s0(a),M}function s0(a){V.H=em;var o=nn!==null&&nn.next!==null;if(Gr=0,Vn=nn=tn=null,Ca=!1,Vo=0,$o=null,o)throw Error(r(300));a===null||Ri||(a=a.dependencies,a!==null&&Jh(a)&&(Ri=!0))}function _o(a,o,h,p){tn=a;var D=0;do{if(Xa&&($o=null),Vo=0,Xa=!1,25<=D)throw Error(r(301));if(D+=1,Vn=nn=null,a.updateQueue!=null){var M=a.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}V.H=YN,M=o(h,p)}while(Xa);return M}function Ax(){var a=V.H,o=a.useState()[0];return o=typeof o.then=="function"?Ho(o):o,a=a.useState()[0],(nn!==null?nn.memoizedState:null)!==a&&(tn.flags|=1024),o}function $f(){var a=ci!==0;return ci=0,a}function Hf(a,o,h){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~h}function n0(a){if(Ca){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Ca=!1}Gr=0,Vn=nn=tn=null,Xa=!1,Vo=ci=0,$o=null}function Di(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?tn.memoizedState=Vn=a:Vn=Vn.next=a,Vn}function Yr(){if(nn===null){var a=tn.alternate;a=a!==null?a.memoizedState:null}else a=nn.next;var o=Vn===null?tn.memoizedState:Vn.next;if(o!==null)Vn=o,nn=a;else{if(a===null)throw tn.alternate===null?Error(r(467)):Error(r(310));nn=a,a={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},Vn===null?tn.memoizedState=Vn=a:Vn=Vn.next=a}return Vn}function Bu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ho(a){var o=Vo;return Vo+=1,$o===null&&($o=[]),a=es($o,a,o),o=tn,(Vn===null?o.memoizedState:Vn.next)===null&&(o=o.alternate,V.H=o===null||o.memoizedState===null?GN:Qx),a}function vd(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ho(a);if(a.$$typeof===L)return ki(a)}throw Error(r(438,String(a)))}function Dc(a){var o=null,h=tn.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var p=tn.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(D){return D.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=Bu(),tn.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(a),p=0;p<a;p++)h[p]=S;return o.index++,h}function Pl(a,o){return typeof o=="function"?o(a):o}function r0(a){var o=Yr();return Dd(o,nn,a)}function Dd(a,o,h){var p=a.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=h;var D=a.baseQueue,M=p.pending;if(M!==null){if(D!==null){var oe=D.next;D.next=M.next,M.next=oe}o.baseQueue=D=M,p.pending=null}if(M=a.baseState,D===null)a.memoizedState=M;else{o=D.next;var Ae=oe=null,gt=null,Gt=o,ns=!1;do{var us=Gt.lane&-536870913;if(us!==Gt.lane?(An&us)===us:(Gr&us)===us){var Vt=Gt.revertLane;if(Vt===0)gt!==null&&(gt=gt.next={lane:0,revertLane:0,gesture:null,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null}),us===b&&(ns=!0);else if((Gr&Vt)===Vt){Gt=Gt.next,Vt===b&&(ns=!0);continue}else us={lane:0,revertLane:Gt.revertLane,gesture:null,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null},gt===null?(Ae=gt=us,oe=M):gt=gt.next=us,tn.lanes|=Vt,Id|=Vt;us=Gt.action,ha&&h(M,us),M=Gt.hasEagerState?Gt.eagerState:h(M,us)}else Vt={lane:us,revertLane:Gt.revertLane,gesture:Gt.gesture,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null},gt===null?(Ae=gt=Vt,oe=M):gt=gt.next=Vt,tn.lanes|=us,Id|=us;Gt=Gt.next}while(Gt!==null&&Gt!==o);if(gt===null?oe=M:gt.next=Ae,!Li(M,a.memoizedState)&&(Ri=!0,ns&&(h=E,h!==null)))throw h;a.memoizedState=M,a.baseState=oe,a.baseQueue=gt,p.lastRenderedState=M}return D===null&&(p.lanes=0),[a.memoizedState,p.dispatch]}function i0(a){var o=Yr(),h=o.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=a;var p=h.dispatch,D=h.pending,M=o.memoizedState;if(D!==null){h.pending=null;var oe=D=D.next;do M=a(M,oe.action),oe=oe.next;while(oe!==D);Li(M,o.memoizedState)||(Ri=!0),o.memoizedState=M,o.baseQueue===null&&(o.baseState=M),h.lastRenderedState=M}return[M,p]}function a0(a,o,h){var p=tn,D=Yr(),M=Mn;if(M){if(h===void 0)throw Error(r(407));h=h()}else h=o();var oe=!Li((nn||D).memoizedState,h);if(oe&&(D.memoizedState=h,Ri=!0),D=D.queue,kx(qf.bind(null,p,D,a),[a]),D.getSnapshot!==o||oe||Vn!==null&&Vn.memoizedState.tag&1){if(p.flags|=2048,Tc(9,{destroy:void 0},zf.bind(null,p,D,h,o),null),Er===null)throw Error(r(349));M||(Gr&127)!==0||xo(p,o,h)}return h}function xo(a,o,h){a.flags|=16384,a={getSnapshot:o,value:h},o=tn.updateQueue,o===null?(o=Bu(),tn.updateQueue=o,o.stores=[a]):(h=o.stores,h===null?o.stores=[a]:h.push(a))}function zf(a,o,h,p){o.value=h,o.getSnapshot=p,Wg(o)&&Xf(a)}function qf(a,o,h){return h(function(){Wg(o)&&Xf(a)})}function Wg(a){var o=a.getSnapshot;a=a.value;try{var h=o();return!Li(a,h)}catch{return!0}}function Xf(a){var o=go(a,2);o!==null&&sl(o,a,2)}function zo(a){var o=Di();if(typeof a=="function"){var h=a;if(a=h(),ha){Ke(!0);try{h()}finally{Ke(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:a},o}function Fg(a,o,h,p){return a.baseState=h,Dd(a,nn,typeof p=="function"?p:Pl)}function Kg(a,o,h,p,D){if(Vg(a))throw Error(r(485));if(a=o.action,a!==null){var M={payload:D,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(oe){M.listeners.push(oe)}};V.T!==null?h(!0):M.isTransition=!1,p(M),h=o.pending,h===null?(M.next=o.pending=M,Qg(o,M)):(M.next=h.next,o.pending=h.next=M)}}function Qg(a,o){var h=o.action,p=o.payload,D=a.state;if(o.isTransition){var M=V.T,oe={};V.T=oe;try{var Ae=h(D,p),gt=V.S;gt!==null&&gt(oe,Ae),Jf(a,o,Ae)}catch(Gt){Rc(a,o,Gt)}finally{M!==null&&oe.types!==null&&(M.types=oe.types),V.T=M}}else try{M=h(D,p),Jf(a,o,M)}catch(Gt){Rc(a,o,Gt)}}function Jf(a,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){Gg(a,o,p)},function(p){return Rc(a,o,p)}):Gg(a,o,h)}function Gg(a,o,h){o.status="fulfilled",o.value=h,l0(o),a.state=h,o=a.pending,o!==null&&(h=o.next,h===o?a.pending=null:(h=h.next,o.next=h,Qg(a,h)))}function Rc(a,o,h){var p=a.pending;if(a.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=h,l0(o),o=o.next;while(o!==p)}a.action=null}function l0(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function Wu(a,o){return o}function Al(a,o){if(Mn){var h=Er.formState;if(h!==null){e:{var p=tn;if(Mn){if(Rr){t:{for(var D=Rr,M=Qr;D.nodeType!==8;){if(!M){D=null;break t}if(D=kl(D.nextSibling),D===null){D=null;break t}}M=D.data,D=M==="F!"||M==="F"?D:null}if(D){Rr=kl(D.nextSibling),p=D.data==="F!";break e}}Fo(p)}p=!1}p&&(o=h[0])}}return h=Di(),h.memoizedState=h.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wu,lastRenderedState:o},h.queue=p,h=FN.bind(null,tn,p),p.dispatch=h,p=zo(!1),M=Kx.bind(null,tn,!1,p.queue),p=Di(),D={state:o,dispatch:null,action:a,pending:null},p.queue=D,h=Kg.bind(null,tn,D,M,h),D.dispatch=h,p.memoizedState=a,[o,h,!1]}function Co(a){var o=Yr();return yo(o,nn,a)}function yo(a,o,h){if(o=Dd(a,o,Wu)[0],a=r0(Pl)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=Ho(o)}catch(oe){throw oe===Nt?He:oe}else p=o;o=Yr();var D=o.queue,M=D.dispatch;return h!==o.memoizedState&&(tn.flags|=2048,Tc(9,{destroy:void 0},o0.bind(null,D,h),null)),[p,M,a]}function o0(a,o){a.action=o}function c0(a){var o=Yr(),h=nn;if(h!==null)return yo(o,h,a);Yr(),o=o.memoizedState,h=Yr();var p=h.queue.dispatch;return h.memoizedState=a,[o,p,!1]}function Tc(a,o,h,p){return a={tag:a,create:h,deps:p,inst:o,next:null},o=tn.updateQueue,o===null&&(o=Bu(),tn.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=a.next=a:(p=h.next,h.next=a,a.next=p,o.lastEffect=a),a}function Yg(){return Yr().memoizedState}function Rd(a,o,h,p){var D=Di();tn.flags|=a,D.memoizedState=Tc(1|o,{destroy:void 0},h,p===void 0?null:p)}function Td(a,o,h,p){var D=Yr();p=p===void 0?null:p;var M=D.memoizedState.inst;nn!==null&&p!==null&&Yf(p,nn.memoizedState.deps)?D.memoizedState=Tc(o,M,h,p):(tn.flags|=a,D.memoizedState=Tc(1|o,M,h,p))}function TN(a,o){Rd(8390656,8,a,o)}function kx(a,o){Td(2048,8,a,o)}function KI(a){tn.flags|=4;var o=tn.updateQueue;if(o===null)o=Bu(),tn.updateQueue=o,o.events=[a];else{var h=o.events;h===null?o.events=[a]:h.push(a)}}function EN(a){var o=Yr().memoizedState;return KI({ref:o,nextImpl:a}),function(){if((ar&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}function jN(a,o){return Td(4,2,a,o)}function IN(a,o){return Td(4,4,a,o)}function ON(a,o){if(typeof o=="function"){a=a();var h=o(a);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function MN(a,o,h){h=h!=null?h.concat([a]):null,Td(4,4,ON.bind(null,o,a),h)}function Ux(){}function LN(a,o){var h=Yr();o=o===void 0?null:o;var p=h.memoizedState;return o!==null&&Yf(o,p[1])?p[0]:(h.memoizedState=[a,o],a)}function wN(a,o){var h=Yr();o=o===void 0?null:o;var p=h.memoizedState;if(o!==null&&Yf(o,p[1]))return p[0];if(p=a(),ha){Ke(!0);try{a()}finally{Ke(!1)}}return h.memoizedState=[p,o],p}function Bx(a,o,h){return h===void 0||(Gr&1073741824)!==0&&(An&261930)===0?a.memoizedState=o:(a.memoizedState=h,a=P2(),tn.lanes|=a,Id|=a,h)}function PN(a,o,h,p){return Li(h,o)?h:Tn.current!==null?(a=Bx(a,h,p),Li(a,o)||(Ri=!0),a):(Gr&42)===0||(Gr&1073741824)!==0&&(An&261930)===0?(Ri=!0,a.memoizedState=h):(a=P2(),tn.lanes|=a,Id|=a,o)}function AN(a,o,h,p,D){var M=F.p;F.p=M!==0&&8>M?M:8;var oe=V.T,Ae={};V.T=Ae,Kx(a,!1,o,h);try{var gt=D(),Gt=V.S;if(Gt!==null&&Gt(Ae,gt),gt!==null&&typeof gt=="object"&&typeof gt.then=="function"){var ns=ve(gt,p);Zf(a,o,ns,Sl(a))}else Zf(a,o,p,Sl(a))}catch(us){Zf(a,o,{then:function(){},status:"rejected",reason:us},Sl())}finally{F.p=M,oe!==null&&Ae.types!==null&&(oe.types=Ae.types),V.T=oe}}function QI(){}function Wx(a,o,h,p){if(a.tag!==5)throw Error(r(476));var D=kN(a).queue;AN(a,D,o,I,h===null?QI:function(){return UN(a),h(p)})}function kN(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:I},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:h},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function UN(a){var o=kN(a);o.next===null&&(o=a.alternate.memoizedState),Zf(a,o.next.queue,{},Sl())}function Fx(){return ki(pm)}function BN(){return Yr().memoizedState}function WN(){return Yr().memoizedState}function GI(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var h=Sl();a=on(h);var p=Nn(o,a,h);p!==null&&(sl(p,o,h),rr(p,o,h)),o={cache:Sd()},a.payload=o;return}o=o.return}}function YI(a,o,h){var p=Sl();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Vg(a)?KN(o,h):(h=Gh(a,o,h,p),h!==null&&(sl(h,a,p),QN(h,o,p)))}function FN(a,o,h){var p=Sl();Zf(a,o,h,p)}function Zf(a,o,h,p){var D={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Vg(a))KN(o,D);else{var M=a.alternate;if(a.lanes===0&&(M===null||M.lanes===0)&&(M=o.lastRenderedReducer,M!==null))try{var oe=o.lastRenderedState,Ae=M(oe,h);if(D.hasEagerState=!0,D.eagerState=Ae,Li(Ae,oe))return Mu(a,o,D,0),Er===null&&Ou(),!1}catch{}finally{}if(h=Gh(a,o,D,p),h!==null)return sl(h,a,p),QN(h,o,p),!0}return!1}function Kx(a,o,h,p){if(p={lane:2,revertLane:y1(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Vg(a)){if(o)throw Error(r(479))}else o=Gh(a,h,p,2),o!==null&&sl(o,a,2)}function Vg(a){var o=a.alternate;return a===tn||o!==null&&o===tn}function KN(a,o){Xa=Ca=!0;var h=a.pending;h===null?o.next=o:(o.next=h.next,h.next=o),a.pending=o}function QN(a,o,h){if((h&4194048)!==0){var p=o.lanes;p&=a.pendingLanes,h|=p,o.lanes=h,lt(a,h)}}var em={readContext:ki,use:vd,useCallback:br,useContext:br,useEffect:br,useImperativeHandle:br,useLayoutEffect:br,useInsertionEffect:br,useMemo:br,useReducer:br,useRef:br,useState:br,useDebugValue:br,useDeferredValue:br,useTransition:br,useSyncExternalStore:br,useId:br,useHostTransitionStatus:br,useFormState:br,useActionState:br,useOptimistic:br,useMemoCache:br,useCacheRefresh:br};em.useEffectEvent=br;var GN={readContext:ki,use:vd,useCallback:function(a,o){return Di().memoizedState=[a,o===void 0?null:o],a},useContext:ki,useEffect:TN,useImperativeHandle:function(a,o,h){h=h!=null?h.concat([a]):null,Rd(4194308,4,ON.bind(null,o,a),h)},useLayoutEffect:function(a,o){return Rd(4194308,4,a,o)},useInsertionEffect:function(a,o){Rd(4,2,a,o)},useMemo:function(a,o){var h=Di();o=o===void 0?null:o;var p=a();if(ha){Ke(!0);try{a()}finally{Ke(!1)}}return h.memoizedState=[p,o],p},useReducer:function(a,o,h){var p=Di();if(h!==void 0){var D=h(o);if(ha){Ke(!0);try{h(o)}finally{Ke(!1)}}}else D=o;return p.memoizedState=p.baseState=D,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:D},p.queue=a,a=a.dispatch=YI.bind(null,tn,a),[p.memoizedState,a]},useRef:function(a){var o=Di();return a={current:a},o.memoizedState=a},useState:function(a){a=zo(a);var o=a.queue,h=FN.bind(null,tn,o);return o.dispatch=h,[a.memoizedState,h]},useDebugValue:Ux,useDeferredValue:function(a,o){var h=Di();return Bx(h,a,o)},useTransition:function(){var a=zo(!1);return a=AN.bind(null,tn,a.queue,!0,!1),Di().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,h){var p=tn,D=Di();if(Mn){if(h===void 0)throw Error(r(407));h=h()}else{if(h=o(),Er===null)throw Error(r(349));(An&127)!==0||xo(p,o,h)}D.memoizedState=h;var M={value:h,getSnapshot:o};return D.queue=M,TN(qf.bind(null,p,M,a),[a]),p.flags|=2048,Tc(9,{destroy:void 0},zf.bind(null,p,M,h,o),null),h},useId:function(){var a=Di(),o=Er.identifierPrefix;if(Mn){var h=za,p=Ha;h=(p&~(1<<32-rt(p)-1)).toString(32)+h,o="_"+o+"R_"+h,h=ci++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=t0++,o="_"+o+"r_"+h.toString(32)+"_";return a.memoizedState=o},useHostTransitionStatus:Fx,useFormState:Al,useActionState:Al,useOptimistic:function(a){var o=Di();o.memoizedState=o.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=Kx.bind(null,tn,!0,h),h.dispatch=o,[a,o]},useMemoCache:Dc,useCacheRefresh:function(){return Di().memoizedState=GI.bind(null,tn)},useEffectEvent:function(a){var o=Di(),h={impl:a};return o.memoizedState=h,function(){if((ar&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}},Qx={readContext:ki,use:vd,useCallback:LN,useContext:ki,useEffect:kx,useImperativeHandle:MN,useInsertionEffect:jN,useLayoutEffect:IN,useMemo:wN,useReducer:r0,useRef:Yg,useState:function(){return r0(Pl)},useDebugValue:Ux,useDeferredValue:function(a,o){var h=Yr();return PN(h,nn.memoizedState,a,o)},useTransition:function(){var a=r0(Pl)[0],o=Yr().memoizedState;return[typeof a=="boolean"?a:Ho(a),o]},useSyncExternalStore:a0,useId:BN,useHostTransitionStatus:Fx,useFormState:Co,useActionState:Co,useOptimistic:function(a,o){var h=Yr();return Fg(h,nn,a,o)},useMemoCache:Dc,useCacheRefresh:WN};Qx.useEffectEvent=EN;var YN={readContext:ki,use:vd,useCallback:LN,useContext:ki,useEffect:kx,useImperativeHandle:MN,useInsertionEffect:jN,useLayoutEffect:IN,useMemo:wN,useReducer:i0,useRef:Yg,useState:function(){return i0(Pl)},useDebugValue:Ux,useDeferredValue:function(a,o){var h=Yr();return nn===null?Bx(h,a,o):PN(h,nn.memoizedState,a,o)},useTransition:function(){var a=i0(Pl)[0],o=Yr().memoizedState;return[typeof a=="boolean"?a:Ho(a),o]},useSyncExternalStore:a0,useId:BN,useHostTransitionStatus:Fx,useFormState:c0,useActionState:c0,useOptimistic:function(a,o){var h=Yr();return nn!==null?Fg(h,nn,a,o):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:Dc,useCacheRefresh:WN};YN.useEffectEvent=EN;function Gx(a,o,h,p){o=a.memoizedState,h=h(p,o),h=h==null?o:_({},o,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var Yx={enqueueSetState:function(a,o,h){a=a._reactInternals;var p=Sl(),D=on(p);D.payload=o,h!=null&&(D.callback=h),o=Nn(a,D,p),o!==null&&(sl(o,a,p),rr(o,a,p))},enqueueReplaceState:function(a,o,h){a=a._reactInternals;var p=Sl(),D=on(p);D.tag=1,D.payload=o,h!=null&&(D.callback=h),o=Nn(a,D,p),o!==null&&(sl(o,a,p),rr(o,a,p))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var h=Sl(),p=on(h);p.tag=2,o!=null&&(p.callback=o),o=Nn(a,p,h),o!==null&&(sl(o,a,h),rr(o,a,h))}};function VN(a,o,h,p,D,M,oe){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,M,oe):o.prototype&&o.prototype.isPureReactComponent?!uo(h,p)||!uo(D,M):!0}function $N(a,o,h,p){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,p),o.state!==a&&Yx.enqueueReplaceState(o,o.state,null)}function Fu(a,o){var h=o;if("ref"in o){h={};for(var p in o)p!=="ref"&&(h[p]=o[p])}if(a=a.defaultProps){h===o&&(h=_({},h));for(var D in a)h[D]===void 0&&(h[D]=a[D])}return h}function HN(a){Iu(a)}function zN(a){console.error(a)}function qN(a){Iu(a)}function $g(a,o){try{var h=a.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function XN(a,o,h){try{var p=a.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function Vx(a,o,h){return h=on(h),h.tag=3,h.payload={element:null},h.callback=function(){$g(a,o)},h}function JN(a){return a=on(a),a.tag=3,a}function ZN(a,o,h,p){var D=h.type.getDerivedStateFromError;if(typeof D=="function"){var M=p.value;a.payload=function(){return D(M)},a.callback=function(){XN(o,h,p)}}var oe=h.stateNode;oe!==null&&typeof oe.componentDidCatch=="function"&&(a.callback=function(){XN(o,h,p),typeof D!="function"&&(Od===null?Od=new Set([this]):Od.add(this));var Ae=p.stack;this.componentDidCatch(p.value,{componentStack:Ae!==null?Ae:""})})}function VI(a,o,h,p,D){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=h.alternate,o!==null&&Go(o,h,D,!0),h=kr.current,h!==null){switch(h.tag){case 31:case 13:return Yn===null?ip():h.alternate===null&&di===0&&(di=3),h.flags&=-257,h.flags|=65536,h.lanes=D,p===Et?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([p]):o.add(p),_1(a,p,D)),!1;case 22:return h.flags|=65536,p===Et?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([p]):h.add(p)),_1(a,p,D)),!1}throw Error(r(435,h.tag))}return _1(a,p,D),ip(),!1}if(Mn)return o=kr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=D,p!==yl&&(a=Error(r(422),{cause:p}),bd(Ya(a,h)))):(p!==yl&&(o=Error(r(423),{cause:p}),bd(Ya(o,h))),a=a.current.alternate,a.flags|=65536,D&=-D,a.lanes|=D,p=Ya(p,h),D=Vx(a.stateNode,p,D),gi(a,D),di!==4&&(di=2)),!1;var M=Error(r(520),{cause:p});if(M=Ya(M,h),om===null?om=[M]:om.push(M),di!==4&&(di=2),o===null)return!0;p=Ya(p,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,a=D&-D,h.lanes|=a,a=Vx(h.stateNode,p,a),gi(h,a),!1;case 1:if(o=h.type,M=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Od===null||!Od.has(M))))return h.flags|=65536,D&=-D,h.lanes|=D,D=JN(D),ZN(D,a,h,p),gi(h,D),!1}h=h.return}while(h!==null);return!1}var $x=Error(r(461)),Ri=!1;function fa(a,o,h,p){o.child=a===null?Cn(o,null,h,p):Tr(o,a.child,h,p)}function e2(a,o,h,p,D){h=h.render;var M=o.ref;if("ref"in p){var oe={};for(var Ae in p)Ae!=="ref"&&(oe[Ae]=p[Ae])}else oe=p;return Yo(o),p=Vf(a,o,h,oe,M,D),Ae=$f(),a!==null&&!Ri?(Hf(a,o,D),Ec(a,o,D)):(Mn&&Ae&&Kf(o),o.flags|=1,fa(a,o,p,D),o.child)}function t2(a,o,h,p,D){if(a===null){var M=h.type;return typeof M=="function"&&!Vh(M)&&M.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=M,s2(a,o,M,p,D)):(a=xd(h.type,null,p,o,o.mode,D),a.ref=o.ref,a.return=o,o.child=a)}if(M=a.child,!t1(a,D)){var oe=M.memoizedProps;if(h=h.compare,h=h!==null?h:uo,h(oe,p)&&a.ref===o.ref)return Ec(a,o,D)}return o.flags|=1,a=Ga(M,p),a.ref=o.ref,a.return=o,o.child=a}function s2(a,o,h,p,D){if(a!==null){var M=a.memoizedProps;if(uo(M,p)&&a.ref===o.ref)if(Ri=!1,o.pendingProps=p=M,t1(a,D))(a.flags&131072)!==0&&(Ri=!0);else return o.lanes=a.lanes,Ec(a,o,D)}return Hx(a,o,h,p,D)}function n2(a,o,h,p){var D=p.children,M=a!==null?a.memoizedState:null;if(a===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((o.flags&128)!==0){if(M=M!==null?M.baseLanes|h:h,a!==null){for(p=o.child=a.child,D=0;p!==null;)D=D|p.lanes|p.childLanes,p=p.sibling;p=D&~M}else p=0,o.child=null;return r2(a,o,M,h,p)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&Ge(o,M!==null?M.cachePool:null),M!==null?Ar(o,M):qn(),li(o);else return p=o.lanes=536870912,r2(a,o,M!==null?M.baseLanes|h:h,h,p)}else M!==null?(Ge(o,M.cachePool),Ar(o,M),oi(),o.memoizedState=null):(a!==null&&Ge(o,null),qn(),oi());return fa(a,o,D,h),o.child}function tm(a,o){return a!==null&&a.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function r2(a,o,h,p,D){var M=Fe();return M=M===null?null:{parent:ti._currentValue,pool:M},o.memoizedState={baseLanes:h,cachePool:M},a!==null&&Ge(o,null),qn(),li(o),a!==null&&Go(a,o,p,!0),o.childLanes=D,null}function Hg(a,o){return o=qg({mode:o.mode,children:o.children},a.mode),o.ref=a.ref,a.child=o,o.return=a,o}function i2(a,o,h){return Tr(o,a.child,null,h),a=Hg(o,o.pendingProps),a.flags|=2,hr(o),o.memoizedState=null,a}function $I(a,o,h){var p=o.pendingProps,D=(o.flags&128)!==0;if(o.flags&=-129,a===null){if(Mn){if(p.mode==="hidden")return a=Hg(o,p),o.lanes=536870912,tm(null,a);if(ir(o),(a=Rr)?(a=_S(a,Qr),a=a!==null&&a.data==="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:Wo!==null?{id:Ha,overflow:za}:null,retryLane:536870912,hydrationErrors:null},h=$h(a),h.return=o,o.child=h,Pi=o,Rr=null)):a=null,a===null)throw Fo(o);return o.lanes=536870912,null}return Hg(o,p)}var M=a.memoizedState;if(M!==null){var oe=M.dehydrated;if(ir(o),D)if(o.flags&256)o.flags&=-257,o=i2(a,o,h);else if(o.memoizedState!==null)o.child=a.child,o.flags|=128,o=null;else throw Error(r(558));else if(Ri||Go(a,o,h,!1),D=(h&a.childLanes)!==0,Ri||D){if(p=Er,p!==null&&(oe=ut(p,h),oe!==0&&oe!==M.retryLane))throw M.retryLane=oe,go(a,oe),sl(p,a,oe),$x;ip(),o=i2(a,o,h)}else a=M.treeContext,Rr=kl(oe.nextSibling),Pi=o,Mn=!0,ua=null,Qr=!1,a!==null&&Ug(o,a),o=Hg(o,p),o.flags|=4096;return o}return a=Ga(a.child,{mode:p.mode,children:p.children}),a.ref=o.ref,o.child=a,a.return=o,a}function zg(a,o){var h=o.ref;if(h===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(a===null||a.ref!==h)&&(o.flags|=4194816)}}function Hx(a,o,h,p,D){return Yo(o),h=Vf(a,o,h,p,void 0,D),p=$f(),a!==null&&!Ri?(Hf(a,o,D),Ec(a,o,D)):(Mn&&p&&Kf(o),o.flags|=1,fa(a,o,h,D),o.child)}function a2(a,o,h,p,D,M){return Yo(o),o.updateQueue=null,h=_o(o,p,h,D),s0(a),p=$f(),a!==null&&!Ri?(Hf(a,o,M),Ec(a,o,M)):(Mn&&p&&Kf(o),o.flags|=1,fa(a,o,h,M),o.child)}function l2(a,o,h,p,D){if(Yo(o),o.stateNode===null){var M=wi,oe=h.contextType;typeof oe=="object"&&oe!==null&&(M=ki(oe)),M=new h(p,M),o.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Yx,o.stateNode=M,M._reactInternals=o,M=o.stateNode,M.props=p,M.state=o.memoizedState,M.refs={},Ts(o),oe=h.contextType,M.context=typeof oe=="object"&&oe!==null?ki(oe):wi,M.state=o.memoizedState,oe=h.getDerivedStateFromProps,typeof oe=="function"&&(Gx(o,h,oe,p),M.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(oe=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),oe!==M.state&&Yx.enqueueReplaceState(M,M.state,null),ii(o,p,M,D),yr(),M.state=o.memoizedState),typeof M.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(a===null){M=o.stateNode;var Ae=o.memoizedProps,gt=Fu(h,Ae);M.props=gt;var Gt=M.context,ns=h.contextType;oe=wi,typeof ns=="object"&&ns!==null&&(oe=ki(ns));var us=h.getDerivedStateFromProps;ns=typeof us=="function"||typeof M.getSnapshotBeforeUpdate=="function",Ae=o.pendingProps!==Ae,ns||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(Ae||Gt!==oe)&&$N(o,M,p,oe),Ws=!1;var Vt=o.memoizedState;M.state=Vt,ii(o,p,M,D),yr(),Gt=o.memoizedState,Ae||Vt!==Gt||Ws?(typeof us=="function"&&(Gx(o,h,us,p),Gt=o.memoizedState),(gt=Ws||VN(o,h,gt,p,Vt,Gt,oe))?(ns||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(o.flags|=4194308)):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=Gt),M.props=p,M.state=Gt,M.context=oe,p=gt):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{M=o.stateNode,Pr(a,o),oe=o.memoizedProps,ns=Fu(h,oe),M.props=ns,us=o.pendingProps,Vt=M.context,Gt=h.contextType,gt=wi,typeof Gt=="object"&&Gt!==null&&(gt=ki(Gt)),Ae=h.getDerivedStateFromProps,(Gt=typeof Ae=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(oe!==us||Vt!==gt)&&$N(o,M,p,gt),Ws=!1,Vt=o.memoizedState,M.state=Vt,ii(o,p,M,D),yr();var zt=o.memoizedState;oe!==us||Vt!==zt||Ws||a!==null&&a.dependencies!==null&&Jh(a.dependencies)?(typeof Ae=="function"&&(Gx(o,h,Ae,p),zt=o.memoizedState),(ns=Ws||VN(o,h,ns,p,Vt,zt,gt)||a!==null&&a.dependencies!==null&&Jh(a.dependencies))?(Gt||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(p,zt,gt),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(p,zt,gt)),typeof M.componentDidUpdate=="function"&&(o.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof M.componentDidUpdate!="function"||oe===a.memoizedProps&&Vt===a.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||oe===a.memoizedProps&&Vt===a.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=zt),M.props=p,M.state=zt,M.context=gt,p=ns):(typeof M.componentDidUpdate!="function"||oe===a.memoizedProps&&Vt===a.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||oe===a.memoizedProps&&Vt===a.memoizedState||(o.flags|=1024),p=!1)}return M=p,zg(a,o),p=(o.flags&128)!==0,M||p?(M=o.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:M.render(),o.flags|=1,a!==null&&p?(o.child=Tr(o,a.child,null,D),o.child=Tr(o,null,h,D)):fa(a,o,h,D),o.memoizedState=M.state,a=o.child):a=Ec(a,o,D),a}function o2(a,o,h,p){return Sc(),o.flags|=256,fa(a,o,h,p),o.child}var zx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qx(a){return{baseLanes:a,cachePool:qe()}}function Xx(a,o,h){return a=a!==null?a.childLanes&~h:0,o&&(a|=Nl),a}function c2(a,o,h){var p=o.pendingProps,D=!1,M=(o.flags&128)!==0,oe;if((oe=M)||(oe=a!==null&&a.memoizedState===null?!1:(Fn.current&2)!==0),oe&&(D=!0,o.flags&=-129),oe=(o.flags&32)!==0,o.flags&=-33,a===null){if(Mn){if(D?si(o):oi(),(a=Rr)?(a=_S(a,Qr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:Wo!==null?{id:Ha,overflow:za}:null,retryLane:536870912,hydrationErrors:null},h=$h(a),h.return=o,o.child=h,Pi=o,Rr=null)):a=null,a===null)throw Fo(o);return L1(a)?o.lanes=32:o.lanes=536870912,null}var Ae=p.children;return p=p.fallback,D?(oi(),D=o.mode,Ae=qg({mode:"hidden",children:Ae},D),p=Bo(p,D,h,null),Ae.return=o,p.return=o,Ae.sibling=p,o.child=Ae,p=o.child,p.memoizedState=qx(h),p.childLanes=Xx(a,oe,h),o.memoizedState=zx,tm(null,p)):(si(o),Jx(o,Ae))}var gt=a.memoizedState;if(gt!==null&&(Ae=gt.dehydrated,Ae!==null)){if(M)o.flags&256?(si(o),o.flags&=-257,o=Zx(a,o,h)):o.memoizedState!==null?(oi(),o.child=a.child,o.flags|=128,o=null):(oi(),Ae=p.fallback,D=o.mode,p=qg({mode:"visible",children:p.children},D),Ae=Bo(Ae,D,h,null),Ae.flags|=2,p.return=o,Ae.return=o,p.sibling=Ae,o.child=p,Tr(o,a.child,null,h),p=o.child,p.memoizedState=qx(h),p.childLanes=Xx(a,oe,h),o.memoizedState=zx,o=tm(null,p));else if(si(o),L1(Ae)){if(oe=Ae.nextSibling&&Ae.nextSibling.dataset,oe)var Gt=oe.dgst;oe=Gt,p=Error(r(419)),p.stack="",p.digest=oe,bd({value:p,source:null,stack:null}),o=Zx(a,o,h)}else if(Ri||Go(a,o,h,!1),oe=(h&a.childLanes)!==0,Ri||oe){if(oe=Er,oe!==null&&(p=ut(oe,h),p!==0&&p!==gt.retryLane))throw gt.retryLane=p,go(a,p),sl(oe,a,p),$x;M1(Ae)||ip(),o=Zx(a,o,h)}else M1(Ae)?(o.flags|=192,o.child=a.child,o=null):(a=gt.treeContext,Rr=kl(Ae.nextSibling),Pi=o,Mn=!0,ua=null,Qr=!1,a!==null&&Ug(o,a),o=Jx(o,p.children),o.flags|=4096);return o}return D?(oi(),Ae=p.fallback,D=o.mode,gt=a.child,Gt=gt.sibling,p=Ga(gt,{mode:"hidden",children:p.children}),p.subtreeFlags=gt.subtreeFlags&65011712,Gt!==null?Ae=Ga(Gt,Ae):(Ae=Bo(Ae,D,h,null),Ae.flags|=2),Ae.return=o,p.return=o,p.sibling=Ae,o.child=p,tm(null,p),p=o.child,Ae=a.child.memoizedState,Ae===null?Ae=qx(h):(D=Ae.cachePool,D!==null?(gt=ti._currentValue,D=D.parent!==gt?{parent:gt,pool:gt}:D):D=qe(),Ae={baseLanes:Ae.baseLanes|h,cachePool:D}),p.memoizedState=Ae,p.childLanes=Xx(a,oe,h),o.memoizedState=zx,tm(a.child,p)):(si(o),h=a.child,a=h.sibling,h=Ga(h,{mode:"visible",children:p.children}),h.return=o,h.sibling=null,a!==null&&(oe=o.deletions,oe===null?(o.deletions=[a],o.flags|=16):oe.push(a)),o.child=h,o.memoizedState=null,h)}function Jx(a,o){return o=qg({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function qg(a,o){return a=Ji(22,a,null,o),a.lanes=0,a}function Zx(a,o,h){return Tr(o,a.child,null,h),a=Jx(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function d2(a,o,h){a.lanes|=o;var p=a.alternate;p!==null&&(p.lanes|=o),Nd(a.return,o,h)}function e1(a,o,h,p,D,M){var oe=a.memoizedState;oe===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:D,treeForkCount:M}:(oe.isBackwards=o,oe.rendering=null,oe.renderingStartTime=0,oe.last=p,oe.tail=h,oe.tailMode=D,oe.treeForkCount=M)}function u2(a,o,h){var p=o.pendingProps,D=p.revealOrder,M=p.tail;p=p.children;var oe=Fn.current,Ae=(oe&2)!==0;if(Ae?(oe=oe&1|2,o.flags|=128):oe&=1,k(Fn,oe),fa(a,o,p,h),p=Mn?Au:0,!Ae&&a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&d2(a,h,o);else if(a.tag===19)d2(a,h,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(D){case"forwards":for(h=o.child,D=null;h!==null;)a=h.alternate,a!==null&&ea(a)===null&&(D=h),h=h.sibling;h=D,h===null?(D=o.child,o.child=null):(D=h.sibling,h.sibling=null),e1(o,!1,D,h,M,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,D=o.child,o.child=null;D!==null;){if(a=D.alternate,a!==null&&ea(a)===null){o.child=D;break}a=D.sibling,D.sibling=h,h=D,D=a}e1(o,!0,h,null,M,p);break;case"together":e1(o,!1,null,null,void 0,p);break;default:o.memoizedState=null}return o.child}function Ec(a,o,h){if(a!==null&&(o.dependencies=a.dependencies),Id|=o.lanes,(h&o.childLanes)===0)if(a!==null){if(Go(a,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(r(153));if(o.child!==null){for(a=o.child,h=Ga(a,a.pendingProps),o.child=h,h.return=o;a.sibling!==null;)a=a.sibling,h=h.sibling=Ga(a,a.pendingProps),h.return=o;h.sibling=null}return o.child}function t1(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&Jh(a)))}function HI(a,o,h){switch(o.tag){case 3:fe(o,o.stateNode.containerInfo),Qo(o,ti,a.memoizedState.cache),Sc();break;case 27:case 5:de(o);break;case 4:fe(o,o.stateNode.containerInfo);break;case 10:Qo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,ir(o),null;break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(si(o),o.flags|=128,null):(h&o.child.childLanes)!==0?c2(a,o,h):(si(o),a=Ec(a,o,h),a!==null?a.sibling:null);si(o);break;case 19:var D=(a.flags&128)!==0;if(p=(h&o.childLanes)!==0,p||(Go(a,o,h,!1),p=(h&o.childLanes)!==0),D){if(p)return u2(a,o,h);o.flags|=128}if(D=o.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),k(Fn,Fn.current),p)break;return null;case 22:return o.lanes=0,n2(a,o,h,o.pendingProps);case 24:Qo(o,ti,a.memoizedState.cache)}return Ec(a,o,h)}function h2(a,o,h){if(a!==null)if(a.memoizedProps!==o.pendingProps)Ri=!0;else{if(!t1(a,h)&&(o.flags&128)===0)return Ri=!1,HI(a,o,h);Ri=(a.flags&131072)!==0}else Ri=!1,Mn&&(o.flags&1048576)!==0&&kg(o,Au,o.index);switch(o.lanes=0,o.tag){case 16:e:{var p=o.pendingProps;if(a=kt(o.elementType),o.type=a,typeof a=="function")Vh(a)?(p=Fu(a,p),o.tag=1,o=l2(null,o,a,p,h)):(o.tag=0,o=Hx(null,o,a,p,h));else{if(a!=null){var D=a.$$typeof;if(D===w){o.tag=11,o=e2(null,o,a,p,h);break e}else if(D===K){o.tag=14,o=t2(null,o,a,p,h);break e}}throw o=J(a)||a,Error(r(306,o,""))}}return o;case 0:return Hx(a,o,o.type,o.pendingProps,h);case 1:return p=o.type,D=Fu(p,o.pendingProps),l2(a,o,p,D,h);case 3:e:{if(fe(o,o.stateNode.containerInfo),a===null)throw Error(r(387));p=o.pendingProps;var M=o.memoizedState;D=M.element,Pr(a,o),ii(o,p,null,h);var oe=o.memoizedState;if(p=oe.cache,Qo(o,ti,p),p!==M.cache&&vc(o,[ti],h,!0),yr(),p=oe.element,M.isDehydrated)if(M={element:p,isDehydrated:!1,cache:oe.cache},o.updateQueue.baseState=M,o.memoizedState=M,o.flags&256){o=o2(a,o,p,h);break e}else if(p!==D){D=Ya(Error(r(424)),o),bd(D),o=o2(a,o,p,h);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Rr=kl(a.firstChild),Pi=o,Mn=!0,ua=null,Qr=!0,h=Cn(o,null,p,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Sc(),p===D){o=Ec(a,o,h);break e}fa(a,o,p,h)}o=o.child}return o;case 26:return zg(a,o),a===null?(h=SS(o.type,null,o.pendingProps,null))?o.memoizedState=h:Mn||(h=o.type,a=o.pendingProps,p=hp($.current).createElement(h),p[ls]=o,p[ds]=a,ma(p,h,a),Oe(p),o.stateNode=p):o.memoizedState=SS(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return de(o),a===null&&Mn&&(p=o.stateNode=yS(o.type,o.pendingProps,$.current),Pi=o,Qr=!0,D=Rr,Pd(o.type)?(w1=D,Rr=kl(p.firstChild)):Rr=D),fa(a,o,o.pendingProps.children,h),zg(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&Mn&&((D=p=Rr)&&(p=vO(p,o.type,o.pendingProps,Qr),p!==null?(o.stateNode=p,Pi=o,Rr=kl(p.firstChild),Qr=!1,D=!0):D=!1),D||Fo(o)),de(o),D=o.type,M=o.pendingProps,oe=a!==null?a.memoizedProps:null,p=M.children,j1(D,M)?p=null:oe!==null&&j1(D,oe)&&(o.flags|=32),o.memoizedState!==null&&(D=Vf(a,o,Ax,null,null,h),pm._currentValue=D),zg(a,o),fa(a,o,p,h),o.child;case 6:return a===null&&Mn&&((a=h=Rr)&&(h=DO(h,o.pendingProps,Qr),h!==null?(o.stateNode=h,Pi=o,Rr=null,a=!0):a=!1),a||Fo(o)),null;case 13:return c2(a,o,h);case 4:return fe(o,o.stateNode.containerInfo),p=o.pendingProps,a===null?o.child=Tr(o,null,p,h):fa(a,o,p,h),o.child;case 11:return e2(a,o,o.type,o.pendingProps,h);case 7:return fa(a,o,o.pendingProps,h),o.child;case 8:return fa(a,o,o.pendingProps.children,h),o.child;case 12:return fa(a,o,o.pendingProps.children,h),o.child;case 10:return p=o.pendingProps,Qo(o,o.type,p.value),fa(a,o,p.children,h),o.child;case 9:return D=o.type._context,p=o.pendingProps.children,Yo(o),D=ki(D),p=p(D),o.flags|=1,fa(a,o,p,h),o.child;case 14:return t2(a,o,o.type,o.pendingProps,h);case 15:return s2(a,o,o.type,o.pendingProps,h);case 19:return u2(a,o,h);case 31:return $I(a,o,h);case 22:return n2(a,o,h,o.pendingProps);case 24:return Yo(o),p=ki(ti),a===null?(D=Fe(),D===null&&(D=Er,M=Sd(),D.pooledCache=M,M.refCount++,M!==null&&(D.pooledCacheLanes|=h),D=M),o.memoizedState={parent:p,cache:D},Ts(o),Qo(o,ti,D)):((a.lanes&h)!==0&&(Pr(a,o),ii(o,null,null,h),yr()),D=a.memoizedState,M=o.memoizedState,D.parent!==p?(D={parent:p,cache:p},o.memoizedState=D,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=D),Qo(o,ti,p)):(p=M.cache,Qo(o,ti,p),p!==D.cache&&vc(o,[ti],h,!0))),fa(a,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function jc(a){a.flags|=4}function s1(a,o,h,p,D){if((o=(a.mode&32)!==0)&&(o=!1),o){if(a.flags|=16777216,(D&335544128)===D)if(a.stateNode.complete)a.flags|=8192;else if(B2())a.flags|=8192;else throw Jt=Et,Wt}else a.flags&=-16777217}function f2(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!ES(o))if(B2())a.flags|=8192;else throw Jt=Et,Wt}function Xg(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?Le():536870912,a.lanes|=o,f0|=o)}function sm(a,o){if(!Mn)switch(a.tailMode){case"hidden":o=a.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function Ur(a){var o=a.alternate!==null&&a.alternate.child===a.child,h=0,p=0;if(o)for(var D=a.child;D!==null;)h|=D.lanes|D.childLanes,p|=D.subtreeFlags&65011712,p|=D.flags&65011712,D.return=a,D=D.sibling;else for(D=a.child;D!==null;)h|=D.lanes|D.childLanes,p|=D.subtreeFlags,p|=D.flags,D.return=a,D=D.sibling;return a.subtreeFlags|=p,a.childLanes=h,o}function zI(a,o,h){var p=o.pendingProps;switch(qh(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ur(o),null;case 1:return Ur(o),null;case 3:return h=o.stateNode,p=null,a!==null&&(p=a.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),qa(ti),pe(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(Ai(o)?jc(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Gf())),Ur(o),null;case 26:var D=o.type,M=o.memoizedState;return a===null?(jc(o),M!==null?(Ur(o),f2(o,M)):(Ur(o),s1(o,D,null,p,h))):M?M!==a.memoizedState?(jc(o),Ur(o),f2(o,M)):(Ur(o),o.flags&=-16777217):(a=a.memoizedProps,a!==p&&jc(o),Ur(o),s1(o,D,a,p,h)),null;case 27:if(Re(o),h=$.current,D=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==p&&jc(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return Ur(o),null}a=Q.current,Ai(o)?Qf(o):(a=yS(D,p,h),o.stateNode=a,jc(o))}return Ur(o),null;case 5:if(Re(o),D=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==p&&jc(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return Ur(o),null}if(M=Q.current,Ai(o))Qf(o);else{var oe=hp($.current);switch(M){case 1:M=oe.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:M=oe.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":M=oe.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":M=oe.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":M=oe.createElement("div"),M.innerHTML="<script><\/script>",M=M.removeChild(M.firstChild);break;case"select":M=typeof p.is=="string"?oe.createElement("select",{is:p.is}):oe.createElement("select"),p.multiple?M.multiple=!0:p.size&&(M.size=p.size);break;default:M=typeof p.is=="string"?oe.createElement(D,{is:p.is}):oe.createElement(D)}}M[ls]=o,M[ds]=p;e:for(oe=o.child;oe!==null;){if(oe.tag===5||oe.tag===6)M.appendChild(oe.stateNode);else if(oe.tag!==4&&oe.tag!==27&&oe.child!==null){oe.child.return=oe,oe=oe.child;continue}if(oe===o)break e;for(;oe.sibling===null;){if(oe.return===null||oe.return===o)break e;oe=oe.return}oe.sibling.return=oe.return,oe=oe.sibling}o.stateNode=M;e:switch(ma(M,D,p),D){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&jc(o)}}return Ur(o),s1(o,o.type,a===null?null:a.memoizedProps,o.pendingProps,h),null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==p&&jc(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(a=$.current,Ai(o)){if(a=o.stateNode,h=o.memoizedProps,p=null,D=Pi,D!==null)switch(D.tag){case 27:case 5:p=D.memoizedProps}a[ls]=o,a=!!(a.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||cS(a.nodeValue,h)),a||Fo(o,!0)}else a=hp(a).createTextNode(p),a[ls]=o,o.stateNode=a}return Ur(o),null;case 31:if(h=o.memoizedState,a===null||a.memoizedState!==null){if(p=Ai(o),h!==null){if(a===null){if(!p)throw Error(r(318));if(a=o.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[ls]=o}else Sc(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ur(o),a=!1}else h=Gf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return o.flags&256?(hr(o),o):(hr(o),null);if((o.flags&128)!==0)throw Error(r(558))}return Ur(o),null;case 13:if(p=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(D=Ai(o),p!==null&&p.dehydrated!==null){if(a===null){if(!D)throw Error(r(318));if(D=o.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(r(317));D[ls]=o}else Sc(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ur(o),D=!1}else D=Gf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=D),D=!0;if(!D)return o.flags&256?(hr(o),o):(hr(o),null)}return hr(o),(o.flags&128)!==0?(o.lanes=h,o):(h=p!==null,a=a!==null&&a.memoizedState!==null,h&&(p=o.child,D=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(D=p.alternate.memoizedState.cachePool.pool),M=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(M=p.memoizedState.cachePool.pool),M!==D&&(p.flags|=2048)),h!==a&&h&&(o.child.flags|=8192),Xg(o,o.updateQueue),Ur(o),null);case 4:return pe(),a===null&&v1(o.stateNode.containerInfo),Ur(o),null;case 10:return qa(o.type),Ur(o),null;case 19:if(j(Fn),p=o.memoizedState,p===null)return Ur(o),null;if(D=(o.flags&128)!==0,M=p.rendering,M===null)if(D)sm(p,!1);else{if(di!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(M=ea(a),M!==null){for(o.flags|=128,sm(p,!1),a=M.updateQueue,o.updateQueue=a,Xg(o,a),o.subtreeFlags=0,a=h,h=o.child;h!==null;)wu(h,a),h=h.sibling;return k(Fn,Fn.current&1|2),Mn&&Oa(o,p.treeForkCount),o.child}a=a.sibling}p.tail!==null&&et()>sp&&(o.flags|=128,D=!0,sm(p,!1),o.lanes=4194304)}else{if(!D)if(a=ea(M),a!==null){if(o.flags|=128,D=!0,a=a.updateQueue,o.updateQueue=a,Xg(o,a),sm(p,!0),p.tail===null&&p.tailMode==="hidden"&&!M.alternate&&!Mn)return Ur(o),null}else 2*et()-p.renderingStartTime>sp&&h!==536870912&&(o.flags|=128,D=!0,sm(p,!1),o.lanes=4194304);p.isBackwards?(M.sibling=o.child,o.child=M):(a=p.last,a!==null?a.sibling=M:o.child=M,p.last=M)}return p.tail!==null?(a=p.tail,p.rendering=a,p.tail=a.sibling,p.renderingStartTime=et(),a.sibling=null,h=Fn.current,k(Fn,D?h&1|2:h&1),Mn&&Oa(o,p.treeForkCount),a):(Ur(o),null);case 22:case 23:return hr(o),pi(),p=o.memoizedState!==null,a!==null?a.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(h&536870912)!==0&&(o.flags&128)===0&&(Ur(o),o.subtreeFlags&6&&(o.flags|=8192)):Ur(o),h=o.updateQueue,h!==null&&Xg(o,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==h&&(o.flags|=2048),a!==null&&j(we),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),qa(ti),Ur(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function qI(a,o){switch(qh(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return qa(ti),pe(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return Re(o),null;case 31:if(o.memoizedState!==null){if(hr(o),o.alternate===null)throw Error(r(340));Sc()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 13:if(hr(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Sc()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return j(Fn),null;case 4:return pe(),null;case 10:return qa(o.type),null;case 22:case 23:return hr(o),pi(),a!==null&&j(we),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return qa(ti),null;case 25:return null;default:return null}}function m2(a,o){switch(qh(o),o.tag){case 3:qa(ti),pe();break;case 26:case 27:case 5:Re(o);break;case 4:pe();break;case 31:o.memoizedState!==null&&hr(o);break;case 13:hr(o);break;case 19:j(Fn);break;case 10:qa(o.type);break;case 22:case 23:hr(o),pi(),a!==null&&j(we);break;case 24:qa(ti)}}function nm(a,o){try{var h=o.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var D=p.next;h=D;do{if((h.tag&a)===a){p=void 0;var M=h.create,oe=h.inst;p=M(),oe.destroy=p}h=h.next}while(h!==D)}}catch(Ae){mr(o,o.return,Ae)}}function Ed(a,o,h){try{var p=o.updateQueue,D=p!==null?p.lastEffect:null;if(D!==null){var M=D.next;p=M;do{if((p.tag&a)===a){var oe=p.inst,Ae=oe.destroy;if(Ae!==void 0){oe.destroy=void 0,D=o;var gt=h,Gt=Ae;try{Gt()}catch(ns){mr(D,gt,ns)}}}p=p.next}while(p!==M)}}catch(ns){mr(o,o.return,ns)}}function g2(a){var o=a.updateQueue;if(o!==null){var h=a.stateNode;try{ai(o,h)}catch(p){mr(a,a.return,p)}}}function p2(a,o,h){h.props=Fu(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(p){mr(a,o,p)}}function rm(a,o){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var p=a.stateNode;break;case 30:p=a.stateNode;break;default:p=a.stateNode}typeof h=="function"?a.refCleanup=h(p):h.current=p}}catch(D){mr(a,o,D)}}function qo(a,o){var h=a.ref,p=a.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(D){mr(a,o,D)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(D){mr(a,o,D)}else h.current=null}function _2(a){var o=a.type,h=a.memoizedProps,p=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(D){mr(a,a.return,D)}}function n1(a,o,h){try{var p=a.stateNode;xO(p,a.type,h,o),p[ds]=o}catch(D){mr(a,a.return,D)}}function x2(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Pd(a.type)||a.tag===4}function r1(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||x2(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Pd(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function i1(a,o,h){var p=a.tag;if(p===5||p===6)a=a.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(a),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=hs));else if(p!==4&&(p===27&&Pd(a.type)&&(h=a.stateNode,o=null),a=a.child,a!==null))for(i1(a,o,h),a=a.sibling;a!==null;)i1(a,o,h),a=a.sibling}function Jg(a,o,h){var p=a.tag;if(p===5||p===6)a=a.stateNode,o?h.insertBefore(a,o):h.appendChild(a);else if(p!==4&&(p===27&&Pd(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(Jg(a,o,h),a=a.sibling;a!==null;)Jg(a,o,h),a=a.sibling}function C2(a){var o=a.stateNode,h=a.memoizedProps;try{for(var p=a.type,D=o.attributes;D.length;)o.removeAttributeNode(D[0]);ma(o,p,h),o[ls]=a,o[ds]=h}catch(M){mr(a,a.return,M)}}var Ic=!1,Ti=!1,a1=!1,y2=typeof WeakSet=="function"?WeakSet:Set,ta=null;function XI(a,o){if(a=a.containerInfo,T1=Cp,a=fo(a),Ml(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var D=p.anchorOffset,M=p.focusNode;p=p.focusOffset;try{h.nodeType,M.nodeType}catch{h=null;break e}var oe=0,Ae=-1,gt=-1,Gt=0,ns=0,us=a,Vt=null;t:for(;;){for(var zt;us!==h||D!==0&&us.nodeType!==3||(Ae=oe+D),us!==M||p!==0&&us.nodeType!==3||(gt=oe+p),us.nodeType===3&&(oe+=us.nodeValue.length),(zt=us.firstChild)!==null;)Vt=us,us=zt;for(;;){if(us===a)break t;if(Vt===h&&++Gt===D&&(Ae=oe),Vt===M&&++ns===p&&(gt=oe),(zt=us.nextSibling)!==null)break;us=Vt,Vt=us.parentNode}us=zt}h=Ae===-1||gt===-1?null:{start:Ae,end:gt}}else h=null}h=h||{start:0,end:0}}else h=null;for(E1={focusedElem:a,selectionRange:h},Cp=!1,ta=o;ta!==null;)if(o=ta,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,ta=a;else for(;ta!==null;){switch(o=ta,M=o.alternate,a=o.flags,o.tag){case 0:if((a&4)!==0&&(a=o.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)D=a[h],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&M!==null){a=void 0,h=o,D=M.memoizedProps,M=M.memoizedState,p=h.stateNode;try{var Vs=Fu(h.type,D);a=p.getSnapshotBeforeUpdate(Vs,M),p.__reactInternalSnapshotBeforeUpdate=a}catch(dn){mr(h,h.return,dn)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,h=a.nodeType,h===9)O1(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":O1(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=o.sibling,a!==null){a.return=o.return,ta=a;break}ta=o.return}}function b2(a,o,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Mc(a,h),p&4&&nm(5,h);break;case 1:if(Mc(a,h),p&4)if(a=h.stateNode,o===null)try{a.componentDidMount()}catch(oe){mr(h,h.return,oe)}else{var D=Fu(h.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(D,o,a.__reactInternalSnapshotBeforeUpdate)}catch(oe){mr(h,h.return,oe)}}p&64&&g2(h),p&512&&rm(h,h.return);break;case 3:if(Mc(a,h),p&64&&(a=h.updateQueue,a!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{ai(a,o)}catch(oe){mr(h,h.return,oe)}}break;case 27:o===null&&p&4&&C2(h);case 26:case 5:Mc(a,h),o===null&&p&4&&_2(h),p&512&&rm(h,h.return);break;case 12:Mc(a,h);break;case 31:Mc(a,h),p&4&&v2(a,h);break;case 13:Mc(a,h),p&4&&D2(a,h),p&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=aO.bind(null,h),RO(a,h))));break;case 22:if(p=h.memoizedState!==null||Ic,!p){o=o!==null&&o.memoizedState!==null||Ti,D=Ic;var M=Ti;Ic=p,(Ti=o)&&!M?Lc(a,h,(h.subtreeFlags&8772)!==0):Mc(a,h),Ic=D,Ti=M}break;case 30:break;default:Mc(a,h)}}function N2(a){var o=a.alternate;o!==null&&(a.alternate=null,N2(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&ht(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Vr=null,Ja=!1;function Oc(a,o,h){for(h=h.child;h!==null;)S2(a,o,h),h=h.sibling}function S2(a,o,h){if(dt&&typeof dt.onCommitFiberUnmount=="function")try{dt.onCommitFiberUnmount(ze,h)}catch{}switch(h.tag){case 26:Ti||qo(h,o),Oc(a,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ti||qo(h,o);var p=Vr,D=Ja;Pd(h.type)&&(Vr=h.stateNode,Ja=!1),Oc(a,o,h),fm(h.stateNode),Vr=p,Ja=D;break;case 5:Ti||qo(h,o);case 6:if(p=Vr,D=Ja,Vr=null,Oc(a,o,h),Vr=p,Ja=D,Vr!==null)if(Ja)try{(Vr.nodeType===9?Vr.body:Vr.nodeName==="HTML"?Vr.ownerDocument.body:Vr).removeChild(h.stateNode)}catch(M){mr(h,o,M)}else try{Vr.removeChild(h.stateNode)}catch(M){mr(h,o,M)}break;case 18:Vr!==null&&(Ja?(a=Vr,gS(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),b0(a)):gS(Vr,h.stateNode));break;case 4:p=Vr,D=Ja,Vr=h.stateNode.containerInfo,Ja=!0,Oc(a,o,h),Vr=p,Ja=D;break;case 0:case 11:case 14:case 15:Ed(2,h,o),Ti||Ed(4,h,o),Oc(a,o,h);break;case 1:Ti||(qo(h,o),p=h.stateNode,typeof p.componentWillUnmount=="function"&&p2(h,o,p)),Oc(a,o,h);break;case 21:Oc(a,o,h);break;case 22:Ti=(p=Ti)||h.memoizedState!==null,Oc(a,o,h),Ti=p;break;default:Oc(a,o,h)}}function v2(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{b0(a)}catch(h){mr(o,o.return,h)}}}function D2(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{b0(a)}catch(h){mr(o,o.return,h)}}function JI(a){switch(a.tag){case 31:case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new y2),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new y2),o;default:throw Error(r(435,a.tag))}}function Zg(a,o){var h=JI(a);o.forEach(function(p){if(!h.has(p)){h.add(p);var D=lO.bind(null,a,p);p.then(D,D)}})}function Za(a,o){var h=o.deletions;if(h!==null)for(var p=0;p<h.length;p++){var D=h[p],M=a,oe=o,Ae=oe;e:for(;Ae!==null;){switch(Ae.tag){case 27:if(Pd(Ae.type)){Vr=Ae.stateNode,Ja=!1;break e}break;case 5:Vr=Ae.stateNode,Ja=!1;break e;case 3:case 4:Vr=Ae.stateNode.containerInfo,Ja=!0;break e}Ae=Ae.return}if(Vr===null)throw Error(r(160));S2(M,oe,D),Vr=null,Ja=!1,M=D.alternate,M!==null&&(M.return=null),D.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)R2(o,a),o=o.sibling}var bo=null;function R2(a,o){var h=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Za(o,a),el(a),p&4&&(Ed(3,a,a.return),nm(3,a),Ed(5,a,a.return));break;case 1:Za(o,a),el(a),p&512&&(Ti||h===null||qo(h,h.return)),p&64&&Ic&&(a=a.updateQueue,a!==null&&(p=a.callbacks,p!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var D=bo;if(Za(o,a),el(a),p&512&&(Ti||h===null||qo(h,h.return)),p&4){var M=h!==null?h.memoizedState:null;if(p=a.memoizedState,h===null)if(p===null)if(a.stateNode===null){e:{p=a.type,h=a.memoizedProps,D=D.ownerDocument||D;t:switch(p){case"title":M=D.getElementsByTagName("title")[0],(!M||M[Kt]||M[ls]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=D.createElement(p),D.head.insertBefore(M,D.querySelector("head > title"))),ma(M,p,h),M[ls]=a,Oe(M),p=M;break e;case"link":var oe=RS("link","href",D).get(p+(h.href||""));if(oe){for(var Ae=0;Ae<oe.length;Ae++)if(M=oe[Ae],M.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&M.getAttribute("rel")===(h.rel==null?null:h.rel)&&M.getAttribute("title")===(h.title==null?null:h.title)&&M.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){oe.splice(Ae,1);break t}}M=D.createElement(p),ma(M,p,h),D.head.appendChild(M);break;case"meta":if(oe=RS("meta","content",D).get(p+(h.content||""))){for(Ae=0;Ae<oe.length;Ae++)if(M=oe[Ae],M.getAttribute("content")===(h.content==null?null:""+h.content)&&M.getAttribute("name")===(h.name==null?null:h.name)&&M.getAttribute("property")===(h.property==null?null:h.property)&&M.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&M.getAttribute("charset")===(h.charSet==null?null:h.charSet)){oe.splice(Ae,1);break t}}M=D.createElement(p),ma(M,p,h),D.head.appendChild(M);break;default:throw Error(r(468,p))}M[ls]=a,Oe(M),p=M}a.stateNode=p}else TS(D,a.type,a.stateNode);else a.stateNode=DS(D,p,a.memoizedProps);else M!==p?(M===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):M.count--,p===null?TS(D,a.type,a.stateNode):DS(D,p,a.memoizedProps)):p===null&&a.stateNode!==null&&n1(a,a.memoizedProps,h.memoizedProps)}break;case 27:Za(o,a),el(a),p&512&&(Ti||h===null||qo(h,h.return)),h!==null&&p&4&&n1(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Za(o,a),el(a),p&512&&(Ti||h===null||qo(h,h.return)),a.flags&32){D=a.stateNode;try{nt(D,"")}catch(Vs){mr(a,a.return,Vs)}}p&4&&a.stateNode!=null&&(D=a.memoizedProps,n1(a,D,h!==null?h.memoizedProps:D)),p&1024&&(a1=!0);break;case 6:if(Za(o,a),el(a),p&4){if(a.stateNode===null)throw Error(r(162));p=a.memoizedProps,h=a.stateNode;try{h.nodeValue=p}catch(Vs){mr(a,a.return,Vs)}}break;case 3:if(gp=null,D=bo,bo=fp(o.containerInfo),Za(o,a),bo=D,el(a),p&4&&h!==null&&h.memoizedState.isDehydrated)try{b0(o.containerInfo)}catch(Vs){mr(a,a.return,Vs)}a1&&(a1=!1,T2(a));break;case 4:p=bo,bo=fp(a.stateNode.containerInfo),Za(o,a),el(a),bo=p;break;case 12:Za(o,a),el(a);break;case 31:Za(o,a),el(a),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,Zg(a,p)));break;case 13:Za(o,a),el(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(tp=et()),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,Zg(a,p)));break;case 22:D=a.memoizedState!==null;var gt=h!==null&&h.memoizedState!==null,Gt=Ic,ns=Ti;if(Ic=Gt||D,Ti=ns||gt,Za(o,a),Ti=ns,Ic=Gt,el(a),p&8192)e:for(o=a.stateNode,o._visibility=D?o._visibility&-2:o._visibility|1,D&&(h===null||gt||Ic||Ti||Ku(a)),h=null,o=a;;){if(o.tag===5||o.tag===26){if(h===null){gt=h=o;try{if(M=gt.stateNode,D)oe=M.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none";else{Ae=gt.stateNode;var us=gt.memoizedProps.style,Vt=us!=null&&us.hasOwnProperty("display")?us.display:null;Ae.style.display=Vt==null||typeof Vt=="boolean"?"":(""+Vt).trim()}}catch(Vs){mr(gt,gt.return,Vs)}}}else if(o.tag===6){if(h===null){gt=o;try{gt.stateNode.nodeValue=D?"":gt.memoizedProps}catch(Vs){mr(gt,gt.return,Vs)}}}else if(o.tag===18){if(h===null){gt=o;try{var zt=gt.stateNode;D?pS(zt,!0):pS(gt.stateNode,!1)}catch(Vs){mr(gt,gt.return,Vs)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=a.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,Zg(a,h))));break;case 19:Za(o,a),el(a),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,Zg(a,p)));break;case 30:break;case 21:break;default:Za(o,a),el(a)}}function el(a){var o=a.flags;if(o&2){try{for(var h,p=a.return;p!==null;){if(x2(p)){h=p;break}p=p.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var D=h.stateNode,M=r1(a);Jg(a,M,D);break;case 5:var oe=h.stateNode;h.flags&32&&(nt(oe,""),h.flags&=-33);var Ae=r1(a);Jg(a,Ae,oe);break;case 3:case 4:var gt=h.stateNode.containerInfo,Gt=r1(a);i1(a,Gt,gt);break;default:throw Error(r(161))}}catch(ns){mr(a,a.return,ns)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function T2(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;T2(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function Mc(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)b2(a,o.alternate,o),o=o.sibling}function Ku(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Ed(4,o,o.return),Ku(o);break;case 1:qo(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&p2(o,o.return,h),Ku(o);break;case 27:fm(o.stateNode);case 26:case 5:qo(o,o.return),Ku(o);break;case 22:o.memoizedState===null&&Ku(o);break;case 30:Ku(o);break;default:Ku(o)}a=a.sibling}}function Lc(a,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,D=a,M=o,oe=M.flags;switch(M.tag){case 0:case 11:case 15:Lc(D,M,h),nm(4,M);break;case 1:if(Lc(D,M,h),p=M,D=p.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(Gt){mr(p,p.return,Gt)}if(p=M,D=p.updateQueue,D!==null){var Ae=p.stateNode;try{var gt=D.shared.hiddenCallbacks;if(gt!==null)for(D.shared.hiddenCallbacks=null,D=0;D<gt.length;D++)Zi(gt[D],Ae)}catch(Gt){mr(p,p.return,Gt)}}h&&oe&64&&g2(M),rm(M,M.return);break;case 27:C2(M);case 26:case 5:Lc(D,M,h),h&&p===null&&oe&4&&_2(M),rm(M,M.return);break;case 12:Lc(D,M,h);break;case 31:Lc(D,M,h),h&&oe&4&&v2(D,M);break;case 13:Lc(D,M,h),h&&oe&4&&D2(D,M);break;case 22:M.memoizedState===null&&Lc(D,M,h),rm(M,M.return);break;case 30:break;default:Lc(D,M,h)}o=o.sibling}}function l1(a,o){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&ku(h))}function o1(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&ku(a))}function No(a,o,h,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)E2(a,o,h,p),o=o.sibling}function E2(a,o,h,p){var D=o.flags;switch(o.tag){case 0:case 11:case 15:No(a,o,h,p),D&2048&&nm(9,o);break;case 1:No(a,o,h,p);break;case 3:No(a,o,h,p),D&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&ku(a)));break;case 12:if(D&2048){No(a,o,h,p),a=o.stateNode;try{var M=o.memoizedProps,oe=M.id,Ae=M.onPostCommit;typeof Ae=="function"&&Ae(oe,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(gt){mr(o,o.return,gt)}}else No(a,o,h,p);break;case 31:No(a,o,h,p);break;case 13:No(a,o,h,p);break;case 23:break;case 22:M=o.stateNode,oe=o.alternate,o.memoizedState!==null?M._visibility&2?No(a,o,h,p):im(a,o):M._visibility&2?No(a,o,h,p):(M._visibility|=2,d0(a,o,h,p,(o.subtreeFlags&10256)!==0||!1)),D&2048&&l1(oe,o);break;case 24:No(a,o,h,p),D&2048&&o1(o.alternate,o);break;default:No(a,o,h,p)}}function d0(a,o,h,p,D){for(D=D&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var M=a,oe=o,Ae=h,gt=p,Gt=oe.flags;switch(oe.tag){case 0:case 11:case 15:d0(M,oe,Ae,gt,D),nm(8,oe);break;case 23:break;case 22:var ns=oe.stateNode;oe.memoizedState!==null?ns._visibility&2?d0(M,oe,Ae,gt,D):im(M,oe):(ns._visibility|=2,d0(M,oe,Ae,gt,D)),D&&Gt&2048&&l1(oe.alternate,oe);break;case 24:d0(M,oe,Ae,gt,D),D&&Gt&2048&&o1(oe.alternate,oe);break;default:d0(M,oe,Ae,gt,D)}o=o.sibling}}function im(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=a,p=o,D=p.flags;switch(p.tag){case 22:im(h,p),D&2048&&l1(p.alternate,p);break;case 24:im(h,p),D&2048&&o1(p.alternate,p);break;default:im(h,p)}o=o.sibling}}var am=8192;function u0(a,o,h){if(a.subtreeFlags&am)for(a=a.child;a!==null;)j2(a,o,h),a=a.sibling}function j2(a,o,h){switch(a.tag){case 26:u0(a,o,h),a.flags&am&&a.memoizedState!==null&&UO(h,bo,a.memoizedState,a.memoizedProps);break;case 5:u0(a,o,h);break;case 3:case 4:var p=bo;bo=fp(a.stateNode.containerInfo),u0(a,o,h),bo=p;break;case 22:a.memoizedState===null&&(p=a.alternate,p!==null&&p.memoizedState!==null?(p=am,am=16777216,u0(a,o,h),am=p):u0(a,o,h));break;default:u0(a,o,h)}}function I2(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function lm(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];ta=p,M2(p,a)}I2(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)O2(a),a=a.sibling}function O2(a){switch(a.tag){case 0:case 11:case 15:lm(a),a.flags&2048&&Ed(9,a,a.return);break;case 3:lm(a);break;case 12:lm(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,ep(a)):lm(a);break;default:lm(a)}}function ep(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];ta=p,M2(p,a)}I2(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Ed(8,o,o.return),ep(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,ep(o));break;default:ep(o)}a=a.sibling}}function M2(a,o){for(;ta!==null;){var h=ta;switch(h.tag){case 0:case 11:case 15:Ed(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:ku(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,ta=p;else e:for(h=a;ta!==null;){p=ta;var D=p.sibling,M=p.return;if(N2(p),p===h){ta=null;break e}if(D!==null){D.return=M,ta=D;break e}ta=M}}}var ZI={getCacheForType:function(a){var o=ki(ti),h=o.data.get(a);return h===void 0&&(h=a(),o.data.set(a,h)),h},cacheSignal:function(){return ki(ti).controller.signal}},eO=typeof WeakMap=="function"?WeakMap:Map,ar=0,Er=null,Ln=null,An=0,fr=0,bl=null,jd=!1,h0=!1,c1=!1,wc=0,di=0,Id=0,Qu=0,d1=0,Nl=0,f0=0,om=null,tl=null,u1=!1,tp=0,L2=0,sp=1/0,np=null,Od=null,Bi=0,Md=null,m0=null,Pc=0,h1=0,f1=null,w2=null,cm=0,m1=null;function Sl(){return(ar&2)!==0&&An!==0?An&-An:V.T!==null?y1():$t()}function P2(){if(Nl===0)if((An&536870912)===0||Mn){var a=De;De<<=1,(De&3932160)===0&&(De=262144),Nl=a}else Nl=536870912;return a=kr.current,a!==null&&(a.flags|=32),Nl}function sl(a,o,h){(a===Er&&(fr===2||fr===9)||a.cancelPendingCommit!==null)&&(g0(a,0),Ld(a,An,Nl,!1)),Pe(a,h),((ar&2)===0||a!==Er)&&(a===Er&&((ar&2)===0&&(Qu|=h),di===4&&Ld(a,An,Nl,!1)),Xo(a))}function A2(a,o,h){if((ar&6)!==0)throw Error(r(327));var p=!h&&(o&127)===0&&(o&a.expiredLanes)===0||Be(a,o),D=p?nO(a,o):p1(a,o,!0),M=p;do{if(D===0){h0&&!p&&Ld(a,o,0,!1);break}else{if(h=a.current.alternate,M&&!tO(h)){D=p1(a,o,!1),M=!1;continue}if(D===2){if(M=o,a.errorRecoveryDisabledLanes&M)var oe=0;else oe=a.pendingLanes&-536870913,oe=oe!==0?oe:oe&536870912?536870912:0;if(oe!==0){o=oe;e:{var Ae=a;D=om;var gt=Ae.current.memoizedState.isDehydrated;if(gt&&(g0(Ae,oe).flags|=256),oe=p1(Ae,oe,!1),oe!==2){if(c1&&!gt){Ae.errorRecoveryDisabledLanes|=M,Qu|=M,D=4;break e}M=tl,tl=D,M!==null&&(tl===null?tl=M:tl.push.apply(tl,M))}D=oe}if(M=!1,D!==2)continue}}if(D===1){g0(a,0),Ld(a,o,0,!0);break}e:{switch(p=a,M=D,M){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:Ld(p,o,Nl,!jd);break e;case 2:tl=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(D=tp+300-et(),10<D)){if(Ld(p,o,Nl,!jd),ge(p,0,!0)!==0)break e;Pc=o,p.timeoutHandle=fS(k2.bind(null,p,h,tl,np,u1,o,Nl,Qu,f0,jd,M,"Throttled",-0,0),D);break e}k2(p,h,tl,np,u1,o,Nl,Qu,f0,jd,M,null,-0,0)}}break}while(!0);Xo(a)}function k2(a,o,h,p,D,M,oe,Ae,gt,Gt,ns,us,Vt,zt){if(a.timeoutHandle=-1,us=o.subtreeFlags,us&8192||(us&16785408)===16785408){us={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hs},j2(o,M,us);var Vs=(M&62914560)===M?tp-et():(M&4194048)===M?L2-et():0;if(Vs=BO(us,Vs),Vs!==null){Pc=M,a.cancelPendingCommit=Vs(Y2.bind(null,a,o,M,h,p,D,oe,Ae,gt,ns,us,null,Vt,zt)),Ld(a,M,oe,!Gt);return}}Y2(a,o,M,h,p,D,oe,Ae,gt)}function tO(a){for(var o=a;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var D=h[p],M=D.getSnapshot;D=D.value;try{if(!Li(M(),D))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ld(a,o,h,p){o&=~d1,o&=~Qu,a.suspendedLanes|=o,a.pingedLanes&=~o,p&&(a.warmLanes|=o),p=a.expirationTimes;for(var D=o;0<D;){var M=31-rt(D),oe=1<<M;p[M]=-1,D&=~oe}h!==0&&Me(a,h,o)}function rp(){return(ar&6)===0?(dm(0),!1):!0}function g1(){if(Ln!==null){if(fr===0)var a=Ln.return;else a=Ln,wl=Ko=null,n0(a),fs=null,$s=0,a=Ln;for(;a!==null;)m2(a.alternate,a),a=a.return;Ln=null}}function g0(a,o){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,bO(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),Pc=0,g1(),Er=a,Ln=h=Ga(a.current,null),An=o,fr=0,bl=null,jd=!1,h0=Be(a,o),c1=!1,f0=Nl=d1=Qu=Id=di=0,tl=om=null,u1=!1,(o&8)!==0&&(o|=o&32);var p=a.entangledLanes;if(p!==0)for(a=a.entanglements,p&=o;0<p;){var D=31-rt(p),M=1<<D;o|=a[D],p&=~M}return wc=o,Ou(),h}function U2(a,o){tn=null,V.H=em,o===Nt||o===He?(o=is(),fr=3):o===Wt?(o=is(),fr=4):fr=o===$x?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,bl=o,Ln===null&&(di=1,$g(a,Ya(o,a.current)))}function B2(){var a=kr.current;return a===null?!0:(An&4194048)===An?Yn===null:(An&62914560)===An||(An&536870912)!==0?a===Yn:!1}function W2(){var a=V.H;return V.H=em,a===null?em:a}function F2(){var a=V.A;return V.A=ZI,a}function ip(){di=4,jd||(An&4194048)!==An&&kr.current!==null||(h0=!0),(Id&134217727)===0&&(Qu&134217727)===0||Er===null||Ld(Er,An,Nl,!1)}function p1(a,o,h){var p=ar;ar|=2;var D=W2(),M=F2();(Er!==a||An!==o)&&(np=null,g0(a,o)),o=!1;var oe=di;e:do try{if(fr!==0&&Ln!==null){var Ae=Ln,gt=bl;switch(fr){case 8:g1(),oe=6;break e;case 3:case 2:case 9:case 6:kr.current===null&&(o=!0);var Gt=fr;if(fr=0,bl=null,p0(a,Ae,gt,Gt),h&&h0){oe=0;break e}break;default:Gt=fr,fr=0,bl=null,p0(a,Ae,gt,Gt)}}sO(),oe=di;break}catch(ns){U2(a,ns)}while(!0);return o&&a.shellSuspendCounter++,wl=Ko=null,ar=p,V.H=D,V.A=M,Ln===null&&(Er=null,An=0,Ou()),oe}function sO(){for(;Ln!==null;)K2(Ln)}function nO(a,o){var h=ar;ar|=2;var p=W2(),D=F2();Er!==a||An!==o?(np=null,sp=et()+500,g0(a,o)):h0=Be(a,o);e:do try{if(fr!==0&&Ln!==null){o=Ln;var M=bl;t:switch(fr){case 1:fr=0,bl=null,p0(a,o,M,1);break;case 2:case 9:if(Pt(M)){fr=0,bl=null,Q2(o);break}o=function(){fr!==2&&fr!==9||Er!==a||(fr=7),Xo(a)},M.then(o,o);break e;case 3:fr=7;break e;case 4:fr=5;break e;case 7:Pt(M)?(fr=0,bl=null,Q2(o)):(fr=0,bl=null,p0(a,o,M,7));break;case 5:var oe=null;switch(Ln.tag){case 26:oe=Ln.memoizedState;case 5:case 27:var Ae=Ln;if(oe?ES(oe):Ae.stateNode.complete){fr=0,bl=null;var gt=Ae.sibling;if(gt!==null)Ln=gt;else{var Gt=Ae.return;Gt!==null?(Ln=Gt,ap(Gt)):Ln=null}break t}}fr=0,bl=null,p0(a,o,M,5);break;case 6:fr=0,bl=null,p0(a,o,M,6);break;case 8:g1(),di=6;break e;default:throw Error(r(462))}}rO();break}catch(ns){U2(a,ns)}while(!0);return wl=Ko=null,V.H=p,V.A=D,ar=h,Ln!==null?0:(Er=null,An=0,Ou(),di)}function rO(){for(;Ln!==null&&!ue();)K2(Ln)}function K2(a){var o=h2(a.alternate,a,wc);a.memoizedProps=a.pendingProps,o===null?ap(a):Ln=o}function Q2(a){var o=a,h=o.alternate;switch(o.tag){case 15:case 0:o=a2(h,o,o.pendingProps,o.type,void 0,An);break;case 11:o=a2(h,o,o.pendingProps,o.type.render,o.ref,An);break;case 5:n0(o);default:m2(h,o),o=Ln=wu(o,wc),o=h2(h,o,wc)}a.memoizedProps=a.pendingProps,o===null?ap(a):Ln=o}function p0(a,o,h,p){wl=Ko=null,n0(o),fs=null,$s=0;var D=o.return;try{if(VI(a,D,o,h,An)){di=1,$g(a,Ya(h,a.current)),Ln=null;return}}catch(M){if(D!==null)throw Ln=D,M;di=1,$g(a,Ya(h,a.current)),Ln=null;return}o.flags&32768?(Mn||p===1?a=!0:h0||(An&536870912)!==0?a=!1:(jd=a=!0,(p===2||p===9||p===3||p===6)&&(p=kr.current,p!==null&&p.tag===13&&(p.flags|=16384))),G2(o,a)):ap(o)}function ap(a){var o=a;do{if((o.flags&32768)!==0){G2(o,jd);return}a=o.return;var h=zI(o.alternate,o,wc);if(h!==null){Ln=h;return}if(o=o.sibling,o!==null){Ln=o;return}Ln=o=a}while(o!==null);di===0&&(di=5)}function G2(a,o){do{var h=qI(a.alternate,a);if(h!==null){h.flags&=32767,Ln=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(a=a.sibling,a!==null)){Ln=a;return}Ln=a=h}while(a!==null);di=6,Ln=null}function Y2(a,o,h,p,D,M,oe,Ae,gt){a.cancelPendingCommit=null;do lp();while(Bi!==0);if((ar&6)!==0)throw Error(r(327));if(o!==null){if(o===a.current)throw Error(r(177));if(M=o.lanes|o.childLanes,M|=Qh,Ct(a,h,M,oe,Ae,gt),a===Er&&(Ln=Er=null,An=0),m0=o,Md=a,Pc=h,h1=M,f1=D,w2=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,oO(at,function(){return q2(),null})):(a.callbackNode=null,a.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=V.T,V.T=null,D=F.p,F.p=2,oe=ar,ar|=4;try{XI(a,o,h)}finally{ar=oe,F.p=D,V.T=p}}Bi=1,V2(),$2(),H2()}}function V2(){if(Bi===1){Bi=0;var a=Md,o=m0,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=V.T,V.T=null;var p=F.p;F.p=2;var D=ar;ar|=4;try{R2(o,a);var M=E1,oe=fo(a.containerInfo),Ae=M.focusedElem,gt=M.selectionRange;if(oe!==Ae&&Ae&&Ae.ownerDocument&&ho(Ae.ownerDocument.documentElement,Ae)){if(gt!==null&&Ml(Ae)){var Gt=gt.start,ns=gt.end;if(ns===void 0&&(ns=Gt),"selectionStart"in Ae)Ae.selectionStart=Gt,Ae.selectionEnd=Math.min(ns,Ae.value.length);else{var us=Ae.ownerDocument||document,Vt=us&&us.defaultView||window;if(Vt.getSelection){var zt=Vt.getSelection(),Vs=Ae.textContent.length,dn=Math.min(gt.start,Vs),Sr=gt.end===void 0?dn:Math.min(gt.end,Vs);!zt.extend&&dn>Sr&&(oe=Sr,Sr=dn,dn=oe);var Lt=_d(Ae,dn),Rt=_d(Ae,Sr);if(Lt&&Rt&&(zt.rangeCount!==1||zt.anchorNode!==Lt.node||zt.anchorOffset!==Lt.offset||zt.focusNode!==Rt.node||zt.focusOffset!==Rt.offset)){var Qt=us.createRange();Qt.setStart(Lt.node,Lt.offset),zt.removeAllRanges(),dn>Sr?(zt.addRange(Qt),zt.extend(Rt.node,Rt.offset)):(Qt.setEnd(Rt.node,Rt.offset),zt.addRange(Qt))}}}}for(us=[],zt=Ae;zt=zt.parentNode;)zt.nodeType===1&&us.push({element:zt,left:zt.scrollLeft,top:zt.scrollTop});for(typeof Ae.focus=="function"&&Ae.focus(),Ae=0;Ae<us.length;Ae++){var os=us[Ae];os.element.scrollLeft=os.left,os.element.scrollTop=os.top}}Cp=!!T1,E1=T1=null}finally{ar=D,F.p=p,V.T=h}}a.current=o,Bi=2}}function $2(){if(Bi===2){Bi=0;var a=Md,o=m0,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=V.T,V.T=null;var p=F.p;F.p=2;var D=ar;ar|=4;try{b2(a,o.alternate,o)}finally{ar=D,F.p=p,V.T=h}}Bi=3}}function H2(){if(Bi===4||Bi===3){Bi=0,xe();var a=Md,o=m0,h=Pc,p=w2;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Bi=5:(Bi=0,m0=Md=null,z2(a,a.pendingLanes));var D=a.pendingLanes;if(D===0&&(Od=null),Ve(h),o=o.stateNode,dt&&typeof dt.onCommitFiberRoot=="function")try{dt.onCommitFiberRoot(ze,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=V.T,D=F.p,F.p=2,V.T=null;try{for(var M=a.onRecoverableError,oe=0;oe<p.length;oe++){var Ae=p[oe];M(Ae.value,{componentStack:Ae.stack})}}finally{V.T=o,F.p=D}}(Pc&3)!==0&&lp(),Xo(a),D=a.pendingLanes,(h&261930)!==0&&(D&42)!==0?a===m1?cm++:(cm=0,m1=a):cm=0,dm(0)}}function z2(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,ku(o)))}function lp(){return V2(),$2(),H2(),q2()}function q2(){if(Bi!==5)return!1;var a=Md,o=h1;h1=0;var h=Ve(Pc),p=V.T,D=F.p;try{F.p=32>h?32:h,V.T=null,h=f1,f1=null;var M=Md,oe=Pc;if(Bi=0,m0=Md=null,Pc=0,(ar&6)!==0)throw Error(r(331));var Ae=ar;if(ar|=4,O2(M.current),E2(M,M.current,oe,h),ar=Ae,dm(0,!1),dt&&typeof dt.onPostCommitFiberRoot=="function")try{dt.onPostCommitFiberRoot(ze,M)}catch{}return!0}finally{F.p=D,V.T=p,z2(a,o)}}function X2(a,o,h){o=Ya(h,o),o=Vx(a.stateNode,o,2),a=Nn(a,o,2),a!==null&&(Pe(a,2),Xo(a))}function mr(a,o,h){if(a.tag===3)X2(a,a,h);else for(;o!==null;){if(o.tag===3){X2(o,a,h);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Od===null||!Od.has(p))){a=Ya(h,a),h=JN(2),p=Nn(o,h,2),p!==null&&(ZN(h,p,o,a),Pe(p,2),Xo(p));break}}o=o.return}}function _1(a,o,h){var p=a.pingCache;if(p===null){p=a.pingCache=new eO;var D=new Set;p.set(o,D)}else D=p.get(o),D===void 0&&(D=new Set,p.set(o,D));D.has(h)||(c1=!0,D.add(h),a=iO.bind(null,a,o,h),o.then(a,a))}function iO(a,o,h){var p=a.pingCache;p!==null&&p.delete(o),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,Er===a&&(An&h)===h&&(di===4||di===3&&(An&62914560)===An&&300>et()-tp?(ar&2)===0&&g0(a,0):d1|=h,f0===An&&(f0=0)),Xo(a)}function J2(a,o){o===0&&(o=Le()),a=go(a,o),a!==null&&(Pe(a,o),Xo(a))}function aO(a){var o=a.memoizedState,h=0;o!==null&&(h=o.retryLane),J2(a,h)}function lO(a,o){var h=0;switch(a.tag){case 31:case 13:var p=a.stateNode,D=a.memoizedState;D!==null&&(h=D.retryLane);break;case 19:p=a.stateNode;break;case 22:p=a.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),J2(a,h)}function oO(a,o){return ye(a,o)}var op=null,_0=null,x1=!1,cp=!1,C1=!1,wd=0;function Xo(a){a!==_0&&a.next===null&&(_0===null?op=_0=a:_0=_0.next=a),cp=!0,x1||(x1=!0,dO())}function dm(a,o){if(!C1&&cp){C1=!0;do for(var h=!1,p=op;p!==null;){if(a!==0){var D=p.pendingLanes;if(D===0)var M=0;else{var oe=p.suspendedLanes,Ae=p.pingedLanes;M=(1<<31-rt(42|a)+1)-1,M&=D&~(oe&~Ae),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(h=!0,sS(p,M))}else M=An,M=ge(p,p===Er?M:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(M&3)===0||Be(p,M)||(h=!0,sS(p,M));p=p.next}while(h);C1=!1}}function cO(){Z2()}function Z2(){cp=x1=!1;var a=0;wd!==0&&yO()&&(a=wd);for(var o=et(),h=null,p=op;p!==null;){var D=p.next,M=eS(p,o);M===0?(p.next=null,h===null?op=D:h.next=D,D===null&&(_0=h)):(h=p,(a!==0||(M&3)!==0)&&(cp=!0)),p=D}Bi!==0&&Bi!==5||dm(a),wd!==0&&(wd=0)}function eS(a,o){for(var h=a.suspendedLanes,p=a.pingedLanes,D=a.expirationTimes,M=a.pendingLanes&-62914561;0<M;){var oe=31-rt(M),Ae=1<<oe,gt=D[oe];gt===-1?((Ae&h)===0||(Ae&p)!==0)&&(D[oe]=ce(Ae,o)):gt<=o&&(a.expiredLanes|=Ae),M&=~Ae}if(o=Er,h=An,h=ge(a,a===o?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),p=a.callbackNode,h===0||a===o&&(fr===2||fr===9)||a.cancelPendingCommit!==null)return p!==null&&p!==null&&ne(p),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||Be(a,h)){if(o=h&-h,o===a.callbackPriority)return o;switch(p!==null&&ne(p),Ve(h)){case 2:case 8:h=At;break;case 32:h=at;break;case 268435456:h=Dt;break;default:h=at}return p=tS.bind(null,a),h=ye(h,p),a.callbackPriority=o,a.callbackNode=h,o}return p!==null&&p!==null&&ne(p),a.callbackPriority=2,a.callbackNode=null,2}function tS(a,o){if(Bi!==0&&Bi!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(lp()&&a.callbackNode!==h)return null;var p=An;return p=ge(a,a===Er?p:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),p===0?null:(A2(a,p,o),eS(a,et()),a.callbackNode!=null&&a.callbackNode===h?tS.bind(null,a):null)}function sS(a,o){if(lp())return null;A2(a,o,!0)}function dO(){NO(function(){(ar&6)!==0?ye(it,cO):Z2()})}function y1(){if(wd===0){var a=b;a===0&&(a=Ze,Ze<<=1,(Ze&261888)===0&&(Ze=256)),wd=a}return wd}function nS(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:js(""+a)}function rS(a,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,a.id&&h.setAttribute("form",a.id),o.parentNode.insertBefore(h,o),a=new FormData(a),h.parentNode.removeChild(h),a}function uO(a,o,h,p,D){if(o==="submit"&&h&&h.stateNode===D){var M=nS((D[ds]||null).action),oe=p.submitter;oe&&(o=(o=oe[ds]||null)?nS(o.formAction):oe.getAttribute("formAction"),o!==null&&(M=o,oe=null));var Ae=new Qn("action","action",null,p,D);a.push({event:Ae,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(wd!==0){var gt=oe?rS(D,oe):new FormData(D);Wx(h,{pending:!0,data:gt,method:D.method,action:M},null,gt)}}else typeof M=="function"&&(Ae.preventDefault(),gt=oe?rS(D,oe):new FormData(D),Wx(h,{pending:!0,data:gt,method:D.method,action:M},M,gt))},currentTarget:D}]})}}for(var b1=0;b1<yc.length;b1++){var N1=yc[b1],hO=N1.toLowerCase(),fO=N1[0].toUpperCase()+N1.slice(1);Qa(hO,"on"+fO)}Qa(Cc,"onAnimationEnd"),Qa(ju,"onAnimationIteration"),Qa(Bf,"onAnimationStart"),Qa("dblclick","onDoubleClick"),Qa("focusin","onFocus"),Qa("focusout","onBlur"),Qa(wg,"onTransitionRun"),Qa(Pg,"onTransitionStart"),Qa(Ag,"onTransitionCancel"),Qa(Wf,"onTransitionEnd"),_t("onMouseEnter",["mouseout","mouseover"]),_t("onMouseLeave",["mouseout","mouseover"]),_t("onPointerEnter",["pointerout","pointerover"]),_t("onPointerLeave",["pointerout","pointerover"]),Te("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Te("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Te("onBeforeInput",["compositionend","keypress","textInput","paste"]),Te("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var um="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(um));function iS(a,o){o=(o&4)!==0;for(var h=0;h<a.length;h++){var p=a[h],D=p.event;p=p.listeners;e:{var M=void 0;if(o)for(var oe=p.length-1;0<=oe;oe--){var Ae=p[oe],gt=Ae.instance,Gt=Ae.currentTarget;if(Ae=Ae.listener,gt!==M&&D.isPropagationStopped())break e;M=Ae,D.currentTarget=Gt;try{M(D)}catch(ns){Iu(ns)}D.currentTarget=null,M=gt}else for(oe=0;oe<p.length;oe++){if(Ae=p[oe],gt=Ae.instance,Gt=Ae.currentTarget,Ae=Ae.listener,gt!==M&&D.isPropagationStopped())break e;M=Ae,D.currentTarget=Gt;try{M(D)}catch(ns){Iu(ns)}D.currentTarget=null,M=gt}}}}function wn(a,o){var h=o[Ns];h===void 0&&(h=o[Ns]=new Set);var p=a+"__bubble";h.has(p)||(aS(o,a,2,!1),h.add(p))}function S1(a,o,h){var p=0;o&&(p|=4),aS(h,a,p,o)}var dp="_reactListening"+Math.random().toString(36).slice(2);function v1(a){if(!a[dp]){a[dp]=!0,je.forEach(function(h){h!=="selectionchange"&&(mO.has(h)||S1(h,!1,a),S1(h,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[dp]||(o[dp]=!0,S1("selectionchange",!1,o))}}function aS(a,o,h,p){switch(PS(o)){case 2:var D=KO;break;case 8:D=QO;break;default:D=B1}h=D.bind(null,o,h,a),D=void 0,!cr||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(D=!0),p?D!==void 0?a.addEventListener(o,h,{capture:!0,passive:D}):a.addEventListener(o,h,!0):D!==void 0?a.addEventListener(o,h,{passive:D}):a.addEventListener(o,h,!1)}function D1(a,o,h,p,D){var M=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var oe=p.tag;if(oe===3||oe===4){var Ae=p.stateNode.containerInfo;if(Ae===D)break;if(oe===4)for(oe=p.return;oe!==null;){var gt=oe.tag;if((gt===3||gt===4)&&oe.stateNode.containerInfo===D)return;oe=oe.return}for(;Ae!==null;){if(oe=qt(Ae),oe===null)return;if(gt=oe.tag,gt===5||gt===6||gt===26||gt===27){p=M=oe;continue e}Ae=Ae.parentNode}}p=p.return}qr(function(){var Gt=M,ns=Qs(h),us=[];e:{var Vt=Ff.get(a);if(Vt!==void 0){var zt=Qn,Vs=a;switch(a){case"keypress":if(Dr(h)===0)break e;case"keydown":case"keyup":zt=Bn;break;case"focusin":Vs="focus",zt=no;break;case"focusout":Vs="blur",zt=no;break;case"beforeblur":case"afterblur":zt=no;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":zt=Kr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":zt=Oi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":zt=mi;break;case Cc:case ju:case Bf:zt=W;break;case Wf:zt=Mi;break;case"scroll":case"scrollend":zt=Ni;break;case"wheel":zt=gl;break;case"copy":case"cut":case"paste":zt=Je;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":zt=Jr;break;case"toggle":case"beforetoggle":zt=Ru}var dn=(o&4)!==0,Sr=!dn&&(a==="scroll"||a==="scrollend"),Lt=dn?Vt!==null?Vt+"Capture":null:Vt;dn=[];for(var Rt=Gt,Qt;Rt!==null;){var os=Rt;if(Qt=os.stateNode,os=os.tag,os!==5&&os!==26&&os!==27||Qt===null||Lt===null||(os=vr(Rt,Lt),os!=null&&dn.push(hm(Rt,os,Qt))),Sr)break;Rt=Rt.return}0<dn.length&&(Vt=new zt(Vt,Vs,null,h,ns),us.push({event:Vt,listeners:dn}))}}if((o&7)===0){e:{if(Vt=a==="mouseover"||a==="pointerover",zt=a==="mouseout"||a==="pointerout",Vt&&h!==Us&&(Vs=h.relatedTarget||h.fromElement)&&(qt(Vs)||Vs[Ss]))break e;if((zt||Vt)&&(Vt=ns.window===ns?ns:(Vt=ns.ownerDocument)?Vt.defaultView||Vt.parentWindow:window,zt?(Vs=h.relatedTarget||h.toElement,zt=Gt,Vs=Vs?qt(Vs):null,Vs!==null&&(Sr=l(Vs),dn=Vs.tag,Vs!==Sr||dn!==5&&dn!==27&&dn!==6)&&(Vs=null)):(zt=null,Vs=Gt),zt!==Vs)){if(dn=Kr,os="onMouseLeave",Lt="onMouseEnter",Rt="mouse",(a==="pointerout"||a==="pointerover")&&(dn=Jr,os="onPointerLeave",Lt="onPointerEnter",Rt="pointer"),Sr=zt==null?Vt:he(zt),Qt=Vs==null?Vt:he(Vs),Vt=new dn(os,Rt+"leave",zt,h,ns),Vt.target=Sr,Vt.relatedTarget=Qt,os=null,qt(ns)===Gt&&(dn=new dn(Lt,Rt+"enter",Vs,h,ns),dn.target=Qt,dn.relatedTarget=Sr,os=dn),Sr=os,zt&&Vs)t:{for(dn=gO,Lt=zt,Rt=Vs,Qt=0,os=Lt;os;os=dn(os))Qt++;os=0;for(var rn=Rt;rn;rn=dn(rn))os++;for(;0<Qt-os;)Lt=dn(Lt),Qt--;for(;0<os-Qt;)Rt=dn(Rt),os--;for(;Qt--;){if(Lt===Rt||Rt!==null&&Lt===Rt.alternate){dn=Lt;break t}Lt=dn(Lt),Rt=dn(Rt)}dn=null}else dn=null;zt!==null&&lS(us,Vt,zt,dn,!1),Vs!==null&&Sr!==null&&lS(us,Sr,Vs,dn,!0)}}e:{if(Vt=Gt?he(Gt):window,zt=Vt.nodeName&&Vt.nodeName.toLowerCase(),zt==="select"||zt==="input"&&Vt.type==="file")var Xn=Uo;else if(Tu(Vt))if(xa)Xn=Il;else{Xn=Zr;var Js=gd}else zt=Vt.nodeName,!zt||zt.toLowerCase()!=="input"||Vt.type!=="checkbox"&&Vt.type!=="radio"?Gt&&Os(Gt.elementType)&&(Xn=Uo):Xn=Kh;if(Xn&&(Xn=Xn(a,Gt))){Ea(us,Xn,h,ns);break e}Js&&Js(a,Vt,Gt),a==="focusout"&&Gt&&Vt.type==="number"&&Gt.memoizedProps.value!=null&&cs(Vt,"number",Vt.value)}switch(Js=Gt?he(Gt):window,a){case"focusin":(Tu(Js)||Js.contentEditable==="true")&&(ja=Js,mo=Gt,qi=null);break;case"focusout":qi=mo=ja=null;break;case"mousedown":Ka=!0;break;case"contextmenu":case"mouseup":case"dragend":Ka=!1,zn(us,h,ns);break;case"selectionchange":if(xc)break;case"keydown":case"keyup":zn(us,h,ns)}var vn;if(Rl)e:{switch(a){case"compositionstart":var kn="onCompositionStart";break e;case"compositionend":kn="onCompositionEnd";break e;case"compositionupdate":kn="onCompositionUpdate";break e}kn=void 0}else Tl?ko(a,h)&&(kn="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(kn="onCompositionStart");kn&&(ao&&h.locale!=="ko"&&(Tl||kn!=="onCompositionStart"?kn==="onCompositionEnd"&&Tl&&(vn=zi()):(Fr=ns,Hi="value"in Fr?Fr.value:Fr.textContent,Tl=!0)),Js=up(Gt,kn),0<Js.length&&(kn=new Mt(kn,a,null,h,ns),us.push({event:kn,listeners:Js}),vn?kn.data=vn:(vn=hd(h),vn!==null&&(kn.data=vn)))),(vn=_c?ca(a,h):lo(a,h))&&(kn=up(Gt,"onBeforeInput"),0<kn.length&&(Js=new Mt("onBeforeInput","beforeinput",null,h,ns),us.push({event:Js,listeners:kn}),Js.data=vn)),uO(us,a,Gt,h,ns)}iS(us,o)})}function hm(a,o,h){return{instance:a,listener:o,currentTarget:h}}function up(a,o){for(var h=o+"Capture",p=[];a!==null;){var D=a,M=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||M===null||(D=vr(a,h),D!=null&&p.unshift(hm(a,D,M)),D=vr(a,o),D!=null&&p.push(hm(a,D,M))),a.tag===3)return p;a=a.return}return[]}function gO(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function lS(a,o,h,p,D){for(var M=o._reactName,oe=[];h!==null&&h!==p;){var Ae=h,gt=Ae.alternate,Gt=Ae.stateNode;if(Ae=Ae.tag,gt!==null&&gt===p)break;Ae!==5&&Ae!==26&&Ae!==27||Gt===null||(gt=Gt,D?(Gt=vr(h,M),Gt!=null&&oe.unshift(hm(h,Gt,gt))):D||(Gt=vr(h,M),Gt!=null&&oe.push(hm(h,Gt,gt)))),h=h.return}oe.length!==0&&a.push({event:o,listeners:oe})}var pO=/\r\n?/g,_O=/\u0000|\uFFFD/g;function oS(a){return(typeof a=="string"?a:""+a).replace(pO,`
`).replace(_O,"")}function cS(a,o){return o=oS(o),oS(a)===o}function Nr(a,o,h,p,D,M){switch(h){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||nt(a,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&nt(a,""+p);break;case"className":wt(a,"class",p);break;case"tabIndex":wt(a,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":wt(a,h,p);break;case"style":Ht(a,p,M);break;case"data":if(o!=="object"){wt(a,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||h!=="href")){a.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){a.removeAttribute(h);break}p=js(""+p),a.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(h==="formAction"?(o!=="input"&&Nr(a,o,"name",D.name,D,null),Nr(a,o,"formEncType",D.formEncType,D,null),Nr(a,o,"formMethod",D.formMethod,D,null),Nr(a,o,"formTarget",D.formTarget,D,null)):(Nr(a,o,"encType",D.encType,D,null),Nr(a,o,"method",D.method,D,null),Nr(a,o,"target",D.target,D,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){a.removeAttribute(h);break}p=js(""+p),a.setAttribute(h,p);break;case"onClick":p!=null&&(a.onclick=hs);break;case"onScroll":p!=null&&wn("scroll",a);break;case"onScrollEnd":p!=null&&wn("scrollend",a);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(D.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"multiple":a.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":a.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){a.removeAttribute("xlink:href");break}h=js(""+p),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(h,""+p):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":p===!0?a.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(h,p):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?a.setAttribute(h,p):a.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?a.removeAttribute(h):a.setAttribute(h,p);break;case"popover":wn("beforetoggle",a),wn("toggle",a),ot(a,"popover",p);break;case"xlinkActuate":Bt(a,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Bt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Bt(a,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Bt(a,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Bt(a,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Bt(a,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Bt(a,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Bt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Bt(a,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ot(a,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Zt.get(h)||h,ot(a,h,p))}}function R1(a,o,h,p,D,M){switch(h){case"style":Ht(a,p,M);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(D.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"children":typeof p=="string"?nt(a,p):(typeof p=="number"||typeof p=="bigint")&&nt(a,""+p);break;case"onScroll":p!=null&&wn("scroll",a);break;case"onScrollEnd":p!=null&&wn("scrollend",a);break;case"onClick":p!=null&&(a.onclick=hs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tt.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(D=h.endsWith("Capture"),o=h.slice(2,D?h.length-7:void 0),M=a[ds]||null,M=M!=null?M[h]:null,typeof M=="function"&&a.removeEventListener(o,M,D),typeof p=="function")){typeof M!="function"&&M!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(o,p,D);break e}h in a?a[h]=p:p===!0?a.setAttribute(h,""):ot(a,h,p)}}}function ma(a,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wn("error",a),wn("load",a);var p=!1,D=!1,M;for(M in h)if(h.hasOwnProperty(M)){var oe=h[M];if(oe!=null)switch(M){case"src":p=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Nr(a,o,M,oe,h,null)}}D&&Nr(a,o,"srcSet",h.srcSet,h,null),p&&Nr(a,o,"src",h.src,h,null);return;case"input":wn("invalid",a);var Ae=M=oe=D=null,gt=null,Gt=null;for(p in h)if(h.hasOwnProperty(p)){var ns=h[p];if(ns!=null)switch(p){case"name":D=ns;break;case"type":oe=ns;break;case"checked":gt=ns;break;case"defaultChecked":Gt=ns;break;case"value":M=ns;break;case"defaultValue":Ae=ns;break;case"children":case"dangerouslySetInnerHTML":if(ns!=null)throw Error(r(137,o));break;default:Nr(a,o,p,ns,h,null)}}Ms(a,M,Ae,gt,Gt,oe,D,!1);return;case"select":wn("invalid",a),p=oe=M=null;for(D in h)if(h.hasOwnProperty(D)&&(Ae=h[D],Ae!=null))switch(D){case"value":M=Ae;break;case"defaultValue":oe=Ae;break;case"multiple":p=Ae;default:Nr(a,o,D,Ae,h,null)}o=M,h=oe,a.multiple=!!p,o!=null?ms(a,!!p,o,!1):h!=null&&ms(a,!!p,h,!0);return;case"textarea":wn("invalid",a),M=D=p=null;for(oe in h)if(h.hasOwnProperty(oe)&&(Ae=h[oe],Ae!=null))switch(oe){case"value":p=Ae;break;case"defaultValue":D=Ae;break;case"children":M=Ae;break;case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(r(91));break;default:Nr(a,o,oe,Ae,h,null)}Ls(a,p,D,M);return;case"option":for(gt in h)if(h.hasOwnProperty(gt)&&(p=h[gt],p!=null))switch(gt){case"selected":a.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Nr(a,o,gt,p,h,null)}return;case"dialog":wn("beforetoggle",a),wn("toggle",a),wn("cancel",a),wn("close",a);break;case"iframe":case"object":wn("load",a);break;case"video":case"audio":for(p=0;p<um.length;p++)wn(um[p],a);break;case"image":wn("error",a),wn("load",a);break;case"details":wn("toggle",a);break;case"embed":case"source":case"link":wn("error",a),wn("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Gt in h)if(h.hasOwnProperty(Gt)&&(p=h[Gt],p!=null))switch(Gt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Nr(a,o,Gt,p,h,null)}return;default:if(Os(o)){for(ns in h)h.hasOwnProperty(ns)&&(p=h[ns],p!==void 0&&R1(a,o,ns,p,h,void 0));return}}for(Ae in h)h.hasOwnProperty(Ae)&&(p=h[Ae],p!=null&&Nr(a,o,Ae,p,h,null))}function xO(a,o,h,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,M=null,oe=null,Ae=null,gt=null,Gt=null,ns=null;for(zt in h){var us=h[zt];if(h.hasOwnProperty(zt)&&us!=null)switch(zt){case"checked":break;case"value":break;case"defaultValue":gt=us;default:p.hasOwnProperty(zt)||Nr(a,o,zt,null,p,us)}}for(var Vt in p){var zt=p[Vt];if(us=h[Vt],p.hasOwnProperty(Vt)&&(zt!=null||us!=null))switch(Vt){case"type":M=zt;break;case"name":D=zt;break;case"checked":Gt=zt;break;case"defaultChecked":ns=zt;break;case"value":oe=zt;break;case"defaultValue":Ae=zt;break;case"children":case"dangerouslySetInnerHTML":if(zt!=null)throw Error(r(137,o));break;default:zt!==us&&Nr(a,o,Vt,zt,p,us)}}vs(a,oe,Ae,gt,Gt,ns,M,D);return;case"select":zt=oe=Ae=Vt=null;for(M in h)if(gt=h[M],h.hasOwnProperty(M)&&gt!=null)switch(M){case"value":break;case"multiple":zt=gt;default:p.hasOwnProperty(M)||Nr(a,o,M,null,p,gt)}for(D in p)if(M=p[D],gt=h[D],p.hasOwnProperty(D)&&(M!=null||gt!=null))switch(D){case"value":Vt=M;break;case"defaultValue":Ae=M;break;case"multiple":oe=M;default:M!==gt&&Nr(a,o,D,M,p,gt)}o=Ae,h=oe,p=zt,Vt!=null?ms(a,!!h,Vt,!1):!!p!=!!h&&(o!=null?ms(a,!!h,o,!0):ms(a,!!h,h?[]:"",!1));return;case"textarea":zt=Vt=null;for(Ae in h)if(D=h[Ae],h.hasOwnProperty(Ae)&&D!=null&&!p.hasOwnProperty(Ae))switch(Ae){case"value":break;case"children":break;default:Nr(a,o,Ae,null,p,D)}for(oe in p)if(D=p[oe],M=h[oe],p.hasOwnProperty(oe)&&(D!=null||M!=null))switch(oe){case"value":Vt=D;break;case"defaultValue":zt=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(r(91));break;default:D!==M&&Nr(a,o,oe,D,p,M)}Ks(a,Vt,zt);return;case"option":for(var Vs in h)if(Vt=h[Vs],h.hasOwnProperty(Vs)&&Vt!=null&&!p.hasOwnProperty(Vs))switch(Vs){case"selected":a.selected=!1;break;default:Nr(a,o,Vs,null,p,Vt)}for(gt in p)if(Vt=p[gt],zt=h[gt],p.hasOwnProperty(gt)&&Vt!==zt&&(Vt!=null||zt!=null))switch(gt){case"selected":a.selected=Vt&&typeof Vt!="function"&&typeof Vt!="symbol";break;default:Nr(a,o,gt,Vt,p,zt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dn in h)Vt=h[dn],h.hasOwnProperty(dn)&&Vt!=null&&!p.hasOwnProperty(dn)&&Nr(a,o,dn,null,p,Vt);for(Gt in p)if(Vt=p[Gt],zt=h[Gt],p.hasOwnProperty(Gt)&&Vt!==zt&&(Vt!=null||zt!=null))switch(Gt){case"children":case"dangerouslySetInnerHTML":if(Vt!=null)throw Error(r(137,o));break;default:Nr(a,o,Gt,Vt,p,zt)}return;default:if(Os(o)){for(var Sr in h)Vt=h[Sr],h.hasOwnProperty(Sr)&&Vt!==void 0&&!p.hasOwnProperty(Sr)&&R1(a,o,Sr,void 0,p,Vt);for(ns in p)Vt=p[ns],zt=h[ns],!p.hasOwnProperty(ns)||Vt===zt||Vt===void 0&&zt===void 0||R1(a,o,ns,Vt,p,zt);return}}for(var Lt in h)Vt=h[Lt],h.hasOwnProperty(Lt)&&Vt!=null&&!p.hasOwnProperty(Lt)&&Nr(a,o,Lt,null,p,Vt);for(us in p)Vt=p[us],zt=h[us],!p.hasOwnProperty(us)||Vt===zt||Vt==null&&zt==null||Nr(a,o,us,Vt,p,zt)}function dS(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function CO(){if(typeof performance.getEntriesByType=="function"){for(var a=0,o=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var D=h[p],M=D.transferSize,oe=D.initiatorType,Ae=D.duration;if(M&&Ae&&dS(oe)){for(oe=0,Ae=D.responseEnd,p+=1;p<h.length;p++){var gt=h[p],Gt=gt.startTime;if(Gt>Ae)break;var ns=gt.transferSize,us=gt.initiatorType;ns&&dS(us)&&(gt=gt.responseEnd,oe+=ns*(gt<Ae?1:(Ae-Gt)/(gt-Gt)))}if(--p,o+=8*(M+oe)/(D.duration/1e3),a++,10<a)break}}if(0<a)return o/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var T1=null,E1=null;function hp(a){return a.nodeType===9?a:a.ownerDocument}function uS(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hS(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function j1(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var I1=null;function yO(){var a=window.event;return a&&a.type==="popstate"?a===I1?!1:(I1=a,!0):(I1=null,!1)}var fS=typeof setTimeout=="function"?setTimeout:void 0,bO=typeof clearTimeout=="function"?clearTimeout:void 0,mS=typeof Promise=="function"?Promise:void 0,NO=typeof queueMicrotask=="function"?queueMicrotask:typeof mS<"u"?function(a){return mS.resolve(null).then(a).catch(SO)}:fS;function SO(a){setTimeout(function(){throw a})}function Pd(a){return a==="head"}function gS(a,o){var h=o,p=0;do{var D=h.nextSibling;if(a.removeChild(h),D&&D.nodeType===8)if(h=D.data,h==="/$"||h==="/&"){if(p===0){a.removeChild(D),b0(o);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")fm(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,fm(h);for(var M=h.firstChild;M;){var oe=M.nextSibling,Ae=M.nodeName;M[Kt]||Ae==="SCRIPT"||Ae==="STYLE"||Ae==="LINK"&&M.rel.toLowerCase()==="stylesheet"||h.removeChild(M),M=oe}}else h==="body"&&fm(a.ownerDocument.body);h=D}while(h);b0(o)}function pS(a,o){var h=a;a=0;do{var p=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=p}while(h)}function O1(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":O1(h),ht(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function vO(a,o,h,p){for(;a.nodeType===1;){var D=h;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(p){if(!a[Kt])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(M=a.getAttribute("rel"),M==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(M!==D.rel||a.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||a.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||a.getAttribute("title")!==(D.title==null?null:D.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(M=a.getAttribute("src"),(M!==(D.src==null?null:D.src)||a.getAttribute("type")!==(D.type==null?null:D.type)||a.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&M&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var M=D.name==null?null:""+D.name;if(D.type==="hidden"&&a.getAttribute("name")===M)return a}else return a;if(a=kl(a.nextSibling),a===null)break}return null}function DO(a,o,h){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=kl(a.nextSibling),a===null))return null;return a}function _S(a,o){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=kl(a.nextSibling),a===null))return null;return a}function M1(a){return a.data==="$?"||a.data==="$~"}function L1(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function RO(a,o){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=o;else if(a.data!=="$?"||h.readyState!=="loading")o();else{var p=function(){o(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),a._reactRetry=p}}function kl(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return a}var w1=null;function xS(a){a=a.nextSibling;for(var o=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(o===0)return kl(a.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}a=a.nextSibling}return null}function CS(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return a;o--}else h!=="/$"&&h!=="/&"||o++}a=a.previousSibling}return null}function yS(a,o,h){switch(o=hp(h),a){case"html":if(a=o.documentElement,!a)throw Error(r(452));return a;case"head":if(a=o.head,!a)throw Error(r(453));return a;case"body":if(a=o.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function fm(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);ht(a)}var Ul=new Map,bS=new Set;function fp(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Ac=F.d;F.d={f:TO,r:EO,D:jO,C:IO,L:OO,m:MO,X:wO,S:LO,M:PO};function TO(){var a=Ac.f(),o=rp();return a||o}function EO(a){var o=It(a);o!==null&&o.tag===5&&o.type==="form"?UN(o):Ac.r(a)}var x0=typeof document>"u"?null:document;function NS(a,o,h){var p=x0;if(p&&typeof o=="string"&&o){var D=ps(o);D='link[rel="'+a+'"][href="'+D+'"]',typeof h=="string"&&(D+='[crossorigin="'+h+'"]'),bS.has(D)||(bS.add(D),a={rel:a,crossOrigin:h,href:o},p.querySelector(D)===null&&(o=p.createElement("link"),ma(o,"link",a),Oe(o),p.head.appendChild(o)))}}function jO(a){Ac.D(a),NS("dns-prefetch",a,null)}function IO(a,o){Ac.C(a,o),NS("preconnect",a,o)}function OO(a,o,h){Ac.L(a,o,h);var p=x0;if(p&&a&&o){var D='link[rel="preload"][as="'+ps(o)+'"]';o==="image"&&h&&h.imageSrcSet?(D+='[imagesrcset="'+ps(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(D+='[imagesizes="'+ps(h.imageSizes)+'"]')):D+='[href="'+ps(a)+'"]';var M=D;switch(o){case"style":M=C0(a);break;case"script":M=y0(a)}Ul.has(M)||(a=_({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:a,as:o},h),Ul.set(M,a),p.querySelector(D)!==null||o==="style"&&p.querySelector(mm(M))||o==="script"&&p.querySelector(gm(M))||(o=p.createElement("link"),ma(o,"link",a),Oe(o),p.head.appendChild(o)))}}function MO(a,o){Ac.m(a,o);var h=x0;if(h&&a){var p=o&&typeof o.as=="string"?o.as:"script",D='link[rel="modulepreload"][as="'+ps(p)+'"][href="'+ps(a)+'"]',M=D;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=y0(a)}if(!Ul.has(M)&&(a=_({rel:"modulepreload",href:a},o),Ul.set(M,a),h.querySelector(D)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(gm(M)))return}p=h.createElement("link"),ma(p,"link",a),Oe(p),h.head.appendChild(p)}}}function LO(a,o,h){Ac.S(a,o,h);var p=x0;if(p&&a){var D=be(p).hoistableStyles,M=C0(a);o=o||"default";var oe=D.get(M);if(!oe){var Ae={loading:0,preload:null};if(oe=p.querySelector(mm(M)))Ae.loading=5;else{a=_({rel:"stylesheet",href:a,"data-precedence":o},h),(h=Ul.get(M))&&P1(a,h);var gt=oe=p.createElement("link");Oe(gt),ma(gt,"link",a),gt._p=new Promise(function(Gt,ns){gt.onload=Gt,gt.onerror=ns}),gt.addEventListener("load",function(){Ae.loading|=1}),gt.addEventListener("error",function(){Ae.loading|=2}),Ae.loading|=4,mp(oe,o,p)}oe={type:"stylesheet",instance:oe,count:1,state:Ae},D.set(M,oe)}}}function wO(a,o){Ac.X(a,o);var h=x0;if(h&&a){var p=be(h).hoistableScripts,D=y0(a),M=p.get(D);M||(M=h.querySelector(gm(D)),M||(a=_({src:a,async:!0},o),(o=Ul.get(D))&&A1(a,o),M=h.createElement("script"),Oe(M),ma(M,"link",a),h.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},p.set(D,M))}}function PO(a,o){Ac.M(a,o);var h=x0;if(h&&a){var p=be(h).hoistableScripts,D=y0(a),M=p.get(D);M||(M=h.querySelector(gm(D)),M||(a=_({src:a,async:!0,type:"module"},o),(o=Ul.get(D))&&A1(a,o),M=h.createElement("script"),Oe(M),ma(M,"link",a),h.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},p.set(D,M))}}function SS(a,o,h,p){var D=(D=$.current)?fp(D):null;if(!D)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=C0(h.href),h=be(D).hoistableStyles,p=h.get(o),p||(p={type:"style",instance:null,count:0,state:null},h.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=C0(h.href);var M=be(D).hoistableStyles,oe=M.get(a);if(oe||(D=D.ownerDocument||D,oe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(a,oe),(M=D.querySelector(mm(a)))&&!M._p&&(oe.instance=M,oe.state.loading=5),Ul.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Ul.set(a,h),M||AO(D,a,h,oe.state))),o&&p===null)throw Error(r(528,""));return oe}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=y0(h),h=be(D).hoistableScripts,p=h.get(o),p||(p={type:"script",instance:null,count:0,state:null},h.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function C0(a){return'href="'+ps(a)+'"'}function mm(a){return'link[rel="stylesheet"]['+a+"]"}function vS(a){return _({},a,{"data-precedence":a.precedence,precedence:null})}function AO(a,o,h,p){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=a.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),ma(o,"link",h),Oe(o),a.head.appendChild(o))}function y0(a){return'[src="'+ps(a)+'"]'}function gm(a){return"script[async]"+a}function DS(a,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var p=a.querySelector('style[data-href~="'+ps(h.href)+'"]');if(p)return o.instance=p,Oe(p),p;var D=_({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(a.ownerDocument||a).createElement("style"),Oe(p),ma(p,"style",D),mp(p,h.precedence,a),o.instance=p;case"stylesheet":D=C0(h.href);var M=a.querySelector(mm(D));if(M)return o.state.loading|=4,o.instance=M,Oe(M),M;p=vS(h),(D=Ul.get(D))&&P1(p,D),M=(a.ownerDocument||a).createElement("link"),Oe(M);var oe=M;return oe._p=new Promise(function(Ae,gt){oe.onload=Ae,oe.onerror=gt}),ma(M,"link",p),o.state.loading|=4,mp(M,h.precedence,a),o.instance=M;case"script":return M=y0(h.src),(D=a.querySelector(gm(M)))?(o.instance=D,Oe(D),D):(p=h,(D=Ul.get(M))&&(p=_({},h),A1(p,D)),a=a.ownerDocument||a,D=a.createElement("script"),Oe(D),ma(D,"link",p),a.head.appendChild(D),o.instance=D);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,mp(p,h.precedence,a));return o.instance}function mp(a,o,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=p.length?p[p.length-1]:null,M=D,oe=0;oe<p.length;oe++){var Ae=p[oe];if(Ae.dataset.precedence===o)M=Ae;else if(M!==D)break}M?M.parentNode.insertBefore(a,M.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(a,o.firstChild))}function P1(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function A1(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var gp=null;function RS(a,o,h){if(gp===null){var p=new Map,D=gp=new Map;D.set(h,p)}else D=gp,p=D.get(h),p||(p=new Map,D.set(h,p));if(p.has(a))return p;for(p.set(a,null),h=h.getElementsByTagName(a),D=0;D<h.length;D++){var M=h[D];if(!(M[Kt]||M[ls]||a==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var oe=M.getAttribute(o)||"";oe=a+oe;var Ae=p.get(oe);Ae?Ae.push(M):p.set(oe,[M])}}return p}function TS(a,o,h){a=a.ownerDocument||a,a.head.insertBefore(h,o==="title"?a.querySelector("head > title"):null)}function kO(a,o,h){if(h===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function ES(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function UO(a,o,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var D=C0(p.href),M=o.querySelector(mm(D));if(M){o=M._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(a.count++,a=pp.bind(a),o.then(a,a)),h.state.loading|=4,h.instance=M,Oe(M);return}M=o.ownerDocument||o,p=vS(p),(D=Ul.get(D))&&P1(p,D),M=M.createElement("link"),Oe(M);var oe=M;oe._p=new Promise(function(Ae,gt){oe.onload=Ae,oe.onerror=gt}),ma(M,"link",p),h.instance=M}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=pp.bind(a),o.addEventListener("load",h),o.addEventListener("error",h))}}var k1=0;function BO(a,o){return a.stylesheets&&a.count===0&&xp(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var p=setTimeout(function(){if(a.stylesheets&&xp(a,a.stylesheets),a.unsuspend){var M=a.unsuspend;a.unsuspend=null,M()}},6e4+o);0<a.imgBytes&&k1===0&&(k1=62500*CO());var D=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&xp(a,a.stylesheets),a.unsuspend)){var M=a.unsuspend;a.unsuspend=null,M()}},(a.imgBytes>k1?50:800)+o);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(p),clearTimeout(D)}}:null}function pp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xp(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var _p=null;function xp(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,_p=new Map,o.forEach(WO,a),_p=null,pp.call(a))}function WO(a,o){if(!(o.state.loading&4)){var h=_p.get(a);if(h)var p=h.get(null);else{h=new Map,_p.set(a,h);for(var D=a.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<D.length;M++){var oe=D[M];(oe.nodeName==="LINK"||oe.getAttribute("media")!=="not all")&&(h.set(oe.dataset.precedence,oe),p=oe)}p&&h.set(null,p)}D=o.instance,oe=D.getAttribute("data-precedence"),M=h.get(oe)||p,M===p&&h.set(null,D),h.set(oe,D),this.count++,p=pp.bind(this),D.addEventListener("load",p),D.addEventListener("error",p),M?M.parentNode.insertBefore(D,M.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(D,a.firstChild)),o.state.loading|=4}}var pm={$$typeof:L,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function FO(a,o,h,p,D,M,oe,Ae,gt){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xe(0),this.hiddenUpdates=Xe(null),this.identifierPrefix=p,this.onUncaughtError=D,this.onCaughtError=M,this.onRecoverableError=oe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=gt,this.incompleteTransitions=new Map}function jS(a,o,h,p,D,M,oe,Ae,gt,Gt,ns,us){return a=new FO(a,o,h,oe,gt,Gt,ns,us,Ae),o=1,M===!0&&(o|=24),M=Ji(3,null,null,o),a.current=M,M.stateNode=a,o=Sd(),o.refCount++,a.pooledCache=o,o.refCount++,M.memoizedState={element:p,isDehydrated:h,cache:o},Ts(M),a}function IS(a){return a?(a=wi,a):wi}function OS(a,o,h,p,D,M){D=IS(D),p.context===null?p.context=D:p.pendingContext=D,p=on(o),p.payload={element:h},M=M===void 0?null:M,M!==null&&(p.callback=M),h=Nn(a,p,o),h!==null&&(sl(h,a,o),rr(h,a,o))}function MS(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<o?h:o}}function U1(a,o){MS(a,o),(a=a.alternate)&&MS(a,o)}function LS(a){if(a.tag===13||a.tag===31){var o=go(a,67108864);o!==null&&sl(o,a,67108864),U1(a,67108864)}}function wS(a){if(a.tag===13||a.tag===31){var o=Sl();o=jt(o);var h=go(a,o);h!==null&&sl(h,a,o),U1(a,o)}}var Cp=!0;function KO(a,o,h,p){var D=V.T;V.T=null;var M=F.p;try{F.p=2,B1(a,o,h,p)}finally{F.p=M,V.T=D}}function QO(a,o,h,p){var D=V.T;V.T=null;var M=F.p;try{F.p=8,B1(a,o,h,p)}finally{F.p=M,V.T=D}}function B1(a,o,h,p){if(Cp){var D=W1(p);if(D===null)D1(a,o,p,yp,h),AS(a,p);else if(YO(D,a,o,h,p))p.stopPropagation();else if(AS(a,p),o&4&&-1<GO.indexOf(a)){for(;D!==null;){var M=It(D);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var oe=Ce(M.pendingLanes);if(oe!==0){var Ae=M;for(Ae.pendingLanes|=2,Ae.entangledLanes|=2;oe;){var gt=1<<31-rt(oe);Ae.entanglements[1]|=gt,oe&=~gt}Xo(M),(ar&6)===0&&(sp=et()+500,dm(0))}}break;case 31:case 13:Ae=go(M,2),Ae!==null&&sl(Ae,M,2),rp(),U1(M,2)}if(M=W1(p),M===null&&D1(a,o,p,yp,h),M===D)break;D=M}D!==null&&p.stopPropagation()}else D1(a,o,p,null,h)}}function W1(a){return a=Qs(a),F1(a)}var yp=null;function F1(a){if(yp=null,a=qt(a),a!==null){var o=l(a);if(o===null)a=null;else{var h=o.tag;if(h===13){if(a=c(o),a!==null)return a;a=null}else if(h===31){if(a=d(o),a!==null)return a;a=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return yp=a,null}function PS(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bt()){case it:return 2;case At:return 8;case at:case We:return 32;case Dt:return 268435456;default:return 32}default:return 32}}var K1=!1,Ad=null,kd=null,Ud=null,_m=new Map,xm=new Map,Bd=[],GO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function AS(a,o){switch(a){case"focusin":case"focusout":Ad=null;break;case"dragenter":case"dragleave":kd=null;break;case"mouseover":case"mouseout":Ud=null;break;case"pointerover":case"pointerout":_m.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":xm.delete(o.pointerId)}}function Cm(a,o,h,p,D,M){return a===null||a.nativeEvent!==M?(a={blockedOn:o,domEventName:h,eventSystemFlags:p,nativeEvent:M,targetContainers:[D]},o!==null&&(o=It(o),o!==null&&LS(o)),a):(a.eventSystemFlags|=p,o=a.targetContainers,D!==null&&o.indexOf(D)===-1&&o.push(D),a)}function YO(a,o,h,p,D){switch(o){case"focusin":return Ad=Cm(Ad,a,o,h,p,D),!0;case"dragenter":return kd=Cm(kd,a,o,h,p,D),!0;case"mouseover":return Ud=Cm(Ud,a,o,h,p,D),!0;case"pointerover":var M=D.pointerId;return _m.set(M,Cm(_m.get(M)||null,a,o,h,p,D)),!0;case"gotpointercapture":return M=D.pointerId,xm.set(M,Cm(xm.get(M)||null,a,o,h,p,D)),!0}return!1}function kS(a){var o=qt(a.target);if(o!==null){var h=l(o);if(h!==null){if(o=h.tag,o===13){if(o=c(h),o!==null){a.blockedOn=o,Ue(a.priority,function(){wS(h)});return}}else if(o===31){if(o=d(h),o!==null){a.blockedOn=o,Ue(a.priority,function(){wS(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function bp(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var h=W1(a.nativeEvent);if(h===null){h=a.nativeEvent;var p=new h.constructor(h.type,h);Us=p,h.target.dispatchEvent(p),Us=null}else return o=It(h),o!==null&&LS(o),a.blockedOn=h,!1;o.shift()}return!0}function US(a,o,h){bp(a)&&h.delete(o)}function VO(){K1=!1,Ad!==null&&bp(Ad)&&(Ad=null),kd!==null&&bp(kd)&&(kd=null),Ud!==null&&bp(Ud)&&(Ud=null),_m.forEach(US),xm.forEach(US)}function Np(a,o){a.blockedOn===o&&(a.blockedOn=null,K1||(K1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,VO)))}var Sp=null;function BS(a){Sp!==a&&(Sp=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Sp===a&&(Sp=null);for(var o=0;o<a.length;o+=3){var h=a[o],p=a[o+1],D=a[o+2];if(typeof p!="function"){if(F1(p||h)===null)continue;break}var M=It(h);M!==null&&(a.splice(o,3),o-=3,Wx(M,{pending:!0,data:D,method:h.method,action:p},p,D))}}))}function b0(a){function o(gt){return Np(gt,a)}Ad!==null&&Np(Ad,a),kd!==null&&Np(kd,a),Ud!==null&&Np(Ud,a),_m.forEach(o),xm.forEach(o);for(var h=0;h<Bd.length;h++){var p=Bd[h];p.blockedOn===a&&(p.blockedOn=null)}for(;0<Bd.length&&(h=Bd[0],h.blockedOn===null);)kS(h),h.blockedOn===null&&Bd.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var D=h[p],M=h[p+1],oe=D[ds]||null;if(typeof M=="function")oe||BS(h);else if(oe){var Ae=null;if(M&&M.hasAttribute("formAction")){if(D=M,oe=M[ds]||null)Ae=oe.formAction;else if(F1(D)!==null)continue}else Ae=oe.action;typeof Ae=="function"?h[p+1]=Ae:(h.splice(p,3),p-=3),BS(h)}}}function WS(){function a(M){M.canIntercept&&M.info==="react-transition"&&M.intercept({handler:function(){return new Promise(function(oe){return D=oe})},focusReset:"manual",scroll:"manual"})}function o(){D!==null&&(D(),D=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var M=navigation.currentEntry;M&&M.url!=null&&navigation.navigate(M.url,{state:M.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,D=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),D!==null&&(D(),D=null)}}}function Q1(a){this._internalRoot=a}vp.prototype.render=Q1.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(r(409));var h=o.current,p=Sl();OS(h,p,a,o,null,null)},vp.prototype.unmount=Q1.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;OS(a.current,2,null,a,null,null),rp(),o[Ss]=null}};function vp(a){this._internalRoot=a}vp.prototype.unstable_scheduleHydration=function(a){if(a){var o=$t();a={blockedOn:null,target:a,priority:o};for(var h=0;h<Bd.length&&o!==0&&o<Bd[h].priority;h++);Bd.splice(h,0,a),h===0&&kS(a)}};var FS=e.version;if(FS!=="19.2.3")throw Error(r(527,FS,"19.2.3"));F.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=f(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var $O={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dp.isDisabled&&Dp.supportsFiber)try{ze=Dp.inject($O),dt=Dp}catch{}}return bm.createRoot=function(a,o){if(!i(a))throw Error(r(299));var h=!1,p="",D=HN,M=zN,oe=qN;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(D=o.onUncaughtError),o.onCaughtError!==void 0&&(M=o.onCaughtError),o.onRecoverableError!==void 0&&(oe=o.onRecoverableError)),o=jS(a,1,!1,null,null,h,p,null,D,M,oe,WS),a[Ss]=o.current,v1(a),new Q1(o)},bm.hydrateRoot=function(a,o,h){if(!i(a))throw Error(r(299));var p=!1,D="",M=HN,oe=zN,Ae=qN,gt=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(D=h.identifierPrefix),h.onUncaughtError!==void 0&&(M=h.onUncaughtError),h.onCaughtError!==void 0&&(oe=h.onCaughtError),h.onRecoverableError!==void 0&&(Ae=h.onRecoverableError),h.formState!==void 0&&(gt=h.formState)),o=jS(a,1,!0,o,h??null,p,D,gt,M,oe,Ae,WS),o.context=IS(null),h=o.current,p=Sl(),p=jt(p),D=on(p),D.callback=null,Nn(h,D,p),h=p,o.current.lanes=h,Pe(o,h),Xo(o),a[Ss]=o.current,v1(a),new vp(o)},bm.version="19.2.3",bm}var JS;function iM(){if(JS)return $1.exports;JS=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),$1.exports=rM(),$1.exports}var aM=iM();const lM=lb(aM);var jf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},oM={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},su,ab,jT,cM=(jT=class{constructor(){sn(this,su,oM);sn(this,ab,!1)}setTimeoutProvider(t){As(this,su,t)}setTimeout(t,e){return pt(this,su).setTimeout(t,e)}clearTimeout(t){pt(this,su).clearTimeout(t)}setInterval(t,e){return pt(this,su).setInterval(t,e)}clearInterval(t){pt(this,su).clearInterval(t)}},su=new WeakMap,ab=new WeakMap,jT),Zu=new cM;function dM(t){setTimeout(t,0)}var ph=typeof window>"u"||"Deno"in globalThis;function Pa(){}function uM(t,e){return typeof t=="function"?t(e):t}function ay(t){return typeof t=="number"&&t>=0&&t!==1/0}function KT(t,e){return Math.max(t+(e||0)-Date.now(),0)}function gu(t,e){return typeof t=="function"?t(e):t}function Kl(t,e){return typeof t=="function"?t(e):t}function ZS(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:l,queryKey:c,stale:d}=t;if(c){if(r){if(e.queryHash!==cb(c,e.options))return!1}else if(!Xm(e.queryKey,c))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof d=="boolean"&&e.isStale()!==d||i&&i!==e.state.fetchStatus||l&&!l(e))}function ev(t,e){const{exact:n,status:r,predicate:i,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(_h(e.options.mutationKey)!==_h(l))return!1}else if(!Xm(e.options.mutationKey,l))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function cb(t,e){return((e==null?void 0:e.queryKeyHashFn)||_h)(t)}function _h(t){return JSON.stringify(t,(e,n)=>ly(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Xm(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Xm(t[n],e[n])):!1}var hM=Object.prototype.hasOwnProperty;function QT(t,e){if(t===e)return t;const n=tv(t)&&tv(e);if(!n&&!(ly(t)&&ly(e)))return e;const i=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,d=n?new Array(c):{};let u=0;for(let f=0;f<c;f++){const m=n?f:l[f],_=t[m],y=e[m];if(_===y){d[m]=_,(n?f<i:hM.call(t,m))&&u++;continue}if(_===null||y===null||typeof _!="object"||typeof y!="object"){d[m]=y;continue}const g=QT(_,y);d[m]=g,g===_&&u++}return i===c&&u===i?t:d}function x_(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function tv(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function ly(t){if(!sv(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!sv(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function sv(t){return Object.prototype.toString.call(t)==="[object Object]"}function fM(t){return new Promise(e=>{Zu.setTimeout(e,t)})}function oy(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?QT(t,e):e}function mM(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function gM(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var db=Symbol();function GT(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===db?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function YT(t,e){return typeof t=="function"?t(...e):!!t}var rh,nu,lf,IT,pM=(IT=class extends jf{constructor(){super();sn(this,rh);sn(this,nu);sn(this,lf);As(this,lf,e=>{if(!ph&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){pt(this,nu)||this.setEventListener(pt(this,lf))}onUnsubscribe(){var e;this.hasListeners()||((e=pt(this,nu))==null||e.call(this),As(this,nu,void 0))}setEventListener(e){var n;As(this,lf,e),(n=pt(this,nu))==null||n.call(this),As(this,nu,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){pt(this,rh)!==e&&(As(this,rh,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof pt(this,rh)=="boolean"?pt(this,rh):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},rh=new WeakMap,nu=new WeakMap,lf=new WeakMap,IT),ub=new pM;function cy(){let t,e;const n=new Promise((i,l)=>{t=i,e=l});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var _M=dM;function xM(){let t=[],e=0,n=d=>{d()},r=d=>{d()},i=_M;const l=d=>{e?t.push(d):i(()=>{n(d)})},c=()=>{const d=t;t=[],d.length&&i(()=>{r(()=>{d.forEach(u=>{n(u)})})})};return{batch:d=>{let u;e++;try{u=d()}finally{e--,e||c()}return u},batchCalls:d=>(...u)=>{l(()=>{d(...u)})},schedule:l,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{i=d}}}var Yi=xM(),of,ru,cf,OT,CM=(OT=class extends jf{constructor(){super();sn(this,of,!0);sn(this,ru);sn(this,cf);As(this,cf,e=>{if(!ph&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){pt(this,ru)||this.setEventListener(pt(this,cf))}onUnsubscribe(){var e;this.hasListeners()||((e=pt(this,ru))==null||e.call(this),As(this,ru,void 0))}setEventListener(e){var n;As(this,cf,e),(n=pt(this,ru))==null||n.call(this),As(this,ru,e(this.setOnline.bind(this)))}setOnline(e){pt(this,of)!==e&&(As(this,of,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return pt(this,of)}},of=new WeakMap,ru=new WeakMap,cf=new WeakMap,OT),C_=new CM;function yM(t){return Math.min(1e3*2**t,3e4)}function VT(t){return(t??"online")==="online"?C_.isOnline():!0}var dy=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function $T(t){let e=!1,n=0,r;const i=cy(),l=()=>i.status!=="pending",c=C=>{var v;if(!l()){const R=new dy(C);y(R),(v=t.onCancel)==null||v.call(t,R)}},d=()=>{e=!0},u=()=>{e=!1},f=()=>ub.isFocused()&&(t.networkMode==="always"||C_.isOnline())&&t.canRun(),m=()=>VT(t.networkMode)&&t.canRun(),_=C=>{l()||(r==null||r(),i.resolve(C))},y=C=>{l()||(r==null||r(),i.reject(C))},g=()=>new Promise(C=>{var v;r=R=>{(l()||f())&&C(R)},(v=t.onPause)==null||v.call(t)}).then(()=>{var C;r=void 0,l()||(C=t.onContinue)==null||C.call(t)}),N=()=>{if(l())return;let C;const v=n===0?t.initialPromise:void 0;try{C=v??t.fn()}catch(R){C=Promise.reject(R)}Promise.resolve(C).then(_).catch(R=>{var G;if(l())return;const U=t.retry??(ph?0:3),L=t.retryDelay??yM,w=typeof L=="function"?L(n,R):L,P=U===!0||typeof U=="number"&&n<U||typeof U=="function"&&U(n,R);if(e||!P){y(R);return}n++,(G=t.onFail)==null||G.call(t,n,R),fM(w).then(()=>f()?void 0:g()).then(()=>{e?y(R):N()})})};return{promise:i,status:()=>i.status,cancel:c,continue:()=>(r==null||r(),i),cancelRetry:d,continueRetry:u,canStart:m,start:()=>(m()?N():g().then(N),i)}}var ih,MT,HT=(MT=class{constructor(){sn(this,ih)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ay(this.gcTime)&&As(this,ih,Zu.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ph?1/0:300*1e3))}clearGcTimeout(){pt(this,ih)&&(Zu.clearTimeout(pt(this,ih)),As(this,ih,void 0))}},ih=new WeakMap,MT),ah,df,Fl,lh,sa,mg,oh,Do,Qc,LT,bM=(LT=class extends HT{constructor(e){super();sn(this,Do);sn(this,ah);sn(this,df);sn(this,Fl);sn(this,lh);sn(this,sa);sn(this,mg);sn(this,oh);As(this,oh,!1),As(this,mg,e.defaultOptions),this.setOptions(e.options),this.observers=[],As(this,lh,e.client),As(this,Fl,pt(this,lh).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,As(this,ah,rv(this.options)),this.state=e.state??pt(this,ah),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=pt(this,sa))==null?void 0:e.promise}setOptions(e){if(this.options={...pt(this,mg),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=rv(this.options);n.data!==void 0&&(this.setState(nv(n.data,n.dataUpdatedAt)),As(this,ah,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&pt(this,Fl).remove(this)}setData(e,n){const r=oy(this.state.data,e,this.options);return En(this,Do,Qc).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){En(this,Do,Qc).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=pt(this,sa))==null?void 0:r.promise;return(i=pt(this,sa))==null||i.cancel(e),n?n.then(Pa).catch(Pa):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(pt(this,ah))}isActive(){return this.observers.some(e=>Kl(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===db||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>gu(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!KT(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=pt(this,sa))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=pt(this,sa))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),pt(this,Fl).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(pt(this,sa)&&(pt(this,oh)?pt(this,sa).cancel({revert:!0}):pt(this,sa).cancelRetry()),this.scheduleGc()),pt(this,Fl).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||En(this,Do,Qc).call(this,{type:"invalidate"})}async fetch(e,n){var u,f,m,_,y,g,N,C,v,R,U,L;if(this.state.fetchStatus!=="idle"&&((u=pt(this,sa))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(pt(this,sa))return pt(this,sa).continueRetry(),pt(this,sa).promise}if(e&&this.setOptions(e),!this.options.queryFn){const w=this.observers.find(P=>P.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,i=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(As(this,oh,!0),r.signal)})},l=()=>{const w=GT(this.options,n),G=(()=>{const K={client:pt(this,lh),queryKey:this.queryKey,meta:this.meta};return i(K),K})();return As(this,oh,!1),this.options.persister?this.options.persister(w,G,this):w(G)},d=(()=>{const w={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:pt(this,lh),state:this.state,fetchFn:l};return i(w),w})();(f=this.options.behavior)==null||f.onFetch(d,this),As(this,df,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=d.fetchOptions)==null?void 0:m.meta))&&En(this,Do,Qc).call(this,{type:"fetch",meta:(_=d.fetchOptions)==null?void 0:_.meta}),As(this,sa,$T({initialPromise:n==null?void 0:n.initialPromise,fn:d.fetchFn,onCancel:w=>{w instanceof dy&&w.revert&&this.setState({...pt(this,df),fetchStatus:"idle"}),r.abort()},onFail:(w,P)=>{En(this,Do,Qc).call(this,{type:"failed",failureCount:w,error:P})},onPause:()=>{En(this,Do,Qc).call(this,{type:"pause"})},onContinue:()=>{En(this,Do,Qc).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const w=await pt(this,sa).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(g=(y=pt(this,Fl).config).onSuccess)==null||g.call(y,w,this),(C=(N=pt(this,Fl).config).onSettled)==null||C.call(N,w,this.state.error,this),w}catch(w){if(w instanceof dy){if(w.silent)return pt(this,sa).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw En(this,Do,Qc).call(this,{type:"error",error:w}),(R=(v=pt(this,Fl).config).onError)==null||R.call(v,w,this),(L=(U=pt(this,Fl).config).onSettled)==null||L.call(U,this.state.data,w,this),w}finally{this.scheduleGc()}}},ah=new WeakMap,df=new WeakMap,Fl=new WeakMap,lh=new WeakMap,sa=new WeakMap,mg=new WeakMap,oh=new WeakMap,Do=new WeakSet,Qc=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...zT(r.data,this.options),fetchMeta:e.meta??null};case"success":const i={...r,...nv(e.data,e.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return As(this,df,e.manual?i:void 0),i;case"error":const l=e.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),Yi.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),pt(this,Fl).notify({query:this,type:"updated",action:e})})},LT);function zT(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:VT(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function nv(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function rv(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var nl,Kn,gg,La,ch,uf,Hc,iu,pg,hf,ff,dh,uh,au,mf,ur,Lm,uy,hy,fy,my,gy,py,_y,qT,wT,NM=(wT=class extends jf{constructor(e,n){super();sn(this,ur);sn(this,nl);sn(this,Kn);sn(this,gg);sn(this,La);sn(this,ch);sn(this,uf);sn(this,Hc);sn(this,iu);sn(this,pg);sn(this,hf);sn(this,ff);sn(this,dh);sn(this,uh);sn(this,au);sn(this,mf,new Set);this.options=n,As(this,nl,e),As(this,iu,null),As(this,Hc,cy()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(pt(this,Kn).addObserver(this),iv(pt(this,Kn),this.options)?En(this,ur,Lm).call(this):this.updateResult(),En(this,ur,my).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return xy(pt(this,Kn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return xy(pt(this,Kn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,En(this,ur,gy).call(this),En(this,ur,py).call(this),pt(this,Kn).removeObserver(this)}setOptions(e){const n=this.options,r=pt(this,Kn);if(this.options=pt(this,nl).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Kl(this.options.enabled,pt(this,Kn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");En(this,ur,_y).call(this),pt(this,Kn).setOptions(this.options),n._defaulted&&!x_(this.options,n)&&pt(this,nl).getQueryCache().notify({type:"observerOptionsUpdated",query:pt(this,Kn),observer:this});const i=this.hasListeners();i&&av(pt(this,Kn),r,this.options,n)&&En(this,ur,Lm).call(this),this.updateResult(),i&&(pt(this,Kn)!==r||Kl(this.options.enabled,pt(this,Kn))!==Kl(n.enabled,pt(this,Kn))||gu(this.options.staleTime,pt(this,Kn))!==gu(n.staleTime,pt(this,Kn)))&&En(this,ur,uy).call(this);const l=En(this,ur,hy).call(this);i&&(pt(this,Kn)!==r||Kl(this.options.enabled,pt(this,Kn))!==Kl(n.enabled,pt(this,Kn))||l!==pt(this,au))&&En(this,ur,fy).call(this,l)}getOptimisticResult(e){const n=pt(this,nl).getQueryCache().build(pt(this,nl),e),r=this.createResult(n,e);return vM(this,r)&&(As(this,La,r),As(this,uf,this.options),As(this,ch,pt(this,Kn).state)),r}getCurrentResult(){return pt(this,La)}trackResult(e,n){return new Proxy(e,{get:(r,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&pt(this,Hc).status==="pending"&&pt(this,Hc).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,i))})}trackProp(e){pt(this,mf).add(e)}getCurrentQuery(){return pt(this,Kn)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=pt(this,nl).defaultQueryOptions(e),r=pt(this,nl).getQueryCache().build(pt(this,nl),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return En(this,ur,Lm).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),pt(this,La)))}createResult(e,n){var O;const r=pt(this,Kn),i=this.options,l=pt(this,La),c=pt(this,ch),d=pt(this,uf),f=e!==r?e.state:pt(this,gg),{state:m}=e;let _={...m},y=!1,g;if(n._optimisticResults){const S=this.hasListeners(),A=!S&&iv(e,n),Y=S&&av(e,r,n,i);(A||Y)&&(_={..._,...zT(m.data,e.options)}),n._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:N,errorUpdatedAt:C,status:v}=_;g=_.data;let R=!1;if(n.placeholderData!==void 0&&g===void 0&&v==="pending"){let S;l!=null&&l.isPlaceholderData&&n.placeholderData===(d==null?void 0:d.placeholderData)?(S=l.data,R=!0):S=typeof n.placeholderData=="function"?n.placeholderData((O=pt(this,ff))==null?void 0:O.state.data,pt(this,ff)):n.placeholderData,S!==void 0&&(v="success",g=oy(l==null?void 0:l.data,S,n),y=!0)}if(n.select&&g!==void 0&&!R)if(l&&g===(c==null?void 0:c.data)&&n.select===pt(this,pg))g=pt(this,hf);else try{As(this,pg,n.select),g=n.select(g),g=oy(l==null?void 0:l.data,g,n),As(this,hf,g),As(this,iu,null)}catch(S){As(this,iu,S)}pt(this,iu)&&(N=pt(this,iu),g=pt(this,hf),C=Date.now(),v="error");const U=_.fetchStatus==="fetching",L=v==="pending",w=v==="error",P=L&&U,G=g!==void 0,B={status:v,fetchStatus:_.fetchStatus,isPending:L,isSuccess:v==="success",isError:w,isInitialLoading:P,isLoading:P,data:g,dataUpdatedAt:_.dataUpdatedAt,error:N,errorUpdatedAt:C,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>f.dataUpdateCount||_.errorUpdateCount>f.errorUpdateCount,isFetching:U,isRefetching:U&&!L,isLoadingError:w&&!G,isPaused:_.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:w&&G,isStale:hb(e,n),refetch:this.refetch,promise:pt(this,Hc),isEnabled:Kl(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const S=te=>{B.status==="error"?te.reject(B.error):B.data!==void 0&&te.resolve(B.data)},A=()=>{const te=As(this,Hc,B.promise=cy());S(te)},Y=pt(this,Hc);switch(Y.status){case"pending":e.queryHash===r.queryHash&&S(Y);break;case"fulfilled":(B.status==="error"||B.data!==Y.value)&&A();break;case"rejected":(B.status!=="error"||B.error!==Y.reason)&&A();break}}return B}updateResult(){const e=pt(this,La),n=this.createResult(pt(this,Kn),this.options);if(As(this,ch,pt(this,Kn).state),As(this,uf,this.options),pt(this,ch).data!==void 0&&As(this,ff,pt(this,Kn)),x_(n,e))return;As(this,La,n);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,l=typeof i=="function"?i():i;if(l==="all"||!l&&!pt(this,mf).size)return!0;const c=new Set(l??pt(this,mf));return this.options.throwOnError&&c.add("error"),Object.keys(pt(this,La)).some(d=>{const u=d;return pt(this,La)[u]!==e[u]&&c.has(u)})};En(this,ur,qT).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&En(this,ur,my).call(this)}},nl=new WeakMap,Kn=new WeakMap,gg=new WeakMap,La=new WeakMap,ch=new WeakMap,uf=new WeakMap,Hc=new WeakMap,iu=new WeakMap,pg=new WeakMap,hf=new WeakMap,ff=new WeakMap,dh=new WeakMap,uh=new WeakMap,au=new WeakMap,mf=new WeakMap,ur=new WeakSet,Lm=function(e){En(this,ur,_y).call(this);let n=pt(this,Kn).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Pa)),n},uy=function(){En(this,ur,gy).call(this);const e=gu(this.options.staleTime,pt(this,Kn));if(ph||pt(this,La).isStale||!ay(e))return;const r=KT(pt(this,La).dataUpdatedAt,e)+1;As(this,dh,Zu.setTimeout(()=>{pt(this,La).isStale||this.updateResult()},r))},hy=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(pt(this,Kn)):this.options.refetchInterval)??!1},fy=function(e){En(this,ur,py).call(this),As(this,au,e),!(ph||Kl(this.options.enabled,pt(this,Kn))===!1||!ay(pt(this,au))||pt(this,au)===0)&&As(this,uh,Zu.setInterval(()=>{(this.options.refetchIntervalInBackground||ub.isFocused())&&En(this,ur,Lm).call(this)},pt(this,au)))},my=function(){En(this,ur,uy).call(this),En(this,ur,fy).call(this,En(this,ur,hy).call(this))},gy=function(){pt(this,dh)&&(Zu.clearTimeout(pt(this,dh)),As(this,dh,void 0))},py=function(){pt(this,uh)&&(Zu.clearInterval(pt(this,uh)),As(this,uh,void 0))},_y=function(){const e=pt(this,nl).getQueryCache().build(pt(this,nl),this.options);if(e===pt(this,Kn))return;const n=pt(this,Kn);As(this,Kn,e),As(this,gg,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},qT=function(e){Yi.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(pt(this,La))}),pt(this,nl).getQueryCache().notify({query:pt(this,Kn),type:"observerResultsUpdated"})})},wT);function SM(t,e){return Kl(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function iv(t,e){return SM(t,e)||t.state.data!==void 0&&xy(t,e,e.refetchOnMount)}function xy(t,e,n){if(Kl(e.enabled,t)!==!1&&gu(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&hb(t,e)}return!1}function av(t,e,n,r){return(t!==e||Kl(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&hb(t,n)}function hb(t,e){return Kl(e.enabled,t)!==!1&&t.isStaleByTime(gu(e.staleTime,t))}function vM(t,e){return!x_(t.getCurrentResult(),e)}function lv(t){return{onFetch:(e,n)=>{var m,_,y,g,N;const r=e.options,i=(y=(_=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:_.fetchMore)==null?void 0:y.direction,l=((g=e.state.data)==null?void 0:g.pages)||[],c=((N=e.state.data)==null?void 0:N.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const f=async()=>{let C=!1;const v=L=>{Object.defineProperty(L,"signal",{enumerable:!0,get:()=>(e.signal.aborted?C=!0:e.signal.addEventListener("abort",()=>{C=!0}),e.signal)})},R=GT(e.options,e.fetchOptions),U=async(L,w,P)=>{if(C)return Promise.reject();if(w==null&&L.pages.length)return Promise.resolve(L);const K=(()=>{const A={client:e.client,queryKey:e.queryKey,pageParam:w,direction:P?"backward":"forward",meta:e.options.meta};return v(A),A})(),B=await R(K),{maxPages:O}=e.options,S=P?gM:mM;return{pages:S(L.pages,B,O),pageParams:S(L.pageParams,w,O)}};if(i&&l.length){const L=i==="backward",w=L?DM:ov,P={pages:l,pageParams:c},G=w(r,P);d=await U(P,G,L)}else{const L=t??l.length;do{const w=u===0?c[0]??r.initialPageParam:ov(r,d);if(u>0&&w==null)break;d=await U(d,w),u++}while(u<L)}return d};e.options.persister?e.fetchFn=()=>{var C,v;return(v=(C=e.options).persister)==null?void 0:v.call(C,f,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=f}}}function ov(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function DM(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var _g,sc,wa,hh,nc,Xd,PT,RM=(PT=class extends HT{constructor(e){super();sn(this,nc);sn(this,_g);sn(this,sc);sn(this,wa);sn(this,hh);As(this,_g,e.client),this.mutationId=e.mutationId,As(this,wa,e.mutationCache),As(this,sc,[]),this.state=e.state||XT(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){pt(this,sc).includes(e)||(pt(this,sc).push(e),this.clearGcTimeout(),pt(this,wa).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){As(this,sc,pt(this,sc).filter(n=>n!==e)),this.scheduleGc(),pt(this,wa).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){pt(this,sc).length||(this.state.status==="pending"?this.scheduleGc():pt(this,wa).remove(this))}continue(){var e;return((e=pt(this,hh))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var c,d,u,f,m,_,y,g,N,C,v,R,U,L,w,P,G,K,B,O;const n=()=>{En(this,nc,Xd).call(this,{type:"continue"})},r={client:pt(this,_g),meta:this.options.meta,mutationKey:this.options.mutationKey};As(this,hh,$T({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(S,A)=>{En(this,nc,Xd).call(this,{type:"failed",failureCount:S,error:A})},onPause:()=>{En(this,nc,Xd).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>pt(this,wa).canRun(this)}));const i=this.state.status==="pending",l=!pt(this,hh).canStart();try{if(i)n();else{En(this,nc,Xd).call(this,{type:"pending",variables:e,isPaused:l}),await((d=(c=pt(this,wa).config).onMutate)==null?void 0:d.call(c,e,this,r));const A=await((f=(u=this.options).onMutate)==null?void 0:f.call(u,e,r));A!==this.state.context&&En(this,nc,Xd).call(this,{type:"pending",context:A,variables:e,isPaused:l})}const S=await pt(this,hh).start();return await((_=(m=pt(this,wa).config).onSuccess)==null?void 0:_.call(m,S,e,this.state.context,this,r)),await((g=(y=this.options).onSuccess)==null?void 0:g.call(y,S,e,this.state.context,r)),await((C=(N=pt(this,wa).config).onSettled)==null?void 0:C.call(N,S,null,this.state.variables,this.state.context,this,r)),await((R=(v=this.options).onSettled)==null?void 0:R.call(v,S,null,e,this.state.context,r)),En(this,nc,Xd).call(this,{type:"success",data:S}),S}catch(S){try{throw await((L=(U=pt(this,wa).config).onError)==null?void 0:L.call(U,S,e,this.state.context,this,r)),await((P=(w=this.options).onError)==null?void 0:P.call(w,S,e,this.state.context,r)),await((K=(G=pt(this,wa).config).onSettled)==null?void 0:K.call(G,void 0,S,this.state.variables,this.state.context,this,r)),await((O=(B=this.options).onSettled)==null?void 0:O.call(B,void 0,S,e,this.state.context,r)),S}finally{En(this,nc,Xd).call(this,{type:"error",error:S})}}finally{pt(this,wa).runNext(this)}}},_g=new WeakMap,sc=new WeakMap,wa=new WeakMap,hh=new WeakMap,nc=new WeakSet,Xd=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Yi.batch(()=>{pt(this,sc).forEach(r=>{r.onMutationUpdate(e)}),pt(this,wa).notify({mutation:this,type:"updated",action:e})})},PT);function XT(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var zc,Ro,xg,AT,TM=(AT=class extends jf{constructor(e={}){super();sn(this,zc);sn(this,Ro);sn(this,xg);this.config=e,As(this,zc,new Set),As(this,Ro,new Map),As(this,xg,0)}build(e,n,r){const i=new RM({client:e,mutationCache:this,mutationId:++Rp(this,xg)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){pt(this,zc).add(e);const n=Tp(e);if(typeof n=="string"){const r=pt(this,Ro).get(n);r?r.push(e):pt(this,Ro).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(pt(this,zc).delete(e)){const n=Tp(e);if(typeof n=="string"){const r=pt(this,Ro).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&pt(this,Ro).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Tp(e);if(typeof n=="string"){const r=pt(this,Ro).get(n),i=r==null?void 0:r.find(l=>l.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=Tp(e);if(typeof n=="string"){const i=(r=pt(this,Ro).get(n))==null?void 0:r.find(l=>l!==e&&l.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Yi.batch(()=>{pt(this,zc).forEach(e=>{this.notify({type:"removed",mutation:e})}),pt(this,zc).clear(),pt(this,Ro).clear()})}getAll(){return Array.from(pt(this,zc))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>ev(n,r))}findAll(e={}){return this.getAll().filter(n=>ev(e,n))}notify(e){Yi.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Yi.batch(()=>Promise.all(e.map(n=>n.continue().catch(Pa))))}},zc=new WeakMap,Ro=new WeakMap,xg=new WeakMap,AT);function Tp(t){var e;return(e=t.options.scope)==null?void 0:e.id}var qc,lu,rl,Xc,sd,i_,Cy,kT,EM=(kT=class extends jf{constructor(n,r){super();sn(this,sd);sn(this,qc);sn(this,lu);sn(this,rl);sn(this,Xc);As(this,qc,n),this.setOptions(r),this.bindMethods(),En(this,sd,i_).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=pt(this,qc).defaultMutationOptions(n),x_(this.options,r)||pt(this,qc).getMutationCache().notify({type:"observerOptionsUpdated",mutation:pt(this,rl),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&_h(r.mutationKey)!==_h(this.options.mutationKey)?this.reset():((i=pt(this,rl))==null?void 0:i.state.status)==="pending"&&pt(this,rl).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=pt(this,rl))==null||n.removeObserver(this)}onMutationUpdate(n){En(this,sd,i_).call(this),En(this,sd,Cy).call(this,n)}getCurrentResult(){return pt(this,lu)}reset(){var n;(n=pt(this,rl))==null||n.removeObserver(this),As(this,rl,void 0),En(this,sd,i_).call(this),En(this,sd,Cy).call(this)}mutate(n,r){var i;return As(this,Xc,r),(i=pt(this,rl))==null||i.removeObserver(this),As(this,rl,pt(this,qc).getMutationCache().build(pt(this,qc),this.options)),pt(this,rl).addObserver(this),pt(this,rl).execute(n)}},qc=new WeakMap,lu=new WeakMap,rl=new WeakMap,Xc=new WeakMap,sd=new WeakSet,i_=function(){var r;const n=((r=pt(this,rl))==null?void 0:r.state)??XT();As(this,lu,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Cy=function(n){Yi.batch(()=>{var r,i,l,c,d,u,f,m;if(pt(this,Xc)&&this.hasListeners()){const _=pt(this,lu).variables,y=pt(this,lu).context,g={client:pt(this,qc),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((i=(r=pt(this,Xc)).onSuccess)==null||i.call(r,n.data,_,y,g),(c=(l=pt(this,Xc)).onSettled)==null||c.call(l,n.data,null,_,y,g)):(n==null?void 0:n.type)==="error"&&((u=(d=pt(this,Xc)).onError)==null||u.call(d,n.error,_,y,g),(m=(f=pt(this,Xc)).onSettled)==null||m.call(f,void 0,n.error,_,y,g))}this.listeners.forEach(_=>{_(pt(this,lu))})})},kT),rc,UT,jM=(UT=class extends jf{constructor(e={}){super();sn(this,rc);this.config=e,As(this,rc,new Map)}build(e,n,r){const i=n.queryKey,l=n.queryHash??cb(i,n);let c=this.get(l);return c||(c=new bM({client:e,queryKey:i,queryHash:l,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(c)),c}add(e){pt(this,rc).has(e.queryHash)||(pt(this,rc).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=pt(this,rc).get(e.queryHash);n&&(e.destroy(),n===e&&pt(this,rc).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Yi.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return pt(this,rc).get(e)}getAll(){return[...pt(this,rc).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>ZS(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>ZS(e,r)):n}notify(e){Yi.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Yi.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Yi.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},rc=new WeakMap,UT),ui,ou,cu,gf,pf,du,_f,xf,BT,IM=(BT=class{constructor(t={}){sn(this,ui);sn(this,ou);sn(this,cu);sn(this,gf);sn(this,pf);sn(this,du);sn(this,_f);sn(this,xf);As(this,ui,t.queryCache||new jM),As(this,ou,t.mutationCache||new TM),As(this,cu,t.defaultOptions||{}),As(this,gf,new Map),As(this,pf,new Map),As(this,du,0)}mount(){Rp(this,du)._++,pt(this,du)===1&&(As(this,_f,ub.subscribe(async t=>{t&&(await this.resumePausedMutations(),pt(this,ui).onFocus())})),As(this,xf,C_.subscribe(async t=>{t&&(await this.resumePausedMutations(),pt(this,ui).onOnline())})))}unmount(){var t,e;Rp(this,du)._--,pt(this,du)===0&&((t=pt(this,_f))==null||t.call(this),As(this,_f,void 0),(e=pt(this,xf))==null||e.call(this),As(this,xf,void 0))}isFetching(t){return pt(this,ui).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return pt(this,ou).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=pt(this,ui).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=pt(this,ui).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(gu(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return pt(this,ui).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=pt(this,ui).get(r.queryHash),l=i==null?void 0:i.state.data,c=uM(e,l);if(c!==void 0)return pt(this,ui).build(this,r).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return Yi.batch(()=>pt(this,ui).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=pt(this,ui).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=pt(this,ui);Yi.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=pt(this,ui);return Yi.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Yi.batch(()=>pt(this,ui).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(Pa).catch(Pa)}invalidateQueries(t,e={}){return Yi.batch(()=>(pt(this,ui).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Yi.batch(()=>pt(this,ui).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let l=i.fetch(void 0,n);return n.throwOnError||(l=l.catch(Pa)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(Pa)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=pt(this,ui).build(this,e);return n.isStaleByTime(gu(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Pa).catch(Pa)}fetchInfiniteQuery(t){return t.behavior=lv(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Pa).catch(Pa)}ensureInfiniteQueryData(t){return t.behavior=lv(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return C_.isOnline()?pt(this,ou).resumePausedMutations():Promise.resolve()}getQueryCache(){return pt(this,ui)}getMutationCache(){return pt(this,ou)}getDefaultOptions(){return pt(this,cu)}setDefaultOptions(t){As(this,cu,t)}setQueryDefaults(t,e){pt(this,gf).set(_h(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...pt(this,gf).values()],n={};return e.forEach(r=>{Xm(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){pt(this,pf).set(_h(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...pt(this,pf).values()],n={};return e.forEach(r=>{Xm(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...pt(this,cu).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=cb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===db&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...pt(this,cu).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){pt(this,ui).clear(),pt(this,ou).clear()}},ui=new WeakMap,ou=new WeakMap,cu=new WeakMap,gf=new WeakMap,pf=new WeakMap,du=new WeakMap,_f=new WeakMap,xf=new WeakMap,BT),JT=x.createContext(void 0),fb=t=>{const e=x.useContext(JT);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},OM=({client:t,children:e})=>(x.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(JT.Provider,{value:t,children:e})),ZT=x.createContext(!1),MM=()=>x.useContext(ZT);ZT.Provider;function LM(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var wM=x.createContext(LM()),PM=()=>x.useContext(wM),AM=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},kM=t=>{x.useEffect(()=>{t.clearReset()},[t])},UM=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||YT(n,[t.error,r])),BM=t=>{if(t.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},WM=(t,e)=>t.isLoading&&t.isFetching&&!e,FM=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,cv=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function KM(t,e,n){var _,y,g,N,C;const r=MM(),i=PM(),l=fb(),c=l.defaultQueryOptions(t);(y=(_=l.getDefaultOptions().queries)==null?void 0:_._experimental_beforeQuery)==null||y.call(_,c),c._optimisticResults=r?"isRestoring":"optimistic",BM(c),AM(c,i),kM(i);const d=!l.getQueryCache().get(c.queryHash),[u]=x.useState(()=>new e(l,c)),f=u.getOptimisticResult(c),m=!r&&t.subscribed!==!1;if(x.useSyncExternalStore(x.useCallback(v=>{const R=m?u.subscribe(Yi.batchCalls(v)):Pa;return u.updateResult(),R},[u,m]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),x.useEffect(()=>{u.setOptions(c)},[c,u]),FM(c,f))throw cv(c,u,i);if(UM({result:f,errorResetBoundary:i,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw f.error;if((N=(g=l.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||N.call(g,c,f),c.experimental_prefetchInRender&&!ph&&WM(f,r)){const v=d?cv(c,u,i):(C=l.getQueryCache().get(c.queryHash))==null?void 0:C.promise;v==null||v.catch(Pa).finally(()=>{u.updateResult()})}return c.notifyOnChangeProps?f:u.trackResult(f)}function QM(t,e){return KM(t,NM)}function GM(t,e){const n=fb(),[r]=x.useState(()=>new EM(n,t));x.useEffect(()=>{r.setOptions(t)},[r,t]);const i=x.useSyncExternalStore(x.useCallback(c=>r.subscribe(Yi.batchCalls(c)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=x.useCallback((c,d)=>{r.mutate(c,d).catch(Pa)},[r]);if(i.error&&YT(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}const YM="modulepreload",VM=function(t){return"/"+t},dv={},X1=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let c=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));i=c(n.map(f=>{if(f=VM(f),f in dv)return;dv[f]=!0;const m=f.endsWith(".css"),_=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":YM,m||(y.as="script"),y.crossOrigin="",y.href=f,u&&y.setAttribute("nonce",u),document.head.appendChild(y),m)return new Promise((g,N)=>{y.addEventListener("load",g),y.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};var $M=function(){return null};const uv=new IM({defaultOptions:{queries:{staleTime:300*1e3,gcTime:600*1e3,retry:1,retryDelay:1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!0,networkMode:"online"},mutations:{retry:0,networkMode:"online"}}});/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),hv=t=>{const e=zM(t);return e.charAt(0).toUpperCase()+e.slice(1)},e5=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),qM=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var XM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=x.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:l,iconNode:c,...d},u)=>x.createElement("svg",{ref:u,...XM,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:e5("lucide",i),...!l&&!qM(d)&&{"aria-hidden":"true"},...d},[...c.map(([f,m])=>x.createElement(f,m)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=(t,e)=>{const n=x.forwardRef(({className:r,...i},l)=>x.createElement(JM,{ref:l,iconNode:e,className:e5(`lucide-${HM(hv(t))}`,`lucide-${t}`,r),...i}));return n.displayName=hv(t),n};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Rh=ks("arrow-down",ZM);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],mb=ks("arrow-left",eL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tL=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],sL=ks("arrow-right-left",tL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],rL=ks("arrow-right",nL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iL=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Th=ks("arrow-up",iL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aL=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],lL=ks("boxes",aL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oL=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],cL=ks("building-2",oL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]],uL=ks("cable",dL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Cf=ks("calendar",hL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],fv=ks("camera",fL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],dc=ks("check",mL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sr=ks("chevron-down",gL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],t5=ks("chevron-left",pL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _L=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],xL=ks("chevron-right",_L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Mr=ks("chevron-up",CL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Wr=ks("circle-alert",yL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Vi=ks("circle-check-big",bL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Eh=ks("circle-check",NL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Lo=ks("circle-x",SL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Z_=ks("clipboard-list",vL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],y_=ks("clock",DL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],b_=ks("credit-card",RL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],EL=ks("crown",TL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],s5=ks("database",jL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],n5=ks("ellipsis",IL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Nm=ks("external-link",OL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],LL=ks("file-down",ML);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xh=ks("file-text",wL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],r5=ks("funnel",PL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AL=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],nd=ks("history",AL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],UL=ks("house",kL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],i5=ks("info",BL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],FL=ks("layers",WL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],gb=ks("list",KL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],jn=ks("loader-circle",QL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],YL=ks("log-out",GL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],rd=ks("map-pin",VL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],HL=ks("map",$L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],qL=ks("menu",zL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],mv=ks("message-square",XL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],ZL=ks("monitor",JL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],tw=ks("navigation",ew);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],yf=ks("package",sw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],rw=ks("pause",nw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],aw=ks("pen-tool",iw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lw=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],yy=ks("phone",lw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],cw=ks("play",ow);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],uw=ks("plus",dw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hw=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],uc=ks("refresh-cw",hw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ei=ks("rotate-ccw",fw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mw=[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]],gw=ks("router",mw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pw=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],_w=ks("save",pw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],jh=ks("scan-barcode",xw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],yu=ks("search",Cw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],pb=ks("send",yw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],gv=ks("server",bw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_b=ks("settings",Nw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],pv=ks("shield",Sw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],by=ks("smartphone",vw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],N_=ks("square-check-big",Dw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],S_=ks("square-x",Rw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],Ew=ks("test-tube",Tw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Iw=ks("trash-2",jw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ql=ks("triangle-alert",Ow);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],Lw=ks("tv",Mw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Pw=ks("user-check",ww);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],kw=ks("user-plus",Aw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ih=ks("user",Uw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],a5=ks("users",Bw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],v_=ks("wifi",Ww);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],pu=ks("wrench",Fw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bi=ks("x",Kw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],_v=ks("zap",Qw),Gw=({className:t})=>s.jsx("div",{className:`font-extrabold tracking-tight ${t}`,style:{fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},children:"D'LIVE"}),Yw=({onLogout:t,onNavigateHome:e,onNavigateBack:n,onMenuClick:r,currentView:i,userInfo:l,selectedWorkItem:c})=>{const[d,u]=x.useState(!1),f=x.useRef(null);x.useEffect(()=>{const g=N=>{f.current&&!f.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const _=(g=>{const N=(c==null?void 0:c.WRK_CD_NM)||(c==null?void 0:c.typeDisplay)||"";switch(g){case"today-work":return{title:" "};case"work-management":return{title:""};case"work-order-detail":return{title:""};case"work-complete-form":return{title:"",workType:N};case"work-complete-detail":return{title:"",workType:N};case"work-item-list":return{title:""};case"work-process-flow":return{title:"",workType:N};case"customer-management":return{title:""};case"equipment-management":return{title:""};case"other-management":return{title:""};case"coming-soon":return{title:""};default:return null}})(i),y=i==="today-work"||i==="menu"||!i;return s.jsx("header",{className:"bg-white shadow-sm fixed top-0 left-0 right-0 z-[100] border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6",children:s.jsxs("div",{className:"flex items-center h-12",children:[s.jsxs("div",{className:"flex items-center gap-0 w-24 flex-shrink-0",children:[!y&&s.jsx("button",{onClick:n||e,className:"p-1.5 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors duration-200","aria-label":"",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),r&&s.jsx("button",{onClick:r,className:"p-1.5 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors duration-200","aria-label":" ",children:s.jsx(qL,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:y?s.jsx("button",{onClick:e,className:"flex items-center cursor-pointer","aria-label":"  ",children:s.jsx(Gw,{className:"text-xl text-blue-600"})}):_?s.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[_.title,_.workType&&s.jsxs("span",{className:"text-blue-600",children:["(",_.workType,")"]})]}):null}),s.jsx("div",{className:"w-24 flex-shrink-0 flex justify-end",children:s.jsxs("div",{className:"relative",ref:f,children:[s.jsxs("button",{onClick:()=>u(!d),className:`flex flex-col items-center p-1.5 rounded-lg transition-colors duration-200 ${d?"text-blue-700 bg-blue-50":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,"aria-label":" ",children:[s.jsx(Ih,{className:"w-4 h-4"}),s.jsx("span",{className:"text-[0.5625rem] mt-0.5 truncate max-w-[60px]",children:l?`${l.userName||""}`:""})]}),d&&s.jsxs("div",{className:"fixed right-2 top-12 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[9999]",children:[s.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.userName)||""}),s.jsx("p",{className:"text-xs text-gray-500",children:(l==null?void 0:l.userId)||""}),s.jsx("p",{className:"text-xs text-gray-400",children:(l==null?void 0:l.userRole)||""})]}),s.jsx("button",{onClick:()=>{u(!1),t()},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:""})]})]})})]})})})};var a_={exports:{}},Vw=a_.exports,xv;function $w(){return xv||(xv=1,(function(t,e){(function(n,r){t.exports=r()})(Vw,(function(){var n=1e3,r=6e4,i=36e5,l="millisecond",c="second",d="minute",u="hour",f="day",m="week",_="month",y="quarter",g="year",N="date",C="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,R=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,U={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(J){var q=["th","st","nd","rd"],V=J%100;return"["+J+(q[(V-20)%10]||q[V]||q[0])+"]"}},L=function(J,q,V){var F=String(J);return!F||F.length>=q?J:""+Array(q+1-F.length).join(V)+J},w={s:L,z:function(J){var q=-J.utcOffset(),V=Math.abs(q),F=Math.floor(V/60),I=V%60;return(q<=0?"+":"-")+L(F,2,"0")+":"+L(I,2,"0")},m:function J(q,V){if(q.date()<V.date())return-J(V,q);var F=12*(V.year()-q.year())+(V.month()-q.month()),I=q.clone().add(F,_),ee=V-I<0,ae=q.clone().add(F+(ee?-1:1),_);return+(-(F+(V-I)/(ee?I-ae:ae-I))||0)},a:function(J){return J<0?Math.ceil(J)||0:Math.floor(J)},p:function(J){return{M:_,y:g,w:m,d:f,D:N,h:u,m:d,s:c,ms:l,Q:y}[J]||String(J||"").toLowerCase().replace(/s$/,"")},u:function(J){return J===void 0}},P="en",G={};G[P]=U;var K="$isDayjsObject",B=function(J){return J instanceof Y||!(!J||!J[K])},O=function J(q,V,F){var I;if(!q)return P;if(typeof q=="string"){var ee=q.toLowerCase();G[ee]&&(I=ee),V&&(G[ee]=V,I=ee);var ae=q.split("-");if(!I&&ae.length>1)return J(ae[0])}else{var T=q.name;G[T]=q,I=T}return!F&&I&&(P=I),I||!F&&P},S=function(J,q){if(B(J))return J.clone();var V=typeof q=="object"?q:{};return V.date=J,V.args=arguments,new Y(V)},A=w;A.l=O,A.i=B,A.w=function(J,q){return S(J,{locale:q.$L,utc:q.$u,x:q.$x,$offset:q.$offset})};var Y=(function(){function J(V){this.$L=O(V.locale,null,!0),this.parse(V),this.$x=this.$x||V.x||{},this[K]=!0}var q=J.prototype;return q.parse=function(V){this.$d=(function(F){var I=F.date,ee=F.utc;if(I===null)return new Date(NaN);if(A.u(I))return new Date;if(I instanceof Date)return new Date(I);if(typeof I=="string"&&!/Z$/i.test(I)){var ae=I.match(v);if(ae){var T=ae[2]-1||0,j=(ae[7]||"0").substring(0,3);return ee?new Date(Date.UTC(ae[1],T,ae[3]||1,ae[4]||0,ae[5]||0,ae[6]||0,j)):new Date(ae[1],T,ae[3]||1,ae[4]||0,ae[5]||0,ae[6]||0,j)}}return new Date(I)})(V),this.init()},q.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},q.$utils=function(){return A},q.isValid=function(){return this.$d.toString()!==C},q.isSame=function(V,F){var I=S(V);return this.startOf(F)<=I&&I<=this.endOf(F)},q.isAfter=function(V,F){return S(V)<this.startOf(F)},q.isBefore=function(V,F){return this.endOf(F)<S(V)},q.$g=function(V,F,I){return A.u(V)?this[F]:this.set(I,V)},q.unix=function(){return Math.floor(this.valueOf()/1e3)},q.valueOf=function(){return this.$d.getTime()},q.startOf=function(V,F){var I=this,ee=!!A.u(F)||F,ae=A.p(V),T=function(pe,de){var Re=A.w(I.$u?Date.UTC(I.$y,de,pe):new Date(I.$y,de,pe),I);return ee?Re:Re.endOf(f)},j=function(pe,de){return A.w(I.toDate()[pe].apply(I.toDate("s"),(ee?[0,0,0,0]:[23,59,59,999]).slice(de)),I)},k=this.$W,Q=this.$M,H=this.$D,$="set"+(this.$u?"UTC":"");switch(ae){case g:return ee?T(1,0):T(31,11);case _:return ee?T(1,Q):T(0,Q+1);case m:var ie=this.$locale().weekStart||0,fe=(k<ie?k+7:k)-ie;return T(ee?H-fe:H+(6-fe),Q);case f:case N:return j($+"Hours",0);case u:return j($+"Minutes",1);case d:return j($+"Seconds",2);case c:return j($+"Milliseconds",3);default:return this.clone()}},q.endOf=function(V){return this.startOf(V,!1)},q.$set=function(V,F){var I,ee=A.p(V),ae="set"+(this.$u?"UTC":""),T=(I={},I[f]=ae+"Date",I[N]=ae+"Date",I[_]=ae+"Month",I[g]=ae+"FullYear",I[u]=ae+"Hours",I[d]=ae+"Minutes",I[c]=ae+"Seconds",I[l]=ae+"Milliseconds",I)[ee],j=ee===f?this.$D+(F-this.$W):F;if(ee===_||ee===g){var k=this.clone().set(N,1);k.$d[T](j),k.init(),this.$d=k.set(N,Math.min(this.$D,k.daysInMonth())).$d}else T&&this.$d[T](j);return this.init(),this},q.set=function(V,F){return this.clone().$set(V,F)},q.get=function(V){return this[A.p(V)]()},q.add=function(V,F){var I,ee=this;V=Number(V);var ae=A.p(F),T=function(Q){var H=S(ee);return A.w(H.date(H.date()+Math.round(Q*V)),ee)};if(ae===_)return this.set(_,this.$M+V);if(ae===g)return this.set(g,this.$y+V);if(ae===f)return T(1);if(ae===m)return T(7);var j=(I={},I[d]=r,I[u]=i,I[c]=n,I)[ae]||1,k=this.$d.getTime()+V*j;return A.w(k,this)},q.subtract=function(V,F){return this.add(-1*V,F)},q.format=function(V){var F=this,I=this.$locale();if(!this.isValid())return I.invalidDate||C;var ee=V||"YYYY-MM-DDTHH:mm:ssZ",ae=A.z(this),T=this.$H,j=this.$m,k=this.$M,Q=I.weekdays,H=I.months,$=I.meridiem,ie=function(de,Re,X,_e){return de&&(de[Re]||de(F,ee))||X[Re].slice(0,_e)},fe=function(de){return A.s(T%12||12,de,"0")},pe=$||function(de,Re,X){var _e=de<12?"AM":"PM";return X?_e.toLowerCase():_e};return ee.replace(R,(function(de,Re){return Re||(function(X){switch(X){case"YY":return String(F.$y).slice(-2);case"YYYY":return A.s(F.$y,4,"0");case"M":return k+1;case"MM":return A.s(k+1,2,"0");case"MMM":return ie(I.monthsShort,k,H,3);case"MMMM":return ie(H,k);case"D":return F.$D;case"DD":return A.s(F.$D,2,"0");case"d":return String(F.$W);case"dd":return ie(I.weekdaysMin,F.$W,Q,2);case"ddd":return ie(I.weekdaysShort,F.$W,Q,3);case"dddd":return Q[F.$W];case"H":return String(T);case"HH":return A.s(T,2,"0");case"h":return fe(1);case"hh":return fe(2);case"a":return pe(T,j,!0);case"A":return pe(T,j,!1);case"m":return String(j);case"mm":return A.s(j,2,"0");case"s":return String(F.$s);case"ss":return A.s(F.$s,2,"0");case"SSS":return A.s(F.$ms,3,"0");case"Z":return ae}return null})(de)||ae.replace(":","")}))},q.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},q.diff=function(V,F,I){var ee,ae=this,T=A.p(F),j=S(V),k=(j.utcOffset()-this.utcOffset())*r,Q=this-j,H=function(){return A.m(ae,j)};switch(T){case g:ee=H()/12;break;case _:ee=H();break;case y:ee=H()/3;break;case m:ee=(Q-k)/6048e5;break;case f:ee=(Q-k)/864e5;break;case u:ee=Q/i;break;case d:ee=Q/r;break;case c:ee=Q/n;break;default:ee=Q}return I?ee:A.a(ee)},q.daysInMonth=function(){return this.endOf(_).$D},q.$locale=function(){return G[this.$L]},q.locale=function(V,F){if(!V)return this.$L;var I=this.clone(),ee=O(V,F,!0);return ee&&(I.$L=ee),I},q.clone=function(){return A.w(this.$d,this)},q.toDate=function(){return new Date(this.valueOf())},q.toJSON=function(){return this.isValid()?this.toISOString():null},q.toISOString=function(){return this.$d.toISOString()},q.toString=function(){return this.$d.toUTCString()},J})(),te=Y.prototype;return S.prototype=te,[["$ms",l],["$s",c],["$m",d],["$H",u],["$W",f],["$M",_],["$y",g],["$D",N]].forEach((function(J){te[J[1]]=function(q){return this.$g(q,J[0],J[1])}})),S.extend=function(J,q){return J.$i||(J(q,Y,S),J.$i=!0),S},S.locale=O,S.isDayjs=B,S.unix=function(J){return S(1e3*J)},S.en=G[P],S.Ls=G,S.p={},S}))})(a_)),a_.exports}var Hw=$w();const Yc=lb(Hw);var hn=(t=>(t.Pending="",t.Completed="",t.Cancelled="",t))(hn||{}),aa=(t=>(t.Installation="",t.AS="A/S",t.Change="",t.Move="",t.Etc="",t))(aa||{});const J1=[{code:"020",name:"",template:"[$1]",kkoMsgId:"KKO020_003",refCode:"WK"},{code:"021",name:"",template:"[$1]      .",kkoMsgId:"KKO021_001",refCode:"WK"},{code:"027",name:"",template:"[$1]  [$2]    .()",kkoMsgId:"KKO027_001",refCode:"WK"},{code:"028",name:"",template:"[$1]  [$2]    [$3]   .",kkoMsgId:"KKO028_001",refCode:"WK"},{code:"138",name:"",template:"[$1] .   .",kkoMsgId:"KKO138_003",refCode:"AS"},{code:"139",name:"",template:"[$1]AS    . :$2",kkoMsgId:"KKO139_001",refCode:"AS"},{code:"141",name:"",template:"[$1][$2]",kkoMsgId:"KKO141_001",refCode:"AS"},{code:"059_002",name:"KB",template:"[$1][$2]",kkoMsgId:"KKO059_002",refCode:"WK"},{code:"059",name:"URL",template:"[$1][$2]",kkoMsgId:"KKO059_001",refCode:"WK"},{code:"271",name:"",template:"[]  1644-1100 . .",kkoMsgId:"KKO271_001",refCode:"AS"},{code:"235",name:"()",template:"[$1] [$2]",kkoMsgId:"KKO059_002",refCode:"WK"},{code:"059_005",name:"()SE",template:"[$1] [$2]",kkoMsgId:"KKO059_002",refCode:"WK"}],xb=({customer:t,className:e=""})=>{if(!t.isVip)return null;const r=(()=>{switch(t.vipLevel){case"VVIP":return{bgColor:"bg-gradient-to-r from-yellow-400 to-yellow-500",textColor:"text-yellow-900",borderColor:"border-yellow-300",shadow:"shadow-yellow-200",label:"VVIP"};case"VIP":default:return{bgColor:"bg-gradient-to-r from-purple-400 to-purple-500",textColor:"text-purple-900",borderColor:"border-purple-300",shadow:"shadow-purple-200",label:"VIP"}}})();return s.jsxs("div",{className:`
        inline-flex items-center px-2 py-1 rounded-full text-xs font-bold
        ${r.bgColor} ${r.textColor} ${r.borderColor}
        border shadow-sm ${r.shadow}
        ${e}
      `,children:[s.jsx(EL,{className:"w-3 h-3 mr-1"}),r.label]})},zw=t=>{try{const e=new Date(t);if(isNaN(e.getTime()))return"  ";const n=e.getMonth()+1,r=e.getDate();return`${n} ${r}`}catch{return"  "}},D_=t=>{try{const e=new Date(t);if(isNaN(e.getTime()))return"  ";const n=e.getMonth()+1,r=e.getDate();let i=e.getHours();const l=i>=12?"":"";i=i%12||12;const c=e.getMinutes().toString().padStart(2,"0");return`${n} ${r} ${l} ${i}:${c}`}catch{return"  "}},Qi=t=>{if(!t)return"-";const e=String(t).replace(/\D/g,"");return e.length!==10?String(t):`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`},qw=({direction:t,onSelect:e,onSms:n,onWorkerAdjust:r,workStatusCounts:i,index:l})=>{const c=i||{pending:1,completed:0,cancelled:0},d=()=>{const _=c.pendingByProdGrp||{},y=c.completedByProdGrp||{},g={};[...Object.keys(_),...Object.keys(y)].forEach(v=>{g[v]=(_[v]||0)+(y[v]||0)});const N=["D","I","V","C"],C=[];return N.forEach(v=>{g[v]&&g[v]>0&&C.push(`${v}_${g[v]}`)}),Object.keys(g).forEach(v=>{!N.includes(v)&&g[v]>0&&C.push(`${v}_${g[v]}`)}),C.join(" / ")},u=()=>{const _=d();return{statusBadges:s.jsxs("div",{className:"flex items-center gap-1",children:[c.pending>0&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-amber-50 text-amber-700 border border-amber-200",children:[" ",c.pending]}),c.completed>0&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200",children:[" ",c.completed]}),c.cancelled>0&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-rose-50 text-rose-700 border border-rose-200",children:[" ",c.cancelled]})]}),serviceBadge:_?s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200",children:_}):null}},f=_=>{_.stopPropagation(),t.customer.phone&&(window.location.href=`tel:${t.customer.phone}`)},m=_=>{_.stopPropagation(),n&&n(t)};return s.jsx("div",{onClick:()=>e(t),className:"bg-white rounded-xl shadow-sm hover:shadow-md border border-gray-100 transition-all duration-200 cursor-pointer active:scale-[0.99] mb-3 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"p-4",children:[(()=>{const{statusBadges:_,serviceBadge:y}=u();return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[l!==void 0&&s.jsx("div",{className:"flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full bg-blue-500 text-white text-sm font-bold",children:l}),s.jsxs("h3",{className:"font-bold text-gray-900 text-base truncate",children:[t.customer.name,t.customer.id&&s.jsxs("span",{className:"font-normal ml-1",children:["(",t.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200 flex-shrink-0",children:t.typeDisplay}),t.WRK_CD==="04"&&t.WRK_DTL_TCD==="0440"&&s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-50 text-amber-700 border border-amber-200 flex-shrink-0",children:""})]}),s.jsx("div",{className:"flex-shrink-0",children:_})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-sm text-gray-600",children:D_(t.scheduledAt)}),s.jsx(xb,{customer:t.customer})]}),s.jsx("div",{className:"flex-shrink-0",children:y})]})]})})(),s.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[s.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:t.customer.address||"  "})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("button",{onClick:f,className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),""]}),n&&s.jsxs("button",{onClick:m,className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),""]}),r&&s.jsxs("button",{onClick:_=>{_.stopPropagation(),r(t)},className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"whitespace-nowrap",children:""})]})]})]})})},Z1=t=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),Cv=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),yv=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),eC=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})}),tC=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})}),Fd=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),Xw=t=>[{id:`${t}_1`,directionId:t,type:aa.AS,typeDisplay:"A/S ",status:hn.Completed,scheduledAt:"2025-09-30T14:00:00",customer:{id:"1001857578",name:"",phone:"01044586687",address:"   261 17"},details:"   ",assignedEquipment:[],productName:"ISP  ",cellNo:"-",installLocation:""},{id:`${t}_2`,directionId:t,type:aa.AS,typeDisplay:"A/S ",status:hn.Pending,scheduledAt:"2025-09-30T14:30:00",customer:{id:"1001857578",name:"",phone:"01044586687",address:"   261 17"},details:"  ",assignedEquipment:[],productName:"ISP ",cellNo:"C001",installLocation:""},{id:`${t}_3`,directionId:t,type:aa.AS,typeDisplay:"A/S ",status:hn.Pending,scheduledAt:"2025-09-30T15:00:00",customer:{id:"1001857578",name:"",phone:"01044586687",address:"   261 17"},details:"  ",assignedEquipment:[],productName:"ISP  ",cellNo:"C002",installLocation:""}],Ny=async t=>{console.log("[LGU API] getUplsCtrtInfo params:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsCtrtInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[LGU API] getUplsCtrtInfo HTTP error:",e.status),null;const n=await e.json();return console.log("[LGU API] getUplsCtrtInfo response:",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n?[n]:null}catch(e){return console.error("[LGU API] getUplsCtrtInfo error:",e),null}},bv=async t=>{console.log("[L2 API] getUplsNwcs params:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsNwcs`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[L2 API] getUplsNwcs HTTP error:",e.status),null;const n=await e.json();return console.log("[L2 API] getUplsNwcs response:",n),Array.isArray(n)&&n.length>0?n[0]:n&&typeof n=="object"?n:null}catch(e){return console.error("[L2 API] getUplsNwcs error:",e),null}},Nv=async t=>{console.log("[L2 API] getUplsEntrEqipDtl params:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsEntrEqipDtl`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[L2 API] getUplsEntrEqipDtl HTTP error:",e.status),null;const n=await e.json();return console.log("[L2 API] getUplsEntrEqipDtl response:",n),n}catch(e){return console.error("[L2 API] getUplsEntrEqipDtl error:",e),null}},Jw=async t=>{if(console.log("[ API] setCertifyCL04 params:",t),$n())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"   "};try{const e=await fetch(`${bs}/customer/etc/setCertifyCL04`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CMD:"CL-04",...t})});if(!e.ok)return console.error("[ API] setCertifyCL04 HTTP error:",e.status),{code:"ERROR",message:`HTTP error: ${e.status}`};const n=await e.json();return console.log("[ API] setCertifyCL04 response:",n),{code:n.code||n.RESULT_CODE||"SUCCESS",message:n.message||n.RESULT_MSG||"   "}}catch(e){return console.error("[ API] setCertifyCL04 error:",e),{code:"ERROR",message:String(e)}}},R_=async t=>{console.log("[Certify API] setCertifyCL06 params:",t);try{const e=await fetch(`${bs}/customer/etc/setCertifyCL06`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,CONT_ID:t.CTRT_ID})});if(!e.ok)return console.error("[Certify API] setCertifyCL06 HTTP error:",e.status),{ERROR:`HTTP ${e.status}`};const n=await e.json();return console.log("[Certify API] setCertifyCL06 response:",n),n.data?n.data:n}catch(e){return console.error("[Certify API] setCertifyCL06 error:",e),{ERROR:String(e)}}},Jm=async t=>{console.log("[Certify API] getCertifyCL08 params:",t);try{const e=await fetch(`${bs}/customer/etc/getCertifyCL08`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,CONT_ID:t.CTRT_ID})});if(!e.ok)return console.error("[Certify API] getCertifyCL08 HTTP error:",e.status),{ERROR:`HTTP ${e.status}`};const n=await e.json();return console.log("[Certify API] getCertifyCL08 response:",n),n.data?n.data:n}catch(e){return console.error("[Certify API] getCertifyCL08 error:",e),{ERROR:String(e)}}},ex=async()=>{var t;if(console.log("[FTTH API] getCertifyProdMap "),$n())return await new Promise(e=>setTimeout(e,300)),["PD10007399","PD10007400"];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/customer/work/getCertifyProdMap`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify({})});if(!n.ok)return console.error("[FTTH API] getCertifyProdMap HTTP error:",n.status),[];const r=await n.json();console.log("[FTTH API] getCertifyProdMap response:",r);const i=((t=r.output)==null?void 0:t.output)||r.output;if(i&&Array.isArray(i)){const l=i.map(c=>c.PROD_CD).filter(Boolean);return console.log("[FTTH API] FTTH   :",l.length,""),l}if(Array.isArray(r)){const l=r.map(c=>c.PROD_CD).filter(Boolean);return console.log("[FTTH API] FTTH   :",l.length,""),l}return[]}catch(e){return console.error("[FTTH API] getCertifyProdMap error:",e),[]}},Cb=async t=>{console.log("[Certify API] getUplsLdapRslt CTRT_ID:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsLdapRslt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CTRT_ID:t})});if(!e.ok)return console.error("[Certify API] getUplsLdapRslt HTTP error:",e.status),{exists:!1,data:[]};const n=await e.json();console.log("[Certify API] getUplsLdapRslt response:",n);const r=n.output||n.data||[];return{exists:(n.rowcount||r.length||0)>0,data:Array.isArray(r)?r:[]}}catch(e){return console.error("[Certify API] getUplsLdapRslt error:",e),{exists:!1,data:[]}}},Zw=async t=>{try{const e=await fetch(`${bs}/customer/etc/getCertifyApiHist`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return e.ok?(await e.json()).output||[]:[]}catch(e){return console.error("[Signal API] getCertifyApiHist error:",e),[]}},e4=async t=>{if($n())return await new Promise(e=>setTimeout(e,1e3)),[{CONSREQNO:"20240101001",CTRT_ID:"CTRT001",CONSCHRRNM:"",CONSCHRRTLNO:"010-1234-5678",CONSCHRRMAKRMKS:"LGU+   ",CONSFNSHSCDLDT:"20240115",CONSFNSHDT:"20240114",CONSNEEDDIVSNM:"",CONSDLYRSNNM:"",CONSIPSBPRSSDT:"",CONSIPSBRSNNM:"",CONSNREQPRSSDT:"",CONSNREQRSNNM:"",ENTR_NO:"500030621784",ENTR_RQST_NO:"300241327941",MSTR_FL:"Y",SBGNEGNRNM:"LGU+"},{CONSREQNO:"20240102002",CTRT_ID:"CTRT002",CONSCHRRNM:"",CONSCHRRTLNO:"010-2345-6789",CONSCHRRMAKRMKS:"  ",CONSFNSHSCDLDT:"20240120",CONSFNSHDT:"",CONSNEEDDIVSNM:"",CONSDLYRSNNM:" ",CONSIPSBPRSSDT:"",CONSIPSBRSNNM:"",CONSNREQPRSSDT:"",CONSNREQRSNNM:"",ENTR_NO:"500030621785",ENTR_RQST_NO:"300241327942",MSTR_FL:"Y",SBGNEGNRNM:"LGU+"}];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/customer/etc/getUplsRqstConsList`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)});if(!n.ok)throw new Error(`LGU    : ${n.status}`);return await n.json()}catch(e){throw console.error("LGU    :",e),e}},t4=async t=>{console.log("[LGU API] uplsEntrBgnEstbChg params:",t);try{const e=await fetch(`${bs}/customer/receipt/uplsEntrBgnEstbChg`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[LGU API] uplsEntrBgnEstbChg HTTP error:",e.status),{RESULT_CD:"N",RESULT_MSG:`HTTP error: ${e.status}`};const n=await e.json();return console.log("[LGU API] uplsEntrBgnEstbChg response:",n),{RESULT_CD:n.RESULT_CD||"N",RESULT_MSG:n.RESULT_MSG||"",ENTR_NO:n.ENTR_NO||"",ENTR_RQST_NO:n.ENTR_RQST_NO||"",ENTR_CNTRT_NO:n.ENTR_CNTRT_NO||"",SVC_CD:n.SVC_CD||"",UPLS_PROD_YN:n.UPLS_PROD_YN||"",RQST_DV_CD:n.RQST_DV_CD||"",NET_TYP:n.NET_TYP||""}}catch(e){return console.error("[LGU API] uplsEntrBgnEstbChg error:",e),{RESULT_CD:"N",RESULT_MSG:String(e)}}},Sv=async t=>{console.log("[LGU API] reqUplsHspdLdap params:",t);try{const e=await fetch(`${bs}/lgu/construction-request`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw console.error("[LGU API] reqUplsHspdLdap HTTP error:",e.status),new Error(`LDAP request failed: ${e.status}`);const n=await e.json();return console.log("[LGU API] reqUplsHspdLdap response:",n),n}catch(e){throw console.error("[LGU API] reqUplsHspdLdap error:",e),e}},s4=async t=>{console.log("[LGU API] getUplsDuplicationMember params:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsDuplicationMember`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return{success:!1,ENTR_EXIST:"N",RESULT_CD:"N",RESULT_MSG:`HTTP error: ${e.status}`};const n=await e.json();console.log("[LGU API] getUplsDuplicationMember response:",n);const r=Array.isArray(n)?n[0]:n,i=(r==null?void 0:r.RESULT_CD)||"";return i.startsWith("N")?{success:!1,ENTR_EXIST:"N",RESULT_CD:i,RESULT_MSG:(r==null?void 0:r.RESULT_MSG)||""}:{success:!0,ENTR_EXIST:(r==null?void 0:r.ENTR_EXIST)||"N",RESULT_CD:i,RESULT_MSG:(r==null?void 0:r.RESULT_MSG)||""}}catch(e){return console.error("[LGU API] getUplsDuplicationMember error:",e),{success:!1,ENTR_EXIST:"N",RESULT_CD:"N",RESULT_MSG:String(e)}}},l5=async t=>{console.log("[LGU API] getUplsEqipInfo params:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsEqipInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return[];const n=await e.json();return console.log("[LGU API] getUplsEqipInfo response:",n),Array.isArray(n)?n:n.output&&Array.isArray(n.output)?n.output:n?[n]:[]}catch(e){return console.error("[LGU API] getUplsEqipInfo error:",e),[]}},Sy=async t=>{console.log("[LGU API] getUplsEqipPortInfo params:",t);try{const e=await fetch(`${bs}/customer/etc/getUplsEqipPortInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return[];const n=await e.json();return console.log("[LGU API] getUplsEqipPortInfo response:",n),Array.isArray(n)?n:n.output&&Array.isArray(n.output)?n.output:n?[n]:[]}catch(e){return console.error("[LGU API] getUplsEqipPortInfo error:",e),[]}},n4=async t=>{console.log("[LGU API] setUplsRqstConsReq params:",t);try{const e=await fetch(`${bs}/customer/etc/setUplsRqstConsReq`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw new Error(`Port : ${e.status}`);const n=await e.json();return console.log("[LGU API] setUplsRqstConsReq response:",n),n}catch(e){throw console.error("[LGU API] setUplsRqstConsReq error:",e),e}},o5=async t=>{if($n())return await new Promise(e=>setTimeout(e,1500)),[{code:"SUCCESS",message:"LGU    ()",CANCEL_ID:"FAULT"+Date.now(),STATUS:""}];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/lgu/network-fault`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)});if(!n.ok)throw new Error(`LGU   : ${n.status}`);return await n.json()}catch(e){throw console.error("LGU   :",e),e}};class Fs extends Error{constructor(e,n,r){super(e),this.name="NetworkError",this.statusCode=n,this.details=r}}class r4{constructor(){this.states=new Map,this.failureThreshold=5,this.openDuration=3e4,this.halfOpenDuration=1e4}getState(e){return this.states.has(e)||this.states.set(e,{failureCount:0,lastFailureTime:0,state:"CLOSED"}),this.states.get(e)}canRequest(e){const n=this.getState(e),r=Date.now();return n.state==="CLOSED"?!0:n.state==="OPEN"?r-n.lastFailureTime>=this.openDuration?(console.log(`[Circuit Breaker] ${e} - OPEN  HALF_OPEN ( )`),n.state="HALF_OPEN",!0):(console.warn(` Circuit Breaker: ${e} -   (${Math.round((this.openDuration-(r-n.lastFailureTime))/1e3)}   )`),!1):n.state==="HALF_OPEN"}recordSuccess(e){const n=this.getState(e);n.state==="HALF_OPEN"&&console.log(`[Circuit Breaker] ${e} - HALF_OPEN  CLOSED ()`),n.failureCount=0,n.state="CLOSED"}recordFailure(e){const n=this.getState(e);n.failureCount++,n.lastFailureTime=Date.now(),n.failureCount>=this.failureThreshold?(n.state!=="OPEN"&&console.error(` Circuit Breaker: ${e} - CLOSED  OPEN (${this.failureThreshold}  , ${this.openDuration/1e3}  )`),n.state="OPEN"):n.state==="HALF_OPEN"&&(console.warn(`[Circuit Breaker] ${e} - HALF_OPEN  OPEN ( )`),n.state="OPEN")}reset(){this.states.clear()}}class i4{constructor(){this.pendingRequests=new Map,this.maxAge=5e3}getOrCreate(e,n){this.cleanup();const r=this.pendingRequests.get(e);if(r)return console.log(`[Request Dedup]   : ${e} (  )`),r.promise;const i=n();return this.pendingRequests.set(e,{promise:i,timestamp:Date.now()}),i.finally(()=>{this.pendingRequests.delete(e)}),i}cleanup(){const e=Date.now();for(const[n,r]of this.pendingRequests.entries())e-r.timestamp>this.maxAge&&this.pendingRequests.delete(n)}reset(){this.pendingRequests.clear()}}const Jd=new r4,c5=new i4;typeof window<"u"&&(window.resetCircuitBreaker=()=>{Jd.reset(),c5.reset(),console.log("[API ] Circuit Breaker  Request Deduplicator ")});const vv=(t,e=" .")=>{switch(t){case 400:return" .   .";case 401:return" .";case 403:return"  .";case 404:return"    .";case 408:return"  .  .";case 429:return"   .    .";case 500:return"  .    .";case 502:case 503:return"   .    .";case 504:return"   .  .";default:return e}},nr=async(t,e,n=3,r=3e4)=>{if(!Jd.canRequest(t))throw new Fs("  .    .",503);if(!(e.method==="GET"||!e.method))return l();return c5.getOrCreate(t,l);async function l(){let c=null;for(let d=0;d<n;d++)try{const u=new AbortController,f=setTimeout(()=>u.abort(),r),m=await fetch(t,{...e,signal:u.signal});if(clearTimeout(f),m.ok)return Jd.recordSuccess(t),m;if(m.status>=400&&m.status<500)throw Jd.recordFailure(t),new Fs(vv(m.status),m.status);if(m.status>=500){Jd.recordFailure(t);let _=vv(m.status);try{const y=await m.json();y&&y.message&&(_=y.message)}catch{}throw new Fs(_,m.status)}return m}catch(u){if(c=u,u.name==="AbortError"){if(console.error(`API  ( ${d+1}/${n}):`,t),Jd.recordFailure(t),d===n-1)throw new Fs("  .  .",408)}else if(u instanceof TypeError&&u.message.includes("fetch")){if(console.error(`  ( ${d+1}/${n}):`,u),Jd.recordFailure(t),d===n-1)throw new Fs("  .",void 0,u)}else if(u instanceof Fs){if(u.statusCode&&u.statusCode>=400&&u.statusCode<500||d===n-1)throw u}else if(console.error(`API   ( ${d+1}/${n}):`,u),Jd.recordFailure(t),d===n-1)throw new Fs(u.message||"    .");if(d<n-1){const f=Math.min(1e3*Math.pow(2,d),5e3);console.log(`${f}ms  ...`),await new Promise(m=>setTimeout(m,f))}}throw c||new Fs("    .")}},a4=(t,e)=>{const n=["","","","","","","",""],r=[{type:aa.AS,display:"A/S"},{type:aa.Installation,display:""},{type:aa.Move,display:""},{type:aa.Change,display:""},{type:aa.Etc,display:""}],i=[hn.Pending,hn.Completed,hn.Cancelled],l=["   15 1","   123 5","   456 12","   789 3","   321 8","   654 2","   987 15","   147 7"];return n.map((d,u)=>{const f=r[u%r.length],m=i[u%i.length],_=9+u%8,y=u%4*15;return{id:`WRK${String(u+1).padStart(3,"0")}`,type:f.type,typeDisplay:f.display,status:m,scheduledAt:`2025-09-30T${String(_).padStart(2,"0")}:${String(y).padStart(2,"0")}:00`,customer:{id:`CUST${String(u+1).padStart(3,"0")}`,name:d,phone:`010-${String(Math.floor(Math.random()*9e3)+1e3)}-${String(Math.floor(Math.random()*9e3)+1e3)}`,address:l[u%l.length]},details:`${f.display}  `,assignedEquipment:[],directionId:`WRK${String(u+1).padStart(3,"0")}`}})},Dv=async(t,e,n="N")=>{const r=typeof window<"u"?window.location.origin:"http://localhost:3000";try{return await(await nr(`${bs}/login`,{method:"POST",headers:{"Content-Type":"application/json",Origin:r},credentials:"include",body:JSON.stringify({USR_ID:t,USR_PWD:e,DISCONN_YN:n})},1)).json()}catch(i){throw console.error(" API  :",i),i instanceof Fs?i:new Fs("   .  .")}},$n=()=>typeof window<"u"&&localStorage.getItem("demoMode")==="true",l4=()=>[{INSP_ID:"INSP001",SO_ID:"209",CRR_ID:"01",INSP_END_DT:"20251015",STTL_YN:"Y",CUST_ID:"CUST001",CUST_NM:"",TEL_NO:"010-1234-5678",PASS_YN:"Y",PROD_GRP_NM:"+TV"},{INSP_ID:"INSP002",SO_ID:"209",CRR_ID:"01",INSP_END_DT:"20251014",STTL_YN:"N",CUST_ID:"CUST002",CUST_NM:"",TEL_NO:"010-2345-6789",PASS_YN:"N",FAIL_GRADE:"B",DAPPR_RESN:" ",PROD_GRP_NM:""},{INSP_ID:"INSP003",SO_ID:"209",CRR_ID:"01",INSP_END_DT:"20251013",STTL_YN:"Y",CUST_ID:"CUST003",CUST_NM:"",TEL_NO:"010-3456-7890",PASS_YN:"Y",PROD_GRP_NM:"+TV+"}],o4=()=>[{WRK_DRCTN_ID:"WRK001",WRK_ID:"1008409324",CUST_ID:"CUST001",CUST_NM:"",SO_ID:"209",SO_NM:"",CRR_ID:"01",CRR_NM:"LG",PROD_CD:"PROD001",PROD_NM:" 100M",WRK_CD:"02",WRK_CD_NM:"A/S",WRK_STAT_CD:"4",WRK_STAT_NM:"",SIGNAL_RESULT:"",SIGNAL_DATE:"2025-10-16 15:30"},{WRK_DRCTN_ID:"WRK002",WRK_ID:"1008409325",CUST_ID:"CUST002",CUST_NM:"",SO_ID:"209",SO_NM:"",CRR_ID:"01",CRR_NM:"LG",PROD_CD:"PROD002",PROD_NM:" 500M + TV",WRK_CD:"01",WRK_CD_NM:"",WRK_STAT_CD:"2",WRK_STAT_NM:"",SIGNAL_RESULT:""},{WRK_DRCTN_ID:"WRK003",WRK_ID:"1008409326",CUST_ID:"CUST003",CUST_NM:"",SO_ID:"209",SO_NM:"",CRR_ID:"01",CRR_NM:"LG",PROD_CD:"PROD003",PROD_NM:" 1G",WRK_CD:"03",WRK_CD_NM:"",WRK_STAT_CD:"1",WRK_STAT_NM:"",SIGNAL_RESULT:""}],c4=(t,e)=>{if(!t&&!e)return null;const n={total:0,pending:0,completed:0,cancelled:0,pendingByProdGrp:{},completedByProdGrp:{}},r={DTV:"D",D:"D",ISP:"I",I:"I",VOIP:"V",VoIP:"V",V:"V",C:"C",:"C",:"C"},i={:"pending",:"pending",:"pending",:"completed",:"completed","()":"completed",:"cancelled"};if(e){const l=e.split(/\s*\/\s*/).filter(c=>c.trim());n.total=l.length,l.forEach(c=>{const d=c.trim();let u=i[d];u||(d.includes("")?u="cancelled":d.includes("")&&!d.includes("")||d.includes("")&&d.includes("")?u="completed":u="pending",console.log("[parseWorkStatusFromStrings] :",d,"->",u)),n[u]++})}if(t){const l=t.split(/\s*\/\s*/).filter(c=>c.trim());n.total===0&&(n.total=l.length,n.pending=l.length),l.forEach(c=>{const d=c.trim().toUpperCase(),u=r[d]||d.charAt(0);n.pendingByProdGrp[u]=(n.pendingByProdGrp[u]||0)+1})}return n},vy=async t=>{if($n())return Xw(t);try{const n=typeof window<"u"?window.location.origin:"http://localhost:3000";return await(await nr(`${bs}/work/receipts`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify({WRK_DRCTN_ID:t})})).json()}catch(n){throw n instanceof Fs?n:new Fs("   .")}},yb=async t=>{if(typeof window<"u"&&localStorage.getItem("demoMode")==="true")return await new Promise(n=>setTimeout(n,1e3)),{code:"SUCCESS",message:"   ()"};try{const n=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await fetch(`${bs}/work/cancel`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify(t)});if(!r.ok)throw new Error(` : ${r.status}`);return await r.json()}catch(n){throw console.error(" API  :",n),n}},tx=async t=>{if(console.log("[] API :",t),$n())return await new Promise(e=>setTimeout(e,300)),{WRK_ID:t.WRK_ID,RCPT_ID:t.RCPT_ID||"",CUST_ID:t.CUST_ID||"",CTRT_ID:"CT001",SO_ID:"100",WRK_CD:"01",WRK_CD_NM:"",WRK_STAT_CD:"2",WRK_STAT_CD_NM:"",WRK_RCPT_CL:"",OST_WORKABLE_STAT:"X",HOTBILL_YN:"N"};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/work/getDetailWorkInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[] :",r),Array.isArray(r)&&r.length>0?r[0]:r&&!Array.isArray(r)?r:null}catch(e){throw console.error("[] API :",e),e}},d4=async t=>{if(console.log("[OST] API :",t),$n())return await new Promise(e=>setTimeout(e,300)),{AGENT_FL:"1",BUSI_TYPE:"031",RES_CD:"0BS0000"};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/etc/getOSTInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify({AGENT_FL:t.AGENT_FL||"1",RCPT_ID:t.RCPT_ID,CUST_ID:t.CUST_ID})})).json();return console.log("[OST] :",r),Array.isArray(r)&&r.length>0?r[0]:r&&!Array.isArray(r)?r:null}catch(e){return console.error("[OST] API :",e),null}},u4=async t=>{if(console.log("[OST] API :",t),$n())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:" ."};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/etc/modOstWorkCancel`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[OST] :",r),r.MESSAGE==="SUCCESS"||r.code==="SUCCESS"?{code:"SUCCESS",message:" .",RCPT_ID:r.RCPT_ID}:{code:r.code||"ERROR",message:r.message||r.MESSAGE||"  "}}catch(e){throw console.error("[OST] API :",e),new Fs(e.message||"OST     .")}},bs=typeof window<"u"?(()=>{const t=window.location.hostname,e=window.location.protocol;return console.log("[ API]  :",{hostname:t,protocol:e}),t==="localhost"||t==="127.0.0.1"?"http://58.143.140.222:8080/api":"/api"})():"/api",h4=t=>{switch(t){case"":return aa.Installation;case"A/S":return aa.AS;case"":return aa.Change;case"":return aa.Move;default:return aa.Etc}},f4=(t,e)=>{if(e){if(e==="4"||e==="7")return hn.Completed;if(e==="3")return hn.Cancelled;if(e==="1"||e==="2")return hn.Pending}switch(t){case"":return hn.Pending;case"":return hn.Completed;case"":return hn.Cancelled;default:return hn.Pending}},m4=async({startDate:t,endDate:e})=>{if($n())return a4();const r=t.replace(/-/g,""),i=e.replace(/-/g,""),l=typeof window<"u"?localStorage.getItem("userInfo"):null,c=l?JSON.parse(l):{},d={WRKR_ID:c.userId||"",SO_ID:c.soId||"",PROC_CL:"A02",VIEW_TYP:"MOBILE",SCH_HOPEDT_GB:"2",PRT_STAT:"%",WRK_DTL_TCD:"%",HOPE_DT_STRT:r,HOPE_DT_END:i,PDA_WORK_STATUS:"%",EMRG_YN:"",WRK_CD:"",DATE_GBN:""};try{const u=typeof window<"u"?window.location.origin:"http://localhost:3000",m=await(await nr(`${bs}/work/directions`,{method:"POST",headers:{"Content-Type":"application/json",Origin:u},credentials:"include",body:JSON.stringify(d)},3,6e4)).json();return!Array.isArray(m)||m.length===0?[]:m.map(y=>{const g=y.HOPE_DT,N=y.HOPE_TM,C=new Date(`${g.slice(0,4)}-${g.slice(4,6)}-${g.slice(6,8)}T${N}:00`).toISOString();return{id:y.WRK_DRCTN_ID,type:h4(y.WRK_CD_NM),typeDisplay:y.WRK_CD_NM||"",status:f4(y.WRK_STAT,y.MIN_WRK_STAT_CD||y.WRK_STAT_CD),scheduledAt:C,customer:{id:y.CUST_ID,name:y.NONMASK_CUST_NM||y.CUST_NM,phone:y.CUST_TEL_NO||y.REQ_CUST_TEL_NO||"",address:y.ADDR,isVip:!!(y.VIP_GB&&String(y.VIP_GB).length>0),vipLevel:y.VIP_GB==="VIP_VVIP"?"VVIP":y.VIP_GB?"VIP":void 0},details:y.REQ_CTX,assignedEquipment:[],directionId:y.WRK_DRCTN_ID,installLocation:y.INSTL_LOC||"",WRK_CD:y.WRK_CD,WRK_CD_NM:y.WRK_CD_NM,WRK_DTL_TCD:y.WRK_DTL_TCD,PROD_CD:y.PROD_CD,PROD_NM:y.PROD_NM,PROD_GRP:y.PROD_GRP,CTRT_ID:y.CTRT_ID,CTRT_STAT:y.CTRT_STAT,CTRT_STAT_NM:y.CTRT_STAT_NM,SO_ID:y.SO_ID,SO_NM:y.SO_NM,CRR_ID:y.CRR_ID,CUST_REL:y.CUST_REL||"",UP_CTRL_CL:y.UP_CTRL_CL||"",PSN_USE_CORP:y.PSN_USE_CORP||"",VOIP_USE_CORP:y.VOIP_USE_CORP||"",DTV_USE_CORP:y.DTV_USE_CORP||"",VIEW_MOD_CD:y.VIEW_MOD_CD||"",VIEW_MOD_NM:y.VIEW_MOD_NM||"",VIP_GB:y.VIP_GB||"",PROD_GRPS:y.PROD_GRPS||"",WRK_STATS:y.WRK_STATS||"",OST_WORKABLE_STAT:y.OST_WORKABLE_STAT||""}})}catch(u){throw console.error("API  :",u),u instanceof Fs?u:new Fs("   .")}},ad=async t=>{if($n())return null;try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n={PROC_CL:"A02",WRK_DRCTN_ID:t.WRK_DRCTN_ID,WRK_ID:t.WRK_ID||"",SO_ID:t.SO_ID||""};console.log("[getWorkReceiptDetail] Requesting with:",n);const r=await fetch(`${bs}/work/receipts`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(n)});if(!r.ok)return console.error("[getWorkReceiptDetail] HTTP Error:",r.status),null;const i=await r.json();if(console.log("[getWorkReceiptDetail] Response:",i),Array.isArray(i)&&i.length>0){if(t.WRK_ID){const l=i.find(c=>String(c.WRK_ID)===String(t.WRK_ID));if(l)return console.log("[getWorkReceiptDetail] Found matching WRK_ID:",t.WRK_ID,"MEMO:",l.MEMO,"NET_CL:",l.NET_CL),l;console.log("[getWorkReceiptDetail] WRK_ID not found in response, params.WRK_ID:",t.WRK_ID,"available WRK_IDs:",i.map(c=>c.WRK_ID))}return i[0]}return null}catch(e){return console.error("[getWorkReceiptDetail] Error:",e),null}},g4=async t=>{try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/customer/work/getSafeCheckList_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},body:JSON.stringify(t||{}),credentials:"include"});if(!n.ok)return console.warn(`[SafetyChecklist API] Failed: ${n.status}`),[];const r=await n.json();return r.data&&Array.isArray(r.data)?r.data:Array.isArray(r)?r:[]}catch(e){return console.warn("[SafetyChecklist API] Error:",e),[]}},p4=async t=>{try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/customer/work/saveSafeCheckList_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},body:JSON.stringify({USR_ID:t.USR_ID,IMG_PATHS:t.IMG_PATHS||"",ANS_ITEM_IDS:t.ANS_ITEM_IDS,ANS_VALUES:t.ANS_VALUES}),credentials:"include"});if(!n.ok)return console.warn(`[SafetyChecklist Save API] Failed: ${n.status}`),{code:"ERROR",message:`HTTP ${n.status}`};const r=await n.json();return{code:r.code||"SUCCESS",message:r.message||"Safety checklist saved"}}catch(e){return console.warn("[SafetyChecklist Save API] Error:",e),{code:"ERROR",message:String(e)}}},d5=async t=>{try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/customer/work/getSafeCheckResultInfo_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},body:JSON.stringify({WRKR_ID:t}),credentials:"include"});if(!n.ok)return console.warn(`[SafetyCheckResult API] Failed: ${n.status}`),[];const r=await n.json();return r.code==="SUCCESS"&&r.output?r.output:[]}catch(e){return console.warn("[SafetyCheckResult API] Error:",e),[]}},_4=async t=>{if($n())return await new Promise(e=>setTimeout(e,500)),l4();try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=new URLSearchParams;n.append("SO_ID",t.SO_ID),n.append("CRR_ID",t.CRR_ID);const r=new Date,i=new Date(r.getFullYear(),r.getMonth()-3,r.getDate()),l=m=>{const _=m.getFullYear(),y=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0");return`${_}${y}${g}`},c=t.INSP_DT_FROM||l(i),d=t.INSP_DT_TO||l(r);n.append("INSP_DT_FROM",c),n.append("INSP_DT_TO",d),t.INSP_ID&&n.append("INSP_ID",t.INSP_ID);const u=await fetch(`${bs}/work/safety-checks?${n.toString()}`,{method:"GET",headers:{Origin:e},credentials:"include"});return u.ok?await u.json():(console.warn(`[ API]   : ${u.status} -    `),[])}catch(e){return console.warn("[ API]    -   :",e),[]}},x4=async t=>{if($n())return await new Promise(e=>setTimeout(e,500)),o4();try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=new URLSearchParams;Object.entries(t).forEach(([l,c])=>{c&&n.append(l,c)});const r=await fetch(`${bs}/work/result-signals?${n.toString()}`,{method:"GET",headers:{Origin:e},credentials:"include"});return r.ok?await r.json():(console.warn(`[ API]   : ${r.status} -    `),[])}catch(e){return console.warn("[ API]    -   :",e),[]}},to=async t=>{var n;if($n())return await new Promise(r=>setTimeout(r,500)),{contractEquipments:[{SVC_CMPS_ID:"SVC001",ITEM_MID_NM:"",EQT_CL_NM:"RS-M100",ITEM_MID_CD:"04"},{SVC_CMPS_ID:"SVC002",ITEM_MID_NM:"",EQT_CL_NM:"DTV-STB100",ITEM_MID_CD:"05"}],technicianEquipments:[{EQT_NO:"EQT001",ITEM_MID_NM:"",EQT_CL_NM:"RS-M100",EQT_SERNO:"RSM100001",ITEM_MID_CD:"04",MAC_ADDRESS:"AA:BB:CC:DD:EE:01"},{EQT_NO:"EQT002",ITEM_MID_NM:"",EQT_CL_NM:"RS-M200",EQT_SERNO:"RSM200001",ITEM_MID_CD:"04",MAC_ADDRESS:"AA:BB:CC:DD:EE:02"},{EQT_NO:"EQT003",ITEM_MID_NM:"",EQT_CL_NM:"DTV-STB100",EQT_SERNO:"DTV100001",ITEM_MID_CD:"05"},{EQT_NO:"EQT004",ITEM_MID_NM:"",EQT_CL_NM:"DTV-STB200",EQT_SERNO:"DTV200001",ITEM_MID_CD:"05"}],customerEquipments:[],removedEquipments:[]};try{const r=typeof window<"u"?window.location.origin:"http://localhost:3000",{WORK_ID:i,...l}=t,c={...l,WRK_ID:t.WRK_ID||i,EQT_SEL:"0",EQT_CL:"ALL"},f=(await(await nr(`${bs}/customer/work/getCustProdInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:r},credentials:"include",body:JSON.stringify(c)})).text()).replace(/[\x00-\x1f\x7f]/g,g=>g===`
`||g==="\r"||g==="	"?" ":""),m=JSON.parse(f),_=((n=m==null?void 0:m.output1)==null?void 0:n[0])||{},y=c.WRK_CD==="02";return{contractEquipments:(m==null?void 0:m.output2)||[],technicianEquipments:(m==null?void 0:m.output3)||[],customerEquipments:y?[]:(m==null?void 0:m.output4)||[],removedEquipments:y?(m==null?void 0:m.output4)||[]:(m==null?void 0:m.output5)||[],kpiProdGrpCd:_.KPI_PROD_GRP_CD,prodChgGb:_.PROD_CHG_GB,chgKpiProdGrpCd:_.CHG_KPI_PROD_GRP_CD,prodGrp:_.PROD_GRP,upCtrlCl:_.UP_CTRL_CL,prodPromoInfo:(m==null?void 0:m.output1)||[]}}catch(r){throw console.error("[ API]    :",r),r instanceof Fs?r:new Fs("   .")}},Oh=async t=>{if($n())return await new Promise(l=>setTimeout(l,1e3)),{code:"SUCCESS",message:"   ()"};const e=typeof window<"u"?localStorage.getItem("userInfo"):null,n=e?JSON.parse(e):{},r=n.userId||n.id||"",i=t.WRKR_ID||n.userId||"";try{const l=typeof window<"u"?window.location.origin:"http://localhost:3000",c=(G,K,B)=>{const O=(G==null?"":String(G)).trim();return O.length>=K?O.substring(0,K):O+new Array(K-O.length+1).join(B)};let d="",u="",f="",m="",_="",y="",g="",N="",C="",v="",R=0;const U=(t.equipments||[]).filter(G=>String(G.SEL||"1")==="1").map((G,K)=>({eq:G,order:Number(G.EQUIP_SEQ||G.SVC_CMPS_ID||K+1),idx:K})).sort((G,K)=>(G.order||0)-(K.order||0));for(let G=0;G<U.length;G++){const{eq:K,idx:B}=U[G],O=String(K.PROD_GRP||"");d+=O;const S=String(K.PROD_TYP||""),A=String(K.EQUIP_SEQ||K.SVC_CMPS_ID||"");u+=S+A,f+=String(K.PROD_CD||""),m+=String(K.SVC_CD||"");const Y=c(K.ITEM_MID_CD||K.EQT||K.EQT_CD||"",10," ");_+=Y;const te=c(K.EQT_CL||K.EQT_CL_CD||"",10," ");y+=te;const J=String(K.LENT||"");g+=J;const q=c(String(K.EQT_USE_STAT_CD||""),1," ");N+=q,C=c(K.EQT_SALE_AMT||0,10," ");const V=c(K.ITLLMT_PRD||"00",2," ");v+=V,R+=1}const L={RCPT_ID:t.RCPT_ID||"",WRK_ID:t.WRK_ID,CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:i,REG_UID:r,PROD_GRPS:d,PROD_CMPS_CLS:u,PROD_CDS:f,SVC_CDS:m,ITEM_MID_CDS:_,EQT_CLS:y,LENTS:g,EQT_USE_STATS:N,EQT_SALE_AMTS:C,ITLLMT_PRDS:v,SERVICE_CNT:String(R),PROM_CNT:t.PROM_CNT||""},w=await fetch(`${bs}/customer/work/eqtCmpsInfoChg`,{method:"POST",headers:{"Content-Type":"application/json",Origin:l},credentials:"include",body:JSON.stringify({parameters:L})});if(!w.ok){let G=`HTTP ${w.status}: ${w.statusText}`;try{const K=await w.json();G=K.MESSAGE||K.message||G}catch{try{const K=await w.text();K&&(G=K)}catch{}}throw new Fs(G)}return await w.json()}catch(l){throw console.error("[ API]     :",l),l instanceof Fs?l:new Fs("    .")}},C4=async(t,e)=>{if($n())return await new Promise(n=>setTimeout(n,500)),[{EQT_CD:"05",EQT_CL_CD:"STB001",EQT_CL_NM:"STB-HD"},{EQT_CD:"05",EQT_CL_CD:"STB002",EQT_CL_NM:"STB-UHD"},{EQT_CD:"05",EQT_CL_CD:"STB003",EQT_CL_NM:"STB-4K"},{EQT_CD:"04",EQT_CL_CD:"MDM001",EQT_CL_NM:"DOCSIS 3.0"},{EQT_CD:"04",EQT_CL_CD:"MDM002",EQT_CL_NM:"DOCSIS 3.1"}];try{const n={EQT_SEL:"0",PROD_CD:t,BUGA_EQT_SEL:"Y"};e&&(n.CTRT_ID=e);const r=await fetch(`${bs}/customer/receipt/contract/getEquipmentNmListOfProd`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();if(Array.isArray(i))return i;throw i.code&&i.message?new Error(i.message||"    "):new Error("    :   ")}catch(n){throw console.error("[ API]     API :",n),n}},y4=async(t,e)=>{if(console.log("[ API]     API :"),console.log("  - PROD_CD:",t),console.log("  - CTRT_ID:",e),$n())return await new Promise(n=>setTimeout(n,500)),{output1:[{ITEM_MID_CDS:"05        10        ",EQT_CLS:"STB001    MDM001    ",LENTS:"1030",EQT_USE_STATS:"11",ITLLMT_PRDS:"0000",EQT_SALE_AMTS:"0         0         "}],output2:[{SEL:"1",PROD_CD:t,SVC_CD:"SVC001",PROD_TYP:"01",PROD_GRP:"V",EQT:"05",EQT_CD:"05",EQT_CL:"STB001",EQT_CL_NM:"STB-HD",ITM_MID_CD:"05",LENT:"10",EQT_USE_STAT_CD:"1",ITLLMT_PRD:"00",LENT_YN:"Y",EQT_SALE_AMT:0,EQUIP_SEQ:"1",EQT_BASIC_YN:"Y",EQT_NM:""},{SEL:"1",PROD_CD:t,SVC_CD:"SVC001",PROD_TYP:"01",PROD_GRP:"V",EQT:"04",EQT_CD:"04",EQT_CL:"MDM001",EQT_CL_NM:"DOCSIS 3.0",ITM_MID_CD:"04",LENT:"30",EQT_USE_STAT_CD:"1",ITLLMT_PRD:"00",LENT_YN:"Y",EQT_SALE_AMT:0,EQUIP_SEQ:"2",EQT_BASIC_YN:"Y",EQT_NM:""}],output3:[]};try{const n={EQT_SEL:"0",PROD_CD:t,BUGA_EQT_SEL:"Y"};e&&(n.CTRT_ID=e),console.log("[ API]  :",n);const r=await fetch(`${bs}/customer/receipt/contract/getContractEqtList`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();return console.log("[ API] getContractEqtList  :",i),i}catch(n){throw console.error("[ API]     API :",n),n}},Jl=async t=>{if(console.log("[ API]   API :",t),$n()){await new Promise(n=>setTimeout(n,300));const e={};return t.includes("CMCU027")&&(e.CMCU027=[{COMMON_CD:"10",COMMON_CD_NM:""},{COMMON_CD:"30",COMMON_CD_NM:""},{COMMON_CD:"31",COMMON_CD_NM:""},{COMMON_CD:"60",COMMON_CD_NM:""}]),t.includes("CMEP314")&&(e.CMEP314=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU064")&&(e.CMCU064=[{COMMON_CD:"0",COMMON_CD_NM:""},{COMMON_CD:"1",COMMON_CD_NM:"1"},{COMMON_CD:"2",COMMON_CD_NM:"2"},{COMMON_CD:"3",COMMON_CD_NM:"3"}]),t.includes("CMCU057")&&(e.CMCU057=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU110")&&(e.CMCU110=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU148")&&(e.CMCU148=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU005")&&(e.CMCU005=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""},{COMMON_CD:"4",COMMON_CD_NM:""},{COMMON_CD:"5",COMMON_CD_NM:""}]),t.includes("CMCT015")&&(e.CMCT015=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""}]),e}try{const e={CODE_IDS:t.join(",")};console.log("[ API]  :",e);const n=await fetch(`${bs}/common/getCommonCodeList`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const r=await n.json();return console.log("[ API] getCommonCodeList  :",r),r}catch(e){throw console.error("[ API]   API :",e),e}},b4=async t=>{try{const e={P_COMM_GRP_CD:t},n=await fetch(`${bs}/common/getCommonCodeList`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(e){throw console.error("[ API]    API :",e),e}},Su=async(t,e,n,r,i,l)=>{if(console.log("[STB API]    API "),console.log("[STB API]  :",{regUid:t,ctrtId:e,wrkId:n,msgId:r,stbEqtNo:i,modemEqtNo:l}),$n())return await new Promise(d=>setTimeout(d,800)),{MSGCODE:"SUCCESS",MESSAGE:"STB server connection check completed",O_IFSVC_RESULT:"TRUE0000000001SMR03000000"};try{const u=`${typeof window<"u"?window.location.origin:"http://localhost:3000"}/api/customer/work/checkStbServerConnection`,f={REG_UID:t,CTRT_ID:e,WRK_ID:n,MSG_ID:r,STB_EQT_NO:i,MODEM_EQT_NO:l};console.log("[STB API] API URL:",u),console.log("[STB API]  :",f),console.log("[STB API] fetch  ...");const m=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(console.log("[STB API]  :",m.status,m.statusText),!m.ok){const y=await m.text();throw console.error("[STB API] HTTP  :",y),new Error(`HTTP ${m.status}: ${m.statusText}`)}const _=await m.json();return console.log("[STB API]  :",_),Array.isArray(_)&&_.length>0?(console.log("[STB API]      :",_[0]),_[0]):_}catch(d){throw console.error("[STB API] STB    API :",d),d}},N4=async t=>{if(console.log("  API :",t),$n())return await new Promise(e=>setTimeout(e,1500)),{code:"SUCCESS",message:"   ()",data:{WRK_ID:t.workInfo.WRK_ID,WRK_STAT_CD:"4",CMPL_DT:t.workInfo.WRKR_CMPL_DT}};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000";console.log("    API :",`${bs}/customer/work/workComplete`);const n=await nr(`${bs}/customer/work/workComplete`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)},1);console.log("   API  :",n.status,n.statusText);const r=await n.json();return console.log("  API :",r),Array.isArray(r)?(console.log("   -  "),{code:"SUCCESS",message:" .",data:r}):r}catch(e){throw console.error("  API :",e),e instanceof Fs?e:new Fs(e.message||"     .")}},S4=async t=>{if(console.log(" [  ] API :",t),$n())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"  ."};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000";console.log("     API :",`${bs}/customer/work/saveInstallInfo`);const n=await nr(`${bs}/customer/work/saveInstallInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)},1);console.log("    API  :",n.status,n.statusText);const r=await n.json();return console.log("   API :",r),r}catch(e){throw console.error("   API :",e),e instanceof Fs?e:new Fs(e.message||"     .")}},ka=async t=>{if(console.log("[  ] API :",t),$n())return await new Promise(n=>setTimeout(n,300)),{CMCU048:[{code:"1",name:"HFC"},{code:"2",name:"FTTH"},{code:"3",name:"FTTB"}],BLST010:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:""}],BLST014:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:""}],CMCU030:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:"UTP"}],BLST016:[{code:"1",name:""},{code:"2",name:""}],CMCU046:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:""}],CMCU050:[{code:"1",name:"HDMI"},{code:"2",name:"Component"},{code:"3",name:"Composite"}],CMCU051:[{code:"1",name:""},{code:"2",name:""}],CMCU049:[{code:"1",name:""},{code:"2",name:""}]}[t]||[];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/common/getCommonCodes`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify({CODE_GROUP:t})})).json();return Array.isArray(r)?r.map(i=>({code:i.COMMON_CD||i.code||"",name:i.COMMON_CD_NM||i.name||"",description:i.DESCRIPTION||i.description||"",ref_code:i.REF_CODE||i.ref_code||"",ref_code2:i.REF_CODE2||i.ref_code2||"",ref_code3:i.REF_CODE3||i.ref_code3||"",ref_code8:i.REF_CODE8||i.ref_code8||"",ref_code12:i.REF_CODE12||i.ref_code12||""})):[]}catch{return[]}},Rv=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/equipment/getEquipmentOutList`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("    :",r),Array.isArray(r)?r:r.output1||[]}catch(e){throw console.error("    :",e),e instanceof Fs?e:new Fs("    .")}},v4=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/equipment/addCorporationEquipmentQuota`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",r),r}catch(e){throw console.error("   :",e),e instanceof Fs?e:new Fs("   .")}},D4=async(t,e)=>{console.log("[addEquipmentReturnRequest]  :",t);try{if(!t.WRKR_ID||!t.CRR_ID)throw new Fs("  .");if(!t.equipmentList||t.equipmentList.length===0)throw new Fs("  .");const n=typeof window<"u"?window.location.origin:"http://localhost:3000",r=t.equipmentList.length;let i=0,l=[],c=0;for(const d of t.equipmentList){c++,e==null||e(c,r,d.EQT_SERNO||d.EQT_NO);const u={EQT_NO:d.EQT_NO,EQT_SERNO:d.EQT_SERNO||"",RETN_RESN_CD:d.RETN_RESN_CD||"01",ACTION:d.ACTION||"RETURN",WRKR_ID:t.WRKR_ID,CRR_ID:t.CRR_ID,SO_ID:t.SO_ID||"",MST_SO_ID:t.MST_SO_ID||t.SO_ID||"",RETURN_TP:t.RETURN_TP||"2",PROC_STAT:"1",RETN_PSN_ID:t.WRKR_ID};console.log("[addEquipmentReturnRequest]  :",d.EQT_SERNO,u);try{const m=await(await nr(`${bs}/customer/equipment/addEquipmentReturnRequest`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify(u)})).json();console.log("[addEquipmentReturnRequest]  :",d.EQT_SERNO,m),m&&(m.MSGCODE==="0"||m.MSGCODE==="SUCCESS"||m.success===!0)?i++:l.push(d.EQT_SERNO||d.EQT_NO)}catch(f){console.error("[addEquipmentReturnRequest]  :",d.EQT_SERNO,f),l.push(d.EQT_SERNO||d.EQT_NO)}}if(console.log("[addEquipmentReturnRequest] : ",i,"/ ",l.length),i>0)return{success:!0,MSGCODE:"SUCCESS",message:l.length>0?`${i}  , ${l.length} `:`${i}  .`,data:{successCount:i,failedItems:l}};throw new Fs(` : ${l.join(", ")}`)}catch(n){throw console.error("[addEquipmentReturnRequest]  :",n),n instanceof Fs?n:new Fs(n.message||"  .")}},R4=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/equipment/cmplEqtCustLossIndem`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),r}catch(e){throw console.error("  :",e),e instanceof Fs?e:new Fs("  .")}},T4=async t=>{console.log("[fn:setEquipmentCheckStandby -> req:setEquipmentChkStndByY_ForM] API:",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${bs}/customer/equipment/setEquipmentChkStndByY_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)}),r=await n.json();if(r.debugLogs&&(console.log("[backend debug logs]"),r.debugLogs.forEach(i=>console.log(i))),n.status===400&&r.code==="BUSINESS_RULE_ERROR")throw console.error("business rule error:",r.message),new Error(r.message||"business rule error");if(!n.ok){console.error("equipment status change failed:",r);const i=r.message||r.error||`server error (HTTP ${n.status})`;throw new Error(i)}return console.log("equipment status change success:",r),r}catch(e){throw console.error("equipment status change failed:",e),e instanceof Error?e:new Error("equipment status change failed.")}},bf=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/statistics/equipment/getEquipmentHistoryInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();console.log("  :",r);const i=(r==null?void 0:r.data)||r;return Array.isArray(i)?i:[i]}catch(e){throw console.error("  :",e),e instanceof Fs?e:new Fs("  .")}},E4=async t=>{const e=`API_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,n=Date.now(),r={...t,TO_WRKR_ID:t.MV_WRKR_ID,WRKR_ID:t.MV_WRKR_ID};console.log(`[fn:changeEquipmentWorker -> req:changeEqtWrkr_3_ForM] ${e}`),console.log("params:",JSON.stringify(r,null,2));try{const i=`${bs}/customer/equipment/changeEqtWrkr_3_ForM`,l=new AbortController,c=setTimeout(()=>l.abort(),3e4),d=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r),signal:l.signal});clearTimeout(c);const u=Date.now()-n;console.log(`[${e}] HTTP ${d.status} (${u}ms)`);const f=await d.text();console.log(`[${e}] RAW:`,f);let m;try{m=JSON.parse(f),console.log(`[${e}] PARSED:`,JSON.stringify(m,null,2))}catch{throw console.error(`[${e}] JSON parse failed`),new Error("server response parse failed")}const _=m==null?void 0:m.MSGCODE,y=(m==null?void 0:m.MESSAGE)||(m==null?void 0:m.message)||"";if(_==="SUCCESS")return console.log(`[${e}] SUCCESS (MSGCODE=SUCCESS, ${u}ms)`),m;if(_==="FAIL")throw new Error(y||"Oracle procedure failed (MSGCODE=FAIL)");if(!d.ok){const g=y||(m==null?void 0:m.error)||(m==null?void 0:m.code)||`server error (HTTP ${d.status})`;throw new Error(g)}if(y&&(y.includes("ERROR")||y.includes("FAIL")))throw new Error(y);return console.log(`[${e}] SUCCESS (${u}ms)`),m}catch(i){const l=Date.now()-n;throw console.error(`[${e}] FAILED (${l}ms):`,i.message),i.name==="AbortError"?new Error("Request timeout (30s)."):i instanceof Error?i:new Error("equipment transfer failed.")}},j4=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/work/worker-adjustment`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),r}catch(e){throw console.error("  :",e),e instanceof Fs?e:new Fs("  .")}},l_=async t=>{console.log("[fn:findUserList -> req:getFindUsrList3] API:",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n={};t.USR_NM&&t.USR_NM.trim()&&(n.USR_NM=t.USR_NM.trim(),n.WRKR_NM=t.USR_NM.trim()),t.USR_ID&&t.USR_ID.trim()&&(n.USR_ID=t.USR_ID.trim(),n.WRKR_ID=t.USR_ID.trim()),t.SO_ID&&(n.SO_ID=t.SO_ID),t.CRR_ID&&(n.CRR_ID=t.CRR_ID),console.log("[findUserList] cleaned params:",n);const i=await(await nr(`${bs}/system/cm/getFindUsrList3`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(n)})).json();return console.log("findUserList result:",i),Array.isArray(i)?i:i.output1&&Array.isArray(i.output1)?i.output1:i.data&&Array.isArray(i.data)?i.data:[]}catch(e){throw console.error("findUserList failed:",e),e instanceof Fs?e:new Fs("findUserList failed.")}},I4=async(t,e,n)=>{console.log(" [] API :",{custId:t,startDate:e,endDate:n});try{const r=new Date,i=r.toISOString().slice(0,10).replace(/-/g,""),c=new Date(r.getTime()-10080*60*1e3).toISOString().slice(0,10).replace(/-/g,""),d={CUST_ID:t,SMS_PROCESS:"ALL",REG_DATE1:e||c,REG_DATE2:n||i},u=typeof window<"u"?window.location.origin:"http://localhost:3000",m=await(await nr(`${bs}/customer/sigtrans/getENSSendHist`,{method:"POST",headers:{"Content-Type":"application/json",Origin:u},credentials:"include",body:JSON.stringify(d)})).json();return console.log("  :",m),Array.isArray(m)?m:m.output&&Array.isArray(m.output)?m.output:m.data&&Array.isArray(m.data)?m.data:[]}catch(r){throw console.error("  :",r),r instanceof Fs?r:new Fs("  .")}},O4=async t=>{console.log(" [] API :",{custId:t});try{const e={CUST_ID:t},n=typeof window<"u"?window.location.origin:"http://localhost:3000",i=await(await nr(`${bs}/customer/negociation/getCustConslHist`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify(e)})).json();return console.log("  :",i),Array.isArray(i)?i:i.output&&Array.isArray(i.output)?i.output:i.data&&Array.isArray(i.data)?i.data:[]}catch(e){throw console.error("  :",e),e instanceof Fs?e:new Fs("  .")}},sC=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/work/getEquipLossInfo_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",r),Array.isArray(r)?r:r.output1||[]}catch(e){throw console.error("   :",e),e instanceof Fs?e:new Fs("   .")}},M4=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/work/modEquipLoss_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),r}catch(e){throw console.error("  :",e),e instanceof Fs?e:new Fs("  .")}},u5=async t=>{console.log("[ ] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/contract/getFullContractInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",r),{contracts:r.contracts||[],billing:r.billing||null,currentContract:r.currentContract||null}}catch(e){throw console.error("   :",e),e instanceof Fs?e:new Fs("  .")}},If=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/contract/getContractInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),Array.isArray(r)?r:[]}catch(e){throw console.error("  :",e),e instanceof Fs?e:new Fs("  .")}},dl=async t=>{console.log("[getProdPromotionInfo]  :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/customer/work/getProdPromotionInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[getProdPromotionInfo] :",r),Array.isArray(r)?r:(r==null?void 0:r.data)||(r==null?void 0:r.output)||[]}catch(e){return console.error("[getProdPromotionInfo] :",e),[]}},la=async t=>{console.log(" [] sendSignal :",t.MSG_ID,t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await nr(`${bs}/signal/send`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log(" [] :",r),r}catch(e){return console.error("[] :",e),{code:"ERROR",message:e.message||"  .",MSG_ID:t.MSG_ID}}},T_=async t=>{if(console.log("[ API] insertWorkRemoveStat :",t),$n())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"  ()"};try{const e=localStorage.getItem("userInfo"),n=e?JSON.parse(e):{},r=t.REG_UID||n.userId||"A20130708",i={WRK_ID:t.WRK_ID,REMOVE_LINE_TP:t.REMOVE_LINE_TP,REMOVE_GB:t.REMOVE_GB,REMOVE_STAT:t.REMOVE_STAT||"",REG_UID:r};console.log("[ API]  :",i);const c=await(await fetch(`${bs}/customer/work/insertWorkRemoveStat`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)})).json();return console.log("[ API] :",c),Array.isArray(c)||c.code==="SUCCESS"||c.success===!0?{code:"SUCCESS",message:" ."}:{code:"ERROR",message:c.message||c.msg||"  ."}}catch(e){return console.error("[ API] :",e),{code:"ERROR",message:e.message||"    ."}}},h5=async t=>{if($n())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"AS  ()"};try{const e=localStorage.getItem("userInfo"),n=e?JSON.parse(e):{},r=t.REG_UID||n.userId||"A20130708",i=t.CRR_ID||n.crrId||"01",l={CUST_ID:t.CUST_ID,RCPT_ID:t.RCPT_ID||"",WRK_DTL_TCD:t.WRK_DTL_TCD,WRK_RCPT_CL:t.WRK_RCPT_CL,WRK_RCPT_CL_DTL:t.WRK_RCPT_CL_DTL,WRK_HOPE_DTTM:t.WRK_HOPE_DTTM,HOPE_DTTM:t.WRK_HOPE_DTTM,MEMO:t.MEMO||"",EMRG_YN:t.EMRG_YN||"N",HOLY_YN:t.HOLY_YN||"N",CRR_ID:i,WRKR_ID:t.WRKR_ID||r,REG_UID:r,WRK_DIV_ID:"",POST_ID:t.POST_ID||"",BLD_ID:t.BLD_ID||"",BLD_CL:t.BLD_CL||"",BLD_NM:t.BLD_NM||"",BUN_CL:t.BUN_CL||"",BUN_NO:t.BUN_NO||"",HO_NM:t.HO_NM||"",APT_DONG_NO:t.APT_DONG_NO||"",APT_HO_CNT:t.APT_HO_CNT||"",ADDR:t.ADDR||"",ADDR_DTL:t.ADDR_DTL||""},d=await(await fetch(`${bs}/customer/work/modAsPdaReceipt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)})).json();return Array.isArray(d)||d.code==="SUCCESS"||d.success===!0?{code:"SUCCESS",message:"AS ."}:{code:"ERROR",message:d.message||d.msg||"AS ."}}catch(e){return console.error("[AS API] :",e),{code:"ERROR",message:e.message||"AS   ."}}},Tv=async(t,e)=>{if(console.log("[Hotbill API] getHotbillSummary :",{custId:t,rcptId:e}),$n())return await new Promise(n=>setTimeout(n,500)),{details:[{BILL_SEQ_NO:"202412001",PROD_GRP:"DTV",SO_ID:"01",CHG_NM:"DTV ",BILL_AMT:15e3,PYM_AMT:15e3,UPYM_AMT:0},{BILL_SEQ_NO:"202412002",PROD_GRP:"ISP",SO_ID:"01",CHG_NM:" ",BILL_AMT:25e3,PYM_AMT:0,UPYM_AMT:25e3}],refund:{TOT_RFND_AMT:5e3,RFND_RSN:" "},totalAmount:4e4,paidAmount:15e3,unpaidAmount:25e3,refundAmount:5e3};try{const n=await fetch(`${bs}/hotbill/summary`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CUST_ID:t,RCPT_ID:e})});if(!n.ok)throw console.error("[Hotbill API] HTTP :",n.status),new Error(`Hot Bill API   . (HTTP ${n.status})`);const r=n.headers.get("content-type");if(!r||!r.includes("application/json"))throw console.error("[Hotbill API]   :",r),new Error("Hot Bill API   .");const i=await n.json();return console.log("[Hotbill API] getHotbillSummary :",i),{details:Array.isArray(i.details)?i.details.map(l=>({...l,BILL_AMT:Number(l.BILL_AMT)||0,PYM_AMT:Number(l.PYM_AMT)||0,UPYM_AMT:Number(l.UPYM_AMT)||0})):[],refund:i.refund?{...i.refund,TOT_RFND_AMT:Number(i.refund.TOT_RFND_AMT)||0}:null,totalAmount:Number(i.totalAmount)||0,paidAmount:Number(i.paidAmount)||0,unpaidAmount:Number(i.unpaidAmount)||0,refundAmount:Number(i.refundAmount)||0}}catch(n){throw console.error("[Hotbill API] getHotbillSummary :",n),n}},L4=async t=>{if(console.log("[Hotbill API] runHotbillSimulation :",t),$n())return await new Promise(e=>setTimeout(e,300)),{code:"SUCCESS",RCPT_ID:t.RCPT_ID||"1044931550",message:"OK (Demo)",simulatedCount:1};try{const e={CUST_ID:t.CUST_ID,CTRT_ID:t.CTRT_ID,SO_ID:t.SO_ID,HOPE_DT:t.HOPE_DT,CLC_WRK_CL:t.CLC_WRK_CL||"2",RCPT_ID:t.RCPT_ID||"",IS_NEW:t.IS_NEW||"false",PNTY_EXMP_YN:t.PNTY_EXMP_YN||"N"},n=await fetch(`${bs}/hotbill/simulate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw console.error("[Hotbill API] HTTP :",n.status),new Error(`Hot Bill  API  (HTTP ${n.status})`);const r=await n.json();return console.log("[Hotbill API] runHotbillSimulation :",r),{code:r.code||"ERROR",RCPT_ID:r.RCPT_ID||"",message:r.message||"",simulatedCount:r.simulatedCount||0}}catch(e){throw console.error("[Hotbill API] runHotbillSimulation :",e),e}},Ev=async(t,e,n,r,i)=>{if(console.log("[Hotbill API] getHotbillByContract :",{billSeqNo:t,prodGrp:e,soId:n,clcWrkCl:r,rcptId:i}),$n())return await new Promise(l=>setTimeout(l,200)),[{BILL_SEQ_NO:t,PROD_GRP:e,SO_ID:n,CTRT_ID:"0000000001",CLC_WRK_NO:"20241201001",BILL_AMT:2e4}];try{const l=await fetch(`${bs}/hotbill/byContract`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({BILL_SEQ_NO:t,PROD_GRP:e,SO_ID:n,CLC_WRK_CL:r,RCPT_ID:i})});if(!l.ok)throw console.error("[Hotbill API] HTTP :",l.status),new Error(`Hot Bill   API  (HTTP ${l.status})`);const c=await l.json();return console.log("[Hotbill API] getHotbillByContract :",c),Array.isArray(c)?c.map(d=>({BILL_SEQ_NO:d.BILL_SEQ_NO||"",PROD_GRP:d.PROD_GRP||"",SO_ID:d.SO_ID||"",CTRT_ID:d.CTRT_ID||"",CLC_WRK_NO:d.CLC_WRK_NO||"",BILL_AMT:Number(d.BILL_AMT)||0})):[]}catch(l){throw console.error("[Hotbill API] getHotbillByContract :",l),l}},jv=async(t,e,n)=>{if(console.log("[Hotbill API] getHotbillByCharge :",{billSeqNo:t,clcWrkNo:e,ctrtId:n}),$n())return await new Promise(r=>setTimeout(r,300)),[{CLC_WRK_NO:e,BILL_SEQ_NO:t,CUST_ID:"0000000001",CTRT_ID:n,SORT_SEQ:"1",CHRG_ITEM_NM:"",REQ_YN:"Y",BILL_AMT:15e3},{CLC_WRK_NO:e,BILL_SEQ_NO:t,CUST_ID:"0000000001",CTRT_ID:n,SORT_SEQ:"2",CHRG_ITEM_NM:"",REQ_YN:"N",BILL_AMT:5e3}];try{const i=await(await fetch(`${bs}/hotbill/byCharge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({BILL_SEQ_NO:t,CLC_WRK_NO:e,CTRT_ID:n})})).json();return console.log("[Hotbill API] getHotbillByCharge :",i),Array.isArray(i)?i.map(l=>({CLC_WRK_NO:l.CLC_WRK_NO||"",BILL_SEQ_NO:l.BILL_SEQ_NO||"",CUST_ID:l.CUST_ID||"",CTRT_ID:l.CTRT_ID||"",SORT_SEQ:l.SORT_SEQ||"0",CHRG_ITEM_NM:l.CHRG_ITEM_NM||"",REQ_YN:l.REQ_YN||"N",BILL_AMT:Number(l.BILL_AMT)||0})):[]}catch(r){throw console.error("[Hotbill API] getHotbillByCharge :",r),r}},w4=async t=>{if(console.log("[SMS API] sendVisitSms :",t),$n())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"  . (Demo)"};try{const e={SMS_EML_TYPE:t.SMS_EML_TYPE,SO_ID:t.SO_ID,USER_SMS:t.USER_SMS.replace(/-/g,"").replace(/\s/g,""),SEND_SMS:t.SEND_SMS.replace(/-/g,"").replace(/\s/g,""),USER_ID:t.USER_ID,USER_NAME:t.USER_NAME,MAP01:t.MAP01,KKO_MSG_ID:t.KKO_MSG_ID,REG_UID:t.REG_UID,TRANS_YN:t.TRANS_YN||"N",SMS_EML_CL:t.SMS_EML_CL||"20"},n=await fetch(`${bs}/customer/sigtrans/saveENSSendHist`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw console.error("[SMS API] HTTP :",n.status),new Error(`  API  (HTTP ${n.status})`);const r=await n.json();return console.log("[SMS API] sendVisitSms :",r),r.MSGCODE==="SUCCESS"||r.code==="SUCCESS"?{code:"SUCCESS",message:r.MESSAGE||r.message||"  ."}:{code:r.MSGCODE||r.code||"ERROR",message:r.MESSAGE||r.message||"  ."}}catch(e){throw console.error("[SMS API] sendVisitSms :",e),e}},f5=async t=>{console.log("[ API] getMmtSusInfo :",t);try{const e=await fetch(`${bs}/customer/etc/getMmtSusInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw console.error("[ API] HTTP :",e.status),new Error(`  API  (HTTP ${e.status})`);const n=await e.json();if(console.log("[ API] getMmtSusInfo :",n),n&&(n.SUS_HOPE_DD||n.output)){const r=n.output?n.output[0]:n;return{SUS_HOPE_DD:r.SUS_HOPE_DD||"",MMT_SUS_HOPE_DD:r.MMT_SUS_HOPE_DD||"",VALID_SUS_DAYS:r.VALID_SUS_DAYS||"",MMT_SUS_CD:r.MMT_SUS_CD||"",WRK_DTL_TCD:r.WRK_DTL_TCD||""}}return null}catch(e){throw console.error("[ API] getMmtSusInfo :",e),e}},m5=async t=>{console.log("[ API] modMmtSusInfo :",t);try{const e=await fetch(`${bs}/customer/etc/modMmtSusInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw console.error("[ API] HTTP :",e.status),new Error(`  API  (HTTP ${e.status})`);const n=await e.json();return console.log("[ API] modMmtSusInfo :",n),n.MSGCODE==="SUCCESS"||n.code==="SUCCESS"?{code:"SUCCESS",message:n.MESSAGE||n.message||" ."}:{code:n.MSGCODE||n.code||"ERROR",message:n.MESSAGE||n.message||"  ."}}catch(e){throw console.error("[ API] modMmtSusInfo :",e),e}},g5=async(t,e)=>{console.log("[Contract API] getCtrtDetailInfo:",t,e);try{const n={CTRT_ID:t};e&&(n.CUST_ID=e);const r=await fetch(`${bs}/customer/contract/getCtrtDetailInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!r.ok)return console.error("[Contract API] getCtrtDetailInfo HTTP error:",r.status),null;const i=await r.json();return console.log("[Contract API] getCtrtDetailInfo response:",i),i}catch(n){return console.error("[Contract API] getCtrtDetailInfo error:",n),null}},p5=async t=>{console.log("[Work API] getAfterProcInfo:",t);try{const e=await fetch(`${bs}/customer/work/getAfterProcInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({WRK_DRCTN_ID:t})});if(!e.ok)return console.error("[Work API] getAfterProcInfo HTTP error:",e.status),null;const n=await e.json();return console.log("[Work API] getAfterProcInfo response:",n),n}catch(e){return console.error("[Work API] getAfterProcInfo error:",e),null}},P4=async(t,e)=>{console.log("[Alarm API] getAllAlarmInfo:",{custId:t,wrkDrctnId:e});try{const n=await fetch(`${bs}/customer/alarm/getAllAlarmInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CUST_ID:t,WRK_DRCTN_ID:e||""})});if(!n.ok)return console.error("[Alarm API] HTTP error:",n.status),{};const r=await n.json();return console.log("[Alarm API] getAllAlarmInfo response:",r),r}catch(n){return console.error("[Alarm API] getAllAlarmInfo error:",n),{}}},Cg=async t=>{if(console.log("[ API] getMoveWorkInfo:",t),$n())return await new Promise(e=>setTimeout(e,500)),{MVM_TP:"01",MVM_TP_NM:"",WRK_ID:t.WRK_ID,PROD_NM:"DTV ",HOPE_DTTM:"2024-12-29 10:00",WRK_STAT_NM:"",ADDR_ORD:"   123",WRK_CD:t.WRK_CD};try{const e=await fetch(`${bs}/customer/work/getMoveWorkInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),null;const n=await e.json();return console.log("[ API] getMoveWorkInfo response:",n),n.data?n.data:Array.isArray(n)&&n.length>0?n[0]:n}catch(e){return console.error("[ API] getMoveWorkInfo error:",e),null}},_5=async t=>{if(console.log("[ API] getMVRemoveEqtInfo:",t),$n())return await new Promise(e=>setTimeout(e,500)),[{CHK:1,CTRT_ID:"CT123456",EQT_CL_NM:"DTV ",LENT_YN_NM:"",EQT_USE_STAT_CD:"",NOTRECEV:"",EQT_LOC_TP_CD:"",EQT_STAT_CD:"",WRKR_NM:"",EQT_SERNO:"STB123456789",MAC_ADDRESS:"AA:BB:CC:DD:EE:FF",ITEM_NM:"UHD ",WRK_CD:"08"},{CHK:1,CTRT_ID:"CT123456",EQT_CL_NM:"",LENT_YN_NM:"",EQT_USE_STAT_CD:"",NOTRECEV:"",EQT_LOC_TP_CD:"",EQT_STAT_CD:"",WRKR_NM:"",EQT_SERNO:"MDM987654321",MAC_ADDRESS:"11:22:33:44:55:66",ITEM_NM:" ",WRK_CD:"08"}];try{const e=await fetch(`${bs}/customer/equipment/getMVRemoveEqtInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),[];const n=await e.json();return console.log("[ API] getMVRemoveEqtInfo response:",n),n.data?Array.isArray(n.data)?n.data:[n.data]:Array.isArray(n)?n:[]}catch(e){return console.error("[ API] getMVRemoveEqtInfo error:",e),[]}},x5=async t=>{if(console.log("[ API] getEqtSoMoveInfo:",t),$n())return await new Promise(e=>setTimeout(e,500)),[];try{const e=await fetch(`${bs}/customer/work/getEqtSoMoveInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),[];const n=await e.json();return console.log("[ API] getEqtSoMoveInfo response:",n),n.data?Array.isArray(n.data)?n.data:[n.data]:Array.isArray(n)?n:[]}catch(e){return console.error("[ API] getEqtSoMoveInfo error:",e),[]}},A4=async t=>{if(console.log("[ API] excuteSoMoveEqtChg:",t),$n())return await new Promise(e=>setTimeout(e,1e3)),{MSGCODE:"SUCCESS",MESSAGE:" ."};try{const e=await fetch(`${bs}/customer/work/excuteSoMoveEqtChg`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),null;const n=await e.json();return console.log("[ API] excuteSoMoveEqtChg response:",n),n.data?n.data:n}catch(e){return console.error("[ API] excuteSoMoveEqtChg error:",e),null}},k4=async t=>{if(console.log("[ API] custEqtInfoDel:",t),$n())return await new Promise(e=>setTimeout(e,500)),{MSGCODE:"SUCCESS",MESSAGE:" ."};try{const e=await fetch(`${bs}/customer/work/custEqtInfoDel`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),null;const n=await e.json();return console.log("[ API] custEqtInfoDel response:",n),n.data?n.data:n}catch(e){return console.error("[ API] custEqtInfoDel error:",e),null}},mc=async()=>{console.log("[Work API] getLghvProdMap called");try{const t=await fetch(`${bs}/customer/work/getLghvProdMap`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!t.ok)return console.error("[Work API] getLghvProdMap HTTP error:",t.status),[];const e=await t.json();return console.log("[Work API] getLghvProdMap response:",e),Array.isArray(e)?e:e.data&&Array.isArray(e.data)?e.data:[]}catch(t){return console.error("[Work API] getLghvProdMap error:",t),[]}},sx=async t=>{console.log("[Work API] getOttSale called:",t);try{const e=await fetch(`${bs}/customer/work/getOttSale`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] getOttSale HTTP error:",e.status),null;const n=await e.json();return console.log("[Work API] getOttSale response:",n),Array.isArray(n)&&n.length>0?n[0]:n.data&&Array.isArray(n.data)&&n.data.length>0?n.data[0]:n.output&&Array.isArray(n.output)&&n.output.length>0?n.output[0]:n}catch(e){return console.error("[Work API] getOttSale error:",e),null}},U4=async t=>{console.log("[Work API] saveOttSale called:",t);try{const e=await fetch(`${bs}/customer/work/saveOttSale`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] saveOttSale HTTP error:",e.status),{code:"ERROR",message:`HTTP ${e.status}`};const n=await e.json();return console.log("[Work API] saveOttSale response:",n),{code:n.code||n.CODE||"SUCCESS",message:n.message||n.MESSAGE||""}}catch(e){return console.error("[Work API] saveOttSale error:",e),{code:"ERROR",message:e.message||"Unknown error"}}},B4=async t=>{console.log("[Work API] getOttSerno called:",t);try{const e=await fetch(`${bs}/customer/work/getOttSerno`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] getOttSerno HTTP error:",e.status),[];const n=await e.json();return console.log("[Work API] getOttSerno response:",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n.output&&Array.isArray(n.output)?n.output:[]}catch(e){return console.error("[Work API] getOttSerno error:",e),[]}},W4=async t=>{console.log("[Work API] getOttType called:",t);try{const e=await fetch(`${bs}/customer/work/getOttType`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] getOttType HTTP error:",e.status),null;const n=await e.json();return console.log("[Work API] getOttType response:",n),Array.isArray(n)&&n.length>0?n[0]:n.data&&Array.isArray(n.data)&&n.data.length>0?n.data[0]:n.output&&Array.isArray(n.output)&&n.output.length>0?n.output[0]:n}catch(e){return console.error("[Work API] getOttType error:",e),null}},Zm=async t=>{console.log("[Common Code API] getCodeDetail params:",t);try{const e=await fetch(`${bs}/system/common/getCodeDetail`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Common Code API] getCodeDetail HTTP error:",e.status),[];const n=await e.json();return console.log("[Common Code API] getCodeDetail response:",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:[]}catch(e){return console.error("[Common Code API] getCodeDetail error:",e),[]}},F4=async t=>{console.log("[getEqtMasterInfo] API :",t);try{const n=await(await nr(`${bs}/customer/equipment/getEqtMasterInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n.output1&&Array.isArray(n.output1)?n.output1:n}catch(e){throw console.error("   :",e),e}},Iv=async t=>{console.log("[getOutEquipmentTargetList] API :",t);try{const n=await(await nr(`${bs}/customer/equipment/getOutEquipmentTargetList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("    :",n),n}catch(e){throw console.error("    :",e),e instanceof Fs?e:new Fs("    .")}},Ov=async t=>{const e={...t,RETURN_TP:t.RETURN_TP||"2",RETURN_STAT:t.RETURN_STAT||"2"};console.log("[getEquipmentReturnRequestListAll] API :",e);try{const r=await(await nr(`${bs}/customer/equipment/getEquipmentReturnRequestList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)})).json();return console.log("   :",r),Array.isArray(r)?r:r.output1||r.data||[]}catch(n){throw console.error("   :",n),n instanceof Fs?n:new Fs("   .")}},K4=async(t,e)=>{console.log("[delEquipmentReturnRequest]  :",t);try{if(!t.WRKR_ID||!t.CRR_ID)throw new Fs("  .");if(!t.equipmentList||t.equipmentList.length===0)throw new Fs("  .");const n=t.equipmentList.length;let r=0,i=[],l=0;for(const c of t.equipmentList){l++,e==null||e(l,n,c.EQT_SERNO||c.EQT_NO);const d={EQT_NO:c.EQT_NO,REQ_DT:c.REQ_DT||"",RETURN_TP:c.RETURN_TP||"2",EQT_USE_ARR_YN:c.EQT_USE_ARR_YN==="A"?"A":"Y",WRKR_ID:t.WRKR_ID,CRR_ID:t.CRR_ID,SO_ID:t.SO_ID||""};console.log("[delEquipmentReturnRequest]  :",c.EQT_SERNO,d);try{const f=await(await nr(`${bs}/customer/equipment/delEquipmentReturnRequest`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)})).json();console.log("[delEquipmentReturnRequest]  :",c.EQT_SERNO,f),f&&(f.MSGCODE==="0"||f.MSGCODE==="SUCCESS"||f.success===!0)?r++:i.push(c.EQT_SERNO||c.EQT_NO)}catch(u){console.error("[delEquipmentReturnRequest]  :",c.EQT_SERNO,u),i.push(c.EQT_SERNO||c.EQT_NO)}}if(console.log("[delEquipmentReturnRequest] : ",r,"/ ",i.length),r>0)return{success:!0,message:i.length>0?`${r}  , ${i.length} `:`${r}  .`,data:{successCount:r,failedItems:i}};throw new Fs(` : ${i.join(", ")}`)}catch(n){throw console.error("[delEquipmentReturnRequest]  :",n),n instanceof Fs?n:new Fs(n.message||"  .")}},Km=async t=>{console.log("[getWrkrHaveEqtListAll] API :",t);try{const n=await(await nr(`${bs}/customer/equipment/getWrkrHaveEqtList_All`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",n),n?n.data&&Array.isArray(n.data)?n.data:Array.isArray(n)?n:n.output1||[]:[]}catch(e){throw console.error("   :",e),e instanceof Fs?e:new Fs("   .")}},Mv=async t=>{console.log("[getEquipmentChkStndByAAll] API :",t);try{const n=await(await nr(`${bs}/customer/equipment/getEquipmentChkStndByA_All`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",n),n?n.data&&Array.isArray(n.data)?n.data:Array.isArray(n)?n:n.output1||[]:[]}catch(e){throw console.error("   :",e),e instanceof Fs?e:new Fs("   .")}},C5=async t=>{console.log("[getEquipmentTypeList] API call:",t);try{const n=await(await nr(`${bs}/customer/equipment/getEquipmentTypeList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[getEquipmentTypeList] Result:",n),n?n.data&&Array.isArray(n.data)?n.data:Array.isArray(n)?n:n.output1||[]:[]}catch(e){return console.error("[getEquipmentTypeList] Failed:",e),[]}},E_="dlive_transferred_equipment",Q4=48,G4=t=>{try{const n=bb().filter(i=>i.EQT_SERNO!==t.EQT_SERNO),r={...t,transferredAt:Date.now(),isTransferred:!0};n.push(r),localStorage.setItem(E_,JSON.stringify(n)),console.log("[TransferredEquipment] Saved:",t.EQT_SERNO)}catch(e){console.error("[TransferredEquipment] Save error:",e)}},bb=()=>{try{const t=localStorage.getItem(E_);if(!t)return[];const e=JSON.parse(t),n=Date.now(),r=Q4*60*60*1e3,i=e.filter(l=>n-l.transferredAt<r);return i.length!==e.length&&localStorage.setItem(E_,JSON.stringify(i)),i}catch(t){return console.error("[TransferredEquipment] Get error:",t),[]}},Y4=async t=>{try{const e=await fetch(`${bs}/customer/sigtrans/getLghvSendHist`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return e.ok?(await e.json()).output||[]:(console.error("[Signal API] getLghvSendHist HTTP error:",e.status),[])}catch(e){return console.error("[Signal API] getLghvSendHist error:",e),[]}},V4=t=>bb().filter(n=>n.TO_WRKR_ID===t),$4=t=>{try{const n=bb().filter(r=>r.EQT_SERNO!==t);localStorage.setItem(E_,JSON.stringify(n)),console.log("[TransferredEquipment] Removed:",t)}catch(e){console.error("[TransferredEquipment] Remove error:",e)}},H4=(t,e)=>{const n=V4(e);if(n.length===0)return{merged:t,transferredCount:0};const r=new Set(t.map(l=>l.EQT_SERNO)),i=[];return n.forEach(l=>{r.has(l.EQT_SERNO)?$4(l.EQT_SERNO):i.push({EQT_NO:l.EQT_NO,EQT_SERNO:l.EQT_SERNO,ITEM_NM:l.ITEM_NM,ITEM_MID_NM:l.ITEM_MID_NM||"",ITEM_MAX_NM:l.ITEM_MAX_NM||"",EQT_CL_NM:l.EQT_CL_NM||"",SO_ID:l.SO_ID,SO_NM:l.SO_NM||"",WRKR_ID:l.TO_WRKR_ID,FROM_WRKR_ID:l.FROM_WRKR_ID,FROM_WRKR_NM:l.FROM_WRKR_NM||"",isTransferred:!0,transferredAt:l.transferredAt})}),console.log("[TransferredEquipment] Merging:",i.length,"items not in API"),{merged:[...t,...i],transferredCount:i.length}},z4=async t=>{try{const e=await fetch(`${bs}/customer/sigtrans/getLghvSvcRslt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({JOB_ID:t})});return e.ok?(await e.json()).output||[]:(console.error("[Signal API] getLghvSvcRslt HTTP error:",e.status),[])}catch(e){return console.error("[Signal API] getLghvSvcRslt error:",e),[]}},q4=async t=>{try{const e=await fetch(`${bs}/customer/sigtrans/getSendHistory`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return e.ok?((await e.json()).output||[]).map(i=>{const l={};for(const c of Object.keys(i))l[c.toUpperCase()]=i[c];return l}):[]}catch(e){return console.error("[Signal API] getSendHistory error:",e),[]}},X4=async t=>{const e=n=>n.map(r=>{const i={};for(const l of Object.keys(r))i[l.toUpperCase()]=r[l];return i});try{const n=await fetch(`${bs}/customer/sigtrans/getSvcRsltAndDtlRslt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({IF_DTL_ID:t})});if(!n.ok)return{svcRslt:[],svcDtlRslt:[]};const r=await n.json(),i=r.output1||r.ds_svc_rest||r.ds_svc_rslt||[],l=r.output2||r.ds_svc_dtl_rslt||r.ds_svc_dtl||[];return{svcRslt:e(i),svcDtlRslt:e(l)}}catch(n){return console.error("[Signal API] getSvcRsltAndDtlRslt error:",n),{svcRslt:[],svcDtlRslt:[]}}},J4=()=>{try{const t=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(t){const e=JSON.parse(t);return e.userId||e.USR_ID||e.LOGIN_ID||"SYSTEM"}}catch{}return"SYSTEM"},nx=async t=>{try{const e=await fetch(`${bs}/customer/common/customercommon/getConditionalCustList2`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,SERCH_GB:"3",LOGIN_ID:J4()})});if(!e.ok)return[];const n=await e.json();return n.output||n.data||[]}catch(e){return console.error("[Customer Search] error:",e),[]}},Z4=async t=>nx({TEL_NO:t}),e3=async t=>nx({CUST_ID:t}),t3=async t=>nx({CTRT_ID:t}),s3=async t=>nx({EQT_SERNO:t}),n3=async t=>{try{const e=await fetch(`${bs}/customer/contract/getContractInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CUST_ID:t})});if(!e.ok)return[];const n=await e.json();return Array.isArray(n)?n:n.output||n.data||[]}catch(e){return console.error("[Customer Search] getContractList error:",e),[]}};var vu=FT();const Zs=({value:t,onValueChange:e,options:n=[],placeholder:r="",className:i="",required:l=!1,disabled:c=!1})=>{const[d,u]=x.useState(!1),[f,m]=x.useState(!1);x.useEffect(()=>{m(!0)},[]);const _=n==null?void 0:n.find(g=>g.value===t);x.useEffect(()=>{const g=N=>{N.key==="Escape"&&u(!1)};if(d)return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[d]);const y=g=>{e(g),u(!1)};return s.jsxs("div",{className:`relative ${i}`,style:{zIndex:"auto"},children:[s.jsxs("button",{type:"button",onClick:()=>!c&&u(!d),disabled:c,className:`
          w-full p-3 text-left border border-gray-300 rounded-lg
          transition-colors duration-200 flex items-center justify-between
          ${c?"bg-gray-100 cursor-not-allowed opacity-60":"bg-white hover:border-gray-400 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"}
          ${d&&!c?"ring-2 ring-cyan-500 border-cyan-500":""}
        `,"aria-expanded":d,"aria-haspopup":"listbox",required:l,children:[s.jsx("span",{className:`text-base ${_?"text-gray-900":"text-gray-500"}`,children:_?_.label:r}),s.jsx(sr,{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&f&&typeof window<"u"&&vu.createPortal(s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",style:{zIndex:99999},onClick:()=>u(!1)}),s.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white rounded-t-xl shadow-2xl",style:{zIndex:1e5,maxHeight:"60vh",display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"flex justify-center py-3 bg-white rounded-t-xl",style:{flexShrink:0},children:s.jsx("div",{className:"w-8 h-1 bg-gray-300 rounded-full"})}),s.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0,WebkitOverflowScrolling:"touch"},children:s.jsx("div",{className:"py-1",children:(n==null?void 0:n.length)>0?n.map(g=>s.jsxs("button",{type:"button",onClick:()=>y(g.value),className:`
                      w-full px-4 py-3 text-left text-base hover:bg-gray-50
                      transition-colors duration-150 flex items-center justify-between
                      ${t===g.value?"bg-cyan-50 text-cyan-700":"text-gray-900"}
                    `,role:"option","aria-selected":t===g.value,children:[s.jsx("span",{className:"font-medium",children:g.label}),t===g.value&&s.jsx(dc,{className:"w-5 h-5 text-cyan-600"})]},g.value)):s.jsx("div",{className:"px-4 py-3 text-center text-gray-500 text-sm",children:" "})})}),s.jsx("div",{className:"p-4 border-t border-gray-200 bg-white",style:{flexShrink:0,paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:s.jsx("button",{type:"button",onClick:()=>u(!1),className:"w-full py-3 text-center text-gray-600 font-medium",children:""})})]})]}),document.body)]})},r3=(t,e=10,n=500)=>{if(!t||typeof t!="string")return{valid:!1,message:" ."};const r=t.trim();return r.length<e?{valid:!1,message:` ${e}  . ( ${r.length})`}:r.length>n?{valid:!1,message:` ${n}  . ( ${r.length})`}:{valid:!0}},fn={INSTALLATION:"01",REMOVAL:"02",AS:"03",SUSPENSION:"04",PRODUCT_CHANGE:"05",HOME_RELOCATION:"06",RELOCATION_INSTALL:"07",RELOCATION_REMOVAL:"08",ADDITIONAL_PRODUCT:"09",TEMP_REMOVAL:"0430",TEMP_REMOVAL_RESTORE:"0440"},Jo={INSTALL_SCHEDULED:"10",ACTIVE:"20",SUSPENDED:"30",SUSPENDED_SPECIFIC:"37",TERMINATED:"90"},Lv={RECEIVED:"1",ASSIGNED:"2"},A0=t=>t===fn.INSTALLATION,k0=t=>t===fn.AS,Qm=t=>t===fn.REMOVAL,Gm=t=>t===fn.RELOCATION_INSTALL||t===fn.RELOCATION_REMOVAL,o_=t=>t===fn.PRODUCT_CHANGE,nC=t=>t===fn.SUSPENSION,i3=(t,e)=>t===fn.SUSPENSION&&e===fn.TEMP_REMOVAL,y5=i3,a3=(t,e)=>t===fn.SUSPENSION&&e===fn.TEMP_REMOVAL_RESTORE,b5=a3,l3=(t,e)=>{if(!t||!e)return!1;switch(t){case fn.INSTALLATION:return e===Jo.INSTALL_SCHEDULED;case fn.REMOVAL:return e===Jo.ACTIVE||e===Jo.SUSPENDED||e===Jo.SUSPENDED_SPECIFIC;case fn.AS:return e!==Jo.TERMINATED;case fn.TEMP_REMOVAL:return e===Jo.ACTIVE;case fn.TEMP_REMOVAL_RESTORE:return e===Jo.SUSPENDED||e===Jo.SUSPENDED_SPECIFIC;case fn.HOME_RELOCATION:case fn.PRODUCT_CHANGE:case fn.RELOCATION_INSTALL:case fn.RELOCATION_REMOVAL:return e===Jo.ACTIVE;default:return e!==Jo.TERMINATED}},o3=(t,e)=>{if(l3(t,e))return{valid:!0};let r="       .";switch(t){case fn.INSTALLATION:r="    .";break;case fn.REMOVAL:r="      .";break;case fn.TEMP_REMOVAL:r="   .";break;case fn.TEMP_REMOVAL_RESTORE:r="   .";break;case fn.AS:r="A/S    .";break}return{valid:!1,message:r}},Nb=t=>t?t===Lv.RECEIVED||t===Lv.ASSIGNED:!1,c3=(t,e,n)=>{const r=[];return(!e||e.trim()==="")&&r.push("   ."),t.WRK_STAT_CD&&(Nb(t.WRK_STAT_CD)||r.push("       .")),e==="099Z"&&(!n||n.trim().length<10)&&r.push("      10   ."),t.WRK_CD,fn.RELOCATION_INSTALL,{valid:r.length===0,errors:r}},d3=t=>{switch(t){case fn.INSTALLATION:return" ";case fn.AS:return"A/S ";case fn.REMOVAL:return" ";case fn.RELOCATION_INSTALL:return" ";case fn.RELOCATION_REMOVAL:return" ";case fn.PRODUCT_CHANGE:return" ";case fn.SUSPENSION:case fn.TEMP_REMOVAL:return" ";case fn.TEMP_REMOVAL_RESTORE:return" ";case fn.HOME_RELOCATION:return" ";case fn.ADDITIONAL_PRODUCT:return" ";default:return" "}},wv=t=>{switch(t){case fn.INSTALLATION:return"  .";case fn.AS:return"A/S .";case fn.REMOVAL:return" .";case fn.RELOCATION_INSTALL:return" .";case fn.RELOCATION_REMOVAL:return" .";case fn.PRODUCT_CHANGE:return" .";case fn.SUSPENSION:case fn.TEMP_REMOVAL:return" .";case fn.TEMP_REMOVAL_RESTORE:return" .";case fn.HOME_RELOCATION:return" .";case fn.ADDITIONAL_PRODUCT:return" .";default:return" ."}},Mh=t=>t?["F","FG","Z","ZG"].includes(t):!1,Sb=({isOpen:t,onClose:e,onConfirm:n,workOrder:r,userId:i,showToast:l})=>{var ee;const[c,d]=x.useState("[]"),[u,f]=x.useState(new Date().toISOString().slice(0,10)),m=ae=>{if(!ae)return"";const T=ae.replace(/\D/g,"");return T.length!==10?ae:`${T.slice(0,3)}-${T.slice(3,6)}-${T.slice(6)}`},[_,y]=x.useState(""),[g,N]=x.useState({}),[C,v]=x.useState(!1),[R,U]=x.useState([]),[L,w]=x.useState("X"),[P,G]=x.useState("N"),[K,B]=x.useState(!1),[O,S]=x.useState(!1),A=["600","700","701","710","800","802","803","804"];x.useEffect(()=>{(async()=>{var T;if(console.log("[WorkCancelModal] useEffect  - isOpen:",t,"WRK_STAT_CD:",r.WRK_STAT_CD,"workOrder.id:",r.id),!!t){if(r.WRK_STAT_CD&&!Nb(r.WRK_STAT_CD)){l&&l("       .","error"),e();return}if(!r.id){console.log("[OST] workOrder.id  - ");return}B(!0);try{console.log("[OST] getWorkCancelInfo :",r.id);const j=await tx({WRK_ID:r.id,RCPT_ID:r.RCPT_ID,CUST_ID:(T=r.customer)==null?void 0:T.id});if(j){console.log("[OST] :",j),w(j.OST_WORKABLE_STAT||"X"),G(j.HOTBILL_YN||"N");const k=j.OST_WORKABLE_STAT,Q=r.WRK_CD;if(k==="0"||k==="3"||k==="4"){let H="";Q==="01"?H="    .":Q==="02"?H="    .":H="     .",l&&l(H,"error"),e();return}}}catch(j){console.error("[OST] :",j),w("X")}finally{B(!1)}}})()},[t,r.id,r.WRK_STAT_CD,r.RCPT_ID,(ee=r.customer)==null?void 0:ee.id,r.WRK_CD,l,e]),x.useEffect(()=>{t&&Y()},[t]);const Y=async()=>{try{console.log(" [] CMWO200   ");const ae=await ka("CMWO200");console.log(" [] API   :",ae[0]),console.log(" []   :",ae.length);const T=ae.filter(j=>j.code!=="[]").map(j=>({value:j.code,label:`[${j.code}] ${j.name}`,refCode:j.ref_code||"",refCode2:j.ref_code2||"",refCode12:j.ref_code12||""}));T.unshift({value:"[]",label:"( )",refCode:"",refCode2:"",refCode12:""}),U(T),console.log("[]   :",T.length,""),console.log(" []  :",T.slice(0,3))}catch(ae){console.error("[]   :",ae),U([{value:"[]",label:"( )",refCode:"",refCode2:"",refCode12:""}])}};x.useEffect(()=>{const ae={};if(c!=="[]"&&c.endsWith("Z")){const T=r3(_,10,200);T.valid||(ae.procCt=T.message||"  10  .")}N(ae)},[c,_]);const te=ae=>!ae||ae==="05"||ae==="06"||ae==="07"||ae==="09"?"01":ae==="08"?"02":ae==="03"?"03":ae,J=x.useMemo(()=>{const ae=r.WRK_CD,T=r.asReasonCode,j=r.SO_ID,k=te(ae),Q=k+"3";console.log(""),console.log("[ ]  "),console.log(""),console.log(" WRK_CD:",ae," refCode:",k," refCodeWithSuffix:",Q),console.log(" WRK_RCPT_CL:",T),console.log(" SO_ID:",j),console.log("   :",R.length);let H=R.filter($=>$.value==="[]"?(console.log("    "),!0):$.refCode!==Q?(console.log(`  [${$.value}] ${$.label}: refCode="${$.refCode}" != "${Q}"`),!1):(console.log(`  [${$.value}] ${$.label}: refCode="${$.refCode}" `),!0));return k==="03"&&(console.log("[AS ] AS    "),console.log("[AS ] WRK_RCPT_CL:",T),T==="JJ"?(console.log("[AS ] CS(JJ) - 033G "),H=H.filter($=>$.value==="033G")):T==="JH"?(console.log("[AS ] (JH) - 033H "),H=H.filter($=>$.value==="033H")):(console.log("[AS ]  AS -   "),H=H.filter($=>{if($.value==="033G")return console.log(`    [${$.value}] 033G `),!1;if($.refCode2==="Y"){const ie=A.includes(j||"");if(console.log(`     [${$.value}] refCode2='Y' (), isCallCenter=${ie}`),!ie)return console.log(`    [${$.value}]   `),!1}return $.refCode12==="JH"?(console.log(`    [${$.value}] refCode12='JH' (033H) `),!1):(console.log(`    [${$.value}] `),!0)}))),console.log(""),console.log("[ ]  :",H.length,""),console.log(""),H},[r.WRK_CD,r.asReasonCode,r.SO_ID,R]),q=ae=>{const T=ae.type,j=ae.typeDisplay;return T===aa.Installation||T==="Installation"||T===""||j===""?"01":T===aa.AS||T==="AS"||T==="A/S"||j==="A/S"?"02":T===aa.Move||T==="Move"||T===""||j===""?"03":T===aa.Change||T==="Change"||T===""||j===""?"04":"05"},V=async()=>{S(!1),await F()},F=async()=>{var k;v(!0);const ae=r.WRK_CD||"";if(console.log("[] OST_WORKABLE_STAT:",L,"WRK_CD:",ae),(L==="1"||L==="2")&&(ae==="01"||ae==="02")){console.log("[] OST   ");try{const Q=await d4({RCPT_ID:r.RCPT_ID||"",CUST_ID:((k=r.customer)==null?void 0:k.id)||"",AGENT_FL:"1"});if(Q){const H=(Q.AGENT_FL||"")+(Q.BUSI_TYPE||"")+(Q.RES_CD||"");if(console.log("[] OST_BUSI:",H),H==="10310BS0000"||H==="10320BS0000"){console.log("[] modOstWorkCancel API ");const $=await u4({RCPT_ID:r.RCPT_ID||"",WRK_CD:ae,UNPROC_RESN_CD:c,WRK_STAT_CD:"3",PROC_CT:_||"",REG_UID:i||""});$.code==="SUCCESS"||$.message==="SUCCESS"?(l&&l(" .","success"),e()):l&&l($.message||"  .","error"),v(!1);return}}}catch(Q){console.error("[] OST  :",Q),l&&l("OST    .","error"),v(!1);return}}const T=q(r),j={WRK_ID:r.id,WRK_STAT_CD:"3",UNPROC_RESN_CD:c,CALL_CNTN_DATE:u.replace(/-/g,""),CHG_UID:i||"",REG_UID:i||"",PROC_CT:_||"",RCPT_ID:r.RCPT_ID||"",WRK_CD:T};console.log("  :",j),n(j),v(!1)},I=async ae=>{if(ae.preventDefault(),C)return;const T=c3(r,c,_);if(!T.valid){const k=T.errors.join(`
`);l&&l(k,"error",!0);return}if(c!=="[]"&&c.endsWith("Z")&&_.trim().length<10){l&&l("      10  .","error");return}if(!i){l&&l(" () .  .","error");return}if((r.WRK_CD||"")==="07"&&P==="Y"){S(!0);return}await F()};return t?s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-[9999]",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto mx-2 sm:mx-0",children:[s.jsx("div",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-4 sm:p-6 rounded-t-2xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg sm:text-xl font-bold",children:" "}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-white/20 rounded-lg transition-colors",children:s.jsx(bi,{className:"w-5 h-5"})})]})}),s.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-3 text-sm sm:text-base",children:"  "}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:":"}),s.jsx("span",{className:"text-sm font-medium",children:r.customer.name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:" :"}),s.jsx("span",{className:"text-sm font-medium",children:r.typeDisplay})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:" ID:"}),s.jsx("span",{className:"text-sm font-mono",children:m(r.id)})]})]})]}),s.jsxs("form",{onSubmit:I,className:"p-4 sm:p-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:c,onValueChange:d,options:J,placeholder:"",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:u,onChange:ae=>f(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-cyan-500 focus:border-cyan-500 opacity-0 absolute inset-0 cursor-pointer",required:!0}),s.jsx("div",{className:"w-full p-3 border border-gray-300 rounded-lg bg-white text-gray-900",children:u||"YYYY-MM-DD"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[" ",c!=="[]"&&c.endsWith("Z")&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:_,onChange:ae=>y(ae.target.value),placeholder:c!=="[]"&&c.endsWith("Z")?"      10  ":"     ",className:`w-full p-3 border rounded-lg focus:ring-cyan-500 focus:border-cyan-500 min-h-[80px] resize-y ${g.procCt?"border-red-500":"border-gray-300"}`,maxLength:200,required:c!=="[]"&&c.endsWith("Z")}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[_.length,"/200"]}),c!=="[]"&&c.endsWith("Z")&&s.jsx("p",{className:"text-xs text-blue-600",children:"( 10 )"})]}),g.procCt&&s.jsx("p",{className:"text-xs text-red-500 mt-1",children:g.procCt})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:""}),s.jsx("button",{type:"submit",disabled:C||K||c&&c.endsWith("Z")&&_.trim().length<10,className:`flex-1 px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-lg font-semibold transition-all duration-200 ${C||K||c&&c.endsWith("Z")&&_.trim().length<10?"opacity-50 cursor-not-allowed":""}`,children:K?"...":C?"...":"  "})]})]})]}),O&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-[10000]",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 mx-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center",children:s.jsx(ql,{className:"w-6 h-6 text-amber-600"})}),s.jsx("h4",{className:"text-lg font-bold text-gray-800",children:" "})]}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2 mb-6",children:[s.jsxs("p",{children:["   ",s.jsx("strong",{className:"text-amber-700",children:" "}),"."]}),s.jsx("p",{className:"text-gray-600",children:"    CONA       ."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:()=>S(!1),className:"flex-1 px-4 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors",children:""}),s.jsx("button",{type:"button",onClick:V,className:"flex-1 px-4 py-2.5 bg-amber-500 hover:bg-amber-600 text-white rounded-lg font-medium transition-colors",children:"  "})]})]})})]}):null},u3=t=>{const e=t.toLowerCase();return e.includes("a/s")||e.includes("as")||e.includes("")||e.includes("")?pu:e.includes("")&&(e.includes("")||e.includes(""))?uw:e.includes("")||e.includes("")||e.includes("")?sL:e.includes("")||e.includes("")?UL:e.includes("")||e.includes("")||e.includes("wifi")||e.includes("")?v_:e.includes("tv")||e.includes("")||e.includes("")?Lw:e.includes("")||e.includes("phone")?by:e.includes("")||e.includes("")||e.includes("")?ZL:e.includes("")||e.includes("")||e.includes("")?uL:e.includes("")||e.includes("")||e.includes("")?gw:_b},h3=t=>{const e=t.toLowerCase();return e.includes("")||e.includes("")&&e.includes("")?"text-emerald-500":e.includes("a/s")||e.includes("as")||e.includes("")||e.includes("")?"text-orange-500":e.includes("")||e.includes("")?"text-red-500":e.includes("")||e.includes("")||e.includes("")?"text-blue-500":e.includes("")||e.includes("")?"text-purple-500":e.includes("")||e.includes("")?"text-gray-500":e.includes("")?"text-blue-500":e.includes("")||e.includes("")||e.includes("wifi")||e.includes("")?"text-cyan-500":e.includes("tv")||e.includes("")||e.includes("")?"text-indigo-500":e.includes("")||e.includes("phone")?"text-pink-500":"text-gray-500"},rC=({label:t,value:e,children:n})=>s.jsx("div",{className:"py-2 sm:py-3 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 hover:bg-gray-50/50 transition-colors duration-150 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[s.jsx("dt",{className:"text-xs sm:text-sm font-medium text-gray-600 flex items-center",children:t}),s.jsx("dd",{className:"sm:col-span-2 flex items-center text-sm sm:text-base text-gray-900 mt-0.5 sm:mt-0",children:n||e||"-"})]})}),f3=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-orange-800 mb-2 flex items-center",children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-orange-500 rounded-full mr-2"}),"A/S  "]}),s.jsxs("div",{className:"space-y-1 text-sm text-orange-700",children:[s.jsx(rC,{label:"A/S ",value:t.WRK_DTL_TCD||"AS "}),s.jsx(rC,{label:" ID",value:t.CTRT_ID}),s.jsx(rC,{label:" ID",value:t.RCPT_ID})]})]}),t.asHistory&&t.asHistory.length>0&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})," A/S "]}),s.jsx("div",{className:"space-y-2",children:t.asHistory.map((e,n)=>s.jsxs("div",{className:"border-l-2 border-blue-300 pl-3 py-2 hover:bg-blue-50 transition-colors rounded",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-gray-700",children:e.asDate}),s.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full",children:e.asResult})]}),s.jsx("div",{className:"text-sm text-gray-600",children:e.asReason}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[": ",e.asWorker]})]},n))})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-blue-800 mb-2",children:" A/S      "}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"/    "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"A/S      "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"   "})]})]})]})]}),Ep=({label:t,value:e,children:n})=>s.jsx("div",{className:"py-2 sm:py-3 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 hover:bg-gray-50/50 transition-colors duration-150 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[s.jsx("dt",{className:"text-xs sm:text-sm font-medium text-gray-600 flex items-center",children:t}),s.jsx("dd",{className:"sm:col-span-2 flex items-center text-sm sm:text-base text-gray-900 mt-0.5 sm:mt-0",children:n||e||"-"})]})}),m3=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-green-800 mb-2 flex items-center",children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full mr-2"}),"  "]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Ep,{label:"",value:t.productName||" "}),s.jsx(Ep,{label:" ",value:t.installLocation||t.customer.address}),s.jsx(Ep,{label:" ID",value:t.CTRT_ID}),s.jsx(Ep,{label:" ID",value:t.RCPT_ID})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})," "]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"    "})]})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-green-800 mb-2",children:"       "}),s.jsxs("ul",{className:"text-xs text-green-700 space-y-1",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     (,  )"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"    ()"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"  "})]})]})]})]}),jp=({label:t,value:e,children:n})=>s.jsx("div",{className:"py-2 sm:py-3 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 hover:bg-gray-50/50 transition-colors duration-150 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[s.jsx("dt",{className:"text-xs sm:text-sm font-medium text-gray-600 flex items-center",children:t}),s.jsx("dd",{className:"sm:col-span-2 flex items-center text-sm sm:text-base text-gray-900 mt-0.5 sm:mt-0",children:n||e||"-"})]})}),g3=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-red-800 mb-2 flex items-center",children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-red-500 rounded-full mr-2"}),"  "]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(jp,{label:"() ",value:t.termReasonCode||" "}),s.jsx(jp,{label:"",value:t.termFee?`${t.termFee.toLocaleString()}`:""}),s.jsx(jp,{label:" ID",value:t.CTRT_ID}),s.jsx(jp,{label:" ID",value:t.RCPT_ID})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),"  "]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"   "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"   "})]})]})]}),s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-red-800 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:14}),"      "]}),s.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     (,  )"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"()      "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"   "})]})]})]}),t.termFee&&t.termFee>0&&s.jsxs("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-yellow-800 mb-2 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"  "]}),s.jsxs("p",{className:"text-xs text-yellow-700",children:[" ",s.jsxs("strong",{className:"text-yellow-900",children:[t.termFee.toLocaleString(),""]})," .       ."]})]})]}),Bl=({label:t,value:e,highlight:n})=>s.jsxs("div",{className:`flex py-2 border-b border-gray-100 ${n?"bg-yellow-50":""}`,children:[s.jsx("div",{className:"w-1/3 text-xs sm:text-sm font-medium text-gray-700",children:t}),s.jsx("div",{className:"w-2/3 text-xs sm:text-sm text-gray-900",children:e||"-"})]}),p3=({order:t})=>{const e=y5(t.WRK_CD,t.WRK_DTL_TCD),n=b5(t.WRK_CD,t.WRK_DTL_TCD);return s.jsxs("div",{className:"space-y-4",children:[e&&s.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-orange-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-orange-100 divide-y divide-gray-100",children:[s.jsx(Bl,{label:" ",value:t.mmtSusCd||"",highlight:!t.mmtSusCd}),s.jsx(Bl,{label:" ",value:t.susHopeDd?Ip(t.susHopeDd):"",highlight:!t.susHopeDd}),s.jsx(Bl,{label:" ",value:t.mmtSusHopeDd?Ip(t.mmtSusHopeDd):"",highlight:!t.mmtSusHopeDd}),s.jsx(Bl,{label:" ",value:t.susProcYn==="Y"?"":""}),t.termDays&&s.jsx(Bl,{label:"  ",value:`${t.termDays}`}),t.mmtCnt&&s.jsx(Bl,{label:"   ",value:`${t.mmtCnt}`})]}),s.jsxs("div",{className:"mt-3 bg-orange-100 border border-orange-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-orange-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[s.jsx("li",{children:"    (MMT_SUS_CD)"}),s.jsx("li",{children:"   (SUS_HOPE_DD)"}),s.jsx("li",{children:"   (MMT_SUS_HOPE_DD)"}),s.jsx("li",{children:"    (SUS_PROC_YN)"})]})]}),s.jsxs("div",{className:"mt-3 bg-white border border-orange-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:14}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600",children:["   ",s.jsx("span",{className:"font-semibold text-orange-600",children:"'20'()"}),"  ."]}),s.jsxs("div",{className:"mt-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="20"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="20"?s.jsx(N_,{size:14}):s.jsx(S_,{size:14})]})]})]})]}),n&&s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[s.jsx(cw,{size:16}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-blue-100 divide-y divide-gray-100",children:[s.jsx(Bl,{label:" ",value:t.mmtSusCd||""}),s.jsx(Bl,{label:" ",value:t.susHopeDd?Ip(t.susHopeDd):""}),s.jsx(Bl,{label:" ",value:t.mmtSusHopeDd?Ip(t.mmtSusHopeDd):""}),t.termDays&&s.jsx(Bl,{label:"  ",value:`${t.termDays}`})]}),s.jsxs("div",{className:"mt-3 bg-blue-100 border border-blue-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-blue-800 mb-2 flex items-center gap-1",children:[s.jsx(gb,{size:14}),"  "]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsx("li",{children:"  "}),s.jsx("li",{children:"  "}),s.jsx("li",{children:"   "})]})]}),s.jsxs("div",{className:"mt-3 bg-white border border-blue-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:14}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600",children:["    ",s.jsx("span",{className:"font-semibold text-blue-600",children:"'30'()"})," "," ",s.jsx("span",{className:"font-semibold text-blue-600",children:"'37'(-)"}),"  ."]}),s.jsxs("div",{className:"mt-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="30"||t.CTRT_STAT==="37"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="30"||t.CTRT_STAT==="37"?s.jsx(N_,{size:14}):s.jsx(S_,{size:14})]})]})]})]}),t.WRK_CD==="06"&&s.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-100 divide-y divide-gray-100",children:[s.jsx(Bl,{label:" ",value:t.WRK_DTL_TCD==="0610"?"":t.WRK_DTL_TCD==="0620"?"":t.WRK_DTL_TCD||""}),s.jsx(Bl,{label:" ",value:t.details||""})]}),s.jsxs("div",{className:"mt-3 bg-gray-100 border border-gray-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0610 ()"}),":    "]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0620 ()"}),":     "]})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"  "}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-2",children:[e&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"1."}),s.jsx("span",{children:"     ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"2."}),s.jsx("span",{children:" (~)   ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"3."}),s.jsx("span",{children:"  '(20)' ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"4."}),s.jsx("span",{children:"        ."})]})]}),n&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"1."}),s.jsx("span",{children:"    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"2."}),s.jsx("span",{children:"    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"3."}),s.jsx("span",{children:"     ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"4."}),s.jsx("span",{children:"     ."})]})]})]})]})]})},Ip=t=>!t||t.length!==8?t:`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`,Sm=({label:t,value:e,highlight:n})=>s.jsxs("div",{className:`flex py-2 border-b border-gray-100 ${n?"bg-yellow-50":""}`,children:[s.jsx("div",{className:"w-1/3 text-xs sm:text-sm font-medium text-gray-700",children:t}),s.jsx("div",{className:"w-2/3 text-xs sm:text-sm text-gray-900",children:e||"-"})]}),_3=({order:t})=>{const n=(r=>{switch(r){case"0510":case"0520":return" ";case"0550":case"0560":return" ";default:return" "}})(t.WRK_DTL_TCD);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[s.jsx(uc,{size:16})," "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-purple-100 divide-y divide-gray-100",children:[s.jsx(Sm,{label:" ",value:n}),s.jsx(Sm,{label:"  ",value:t.WRK_DTL_TCD||""}),s.jsx(Sm,{label:" ",value:t.currentProduct||t.productName||"",highlight:!t.currentProduct&&!t.productName}),s.jsx(Sm,{label:" ",value:t.newProduct||"",highlight:!t.newProduct}),s.jsx(Sm,{label:"",value:t.productName||""})]}),s.jsxs("div",{className:"mt-3 bg-purple-100 border border-purple-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-purple-800 mb-2 flex items-center gap-1",children:[s.jsx(gb,{size:14}),"   "]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0510"}),":   (  )"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0520"}),":    ",s.jsx("span",{className:"text-red-600",children:"0510  "})]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0550"}),":   ( )"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0560"}),":  2  ",s.jsx("span",{className:"text-red-600",children:"0550  "})]})]})]}),s.jsxs("div",{className:"mt-3 bg-white border border-purple-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-purple-800 mb-2 flex items-center gap-1",children:[s.jsx(Vi,{size:14}),"  "]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[s.jsx("li",{children:"    (BASIC_PROD_CD)"}),s.jsx("li",{children:"    (NEW_PROD_CD)"}),s.jsx("li",{children:"  "}),s.jsx("li",{children:"   "})]})]})]}),(t.WRK_DTL_TCD==="0510"||t.WRK_DTL_TCD==="0520")&&s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-green-100 p-3",children:[s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[" / ,  ",s.jsx("span",{className:"font-semibold text-green-600",children:"'01'()"}),"    'Y'    ."]}),s.jsx("div",{className:"mt-2 bg-green-50 border border-green-200 rounded p-2",children:s.jsx("p",{className:"text-xs font-semibold text-green-700",children:"SQL : WRK_CD IN ('01','05','07') AND PYM_MTHD = '01' AND ATMT_YN = 'Y'"})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-3",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"      ."}),s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-700",children:" :"}),s.jsxs("ul",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[s.jsx("li",{children:" WRK_CD IN ('01','05','07','09')"}),s.jsx("li",{children:" PROD_CMPS_CL = '21' ()"})]})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"  "}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-2",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"1."}),s.jsx("span",{children:"     ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"2."}),s.jsx("span",{children:"       ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"3."}),s.jsx("span",{children:"       ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"4."}),s.jsx("span",{children:"   ,    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"5."}),s.jsx("span",{children:"    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"6."}),s.jsx("span",{children:"     ."})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:16,className:"text-gray-600"}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["   ",s.jsx("span",{className:"font-semibold text-purple-600",children:"'20'()"}),"   ."]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="20"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="20"?s.jsx(N_,{size:14}):s.jsx(S_,{size:14})]})]})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-yellow-800 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:16}),""]}),s.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[s.jsx("li",{children:"    0520 0560   "}),s.jsx("li",{children:"      ,     "}),s.jsx("li",{children:"        "}),s.jsx("li",{children:"           "})]})]})]})},Op=({label:t,value:e,highlight:n})=>s.jsxs("div",{className:`flex py-2 border-b border-gray-100 ${n?"bg-yellow-50":""}`,children:[s.jsx("div",{className:"w-1/3 text-xs sm:text-sm font-medium text-gray-700",children:t}),s.jsx("div",{className:"w-2/3 text-xs sm:text-sm text-gray-900",children:e||"-"})]}),x3=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-teal-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-teal-100 divide-y divide-gray-100",children:[s.jsx(Op,{label:"  ",value:t.customer.address}),s.jsx(Op,{label:"  ",value:t.installLocation||"",highlight:!t.installLocation}),s.jsx(Op,{label:"",value:t.productName||""}),s.jsx(Op,{label:" ID",value:t.CTRT_ID||""})]}),s.jsxs("div",{className:"mt-3 bg-teal-100 border border-teal-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-teal-800 mb-2 flex items-center gap-1",children:[s.jsx(Vi,{size:14}),"  "]}),s.jsxs("ul",{className:"text-xs text-teal-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"  "}),s.jsx("li",{children:"   "})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[s.jsx(yf,{size:16})," "]}),t.assignedEquipment&&t.assignedEquipment.length>0?s.jsx("div",{className:"space-y-2",children:t.assignedEquipment.map((e,n)=>s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:":"}),s.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:e.type})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:":"}),s.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:e.model})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-600",children:":"}),s.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:e.serialNumber})]})]})},e.id||n))}):s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-xs text-yellow-700 flex items-center gap-1",children:[s.jsx(ql,{size:14}),"   ."]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[s.jsx(yu,{size:16}),"  "]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-2",children:"1"}),s.jsx("h5",{className:"text-xs font-semibold text-blue-800",children:"  "})]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1 ml-8",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("span",{className:"bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-2",children:"2"}),s.jsx("h5",{className:"text-xs font-semibold text-green-800",children:"  "})]}),s.jsxs("ul",{className:"text-xs text-green-700 space-y-1 ml-8",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"   "}),s.jsx("li",{children:"    "})]})]}),s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("span",{className:"bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-2",children:"3"}),s.jsx("h5",{className:"text-xs font-semibold text-purple-800",children:" "})]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1 ml-8",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"      "}),s.jsx("li",{children:"    "})]})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-green-100 p-3",children:[s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["  ,  ",s.jsx("span",{className:"font-semibold text-green-600",children:"'01'()"}),"    'Y'    ."]}),s.jsx("div",{className:"mt-2 bg-green-50 border border-green-200 rounded p-2",children:s.jsx("p",{className:"text-xs font-semibold text-green-700",children:"SQL : WRK_CD IN ('01','05','07') AND PYM_MTHD = '01' AND ATMT_YN = 'Y'"})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-3",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-2",children:" (WRK_CD='07')      :"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"()"})," WRK_CD='07':      "]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"()"})," WRK_CD='08':    "]})]}),s.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded",children:s.jsx("p",{className:"text-xs text-blue-700",children:"         ."})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:16,className:"text-gray-600"}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["    ",s.jsx("span",{className:"font-semibold text-teal-600",children:"'20'()"}),"   ."]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="20"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="20"?s.jsx(N_,{size:14}):s.jsx(S_,{size:14})]})]})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-yellow-800 mb-2 flex items-center gap-1",children:[s.jsx(ql,{size:16}),""]}),s.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"       "}),s.jsx("li",{children:"      "}),s.jsx("li",{children:"       "}),s.jsx("li",{children:"      "})]})]})]}),Ma=({label:t,value:e,children:n,icon:r})=>s.jsxs("div",{className:"bg-gray-50 rounded-md px-3 py-2 flex items-center justify-between gap-3",children:[s.jsxs("dt",{className:"flex items-center gap-1.5 text-xs text-gray-700 font-semibold flex-shrink-0",children:[r&&s.jsx("span",{className:"text-gray-500",children:r}),t]}),s.jsx("dd",{className:"text-sm text-black font-semibold text-right break-words",children:n||e})]}),N5=({order:t,onBack:e,onUpdateStatus:n,onComplete:r,onStartWorkProcess:i,showToast:l})=>{const c=t.WRK_STAT_CD==="4"||t.status===hn.Completed||t.status==="",[d,u]=x.useState("info"),[f,m]=x.useState(!1),[_,y]=x.useState(!1),g=c;x.useEffect(()=>{(async()=>{var P;try{const G=localStorage.getItem("userInfo");if(!G)return;const K=JSON.parse(G),B={WRKR_ID:K.userId||K.workerId||"",SO_ID:t.SO_ID||K.soId,WORK_ID:t.id,CUST_ID:(P=t.customer)==null?void 0:P.id,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};await to(B)}catch{}})()},[t.id]);const N=()=>{if(t.WRK_CD&&t.CTRT_STAT){const w=o3(t.WRK_CD,t.CTRT_STAT);if(!w.valid){l&&l(w.message||"   .","error",!0);return}}i?i(t):r&&r(t)},C=()=>{if(t.WRK_STAT_CD&&!Nb(t.WRK_STAT_CD)){l&&l("       .","warning");return}y(!0)},v=async w=>{m(!0),y(!1);try{const P=await yb(w);P.code==="SUCCESS"||P.code==="OK"?(l&&l("  .","success"),n&&n(t.id,hn.Cancelled)):l&&l(` : ${P.message}`,"error",!0)}catch(P){l&&l(P.message||"   .","error",!0),console.error(" :",P)}finally{m(!1)}},R=({tabId:w,title:P,icon:G})=>{const K=c,B=d===w;return s.jsxs("button",{onClick:()=>u(w),className:`relative px-4 sm:px-6 py-3 sm:py-3.5 text-sm sm:text-base font-semibold transition-all duration-200 flex items-center gap-2 ${B?"text-blue-600 bg-blue-50":c?"text-green-600 bg-green-50 hover:text-green-700 hover:bg-green-100":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[K?s.jsx("svg",{className:`w-5 h-5 ${B?"text-blue-600":"text-green-600"}`,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):G,P,B&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 rounded-t-lg bg-blue-600"})]})},U=u3(t.typeDisplay);h3(t.typeDisplay);const L=w=>w?A0(w)?"bg-green-600":k0(w)?"bg-orange-500":Qm(w)?"bg-red-600":Gm(w)?"bg-blue-600":o_(w)?"bg-purple-600":nC(w)?"bg-gray-600":"bg-blue-500":"bg-blue-500";return s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"pb-40",style:{minHeight:"calc(100vh - 80px)"},children:[s.jsxs("div",{className:"bg-white overflow-hidden",children:[s.jsxs("div",{className:"bg-blue-600 px-4 py-4 text-white",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:s.jsx(U,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsx("h1",{className:"text-xl font-bold text-white truncate",children:t.customer.name}),t.customer.isVip&&s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-bold bg-yellow-400 text-yellow-900 flex-shrink-0",children:t.customer.vipLevel||"VIP"})]})]}),s.jsx("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-bold flex-shrink-0 ${t.status===""?"bg-yellow-400 text-yellow-900":t.status===""?"bg-green-400 text-green-900":"bg-red-400 text-red-900"}`,children:t.status})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-md font-semibold bg-white/20 border border-white/30",children:t.typeDisplay}),s.jsxs("div",{className:"text-right flex items-center gap-1.5",children:[s.jsx(tC,{className:"w-4 h-4 text-white/80"}),s.jsx("span",{className:"font-semibold",children:D_(t.scheduledAt)})]})]})]}),s.jsx("div",{className:"border-b-2 border-gray-200 bg-white shadow-sm",children:s.jsxs("div",{className:"flex overflow-x-auto",children:[s.jsx(R,{tabId:"info",title:"/ ",icon:s.jsx(yv,{className:"w-5 h-5"})}),s.jsx(R,{tabId:"equipment",title:" ",icon:s.jsx(eC,{className:"w-5 h-5"})}),s.jsx(R,{tabId:"workflow",title:" ",icon:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})}),s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 pb-28",children:[d==="info"&&s.jsxs("div",{className:"space-y-4",children:[t.WRK_CD&&s.jsx("div",{className:`${L(t.WRK_CD)} rounded-lg p-4`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:s.jsx(Fd,{className:"w-5 h-5 text-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-sm font-semibold text-white leading-relaxed",children:wv(t.WRK_CD)})})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"})," "]}),s.jsx(Ma,{label:"ID",value:Qi(t.directionId||t.id),icon:s.jsx(Fd,{className:"w-4 h-4"})}),s.jsx(Ma,{label:"ID",value:Qi(t.id),icon:s.jsx(Fd,{className:"w-4 h-4"})}),s.jsx(Ma,{label:"ID",value:Qi(t.RCPT_ID),icon:s.jsx(Fd,{className:"w-4 h-4"})}),s.jsx(Ma,{label:" ",value:t.typeDisplay,icon:s.jsx(U,{className:"w-4 h-4"})}),t.WRK_CD&&s.jsx(Ma,{label:" ",icon:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M10 2a1 1 0 011 1v1.323l3.954 1.582 1.599-.8a1 1 0 01.894 1.79l-1.233.616 1.738 5.42a1 1 0 01-.285 1.05A3.989 3.989 0 0115 15a3.989 3.989 0 01-2.667-1.019 1 1 0 01-.285-1.05l1.738-5.42-1.233-.617a1 1 0 01.894-1.788l1.599.799L11 4.323V3a1 1 0 011-1h-2zm-5 8.274l-.818 2.552c-.25.78.409 1.565 1.237 1.474L9 13.796l3.581.504c.828.091 1.487-.694 1.237-1.474l-.818-2.552-3-1.2-3 1.2z"})}),children:s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-bold ${A0(t.WRK_CD)?"bg-red-100 text-red-800":k0(t.WRK_CD)?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:A0(t.WRK_CD)?" ()":k0(t.WRK_CD)?" (A/S)":""})}),t.CTRT_STAT&&s.jsx(Ma,{label:" ",icon:s.jsx(Fd,{className:"w-4 h-4"}),children:s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-bold ${t.CTRT_STAT==="20"?"bg-green-100 text-green-800":t.CTRT_STAT==="10"?"bg-blue-100 text-blue-800":t.CTRT_STAT==="30"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.CTRT_STAT==="20"?"":t.CTRT_STAT==="10"?"":t.CTRT_STAT==="30"?"":t.CTRT_STAT==="90"?"":`: ${t.CTRT_STAT}`})}),t.CTRT_ID&&s.jsx(Ma,{label:"ID",value:Qi(t.CTRT_ID),icon:s.jsx(Fd,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-3 mt-6",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"})," "]}),s.jsx(Ma,{label:"",value:t.customer.name,icon:s.jsx(yv,{className:"w-4 h-4"})}),s.jsx(Ma,{label:"",icon:s.jsx(Cv,{className:"w-4 h-4"}),children:s.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between gap-2 xs:gap-2 w-full",children:[s.jsx("span",{className:"text-gray-900 font-medium flex-1 min-w-0 break-all",children:t.customer.phone||" "}),s.jsxs("button",{onClick:()=>{l&&l("   .","info")},className:"flex-shrink-0 w-full xs:w-9 py-2 xs:py-0 xs:h-9 rounded-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 flex items-center justify-center gap-1.5",disabled:!t.customer.phone,children:[s.jsx(Cv,{className:"h-4 w-4 text-white"}),s.jsx("span",{className:"xs:hidden text-white text-sm font-medium",children:" "})]})]})}),s.jsx(Ma,{label:" ",icon:s.jsx(Z1,{className:"w-4 h-4"}),children:s.jsxs("div",{className:"flex flex-col xs:flex-row items-start justify-between gap-2 xs:gap-2 w-full",children:[s.jsx("span",{className:"text-gray-900 flex-1 min-w-0 leading-relaxed break-all",children:t.customer.address}),s.jsxs("button",{onClick:()=>{l&&l("    .","info")},className:"flex-shrink-0 w-full xs:w-9 py-2 xs:py-0 xs:h-9 rounded-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95 xs:mt-0.5 flex items-center justify-center gap-1.5",children:[s.jsx(Z1,{className:"h-4 w-4 text-white"}),s.jsx("span",{className:"xs:hidden text-white text-sm font-medium",children:" "})]})]})}),t.installLocation&&s.jsx(Ma,{label:"  ",value:t.installLocation,icon:s.jsx(Z1,{className:"w-4 h-4"})}),t.cellNo&&s.jsx(Ma,{label:"CELL NO",value:t.cellNo,icon:s.jsx(Fd,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-3 mt-6",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"})," "]}),s.jsx(Ma,{label:" ",value:D_(t.scheduledAt),icon:s.jsx(tC,{className:"w-4 h-4"})}),s.jsx(Ma,{label:"",value:zw(t.scheduledAt),icon:s.jsx(tC,{className:"w-4 h-4"})}),s.jsx(Ma,{label:" ",icon:s.jsx(Fd,{className:"w-4 h-4"}),children:s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border-l-4 border-blue-600 w-full",children:s.jsx("p",{className:"text-gray-800 whitespace-pre-wrap leading-relaxed",children:t.details})})})]}),(k0(t.WRK_CD)||A0(t.WRK_CD)||Qm(t.WRK_CD)||nC(t.WRK_CD)||o_(t.WRK_CD)||Gm(t.WRK_CD))&&s.jsxs("div",{className:"mt-6 pt-6 border-t-2 border-gray-200",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-6 bg-blue-600 rounded-full"}),"  "]}),k0(t.WRK_CD)&&s.jsx(f3,{order:t}),A0(t.WRK_CD)&&s.jsx(m3,{order:t}),Qm(t.WRK_CD)&&s.jsx(g3,{order:t}),nC(t.WRK_CD)&&s.jsx(p3,{order:t}),o_(t.WRK_CD)&&s.jsx(_3,{order:t}),Gm(t.WRK_CD)&&s.jsx(x3,{order:t})]}),t.status===hn.Pending&&s.jsx("div",{className:"mt-8 pt-6 border-t-2 border-gray-200",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-600 p-5 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:" ?"}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mb-3",children:wv(t.WRK_CD)}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 text-xs text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"  "})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:" /"})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:" "})]})]})]})]})})})]}),d==="equipment"&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-4 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"}),"  "]}),t.assignedEquipment.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.assignedEquipment.map(w=>{const G=(K=>K==="04"?{color:"bg-blue-600",label:"",status:""}:K==="05"?{color:"bg-purple-600",label:"",status:""}:K==="07"?{color:"bg-orange-500",label:"",status:""}:K==="03"?{color:"bg-green-600",label:"",status:""}:{color:"bg-gray-600",label:"",status:""})(w.itemMidCd);return s.jsx("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-200 p-4 border border-gray-200 hover:border-blue-300",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-lg ${G.color} flex items-center justify-center`,children:s.jsx(eC,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("p",{className:"font-bold text-gray-800 text-base",children:w.type}),s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-green-100 text-green-800 flex-shrink-0",children:G.status})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:w.model}),s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[s.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:["S/N: ",w.serialNumber]}),w.itemMidCd&&s.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[": ",G.label]})]})]})]})},w.id)})})}):s.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[s.jsx(eC,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"  ."}),s.jsx("p",{className:"text-gray-400 text-xs mt-2",children:"    ."})]})]}),d==="workflow"&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"}),"  "]}),s.jsxs("div",{className:"mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("p",{className:"text-sm font-bold text-gray-800",children:" "}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:c?"100%":g&&t.assignedEquipment.length>0?"50%":g?"25%":"0%"})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 h-2.5 rounded-full transition-all duration-500 shadow-sm",style:{width:`${c?100:g&&t.assignedEquipment.length>0?50:g?25:0}%`}})}),s.jsx("p",{className:"text-xs text-gray-600 mt-1.5",children:c?"  ":g&&t.assignedEquipment.length>0?"   ":g?" ":" "})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${g?"bg-green-50 border-green-500 shadow-sm":!g&&!t.assignedEquipment.length&&t.status!==hn.Completed?"bg-blue-50 border-blue-500 shadow-md ring-2 ring-blue-200":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${g?"bg-green-500":!g&&!t.assignedEquipment.length&&t.status!==hn.Completed?"bg-blue-500 animate-pulse":"bg-gray-400"}`,children:g?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"1"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${g?"text-green-800":!g&&!t.assignedEquipment.length&&t.status!==hn.Completed?"text-blue-800":"text-gray-700"}`,children:""}),g?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):!g&&!t.assignedEquipment.length&&t.status!==hn.Completed?s.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full animate-pulse",children:" "}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:g?" .":"   ."})]})]})}),s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${c||t.assignedEquipment.length>0?"bg-green-50 border-green-500 shadow-sm":g&&!t.assignedEquipment.length&&t.status!==hn.Completed?"bg-blue-50 border-blue-500 shadow-md ring-2 ring-blue-200":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${c||t.assignedEquipment.length>0?"bg-green-500":g&&!t.assignedEquipment.length&&t.status!==hn.Completed?"bg-blue-500 animate-pulse":"bg-gray-400"}`,children:c||t.assignedEquipment.length>0?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"2"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${c||t.assignedEquipment.length>0?"text-green-800":g&&!t.assignedEquipment.length&&t.status!==hn.Completed?"text-blue-800":"text-gray-700"}`,children:" "}),c||t.assignedEquipment.length>0?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):g&&!t.assignedEquipment.length&&t.status!==hn.Completed?s.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full animate-pulse",children:" "}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:t.assignedEquipment.length>0?`${t.assignedEquipment.length}  .`:"  ."})]})]})}),s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${c?"bg-green-50 border-green-500 shadow-sm":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${c?"bg-green-500":"bg-gray-400"}`,children:c?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"3"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${c?"text-green-800":"text-gray-700"}`,children:" /  "}),c?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"LGU      ()"})]})]})}),s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${c?"bg-green-50 border-green-500 shadow-sm":g&&t.assignedEquipment.length>0&&t.status!==hn.Completed?"bg-blue-50 border-blue-500 shadow-md ring-2 ring-blue-200":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${c?"bg-green-500":g&&t.assignedEquipment.length>0&&t.status!==hn.Completed?"bg-blue-500 animate-pulse":"bg-gray-400"}`,children:c?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${c?"text-green-800":g&&t.assignedEquipment.length>0&&t.status!==hn.Completed?"text-blue-800":"text-gray-700"}`,children:"  "}),c?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):g&&t.assignedEquipment.length>0&&t.status!==hn.Completed?s.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full animate-pulse",children:" "}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:c?"  .":"      ."})]})]})})]})]})]})]}),s.jsx(Sb,{isOpen:_,onClose:()=>y(!1),onConfirm:v,workOrder:t,showToast:l})]}),t.status===hn.Pending&&s.jsx("div",{className:"bg-white border-t border-gray-200 shadow-2xl mt-4",children:s.jsx("div",{className:"max-w-4xl mx-auto px-3 py-2",children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsxs("button",{onClick:C,disabled:f,className:"flex-shrink-0 w-24 px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-xl font-bold transition-all duration-200 flex flex-col items-center justify-center gap-0.5 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-xs font-bold",children:f?"":""})]}),s.jsxs("button",{onClick:N,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-bold transition-all duration-200 flex items-center justify-center gap-2 shadow-lg hover:shadow-xl active:scale-[0.98]",children:[s.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})}),s.jsxs("div",{className:"flex flex-col items-start",children:[s.jsx("span",{className:"text-base leading-tight font-bold",children:""}),s.jsx("span",{className:"text-[0.625rem] opacity-90 leading-tight",children:t.typeDisplay})]})]})]})})})]})},Pv=t=>{let e;const n=new Set,r=(f,m)=>{const _=typeof f=="function"?f(e):f;if(!Object.is(_,e)){const y=e;e=m??(typeof _!="object"||_===null)?_:Object.assign({},e,_),n.forEach(g=>g(e,y))}},i=()=>e,d={setState:r,getState:i,getInitialState:()=>u,subscribe:f=>(n.add(f),()=>n.delete(f))},u=e=t(r,i,d);return d},C3=(t=>t?Pv(t):Pv),y3=t=>t;function b3(t,e=y3){const n=Gi.useSyncExternalStore(t.subscribe,Gi.useCallback(()=>e(t.getState()),[t,e]),Gi.useCallback(()=>e(t.getInitialState()),[t,e]));return Gi.useDebugValue(n),n}const N3=t=>{const e=C3(t),n=r=>b3(e,r);return Object.assign(n,e),n},rx=(t=>N3);function S3(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var l;const c=u=>u===null?null:JSON.parse(u,void 0),d=(l=n.getItem(i))!=null?l:null;return d instanceof Promise?d.then(c):c(d)},setItem:(i,l)=>n.setItem(i,JSON.stringify(l,void 0)),removeItem:i=>n.removeItem(i)}}const Dy=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return Dy(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Dy(r)(n)}}}},v3=(t,e)=>(n,r,i)=>{let l={storage:S3(()=>localStorage),partialize:C=>C,version:0,merge:(C,v)=>({...v,...C}),...e},c=!1;const d=new Set,u=new Set;let f=l.storage;if(!f)return t((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),n(...C)},r,i);const m=()=>{const C=l.partialize({...r()});return f.setItem(l.name,{state:C,version:l.version})},_=i.setState;i.setState=(C,v)=>(_(C,v),m());const y=t((...C)=>(n(...C),m()),r,i);i.getInitialState=()=>y;let g;const N=()=>{var C,v;if(!f)return;c=!1,d.forEach(U=>{var L;return U((L=r())!=null?L:y)});const R=((v=l.onRehydrateStorage)==null?void 0:v.call(l,(C=r())!=null?C:y))||void 0;return Dy(f.getItem.bind(f))(l.name).then(U=>{if(U)if(typeof U.version=="number"&&U.version!==l.version){if(l.migrate){const L=l.migrate(U.state,U.version);return L instanceof Promise?L.then(w=>[!0,w]):[!0,L]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,U.state];return[!1,void 0]}).then(U=>{var L;const[w,P]=U;if(g=l.merge(P,(L=r())!=null?L:y),n(g,!0),w)return m()}).then(()=>{R==null||R(g,void 0),g=r(),c=!0,u.forEach(U=>U(g))}).catch(U=>{R==null||R(void 0,U)})};return i.persist={setOptions:C=>{l={...l,...C},C.storage&&(f=C.storage)},clearStorage:()=>{f==null||f.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>N(),hasHydrated:()=>c,onHydrate:C=>(d.add(C),()=>{d.delete(C)}),onFinishHydration:C=>(u.add(C),()=>{u.delete(C)})},l.skipHydration||N(),g||y},ix=v3,Ba=rx()(ix(t=>({certifyRegconfInfo:null,ldapResult:null,certifyProdList:[],isCertifyProd:!1,certifyOpLnkdCd:"",entrNo:null,entrRqstNo:null,lguMarketCd:"",lguOperatorId:"",lguJobType:"",lguJobTypeConf:"",cl02PortData:null,isSubscriptionDone:!1,isLineRegistrationDone:!1,setCertifyRegconfInfo:e=>t({certifyRegconfInfo:e}),setLdapResult:e=>t({ldapResult:e}),setCertifyProdList:e=>t({certifyProdList:e}),setIsCertifyProd:e=>t({isCertifyProd:e}),setCertifyOpLnkdCd:e=>t({certifyOpLnkdCd:e}),setEntrNo:(e,n)=>t({entrNo:e,entrRqstNo:n??null}),setLguCommonCd:(e,n,r,i)=>t({lguMarketCd:e,lguOperatorId:n,...r!==void 0?{lguJobType:r}:{},...i!==void 0?{lguJobTypeConf:i}:{}}),setCl02PortData:e=>t({cl02PortData:e}),setIsSubscriptionDone:e=>t({isSubscriptionDone:e}),setIsLineRegistrationDone:e=>t({isLineRegistrationDone:e}),reset:()=>t({certifyRegconfInfo:null,ldapResult:null,certifyProdList:[],isCertifyProd:!1,certifyOpLnkdCd:"",entrNo:null,entrRqstNo:null,lguMarketCd:"",lguOperatorId:"",lguJobType:"",lguJobTypeConf:"",cl02PortData:null,isSubscriptionDone:!1,isLineRegistrationDone:!1})}),{name:"dlive-certify-storage",partialize:t=>({certifyRegconfInfo:t.certifyRegconfInfo,ldapResult:t.ldapResult,entrNo:t.entrNo,entrRqstNo:t.entrRqstNo,isSubscriptionDone:t.isSubscriptionDone,isLineRegistrationDone:t.isLineRegistrationDone})})),yg=async({order:t,workerId:e,certifyRegconfInfo:n,addOnParam:r="",reason:i="",certifyType:l,contIdOld:c})=>{var d,u;if(!n)return{success:!1,code:"NO_DATA",message:" ."};try{const f=await Jw({CONT_ID:t.CTRT_ID||"",CUST_ID:((d=t.customer)==null?void 0:d.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:t.SO_ID||"",REG_UID:e,CERTIFY_TYPE:l,ADDR:t.ADDR||((u=t.customer)==null?void 0:u.address)||"",BLD_NM:t.BLD_NM||"",T:n.T||"",ONT_MAC:n.ONT_MAC||"",ONT_SERIAL:n.ONT_SERIAL||"",AP_MAC:n.AP_MAC||"",DEV_ID:n.DEV_ID||"",IP:n.IP||"",PORT:n.PORT||"",MAX_SPEED:n.MAX_SPEED||"",ST:n.ST||"",EQIP_ID:n.EQIP_ID||"",EQIP_PORT_NO:n.EQIP_PORT_NO||"",EQIP_DIVS:n.EQIP_DIVS||"",SVC:t.PROD_CD||t.PROD_CD||"",ADD_ON:r,REASON:i,...c?{CONT_ID_OLD:c}:{}});return console.log("[useCertifyComplete] CL-04 :",f),f.code!=="SUCCESS"&&f.code!=="OK"?{success:!1,code:f.code,message:f.message}:{success:!0,code:f.code,message:f.message}}catch(f){return console.error("[useCertifyComplete] CL-04 :",f),{success:!1,code:"ERROR",message:f.message||"CL-04  "}}},S5=async(t,e,n)=>{var u;const r=n||t.CTRT_ID||"",i=t.SO_ID||"";let l=!1;try{const f=await Jm({CTRT_ID:r,CUST_ID:((u=t.customer)==null?void 0:u.id)||t.CUST_ID||"",SO_ID:i,REG_UID:e,WRK_ID:t.id||""}),m=Array.isArray(f)?f[0]:f;m&&!m.ERROR&&m.CONT_ID===r&&(l=!0,console.log("[useCertifyComplete] CL-08  "))}catch(f){console.log("[useCertifyComplete] CL-08  :",f)}let c=!1;try{c=(await ka("CMIF006")).map(_=>_.code||_.COMMON_CD).includes(i)}catch(f){console.error("[useCertifyComplete] CMIF006  :",f)}let d="";return l&&c?d="U":!l&&c?d="C":l&&!c&&(d="D"),console.log("[useCertifyComplete] CERTIFY_TYPE:",d,"| bCl08:",l,"| SO in CMIF006:",c),{certifyType:d,bCl08:l}},D3=async(t,e)=>{var i,l;const n=t.CTRT_ID||"";let r="N";try{const c=await Jm({CTRT_ID:n,CUST_ID:((i=t.customer)==null?void 0:i.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:e,WRK_ID:t.id||""}),d=Array.isArray(c)?c[0]:c;d&&!d.ERROR&&d.CONT_ID===n&&(r="Y",console.log("[useCertifyComplete] CL-08  , CERTIFY_TG=Y"))}catch(c){console.log("[useCertifyComplete] CL-08  :",c)}if(r==="Y")try{const c=await R_({CTRT_ID:n,CUST_ID:((l=t.customer)==null?void 0:l.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:t.SO_ID||"",REG_UID:e});if(c!=null&&c.ERROR)return console.error("[useCertifyComplete] CL-06 :",c.ERROR),{success:!1,certifyTg:r,error:c.ERROR};console.log("[useCertifyComplete] CL-06  ")}catch(c){return console.error("[useCertifyComplete] CL-06  :",c),{success:!1,certifyTg:r,error:c.message}}return{success:!0,certifyTg:r}},R3=async(t,e,n)=>{var r;try{const i=await R_({CTRT_ID:n,CUST_ID:((r=t.customer)==null?void 0:r.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:t.SO_ID||"",REG_UID:e});return i!=null&&i.ERROR?(console.error("[useCertifyComplete] CL-06 (Change) :",i.ERROR),{success:!1,error:i.ERROR}):{success:!0}}catch(i){return{success:!1,error:i.message}}},bg=async(t,e)=>{if(!(e==1||e==="1"))return!1;try{return(await ka("CMIF006")).map(l=>l.code||l.COMMON_CD).includes(t)}catch(r){return console.error("[useCertifySignal] CMIF006  :",r),!1}},_a=({isOpen:t,onClose:e,title:n,size:r="medium",children:i,footer:l,subHeader:c})=>{if(x.useEffect(()=>{if(t){const u=window.scrollY,f={overflow:document.body.style.overflow,position:document.body.style.position,top:document.body.style.top,width:document.body.style.width};return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${u}px`,document.body.style.width="100%",()=>{document.body.style.overflow=f.overflow,document.body.style.position=f.position,document.body.style.top=f.top,document.body.style.width=f.width,window.scrollTo(0,u)}}},[t]),!t)return null;const d={small:"modal-sm",medium:"modal-md",large:"modal-lg"}[r];return s.jsx("div",{className:"base-modal-overlay",onClick:e,children:s.jsxs("div",{className:`base-modal-container ${d}`,onClick:u=>u.stopPropagation(),children:[s.jsxs("div",{className:"base-modal-header",children:[s.jsx("h2",{className:"base-modal-title",children:n}),s.jsx("button",{onClick:e,className:"base-modal-close-btn","aria-label":"",children:s.jsx(bi,{size:18})})]}),c&&s.jsx("div",{className:"base-modal-subheader",children:c}),s.jsx("div",{className:"base-modal-body",children:i}),l&&s.jsx("div",{className:"base-modal-footer",children:l})]})})},hc=({isOpen:t,onClose:e,onSave:n,workId:r,initialData:i,workType:l,customerId:c,customerName:d,contractId:u,addrOrd:f,kpiProdGrpCd:m,prodChgGb:_,chgKpiProdGrpCd:y,prodGrp:g,wrkDtlTcd:N,readOnly:C=!1})=>{const[v,R]=x.useState({NET_CL:"",INSTL_TP:"",WRNG_TP:"",CB_INSTL_TP:"",CB_WRNG_TP:"",INOUT_LINE_TP:"N",INOUT_LEN:"",DVDR_YN:"N",BFR_LINE_YN:"N",CUT_YN:"N",TERM_NO:"",RCV_STS:"",SUBTAP_ID:"",PORT_NUM:"",EXTN_TP:"",TAB_LBL:"",CVT_LBL:"",STB_LBL:""}),[U,L]=x.useState([]),[w,P]=x.useState([]),[G,K]=x.useState([]),[B,O]=x.useState([]),[S,A]=x.useState([]),[Y,te]=x.useState([]),[J,q]=x.useState(!1),[V,F]=x.useState(!1);x.useEffect(()=>{t&&r&&ae()},[t,r]),x.useEffect(()=>{if(i){const X=l==="02"||l==="04"||l==="08",_e={...i};X&&((!i.NET_CL||i.NET_CL.trim()==="")&&(delete _e.NET_CL,delete _e.NET_CL_NM),(!i.INSTL_TP||i.INSTL_TP.trim()==="")&&delete _e.INSTL_TP),R(me=>({...me,..._e}))}},[i,l]);const I=(X,_e)=>!X||!_e?-1:X.indexOf(_e),ee=(X,_e,me,Z)=>{const le=l,se=m,Ee=_,Ne=y,ye=g,ne=N;console.log(" [Filter]   :",{WRK_CD:le,KPI_PROD_GRP_CD:se,PROD_CHG_GB:Ee,PROD_GRP:ye,WRK_DTL_TCD:ne}),console.log(" [Filter]    :",{instlTpList:X.length,wrngTpList:_e.length,cbInstlTpList:me.length,cbWrngTpList:Z.length});let ue=X,xe=me,et=Z;le==="01"||le==="03"||le==="06"||le==="07"||le==="09"?(console.log(" [Filter] :",le,"- /AS/ "),ne==="0920"?(console.log(" [Filter] :",ne,"- code=77 "),ue=X.filter(it=>I(it.ref_code,se||"")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77")):(console.log(" [Filter] :",ne,"- code!=77 "),ue=X.filter(it=>I(it.ref_code,se||"")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77")),console.log(" [Filter]   :",ue.length,""),ye==="C"&&(ne==="0920"?xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"):xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"))):le==="05"?Ee==="01"?(ue=X.filter(it=>I(it.ref_code,Ne||"")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"),ye==="C"&&(xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"),et=Z.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"))):Ee==="02"&&(ue=X.filter(it=>I(it.ref_code,se||"")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"),ye==="C"&&(xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"),et=Z.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"))):le==="04"?ne==="0440"?(ue=X.filter(it=>I(it.ref_code,se||"")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"),ye==="C"&&(xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"),et=Z.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code!=="77"))):ne==="0430"&&(ue=X.filter(it=>I(it.ref_code,se||"")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"),ye==="C"&&(xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"),et=Z.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"))):(ue=X.filter(it=>{const At=it.code==="77",at=(it.ref_code3||"")>="20090901",We=se?I(it.ref_code,se)>-1:!0;return At&&at&&We}),ye==="C"&&(xe=me.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77"),et=Z.filter(it=>I(it.ref_code,"I")>-1&&(it.ref_code3||"")>="20090901"&&it.code==="77")));const bt=_e.filter(it=>I(it.ref_code,se||"")>-1&&(it.ref_code3||"")>="20090901");return console.log(" [Filter]   :",{instlTp:ue.length,wrngTp:bt.length,cbInstlTp:xe.length,cbWrngTp:et.length}),{filteredInstlTp:ue,filteredWrngTp:bt,filteredCbInstlTp:xe,filteredCbWrngTp:et}},ae=async()=>{q(!0);try{console.log(" [InstallInfoModal]   "),console.log(" [InstallInfoModal]  :",{workType:l,kpiProdGrpCd:m,prodChgGb:_,chgKpiProdGrpCd:y,prodGrp:g,wrkDtlTcd:N});const[X,_e,me,Z,le]=await Promise.all([ka("CMCU048"),ka("BLST014"),ka("BLST010"),ka("CMCU030"),ka("CMCU046")]);console.log(" [InstallInfoModal]  :",{netCl:X.length,wrngTp:_e.length,instlTp:me.length,cbWrngTp:Z.length,cbInstlTp:le.length}),me.length>0&&(console.log(" [InstallInfoModal] (BLST010)    ():",me[0]),console.log(" [InstallInfoModal]   ref_code :",{ref_code:me[0].ref_code,ref_code2:me[0].ref_code2,ref_code3:me[0].ref_code3})),me.length>1&&(console.log(" [InstallInfoModal] (BLST010)    ( ):",me[1]),console.log(" [InstallInfoModal]   ref_code :",{ref_code:me[1].ref_code,ref_code2:me[1].ref_code2,ref_code3:me[1].ref_code3}),console.log(" [InstallInfoModal]     :",Object.keys(me[1]))),_e.length>1&&console.log(" [InstallInfoModal] (BLST014)   :",_e[1]);const se=l==="02"||l==="04"||l==="08";if(l&&(m||se)){const Ee=ee(me,_e,le,Z);L(X),P(Ee.filteredWrngTp),K(_e),O(Ee.filteredInstlTp),A(Ee.filteredCbWrngTp),te(Ee.filteredCbInstlTp),console.log(" [Filter]    - instlTp:",Ee.filteredInstlTp.length,"")}else L(X),P(_e),K(_e),O(me),A(Z),te(le),console.log(" [Filter]    -   ");if(console.log(" [InstallInfoModal]  state  "),se){const Ee=(i==null?void 0:i.NET_CL)&&i.NET_CL.trim()!=="",Ne=(i==null?void 0:i.INSTL_TP)&&i.INSTL_TP.trim()!=="";console.log(" [InstallInfoModal]     - hasNetCl:",Ee,"hasInstlTp:",Ne);const ye={};if(!Ee&&X.length>0){console.log(" [InstallInfoModal] netCl :",X.map(xe=>({code:xe.code,name:xe.name})));const ue=X.find(xe=>xe.name&&(xe.name.includes("DLIVE")||xe.name.includes("")));console.log(" [InstallInfoModal]   NET_CL:",ue),ue&&(ye.NET_CL=ue.code,ye.NET_CL_NM=ue.name,console.log(" [InstallInfoModal] NET_CL  :",ue.code,ue.name))}if(Ne||(ye.INSTL_TP="77",console.log(" [InstallInfoModal] INSTL_TP  : 77()")),Object.keys(ye).length>0&&R(ue=>({...ue,...ye})),(Ne?i==null?void 0:i.INSTL_TP:"77")==="77"){const ue=_e.filter(xe=>I(xe.ref_code2,"77")>-1);console.log(" [InstallInfoModal]   -  :",ue.length,""),P(ue)}}}catch(X){console.error(" [InstallInfoModal] Failed to load common codes:",X)}finally{q(!1)}},T=x.useMemo(()=>U.map(X=>({value:X.code,label:X.name})),[U]),j=x.useMemo(()=>B.map(X=>({value:X.code,label:X.name})),[B]),k=x.useMemo(()=>w.map(X=>({value:X.code,label:X.name})),[w]),Q=x.useMemo(()=>Y.map(X=>({value:X.code,label:X.name})),[Y]),H=x.useMemo(()=>S.map(X=>({value:X.code,label:X.name})),[S]);if(!t)return null;const $=(X,_e)=>{C||(R(me=>({...me,[X]:_e})),X==="INSTL_TP"&&(R(me=>({...me,WRNG_TP:""})),_e?ie(_e):P(G)),X==="CB_INSTL_TP"&&(R(me=>({...me,CB_WRNG_TP:""})),_e&&fe(_e)))},ie=X=>{if(console.log(" [Filter]  :",{instlTpValue:X,workType:l,prodChgGb:_,kpiProdGrpCd:m,chgKpiProdGrpCd:y}),!X||G.length===0){P(G);return}if(!m&&!y){console.log(" [Filter] KPI_PROD_GRP_CD  - ref_code2 ");const me=G.filter(Z=>I(Z.ref_code2,X)>-1);console.log(" [Filter]   :",me.length,""),P(me);return}let _e=G;l==="05"?_==="01"?_e=G.filter(me=>I(me.ref_code2,X)>-1&&I(me.ref_code,y||"")>-1):_==="02"?_e=G.filter(me=>I(me.ref_code2,X)>-1&&I(me.ref_code,m||"")>-1):_e=G.filter(me=>I(me.ref_code2,X)>-1&&I(me.ref_code,m||"")>-1):_e=G.filter(me=>I(me.ref_code2,X)>-1&&I(me.ref_code,m||"")>-1),console.log(" [Filter]   :",_e.length,""),P(_e),v.WRNG_TP&&!_e.find(me=>me.code===v.WRNG_TP)&&R(me=>({...me,WRNG_TP:""}))},fe=X=>{if(console.log(" [Filter]  :",X),!X)return;const _e=S.filter(me=>I(me.ref_code2,X)>-1&&I(me.ref_code,"I")>-1);console.log(" [Filter]   :",_e.length,""),A(_e)},pe=async()=>{var X;if(!v.NET_CL){alert(" .");return}if(!v.INSTL_TP){alert(" .");return}if(!v.WRNG_TP){alert(" .");return}F(!0);try{const _e=((X=U.find(le=>le.code===v.NET_CL))==null?void 0:X.name)||"",me={...v,NET_CL_NM:_e},Z=await S4({WRK_ID:r,CTRT_ID:u||"",ADDR_ORD:f||"",WRK_DTL_TCD:N||"",...v});Z.code==="SUCCESS"?(n(me),e()):alert(Z.message||" .")}catch(_e){console.error("Save failed:",_e),alert(_e.message||"     .")}finally{F(!1)}},de=J?null:s.jsxs("div",{className:"install-subheader",children:[s.jsxs("div",{className:"info-row whitespace-nowrap",children:[s.jsx("span",{className:"info-label",children:"ID:"}),s.jsx("span",{className:"info-value",children:Qi(c)})]}),s.jsxs("div",{className:"info-row whitespace-nowrap",children:[s.jsx("span",{className:"info-label",children:":"}),s.jsx("span",{className:"info-value",children:d||"-"})]}),s.jsxs("div",{className:"info-row whitespace-nowrap",children:[s.jsx("span",{className:"info-label",children:"ID:"}),s.jsx("span",{className:"info-value",children:Qi(u)})]})]}),Re=C?s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:e,children:""}):s.jsx("button",{className:"btn btn-primary btn-sm",onClick:pe,disabled:J||V,children:V?" ...":""});return s.jsx(_a,{isOpen:t,onClose:e,title:l==="02"||l==="04"||l==="08"||l==="09"?"":"",size:"medium",subHeader:de,footer:Re,children:s.jsx("div",{className:"install-modal-content",children:J?s.jsxs("div",{className:"loading-message",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"  ..."})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"install-info-section",children:[s.jsxs("div",{className:"install-form-row",children:[s.jsxs("label",{className:"install-label",children:[" ",!C&&s.jsx("span",{className:"required",children:"*"})]}),s.jsx(Zs,{value:v.NET_CL||"",onValueChange:X=>$("NET_CL",X),options:T,placeholder:"",required:!C,disabled:C})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsxs("label",{className:"install-label",children:[" ",!C&&s.jsx("span",{className:"required",children:"*"})]}),s.jsx(Zs,{value:v.INSTL_TP||"",onValueChange:X=>$("INSTL_TP",X),options:j,placeholder:"",required:!C,disabled:C})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsxs("label",{className:"install-label",children:[" ",!C&&s.jsx("span",{className:"required",children:"*"})]}),s.jsx(Zs,{value:v.WRNG_TP||"",onValueChange:X=>$("WRNG_TP",X),options:k,placeholder:v.INSTL_TP?"":"  ",disabled:C||!v.INSTL_TP,required:!C})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsx("label",{className:"install-label",children:""}),s.jsx(Zs,{value:v.CB_INSTL_TP||"",onValueChange:X=>$("CB_INSTL_TP",X),options:Q,placeholder:"",disabled:!0})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsx("label",{className:"install-label",children:""}),s.jsx(Zs,{value:v.CB_WRNG_TP||"",onValueChange:X=>$("CB_WRNG_TP",X),options:H,placeholder:"",disabled:!0})]}),s.jsxs("div",{className:"install-form-row-inline",children:[s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:v.INOUT_LINE_TP==="Y",onChange:X=>$("INOUT_LINE_TP",X.target.checked?"Y":"N"),disabled:C}),s.jsx("span",{children:""})]}),s.jsxs("div",{className:"install-inline-group",children:[s.jsx("label",{className:"install-inline-label",children:""}),s.jsx("input",{type:"text",className:"install-input-inline",value:v.INOUT_LEN||"",onChange:X=>$("INOUT_LEN",X.target.value),disabled:C})]})]}),s.jsxs("div",{className:"install-form-row-inline",children:[s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:v.DVDR_YN==="Y",onChange:X=>$("DVDR_YN",X.target.checked?"Y":"N"),disabled:C}),s.jsx("span",{children:""})]}),l==="02"||l==="08"?s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:v.CUT_YN==="Y",onChange:X=>$("CUT_YN",X.target.checked?"Y":"N"),disabled:C}),s.jsx("span",{children:""})]}):s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:v.BFR_LINE_YN==="Y",onChange:X=>$("BFR_LINE_YN",X.target.checked?"Y":"N"),disabled:C}),s.jsx("span",{children:""})]})]})]})})})})},Wa=({isOpen:t,onClose:e,ctrtId:n,custId:r})=>{const[i,l]=x.useState([]),[c,d]=x.useState(!1),[u,f]=x.useState(null),m=v=>{const R=v.getFullYear(),U=String(v.getMonth()+1).padStart(2,"0"),L=String(v.getDate()).padStart(2,"0");return`${R}${U}${L}`},_=(v,R)=>{const U=new Date(v);return U.setDate(U.getDate()+R),U},y=v=>{if(!v||v.length<14)return v;const R=v.substring(0,4),U=v.substring(4,6),L=v.substring(6,8),w=v.substring(8,10),P=v.substring(10,12),G=v.substring(12,14);return`${R}-${U}-${L} ${w}:${P}:${G}`},g=async()=>{if(!n){console.error("[] ID ");return}d(!0),f(null);try{const v=new Date,R=m(_(v,-7)),U=m(_(v,1));console.log("[]  :",{ctrtId:n,custId:r,startDate:R,endDate:U});const L=typeof window<"u"?window.location.origin:"http://localhost:3000",w=await fetch(`${bs}/integration/history`,{method:"POST",headers:{"Content-Type":"application/json",Origin:L},credentials:"include",body:JSON.stringify({CTRT_ID:n,CUST_ID:r||"",STRT_DTTM1:R,STRT_DTTM2:U})});if(!w.ok)throw new Error(`API  : ${w.status}`);const P=await w.json();console.log("[] API :",P);const G=P.output||P.ds_svc_dtl||[];l(Array.isArray(G)?G:[]),console.log("[]  :",G.length,"")}catch(v){console.error("[]  :",v),f(v instanceof Error?v.message:"   ")}finally{d(!1)}};x.useEffect(()=>{t&&n&&g()},[t,n]);const N=s.jsxs("div",{className:"text-xs text-gray-700 space-y-0.5",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-600",children:"ID:"})," ",s.jsx("span",{className:"font-medium text-blue-700",children:Qi(n)})]}),s.jsx("div",{className:"text-gray-600",children:":  7"})]}),C=s.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:""});return s.jsx(_a,{isOpen:t,onClose:e,title:"",size:"medium",subHeader:N,footer:C,children:s.jsxs("div",{children:[c&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:" ..."})}),u&&s.jsx("div",{className:"flex items-center justify-center py-8 px-4",children:s.jsx("div",{className:"text-red-500 text-xs text-center",children:u})}),!c&&!u&&i.length===0&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:" "})}),!c&&!u&&i.length>0&&s.jsx("div",{className:"space-y-2.5 p-2.5",children:i.map((v,R)=>s.jsx("div",{className:`rounded-lg border shadow-sm p-2.5 ${R%2===0?"bg-white border-gray-200":"bg-gray-50 border-gray-200"}`,children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",v.prod_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"ID:"})," ",Qi(v.ctrt_id)]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",v.msg_id_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",v.proc_rslt_cd_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",v.rslt_cd_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",v.strt_dttm?y(v.strt_dttm):"-"]})})]})},R))})]})})},Av=[{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"()",label:"()"},{value:"()",label:"()"},{value:"()",label:"()"},{value:"99",label:"()"}],T3=[{value:"01",label:"HDMI1"},{value:"02",label:"HDMI2"},{value:"03",label:"HDMI3"},{value:"04",label:"HDMI4"},{value:"05",label:""},{value:"06",label:"1"},{value:"07",label:"2"},{value:"08",label:"3"},{value:"09",label:"4"},{value:"11",label:"RF "}],Of=({isOpen:t,onClose:e,onSave:n,workId:r,ctrtId:i,prodGrp:l,initialInstlLoc:c,initialViewModCd:d,initialViewModNm:u,showToast:f,readOnly:m=!1})=>{const[_,y]=x.useState(""),[g,N]=x.useState(""),[C,v]=x.useState(""),[R,U]=x.useState(T3),L=l==="D";x.useEffect(()=>{t&&L&&(async()=>{try{const K=await ka("CMWO048");if(console.log("[InstallLocationModal] API  :",K),K&&K.length>0){const B=K.map(O=>({value:O.code||O.COMMON_CD||"",label:O.name||O.COMMON_CD_NM||""})).filter(O=>O.value&&O.label);B.length>0?(U(B),console.log("[InstallLocationModal]    :",B)):console.log("[InstallLocationModal]   ,  ")}}catch(K){console.error("[InstallLocationModal]    ,  :",K)}})()},[t,L]),x.useEffect(()=>{if(t){if(c){const G=Av.find(K=>K.value===c||K.label===c);G&&G.value!=="99"?(y(G.value),N("")):(y("99"),N(c))}else y(""),N("");v(d||"")}},[t,c,d]);const w=()=>!_||_==="[]"?" .":_==="99"&&!g.trim()?"   . ()":L&&(!C||C==="[]")?" .":null,P=async()=>{var S;const G=w();if(G){f?f(G,"warning"):alert(G);return}const K=_==="99"?g:_,B=((S=R.find(A=>A.value===C))==null?void 0:S.label)||"",O=L&&C?`${K}${C}`:K;f&&f(".","success"),n({INSTL_LOC:K,VIEW_MOD_CD:C,VIEW_MOD_NM:B,INSTL_LOC_FULL:O}),e()};return t?s.jsxs(_a,{isOpen:t,onClose:e,title:"(, )",size:"md",children:[s.jsxs("div",{className:"space-y-5 p-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!m&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:_,onValueChange:G=>{m||(y(G),G!=="99"&&N(""))},options:Av,placeholder:" ",required:!m,disabled:m})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:["  ",!m&&_==="99"&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:g,onChange:G=>!m&&N(G.target.value),placeholder:_==="99"?", ,     ":"    ",disabled:m||_!=="99",maxLength:512,rows:3,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border rounded-lg text-sm sm:text-base resize-none
              ${m?"border-gray-200 bg-gray-100 text-gray-700 cursor-not-allowed":_==="99"?"border-gray-300 bg-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500":"border-gray-200 bg-gray-100 text-gray-500 cursor-not-allowed"}`}),!m&&s.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:"* "})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!m&&L&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:C,onValueChange:G=>!m&&v(G),options:R,placeholder:" ",disabled:m||!L,required:!m&&L}),!m&&!L&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"DTV    ."})]})]}),s.jsxs("div",{className:"flex gap-2 sm:gap-3 p-3 sm:p-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:e,className:"py-2 sm:py-3 px-3 sm:px-4 font-semibold rounded-lg transition-colors text-sm sm:text-base flex-1 bg-gray-200 text-gray-700 hover:bg-gray-300",children:""}),!m&&s.jsx("button",{type:"button",onClick:P,className:"flex-1 py-2 sm:py-3 px-3 sm:px-4 bg-cyan-600 text-white font-semibold rounded-lg hover:bg-cyan-700 transition-colors text-sm sm:text-base",children:""})]})]}):null},vb=({isOpen:t,onClose:e,onSave:n,wrkId:r,wrkDrctnId:i,crrId:l,wrkrId:c,dataType:d,showToast:u,readOnly:f=!1})=>{const[m,_]=x.useState(""),[y,g]=x.useState([]),[N,C]=x.useState(""),[v,R]=x.useState(!1),[U,L]=x.useState(!1);x.useEffect(()=>{t&&r&&i&&(w(),d==="C"&&P())},[t,r,i,d]);const w=async()=>{try{const S=await sx({WRK_ID:r,WRK_DRCTN_ID:i,DATA_TYPE:d});S!=null&&S.EQT_SERNO&&_(S.EQT_SERNO)}catch(S){console.error("[OttSerialModal]    :",S)}},P=async()=>{try{const S=await W4({WRK_ID:r});S!=null&&S.OTT_TYPE?C(S.OTT_TYPE):(u==null||u("OTT BOX   .      .","warning"),e())}catch(S){console.error("[OttSerialModal] OTT   :",S)}},G=async()=>{if(!m.trim()){u==null||u("OTT BOX  .","warning");return}L(!0);try{const S={EQT_SERNO:m,DATA_TYPE:d};d==="C"&&(S.CRR_ID=l||"",S.OTT_TYPE=N,S.WRKR_ID=c||"");const A=await B4(S),Y=d==="C"?A.filter(te=>te.EQT_STAT==="OK"):A;g(Y),Y.length===0&&(u==null||u("  .","info"))}catch(S){console.error("[OttSerialModal]   :",S),u==null||u("    .","error")}finally{L(!1)}},K=S=>{_(S.EQT_SERNO||"")},B=async()=>{if(!m.trim()){u==null||u("OTT BOX  .","warning");return}if(d==="C"&&y.length<1){u==null||u("    .","warning");return}R(!0);try{const S=localStorage.getItem("userInfo"),A=S?JSON.parse(S):{},Y=await U4({WRK_ID:r,WRK_DRCTN_ID:i,EQT_SERNO:m,DATA_TYPE:d,REG_UID:A.userId||""});Y.code==="SUCCESS"||Y.code==="OK"?(u==null||u("OTT  .","success"),n(m),e()):u==null||u(Y.message||" .","error")}catch(S){console.error("[OttSerialModal]  :",S),u==null||u(S.message||"   .","error")}finally{R(!1)}},O=S=>{S.key==="Enter"&&(S.preventDefault(),G())};return s.jsx(_a,{isOpen:t,onClose:e,title:d==="C"?" OTT  ":"OTT  ",maxWidth:"md",children:s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"BOX S/N"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:m,onChange:S=>_(S.target.value),onKeyDown:O,placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",readOnly:f,disabled:f}),s.jsxs("button",{onClick:G,disabled:U||f,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center gap-2 disabled:bg-gray-300",children:[U?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(yu,{className:"w-4 h-4"}),s.jsx("span",{children:""})]})]})]}),d==="C"&&N&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),s.jsx("input",{type:"text",value:N,readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-600"})]}),y.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"  ( )"}),s.jsx("div",{className:"border border-gray-300 rounded-lg max-h-48 overflow-y-auto",children:y.map((S,A)=>s.jsxs("div",{onClick:()=>!f&&K(S),className:`px-4 py-3 border-b last:border-b-0 cursor-pointer transition-colors ${m===S.EQT_SERNO?"bg-blue-50 text-blue-700":"hover:bg-gray-50"} ${f?"cursor-not-allowed":""}`,children:[s.jsx("span",{className:"font-medium",children:S.EQT_SERNO}),S.EQT_STAT&&s.jsx("span",{className:`ml-2 text-xs px-2 py-0.5 rounded ${S.EQT_STAT==="OK"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:S.EQT_STAT})]},A))})]}),s.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[!f&&s.jsx("button",{onClick:B,disabled:v||!m.trim(),className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed",children:v?" ...":""}),s.jsx("button",{onClick:e,className:"flex-1 py-3 bg-gray-500 hover:bg-gray-600 text-white font-semibold rounded-lg",children:f?"":""})]})]})})},E3=[{value:"0",label:""},{value:"1",label:" "},{value:"2",label:" "},{value:"3",label:" "}],Ng=({isOpen:t,onClose:e,onSave:n,soId:r})=>{const[i,l]=x.useState("");x.useEffect(()=>{t&&l("")},[t]);const c=()=>{if(!i){alert("  .");return}n({POLE_YN:i,LAN_GB:""})};return t?s.jsxs(_a,{isOpen:t,onClose:e,title:"",size:"sm",children:[s.jsx("div",{className:"space-y-5 p-4",children:s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:i,onValueChange:l,options:E3,placeholder:"",required:!0})]})}),s.jsxs("div",{className:"flex gap-2 sm:gap-3 p-3 sm:p-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 py-2 sm:py-3 px-3 sm:px-4 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition-colors text-sm sm:text-base",children:""}),s.jsx("button",{type:"button",onClick:c,className:"flex-1 py-2 sm:py-3 px-3 sm:px-4 bg-cyan-600 text-white font-semibold rounded-lg hover:bg-cyan-700 transition-colors text-sm sm:text-base",children:""})]})]}):null},ul=({isOpen:t,onClose:e,onConfirm:n,title:r,message:i,type:l="confirm",confirmText:c="",cancelText:d="",showCancel:u=!0,children:f})=>{if(!t)return null;const m=()=>{switch(l){case"warning":return s.jsx(ql,{className:"w-12 h-12 text-yellow-500"});case"error":return s.jsx(Lo,{className:"w-12 h-12 text-red-500"});case"info":return s.jsx(i5,{className:"w-12 h-12 text-blue-500"});case"confirm":default:return s.jsx(Vi,{className:"w-12 h-12 text-green-500"})}},_=()=>{switch(l){case"warning":return"bg-yellow-50 border-yellow-200";case"error":return"bg-red-50 border-red-200";case"info":return"bg-blue-50 border-blue-200";case"confirm":default:return"bg-green-50 border-green-200"}},y=()=>{switch(l){case"warning":return"bg-yellow-500 hover:bg-yellow-600";case"error":return"bg-red-500 hover:bg-red-600";case"info":return"bg-blue-500 hover:bg-blue-600";case"confirm":default:return"bg-blue-500 hover:bg-blue-600"}},g=()=>{n(),e()};return s.jsxs("div",{className:"fixed inset-0 z-[300] flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-[90%] max-w-sm mx-4 overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:`px-4 sm:px-6 py-4 sm:py-5 flex flex-col items-center border-b ${_()}`,children:[m(),r&&s.jsx("h3",{className:"mt-2 sm:mt-3 text-base sm:text-lg font-bold text-gray-900 text-center",children:r})]}),s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-5 max-h-[60vh] overflow-y-auto",children:[f,s.jsx("p",{className:"text-center text-gray-700 whitespace-pre-line text-sm sm:text-base",children:i})]}),s.jsxs("div",{className:"px-3 sm:px-4 py-3 sm:py-4 bg-gray-50 flex gap-2 sm:gap-3",children:[u&&s.jsx("button",{onClick:e,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors text-sm sm:text-base",children:d}),s.jsx("button",{onClick:g,className:`flex-1 px-3 sm:px-4 py-2 sm:py-3 text-white rounded-lg font-semibold transition-colors text-sm sm:text-base ${y()}`,children:c})]})]})]})},kv={isOpen:!1,message:"",title:void 0,type:"confirm",onConfirm:()=>{}},j3={"01":"","02":"","03":"A/S","04":"","05":"","06":"","07":"","08":"","09":""},I3={11:"",22:"",33:"",44:"IF",55:"FTTB",66:"FTTH",77:"",88:""},ld=({workType:t,workTypeName:e,custRel:n,custRelName:r,networkType:i,networkTypeName:l,installType:c,installTypeName:d,installedEquipments:u,removedEquipments:f,installLocation:m,upCtrlCl:_,upCtrlClName:y,memo:g,kpiProdGrp:N,kpiProdGrpName:C,obsRcptCd:v,obsRcptCdName:R,obsRcptDtlCd:U,obsRcptDtlCdName:L,extraItems:w=[],equipmentData:P,installInfoData:G,order:K,custRelOptions:B,installLocationText:O})=>{var H;const S=t||(K==null?void 0:K.WRK_CD)||"",A=e||(K==null?void 0:K.WRK_CD_NM)||j3[S]||"",Y=r||((H=B==null?void 0:B.find($=>$.value===n))==null?void 0:H.label),te=i||(G==null?void 0:G.networkType)||(G==null?void 0:G.NET_CL),J=l||(G==null?void 0:G.networkTypeName)||(G==null?void 0:G.NET_CL_NM),q=c||(G==null?void 0:G.installType)||(G==null?void 0:G.INSTL_TP),V=d||(G==null?void 0:G.installTypeName)||(G==null?void 0:G.INSTL_TP_NM),F=_||(G==null?void 0:G.upCtrlCl),I=y||(G==null?void 0:G.upCtrlClName),ee=u||(P==null?void 0:P.installedEquipments)||[],ae=f||(P==null?void 0:P.removedEquipments)||[],T=m||(G?{floor:G.floor,room:G.room,position:G.position}:void 0),j=$=>{var ie,fe,pe,de,Re,X,_e,me;return(ie=$.contractEquipment)!=null&&ie.EQT_NM?$.contractEquipment.EQT_NM:(fe=$.contractEquipment)!=null&&fe.eqtNm?$.contractEquipment.eqtNm:(pe=$.contractEquipment)!=null&&pe.type?$.contractEquipment.type:(de=$.contractEquipment)!=null&&de.ITEM_MID_NM?$.contractEquipment.ITEM_MID_NM:(Re=$.actualEquipment)!=null&&Re.EQT_NM?$.actualEquipment.EQT_NM:(X=$.actualEquipment)!=null&&X.eqtNm?$.actualEquipment.eqtNm:(_e=$.actualEquipment)!=null&&_e.type?$.actualEquipment.type:(me=$.actualEquipment)!=null&&me.ITEM_MID_NM?$.actualEquipment.ITEM_MID_NM:$.EQT_NM?$.EQT_NM:$.eqtNm?$.eqtNm:$.type?$.type:$.ITEM_MID_NM?$.ITEM_MID_NM:$.name||""},k=$=>{var ie,fe,pe,de,Re;return(ie=$.actualEquipment)!=null&&ie.EQT_SERNO?$.actualEquipment.EQT_SERNO:(fe=$.actualEquipment)!=null&&fe.eqtSerno?$.actualEquipment.eqtSerno:(pe=$.actualEquipment)!=null&&pe.serialNumber?$.actualEquipment.serialNumber:(de=$.contractEquipment)!=null&&de.EQT_SERNO?$.contractEquipment.EQT_SERNO:(Re=$.contractEquipment)!=null&&Re.serialNumber?$.contractEquipment.serialNumber:$.EQT_SERNO?$.EQT_SERNO:$.eqtSerno?$.eqtSerno:$.serialNumber?$.serialNumber:""},Q=O||T&&[T.floor,T.room,T.position].filter(Boolean).join(" / ")||"-";return s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-blue-200",children:[s.jsx(Vi,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"font-bold text-blue-800 text-sm",children:" "}),s.jsx("span",{className:"text-xs text-blue-600 ml-auto",children:A})]}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ih,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:`font-medium ${n?"text-gray-900":"text-red-500"}`,children:Y||n||""})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(v_,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:`font-medium ${te?"text-gray-900":"text-red-500"}`,children:J||te||""})]}),q&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pu,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:V||I3[q]||q})]}),F&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(v_,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:I||F})]}),Q!=="-"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rd,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900 truncate max-w-[180px]",children:Q})]}),N&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yf,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:"KPI"}),s.jsx("span",{className:"font-medium text-gray-900",children:C||N})]}),v&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pu,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsxs("span",{className:"font-medium text-gray-900",children:[R||v,U&&` > ${L||U}`]})]}),(ee.length>0||ae.length>0)&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(yf,{className:"w-3.5 h-3.5 text-gray-500"}),s.jsx("span",{className:"text-gray-600 font-medium",children:""})]}),s.jsxs("div",{className:"space-y-2",children:[ee.length>0&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-2",children:[s.jsx("div",{className:"mb-1.5",children:s.jsx("span",{className:"text-green-600 font-semibold text-xs",children:""})}),s.jsx("div",{className:"space-y-1",children:ee.map(($,ie)=>s.jsxs("div",{className:"text-green-700",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-green-500 font-bold",children:"+"}),s.jsx("span",{className:"font-medium text-xs",children:j($)})]}),k($)&&s.jsxs("div",{className:"ml-4 text-green-600/70 text-[0.625rem] break-all",children:["S/N: ",k($)]})]},`install-${ie}`))})]}),ae.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2",children:[s.jsx("div",{className:"mb-1.5",children:s.jsx("span",{className:"text-red-600 font-semibold text-xs",children:""})}),s.jsx("div",{className:"space-y-1",children:ae.map(($,ie)=>s.jsxs("div",{className:"text-red-700",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-red-500 font-bold",children:"-"}),s.jsx("span",{className:"font-medium text-xs",children:j($)})]}),k($)&&s.jsxs("div",{className:"ml-4 text-red-600/70 text-[0.625rem] break-all",children:["S/N: ",k($)]})]},`remove-${ie}`))})]})]})]}),w.map(($,ie)=>s.jsxs("div",{className:"flex items-center gap-2",children:[$.icon||s.jsx(xh,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:$.label}),s.jsx("span",{className:`font-medium ${$.isWarning?"text-orange-600":"text-gray-900"}`,children:$.value||"-"})]},ie)),g&&s.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(xh,{className:"w-3.5 h-3.5 text-gray-500 mt-0.5"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900 flex-1 break-all line-clamp-2",children:g})]})})]})]})},$i=rx()(ix((t,e)=>({currentWorkId:null,workSteps:{},currentStep:1,workItem:null,equipmentData:null,filteringData:null,removalLineData:null,setCurrentWorkId:n=>{const{workSteps:r}=e(),i=n&&r[n]||1;t({currentWorkId:n,currentStep:i})},setCurrentStep:n=>t(r=>{const i=typeof n=="function"?n(r.currentStep):n,l={...r.workSteps};return r.currentWorkId&&(l[r.currentWorkId]=i),{currentStep:i,workSteps:l}}),setWorkItem:n=>t({workItem:n}),setEquipmentData:n=>t({equipmentData:n}),setFilteringData:n=>t({filteringData:n}),setRemovalLineData:n=>t({removalLineData:n}),getStepForWork:n=>{const{workSteps:r}=e();return r[n]||1},reset:()=>t({currentWorkId:null,workSteps:{},currentStep:1,workItem:null,equipmentData:null,filteringData:null,removalLineData:null}),resetWork:n=>t(r=>{const i={...r.workSteps};return delete i[n],{workSteps:i}}),clearPreviousWorkDraft:n=>{const{currentWorkId:r,workSteps:i}=e();if(r&&r!==n){console.log(`[WorkProcessStore]  (${r}) draft `);try{localStorage.removeItem(`work_complete_draft_${r}`),localStorage.removeItem(`equipment_draft_${r}`),console.log("localStorage draft  ")}catch(c){console.error("localStorage  :",c)}const l={...i};delete l[r],t({currentWorkId:n,workSteps:l,currentStep:l[n]||1,workItem:null,equipmentData:null,filteringData:null,removalLineData:null})}else{const l=i[n]||1;t({currentWorkId:n,currentStep:l})}}}),{name:"dlive-work-process-storage",partialize:t=>({workSteps:t.workSteps,currentWorkId:t.currentWorkId,filteringData:t.filteringData,equipmentData:t.equipmentData,removalLineData:t.removalLineData})})),Wi=()=>({contractEquipments:[],technicianEquipments:[],customerEquipments:[],removeEquipments:[],installedEquipments:[],removalStatus:{},markedForRemoval:[],pendingLossStatusList:[],reuseAll:!1,selectedContract:null,selectedStock:null,signalStatus:"idle",signalResult:"",filteringData:{},lastUpdated:null,isDataLoaded:!1}),ji=rx()(ix((t,e)=>({workStates:{},currentWorkId:null,initWorkState:n=>{t(r=>r.workStates[n]?r:{...r,workStates:{...r.workStates,[n]:Wi()}})},setCurrentWorkId:n=>{t(r=>{const i={...r.workStates};return n&&!i[n]&&(i[n]=Wi()),{...r,currentWorkId:n,workStates:i}})},clearWorkState:n=>{t(r=>{const i={...r.workStates};return delete i[n],{...r,workStates:i}})},clearAllWorkStates:()=>{t({workStates:{},currentWorkId:null})},setApiData:(n,r)=>{var i,l,c,d,u,f;console.log("[Equipment Store] API  ",{workId:n,:((i=r.contractEquipments)==null?void 0:i.length)??0,:((l=r.technicianEquipments)==null?void 0:l.length)??0,:((c=r.customerEquipments)==null?void 0:c.length)??0,:((d=r.removeEquipments)==null?void 0:d.length)??0,:{contractEquipments:(u=r.contractEquipments)==null?void 0:u.map(m=>({id:m.id,model:m.model,type:m.type})),removeEquipments:(f=r.removeEquipments)==null?void 0:f.map(m=>({id:m.id,model:m.model,EQT_NO:m.EQT_NO}))}}),t(m=>{const y={...m.workStates[n]||Wi(),lastUpdated:new Date().toISOString()};return r.contractEquipments!==void 0&&(y.contractEquipments=r.contractEquipments),r.technicianEquipments!==void 0&&(y.technicianEquipments=r.technicianEquipments),r.customerEquipments!==void 0&&(y.customerEquipments=r.customerEquipments),r.removeEquipments!==void 0&&(y.removeEquipments=r.removeEquipments),r.filteringData!==void 0&&(y.filteringData=r.filteringData),{...m,workStates:{...m.workStates,[n]:y}}})},addInstalledEquipment:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi(),c=l.installedEquipments.findIndex(u=>u.contractEquipment.id===r.contractEquipment.id);let d;return c>=0?(d=[...l.installedEquipments],d[c]=r):d=[...l.installedEquipments,r],console.log("[Equipment Store]  ",{workId:n,action:c>=0?"":"",equipment:{contractId:r.contractEquipment.id,contractModel:r.contractEquipment.model,actualId:r.actualEquipment.id,actualModel:r.actualEquipment.model,EQT_CHG_GB:r.actualEquipment.EQT_CHG_GB},:d.length}),{...i,workStates:{...i.workStates,[n]:{...l,installedEquipments:d,lastUpdated:new Date().toISOString()}}}})},removeInstalledEquipment:(n,r)=>{t(i=>{const l=i.workStates[n];if(!l)return i;const c=l.installedEquipments.find(u=>u.contractEquipment.id===r),d=l.installedEquipments.filter(u=>u.contractEquipment.id!==r);return console.log("[Equipment Store]   ",{workId:n,removed:c?{contractId:c.contractEquipment.id,actualId:c.actualEquipment.id,model:c.actualEquipment.model}:null,:d.length}),{...i,workStates:{...i.workStates,[n]:{...l,installedEquipments:d,lastUpdated:new Date().toISOString()}}}})},updateInstalledEquipment:(n,r,i)=>{t(l=>{const c=l.workStates[n];if(!c)return l;const d=c.installedEquipments.findIndex(f=>f.contractEquipment.id===r);if(d<0)return l;const u=[...c.installedEquipments];return u[d]={...u[d],...i},{...l,workStates:{...l.workStates,[n]:{...c,installedEquipments:u,lastUpdated:new Date().toISOString()}}}})},setInstalledEquipments:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,installedEquipments:r,lastUpdated:new Date().toISOString()}}}})},clearInstalledEquipments:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,installedEquipments:[],lastUpdated:new Date().toISOString()}}}:r})},setRemovalStatus:(n,r,i,l)=>{t(c=>{const d=c.workStates[n]||Wi(),u=d.removalStatus[r]||{};return{...c,workStates:{...c.workStates,[n]:{...d,removalStatus:{...d.removalStatus,[r]:{...u,[i]:l}},lastUpdated:new Date().toISOString()}}}})},toggleRemovalStatus:(n,r,i)=>{t(l=>{const c=l.workStates[n]||Wi(),d=c.removalStatus[r]||{},f=(d[i]||"0")==="1"?"0":"1";return console.log("[Equipment Store] / ",{workId:n,eqtNo:r,field:{EQT_LOSS_YN:"",PART_LOSS_BRK_YN:"/",EQT_BRK_YN:"",EQT_CABL_LOSS_YN:"",EQT_CRDL_LOSS_YN:""}[i]||i,:f==="1"?"Y":"N",:{...d,[i]:f}}),{...l,workStates:{...l.workStates,[n]:{...c,removalStatus:{...c.removalStatus,[r]:{...d,[i]:f}},lastUpdated:new Date().toISOString()}}}})},setFullRemovalStatus:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,removalStatus:r,lastUpdated:new Date().toISOString()}}}})},clearRemovalStatus:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,removalStatus:{},lastUpdated:new Date().toISOString()}}}:r})},addMarkedForRemoval:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();if(l.markedForRemoval.some(u=>u.id===r.id))return i;const d=[...l.markedForRemoval,r];return console.log("[Equipment Store]  ",{workId:n,equipment:{id:r.id,model:r.model,serialNumber:r.serialNumber,itemMidCd:r.itemMidCd},:d.length}),{...i,workStates:{...i.workStates,[n]:{...l,markedForRemoval:d,lastUpdated:new Date().toISOString()}}}})},removeMarkedForRemoval:(n,r)=>{t(i=>{const l=i.workStates[n];if(!l)return i;const c=l.markedForRemoval.find(u=>u.id===r),d=l.markedForRemoval.filter(u=>u.id!==r);return console.log("[Equipment Store]  ",{workId:n,removed:c?{id:c.id,model:c.model}:null,:d.length}),{...i,workStates:{...i.workStates,[n]:{...l,markedForRemoval:d,lastUpdated:new Date().toISOString()}}}})},setMarkedForRemoval:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return console.log("[Equipment Store]   ",{workId:n,:r.length,:r.map(c=>({id:c.id,model:c.model}))}),{...i,workStates:{...i.workStates,[n]:{...l,markedForRemoval:r,lastUpdated:new Date().toISOString()}}}})},clearMarkedForRemoval:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,markedForRemoval:[],lastUpdated:new Date().toISOString()}}}:r})},addPendingLossStatus:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi(),c=l.pendingLossStatusList.filter(d=>d.EQT_SERNO!==r.EQT_SERNO);return{...i,workStates:{...i.workStates,[n]:{...l,pendingLossStatusList:[...c,r],lastUpdated:new Date().toISOString()}}}})},setPendingLossStatusList:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,pendingLossStatusList:r,lastUpdated:new Date().toISOString()}}}})},clearPendingLossStatusList:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,pendingLossStatusList:[],lastUpdated:new Date().toISOString()}}}:r})},setReuseAll:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return console.log("[Equipment Store]   ",{workId:n,value:r?"Y":"N"}),{...i,workStates:{...i.workStates,[n]:{...l,reuseAll:r,lastUpdated:new Date().toISOString()}}}})},setSelectedContract:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,selectedContract:r}}}})},setSelectedStock:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,selectedStock:r}}}})},clearSelection:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,selectedContract:null,selectedStock:null}}}:r})},setSignalStatus:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,signalStatus:r}}}})},setSignalResult:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,signalResult:r}}}})},setDataLoaded:(n,r)=>{t(i=>{const l=i.workStates[n]||Wi();return{...i,workStates:{...i.workStates,[n]:{...l,isDataLoaded:r}}}})},getCurrentWorkState:()=>{const{currentWorkId:n,workStates:r}=e();return n&&r[n]||null},getWorkState:n=>e().workStates[n]||null}),{name:"dlive-work-equipment-storage",partialize:t=>({workStates:Object.fromEntries(Object.entries(t.workStates).map(([e,n])=>[e,{installedEquipments:n.installedEquipments,removalStatus:n.removalStatus,markedForRemoval:n.markedForRemoval,pendingLossStatusList:n.pendingLossStatusList,reuseAll:n.reuseAll,signalStatus:n.signalStatus,signalResult:n.signalResult,filteringData:n.filteringData,lastUpdated:n.lastUpdated}])),currentWorkId:t.currentWorkId}),merge:(t,e)=>{const n={...e};if(t!=null&&t.workStates){n.workStates={};for(const[r,i]of Object.entries(t.workStates))n.workStates[r]={...Wi(),...i}}return t!=null&&t.currentWorkId&&(n.currentWorkId=t.currentWorkId),n}})),Uv={workId:null,state:null,isReady:!1,contractEquipments:[],technicianEquipments:[],customerEquipments:[],removeEquipments:[],installedEquipments:[],removalStatus:{},markedForRemoval:[],pendingLossStatusList:[],selectedContract:null,selectedStock:null,signalStatus:"idle",signalResult:"",filteringData:{}},oa=t=>{const e=ji(n=>t?n.workStates[t]??null:null);return t?e?{workId:t,state:e,isReady:e.isDataLoaded??!1,contractEquipments:e.contractEquipments??[],technicianEquipments:e.technicianEquipments??[],customerEquipments:e.customerEquipments??[],removeEquipments:e.removeEquipments??[],installedEquipments:e.installedEquipments??[],removalStatus:e.removalStatus??{},markedForRemoval:e.markedForRemoval??[],pendingLossStatusList:e.pendingLossStatusList??[],selectedContract:e.selectedContract??null,selectedStock:e.selectedStock??null,signalStatus:e.signalStatus??"idle",signalResult:e.signalResult??"",filteringData:e.filteringData??{}}:{...Uv,workId:t}:Uv},od=()=>{const t=fb();return GM({mutationFn:e=>N4(e),onSuccess:e=>(t.invalidateQueries({queryKey:["workOrders"]}),console.log(" [useCompleteWork]    -    "),e),onError:e=>{console.error(" [useCompleteWork]   :",e)}})},Ry=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1,certifyReason:d})=>{var Kt,ht,qt,It;const u=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[f,m]=x.useState(""),[_,y]=x.useState(!1),g=f==="0"||f==="1"||f==="4",[N,C]=x.useState(!1),{equipmentData:v,filteringData:R}=$i(),{certifyRegconfInfo:U}=Ba(),L=t.id||"",w=oa(L),P={...v||i||R||{},installedEquipments:w.installedEquipments.length>0?w.installedEquipments:(v==null?void 0:v.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:w.markedForRemoval.length>0?w.markedForRemoval:(v==null?void 0:v.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(w.removalStatus).length>0?w.removalStatus:(v==null?void 0:v.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:G,isPending:K}=od(),B=()=>`work_complete_draft_${t.id}`,[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(""),[q,V]=x.useState(!1),[F,I]=x.useState(""),[ee,ae]=x.useState(""),[T,j]=x.useState(void 0),[k,Q]=x.useState(!1),[H,$]=x.useState(!1),[ie,fe]=x.useState(""),[pe,de]=x.useState(""),[Re,X]=x.useState(""),[_e,me]=x.useState(""),[Z,le]=x.useState(""),[se,Ee]=x.useState(""),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(""),[xe,et]=x.useState([]),[bt,it]=x.useState(!1),[At,at]=x.useState([]),[We,Dt]=x.useState(!1),[Tt,St]=x.useState(""),[ze,dt]=x.useState(!1),[Ke,rt]=x.useState([]),[ft,Ot]=x.useState(!1),[mt,Ze]=x.useState(""),[De,Ye]=x.useState(!1),[Ce,ge]=x.useState("B"),[Be,ce]=x.useState(!1),[Le,Xe]=x.useState(null),[Pe,Ct]=x.useState([]),[Me,lt]=x.useState([]),[ut,jt]=x.useState([]),[Ve,$t]=x.useState([]),[Ue,ss]=x.useState([]),[ls,ds]=x.useState(()=>{const he=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(he&&he.length>=8)return`${he.slice(0,4)}-${he.slice(4,6)}-${he.slice(6,8)}`;const be=new Date;return be.getFullYear()+"-"+String(be.getMonth()+1).padStart(2,"0")+"-"+String(be.getDate()).padStart(2,"0")});x.useEffect(()=>{if(u){console.log("[WorkCompleteInstall]   - getWorkReceiptDetail API "),(async()=>{try{const Oe=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(Oe){console.log("[WorkCompleteInstall] API :",Oe);const je=Oe.INSTL_LOC||"";if(je.includes("")){const[Te,_t]=je.split("");fe(Te),de(_t)}else fe(je),de(Oe.VIEW_MOD_CD||""),X(Oe.VIEW_MOD_NM||"");const tt=Oe.UP_CTRL_CL||(P==null?void 0:P.upCtrlCl)||"";console.log("[CompleteInstall]  :",{API:Oe.UP_CTRL_CL,:P==null?void 0:P.upCtrlCl,:tt}),Y(tt),me(Oe.PSN_USE_CORP||""),le(Oe.VOIP_USE_CORP||""),Ee(Oe.DTV_USE_CORP||""),I(Oe.NET_CL||""),ae(Oe.NET_CL_NM||""),j({NET_CL:Oe.NET_CL||"",NET_CL_NM:Oe.NET_CL_NM||"",WRNG_TP:Oe.WRNG_TP||"",INSTL_TP:Oe.INSTL_TP||"",CB_WRNG_TP:Oe.CB_WRNG_TP||"",CB_INSTL_TP:Oe.CB_INSTL_TP||"",INOUT_LINE_TP:Oe.INOUT_LINE_TP||"",INOUT_LEN:Oe.INOUT_LEN||"",DVDR_YN:Oe.DVDR_YN||"",BFR_LINE_YN:Oe.BFR_LINE_YN||"",CUT_YN:Oe.CUT_YN||"",TERM_NO:Oe.TERM_NO||"",RCV_STS:Oe.RCV_STS||"",SUBTAP_ID:Oe.SUBTAP_ID||"",PORT_NUM:Oe.PORT_NUM||"",EXTN_TP:Oe.EXTN_TP||"",TAB_LBL:Oe.TAB_LBL||"",CVT_LBL:Oe.CVT_LBL||"",STB_LBL:Oe.STB_LBL||""}),S(Oe.CUST_REL||""),J((Oe.WRK_PROC_CT||"").replace(/\\n/g,`
`)),Oe.VOIP_JOIN_CTRT_ID&&ue(Oe.VOIP_JOIN_CTRT_ID),Oe.WRKR_CMPL_DT&&Oe.WRKR_CMPL_DT.length>=8&&ds(`${Oe.WRKR_CMPL_DT.slice(0,4)}-${Oe.WRKR_CMPL_DT.slice(4,6)}-${Oe.WRKR_CMPL_DT.slice(6,8)}`)}else console.log("[WorkCompleteInstall] API  - order  "),S(t.CUST_REL||""),I(t.NET_CL||""),ae(t.NET_CL_NM||"")}catch(Oe){console.error("[WorkCompleteInstall] API  :",Oe),S(t.CUST_REL||""),I(t.NET_CL||""),ae(t.NET_CL_NM||"")}finally{C(!0)}})();return}const he=localStorage.getItem(B());if(he)try{const be=JSON.parse(he);S(be.custRel||""),Y(be.upCtrlCl||""),J(be.memo||""),me(be.internetUse||""),le(be.voipUse||""),Ee(be.dtvUse||""),I(be.networkType||""),ae(be.networkTypeName||""),j(be.installInfoData),fe(be.installLocationText||""),de(be.viewModCd||""),X(be.viewModNm||""),be.voipJoinCtrtId&&ue(be.voipJoinCtrtId)}catch(be){console.error("[WorkCompleteInstall] localStorage  :",be)}C(!0)},[t.id,u]),x.useEffect(()=>{if(!N||u)return;const he={custRel:O,upCtrlCl:A,memo:te,internetUse:_e,voipUse:Z,dtvUse:se,networkType:F,networkTypeName:ee,installInfoData:T,installLocationText:ie,viewModCd:pe,viewModNm:Re,voipJoinCtrtId:ne,savedAt:new Date().toISOString()};localStorage.setItem(B(),JSON.stringify(he))},[O,A,te,_e,Z,se,F,ee,T,ie,pe,Re,ne,N,u]),x.useEffect(()=>{(async()=>{try{const be=await Jl(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);be.CMCU005&&Ct(be.CMCU005.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM}))),be.CMCT015&&(console.log("[CompleteInstall]  CMCT015 :",be.CMCT015),lt(be.CMCT015.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM})))),be.CMCU057&&jt(be.CMCU057.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM}))),be.CMCU110&&$t(be.CMCU110.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM}))),be.CMCU148&&ss(be.CMCU148.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM})))}catch(be){console.error("[WorkCompleteInstall]    :",be)}})()},[]),x.useEffect(()=>{(async()=>{var be;if(!(!t.id||u)){y(!0);try{console.log("[CompleteInstall] OST  :",t.id);const Oe=await tx({WRK_ID:t.id,RCPT_ID:t.RCPT_ID,CUST_ID:(be=t.customer)==null?void 0:be.id});if(Oe){const je=Oe.OST_WORKABLE_STAT||"";console.log("[CompleteInstall] OST  :",je),m(je),(je==="0"||je==="1"||je==="4")&&(r==null||r("    .","warning",!0))}}catch(Oe){console.error("[CompleteInstall] OST   :",Oe)}finally{y(!1)}}})()},[t.id,t.RCPT_ID,(Kt=t.customer)==null?void 0:Kt.id,u]),x.useEffect(()=>{console.log("[CompleteInstall] OST  :",{OST_WORKABLE_STAT:f,isOstBlocked:g,isOstChecking:_,isWorkCompleted:u,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,:f==="0"?"":f==="1"?"":f==="2"?"":f==="3"?"":f==="4"?"/":f==="X"?"OST":f===""?"  ":""})},[f,g,_,u]),x.useEffect(()=>{(async()=>{try{const be=await mc(),Oe=(be==null?void 0:be.output)||be||[];rt(Oe);const je=t.PROD_CD||t.PROD_CD||"",tt=Oe.some(Te=>Te.PROD_CD===je);dt(tt),console.log("[CompleteInstall] LGHV :",{currentProdCd:je,isLghv:tt,prodListCount:Oe.length})}catch(be){console.error("[CompleteInstall] LGHV   :",be)}})()},[t.PROD_CD]),x.useEffect(()=>{(async()=>{const be=t.PROD_CD||t.PROD_CD||"",Oe=(P==null?void 0:P.prodPromoInfo)||[];if(be==="PD10018480")console.log("[CompleteInstall] OTT   :",be),Ye(!0),ge("C");else if(Oe.some(Te=>Te.PROD_CD==="PD10018160"))console.log("[CompleteInstall] OTT   : PD10018160"),Ye(!0),ge("B");else{Ye(!1);return}const je=t.id||"",tt=t.directionId||t.WRK_DRCTN_ID||"";if(je&&tt)try{const Te=await sx({WRK_ID:je,WRK_DRCTN_ID:tt,DATA_TYPE:be==="PD10018480"?"C":"B"});Te!=null&&Te.EQT_SERNO&&(console.log("[CompleteInstall]  OTT :",Te.EQT_SERNO),Ze(Te.EQT_SERNO))}catch(Te){console.error("[CompleteInstall] OTT   :",Te)}})()},[t.PROD_CD,t.id,t.directionId,P==null?void 0:P.prodPromoInfo]),x.useEffect(()=>{P!=null&&P.upCtrlCl&&!A?(console.log("[CompleteInstall] equipmentData  :",P.upCtrlCl),Y(P.upCtrlCl)):!A&&N&&!u&&(console.log("[CompleteInstall]   : 01 ()"),Y("01"))},[P==null?void 0:P.upCtrlCl,N,u,A]),x.useEffect(()=>{var Oe,je;if(u)return;const he=((Oe=t.customer)==null?void 0:Oe.id)||t.CUST_ID||t.customerId;if(console.log("[WorkCompleteInstall] CUST_ID :",{"order.customer?.id":(je=t.customer)==null?void 0:je.id,"order.CUST_ID":t.CUST_ID,"order.customerId":t.customerId,custId:he}),!he){console.log("[WorkCompleteInstall] CUST_ID  -    ");return}(async()=>{try{console.log("[WorkCompleteInstall]     :",he);const tt=await If({CUST_ID:he});console.log("[WorkCompleteInstall]   :",tt),at(tt||[])}catch(tt){console.error("[WorkCompleteInstall]     :",tt),at([])}})()},[(ht=t.customer)==null?void 0:ht.id,t.CUST_ID,u]),x.useEffect(()=>{if(u)return;if(At.length===0){console.log("[WorkCompleteInstall]     ...");return}const he=t.PROD_GRP||"",be=t.VOIP_PROD_CD||"",Oe=t.ISP_PROD_CD||"",je=t.WRK_STAT_CD||"",tt=t.ADDR_ORD||"";if(console.log("[WorkCompleteInstall]   :",{prodGrp:he,voipProdCd:be,ispProdCd:Oe,wrkStatCd:je,addrOrd:tt,customerCtrtListCount:At.length}),he==="V"&&!be){const Te=At.filter(Qe=>{const yt=Qe.PROD_GRP||"",vt=Qe.CTRT_STAT||"",$e=Qe.ADDR_ORD||Qe.addr_ord||"";return(yt==="C"||yt==="D"||yt==="I")&&vt==="20"&&(!tt||$e===tt)});console.log("[WorkCompleteInstall] VoIP   :",Te),Te.length<1&&je==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const _t=[{value:"",label:""},...Te.map(Qe=>({value:Qe.CTRT_ID||"",label:`[${Qe.CTRT_ID}] ${Qe.BASIC_PROD_CD_NM||Qe.PROD_NM||""}`}))];et(_t),it(!0);return}if(he==="I"&&Oe){const Te=At.filter(Qe=>{const yt=Qe.PROD_GRP||"",vt=Qe.CTRT_STAT||"",$e=Qe.ADDR_ORD||Qe.addr_ord||"",ot=Qe.ISP_JOIN_ID||"",wt=Qe.KPI_PROD_GRP_CD||"";return(yt==="D"||yt==="C")&&vt==="20"&&!ot&&wt==="D"&&(!tt||$e===tt)});console.log("[WorkCompleteInstall] ISP   :",Te),Te.length<1&&je==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const _t=[{value:"",label:""},...Te.map(Qe=>({value:Qe.CTRT_ID||"",label:`[${Qe.CTRT_ID}] ${Qe.BASIC_PROD_CD_NM||Qe.PROD_NM||""}`}))];et(_t),it(!0);return}it(!1),et([])},[t.id,t.WRK_STAT_CD,u,r,At]);const Ss=()=>{const he=[];(!O||O==="[]")&&he.push("  ."),T!=null&&T.NET_CL||he.push(" ."),!t.installLocation&&!ie&&he.push(" ."),ls||he.push(" .");const be=t.PROD_GRP||"",Oe=t.VOIP_PROD_CD||"",je=t.ISP_PROD_CD||"";be==="V"&&!Oe&&bt&&(ne||he.push("VOIP    .")),be==="I"&&je&&bt&&(ne||he.push("  ISP .    ."));const tt=(P==null?void 0:P.installedEquipments)||[];return be!=="V"&&tt.length<1&&he.push("()  ."),De&&!mt&&he.push("OTT   OTT BOX   ."),he},Ns=he=>{j(he),he.NET_CL&&I(he.NET_CL),he.NET_CL_NM&&ae(he.NET_CL_NM),r==null||r("  .","success")},ke=()=>{if(K)return;if(g){r==null||r("    .","warning");return}const he=Ss();if(he.length>0){he.forEach(Oe=>r==null?void 0:r(Oe,"error"));return}(t.PROD_GRP||"")!=="V"?ce(!0):(St(" ?"),Dt(!0))},ct=he=>{Xe(he),ce(!1),St(" ?"),Dt(!0)},st=async()=>{var $e,ot,wt,Bt;console.log("[WorkCompleteInstall]   ");const he=ls.replace(/-/g,""),be=localStorage.getItem("userInfo"),Oe=be?JSON.parse(be):{},je=Oe.userId||"A20130708",tt=c||Mh(t.OP_LNKD_CD);let Te="";if(tt){let Yt=(P==null?void 0:P.prodPromoInfo)||[];if(Yt.length===0)try{console.log("[CompleteInstall] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),Yt=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"01"}),console.log("[CompleteInstall] getProdPromotionInfo fallback :",Yt.length,"")}catch(ts){console.log("[CompleteInstall] getProdPromotionInfo fallback :",ts)}const Xt=Yt.filter(ts=>(ts.PROD_CMPS_CL==="21"||ts.PROD_CMPS_CL==="22")&&ts.PROD_STAT_CD==="10").map(ts=>ts.PROD_CD).filter(ts=>ts);Te=Xt.join(","),console.log("[CompleteInstall] ADD_ON :",Te,"(",Xt.length," )")}const _t=(P==null?void 0:P.installedEquipments)||[];if(tt&&_t.length>0&&!U){r==null||r("  .","error");return}if(tt&&U)try{const Yt=await yg({order:t,workerId:je,certifyRegconfInfo:U,addOnParam:Te,reason:d||""});if(!Yt.success){r==null||r(` : ${Yt.message}`,"error");return}console.log("[CompleteInstall] CL-04    ")}catch(Yt){console.error("[CompleteInstall] CL-04  :",Yt),r==null||r(`  : ${Yt.message||"   "}`,"error");return}const Qe=async()=>{var ys,Ps;const Yt=(P==null?void 0:P.installedEquipments)||[],Xt=!!t.ISP_PROD_CD;let ts=!1;const Ut=(P==null?void 0:P.customerEquipments)||Yt;for(const ps of Ut){const vs=ps.actualEquipment||ps,Ms=vs.eqtClCd||vs.EQT_CL_CD||"";if(Ms==="090901"||Ms==="091001"||Ms==="091005")continue;(vs.EQT_KND||vs.eqtKnd||"WRKER")==="WRKER"&&(ts=!0)}if(Ut.some(ps=>{const vs=ps.actualEquipment||ps;return(vs.itemMidCd||vs.ITEM_MID_CD)==="23"})&&(ts=!1),Xt&&(ts=!0),await bg(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD)&&(ts=!1),ts&&(Yt.length>0||Xt))try{const ps=t.PROD_GRP||"";let vs="SMR03",Ms="",cs="",ms="",Ks="",Ls="",nt="";ze&&(vs="STB_CRT"),ps==="V"&&(vs="SMR60");let Ft=(P==null?void 0:P.prodPromoInfo)||[];if(Ft.length===0)try{Ft=await dl({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:je,PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"01",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||"",WRK_CD:t.WRK_CD||"01",WRK_STAT_CD:t.WRK_STAT_CD||""})}catch(Is){console.log("[CompleteInstall] prodPromoInfo  :",Is)}const Cs=((ys=Ft.find(Is=>Is.PROD_CMPS_CL==="23"))==null?void 0:ys.PROD_CMPS_ID)||"",Ht=Ft.find(Is=>Is.PROD_CMPS_CL==="11"),Os=(Ht==null?void 0:Ht.PROD_CD)||"",Zt=(Ht==null?void 0:Ht.PROD_GRP)||ps,Ds=Ft.filter(Is=>Is.BASIC_PROD_FL==="V").map(Is=>Is.PROD_CD),js=Ds.length>0?Ds.join(","):"",hs=Is=>{const _s=Yt.find(Ir=>{const qr=Ir.actualEquipment||Ir;return(qr.itemMidCd||qr.ITEM_MID_CD)===Is});if(!_s)return"";const Lr=_s.actualEquipment||_s;return Lr.id||Lr.EQT_NO||""};t.VOIP_PROD_CD?(Ms=hs("08"),cs=hs("02")):(Ms=hs("05")||hs("01")||hs("03")||(Zt==="I"?hs("02"):"")||hs("08")||"",cs=hs("04"),!cs&&Zt==="A"&&(cs=(T==null?void 0:T.NET_CL)||"")),ms=hs("07"),Zt==="C"&&(Ks=hs("02")),Zt==="V"&&(Ls=hs("10")),Xt&&(Ls=hs("21")),(ps==="V"||Xt)&&(nt=ne||t.CTRT_ID||"");let Us=t.id||"";for(const Is of Yt){const _s=Is.actualEquipment||Is,Lr=_s.eqtClCd||_s.EQT_CL_CD||"";if(Lr==="091003"||Lr==="091004"){Us=_s.id||_s.EQT_NO||t.id||"";break}if(Lr==="092201"){Us=_s.macAddress||_s.MAC_ADDRESS||_s.id||_s.EQT_NO||t.id||"";break}}console.log("[CompleteInstall]   :",{msgId:vs,eqtNo:Ms,prodCd:Os,subProdCd:js,etc1:cs,etc2:ms,etc3:Ks,etc4:Ls});const Qs=await la({MSG_ID:vs,CUST_ID:((Ps=t.customer)==null?void 0:Ps.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ms,EQT_PROD_CMPS_ID:Cs,PROD_CD:Os,ITV_USR_ID:"",IP_CNT:"",ETC_1:cs,ETC_2:ms,ETC_3:Ks,ETC_4:Ls,SUB_PROD_CD:js,IF_DTL_ID:"",WRK_ID:Us,REG_UID:je,VOIP_JOIN_CTRT_ID:nt,WTIME:"3"});Qs.code!=="SUCCESS"&&Qs.code!=="OK"?console.warn("[CompleteInstall]    :",Qs.message):console.log("[CompleteInstall]    ")}catch(ps){console.log("[CompleteInstall]      (  ):",ps)}},yt=(Yt,Xt=!1)=>{if(!Yt||Yt.length===0)return[];const ts=(P==null?void 0:P.removalStatus)||{};return Yt.map(Ut=>{var ps,vs,Ms;const Es=Ut.EQT_NO||Ut.id||((ps=Ut.actualEquipment)==null?void 0:ps.id)||"",ys=ts[Es]||{},Ps=Xt?{CRR_TSK_CL:t.WRK_CD||"01",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Oe.crrId||"01",WRKR_ID:je,EQT_LOSS_YN:ys.isLost?"1":"0",EQT_BRK_YN:ys.isDamaged?"1":"0",REUSE_YN:ys.isReusable?"1":"0"}:{};if(Ut.actualEquipment){const cs=Ut.actualEquipment,ms=Ut.contractEquipment||{};return{...cs,EQT_NO:cs.id,EQT_SERNO:cs.serialNumber,ITEM_MID_CD:cs.itemMidCd,EQT_CL_CD:cs.eqtClCd,MAC_ADDRESS:Ut.macAddress||cs.macAddress,WRK_ID:t.id,CUST_ID:(vs=t.customer)==null?void 0:vs.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:ms.id||ms.SVC_CMPS_ID||cs.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:cs.BASIC_PROD_CMPS_ID||ms.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:cs.EQT_PROD_CMPS_ID||ms.id,PROD_CD:cs.PROD_CD||ms.PROD_CD||t.PROD_CD||"",SVC_CD:cs.SVC_CD||ms.SVC_CD||"",EQT_SALE_AMT:cs.EQT_SALE_AMT||"0",MST_SO_ID:cs.MST_SO_ID||t.SO_ID||"",SO_ID:cs.SO_ID||t.SO_ID||"",REG_UID:je,CHG_UID:je,OLD_LENT_YN:cs.OLD_LENT_YN||"N",LENT:cs.LENT||"10",LENT_KND:cs.LENT_KND||"",ITLLMT_PRD:cs.ITLLMT_PRD||"00",EQT_USE_STAT_CD:cs.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:cs.IF_DTL_ID||"",...Ps}}return{...Ut,EQT_NO:Ut.EQT_NO||Ut.id||"",EQT_SERNO:Ut.EQT_SERNO||Ut.serialNumber||"",ITEM_MID_CD:Ut.ITEM_MID_CD||Ut.itemMidCd||"",EQT_CL_CD:Ut.EQT_CL_CD||Ut.eqtClCd||"",MAC_ADDRESS:Ut.MAC_ADDRESS||Ut.macAddress||"",SVC_CMPS_ID:Ut.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Ut.BASIC_PROD_CMPS_ID||"",PROD_CD:Ut.PROD_CD||"",SVC_CD:Ut.SVC_CD||"",WRK_ID:Ut.WRK_ID||t.id,CUST_ID:Ut.CUST_ID||((Ms=t.customer)==null?void 0:Ms.id),CTRT_ID:Ut.CTRT_ID||t.CTRT_ID,WRK_CD:Ut.WRK_CD||t.WRK_CD,REG_UID:je,CHG_UID:je,LENT_KND:Ut.LENT_KND||"",...Ps}})},vt={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:($e=t.customer)==null?void 0:$e.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||Oe.crrId||"01",WRKR_ID:je,WRKR_CMPL_DT:he,MEMO:te||" ",STTL_YN:"Y",REG_UID:je,CUST_REL:O,CNFM_CUST_NM:(ot=t.customer)==null?void 0:ot.name,CNFM_CUST_TELNO:((wt=t.customer)==null?void 0:wt.contactNumber)||"",REQ_CUST_TEL_NO:((Bt=t.customer)==null?void 0:Bt.contactNumber)||"",INSTL_LOC:t.installLocation||ie||"",UP_CTRL_CL:A||"",PSN_USE_CORP:_e||"",VOIP_USE_CORP:Z||"",DTV_USE_CORP:se||"",WRK_ACT_CL:"20",NET_CL:(T==null?void 0:T.NET_CL)||"",WRNG_TP:(T==null?void 0:T.WRNG_TP)||"",INSTL_TP:(T==null?void 0:T.INSTL_TP)||"",CB_WRNG_TP:(T==null?void 0:T.CB_WRNG_TP)||"",CB_INSTL_TP:(T==null?void 0:T.CB_INSTL_TP)||"",INOUT_LINE_TP:(T==null?void 0:T.INOUT_LINE_TP)||"",INOUT_LEN:(T==null?void 0:T.INOUT_LEN)||"",DVDR_YN:(T==null?void 0:T.DVDR_YN)||"",BFR_LINE_YN:(T==null?void 0:T.BFR_LINE_YN)||"",CUT_YN:(T==null?void 0:T.CUT_YN)||"",TERM_NO:(T==null?void 0:T.TERM_NO)||"",RCV_STS:(T==null?void 0:T.RCV_STS)||"",SUBTAP_ID:(T==null?void 0:T.SUBTAP_ID)||"",PORT_NUM:(T==null?void 0:T.PORT_NUM)||"",EXTN_TP:(T==null?void 0:T.EXTN_TP)||"",TAB_LBL:(T==null?void 0:T.TAB_LBL)||"",CVT_LBL:(T==null?void 0:T.CVT_LBL)||"",STB_LBL:(T==null?void 0:T.STB_LBL)||"",KPI_PROD_GRP:"",OBS_RCPT_CD:"",OBS_RCPT_DTL_CD:"",VOIP_JOIN_CTRT_ID:ne||"",AGREE_YN:"",ISP_YN:"",AGREE_GB:"",CUST_CLEAN_YN:"",EQT_RMV_FLAG:"",TV_TYPE:"",ADD_ON:Te||""},equipmentList:yt((P==null?void 0:P.installedEquipments)||[],!1),removeEquipmentList:yt((P==null?void 0:P.removedEquipments)||[],!0),spendItemList:(P==null?void 0:P.spendItems)||[],agreementList:(P==null?void 0:P.agreements)||[],poleList:Le?[{WRK_ID:t.id,POLE_YN:Le.POLE_YN,LAN_GB:Le.LAN_GB||"",REG_UID:je}]:[]};G(vt,{onSuccess:Yt=>{Yt.code==="SUCCESS"||Yt.code==="OK"?(localStorage.removeItem(B()),t.WRK_STAT_CD="3",Qe(),r==null||r("  .","success"),n()):r==null||r(Yt.message||"   .","error",!0)},onError:Yt=>{r==null||r(Yt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[K&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",bt&&!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),bt?s.jsx(Zs,{value:ne,onValueChange:ue,options:xe,placeholder:" ",required:!0,disabled:u}):s.jsx("input",{type:"text",value:"",readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:ee||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>V(!0),className:`min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:u?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:O,onValueChange:S,options:Pe,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-xs sm:text-sm",children:[s.jsx("span",{className:"truncate",children:ie||t.installLocation||""}),Re&&s.jsxs("span",{className:"ml-1 sm:ml-2 text-xs sm:text-sm text-gray-500 flex-shrink-0 whitespace-nowrap",children:["(: ",Re,")"]})]}),s.jsxs("button",{type:"button",onClick:()=>$(!0),className:`min-h-10 sm:min-h-12 px-3 sm:px-4 rounded-lg font-bold transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm flex-shrink-0 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:[s.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{children:u?"":""})]})]})]}),((P==null?void 0:P.kpiProdGrpCd)==="D"||(P==null?void 0:P.prodGrp)==="D"||t.PROD_GRP==="D"||(t.PROD_NM||"").includes("DTV"))&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx(Zs,{value:A,onValueChange:Y,options:Me,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:te,onChange:he=>J(he.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${u?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:u,disabled:u}),!u&&s.jsxs("p",{className:`text-xs text-right mt-1 ${te.length>=500?"text-red-500":"text-gray-400"}`,children:[te.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:ls,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>ye(!Ne),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${Ne?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Ne&&s.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"DTV ()"}),s.jsx(Zs,{value:se,onValueChange:Ee,options:Ue,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"ISP ()"}),s.jsx(Zs,{value:_e,onValueChange:me,options:ut,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"VoIP (VoIP)"}),s.jsx(Zs,{value:Z,onValueChange:le,options:Ve,placeholder:"",disabled:u})]})]})]}),De&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["OTT BOX  ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:mt,readOnly:!0,placeholder:"SER_NO   ",className:"flex-1 px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600"}),s.jsxs("button",{type:"button",onClick:()=>Ot(!0),disabled:u,className:`px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 ${u?"bg-gray-400 text-white cursor-not-allowed":mt?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"SER_NO"]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!u&&s.jsx("button",{onClick:ke,disabled:K||_||g,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${K||_||g?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:K?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>Q(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:q,onClose:()=>V(!1),onSave:Ns,workId:t.id,initialData:T,workType:t.WRK_CD,customerId:t.customer.id,customerName:t.customer.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(P==null?void 0:P.kpiProdGrpCd)||(P==null?void 0:P.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(P==null?void 0:P.prodChgGb)||(P==null?void 0:P.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(P==null?void 0:P.chgKpiProdGrpCd)||(P==null?void 0:P.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(P==null?void 0:P.prodGrp)||(P==null?void 0:P.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:u}),s.jsx(Wa,{isOpen:k,onClose:()=>Q(!1),ctrtId:t.CTRT_ID,custId:t.customer.id}),s.jsx(Of,{isOpen:H,onClose:()=>$(!1),onSave:he=>{fe(he.INSTL_LOC),de(he.VIEW_MOD_CD),X(he.VIEW_MOD_NM),$(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(P==null?void 0:P.prodGrp)||(P==null?void 0:P.PROD_GRP),initialInstlLoc:ie||t.installLocation,initialViewModCd:pe,initialViewModNm:Re,showToast:r,readOnly:u}),s.jsx(ul,{isOpen:We,onClose:()=>Dt(!1),onConfirm:st,title:" ",message:Tt,type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{workType:"01",workTypeName:"",custRel:O,custRelName:(qt=Pe.find(he=>he.value===O))==null?void 0:qt.label,networkType:F,networkTypeName:ee,upCtrlCl:A,upCtrlClName:(It=Me.find(he=>he.value===A))==null?void 0:It.label,installedEquipments:(P==null?void 0:P.installedEquipments)||[],removedEquipments:(P==null?void 0:P.removedEquipments)||[],installLocation:ie?{position:ie}:void 0,memo:te})}),s.jsx(Ng,{isOpen:Be,onClose:()=>ce(!1),onSave:ct,soId:t.SO_ID||""}),s.jsx(vb,{isOpen:ft,onClose:()=>Ot(!1),onSave:he=>{Ze(he),r==null||r("OTT  .","success")},wrkId:t.id||"",wrkDrctnId:t.directionId||t.WRK_DRCTN_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",dataType:Ce,showToast:r,readOnly:u})]})},Db=({custId:t,rcptId:e,ctrtId:n,soId:r,termHopeDt:i,wrkCd:l,wrkStatCd:c,showToast:d,onHotbillConfirmChange:u,onSimulatingChange:f,readOnly:m=!1})=>{const[_,y]=x.useState(null),[g,N]=x.useState(!0),[C,v]=x.useState(!1),[R,U]=x.useState(null),[L,w]=x.useState([]),[P,G]=x.useState(0),[K,B]=x.useState(!1),[O,S]=x.useState(!1),[A,Y]=x.useState(!1),[te,J]=x.useState(!1),[q,V]=x.useState(!1),[F,I]=x.useState(!1),[ee,ae]=x.useState(!1),T=l==="02"&&c!=="7",j=()=>{const fe=new Date;return fe.getFullYear().toString()+String(fe.getMonth()+1).padStart(2,"0")+String(fe.getDate()).padStart(2,"0")},k=fe=>{if(!fe)return"-";const pe=fe.replace(/-/g,"");return pe.length>=8?`${pe.slice(0,4)}-${pe.slice(4,6)}-${pe.slice(6,8)}`:fe},Q=fe=>fe.toLocaleString("ko-KR"),H=async()=>{if(!t||!e){N(!1);return}N(!0),U(null);try{const fe=await Tv(t,e);y(fe);const pe=fe&&fe.details&&fe.details.length>0;if(B(pe),pe&&fe.details.length>0){const X=fe.details[0],_e=X.BILL_SEQ_NO||"",me=X.PROD_GRP||"",Z=X.SO_ID||r||"",le=X.CTRT_ID||n||"",se=X.CLC_WRK_CL||"4";if(console.log("[HotbillSection] Step 2 -   :",{billSeqNo:_e,prodGrp:me,detailSoId:Z,clcWrkCl:se,rcptId:e}),_e&&me&&Z&&e)try{const Ee=await Ev(_e,me,Z,se,e);console.log("[HotbillSection]   :",Ee);let Ne="",ye=le;if(Ee.length>0){const ne=Ee.find(ue=>ue.CTRT_ID===le);ne?(Ne=ne.CLC_WRK_NO,ye=ne.CTRT_ID):(Ne=Ee[0].CLC_WRK_NO,ye=Ee[0].CTRT_ID||le)}if(console.log("[HotbillSection] Step 3 -   :",{billSeqNo:_e,clcWrkNo:Ne,targetCtrtId:ye}),_e&&Ne&&ye){const ne=await jv(_e,Ne,ye);console.log("[HotbillSection] ==========    =========="),console.log("[HotbillSection]  :",ne.length),ne.forEach((et,bt)=>{console.log(`[HotbillSection] [${bt}] CHRG_ITEM_NM: ${et.CHRG_ITEM_NM}, BILL_AMT: ${et.BILL_AMT}, REQ_YN: ${et.REQ_YN}, SORT_SEQ: ${et.SORT_SEQ}`)});const ue=ne.filter(et=>et.BILL_AMT>0||et.REQ_YN==="Y").sort((et,bt)=>parseInt(et.SORT_SEQ||"0")-parseInt(bt.SORT_SEQ||"0"));console.log("[HotbillSection] ==========    (BILL_AMT > 0 OR REQ_YN = Y) =========="),console.log("[HotbillSection]   :",ue.length),ue.forEach((et,bt)=>{console.log(`[HotbillSection] [${bt}] CHRG_ITEM_NM: ${et.CHRG_ITEM_NM}, BILL_AMT: ${et.BILL_AMT}, REQ_YN: ${et.REQ_YN}, SORT_SEQ: ${et.SORT_SEQ}`)}),w(ue);const xe=ue.reduce((et,bt)=>et+bt.BILL_AMT,0);console.log("[HotbillSection] :",xe),G(xe)}}catch(Ee){console.warn("[HotbillSection]    ():",Ee)}}const de=j(),Re=(i||"").replace(/-/g,"");!pe||Re>de?S(!0):S(!1)}catch(fe){console.error("[HotbillSection]  :",fe),U("  "),B(!1),S(!0)}finally{N(!1)}},$=async()=>{if(!t||!n||!r){d==null||d("    ","error");return}const fe=j();v(!0),f==null||f(!0),U(null);try{const pe=await L4({CUST_ID:t,CTRT_ID:n,SO_ID:r,HOPE_DT:fe,CLC_WRK_CL:"2",PNTY_EXMP_YN:"N"});if(pe.code==="SUCCESS"||pe.code==="OK"){d==null||d("  .","success"),Y(!0);const de=pe.RCPT_ID||e,Re=await Tv(t,de);y(Re);const X=Re&&Re.details&&Re.details.length>0;if(B(X),X&&Re.details.length>0){const _e=Re.details[0],me=_e.BILL_SEQ_NO||"",Z=_e.PROD_GRP||"",le=_e.SO_ID||r||"",se=_e.CTRT_ID||n||"";if(me&&Z&&le&&e)try{const Ee=await Ev(me,Z,le,"4",e);let Ne="",ye=se;if(Ee.length>0){const ne=Ee.find(ue=>ue.CTRT_ID===se);ne?(Ne=ne.CLC_WRK_NO,ye=ne.CTRT_ID):(Ne=Ee[0].CLC_WRK_NO,ye=Ee[0].CTRT_ID||se)}if(me&&Ne&&ye){const ue=(await jv(me,Ne,ye)).filter(et=>et.BILL_AMT>0||et.REQ_YN==="Y").sort((et,bt)=>parseInt(et.SORT_SEQ||"0")-parseInt(bt.SORT_SEQ||"0"));w(ue);const xe=ue.reduce((et,bt)=>et+bt.BILL_AMT,0);G(xe)}}catch(Ee){console.warn("[HotbillSection]    ():",Ee)}}}else U(pe.message||"  "),d==null||d(pe.message||"  ","error",!0)}catch(pe){console.error("[HotbillSection]  :",pe),U(pe.message||"    "),d==null||d(pe.message||"    ","error",!0)}finally{v(!1),f==null||f(!1)}};if(x.useEffect(()=>{T&&t?H():N(!1)},[t,e,T]),x.useEffect(()=>{if(!T){u==null||u(!0);return}let fe=!1;O?fe=q||F:fe=te,u==null||u(fe)},[T,O,te,q,F]),!T)return null;const ie=_&&_.details&&_.details.length>0;return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 sm:px-4 py-2.5 sm:py-3 flex items-center bg-orange-50",children:s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-xs sm:text-sm font-bold text-orange-800",children:""})]})}),s.jsxs("div",{className:"p-2.5 sm:p-3 space-y-2.5 sm:space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5 sm:p-3",children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-semibold text-gray-900",children:k(i)})]}),g&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-5 sm:py-6 gap-1.5 sm:gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-blue-600"}),s.jsx("div",{className:"text-gray-500 text-[0.625rem] sm:text-xs",children:"   ..."})]}),!g&&R&&s.jsx("div",{className:"flex items-center justify-center py-3 sm:py-4 px-3 sm:px-4",children:s.jsx("div",{className:"text-red-500 text-[0.625rem] sm:text-xs text-center",children:R})}),!g&&!R&&s.jsxs(s.Fragment,{children:[ie&&s.jsxs("div",{className:"space-y-2.5 sm:space-y-3",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"grid grid-cols-12 bg-gray-100 border-b border-gray-200",children:[s.jsx("div",{className:"col-span-8 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-semibold text-gray-700 text-center",children:""}),s.jsx("div",{className:"col-span-4 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-semibold text-gray-700 text-center",children:""})]}),s.jsx("div",{className:"divide-y divide-gray-100 max-h-40 sm:max-h-48 overflow-y-auto",children:L.length>0?L.map((fe,pe)=>s.jsxs("div",{className:`grid grid-cols-12 ${pe%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("div",{className:"col-span-8 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs text-gray-900",children:fe.CHRG_ITEM_NM||"-"}),s.jsx("div",{className:"col-span-4 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-medium text-gray-900 text-right",children:Q(fe.BILL_AMT)})]},pe)):_.details.map((fe,pe)=>s.jsxs("div",{className:`grid grid-cols-12 ${pe%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("div",{className:"col-span-8 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs text-gray-900",children:fe.CHRG_ITM_NM||fe.CHG_NM||"-"}),s.jsx("div",{className:"col-span-4 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-medium text-gray-900 text-right",children:Q(fe.BILL_AMT)})]},pe))})]}),s.jsx("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-2.5 sm:p-3",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5 sm:gap-2",children:[s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-800 whitespace-nowrap",children:":"}),s.jsxs("span",{className:"text-base sm:text-lg font-bold text-blue-700",children:[Q(P>0?P:_.refundAmount||_.totalAmount),""]})]})})]}),!ie&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 py-2.5 sm:py-3 px-2.5 sm:px-3 bg-amber-50 rounded-lg border border-amber-200",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-amber-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs sm:text-sm text-amber-800",children:"  "})]}),s.jsx("div",{className:"space-y-2",children:O?s.jsxs(s.Fragment,{children:[(()=>{const fe=j();return(i||"").replace(/-/g,"")>fe?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 py-2 px-2.5 sm:px-3 bg-red-50 rounded-lg border border-red-200",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs sm:text-sm text-red-800 font-medium",children:"  ."})]}),s.jsxs("button",{type:"button",onClick:()=>{m||(ae(!ee),ee&&V(!1))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":ee?"bg-amber-50 border-amber-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${ee?"bg-amber-500 border-amber-500":"bg-white border-gray-400"}`,children:ee&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":ee?"text-amber-700":"text-gray-700"}`,children:"  "})]}),ee&&!m&&s.jsx("div",{className:"space-y-2",children:A?s.jsxs("button",{type:"button",onClick:()=>{m||(V(!q),q||I(!1))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":q?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${q?"bg-green-500 border-green-500":"bg-white border-gray-400"}`,children:q&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":q?"text-green-700":"text-gray-700"}`,children:"  "})]}):s.jsx("button",{type:"button",onClick:$,disabled:C||m,className:"w-full py-3 bg-amber-600 hover:bg-amber-700 disabled:bg-gray-400 text-white text-sm font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:C?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:" "})]})})})]}):s.jsx("div",{className:"space-y-2",children:!A&&!m?s.jsx("button",{type:"button",onClick:$,disabled:C||m,className:"w-full py-3 bg-amber-600 hover:bg-amber-700 disabled:bg-gray-400 text-white text-sm font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:C?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:" "})]})}):A?s.jsxs("button",{type:"button",onClick:()=>{m||(V(!q),q||I(!1))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":q?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${q?"bg-green-500 border-green-500":"bg-white border-gray-400"}`,children:q&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":q?"text-green-700":"text-gray-700"}`,children:"  "})]}):null})})(),s.jsxs("button",{type:"button",onClick:()=>{m||(I(!F),F||(V(!1),ae(!1)))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":F?"bg-gray-100 border-gray-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${F?"bg-gray-500 border-gray-500":"bg-white border-gray-400"}`,children:F&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":F?"text-gray-700":"text-gray-600"}`,children:"  "})]})]}):s.jsxs("button",{type:"button",onClick:()=>!m&&J(!te),disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":te?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${te?"bg-green-500 border-green-500":"bg-white border-gray-400"}`,children:te&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":te?"text-green-700":"text-gray-700"}`,children:" "})]})})]})]})]})},O3={1:"",2:"1:1",3:"",4:""},M3={4:"",1:""},L3={5:"",6:"21",7:""},v5=({onComplete:t,onAssignAS:e,showToast:n,disabled:r=!1,savedData:i,onReset:l})=>{const[c,d]=x.useState(""),[u,f]=x.useState("4"),[m,_]=x.useState(""),[y,g]=x.useState(!1);x.useEffect(()=>{i&&(d(i.REMOVE_LINE_TP||""),f(i.REMOVE_GB||"4"),_(i.REMOVE_STAT||""),g(!1))},[i]);const N=[{value:"1",label:""},{value:"2",label:"1:1"},{value:"3",label:""},{value:"4",label:""}],C=[{value:"4",label:""},{value:"1",label:""}],v=[{value:"5",label:""},{value:"6",label:"21"},{value:"7",label:""}],R=B=>{d(B),f("4"),_("")},U=B=>{f(B),B==="4"&&_("")},L=()=>{if(!c){n==null||n("  ","warning");return}if(!u){n==null||n(" ","warning");return}const B={REMOVE_LINE_TP:c,REMOVE_GB:u,REMOVE_STAT:m};g(!1),t(B)},w=()=>{if(!c){n==null||n("  ","warning");return}if(!u){n==null||n(" ","warning");return}if(u==="1"&&!m){n==null||n("  ","warning");return}const B={REMOVE_LINE_TP:c,REMOVE_GB:u,REMOVE_STAT:m};g(!1),e(B)},P=()=>{g(!0),l==null||l()};if(r)return null;const G=i&&!y,K=(i==null?void 0:i.REMOVE_GB)==="1";return s.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden ${G?K?"border-orange-300":"border-green-300":"border-gray-200"}`,id:"removal-line-section",children:[s.jsx("div",{className:`w-full px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between ${G?K?"bg-orange-50":"bg-green-50":"bg-teal-50"}`,children:s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 ${G?K?"text-orange-600":"text-green-600":"text-teal-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("span",{className:`text-xs sm:text-sm font-bold ${G?K?"text-orange-800":"text-green-800":"text-teal-800"}`,children:" "}),G&&(K?s.jsx("span",{className:"ml-1 inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-orange-500 text-white text-xs font-bold",children:"AS"}):s.jsxs("span",{className:"ml-1 inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-green-500 text-white text-xs font-bold",children:[s.jsx(Vi,{className:"w-3 h-3"}),""]}))]})}),G&&i&&s.jsx("div",{className:"p-3 sm:p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"font-semibold text-gray-900",children:O3[i.REMOVE_LINE_TP]||i.REMOVE_LINE_TP})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:`font-semibold ${i.REMOVE_GB==="4"?"text-blue-600":"text-red-600"}`,children:M3[i.REMOVE_GB]||i.REMOVE_GB}),i.REMOVE_GB==="1"&&i.REMOVE_STAT&&s.jsxs("span",{className:"text-yellow-600 font-medium",children:["(",L3[i.REMOVE_STAT]||i.REMOVE_STAT,")"]})]})]}),s.jsxs("button",{type:"button",onClick:P,className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(Ei,{className:"w-4 h-4"}),""]})]})}),!G&&s.jsxs("div",{className:"p-2.5 sm:p-3 space-y-3 sm:space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:""}),s.jsx("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2",children:N.map(B=>s.jsx("button",{type:"button",onClick:()=>R(B.value),className:`min-h-10 sm:min-h-12 py-2 sm:py-3 px-3 sm:px-4 rounded-lg font-medium text-xs sm:text-sm transition-colors border-2 ${c===B.value?"bg-green-100 border-green-500 text-green-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:B.label},B.value))})]}),c&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:""}),s.jsx("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2",children:C.map(B=>s.jsx("button",{type:"button",onClick:()=>U(B.value),className:`min-h-10 sm:min-h-12 py-2 sm:py-3 px-3 sm:px-4 rounded-lg font-bold text-sm sm:text-base transition-colors border-2 ${u===B.value?B.value==="4"?"bg-blue-100 border-blue-500 text-blue-700":"bg-red-100 border-red-500 text-red-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:B.label},B.value))})]}),c&&u==="1"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-3 gap-1.5 sm:gap-2",children:v.map(B=>s.jsx("button",{type:"button",onClick:()=>_(B.value),className:`min-h-10 sm:min-h-12 py-2 sm:py-3 px-1.5 sm:px-2 rounded-lg font-bold text-xs sm:text-sm transition-colors border-2 ${m===B.value?"bg-yellow-100 border-yellow-500 text-yellow-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:B.label},B.value))})]}),c&&s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-1.5 sm:pt-2",children:[s.jsx("button",{type:"button",onClick:L,disabled:!c||!u||u==="1",className:`flex-1 min-h-12 py-2 sm:py-3 rounded-lg font-bold text-sm sm:text-base transition-colors ${c&&u==="4"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:""}),s.jsx("button",{type:"button",onClick:w,disabled:!c||u!=="1"||!m,className:`flex-1 min-h-12 py-2 sm:py-3 rounded-lg font-bold text-sm sm:text-base transition-colors ${c&&u==="1"&&m?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"AS"})]})]})]})},w3={5:"JHA",6:"JHB",7:"JHC"},D5=({isOpen:t,onClose:e,onSave:n,removalLineData:r,custId:i,custNm:l,addrOrd:c,address:d,showToast:u,addressInfo:f})=>{const[m,_]=x.useState(""),[y,g]=x.useState("10"),[N,C]=x.useState("00"),[v,R]=x.useState(""),U=Array.from({length:13},(G,K)=>{const B=(9+K).toString().padStart(2,"0");return{value:B,label:B}}),L=["00","10","20","30","40","50"].map(G=>({value:G,label:G}));x.useEffect(()=>{if(t){const G=new Date,K=G.getFullYear(),B=G.getMonth(),O=new Date(K,B+1,0).getDate(),A=G.getDate()>O-7;let Y;A?Y=new Date(K,B+2,0):Y=new Date(K,B+1,0);const te=Y.getFullYear(),J=String(Y.getMonth()+1).padStart(2,"0"),q=String(Y.getDate()).padStart(2,"0");_(`${te}-${J}-${q}`),g("10"),C("00"),R("")}},[t]);const w=()=>{if(!m){u&&u(" ","warning");return}const G=new Date,K=m.replace(/-/g,"")+y+N,B=G.getFullYear().toString()+String(G.getMonth()+1).padStart(2,"0")+String(G.getDate()).padStart(2,"0")+String(G.getHours()).padStart(2,"0")+String(G.getMinutes()).padStart(2,"0");if(Number(K)<Number(B)){u&&u("   ","warning");return}const O=localStorage.getItem("userInfo"),S=O?JSON.parse(O):{},A=S.userId||"A20130708",Y=S.crrId||"01",te=r!=null&&r.REMOVE_STAT&&w3[r.REMOVE_STAT]||"",J={CUST_ID:i,RCPT_ID:"",WRK_DTL_TCD:"0380",WRK_RCPT_CL:"JH",WRK_RCPT_CL_DTL:te,WRK_HOPE_DTTM:K,HOPE_DTTM:K,MEMO:v,EMRG_YN:"N",HOLY_YN:"N",CRR_ID:Y,WRKR_ID:A,REG_UID:A,REMOVE_LINE_TP:(r==null?void 0:r.REMOVE_LINE_TP)||"",REMOVE_GB:(r==null?void 0:r.REMOVE_GB)||"",REMOVE_STAT:(r==null?void 0:r.REMOVE_STAT)||"",POST_ID:(f==null?void 0:f.POST_ID)||"",BLD_ID:(f==null?void 0:f.BLD_ID)||"",BLD_CL:(f==null?void 0:f.BLD_CL)||"",BLD_NM:(f==null?void 0:f.BLD_NM)||"",BUN_CL:(f==null?void 0:f.BUN_CL)||"",BUN_NO:(f==null?void 0:f.BUN_NO)||"",HO_NM:(f==null?void 0:f.HO_NM)||"",APT_DONG_NO:(f==null?void 0:f.APT_DONG_NO)||"",APT_HO_CNT:(f==null?void 0:f.APT_HO_CNT)||"",ADDR:(f==null?void 0:f.ADDR)||d||"",ADDR_DTL:(f==null?void 0:f.ADDR_DTL)||""};n(J)},P=G=>({5:"",6:"21",7:""})[G]||G;return t?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-[90%] max-w-md mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"bg-purple-600 text-white px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between sticky top-0",children:[s.jsx("h2",{className:"text-sm sm:text-lg font-bold",children:" AS"}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-purple-700 rounded-full transition-colors",children:s.jsx(bi,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5 sm:p-3 space-y-1.5 sm:space-y-2",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20",children:""}),s.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[i," / ",l]})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium truncate",children:d})]})]}),(r==null?void 0:r.REMOVE_STAT)&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("span",{className:"text-sm text-yellow-700 font-medium",children:[" : ",P(r.REMOVE_STAT)]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:"AS"}),s.jsx("input",{type:"text",value:"(AS)",readOnly:!0,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 bg-gray-100 border border-gray-300 rounded-lg text-xs sm:text-sm text-gray-600"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:"AS()"}),s.jsx("input",{type:"text",value:"CS()",readOnly:!0,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 bg-gray-100 border border-gray-300 rounded-lg text-xs sm:text-sm text-gray-600"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:"AS()"}),s.jsx("input",{type:"text",value:P((r==null?void 0:r.REMOVE_STAT)||""),readOnly:!0,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 bg-gray-100 border border-gray-300 rounded-lg text-xs sm:text-sm text-gray-600"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Cf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"date",value:m,onChange:G=>_(G.target.value),min:new Date().toISOString().split("T")[0],className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(y_,{className:"w-4 h-4 text-gray-400"}),s.jsx("select",{value:y,onChange:G=>g(G.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500",children:U.map(G=>s.jsx("option",{value:G.value,children:G.label},G.value))}),s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("select",{value:N,onChange:G=>C(G.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500",children:L.map(G=>s.jsx("option",{value:G.value,children:G.label},G.value))})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:""}),s.jsx("textarea",{value:v,onChange:G=>R(G.target.value),placeholder:"  ...",rows:3,maxLength:512,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 border border-gray-300 rounded-lg text-xs sm:text-sm resize-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 border-t border-gray-200 sticky bottom-0",children:s.jsx("button",{onClick:w,className:"w-full py-2 sm:py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors text-sm sm:text-base",children:""})})]})]}):null},R5=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1})=>{var Ce,ge,Be,ce,Le,Xe,Pe,Ct;const d=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[u,f]=x.useState(!1),[m,_]=x.useState(""),[y,g]=x.useState(!1),{equipmentData:N,filteringData:C,removalLineData:v,setRemovalLineData:R}=$i(),{certifyRegconfInfo:U}=Ba(),L=t.id||"",w=oa(L),P={...N||i||C||{},installedEquipments:w.installedEquipments.length>0?w.installedEquipments:(N==null?void 0:N.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:w.removeEquipments.length>0?w.removeEquipments:(N==null?void 0:N.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(w.removalStatus).length>0?w.removalStatus:(N==null?void 0:N.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:G,isPending:K}=od(),B=()=>`work_complete_draft_${t.id}`,[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(!1),[q,V]=x.useState(""),[F,I]=x.useState(""),[ee,ae]=x.useState(void 0),T=v,j=R,[k,Q]=x.useState(!1),[H,$]=x.useState(!1),[ie,fe]=x.useState(null),[pe,de]=x.useState(!1),[Re,X]=x.useState(""),[_e,me]=x.useState(!1),[Z,le]=x.useState(!1),[se,Ee]=x.useState(!1),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(!1),[xe,et]=x.useState([]),[bt,it]=x.useState([]),[At,at]=x.useState(()=>{const Me=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(Me&&Me.length>=8)return`${Me.slice(0,4)}-${Me.slice(4,6)}-${Me.slice(6,8)}`;const lt=new Date;return lt.getFullYear()+"-"+String(lt.getMonth()+1).padStart(2,"0")+"-"+String(lt.getDate()).padStart(2,"0")});t.SO_ID;const We=t.VOIP_CTX||"",Dt=t.WRK_STAT_CD||"";t.KPI_PROD_GRP_CD;const Tt=m==="0"||m==="1"||m==="4",St=d||y||Tt||We?!1:Dt==="1"||Dt==="2",ze=d||y||Tt?!1:Dt==="1"||Dt==="2"||Dt==="7";x.useEffect(()=>{(async()=>{var lt;if(!(!t.id||d)){g(!0);try{console.log("[CompleteTerminate] OST  :",t.id);const ut=await tx({WRK_ID:t.id,RCPT_ID:t.RCPT_ID,CUST_ID:(lt=t.customer)==null?void 0:lt.id});if(ut){const jt=ut.OST_WORKABLE_STAT||"";console.log("[CompleteTerminate] OST  :",jt),_(jt),(jt==="0"||jt==="1"||jt==="4")&&(r==null||r("    .","warning",!0))}}catch(ut){console.error("[CompleteTerminate] OST   :",ut)}finally{g(!1)}}})()},[t.id,t.RCPT_ID,(Ce=t.customer)==null?void 0:Ce.id,d]),x.useEffect(()=>{(async()=>{try{console.log("[WorkCompleteTerminate]    ");const lt=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});lt&&(console.log("[WorkCompleteTerminate] API  :",lt),console.log("[WorkCompleteTerminate] :",{NET_CL:lt.NET_CL,NET_CL_NM:lt.NET_CL_NM}),console.log("[WorkCompleteTerminate] :",{INSTL_TP:lt.INSTL_TP,WRNG_TP:lt.WRNG_TP}),console.log("[WorkCompleteTerminate] /:",{CUST_REL:lt.CUST_REL,WRK_PROC_CT:lt.WRK_PROC_CT}),console.log("[WorkCompleteTerminate] isWorkCompleted:",d),d&&(console.log("[WorkCompleteTerminate]   -   "),S(lt.CUST_REL||""),Y((lt.WRK_PROC_CT||"").replace(/\\n/g,`
`)),lt.WRKR_CMPL_DT&&lt.WRKR_CMPL_DT.length>=8&&at(`${lt.WRKR_CMPL_DT.slice(0,4)}-${lt.WRKR_CMPL_DT.slice(4,6)}-${lt.WRKR_CMPL_DT.slice(6,8)}`)),V(lt.NET_CL||""),I(lt.NET_CL_NM||""),ae(ut=>ut||{NET_CL:lt.NET_CL||"",NET_CL_NM:lt.NET_CL_NM||"",WRNG_TP:lt.WRNG_TP||"",INSTL_TP:lt.INSTL_TP||"",CB_WRNG_TP:lt.CB_WRNG_TP||"",CB_INSTL_TP:lt.CB_INSTL_TP||"",INOUT_LINE_TP:lt.INOUT_LINE_TP||"",INOUT_LEN:lt.INOUT_LEN||"",DVDR_YN:lt.DVDR_YN||"",BFR_LINE_YN:lt.BFR_LINE_YN||"",CUT_YN:lt.CUT_YN||"",TERM_NO:lt.TERM_NO||"",RCV_STS:lt.RCV_STS||"",SUBTAP_ID:lt.SUBTAP_ID||"",PORT_NUM:lt.PORT_NUM||"",EXTN_TP:lt.EXTN_TP||"",TAB_LBL:lt.TAB_LBL||"",CVT_LBL:lt.CVT_LBL||"",STB_LBL:lt.STB_LBL||""}))}catch(lt){console.error("[WorkCompleteTerminate]    :",lt)}if(!d){const lt=localStorage.getItem(B());if(lt)try{const ut=JSON.parse(lt);S(ut.custRel||""),Y(ut.memo||""),ut.installInfoData&&(V(ut.networkType||""),I(ut.networkTypeName||""),ae(ut.installInfoData))}catch(ut){console.error("[WorkCompleteTerminate] localStorage  :",ut)}}f(!0)})()},[t.id,d]),x.useEffect(()=>{if(!u||d)return;const Me={custRel:O,memo:A,networkType:q,networkTypeName:F,installInfoData:ee,savedAt:new Date().toISOString()};localStorage.setItem(B(),JSON.stringify(Me))},[O,A,q,F,ee,u,d]),x.useEffect(()=>{(async()=>{try{const lt=await Jl(["CMCU005"]);lt.CMCU005&&it(lt.CMCU005.map(ut=>({value:ut.COMMON_CD,label:ut.COMMON_CD_NM})))}catch(lt){console.error("[WorkCompleteTerminate]   :",lt)}})()},[]),x.useEffect(()=>{(async()=>{try{const lt=await mc(),ut=(lt==null?void 0:lt.output)||lt||[];et(ut);const jt=t.PROD_CD||t.PROD_CD||"",Ve=ut.some($t=>$t.PROD_CD===jt);ue(Ve),console.log("[CompleteTerminate] LGHV :",{currentProdCd:jt,isLghv:Ve,prodListCount:ut.length})}catch(lt){console.error("[CompleteTerminate] LGHV   :",lt)}})()},[t.PROD_CD]),x.useEffect(()=>{console.log("[CompleteTerminate] OST  :",{OST_WORKABLE_STAT:m,isOstBlocked:Tt,isOstChecking:y,isWorkCompleted:d,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,:m==="0"?"":m==="1"?"":m==="2"?"":m==="3"?"":m==="4"?"/":m==="X"?"OST":m===""?"  ":""})},[m,Tt,y,d]);const dt=()=>{const Me=[];O||Me.push("  ."),ee!=null&&ee.NET_CL||Me.push(" . ( )"),At||Me.push(" ."),t.WRK_CD==="02"&&Dt!=="7"&&!Ne&&Me.push("  .");const lt=t.PROD_GRP||"",ut=(P==null?void 0:P.removedEquipments)||[];return lt!=="V"&&ut.length<1&&Me.push("  .   ."),Ot()&&!T&&Me.push("   ."),Me},Ke=Me=>{ae(Me),Me.NET_CL&&V(Me.NET_CL),Me.NET_CL_NM&&I(Me.NET_CL_NM),r==null||r("  .","success")},rt=()=>{ft(!0)},ft=(Me=!1)=>{if(K)return;if(Tt){r==null||r("    .","warning");return}if(!Me){const Ve=t.KPI_PROD_GRP_CD||"";if(Ve==="C"||Ve==="D"){r==null||r("    .","error");return}}const lt=dt();if(lt.length>0){if(lt.forEach(Ve=>r==null?void 0:r(Ve,"error")),lt.some(Ve=>Ve.includes(""))){const Ve=document.getElementById("removal-line-section");Ve&&(Ve.scrollIntoView({behavior:"smooth",block:"center"}),Ve.classList.add("ring-2","ring-red-500","ring-offset-2"),setTimeout(()=>{Ve.classList.remove("ring-2","ring-red-500","ring-offset-2")},2e3))}return}const ut=t.TERM_HOPE_DT||t.HOPE_DT||"";if(ut&&At){const Ve=ut.replace(/-/g,"");At.replace(/-/g,"")<Ve&&(r==null||r("  .","warning"))}X(Me?" ?":" ?"),me(Me),de(!0)},Ot=()=>{const Me=t.KPI_PROD_GRP_CD||"",lt=t.VOIP_CTX||"";return["C","D","I"].includes(Me)&&lt!=="T"&&lt!=="R"},mt=Me=>{console.log("[WorkCompleteTerminate]   () :",Me),j(Me),r==null||r("  .   .","info")},Ze=Me=>{console.log("[WorkCompleteTerminate]   - AS  :",Me),j(Me),Q(!0)},De=Me=>{console.log("[WorkCompleteTerminate] AS  :",Me),fe(Me),Q(!1),r==null||r("  AS  .","info")},Ye=async()=>{var Ns,ke,ct,st,Kt,ht,qt;const Me=At.replace(/-/g,""),lt=localStorage.getItem("userInfo"),ut=lt?JSON.parse(lt):{},jt=ut.userId||"A20130708";let Ve="N";if(c||Mh(t.OP_LNKD_CD)){const It=await D3(t,jt);if(Ve=It.certifyTg,!It.success){r==null||r(`  : ${It.error}`,"error");return}}if(T&&T.REMOVE_GB==="4")try{console.log("[WorkCompleteTerminate]   API :",T);const It=await T_({WRK_ID:t.id||t.WRK_ID||"",REMOVE_LINE_TP:T.REMOVE_LINE_TP||"",REMOVE_GB:T.REMOVE_GB||"4",REMOVE_STAT:T.REMOVE_STAT||"",REG_UID:jt});if(It.code!=="SUCCESS"&&It.code!=="OK"){r==null||r(It.message||"   .","error",!0);return}console.log("[WorkCompleteTerminate]    ")}catch(It){r==null||r(It.message||"     .","error",!0);return}const Ue=(P==null?void 0:P.removedEquipments)||[],ss=!!t.ISP_PROD_CD;if(Ve!=="Y"&&(Ue.length>0||ss))try{let It="SMR05",he="";if(ne){It="STB_DEL";const Qe=Ue.find(yt=>{var vt,$e;return(yt.ITEM_MID_CD||yt.itemMidCd||((vt=yt.actualEquipment)==null?void 0:vt.ITEM_MID_CD)||(($e=yt.actualEquipment)==null?void 0:$e.itemMidCd))==="04"});Qe&&(he=Qe.EQT_NO||Qe.id||((Ns=Qe.actualEquipment)==null?void 0:Ns.EQT_NO)||((ke=Qe.actualEquipment)==null?void 0:ke.id)||"")}const be=Ue[0],Oe=be?be.actualEquipment||be:{},je=Oe.PROD_CMPS_ID||(be==null?void 0:be.PROD_CMPS_ID)||Oe.EQT_PROD_CMPS_ID||(be==null?void 0:be.EQT_PROD_CMPS_ID)||"",Te=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"";console.log("[CompleteTerminate]   :",{msgId:It,isLghvStb:ne,etc1:he,eqtProdCmpsId:je,voipJoinCtrtId:Te});const _t=await la({MSG_ID:It,CUST_ID:((ct=t.customer)==null?void 0:ct.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:je,PROD_CD:"",WRK_ID:t.id||"",REG_UID:jt,ETC_1:he,VOIP_JOIN_CTRT_ID:Te,WTIME:"3"});if(_t.code!=="SUCCESS"&&_t.code!=="OK"){if((t.PROD_GRP||"")==="V"&&((st=_t.message)==null?void 0:st.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteTerminate] VoIP    -  :",_t.message),r==null||r("   .","error",!0);return}if((t.MSO_OUT_YN||"")==="Y"){r==null||r("MSO      .  .","error",!0);return}if(!window.confirm(` .
  ?`)){console.log("[CompleteTerminate]      ");return}console.log("[CompleteTerminate]      ")}else console.log("[CompleteTerminate]    ")}catch(It){if(console.warn("[CompleteTerminate]     :",It),!window.confirm(` .
  ?`))return}const ls=(P==null?void 0:P.removalStatus)||{},ds=Ue.map(It=>{var Te;const he=It.actualEquipment||It,be=It.contractEquipment||{},Oe=he.id||It.EQT_NO||It.id||"",je=ls[Oe]||ls[It.id]||ls[It.EQT_NO]||ls[he.id]||ls[It.serialNumber]||ls[he.serialNumber]||{},tt=(_t,Qe)=>_t==="1"||_t==="Y"||Qe==="1"||Qe==="Y"?"1":"0";return{...he,EQT_NO:Oe,ITEM_MID_CD:he.ITEM_MID_CD||he.itemMidCd||It.ITEM_MID_CD||It.itemMidCd||"",ITEM_MID_NM:he.ITEM_MID_NM||he.type||It.ITEM_MID_NM||It.type||"",EQT_CL_CD:he.EQT_CL_CD||he.eqtClCd||It.EQT_CL_CD||It.eqtClCd||"",EQT_CL_NM:he.EQT_CL_NM||he.model||It.EQT_CL_NM||It.model||"",EQT_SERNO:he.EQT_SERNO||he.serialNumber||It.EQT_SERNO||It.serialNumber||"",MAC_ADDRESS:It.macAddress||he.MAC_ADDRESS||he.macAddress||It.MAC_ADDRESS||"",CRR_TSK_CL:"02",RCPT_ID:t.RCPT_ID||"",WRK_ID:t.id||"",CUST_ID:It.CUST_ID||((Te=t.customer)==null?void 0:Te.id)||"",CTRT_ID:It.CTRT_ID||t.CTRT_ID||"",CRR_ID:t.CRR_ID||ut.crrId||"01",WRKR_ID:jt,REG_UID:jt,SVC_CMPS_ID:be.SVC_CMPS_ID||It.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:be.BASIC_PROD_CMPS_ID||It.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:It.EQT_PROD_CMPS_ID||"",PROD_CD:be.PROD_CD||It.PROD_CD||"",SVC_CD:be.SVC_CD||It.SVC_CD||"",MST_SO_ID:It.MST_SO_ID||t.SO_ID||"",SO_ID:It.SO_ID||t.SO_ID||"",OLD_LENT_YN:It.OLD_LENT_YN||"N",LENT_YN:It.lentYn||It.LENT_YN||be.LENT_YN||"10",...(console.log("[CompleteTerminate]  :",{eqtNo:Oe,"eq.EQT_LOSS_YN":It.EQT_LOSS_YN,"status.EQT_LOSS_YN":je.EQT_LOSS_YN,"status ":je,"removalStatus ":Object.keys(ls)}),{}),EQT_LOSS_YN:tt(It.EQT_LOSS_YN,je.EQT_LOSS_YN),PART_LOSS_BRK_YN:tt(It.PART_LOSS_BRK_YN,je.PART_LOSS_BRK_YN),EQT_BRK_YN:tt(It.EQT_BRK_YN,je.EQT_BRK_YN),EQT_CABL_LOSS_YN:tt(It.EQT_CABL_LOSS_YN,je.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:tt(It.EQT_CRDL_LOSS_YN,je.EQT_CRDL_LOSS_YN),REUSE_YN:It.REUSE_YN||je.REUSE_YN||"1"}}),Ss={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Kt=t.customer)==null?void 0:Kt.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||ut.crrId||"01",WRKR_ID:jt,WRKR_CMPL_DT:Me,MEMO:A||" ",STTL_YN:"Y",REG_UID:jt,CUST_REL:O,CNFM_CUST_NM:(ht=t.customer)==null?void 0:ht.name,CNFM_CUST_TELNO:((qt=t.customer)==null?void 0:qt.contactNumber)||"",WRK_ACT_CL:"20",NET_CL:(ee==null?void 0:ee.NET_CL)||"",WRNG_TP:(ee==null?void 0:ee.WRNG_TP)||"",INSTL_TP:(ee==null?void 0:ee.INSTL_TP)||"",EQT_RMV_FLAG:_e?"Y":""},equipmentList:[],removeEquipmentList:ds,spendItemList:(P==null?void 0:P.spendItems)||[],agreementList:(P==null?void 0:P.agreements)||[],poleList:(P==null?void 0:P.poleResults)||[]};console.log("[CompleteTerminate]   :"),console.log("  - workInfo:",Ss.workInfo),console.log("  -  modNetInfo   :"),console.log("    - NET_CL:",Ss.workInfo.NET_CL,"( modNetInfo )"),console.log("    - INSTL_TP:",Ss.workInfo.INSTL_TP),console.log("    - WRNG_TP:",Ss.workInfo.WRNG_TP),console.log("    - WRK_ID:",Ss.workInfo.WRK_ID),console.log("    - CTRT_ID:",Ss.workInfo.CTRT_ID),console.log("    - installInfoData :",ee),console.log("  - removeEquipmentList :",ds.length),ds.length>0&&(console.log("  - removeEquipmentList[0] :",ds[0]),console.log("  -   [0]:",Ue[0])),G(Ss,{onSuccess:async It=>{var he;if(It.code==="SUCCESS"||It.code==="OK"){if(localStorage.removeItem(B()),t.WRK_STAT_CD="3",ie)try{const be=await T_({WRK_ID:t.id||t.WRK_ID||"",REMOVE_LINE_TP:ie.REMOVE_LINE_TP||"",REMOVE_GB:ie.REMOVE_GB||"1",REMOVE_STAT:ie.REMOVE_STAT||"",REG_UID:ie.REG_UID||jt});be.code!=="SUCCESS"&&be.code!=="OK"&&console.error("[WorkCompleteTerminate]    :",be.message);const Oe=await h5({CUST_ID:ie.CUST_ID||((he=t.customer)==null?void 0:he.id)||"",RCPT_ID:ie.RCPT_ID||"",WRK_DTL_TCD:ie.WRK_DTL_TCD||"0380",WRK_RCPT_CL:ie.WRK_RCPT_CL||"JH",WRK_RCPT_CL_DTL:ie.WRK_RCPT_CL_DTL||"",WRK_HOPE_DTTM:ie.WRK_HOPE_DTTM||"",MEMO:ie.MEMO||"",EMRG_YN:ie.EMRG_YN||"N",HOLY_YN:ie.HOLY_YN||"N",CRR_ID:ie.CRR_ID||"",WRKR_ID:ie.WRKR_ID||"",REG_UID:ie.REG_UID||jt,POST_ID:ie.POST_ID||"",BLD_ID:ie.BLD_ID||"",BLD_CL:ie.BLD_CL||"",BLD_NM:ie.BLD_NM||"",BUN_CL:ie.BUN_CL||"",BUN_NO:ie.BUN_NO||"",HO_NM:ie.HO_NM||"",APT_DONG_NO:ie.APT_DONG_NO||"",APT_HO_CNT:ie.APT_HO_CNT||"",ADDR:ie.ADDR||"",ADDR_DTL:ie.ADDR_DTL||""});Oe.code==="SUCCESS"||Oe.code==="OK"?console.log("[WorkCompleteTerminate] AS "):console.error("[WorkCompleteTerminate] AS :",Oe.message)}catch(be){console.error("[WorkCompleteTerminate] AS  :",be)}r==null||r("  .","success"),n()}else r==null||r(It.message||"   .","error",!0)},onError:It=>{r==null||r(It.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[se&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999]",onClick:Me=>Me.stopPropagation(),onTouchStart:Me=>Me.stopPropagation(),children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-4 shadow-xl",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-gray-700 font-medium",children:"  ..."}),s.jsx("p",{className:"text-gray-500 text-sm",children:" "})]})}),K&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("input",{type:"text",value:"",readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:F||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>J(!0),className:`min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${d?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:d?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:O,onValueChange:S,options:bt,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:A,onChange:Me=>Y(Me.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${d?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:d,disabled:d}),!d&&s.jsxs("p",{className:`text-xs text-right mt-1 ${A.length>=500?"text-red-500":"text-gray-400"}`,children:[A.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:At,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsx(Db,{custId:((ge=t.customer)==null?void 0:ge.id)||"",rcptId:t.RCPT_ID||"",ctrtId:t.CTRT_ID||"",soId:t.SO_ID||"",termHopeDt:t.TERM_HOPE_DT||t.HOPE_DT||"",wrkCd:t.WRK_CD||"02",wrkStatCd:Dt,showToast:r,onHotbillConfirmChange:ye,onSimulatingChange:Ee,readOnly:d}),Ot()&&s.jsx(v5,{onComplete:mt,onAssignAS:Ze,showToast:r,disabled:d,savedData:T,onReset:()=>j(null)}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!d&&s.jsxs("button",{onClick:()=>rt(),disabled:K||!St,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${St?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{children:""})]}),!d&&s.jsx("button",{onClick:()=>ft(!1),disabled:K||!ze,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${ze?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:K?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{onClick:()=>le(!0),className:"flex-1 btn btn-lg flex items-center justify-center gap-2 bg-gray-500 hover:bg-gray-600 text-white",children:[s.jsx(nd,{className:"w-5 h-5"}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:te,onClose:()=>J(!1),onSave:Ke,workId:t.id,initialData:ee,workType:t.WRK_CD,customerId:(Be=t.customer)==null?void 0:Be.id,customerName:(ce=t.customer)==null?void 0:ce.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||t.addrOrd||"",kpiProdGrpCd:t.KPI_PROD_GRP_CD||"",prodChgGb:t.PROD_CHG_GB||"",chgKpiProdGrpCd:t.CHG_KPI_PROD_GRP_CD||"",prodGrp:t.PROD_GRP||"",wrkDtlTcd:t.WRK_DTL_TCD||"",readOnly:d}),s.jsx(D5,{isOpen:k,onClose:()=>Q(!1),onSave:De,removalLineData:T,custId:((Le=t.customer)==null?void 0:Le.id)||"",custNm:((Xe=t.customer)==null?void 0:Xe.name)||"",addrOrd:((Pe=t.customer)==null?void 0:Pe.ADDR_ORD)||"",address:t.address||"",showToast:r,addressInfo:{POST_ID:t.POST_ID||"",BLD_ID:t.BLD_ID||"",BLD_CL:t.BLD_CL||"",BLD_NM:t.BLD_NM||"",BUN_CL:t.BUN_CL||"",BUN_NO:t.BUN_NO||"",HO_NM:t.HO_NM||"",APT_DONG_NO:t.APT_DONG_NO||"",APT_HO_CNT:t.APT_HO_CNT||"",ADDR:t.ADDR_TOTAL||t.ADDR||t.address||"",ADDR_DTL:t.ADDR_DTL||""}}),s.jsx(ul,{isOpen:pe,onClose:()=>de(!1),onConfirm:Ye,title:_e?" ":" ",message:Re,type:"confirm",confirmText:_e?"":"",cancelText:"",children:s.jsx(ld,{workType:"02",workTypeName:_e?"":"",custRel:O,custRelName:(Ct=bt.find(Me=>Me.value===O))==null?void 0:Ct.label,networkType:q,networkTypeName:F,installType:ee==null?void 0:ee.INSTL_TP,installTypeName:ee==null?void 0:ee.INSTL_TP_NM,removedEquipments:(P==null?void 0:P.removedEquipments)||[],memo:A})}),s.jsx(Wa,{isOpen:Z,onClose:()=>le(!1),ctrtId:t.CTRT_ID,prodCmpsId:t.BASIC_PROD_CMPS_ID||t.PROD_CMPS_ID})]})},T5=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1})=>{var be,Oe,je,tt,Te,_t,Qe,yt,vt;const d=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[u,f]=x.useState(!1),{equipmentData:m,filteringData:_}=$i(),{certifyRegconfInfo:y}=Ba(),g=t.id||"",N=oa(g),C={...m||i||_||{},installedEquipments:N.installedEquipments.length>0?N.installedEquipments:(m==null?void 0:m.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:N.markedForRemoval.length>0?N.markedForRemoval:(m==null?void 0:m.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(N.removalStatus).length>0?N.removalStatus:(m==null?void 0:m.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:v,isPending:R}=od(),U=()=>`work_complete_draft_${t.id}`,[L,w]=x.useState(""),[P,G]=x.useState(""),[K,B]=x.useState(""),[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(""),[q,V]=x.useState(""),[F,I]=x.useState(""),[ee,ae]=x.useState(!1),[T,j]=x.useState(""),[k,Q]=x.useState([]),[H,$]=x.useState(!1),[ie,fe]=x.useState([]),[pe,de]=x.useState(""),[Re,X]=x.useState(""),[_e,me]=x.useState(!1),[Z,le]=x.useState(""),[se,Ee]=x.useState(""),[Ne,ye]=x.useState(void 0),[ne,ue]=x.useState(!1),[xe,et]=x.useState(!1),[bt,it]=x.useState(""),[At,at]=x.useState(""),[We,Dt]=x.useState(""),[Tt,St]=x.useState(!1),[ze,dt]=x.useState(!1),[Ke,rt]=x.useState([]),[ft,Ot]=x.useState(!1),[mt,Ze]=x.useState(null),[De,Ye]=x.useState([]),[Ce,ge]=x.useState([]),[Be,ce]=x.useState([]),[Le,Xe]=x.useState([]),[Pe,Ct]=x.useState([]),[Me,lt]=x.useState([]),[ut,jt]=x.useState([]),[Ve,$t]=x.useState([]),[Ue,ss]=x.useState([]),[ls,ds]=x.useState([]),[Ss,Ns]=x.useState([]),[ke,ct]=x.useState(()=>{const $e=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if($e&&$e.length>=8)return`${$e.slice(0,4)}-${$e.slice(4,6)}-${$e.slice(6,8)}`;const ot=new Date;return ot.getFullYear()+"-"+String(ot.getMonth()+1).padStart(2,"0")+"-"+String(ot.getDate()).padStart(2,"0")});x.useEffect(()=>{if(d){(async()=>{try{const wt=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(wt){w(wt.CUST_REL||""),G((wt.WRK_PROC_CT||"").replace(/\\n/g,`
`)),B(wt.KPI_PROD_GRP||""),S(wt.OBS_RCPT_CD||""),Y(wt.OBS_RCPT_DTL_CD||""),J(wt.PSN_USE_CORP||""),V(wt.VOIP_USE_CORP||""),I(wt.DTV_USE_CORP||""),le(wt.NET_CL||""),Ee(wt.NET_CL_NM||""),it(wt.INSTL_LOC||"");const Bt=wt.UP_CTRL_CL||(C==null?void 0:C.upCtrlCl)||"";de(Bt),X(wt.TV_TYPE||""),ye({NET_CL:wt.NET_CL||"",NET_CL_NM:wt.NET_CL_NM||"",WRNG_TP:wt.WRNG_TP||"",INSTL_TP:wt.INSTL_TP||"",CB_WRNG_TP:wt.CB_WRNG_TP||"",CB_INSTL_TP:wt.CB_INSTL_TP||"",INOUT_LINE_TP:wt.INOUT_LINE_TP||"",INOUT_LEN:wt.INOUT_LEN||"",DVDR_YN:wt.DVDR_YN||"",BFR_LINE_YN:wt.BFR_LINE_YN||"",CUT_YN:wt.CUT_YN||"",TERM_NO:wt.TERM_NO||"",RCV_STS:wt.RCV_STS||"",SUBTAP_ID:wt.SUBTAP_ID||"",PORT_NUM:wt.PORT_NUM||"",EXTN_TP:wt.EXTN_TP||"",TAB_LBL:wt.TAB_LBL||"",CVT_LBL:wt.CVT_LBL||"",STB_LBL:wt.STB_LBL||""}),wt.VOIP_JOIN_CTRT_ID&&j(wt.VOIP_JOIN_CTRT_ID),wt.WRKR_CMPL_DT&&wt.WRKR_CMPL_DT.length>=8&&ct(`${wt.WRKR_CMPL_DT.slice(0,4)}-${wt.WRKR_CMPL_DT.slice(4,6)}-${wt.WRKR_CMPL_DT.slice(6,8)}`)}}catch(wt){console.error("[WorkCompleteAS]     :",wt)}f(!0)})();return}const $e=localStorage.getItem(U());if($e)try{const ot=JSON.parse($e);w(ot.custRel||""),G(ot.memo||""),B(ot.kpiProdGrp||""),S(ot.obsRcptCd||""),Y(ot.obsRcptDtlCd||""),J(ot.internetUse||""),V(ot.voipUse||""),I(ot.dtvUse||""),le(ot.networkType||""),Ee(ot.networkTypeName||""),it(ot.installLocationText||""),ye(ot.installInfoData),ot.upCtrlCl&&de(ot.upCtrlCl),ot.tvType&&X(ot.tvType),ot.voipJoinCtrtId&&j(ot.voipJoinCtrtId)}catch(ot){console.error("[WorkCompleteAS] localStorage  :",ot)}f(!0)},[t.id,d]),x.useEffect(()=>{if(!u||d)return;const $e={custRel:L,memo:P,kpiProdGrp:K,obsRcptCd:O,obsRcptDtlCd:A,internetUse:te,voipUse:q,dtvUse:F,networkType:Z,networkTypeName:se,installLocationText:bt,installInfoData:Ne,upCtrlCl:pe,tvType:Re,voipJoinCtrtId:T,savedAt:new Date().toISOString()};localStorage.setItem(U(),JSON.stringify($e))},[L,P,K,O,A,te,q,F,Z,se,bt,Ne,pe,Re,T,u,d]),x.useEffect(()=>{(async()=>{try{const ot=await Jl(["CMCU005","CMCU057","CMCU110","CMCU148","CMCT015"]);ot.CMCU005&&Ye(ot.CMCU005.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ot.CMCU057&&ce(ot.CMCU057.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ot.CMCU110&&Xe(ot.CMCU110.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ot.CMCU148&&Ct(ot.CMCU148.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ot.CMCT015&&ge(ot.CMCT015.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM})));const wt=await Jl(["PP00933","CMOB000","CMOB001"]),Bt=wt.PP00933||[],Yt=wt.CMOB000||[],Xt=wt.CMOB001||[];lt(Bt),jt(Yt),$t(Xt),ss(Bt.map(ts=>({value:ts.COMMON_CD||"",label:ts.COMMON_CD_NM||""})))}catch(ot){console.error("[WorkCompleteAS]   :",ot)}})()},[]),x.useEffect(()=>{(async()=>{try{const ot=await mc(),wt=(ot==null?void 0:ot.output)||ot||[];rt(wt);const Bt=t.PROD_CD||t.PROD_CD||"",Yt=wt.some(Xt=>Xt.PROD_CD===Bt);dt(Yt)}catch(ot){console.error("[CompleteAS] LGHV   :",ot)}})()},[t.PROD_CD]),x.useEffect(()=>{C!=null&&C.upCtrlCl&&!pe?de(C.upCtrlCl):!pe&&u&&!d&&de("01")},[C==null?void 0:C.upCtrlCl,u,d,pe]),x.useEffect(()=>{if(Me.length===0)return;const $e=t.KPI_PROD_GRP_CD||(C==null?void 0:C.kpiProdGrpCd)||"",ot=t.PROD_GRP||(C==null?void 0:C.prodGrp)||"";let wt=Me;$e&&(wt=Me.filter(Yt=>{const Xt=Yt.COMMON_CD||"";return Xt===$e||ot==="C"&&Xt==="I"}));const Bt=[{value:"",label:""},...wt.map(Yt=>({value:Yt.COMMON_CD||"",label:Yt.COMMON_CD_NM||""}))];ss(Bt),$e&&!K&&!d&&B($e)},[Me,t,C==null?void 0:C.kpiProdGrpCd,C==null?void 0:C.prodGrp,d]),x.useEffect(()=>{if(ut.length===0)return;const $e=t.WRK_STAT_CD||"",ot=t.WRK_DTL_TCD||"",wt=t.asReasonCode||t.WRK_RCPT_CL||"",Bt=t.asDetailCode||t.WRK_RCPT_CL_DTL||"";if(Ns([{value:"",label:""}]),!K){ds([{value:"",label:"  "}]);return}const Yt=Bt&&ut.some(ys=>ys.REF_CODE12===Bt),Xt=wt&&ut.some(ys=>ys.REF_CODE12===wt);let ts;Yt?ts="clDtl":Xt?ts="cl":ts="empty",console.log("[CompleteAS]   :",{kpiProdGrp:K,wrkStatCd:$e,wrkDtlTcd:ot,wrkRcptCl:wt,wrkRcptClDtl:Bt,hasRefCode12ClDtl:Yt,hasRefCode12Cl:Xt,refCode12Filter:ts,totalCodes:ut.length});const Ut=ut.filter(ys=>{const Ps=ys.COMMON_CD||"",ps=ys.REF_CODE2||"",vs=ys.REF_CODE12||"",Ms=ys.REF_CODE16||"";if(!ps.includes(K)||$e==="2"&&Ps==="KA")return!1;if(ot==="0350"){if(Ms!=="A"&&Ms!=="Y")return!1}else if(Ms&&Ms!=="A")return!1;if(ts==="clDtl"){if(vs!==Bt)return!1}else if(ts==="cl"){if(vs!==wt)return!1}else if(vs)return!1;return!0});console.log("[CompleteAS]   :",Ut.map(ys=>({code:ys.COMMON_CD,name:ys.COMMON_CD_NM,REF_CODE12:ys.REF_CODE12,REF_CODE16:ys.REF_CODE16})));const Es=[{value:"",label:""},...Ut.map(ys=>({value:ys.COMMON_CD||"",label:ys.COMMON_CD_NM||""}))];ds(Es),O&&!Ut.some(ys=>ys.COMMON_CD===O)&&(S(""),Y(""))},[K,ut,t.WRK_STAT_CD,t.WRK_DTL_TCD,t.asReasonCode,t.asDetailCode]),x.useEffect(()=>{if(Ve.length===0)return;const $e=t.WRK_DTL_TCD||"",ot=t.asReasonCode||t.WRK_RCPT_CL||"",wt=t.asDetailCode||t.WRK_RCPT_CL_DTL||"";if(!O||!K){Ns([{value:"",label:"  "}]);return}const Bt=wt&&Ve.some(Es=>Es.REF_CODE12===wt),Yt=ot&&Ve.some(Es=>Es.REF_CODE12===ot);let Xt;Bt?Xt="clDtl":Yt?Xt="cl":Xt="empty";const ts=Ve.filter(Es=>{const ys=Es.COMMON_CD||"",Ps=Es.REF_CODE||"",ps=Es.REF_CODE2||"",vs=Es.REF_CODE12||"",Ms=Es.REF_CODE16||"";if(!Ps.includes(O)||!ps.includes(K))return!1;if($e==="0350"){if(Ms!=="A"&&Ms!=="Y")return!1}else if(Ms&&Ms!=="A")return!1;if(Xt==="clDtl"){if(vs!==wt)return!1}else if(Xt==="cl"){if(vs!==ot)return!1}else if(vs)return!1;return!(wt==="JJO"&&ys!=="OOI")}),Ut=[{value:"",label:""},...ts.map(Es=>({value:Es.COMMON_CD||"",label:Es.COMMON_CD_NM||""}))];Ns(Ut),A&&!ts.some(Es=>Es.COMMON_CD===A)&&Y("")},[O,K,Ve,t.WRK_DTL_TCD,t.asReasonCode,t.asDetailCode]),x.useEffect(()=>{var wt;if(d)return;const $e=((wt=t.customer)==null?void 0:wt.id)||t.CUST_ID;if(!$e)return;(async()=>{try{const Bt=await If({CUST_ID:$e});fe(Bt||[])}catch{fe([])}})()},[(be=t.customer)==null?void 0:be.id,t.CUST_ID,d]),x.useEffect(()=>{if(d||ie.length===0)return;const $e=t.PROD_GRP||"",ot=t.VOIP_PROD_CD||"",wt=t.ISP_PROD_CD||"",Bt=t.WRK_STAT_CD||"",Yt=t.ADDR_ORD||"";if($e==="V"&&!ot){const Xt=ie.filter(Ut=>{const Es=Ut.PROD_GRP||"",ys=Ut.CTRT_STAT||"",Ps=Ut.ADDR_ORD||Ut.addr_ord||"";return(Es==="C"||Es==="D"||Es==="I")&&ys==="20"&&(!Yt||Ps===Yt)});Xt.length<1&&Bt==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const ts=[{value:"",label:""},...Xt.map(Ut=>({value:Ut.CTRT_ID||"",label:`[${Ut.CTRT_ID}] ${Ut.BASIC_PROD_CD_NM||Ut.PROD_NM||""}`}))];Q(ts),$(!0);return}if($e==="I"&&wt){const Xt=ie.filter(Ut=>{const Es=Ut.PROD_GRP||"",ys=Ut.CTRT_STAT||"",Ps=Ut.ADDR_ORD||Ut.addr_ord||"",ps=Ut.ISP_JOIN_ID||"",vs=Ut.KPI_PROD_GRP_CD||"";return(Es==="D"||Es==="C")&&ys==="20"&&!ps&&vs==="D"&&(!Yt||Ps===Yt)});Xt.length<1&&Bt==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const ts=[{value:"",label:""},...Xt.map(Ut=>({value:Ut.CTRT_ID||"",label:`[${Ut.CTRT_ID}] ${Ut.BASIC_PROD_CD_NM||Ut.PROD_NM||""}`}))];Q(ts),$(!0);return}$(!1),Q([])},[t.id,t.WRK_STAT_CD,d,r,ie]);const st=()=>{const $e=[];L||$e.push("  ."),K||$e.push(" ."),O||$e.push(" ."),A||$e.push(" ."),Ne!=null&&Ne.NET_CL||$e.push(" ."),ke||$e.push(" .");const ot=t.PROD_GRP||"",wt=t.VOIP_PROD_CD||"",Bt=t.ISP_PROD_CD||"";ot==="V"&&!wt&&H&&(T||$e.push("VOIP    .")),ot==="I"&&Bt&&H&&(T||$e.push("  ISP .    ."));const Yt=(C==null?void 0:C.installedEquipments)||[],Xt=(C==null?void 0:C.removedEquipments)||[];return Yt.length>0||Xt.length>0,$e},Kt=$e=>{ye($e),$e.NET_CL&&le($e.NET_CL),$e.NET_CL_NM&&Ee($e.NET_CL_NM),r==null||r("  .","success")},ht=()=>{if(R)return;const $e=st();if($e.length>0){$e.forEach(wt=>r==null?void 0:r(wt,"error"));return}(t.PROD_GRP||"")!=="V"?Ot(!0):St(!0)},qt=$e=>{Ze($e),Ot(!1),St(!0)},It=($e,ot=!1)=>{if(!$e||$e.length===0)return[];const wt=localStorage.getItem("userInfo"),Bt=wt?JSON.parse(wt):{},Yt=Bt.userId||"A20130708",Xt=(C==null?void 0:C.removalStatus)||{},ts=(Ut,Es)=>Ut==="1"||Ut==="Y"||Es==="1"||Es==="Y"?"1":"0";return $e.map(Ut=>{var ps,vs,Ms,cs;const Es=Ut.EQT_NO||Ut.id||((ps=Ut.actualEquipment)==null?void 0:ps.id)||"",ys=Xt[Es]||Xt[Ut.id]||Xt[Ut.EQT_NO]||Xt[(vs=Ut.actualEquipment)==null?void 0:vs.id]||Xt[Ut.serialNumber]||{},Ps=ot?{CRR_TSK_CL:t.WRK_CD||"03",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Bt.crrId||"01",WRKR_ID:Yt,EQT_LOSS_YN:ts(Ut.EQT_LOSS_YN,ys.EQT_LOSS_YN),PART_LOSS_BRK_YN:ts(Ut.PART_LOSS_BRK_YN,ys.PART_LOSS_BRK_YN),EQT_BRK_YN:ts(Ut.EQT_BRK_YN,ys.EQT_BRK_YN),EQT_CABL_LOSS_YN:ts(Ut.EQT_CABL_LOSS_YN,ys.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:ts(Ut.EQT_CRDL_LOSS_YN,ys.EQT_CRDL_LOSS_YN)}:{};if(Ut.actualEquipment){const ms=Ut.actualEquipment,Ks=Ut.contractEquipment||{};return{...ms,EQT_NO:ms.id,EQT_SERNO:ms.serialNumber,ITEM_MID_CD:ms.itemMidCd,EQT_CL_CD:ms.eqtClCd,MAC_ADDRESS:Ut.macAddress||ms.macAddress,WRK_ID:t.id,CUST_ID:(Ms=t.customer)==null?void 0:Ms.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:Ks.id||Ks.SVC_CMPS_ID||ms.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ms.BASIC_PROD_CMPS_ID||Ks.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:ms.EQT_PROD_CMPS_ID||Ks.id,PROD_CD:ms.PROD_CD||Ks.PROD_CD||t.PROD_CD||"",SVC_CD:ms.SVC_CD||Ks.SVC_CD||"",EQT_SALE_AMT:ms.EQT_SALE_AMT||"0",MST_SO_ID:ms.MST_SO_ID||t.SO_ID||"",SO_ID:ms.SO_ID||t.SO_ID||"",REG_UID:Yt,OLD_LENT_YN:ms.OLD_LENT_YN||"N",LENT:ms.LENT||"10",LENT_YN:ms.LENT_YN||"10",ITLLMT_PRD:ms.ITLLMT_PRD||"00",EQT_USE_STAT_CD:ms.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:ms.IF_DTL_ID||"",VOIP_CUSTOWN_EQT:ms.VOIP_CUSTOWN_EQT||"N",...Ps}}return{...Ut,EQT_NO:Ut.EQT_NO||Ut.id||"",EQT_SERNO:Ut.EQT_SERNO||Ut.serialNumber||"",ITEM_MID_CD:Ut.ITEM_MID_CD||Ut.itemMidCd||"",EQT_CL_CD:Ut.EQT_CL_CD||Ut.eqtClCd||"",MAC_ADDRESS:Ut.MAC_ADDRESS||Ut.macAddress||"",SVC_CMPS_ID:Ut.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Ut.BASIC_PROD_CMPS_ID||"",PROD_CD:Ut.PROD_CD||"",SVC_CD:Ut.SVC_CD||"",WRK_ID:t.id,CUST_ID:(cs=t.customer)==null?void 0:cs.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:Yt,...Ps}})},he=async()=>{var Ks,Ls,nt,Ft,Cs,Ht,Os;const $e=ke.replace(/-/g,""),ot=localStorage.getItem("userInfo"),wt=ot?JSON.parse(ot):{},Bt=wt.userId||"A20130708",Yt=c||Mh(t.OP_LNKD_CD),Xt=await bg(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let ts="";if(Yt){let Zt=(C==null?void 0:C.prodPromoInfo)||[];if(Zt.length===0)try{Zt=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"03"})}catch(js){console.log("[CompleteAS] getProdPromotionInfo fallback :",js)}const Ds=Zt.filter(js=>(js.PROD_CMPS_CL==="21"||js.PROD_CMPS_CL==="22")&&(js.PROD_STAT_CD==="10"||js.PROD_STAT_CD==="20")).map(js=>js.PROD_CD).filter(js=>js);ts=Ds.length>0?Ds.join(",")+",":"",console.log("[CompleteAS] ADD_ON :",ts)}const Ut=(C==null?void 0:C.installedEquipments)||[];if(Yt&&Ut.length>0&&!y){r==null||r("  .","error");return}if(Yt&&y)try{const Zt=await yg({order:t,workerId:Bt,certifyRegconfInfo:y,addOnParam:ts,reason:"AS"});if(!Zt.success){r==null||r(` : ${Zt.message}`,"error");return}}catch(Zt){console.error("[CompleteAS] CL-04  :",Zt),r==null||r(`  : ${Zt.message||"   "}`,"error");return}let Es="";const ys=(C==null?void 0:C.removedEquipments)||[],Ps=t.VOIP_CTX==="1",ps=Ps&&(t.PROD_CD||t.PROD_CD)==="PD10004499",vs=["090901","091001","091002","091005"],Ms=ys.some(Zt=>{var js,hs;const Ds=Zt.EQT_CL_CD||Zt.eqtClCd||((js=Zt.actualEquipment)==null?void 0:js.EQT_CL_CD)||((hs=Zt.actualEquipment)==null?void 0:hs.eqtClCd)||"";return!vs.includes(Ds)});if(ze)console.log("[CompleteAS] LGHV :   skip ( )");else if(!Xt&&!Ps&&ys.length>0)try{let Zt="";try{const Qs=(await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"TERM",WRK_CD:"03"})).find(Is=>Is.PROD_CMPS_CL==="23");Qs&&(Zt=Qs.PROD_CMPS_ID||""),console.log("[CompleteAS] EQT_PROD_CMPS_ID:",Zt)}catch(Us){console.log("[CompleteAS] getProdPromotionInfo   ():",Us)}const js=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"",hs=await la({MSG_ID:"SMR05",CUST_ID:((Ks=t.customer)==null?void 0:Ks.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Zt,PROD_CD:"",ITV_USR_ID:"",IP_CNT:"",ETC_1:"",ETC_2:"",ETC_3:"",ETC_4:"",SUB_PROD_CD:"",IF_DTL_ID:"",WRK_ID:t.id||"",REG_UID:Bt,VOIP_JOIN_CTRT_ID:js,WTIME:"3"});if((hs==null?void 0:hs.code)==="SUCCESS"||(hs==null?void 0:hs.code)==="PARTIAL")Es=(hs==null?void 0:hs.IF_DTL_ID)||"",console.log("[CompleteAS] SMR05 SUCCESS, IF_DTL_ID:",Es);else{const Us=(hs==null?void 0:hs.message)||(hs==null?void 0:hs.rawResult)||"";console.error("[CompleteAS] SMR05 FAILED:",Us),r==null||r(`   : ${Us}`,"error");return}}catch(Zt){console.error("[CompleteAS] SMR05 error:",Zt),r==null||r("     .","error");return}if(ps&&ys.length>0&&Ms)try{const Ds=((C==null?void 0:C.installedEquipments)||[]).find(Us=>{var Qs,Is;return(Us.ITEM_MID_CD||Us.itemMidCd||((Qs=Us.actualEquipment)==null?void 0:Qs.ITEM_MID_CD)||((Is=Us.actualEquipment)==null?void 0:Is.itemMidCd))==="08"}),js=(Ds==null?void 0:Ds.EQT_NO)||(Ds==null?void 0:Ds.id)||((Ls=Ds==null?void 0:Ds.actualEquipment)==null?void 0:Ls.EQT_NO)||((nt=Ds==null?void 0:Ds.actualEquipment)==null?void 0:nt.id)||"";console.log("[CompleteAS] VoIP IPC (SMR65) :",{eqtNo:js});const hs=await la({MSG_ID:"SMR65",CUST_ID:((Ft=t.customer)==null?void 0:Ft.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:js,EQT_PROD_CMPS_ID:"",PROD_CD:t.PROD_CD||t.PROD_CD||"",ITV_USR_ID:"",IP_CNT:"",ETC_1:"",ETC_2:"",ETC_3:"",ETC_4:"",SUB_PROD_CD:"",IF_DTL_ID:"",WRK_ID:t.id||"",REG_UID:Bt,WTIME:"3"});if((hs==null?void 0:hs.code)==="SUCCESS"||(hs==null?void 0:hs.code)==="PARTIAL")Es=(hs==null?void 0:hs.IF_DTL_ID)||"",console.log("[CompleteAS] SMR65 SUCCESS, IF_DTL_ID:",Es);else{const Us=(hs==null?void 0:hs.message)||(hs==null?void 0:hs.rawResult)||"";console.error("[CompleteAS] SMR65 FAILED:",Us),r==null||r(`IPC   : ${Us}`,"error");return}}catch(Zt){console.error("[CompleteAS] SMR65 error:",Zt),r==null||r("IPC     .","error");return}const cs={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Cs=t.customer)==null?void 0:Cs.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||wt.crrId||"01",WRKR_ID:Bt,WRKR_CMPL_DT:$e,MEMO:P||" ",STTL_YN:"Y",REG_UID:Bt,CUST_REL:L,CNFM_CUST_NM:((Ht=t.customer)==null?void 0:Ht.name)||"",CNFM_CUST_TELNO:((Os=t.customer)==null?void 0:Os.contactNumber)||"",INSTL_LOC:bt||"",PSN_USE_CORP:te||"",VOIP_USE_CORP:q||"",DTV_USE_CORP:F||"",WRK_ACT_CL:"20",NET_CL:(Ne==null?void 0:Ne.NET_CL)||"",WRNG_TP:(Ne==null?void 0:Ne.WRNG_TP)||"",INSTL_TP:(Ne==null?void 0:Ne.INSTL_TP)||"",KPI_PROD_GRP:K,OBS_RCPT_CD:O,OBS_RCPT_DTL_CD:A,CUST_CLEAN_YN:["MMA","MMB","MMC","II5"].includes(A)?"A":"",UP_CTRL_CL:pe.replace("[]",""),TV_TYPE:Re||"",VOIP_JOIN_CTRT_ID:T||"",ADD_ON:ts||""},equipmentList:It((C==null?void 0:C.installedEquipments)||[],!1),removeEquipmentList:It((C==null?void 0:C.removedEquipments)||[],!0),spendItemList:(C==null?void 0:C.spendItems)||[],agreementList:(C==null?void 0:C.agreements)||[],poleList:mt?[{WRK_ID:t.id,POLE_YN:mt.POLE_YN,LAN_GB:mt.LAN_GB||"",REG_UID:Bt}]:[]},ms=async()=>{var Zt,Ds,js,hs,Us,Qs;try{if((t.CERTIFY_TG||"")==="Y"){console.log("[CompleteAS] FTTH :  skip ( )");return}const _s=(C==null?void 0:C.installedEquipments)||[],Lr=["090901","091001","091002","091005"];let Ir=!1;for(const ws of _s){const Hn=ws.EQT_CL_CD||ws.eqtClCd||((Zt=ws.actualEquipment)==null?void 0:Zt.EQT_CL_CD)||((Ds=ws.actualEquipment)==null?void 0:Ds.eqtClCd)||"";if(Lr.includes(Hn))continue;(ws.EQT_KND||((js=ws.actualEquipment)==null?void 0:js.EQT_KND)||"WRKER")==="WRKER"&&(Ir=!0)}if(t.VOIP_CTX==="1"&&(Ir=!1),t.COLOR_RING_YN==="Y"&&(Ir=!1),!Ir){console.log("[CompleteAS]   : skip");return}const qr=t.PROD_GRP||"",vr=t.VOIP_PROD_CD||"";let cn="SMR03";qr==="V"?cn="SMR60":ze&&(cn="STB_CHG");let cr="",ni=t.PROD_CD||"",Fr="",Hi=qr;try{const ws=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"03"}),Hn=ws.find(Oi=>Oi.PROD_CMPS_CL==="23");Hn&&(cr=Hn.PROD_CMPS_ID||"");const Kr=ws.find(Oi=>Oi.PROD_CMPS_CL==="11");Kr&&(ni=Kr.PROD_CD||ni,Hi=Kr.PROD_GRP||qr);const Si=ws.filter(Oi=>Oi.BASIC_PROD_FL==="V").map(Oi=>Oi.PROD_CD);Si.length>0&&(Fr=Si.join(","))}catch(ws){console.log("[CompleteAS] getProdPromotionInfo for install signal failed:",ws)}const Or=ws=>_s.find(Hn=>{var Kr,Si;return(Hn.ITEM_MID_CD||Hn.itemMidCd||((Kr=Hn.actualEquipment)==null?void 0:Kr.ITEM_MID_CD)||((Si=Hn.actualEquipment)==null?void 0:Si.itemMidCd))===ws}),zi=ws=>{var Hn,Kr;return(ws==null?void 0:ws.EQT_NO)||(ws==null?void 0:ws.id)||((Hn=ws==null?void 0:ws.actualEquipment)==null?void 0:Hn.EQT_NO)||((Kr=ws==null?void 0:ws.actualEquipment)==null?void 0:Kr.id)||""};let Dr="";if(vr){const ws=Or("08");ws&&(Dr=zi(ws))}else{for(const ws of["05","01","03"]){const Hn=Or(ws);if(Hn){Dr=zi(Hn);break}}if(!Dr&&Hi==="I"){const ws=Or("02");ws&&(Dr=zi(ws))}if(!Dr){const ws=Or("08");ws&&(Dr=zi(ws))}}let Ta="";if(vr){const ws=Or("02");ws&&(Ta=zi(ws))}else{const ws=Or("04");ws&&(Ta=zi(ws))}const Fa=zi(Or("07")),Rs=Hi==="C"?zi(Or("02")):"",Pn=zi(Or("10"));let Qn=t.id||"";const Xr=_s.find(ws=>{var Hn,Kr;return(ws.EQT_CL_CD||ws.eqtClCd||((Hn=ws.actualEquipment)==null?void 0:Hn.EQT_CL_CD)||((Kr=ws.actualEquipment)==null?void 0:Kr.eqtClCd))==="091003"});if(Xr)Qn=zi(Xr);else{const ws=_s.find(Hn=>{var Kr,Si;return(Hn.EQT_CL_CD||Hn.eqtClCd||((Kr=Hn.actualEquipment)==null?void 0:Kr.EQT_CL_CD)||((Si=Hn.actualEquipment)==null?void 0:Si.eqtClCd))==="092201"});ws&&(Qn=(ws==null?void 0:ws.MAC_ADDRESS)||(ws==null?void 0:ws.macAddress)||((hs=ws==null?void 0:ws.actualEquipment)==null?void 0:hs.MAC_ADDRESS)||((Us=ws==null?void 0:ws.actualEquipment)==null?void 0:Us.macAddress)||"")}let Ni="";qr==="V"?Ni=vr?t.CTRT_ID||"":T||"":t.ISP_PROD_CD&&(Ni=T||"");const so=Es||t.IF_DTL_ID||"",ml=qr==="V"||cn==="SMR03"?"":so;console.log("[CompleteAS]  :",{msgId:cn,eqtNo:Dr,instProdCd:ni,instEqtProdCmpsId:cr,subProdCd:Fr}),await la({MSG_ID:cn,CUST_ID:((Qs=t.customer)==null?void 0:Qs.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Dr,EQT_PROD_CMPS_ID:cr,PROD_CD:ni,ITV_USR_ID:"",IP_CNT:"",ETC_1:Ta,ETC_2:Fa,ETC_3:Rs,ETC_4:Pn,SUB_PROD_CD:Fr,IF_DTL_ID:ml,WRK_ID:Qn,REG_UID:Bt,VOIP_JOIN_CTRT_ID:Ni,WTIME:"3"}),console.log("[CompleteAS]   ")}catch(Is){console.log("[CompleteAS]     (  ):",Is)}};v(cs,{onSuccess:Zt=>{Zt.code==="SUCCESS"||Zt.code==="OK"?(localStorage.removeItem(U()),t.WRK_STAT_CD="3",ms(),r==null||r("  .","success"),n()):r==null||r(Zt.message||"   .","error",!0)},onError:Zt=>{r==null||r(Zt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[R&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[H&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:T,onValueChange:j,options:k,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:se||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>me(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg ${d?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:d?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:L,onValueChange:w,options:De,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:K,onValueChange:B,options:Ue,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:O,onValueChange:S,options:ls,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:A,onValueChange:Y,options:Ss,placeholder:O?" ":"  ",required:!0,disabled:d||!O})]}),((C==null?void 0:C.kpiProdGrpCd)==="D"||(C==null?void 0:C.prodGrp)==="D"||t.PROD_GRP==="D")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(Zs,{value:pe,onValueChange:de,options:Ce,placeholder:" ",disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{className:"truncate",children:bt||t.installLocation||""}),We&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500 flex-shrink-0 whitespace-nowrap",children:["(: ",We,")"]})]}),s.jsx("button",{type:"button",onClick:()=>et(!0),className:`min-h-10 px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${d?"bg-gray-500 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:d?"":""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:P,onChange:$e=>G($e.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${d?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:d,disabled:d}),!d&&s.jsxs("p",{className:`text-xs text-right mt-1 ${P.length>=500?"text-red-500":"text-gray-400"}`,children:[P.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:ke,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>ae(!ee),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${ee?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ee&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"DTV ()"}),s.jsx(Zs,{value:F,onValueChange:I,options:Pe,placeholder:"",disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"ISP ()"}),s.jsx(Zs,{value:te,onValueChange:J,options:Be,placeholder:"",disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"VoIP (VoIP)"}),s.jsx(Zs,{value:q,onValueChange:V,options:Le,placeholder:"",disabled:d})]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!d&&s.jsx("button",{onClick:ht,disabled:R,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${R?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:R?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>ue(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:_e,onClose:()=>me(!1),onSave:Kt,workId:t.id,initialData:Ne,workType:t.WRK_CD,customerId:(Oe=t.customer)==null?void 0:Oe.id,customerName:(je=t.customer)==null?void 0:je.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD,kpiProdGrpCd:(C==null?void 0:C.kpiProdGrpCd)||(C==null?void 0:C.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(C==null?void 0:C.prodChgGb)||(C==null?void 0:C.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(C==null?void 0:C.chgKpiProdGrpCd)||(C==null?void 0:C.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(C==null?void 0:C.prodGrp)||(C==null?void 0:C.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:d}),s.jsx(Wa,{isOpen:ne,onClose:()=>ue(!1),ctrtId:t.CTRT_ID,custId:(tt=t.customer)==null?void 0:tt.id}),s.jsx(Of,{isOpen:xe,onClose:()=>et(!1),onSave:$e=>{it($e.INSTL_LOC),at($e.VIEW_MOD_CD),Dt($e.VIEW_MOD_NM),et(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(C==null?void 0:C.prodGrp)||(C==null?void 0:C.PROD_GRP),initialInstlLoc:bt||t.installLocation,initialViewModCd:At,initialViewModNm:We,showToast:r,readOnly:d}),s.jsx(Ng,{isOpen:ft,onClose:()=>Ot(!1),onSave:qt,soId:t.SO_ID||""}),s.jsx(ul,{isOpen:Tt,onClose:()=>St(!1),onConfirm:he,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{workType:"03",workTypeName:"A/S",custRel:L,custRelName:(Te=De.find($e=>$e.value===L))==null?void 0:Te.label,networkType:Z,networkTypeName:se,upCtrlCl:pe,upCtrlClName:(_t=Ce.find($e=>$e.value===pe))==null?void 0:_t.label,kpiProdGrp:K,kpiProdGrpName:(Qe=Ue.find($e=>$e.value===K))==null?void 0:Qe.label,obsRcptCd:O,obsRcptCdName:(yt=ls.find($e=>$e.value===O))==null?void 0:yt.label,obsRcptDtlCd:A,obsRcptDtlCdName:(vt=Ss.find($e=>$e.value===A))==null?void 0:vt.label,installedEquipments:(C==null?void 0:C.installedEquipments)||[],removedEquipments:(C==null?void 0:C.removedEquipments)||[],installLocation:bt?{position:bt}:void 0,memo:P})})]})},P3=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1})=>{var Kt,ht,qt,It;const c=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",d=t.WRK_DTL_TCD==="0440";t.WRK_DTL_TCD;const[u,f]=x.useState(!1),{equipmentData:m,filteringData:_}=$i(),{certifyRegconfInfo:y}=Ba(),g=t.id||"",N=oa(g),C={...m||i||_||{},installedEquipments:N.installedEquipments.length>0?N.installedEquipments:(m==null?void 0:m.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:N.markedForRemoval.length>0?N.markedForRemoval:(m==null?void 0:m.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(N.removalStatus).length>0?N.removalStatus:(m==null?void 0:m.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:v,isPending:R}=od(),U=()=>`work_complete_draft_${t.id}`,[L,w]=x.useState(""),[P,G]=x.useState(""),[K,B]=x.useState(""),[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(!1),[q,V]=x.useState(""),[F,I]=x.useState([]),[ee,ae]=x.useState(!1),[T,j]=x.useState([]),[k,Q]=x.useState(!1),[H,$]=x.useState(t.NET_CL||""),[ie,fe]=x.useState(t.NET_CL_NM||""),[pe,de]=x.useState(()=>{if(t.NET_CL)return{NET_CL:t.NET_CL||"",NET_CL_NM:t.NET_CL_NM||"",WRNG_TP:t.WRNG_TP||"",INSTL_TP:t.INSTL_TP||"",CB_WRNG_TP:t.CB_WRNG_TP||"",CB_INSTL_TP:t.CB_INSTL_TP||"",INOUT_LINE_TP:t.INOUT_LINE_TP||"",INOUT_LEN:t.INOUT_LEN||"",DVDR_YN:t.DVDR_YN||"",BFR_LINE_YN:t.BFR_LINE_YN||"",CUT_YN:t.CUT_YN||"",TERM_NO:t.TERM_NO||"",RCV_STS:t.RCV_STS||"",SUBTAP_ID:t.SUBTAP_ID||"",PORT_NUM:t.PORT_NUM||"",EXTN_TP:t.EXTN_TP||"",TAB_LBL:t.TAB_LBL||"",CVT_LBL:t.CVT_LBL||"",STB_LBL:t.STB_LBL||""}}),[Re,X]=x.useState(!1),[_e,me]=x.useState(!1),[Z,le]=x.useState(""),[se,Ee]=x.useState(""),[Ne,ye]=x.useState(""),[ne,ue]=x.useState(!1),[xe,et]=x.useState(null),[bt,it]=x.useState(!1),[At,at]=x.useState(""),[We,Dt]=x.useState(!1),[Tt,St]=x.useState(null),[ze,dt]=x.useState(!1),[Ke,rt]=x.useState(!1),[ft,Ot]=x.useState(!1),[mt,Ze]=x.useState([]),[De,Ye]=x.useState([]),[Ce,ge]=x.useState([]),[Be,ce]=x.useState([]),[Le,Xe]=x.useState([]),[Pe,Ct]=x.useState(()=>{const he=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(he&&he.length>=8)return`${he.slice(0,4)}-${he.slice(4,6)}-${he.slice(6,8)}`;const be=new Date;return be.getFullYear()+"-"+String(be.getMonth()+1).padStart(2,"0")+"-"+String(be.getDate()).padStart(2,"0")});x.useEffect(()=>{(async()=>{try{console.log("[WorkCompleteMove]    ");const be=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});be&&(console.log("[WorkCompleteMove]    :",{NET_CL:be.NET_CL,NET_CL_NM:be.NET_CL_NM}),c&&(w(be.CUST_REL||""),G((be.WRK_PROC_CT||"").replace(/\\n/g,`
`)),B(be.PSN_USE_CORP||""),S(be.VOIP_USE_CORP||""),Y(be.DTV_USE_CORP||""),be.WRKR_CMPL_DT&&be.WRKR_CMPL_DT.length>=8&&Ct(`${be.WRKR_CMPL_DT.slice(0,4)}-${be.WRKR_CMPL_DT.slice(4,6)}-${be.WRKR_CMPL_DT.slice(6,8)}`),be.VOIP_JOIN_CTRT_ID&&V(be.VOIP_JOIN_CTRT_ID)),$(be.NET_CL||""),fe(be.NET_CL_NM||""),le(Oe=>Oe||be.INSTL_LOC||""),de(Oe=>Oe||{NET_CL:be.NET_CL||"",NET_CL_NM:be.NET_CL_NM||"",WRNG_TP:be.WRNG_TP||"",INSTL_TP:be.INSTL_TP||"",CB_WRNG_TP:be.CB_WRNG_TP||"",CB_INSTL_TP:be.CB_INSTL_TP||"",INOUT_LINE_TP:be.INOUT_LINE_TP||"",INOUT_LEN:be.INOUT_LEN||"",DVDR_YN:be.DVDR_YN||"",BFR_LINE_YN:be.BFR_LINE_YN||"",CUT_YN:be.CUT_YN||"",TERM_NO:be.TERM_NO||"",RCV_STS:be.RCV_STS||"",SUBTAP_ID:be.SUBTAP_ID||"",PORT_NUM:be.PORT_NUM||"",EXTN_TP:be.EXTN_TP||"",TAB_LBL:be.TAB_LBL||"",CVT_LBL:be.CVT_LBL||"",STB_LBL:be.STB_LBL||""}))}catch(be){console.error("[WorkCompleteMove]    :",be)}if(!c){const be=localStorage.getItem(U());if(be)try{const Oe=JSON.parse(be);w(Oe.custRel||""),G(Oe.memo||""),Oe.installInfoData&&($(Oe.networkType||""),fe(Oe.networkTypeName||""),le(Oe.installLocationText||""),de(Oe.installInfoData)),Oe.voipJoinCtrtId&&V(Oe.voipJoinCtrtId)}catch(Oe){console.error("[WorkCompleteMove] localStorage  :",Oe)}}f(!0)})()},[t.id,c]),x.useEffect(()=>{if(!u||c)return;const he={custRel:L,memo:P,internetUse:K,voipUse:O,dtvUse:A,networkType:H,networkTypeName:ie,installLocationText:Z,installInfoData:pe,voipJoinCtrtId:q,savedAt:new Date().toISOString()};localStorage.setItem(U(),JSON.stringify(he))},[L,P,K,O,A,H,ie,Z,pe,q,u,c]);const Me=he=>!he||he.length!==8?"":`${he.slice(0,4)}-${he.slice(4,6)}-${he.slice(6,8)}`,lt=he=>he.replace(/-/g,""),ut=()=>new Date().toISOString().slice(0,10).replace(/-/g,""),jt=(he,be)=>{if(!he||!be)return 0;const Oe=new Date(Me(he)),je=new Date(Me(be));return Math.ceil((je.getTime()-Oe.getTime())/(1e3*60*60*24))},Ve=he=>new Date(he.getFullYear(),he.getMonth()+1,0),$t=he=>Ve(he).getDate()-he.getDate()<7,Ue=()=>{const he=new Date;let be;return $t(he)?be=new Date(he.getFullYear(),he.getMonth()+2,0):be=Ve(he),be.toISOString().slice(0,10)},ss=x.useCallback(async()=>{const he=t.RCPT_ID||"",be=t.CTRT_ID||"";if(!(!he||!be)){it(!0),St(null);try{const Oe=await f5({RCPT_ID:he,CTRT_ID:be});if(console.log("[CompleteMove]   :",Oe),Oe){et(Oe);const je=ut();if(Oe.WRK_DTL_TCD==="0430"&&Oe.MMT_SUS_HOPE_DD<=je){const tt=Ue();at(tt),Dt(!0),console.log("[CompleteMove]   -   :",tt),r==null||r("  .   .","warning")}else at(Me(Oe.MMT_SUS_HOPE_DD)),Dt(!1)}}catch(Oe){console.error("[CompleteMove]   :",Oe),St(Oe.message||"   ")}finally{it(!1)}}},[t.RCPT_ID,t.CTRT_ID,r]);x.useEffect(()=>{ss()},[ss]);const ls=he=>{const be=he.target.value;if(at(be),St(null),!xe)return;const Oe=Me(xe.SUS_HOPE_DD);if(be<Oe){St("   .");return}if(xe.VALID_SUS_DAYS&&parseInt(xe.VALID_SUS_DAYS)>0){const je=parseInt(xe.VALID_SUS_DAYS),tt=new Date(Oe),Te=new Date(tt);Te.setDate(Te.getDate()+je-1),new Date(be)>Te&&St(`   ${Te.toISOString().slice(0,10)}  .`)}},ds=()=>{if(!xe||!At)return;const he=Me(xe.SUS_HOPE_DD);if(At<he){r==null||r("   .","error");return}rt(!0),Dt(!1),r==null||r(" .   .","info")};x.useEffect(()=>{(async()=>{try{const be=await Jl(["CMCU005","CMCU057","CMCU110","CMCU148"]);be.CMCU005&&Ye(be.CMCU005.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM}))),be.CMCU057&&ge(be.CMCU057.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM}))),be.CMCU110&&ce(be.CMCU110.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM}))),be.CMCU148&&Xe(be.CMCU148.map(Oe=>({value:Oe.COMMON_CD,label:Oe.COMMON_CD_NM})))}catch(be){console.error("[WorkCompleteMove]   :",be)}})()},[]),x.useEffect(()=>{(async()=>{try{const be=await mc(),Oe=(be==null?void 0:be.output)||be||[];Ze(Oe);const je=t.PROD_CD||t.PROD_CD||"",tt=Oe.some(Te=>Te.PROD_CD===je);Ot(tt),console.log("[CompleteSuspend] LGHV :",{currentProdCd:je,isLghv:tt,prodListCount:Oe.length})}catch(be){console.error("[CompleteSuspend] LGHV   :",be)}})()},[t.PROD_CD]),x.useEffect(()=>{var Oe;if(c)return;const he=((Oe=t.customer)==null?void 0:Oe.id)||t.CUST_ID;if(!he)return;(async()=>{try{console.log("[WorkCompleteMove]     :",he);const je=await If({CUST_ID:he});console.log("[WorkCompleteMove]   :",je),j(je||[])}catch(je){console.error("[WorkCompleteMove]     :",je),j([])}})()},[(Kt=t.customer)==null?void 0:Kt.id,t.CUST_ID,c]),x.useEffect(()=>{if(c)return;if(T.length===0){console.log("[WorkCompleteMove]     ...");return}const he=t.PROD_GRP||"",be=t.VOIP_PROD_CD||"",Oe=t.ISP_PROD_CD||"",je=t.WRK_STAT_CD||"",tt=t.ADDR_ORD||"";if(console.log("[WorkCompleteMove]   :",{prodGrp:he,voipProdCd:be,ispProdCd:Oe,wrkStatCd:je,addrOrd:tt,customerCtrtListCount:T.length}),he==="V"&&!be){const Te=T.filter(Qe=>{const yt=Qe.PROD_GRP||"",vt=Qe.CTRT_STAT||"",$e=Qe.ADDR_ORD||Qe.addr_ord||"";return(yt==="C"||yt==="D"||yt==="I")&&vt==="20"&&(!tt||$e===tt)});console.log("[WorkCompleteMove] VoIP   :",Te),Te.length<1&&je==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const _t=[{value:"",label:""},...Te.map(Qe=>({value:Qe.CTRT_ID||"",label:`[${Qe.CTRT_ID}] ${Qe.BASIC_PROD_CD_NM||Qe.PROD_NM||""}`}))];I(_t),ae(!0);return}if(he==="I"&&Oe){const Te=T.filter(Qe=>{const yt=Qe.PROD_GRP||"",vt=Qe.CTRT_STAT||"",$e=Qe.ADDR_ORD||Qe.addr_ord||"",ot=Qe.ISP_JOIN_ID||"",wt=Qe.KPI_PROD_GRP_CD||"";return(yt==="D"||yt==="C")&&vt==="20"&&!ot&&wt==="D"&&(!tt||$e===tt)});console.log("[WorkCompleteMove] ISP   :",Te),Te.length<1&&je==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const _t=[{value:"",label:""},...Te.map(Qe=>({value:Qe.CTRT_ID||"",label:`[${Qe.CTRT_ID}] ${Qe.BASIC_PROD_CD_NM||Qe.PROD_NM||""}`}))];I(_t),ae(!0);return}ae(!1),I([])},[t.id,t.WRK_STAT_CD,c,r,T]);const Ss=()=>{var tt;const he=[];L||he.push("  ."),pe!=null&&pe.NET_CL||he.push(" ."),t.WRK_CD!=="04"&&!Z&&!t.installLocation&&he.push(" ."),Pe||he.push(" .");const be=t.PROD_GRP||"";if(t.WRK_DTL_TCD==="0430")(((tt=C==null?void 0:C.installedEquipments)==null?void 0:tt.length)||0)>0&&he.push("  .");else{const Te=(C==null?void 0:C.installedEquipments)||[];be!=="V"&&Te.length<1&&he.push("()  .")}const Oe=t.VOIP_PROD_CD||"",je=t.ISP_PROD_CD||"";return be==="V"&&!Oe&&ee&&(q||he.push("VOIP    .")),be==="I"&&je&&ee&&(q||he.push("  ISP .    .")),he},Ns=he=>{de(he),he.NET_CL&&$(he.NET_CL),he.NET_CL_NM&&fe(he.NET_CL_NM),r==null||r("  .","success")},ke=()=>{if(R)return;const he=Ss();if(he.length>0){he.forEach(be=>r==null?void 0:r(be,"error"));return}ue(!0)},ct=(he,be=!1)=>{if(!he||he.length===0)return[];const Oe=localStorage.getItem("userInfo"),je=Oe?JSON.parse(Oe):{},tt=je.userId||"A20130708",Te=(C==null?void 0:C.removalStatus)||{},_t=(Qe,yt)=>Qe==="1"||Qe==="Y"||yt==="1"||yt==="Y"?"1":"0";return he.map(Qe=>{var ot,wt,Bt;const yt=Qe.EQT_NO||Qe.id||((ot=Qe.actualEquipment)==null?void 0:ot.id)||"",vt=Te[yt]||{},$e=be?{CRR_TSK_CL:t.WRK_CD||"04",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||je.crrId||"01",WRKR_ID:tt,EQT_LOSS_YN:_t(Qe.EQT_LOSS_YN,vt.EQT_LOSS_YN),PART_LOSS_BRK_YN:_t(Qe.PART_LOSS_BRK_YN,vt.PART_LOSS_BRK_YN),EQT_BRK_YN:_t(Qe.EQT_BRK_YN,vt.EQT_BRK_YN),EQT_CABL_LOSS_YN:_t(Qe.EQT_CABL_LOSS_YN,vt.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:_t(Qe.EQT_CRDL_LOSS_YN,vt.EQT_CRDL_LOSS_YN)}:{};if(Qe.actualEquipment){const Yt=Qe.actualEquipment,Xt=Qe.contractEquipment||{};return{...Yt,EQT_NO:Yt.id,EQT_SERNO:Yt.serialNumber,ITEM_MID_CD:Yt.itemMidCd,EQT_CL_CD:Yt.eqtClCd,MAC_ADDRESS:Qe.macAddress||Yt.macAddress,WRK_ID:t.id,CUST_ID:(wt=t.customer)==null?void 0:wt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:tt,SVC_CMPS_ID:Xt.SVC_CMPS_ID||Qe.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Xt.BASIC_PROD_CMPS_ID||Qe.BASIC_PROD_CMPS_ID||"",PROD_CMPS_ID:Xt.PROD_CMPS_ID||Qe.PROD_CMPS_ID||"",SVC_CD:Xt.SVC_CD||Qe.SVC_CD||"",PROD_CD:Xt.PROD_CD||Qe.PROD_CD||"",LENT_YN:Qe.lentYn||Qe.LENT_YN||Xt.LENT_YN||"",EQT_CHG_GB:Qe.EQT_CHG_GB||"01",...$e}}return{...Qe,EQT_NO:Qe.EQT_NO||Qe.id||"",EQT_SERNO:Qe.EQT_SERNO||Qe.serialNumber||"",ITEM_MID_CD:Qe.ITEM_MID_CD||Qe.itemMidCd||"",EQT_CL_CD:Qe.EQT_CL_CD||Qe.eqtClCd||"",MAC_ADDRESS:Qe.MAC_ADDRESS||Qe.macAddress||"",SVC_CMPS_ID:Qe.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Qe.BASIC_PROD_CMPS_ID||"",PROD_CD:Qe.PROD_CD||"",SVC_CD:Qe.SVC_CD||"",WRK_ID:t.id,CUST_ID:(Bt=t.customer)==null?void 0:Bt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:tt,...$e}})},st=async()=>{var ot,wt,Bt,Yt;const he=Pe.replace(/-/g,""),be=localStorage.getItem("userInfo"),Oe=be?JSON.parse(be):{},je=Oe.userId||"A20130708";if(Ke&&xe&&At){dt(!0);try{const Xt=xe.SUS_HOPE_DD,ts=lt(At),Ut=jt(Xt,ts),Es=await m5({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",SUS_HOPE_DD:Xt,MMT_SUS_HOPE_DD:ts,SUS_DD_NUM:String(Ut),REG_UID:je});if(Es.code!=="SUCCESS"){r==null||r(Es.message||"  ","error",!0),dt(!1);return}console.log("[CompleteMove]   ")}catch(Xt){r==null||r(Xt.message||"  ","error",!0),dt(!1);return}dt(!1)}const tt=(C==null?void 0:C.removedEquipments)||[],Te=(C==null?void 0:C.customerEquipments)||[],_t=(C==null?void 0:C.installedEquipments)||[],Qe=!!t.ISP_PROD_CD;if((t.WRK_DTL_TCD==="0430"||t.WRK_DTL_TCD==="0470")&&(tt.length>0||Te.length>0||_t.length>0||Qe))try{let Xt="SMR05",ts="";ft&&(Xt="STB_DEL");const Ut=tt[0],Es=Ut.actualEquipment||Ut,ys=Es.PROD_CMPS_ID||Ut.PROD_CMPS_ID||Es.EQT_PROD_CMPS_ID||Ut.EQT_PROD_CMPS_ID||"",ps=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"";console.log("[CompleteMove]   :",{msgId:Xt,isLghvStb:ft,etc1:ts,eqtProdCmpsId:ys});const vs=await la({MSG_ID:Xt,CUST_ID:((ot=t.customer)==null?void 0:ot.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:ys,PROD_CD:"",WRK_ID:t.id||"",REG_UID:je,ETC_1:ts,VOIP_JOIN_CTRT_ID:ps,WTIME:"3"});vs.code!=="SUCCESS"&&vs.code!=="OK"?(console.warn("[CompleteMove]    -  :",vs.message),r==null||r("   .","warning")):console.log("[CompleteMove]    ")}catch(Xt){console.warn("[CompleteMove]      -  :",Xt),r==null||r("     .","warning")}const vt=async()=>{var Es,ys;const Xt=(C==null?void 0:C.customerEquipments)||[],ts=(C==null?void 0:C.installedEquipments)||[],Ut=!!t.ISP_PROD_CD;if(t.WRK_DTL_TCD==="0440"&&(Xt.length>0||ts.length>0||Ut))try{const Ps=t.PROD_GRP||"";let ps="SMR03",vs="",Ms="",cs="",ms="",Ks="",Ls="";Ps==="V"?ps="SMR60":ft&&(ps="STB_CRT");let nt=(C==null?void 0:C.prodPromoInfo)||[];if(nt.length===0)try{nt=await dl({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:je,PROD_CD:t.PROD_CD||"",CRR_TSK_CL:t.WRK_CD||"04",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||"",WRK_CD:t.WRK_CD||"04",WRK_STAT_CD:t.WRK_STAT_CD||""})}catch(Qs){console.log("[CompleteSuspend] prodPromoInfo  :",Qs)}const Ft=((Es=nt.find(Qs=>Qs.PROD_CMPS_CL==="23"))==null?void 0:Es.PROD_CMPS_ID)||"",Cs=nt.find(Qs=>Qs.PROD_CMPS_CL==="11"),Ht=(Cs==null?void 0:Cs.PROD_CD)||"",Os=(Cs==null?void 0:Cs.PROD_GRP)||Ps,Zt=nt.filter(Qs=>Qs.BASIC_PROD_FL==="V").map(Qs=>Qs.PROD_CD),Ds=Zt.length>0?Zt.join(","):"",js=[...Xt,...ts],hs=Qs=>{const Is=js.find(Lr=>{const Ir=Lr.actualEquipment||Lr;return(Ir.itemMidCd||Ir.ITEM_MID_CD)===Qs});if(!Is)return"";const _s=Is.actualEquipment||Is;return _s.id||_s.EQT_NO||""};t.VOIP_PROD_CD?(vs=hs("08"),Ms=hs("02")):(vs=hs("05")||hs("01")||hs("03")||(Os==="I"?hs("02"):"")||hs("08")||"",Ms=hs("04")),cs=hs("07"),Os==="C"&&(ms=hs("02")),Os==="V"&&(Ks=hs("10")),Ut&&(Ks=hs("21")),(Ps==="V"||Ut)&&(Ls=q||t.CTRT_ID||"");let Us=t.id||"";for(const Qs of js){const Is=Qs.actualEquipment||Qs,_s=Is.eqtClCd||Is.EQT_CL_CD||"";if(_s==="091003"||_s==="091004"){Us=Is.id||Is.EQT_NO||t.id||"";break}if(_s==="092201"){Us=Is.macAddress||Is.MAC_ADDRESS||Is.id||Is.EQT_NO||t.id||"";break}}console.log("[CompleteSuspend]   :",{msgId:ps,eqtNo:vs,prodCd:Ht,subProdCd:Ds,etc1:Ms,etc2:cs,etc3:ms,etc4:Ks}),await la({MSG_ID:ps,CUST_ID:((ys=t.customer)==null?void 0:ys.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:vs,EQT_PROD_CMPS_ID:Ft,PROD_CD:Ht,ITV_USR_ID:"",IP_CNT:"",ETC_1:Ms,ETC_2:cs,ETC_3:ms,ETC_4:Ks,SUB_PROD_CD:Ds,IF_DTL_ID:"",WRK_ID:Us,REG_UID:je,VOIP_JOIN_CTRT_ID:Ls,WTIME:"3"}),console.log("[CompleteSuspend]    ")}catch(Ps){console.log("[CompleteSuspend]      (  ):",Ps)}},$e={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(wt=t.customer)==null?void 0:wt.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||Oe.crrId||"01",WRKR_ID:je,WRKR_CMPL_DT:he,MEMO:P||" ",STTL_YN:"Y",REG_UID:je,CUST_REL:L,CNFM_CUST_NM:((Bt=t.customer)==null?void 0:Bt.name)||"",CNFM_CUST_TELNO:((Yt=t.customer)==null?void 0:Yt.contactNumber)||"",INSTL_LOC:Z||t.installLocation||"",PSN_USE_CORP:K||"",VOIP_USE_CORP:O||"",DTV_USE_CORP:A||"",WRK_ACT_CL:"20",NET_CL:(pe==null?void 0:pe.NET_CL)||"",WRNG_TP:(pe==null?void 0:pe.WRNG_TP)||"",INSTL_TP:(pe==null?void 0:pe.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:q||""},equipmentList:ct((C==null?void 0:C.installedEquipments)||[],!1),removeEquipmentList:ct((C==null?void 0:C.removedEquipments)||[],!0),spendItemList:(C==null?void 0:C.spendItems)||[],agreementList:(C==null?void 0:C.agreements)||[],poleList:(C==null?void 0:C.poleResults)||[]};v($e,{onSuccess:Xt=>{Xt.code==="SUCCESS"||Xt.code==="OK"?(localStorage.removeItem(U()),t.WRK_STAT_CD="3",vt(),r==null||r("  .","success"),n()):r==null||r(Xt.message||"   .","error",!0)},onError:Xt=>{r==null||r(Xt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[R&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[d&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:" .   ."})}),ee&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:q,onValueChange:V,options:F,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:ie||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>Q(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg ${c?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:L,onValueChange:w,options:De,placeholder:" ",required:!0,disabled:c})]}),t.WRK_CD!=="04"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{className:"truncate",children:Z||t.installLocation||""}),Ne&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500 flex-shrink-0 whitespace-nowrap",children:["(: ",Ne,")"]})]}),s.jsx("button",{type:"button",onClick:()=>me(!0),className:`min-h-10 px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${c?"bg-gray-500 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:P,onChange:he=>G(he.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:c,disabled:c}),!c&&s.jsxs("p",{className:`text-xs text-right mt-1 ${P.length>=500?"text-red-500":"text-gray-400"}`,children:[P.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Pe,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 border border-indigo-200",children:[s.jsxs("div",{className:"text-sm font-semibold text-indigo-800 mb-2 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Cf,{size:16}),""]}),!c&&xe&&!We&&s.jsx("button",{type:"button",onClick:()=>Dt(!0),className:"px-2 py-0.5 bg-indigo-500 hover:bg-indigo-600 text-white rounded text-xs font-medium",children:""})]}),bt?s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-500"})," ..."]}):xe?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"date",value:Me(xe.SUS_HOPE_DD),disabled:!0,className:"flex-1 px-2 py-1.5 border border-gray-300 rounded bg-gray-100 text-gray-600 text-sm"}),s.jsx("span",{className:"text-gray-500",children:"~"}),We&&!c?s.jsx("input",{type:"date",value:At,onChange:ls,min:Me(xe.SUS_HOPE_DD),className:"flex-1 px-2 py-1.5 border border-indigo-300 rounded bg-white text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):s.jsx("input",{type:"date",value:Ke?At:Me(xe.MMT_SUS_HOPE_DD),disabled:!0,className:`flex-1 px-2 py-1.5 border rounded text-sm ${Ke?"border-orange-300 bg-orange-50 text-orange-700":"border-gray-300 bg-gray-100 text-gray-600"}`})]}),We&&!c&&At&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-indigo-600",children:[": ",jt(xe.SUS_HOPE_DD,lt(At)),""]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",onClick:()=>{Dt(!1),rt(!1),at(Me(xe.MMT_SUS_HOPE_DD)),St(null)},className:"px-3 py-1 bg-gray-400 hover:bg-gray-500 text-white rounded text-xs font-medium",children:""}),s.jsx("button",{type:"button",onClick:ds,disabled:!!Tt,className:"px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white rounded text-xs font-medium disabled:opacity-50",children:""})]})]}),Ke&&!We&&!c&&s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"  (  )"}),s.jsx("button",{type:"button",onClick:()=>Dt(!0),className:"px-2 py-0.5 bg-orange-500 hover:bg-orange-600 text-white rounded text-xs font-medium",children:" "})]}),Tt&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[s.jsx(Wr,{size:12}),Tt]})]}):s.jsx("div",{className:"text-sm text-gray-500",children:"  "})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!c&&s.jsx("button",{onClick:ke,disabled:R,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${R?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:R?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>X(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:k,onClose:()=>Q(!1),onSave:Ns,workId:t.id,initialData:pe,workType:t.WRK_CD,customerId:(ht=t.customer)==null?void 0:ht.id,customerName:(qt=t.customer)==null?void 0:qt.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(C==null?void 0:C.kpiProdGrpCd)||(C==null?void 0:C.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(C==null?void 0:C.prodChgGb)||(C==null?void 0:C.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(C==null?void 0:C.chgKpiProdGrpCd)||(C==null?void 0:C.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(C==null?void 0:C.prodGrp)||(C==null?void 0:C.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:c}),s.jsx(Wa,{isOpen:Re,onClose:()=>X(!1),ctrtId:t.CTRT_ID,custId:(It=t.customer)==null?void 0:It.id}),s.jsx(Of,{isOpen:_e,onClose:()=>me(!1),onSave:he=>{le(he.INSTL_LOC),Ee(he.VIEW_MOD_CD),ye(he.VIEW_MOD_NM),me(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(C==null?void 0:C.prodGrp)||(C==null?void 0:C.PROD_GRP),initialInstlLoc:Z||t.installLocation,initialViewModCd:se,initialViewModNm:Ne,showToast:r,readOnly:c}),s.jsx(ul,{isOpen:ne,onClose:()=>ue(!1),onConfirm:st,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{equipmentData:C,installInfoData:pe,custRel:L,custRelOptions:De,memo:P,installLocationText:Z,order:t})})]})},E5=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1})=>{var st,Kt,ht,qt,It,he;const d=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",u=t.WRK_DTL_TCD!=="0510",[f,m]=x.useState(!1),{equipmentData:_,filteringData:y}=$i(),{certifyRegconfInfo:g}=Ba(),N=t.id||"",C=oa(N),v={..._||i||y||{},installedEquipments:C.installedEquipments.length>0?C.installedEquipments:(_==null?void 0:_.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:C.markedForRemoval.length>0?C.markedForRemoval:(_==null?void 0:_.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(C.removalStatus).length>0?C.removalStatus:(_==null?void 0:_.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:R,isPending:U}=od(),L=()=>`work_complete_draft_${t.id}`,[w,P]=x.useState(""),[G,K]=x.useState(""),[B,O]=x.useState(""),[S,A]=x.useState(""),[Y,te]=x.useState(""),[J,q]=x.useState(""),[V,F]=x.useState(!1),[I,ee]=x.useState(""),[ae,T]=x.useState([]),[j,k]=x.useState(!1),[Q,H]=x.useState([]),[$,ie]=x.useState(!1),[fe,pe]=x.useState(!1),[de,Re]=x.useState(""),[X,_e]=x.useState(""),[me,Z]=x.useState(void 0),[le,se]=x.useState(void 0),[Ee,Ne]=x.useState(!1),[ye,ne]=x.useState(!1),[ue,xe]=x.useState(""),[et,bt]=x.useState(""),[it,At]=x.useState(""),[at,We]=x.useState(!1),[Dt,Tt]=x.useState(!1),[St,ze]=x.useState(null),[dt,Ke]=x.useState([]),[rt,ft]=x.useState([]),[Ot,mt]=x.useState([]),[Ze,De]=x.useState([]),[Ye,Ce]=x.useState([]),[ge,Be]=x.useState(!1),[ce,Le]=x.useState([]),[Xe,Pe]=x.useState(!1),[Ct,Me]=x.useState(""),[lt,ut]=x.useState(!1),[jt,Ve]=x.useState("B"),[$t,Ue]=x.useState(()=>{const be=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(be&&be.length>=8)return`${be.slice(0,4)}-${be.slice(4,6)}-${be.slice(6,8)}`;const Oe=new Date;return Oe.getFullYear()+"-"+String(Oe.getMonth()+1).padStart(2,"0")+"-"+String(Oe.getDate()).padStart(2,"0")});x.useEffect(()=>{if(d){(async()=>{try{const je=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(je){P(je.CUST_REL||""),K((je.WRK_PROC_CT||"").replace(/\\n/g,`
`)),O(je.PSN_USE_CORP||""),A(je.VOIP_USE_CORP||""),te(je.DTV_USE_CORP||"");const tt=je.UP_CTRL_CL||(v==null?void 0:v.upCtrlCl)||"";console.log("[CompleteChange]  :",{API:je.UP_CTRL_CL,:v==null?void 0:v.upCtrlCl,:tt}),q(tt),Re(je.NET_CL||""),_e(je.NET_CL_NM||""),xe(je.INSTL_LOC||""),Z({NET_CL:je.NET_CL||"",NET_CL_NM:je.NET_CL_NM||"",WRNG_TP:je.WRNG_TP||"",INSTL_TP:je.INSTL_TP||"",CB_WRNG_TP:je.CB_WRNG_TP||"",CB_INSTL_TP:je.CB_INSTL_TP||"",INOUT_LINE_TP:je.INOUT_LINE_TP||"",INOUT_LEN:je.INOUT_LEN||"",DVDR_YN:je.DVDR_YN||"",BFR_LINE_YN:je.BFR_LINE_YN||"",CUT_YN:je.CUT_YN||"",TERM_NO:je.TERM_NO||"",RCV_STS:je.RCV_STS||"",SUBTAP_ID:je.SUBTAP_ID||"",PORT_NUM:je.PORT_NUM||"",EXTN_TP:je.EXTN_TP||"",TAB_LBL:je.TAB_LBL||"",CVT_LBL:je.CVT_LBL||"",STB_LBL:je.STB_LBL||""}),bt(je.VIEW_MOD_CD||""),At(je.VIEW_MOD_NM||""),je.VOIP_JOIN_CTRT_ID&&ee(je.VOIP_JOIN_CTRT_ID),je.WRKR_CMPL_DT&&je.WRKR_CMPL_DT.length>=8&&Ue(`${je.WRKR_CMPL_DT.slice(0,4)}-${je.WRKR_CMPL_DT.slice(4,6)}-${je.WRKR_CMPL_DT.slice(6,8)}`)}}catch(je){console.error("[WorkCompleteChange]     :",je)}m(!0)})();return}const be=localStorage.getItem(L());if(be)try{const Oe=JSON.parse(be);P(Oe.custRel||""),K(Oe.memo||""),O(Oe.internetUse||""),A(Oe.voipUse||""),te(Oe.dtvUse||""),q(Oe.upCtrlCl||""),Re(Oe.networkType||""),_e(Oe.networkTypeName||""),xe(Oe.installLocationText||""),Z(Oe.installInfoData),se(Oe.removalInfoData),bt(Oe.viewModCd||""),At(Oe.viewModNm||""),Oe.voipJoinCtrtId&&ee(Oe.voipJoinCtrtId)}catch(Oe){console.error("[WorkCompleteChange] localStorage  :",Oe)}m(!0)},[t.id,d]),x.useEffect(()=>{if(!f||d)return;const be={custRel:w,memo:G,internetUse:B,voipUse:S,dtvUse:Y,upCtrlCl:J,networkType:de,networkTypeName:X,installLocationText:ue,installInfoData:me,removalInfoData:le,viewModCd:et,viewModNm:it,voipJoinCtrtId:I,savedAt:new Date().toISOString()};localStorage.setItem(L(),JSON.stringify(be))},[w,G,B,S,Y,J,de,X,ue,me,le,et,it,I,f,d]),x.useEffect(()=>{(async()=>{try{const Oe=await Jl(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);Oe.CMCU005&&Ke(Oe.CMCU005.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),Oe.CMCT015&&(console.log("[CompleteChange]  CMCT015 :",Oe.CMCT015),ft(Oe.CMCT015.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM})))),Oe.CMCU057&&mt(Oe.CMCU057.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),Oe.CMCU110&&De(Oe.CMCU110.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),Oe.CMCU148&&Ce(Oe.CMCU148.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM})))}catch(Oe){console.error("[WorkCompleteChange]   :",Oe)}})()},[]),x.useEffect(()=>{(async()=>{try{const Oe=await mc();Le(Oe||[]),console.log("[CompleteChange] LGHV  :",Oe==null?void 0:Oe.length);const je=t.PROD_CD||t.BASIC_PROD_CD||"";if(je&&Oe&&Oe.length>0){const tt=Oe.some(Te=>Te.PROD_CD===je);Be(tt),console.log("[CompleteChange] LGHV STB :",tt,"PROD_CD:",je)}}catch(Oe){console.error("[CompleteChange] LGHV    :",Oe)}})()},[t.id]),x.useEffect(()=>{(async()=>{const Oe=t.PROD_CD||t.PROD_CD||"",je=(v==null?void 0:v.prodPromoInfo)||[];if(Oe==="PD10018480")console.log("[CompleteChange] OTT   :",Oe),ut(!0),Ve("C");else if(je.some(_t=>_t.PROD_CD==="PD10018160"))console.log("[CompleteChange] OTT   : PD10018160"),ut(!0),Ve("B");else{ut(!1);return}const tt=t.id||"",Te=t.directionId||t.WRK_DRCTN_ID||"";if(tt&&Te)try{const _t=await sx({WRK_ID:tt,WRK_DRCTN_ID:Te,DATA_TYPE:Oe==="PD10018480"?"C":"B"});_t!=null&&_t.EQT_SERNO&&(console.log("[CompleteChange]  OTT :",_t.EQT_SERNO),Me(_t.EQT_SERNO))}catch(_t){console.error("[CompleteChange] OTT   :",_t)}})()},[t.PROD_CD,t.id,t.directionId,v==null?void 0:v.prodPromoInfo]),x.useEffect(()=>{v!=null&&v.upCtrlCl&&!J?(console.log("[CompleteChange] equipmentData  :",v.upCtrlCl),q(v.upCtrlCl)):!J&&f&&!d&&(console.log("[CompleteChange]   : 01 ()"),q("01"))},[v==null?void 0:v.upCtrlCl,f,d,J]),x.useEffect(()=>{var je;if(d)return;const be=((je=t.customer)==null?void 0:je.id)||t.CUST_ID;if(!be)return;(async()=>{try{console.log("[WorkCompleteChange]     :",be);const tt=await If({CUST_ID:be});console.log("[WorkCompleteChange]   :",tt),H(tt||[])}catch(tt){console.error("[WorkCompleteChange]     :",tt),H([])}})()},[(st=t.customer)==null?void 0:st.id,t.CUST_ID,d]),x.useEffect(()=>{if(d)return;if(Q.length===0){console.log("[WorkCompleteChange]     ...");return}const be=t.PROD_GRP||"",Oe=t.VOIP_PROD_CD||"",je=t.ISP_PROD_CD||"",tt=t.WRK_STAT_CD||"",Te=t.ADDR_ORD||"";if(console.log("[WorkCompleteChange]   :",{prodGrp:be,voipProdCd:Oe,ispProdCd:je,wrkStatCd:tt,addrOrd:Te,customerCtrtListCount:Q.length}),be==="V"&&!Oe){const _t=Q.filter(yt=>{const vt=yt.PROD_GRP||"",$e=yt.CTRT_STAT||"",ot=yt.ADDR_ORD||yt.addr_ord||"";return(vt==="C"||vt==="D"||vt==="I")&&$e==="20"&&(!Te||ot===Te)});console.log("[WorkCompleteChange] VoIP   :",_t),_t.length<1&&tt==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const Qe=[{value:"",label:""},..._t.map(yt=>({value:yt.CTRT_ID||"",label:`[${yt.CTRT_ID}] ${yt.BASIC_PROD_CD_NM||yt.PROD_NM||""}`}))];T(Qe),k(!0);return}if(be==="I"&&je){const _t=Q.filter(yt=>{const vt=yt.PROD_GRP||"",$e=yt.CTRT_STAT||"",ot=yt.ADDR_ORD||yt.addr_ord||"",wt=yt.ISP_JOIN_ID||"",Bt=yt.KPI_PROD_GRP_CD||"";return(vt==="D"||vt==="C")&&$e==="20"&&!wt&&Bt==="D"&&(!Te||ot===Te)});console.log("[WorkCompleteChange] ISP   :",_t),_t.length<1&&tt==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const Qe=[{value:"",label:""},..._t.map(yt=>({value:yt.CTRT_ID||"",label:`[${yt.CTRT_ID}] ${yt.BASIC_PROD_CD_NM||yt.PROD_NM||""}`}))];T(Qe),k(!0);return}k(!1),T([])},[t.id,t.WRK_STAT_CD,d,r,Q]);const ss=()=>{const be=[];t.WRKR_ID||""||be.push("  ."),w||be.push("  ."),me!=null&&me.NET_CL||be.push(" ."),me!=null&&me.WRNG_TP||be.push(" ."),me!=null&&me.INSTL_TP||be.push(" ."),!ue&&!t.installLocation&&be.push(" ."),$t||be.push(" ."),B||be.push("  ."),S||be.push("VoIP  ."),Y||be.push("DTV  .");const je=t.PROD_GRP||"",tt=t.VOIP_PROD_CD||"",Te=t.ISP_PROD_CD||"";je==="V"&&!tt&&j&&(I||be.push("VOIP    .")),je==="I"&&Te&&j&&(I||be.push("  ISP .    ."));const _t=(v==null?void 0:v.installedEquipments)||[];return je!=="V"&&_t.length<1&&be.push("()  ."),lt&&!Ct&&be.push("OTT   OTT BOX   ."),be},ls=be=>{Z(be),be.NET_CL&&Re(be.NET_CL),be.NET_CL_NM&&_e(be.NET_CL_NM),r==null||r("  .","success")},ds=be=>{se(be),r==null||r("  .","success")},Ss=()=>{if(U)return;const be=ss();if(be.length>0){be.forEach(je=>r==null?void 0:r(je,"error"));return}(t.PROD_GRP||"")!=="V"?Tt(!0):We(!0)},Ns=be=>{ze(be),Tt(!1),We(!0)},ke=(be,Oe=!1)=>{if(!be||be.length===0)return[];const je=localStorage.getItem("userInfo"),tt=je?JSON.parse(je):{},Te=tt.userId||"A20130708",_t=(v==null?void 0:v.removalStatus)||{},Qe=(Bt,Yt)=>Bt==="1"||Bt==="Y"||Yt==="1"||Yt==="Y"?"1":"0",yt=(v==null?void 0:v.removedEquipments)||[],vt=(Bt,Yt)=>{const Xt=yt.find(ts=>(ts.itemMidCd===Bt||ts.ITEM_MID_CD===Bt)&&ts[Yt]);return(Xt==null?void 0:Xt[Yt])||""},$e=Bt=>vt(Bt,"BASIC_PROD_CMPS_ID"),ot=Bt=>vt(Bt,"LENT")||vt(Bt,"LENT_YN"),wt=Bt=>vt(Bt,"SVC_CMPS_ID");return be.map(Bt=>{var cs,ms,Ks;const Yt=Bt.EQT_NO||Bt.id||((cs=Bt.actualEquipment)==null?void 0:cs.id)||"",Xt=_t[Yt]||{},ts=Oe?{}:{CRR_TSK_CL:"01",CHG_UID:Te},Ut=Oe?{CRR_TSK_CL:"02",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||tt.crrId||"01",WRKR_ID:Te,REG_UID:Te,EQT_LOSS_YN:Qe(Bt.EQT_LOSS_YN,Xt.EQT_LOSS_YN),PART_LOSS_BRK_YN:Qe(Bt.PART_LOSS_BRK_YN,Xt.PART_LOSS_BRK_YN),EQT_BRK_YN:Qe(Bt.EQT_BRK_YN,Xt.EQT_BRK_YN),EQT_CABL_LOSS_YN:Qe(Bt.EQT_CABL_LOSS_YN,Xt.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Qe(Bt.EQT_CRDL_LOSS_YN,Xt.EQT_CRDL_LOSS_YN)}:{},Es=t.DTL_CTRT_ID||t.CTRT_ID||"",ys=Bt.CTRT_ID||t.CTRT_ID||"";if(Bt.actualEquipment){const Ls=Bt.actualEquipment,nt=Bt.contractEquipment||{},Ft=Ls.itemMidCd||Ls.ITEM_MID_CD||"",Cs=nt.BASIC_PROD_CMPS_ID||Bt.BASIC_PROD_CMPS_ID||$e(Ft),Ht=nt.LENT||nt.LENT_YN||Bt.LENT||Bt.lentYn||Bt.LENT_YN||ot(Ft),Os=nt.SVC_CMPS_ID||Bt.SVC_CMPS_ID||wt(Ft);return{...Ls,EQT_NO:Ls.id,EQT_SERNO:Ls.serialNumber,ITEM_MID_CD:Ft,EQT_CL_CD:Ls.eqtClCd,MAC_ADDRESS:Bt.macAddress||Ls.macAddress,WRK_ID:t.id,CUST_ID:(ms=t.customer)==null?void 0:ms.id,CTRT_ID:Oe?ys:Es,WRK_CD:t.WRK_CD,REG_UID:Te,SVC_CMPS_ID:Os,BASIC_PROD_CMPS_ID:Cs,PROD_CMPS_ID:nt.PROD_CMPS_ID||Bt.PROD_CMPS_ID||"",SVC_CD:nt.SVC_CD||Bt.SVC_CD||"",PROD_CD:nt.PROD_CD||Bt.PROD_CD||"",LENT_YN:Ht,EQT_CHG_GB:Bt.EQT_CHG_GB||"01",...ts,...Ut}}const Ps=Bt.ITEM_MID_CD||Bt.itemMidCd||"",ps=Bt.BASIC_PROD_CMPS_ID||$e(Ps),vs=Bt.LENT||Bt.LENT_YN||Bt.lentYn||ot(Ps),Ms=Bt.SVC_CMPS_ID||wt(Ps);return{...Bt,EQT_NO:Bt.EQT_NO||Bt.id||"",EQT_SERNO:Bt.EQT_SERNO||Bt.serialNumber||"",ITEM_MID_CD:Ps,EQT_CL_CD:Bt.EQT_CL_CD||Bt.eqtClCd||"",MAC_ADDRESS:Bt.MAC_ADDRESS||Bt.macAddress||"",SVC_CMPS_ID:Ms,BASIC_PROD_CMPS_ID:ps,LENT_YN:vs,PROD_CD:Bt.PROD_CD||"",SVC_CD:Bt.SVC_CD||"",WRK_ID:t.id,CUST_ID:(Ks=t.customer)==null?void 0:Ks.id,CTRT_ID:Oe?ys:Es,WRK_CD:t.WRK_CD,REG_UID:Te,...ts,...Ut}})},ct=async()=>{var Ps,ps,vs,Ms,cs,ms,Ks,Ls,nt,Ft,Cs;const be=$t.replace(/-/g,""),Oe=localStorage.getItem("userInfo"),je=Oe?JSON.parse(Oe):{},tt=je.userId||"A20130708",Te=c||Mh(t.OP_LNKD_CD),_t=await bg(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let Qe="";if(Te){let Ht=(v==null?void 0:v.prodPromoInfo)||[];if(Ht.length===0)try{console.log("[CompleteChange] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),Ht=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"05"}),console.log("[CompleteChange] getProdPromotionInfo fallback :",Ht.length,"")}catch(Zt){console.log("[CompleteChange] getProdPromotionInfo fallback :",Zt)}const Os=Ht.filter(Zt=>(Zt.PROD_CMPS_CL==="21"||Zt.PROD_CMPS_CL==="22")&&(Zt.PROD_STAT_CD==="10"||Zt.PROD_STAT_CD==="20")).map(Zt=>Zt.PROD_CD).filter(Zt=>Zt);Qe=Os.length>0?Os.join(",")+",":"",console.log("[CompleteChange] ADD_ON :",Qe)}const yt=(v==null?void 0:v.installedEquipments)||[];if(Te&&yt.length>0&&!g){r==null||r("  .","error");return}if(Te&&g)try{const Ht=t.OLD_PROD_CD||"",Os=t.CTRT_ID||"",Zt=t.SO_ID||"";let Ds="";const js=await ex(),Us=(await ka("CMIF006")).map(Is=>Is.code);console.log("[CompleteChange] certifyProdList:",js.length,"certifySoIds:",Us);let Qs=!1;if(js.includes(Ht))try{const Is=await Jm({CTRT_ID:Os,CUST_ID:((Ps=t.customer)==null?void 0:Ps.id)||t.CUST_ID||"",SO_ID:Zt,REG_UID:tt,WRK_ID:t.id||""}),_s=Array.isArray(Is)?Is[0]:Is;console.log("[CompleteChange] CL-08 result:",_s,"oldCtrtId:",Os),_s&&!_s.ERROR&&_s.CONT_ID===Os&&(Qs=!0)}catch(Is){console.log("[CompleteChange] CL-08 query failed:",Is)}else console.log("[CompleteChange] OLD_PROD_CD not in certify_prod, skip CL-08");if(Qs)if(t.IS_CERTIFY_PROD==1&&Us.includes(Zt))Ds="U",console.log("[CompleteChange] CERTIFY_TYPE=U (OLD+NEW certified)");else{const Is=await R3(t,tt,Os);if(!Is.success){r==null||r(`  : ${Is.error}`,"error");return}}else t.IS_CERTIFY_PROD==1&&Us.includes(Zt)&&(Ds="C",console.log("[CompleteChange] CERTIFY_TYPE=C (NEW only certified)"));if(Ds){const Is=await yg({order:t,workerId:tt,certifyRegconfInfo:g,addOnParam:Qe,reason:Ds==="U"?"":"",certifyType:Ds,contIdOld:Ds==="U"?Os:void 0});if(!Is.success){r==null||r(` : ${Is.message}`,"error");return}console.log("[CompleteChange] CL-04    ")}}catch(Ht){console.error("[CompleteChange] CL-04  :",Ht),r==null||r(`  : ${Ht.message||"   "}`,"error");return}let vt="";const $e=t.CTRT_ID||"",ot=t.OLD_PROD_CD||"",wt=ot&&ce.length>0&&ce.some(Ht=>Ht.PROD_CD===ot),Bt=(v==null?void 0:v.removedEquipments)||[];if(ge&&wt)console.log("[CompleteChange] LGHVLGHV :   skip ( )");else if(!_t&&Bt.length>0)try{let Ht="SMR05",Os="";if(wt){Ht="STB_DEL";const Us=Bt.find(Qs=>{var Is,_s;return(Qs.ITEM_MID_CD||Qs.itemMidCd||((Is=Qs.actualEquipment)==null?void 0:Is.ITEM_MID_CD)||((_s=Qs.actualEquipment)==null?void 0:_s.itemMidCd))==="04"});Us&&(Os=Us.EQT_NO||Us.id||((ps=Us.actualEquipment)==null?void 0:ps.EQT_NO)||((vs=Us.actualEquipment)==null?void 0:vs.id)||"")}let Zt="";try{const Us=await dl({CTRT_ID:$e,RCPT_ID:t.RCPT_ID||"",PROC_CL:"TERM",WRK_CD:"05"});console.log("[CompleteChange] getProdPromotionInfo :",Us);const Qs=Us.find(Is=>Is.PROD_CMPS_CL==="23");Qs&&(Zt=Qs.PROD_CMPS_ID||""),console.log("[CompleteChange] EQT_PROD_CMPS_ID:",Zt)}catch(Us){console.log("[CompleteChange] getProdPromotionInfo   ():",Us)}const Ds=t.END_PROD_CD||t.VOIP_PROD_CD||"";let js="";Ds&&(js=$e),console.log("[CompleteChange]   :",{msgId:Ht,ctrtId:$e,eqtProdCmpsId:Zt});const hs=await la({MSG_ID:Ht,CUST_ID:((Ms=t.customer)==null?void 0:Ms.id)||t.CUST_ID||"",CTRT_ID:$e,SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Zt,PROD_CD:"",ITV_USR_ID:"",IP_CNT:"",ETC_1:Os,ETC_2:"",ETC_3:"",ETC_4:"",SUB_PROD_CD:"",IF_DTL_ID:"",WRK_ID:t.id||"",REG_UID:tt,VOIP_JOIN_CTRT_ID:js||I||"",WTIME:"3"});if(console.log("[CompleteChange]    :",hs),(hs==null?void 0:hs.code)==="SUCCESS"||(hs==null?void 0:hs.code)==="PARTIAL")vt=(hs==null?void 0:hs.IF_DTL_ID)||"",console.log("[CompleteChange] removal signal SUCCESS, IF_DTL_ID:",vt);else{const Us=(hs==null?void 0:hs.message)||(hs==null?void 0:hs.rawResult)||"";console.warn("[CompleteChange] removal signal FAILED -  :",Us),r==null||r(`   : ${Us}`,"warning")}}catch(Ht){console.warn("[CompleteChange] removal signal error -  :",Ht),r==null||r("     .","warning")}const Yt=t.DTL_CTRT_ID||t.CTRT_ID||"";console.log("========== [CompleteChange]    =========="),console.log("[DEBUG] order.CTRT_ID (OLD ):",t.CTRT_ID),console.log("[DEBUG] order.DTL_CTRT_ID (NEW ):",t.DTL_CTRT_ID),console.log("[DEBUG] order.OLD_CTRT_ID:",t.OLD_CTRT_ID),console.log("[DEBUG] ctrtIdForProductChange (workInfo ):",Yt),console.log("[DEBUG]   (installedEquipments):",((cs=v==null?void 0:v.installedEquipments)==null?void 0:cs.length)||0,""),(ms=v==null?void 0:v.installedEquipments)==null||ms.forEach((Ht,Os)=>{var Zt,Ds,js,hs,Us;console.log(`[DEBUG] [${Os}]:`,{EQT_NO:Ht.EQT_NO||Ht.id||((Zt=Ht.actualEquipment)==null?void 0:Zt.id),EQT_SERNO:Ht.EQT_SERNO||Ht.serialNumber||((Ds=Ht.actualEquipment)==null?void 0:Ds.serialNumber),CTRT_ID:Ht.CTRT_ID,SVC_CMPS_ID:Ht.SVC_CMPS_ID||((js=Ht.contractEquipment)==null?void 0:js.SVC_CMPS_ID),BASIC_PROD_CMPS_ID:Ht.BASIC_PROD_CMPS_ID||((hs=Ht.contractEquipment)==null?void 0:hs.BASIC_PROD_CMPS_ID),LENT_YN:Ht.LENT_YN||Ht.LENT||((Us=Ht.contractEquipment)==null?void 0:Us.LENT)})}),console.log("[DEBUG]   (removedEquipments):",((Ks=v==null?void 0:v.removedEquipments)==null?void 0:Ks.length)||0,""),(Ls=v==null?void 0:v.removedEquipments)==null||Ls.forEach((Ht,Os)=>{var Zt,Ds,js,hs,Us;console.log(`[DEBUG] [${Os}]  :`,JSON.stringify(Ht,null,2)),console.log(`[DEBUG] [${Os}] :`,{EQT_NO:Ht.EQT_NO||Ht.id||((Zt=Ht.actualEquipment)==null?void 0:Zt.id),EQT_SERNO:Ht.EQT_SERNO||Ht.serialNumber||((Ds=Ht.actualEquipment)==null?void 0:Ds.serialNumber),CTRT_ID:Ht.CTRT_ID,SVC_CMPS_ID:Ht.SVC_CMPS_ID||((js=Ht.contractEquipment)==null?void 0:js.SVC_CMPS_ID),BASIC_PROD_CMPS_ID:Ht.BASIC_PROD_CMPS_ID||((hs=Ht.contractEquipment)==null?void 0:hs.BASIC_PROD_CMPS_ID),LENT_YN:Ht.LENT_YN||Ht.LENT||((Us=Ht.contractEquipment)==null?void 0:Us.LENT),ITEM_MID_CD:Ht.ITEM_MID_CD||Ht.itemMidCd,ITEM_CD:Ht.ITEM_CD,EQT_CL_CD:Ht.EQT_CL_CD||Ht.eqtClCd,PROD_CMPS_ID:Ht.PROD_CMPS_ID})});const Xt=ke((v==null?void 0:v.installedEquipments)||[],!1),ts=ke((v==null?void 0:v.removedEquipments)||[],!0);console.log("[DEBUG]   (equipmentList):",Xt.length,""),Xt.forEach((Ht,Os)=>{console.log(`[DEBUG]  [${Os}]:`,{EQT_NO:Ht.EQT_NO,CTRT_ID:Ht.CTRT_ID,CRR_TSK_CL:Ht.CRR_TSK_CL,SVC_CMPS_ID:Ht.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ht.BASIC_PROD_CMPS_ID})}),console.log("[DEBUG]   (removeEquipmentList):",ts.length,""),ts.forEach((Ht,Os)=>{console.log(`[DEBUG]  [${Os}] :`,JSON.stringify(Ht,null,2))}),console.log("========== [CompleteChange]    ==========");let Ut=t.WRK_DTL_TCD||"";Ut==="0550"?Ut="0560":Ut==="0510"&&(Ut="0520");const Es={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:Ut,CUST_ID:(nt=t.customer)==null?void 0:nt.id,CTRT_ID:Yt,RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||je.crrId||"01",WRKR_ID:tt,WRKR_CMPL_DT:be,MEMO:G||" ",STTL_YN:"Y",REG_UID:tt,CUST_REL:w,CNFM_CUST_NM:((Ft=t.customer)==null?void 0:Ft.name)||"",CNFM_CUST_TELNO:((Cs=t.customer)==null?void 0:Cs.contactNumber)||"",INSTL_LOC:ue||t.installLocation||"",UP_CTRL_CL:J||"",PSN_USE_CORP:B||"",VOIP_USE_CORP:S||"",DTV_USE_CORP:Y||"",WRK_ACT_CL:"20",TV_TYPE:"",NET_CL:(me==null?void 0:me.NET_CL)||"",WRNG_TP:(me==null?void 0:me.WRNG_TP)||"",INSTL_TP:(me==null?void 0:me.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:I||"",ADD_ON:Qe||""},equipmentList:Xt,removeEquipmentList:ts,spendItemList:(v==null?void 0:v.spendItems)||[],agreementList:(v==null?void 0:v.agreements)||[],poleList:St?[{WRK_ID:t.id,POLE_YN:St.POLE_YN,LAN_GB:St.LAN_GB||"",REG_UID:tt}]:[]},ys=async()=>{var Ht,Os,Zt;try{if(_t){console.log("[CompleteChange] FTTH :  skip ( )");return}const Ds=(v==null?void 0:v.installedEquipments)||[],js=t.OLD_PROD_CD||"",hs=ce.some(Rs=>Rs.PROD_CD===js);let Us="SMR03";ge&&(Us=hs?"PKG_CHG":"STB_CRT");const Qs=Rs=>Ds.find(Pn=>{var Qn,Xr;return(Pn.ITEM_MID_CD||Pn.itemMidCd||((Qn=Pn.actualEquipment)==null?void 0:Qn.ITEM_MID_CD)||((Xr=Pn.actualEquipment)==null?void 0:Xr.itemMidCd))===Rs}),Is=Rs=>{var Pn,Qn;return(Rs==null?void 0:Rs.EQT_NO)||(Rs==null?void 0:Rs.id)||((Pn=Rs==null?void 0:Rs.actualEquipment)==null?void 0:Pn.EQT_NO)||((Qn=Rs==null?void 0:Rs.actualEquipment)==null?void 0:Qn.id)||""},_s=t.BGN_PROD_CD||t.VOIP_PROD_CD||"",Lr=t.BGN_PROD_GRP||t.PROD_GRP||"";let Ir="",qr="",vr="",cn="";try{const Rs=await dl({CTRT_ID:t.DTL_CTRT_ID||t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"05"}),Pn=Rs.find(Ni=>Ni.PROD_CMPS_CL==="23");Pn&&(Ir=Pn.PROD_CMPS_ID||"");const Qn=Rs.find(Ni=>Ni.PROD_CMPS_CL==="11");Qn&&(qr=Qn.PROD_CD||"",cn=Qn.PROD_GRP||"");const Xr=Rs.filter(Ni=>Ni.BASIC_PROD_FL==="V").map(Ni=>Ni.PROD_CD);Xr.length>0&&(vr=Xr.join(","))}catch(Rs){console.log("[CompleteChange] getProdPromotionInfo for install signal failed:",Rs)}let cr="";if(_s){const Rs=Qs("08");Rs&&(cr=Is(Rs))}else{for(const Rs of["05","01","03"]){const Pn=Qs(Rs);if(Pn){cr=Is(Pn);break}}if(!cr&&cn==="I"){const Rs=Qs("02");Rs&&(cr=Is(Rs))}if(!cr){const Rs=Qs("08");Rs&&(cr=Is(Rs))}}let ni="";if(_s){const Rs=Qs("02");Rs&&(ni=Is(Rs))}else{const Rs=Qs("04");Rs?ni=Is(Rs):ni=(me==null?void 0:me.NET_CL)||""}const Fr=Is(Qs("07")),Hi=cn==="C"?Is(Qs("02")):"";let Or="";if(Qs("10")&&Lr==="V"&&(Or=Is(Qs("10"))),t.BGN_ISP_PROD_CD||t.ISP_PROD_CD||""){const Rs=Qs("21");Rs&&(Or=Is(Rs))}let Dr=t.id||"";const Ta=Ds.find(Rs=>{var Pn,Qn;return(Rs.EQT_CL_CD||Rs.eqtClCd||((Pn=Rs.actualEquipment)==null?void 0:Pn.EQT_CL_CD)||((Qn=Rs.actualEquipment)==null?void 0:Qn.eqtClCd))==="091003"});if(Ta)Dr=Is(Ta);else{const Rs=Ds.find(Pn=>{var Qn,Xr;return(Pn.EQT_CL_CD||Pn.eqtClCd||((Qn=Pn.actualEquipment)==null?void 0:Qn.EQT_CL_CD)||((Xr=Pn.actualEquipment)==null?void 0:Xr.eqtClCd))==="092201"});Rs&&(Dr=(Rs==null?void 0:Rs.MAC_ADDRESS)||(Rs==null?void 0:Rs.macAddress)||((Ht=Rs==null?void 0:Rs.actualEquipment)==null?void 0:Ht.MAC_ADDRESS)||((Os=Rs==null?void 0:Rs.actualEquipment)==null?void 0:Os.macAddress)||"")}let Fa="";_s?Fa=t.CTRT_ID||"":Fa=I||"",console.log("[CompleteChange]  :",{msgId:Us,eqtNo:cr,instProdCd:qr,instEqtProdCmpsId:Ir,subProdCd:vr}),await la({MSG_ID:Us,CUST_ID:((Zt=t.customer)==null?void 0:Zt.id)||t.CUST_ID||"",CTRT_ID:t.DTL_CTRT_ID||t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:cr,EQT_PROD_CMPS_ID:Ir,PROD_CD:qr,ITV_USR_ID:"",IP_CNT:"",ETC_1:ni,ETC_2:Fr,ETC_3:Hi,ETC_4:Or,SUB_PROD_CD:vr,IF_DTL_ID:"",WRK_ID:Dr,REG_UID:tt,VOIP_JOIN_CTRT_ID:Fa,WTIME:"3"}),console.log("[CompleteChange]   ")}catch(Ds){console.log("[CompleteChange]     (  ):",Ds)}};R(Es,{onSuccess:Ht=>{Ht.code==="SUCCESS"||Ht.code==="OK"?(localStorage.removeItem(L()),t.WRK_STAT_CD="3",ys(),r==null||r("  .","success"),n()):r==null||r(Ht.message||"   .","error",!0)},onError:Ht=>{r==null||r(Ht.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[U&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[j?s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:I,onValueChange:ee,options:ae,placeholder:" ",required:!0,disabled:d})]}):s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx("input",{type:"text",value:"",readOnly:!0,disabled:!0,className:"w-full min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:X||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>ie(!0),className:`px-3 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${d?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:d?"":""}),u&&s.jsx("button",{type:"button",onClick:()=>pe(!0),className:`px-3 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${d?"bg-gray-500 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:d?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:w,onValueChange:P,options:dt,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{children:ue||t.installLocation||""}),it&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(: ",it,")"]})]}),s.jsx("button",{type:"button",onClick:()=>ne(!0),className:`px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${d?"bg-gray-500 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:d?"":""})]})]}),((v==null?void 0:v.kpiProdGrpCd)==="D"||(v==null?void 0:v.prodGrp)==="D"||t.PROD_GRP==="D"||(t.PROD_NM||"").includes("DTV"))&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(Zs,{value:J,onValueChange:q,options:rt,placeholder:"",disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:G,onChange:be=>K(be.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${d?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:d,disabled:d}),!d&&s.jsxs("p",{className:`text-xs text-right mt-1 ${G.length>=500?"text-red-500":"text-gray-400"}`,children:[G.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:$t,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>F(!V),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${V?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),V&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"DTV ()"}),s.jsx(Zs,{value:Y,onValueChange:te,options:Ye,placeholder:"",disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"ISP ()"}),s.jsx(Zs,{value:B,onValueChange:O,options:Ot,placeholder:"",disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"VoIP (VoIP)"}),s.jsx(Zs,{value:S,onValueChange:A,options:Ze,placeholder:"",disabled:d})]})]})]}),lt&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["OTT BOX  ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Ct,readOnly:!0,placeholder:"SER_NO   ",className:"flex-1 px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600"}),s.jsxs("button",{type:"button",onClick:()=>Pe(!0),disabled:d,className:`px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 ${d?"bg-gray-400 text-white cursor-not-allowed":Ct?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"SER_NO"]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!d&&s.jsx("button",{onClick:Ss,disabled:U,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${U?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:U?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>Ne(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:$,onClose:()=>ie(!1),onSave:ls,workId:t.id,initialData:me,workType:t.WRK_CD,customerId:(Kt=t.customer)==null?void 0:Kt.id,customerName:(ht=t.customer)==null?void 0:ht.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD,kpiProdGrpCd:(v==null?void 0:v.kpiProdGrpCd)||(v==null?void 0:v.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:"01",chgKpiProdGrpCd:(v==null?void 0:v.chgKpiProdGrpCd)||(v==null?void 0:v.CHG_KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodGrp:(v==null?void 0:v.prodGrp)||(v==null?void 0:v.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:d}),s.jsx(hc,{isOpen:fe,onClose:()=>pe(!1),onSave:ds,workId:t.id,initialData:le,workType:"08",customerId:(qt=t.customer)==null?void 0:qt.id,customerName:(It=t.customer)==null?void 0:It.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD,kpiProdGrpCd:(v==null?void 0:v.kpiProdGrpCd)||(v==null?void 0:v.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:"02",chgKpiProdGrpCd:(v==null?void 0:v.chgKpiProdGrpCd)||(v==null?void 0:v.CHG_KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodGrp:(v==null?void 0:v.prodGrp)||(v==null?void 0:v.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:d}),s.jsx(Wa,{isOpen:Ee,onClose:()=>Ne(!1),ctrtId:t.CTRT_ID,custId:(he=t.customer)==null?void 0:he.id}),s.jsx(Of,{isOpen:ye,onClose:()=>ne(!1),onSave:be=>{xe(be.INSTL_LOC),bt(be.VIEW_MOD_CD),At(be.VIEW_MOD_NM),ne(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(v==null?void 0:v.prodGrp)||(v==null?void 0:v.PROD_GRP),initialInstlLoc:ue||t.installLocation,initialViewModCd:et,initialViewModNm:it,showToast:r,readOnly:d}),s.jsx(Ng,{isOpen:Dt,onClose:()=>Tt(!1),onSave:Ns,soId:t.SO_ID||""}),s.jsx(ul,{isOpen:at,onClose:()=>We(!1),onConfirm:ct,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{equipmentData:v,installInfoData:me,custRel:w,custRelOptions:dt,memo:G,installLocationText:ue,order:t})}),s.jsx(vb,{isOpen:Xe,onClose:()=>Pe(!1),onSave:be=>{Me(be),r==null||r("OTT  .","success")},wrkId:t.id||"",wrkDrctnId:t.directionId||t.WRK_DRCTN_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",dataType:jt,showToast:r,readOnly:d})]})},Rb=({isOpen:t,onClose:e,wrkCd:n,wrkId:r,rcptId:i})=>{const[l,c]=x.useState(!1),[d,u]=x.useState(null),[f,m]=x.useState(null),_=n==="07"?"":"";x.useEffect(()=>{t&&r&&y()},[t,r,n]);const y=async()=>{c(!0),m(null);try{const N=await Cg({WRK_CD:n,WRK_ID:r,RCPT_ID:i});N?u(N):m("   .")}catch(N){console.error("  :",N),m(N.message||"  .")}finally{c(!1)}},g=s.jsx("button",{onClick:e,className:"w-full px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors",children:""});return s.jsx(_a,{isOpen:t,onClose:e,title:_,size:"medium",footer:g,children:l?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:" ..."})]}):f?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-red-500 mb-2",children:f}),s.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700",children:" "})]}):d?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:d.MVM_TP_NM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:d.PROD_NM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:d.HOPE_DTTM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:d.WRK_STAT_NM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium whitespace-pre-wrap",children:d.ADDR_ORD||"-"})]})]}):s.jsx("div",{className:"text-center py-8 text-gray-500",children:" ."})})},j5=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1,certifyReason:d})=>{var ls,ds,Ss,Ns;const u=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",f=t.WRK_CD==="07",[m,_]=x.useState(!1),{equipmentData:y,filteringData:g}=$i(),{certifyRegconfInfo:N}=Ba(),C=t.id||"",v=oa(C),R={...y||i||g||{},installedEquipments:v.installedEquipments.length>0?v.installedEquipments:(y==null?void 0:y.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:v.markedForRemoval.length>0?v.markedForRemoval:(y==null?void 0:y.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(v.removalStatus).length>0?v.removalStatus:(y==null?void 0:y.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:U,isPending:L}=od(),w=()=>`work_complete_draft_${t.id}`,[P,G]=x.useState(""),[K,B]=x.useState(""),[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(""),[q,V]=x.useState(""),[F,I]=x.useState(!1),[ee,ae]=x.useState(!1),[T,j]=x.useState(!1),[k,Q]=x.useState(""),[H,$]=x.useState([]),[ie,fe]=x.useState(!1),[pe,de]=x.useState([]),[Re,X]=x.useState(!1),[_e,me]=x.useState(""),[Z,le]=x.useState(""),[se,Ee]=x.useState(void 0),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(!1),[xe,et]=x.useState(""),[bt,it]=x.useState(""),[At,at]=x.useState(""),[We,Dt]=x.useState(!1),[Tt,St]=x.useState(!1),[ze,dt]=x.useState(!1),[Ke,rt]=x.useState(null),[ft,Ot]=x.useState([]),[mt,Ze]=x.useState([]),[De,Ye]=x.useState([]),[Ce,ge]=x.useState([]),[Be,ce]=x.useState([]),[Le,Xe]=x.useState(!1),[Pe,Ct]=x.useState([]),[Me,lt]=x.useState(()=>{const ke=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(ke&&ke.length>=8)return`${ke.slice(0,4)}-${ke.slice(4,6)}-${ke.slice(6,8)}`;const ct=new Date;return ct.getFullYear()+"-"+String(ct.getMonth()+1).padStart(2,"0")+"-"+String(ct.getDate()).padStart(2,"0")});x.useEffect(()=>{if(u){(async()=>{try{const st=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(st){G(st.CUST_REL||""),B((st.WRK_PROC_CT||"").replace(/\\n/g,`
`)),S(st.PSN_USE_CORP||""),Y(st.VOIP_USE_CORP||""),J(st.DTV_USE_CORP||"");const Kt=st.UP_CTRL_CL||(R==null?void 0:R.upCtrlCl)||"";console.log("[CompleteMoveRemoval]  :",{API:st.UP_CTRL_CL,:R==null?void 0:R.upCtrlCl,:Kt}),V(Kt),me(st.NET_CL||""),le(st.NET_CL_NM||""),et(st.INSTL_LOC||""),Ee({NET_CL:st.NET_CL||"",NET_CL_NM:st.NET_CL_NM||"",WRNG_TP:st.WRNG_TP||"",INSTL_TP:st.INSTL_TP||"",CB_WRNG_TP:st.CB_WRNG_TP||"",CB_INSTL_TP:st.CB_INSTL_TP||"",INOUT_LINE_TP:st.INOUT_LINE_TP||"",INOUT_LEN:st.INOUT_LEN||"",DVDR_YN:st.DVDR_YN||"",BFR_LINE_YN:st.BFR_LINE_YN||"",CUT_YN:st.CUT_YN||"",TERM_NO:st.TERM_NO||"",RCV_STS:st.RCV_STS||"",SUBTAP_ID:st.SUBTAP_ID||"",PORT_NUM:st.PORT_NUM||"",EXTN_TP:st.EXTN_TP||"",TAB_LBL:st.TAB_LBL||"",CVT_LBL:st.CVT_LBL||"",STB_LBL:st.STB_LBL||""}),st.VOIP_JOIN_CTRT_ID&&Q(st.VOIP_JOIN_CTRT_ID),(st.CHK_CUST_ADDR==="true"||st.CHK_CUST_ADDR==="Y")&&I(!0),(st.CHK_PYM_ADDR==="true"||st.CHK_PYM_ADDR==="Y")&&ae(!0),st.WRKR_CMPL_DT&&st.WRKR_CMPL_DT.length>=8&&lt(`${st.WRKR_CMPL_DT.slice(0,4)}-${st.WRKR_CMPL_DT.slice(4,6)}-${st.WRKR_CMPL_DT.slice(6,8)}`)}}catch(st){console.error("[WorkCompleteMoveRemoval]     :",st)}_(!0)})();return}const ke=localStorage.getItem(w());if(ke)try{const ct=JSON.parse(ke);G(ct.custRel||""),B(ct.memo||""),S(ct.internetUse||""),Y(ct.voipUse||""),J(ct.dtvUse||""),V(ct.upCtrlCl||""),me(ct.networkType||""),le(ct.networkTypeName||""),et(ct.installLocationText||""),Ee(ct.installInfoData),ct.voipJoinCtrtId&&Q(ct.voipJoinCtrtId),ct.chkCustAddr!==void 0&&I(ct.chkCustAddr),ct.chkPymAddr!==void 0&&ae(ct.chkPymAddr)}catch(ct){console.error("[WorkCompleteMoveRemoval] localStorage  :",ct)}_(!0)},[t.id,u]),x.useEffect(()=>{if(!m||u)return;const ke={custRel:P,memo:K,internetUse:O,voipUse:A,dtvUse:te,upCtrlCl:q,networkType:_e,networkTypeName:Z,installLocationText:xe,installInfoData:se,voipJoinCtrtId:k,chkCustAddr:F,chkPymAddr:ee,savedAt:new Date().toISOString()};localStorage.setItem(w(),JSON.stringify(ke))},[P,K,O,A,te,q,_e,Z,xe,se,k,F,ee,m,u]),x.useEffect(()=>{(async()=>{try{const ct=await Jl(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);ct.CMCU005&&Ot(ct.CMCU005.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM}))),ct.CMCT015&&(console.log("[CompleteMoveRemoval]  CMCT015 :",ct.CMCT015),Ze(ct.CMCT015.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM})))),ct.CMCU057&&Ye(ct.CMCU057.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM}))),ct.CMCU110&&ge(ct.CMCU110.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM}))),ct.CMCU148&&ce(ct.CMCU148.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM})))}catch(ct){console.error("[WorkCompleteMoveRemoval]   :",ct)}})()},[]),x.useEffect(()=>{(async()=>{try{const ct=await mc();Ct(ct||[]),console.log("[CompleteInternalMove] LGHV  :",ct==null?void 0:ct.length);const st=t.PROD_CD||t.BASIC_PROD_CD||"";if(st&&ct&&ct.length>0){const Kt=ct.some(ht=>ht.PROD_CD===st);Xe(Kt),console.log("[CompleteInternalMove] LGHV STB :",Kt,"PROD_CD:",st)}}catch(ct){console.error("[CompleteInternalMove] LGHV    :",ct)}})()},[t.id]),x.useEffect(()=>{R!=null&&R.upCtrlCl&&!q?(console.log("[CompleteMoveRemoval] equipmentData  :",R.upCtrlCl),V(R.upCtrlCl)):!q&&m&&!u&&(console.log("[CompleteMoveRemoval]   : 01 ()"),V("01"))},[R==null?void 0:R.upCtrlCl,m,u,q]),x.useEffect(()=>{var st;if(u)return;const ke=((st=t.customer)==null?void 0:st.id)||t.CUST_ID;if(!ke)return;(async()=>{try{console.log("[WorkCompleteMoveRemoval]     :",ke);const Kt=await If({CUST_ID:ke});console.log("[WorkCompleteMoveRemoval]   :",Kt),de(Kt||[])}catch(Kt){console.error("[WorkCompleteMoveRemoval]     :",Kt),de([])}})()},[(ls=t.customer)==null?void 0:ls.id,t.CUST_ID,u]),x.useEffect(()=>{if(u)return;if(pe.length===0){console.log("[WorkCompleteMoveRemoval]     ...");return}const ke=t.PROD_GRP||"",ct=t.VOIP_PROD_CD||"",st=t.ISP_PROD_CD||"",Kt=t.WRK_STAT_CD||"",ht=t.ADDR_ORD||"";if(console.log("[WorkCompleteMoveRemoval]   :",{prodGrp:ke,voipProdCd:ct,ispProdCd:st,wrkStatCd:Kt,addrOrd:ht,customerCtrtListCount:pe.length}),ke==="V"&&!ct){const qt=pe.filter(he=>{const be=he.PROD_GRP||"",Oe=he.CTRT_STAT||"",je=he.ADDR_ORD||he.addr_ord||"";return(be==="C"||be==="D"||be==="I")&&Oe==="20"&&(!ht||je===ht)});console.log("[WorkCompleteMoveRemoval] VoIP   :",qt),qt.length<1&&Kt==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const It=[{value:"",label:""},...qt.map(he=>({value:he.CTRT_ID||"",label:`[${he.CTRT_ID}] ${he.BASIC_PROD_CD_NM||he.PROD_NM||""}`}))];$(It),fe(!0);return}if(ke==="I"&&st){const qt=pe.filter(he=>{const be=he.PROD_GRP||"",Oe=he.CTRT_STAT||"",je=he.ADDR_ORD||he.addr_ord||"",tt=he.ISP_JOIN_ID||"",Te=he.KPI_PROD_GRP_CD||"";return(be==="D"||be==="C")&&Oe==="20"&&!tt&&Te==="D"&&(!ht||je===ht)});console.log("[WorkCompleteMoveRemoval] ISP   :",qt),qt.length<1&&Kt==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const It=[{value:"",label:""},...qt.map(he=>({value:he.CTRT_ID||"",label:`[${he.CTRT_ID}] ${he.BASIC_PROD_CD_NM||he.PROD_NM||""}`}))];$(It),fe(!0);return}fe(!1),$([])},[t.id,t.WRK_STAT_CD,u,r,pe]);const ut=()=>{const ke=[];P||ke.push("  ."),se!=null&&se.NET_CL||ke.push(" ."),xe||ke.push(" ."),Me||ke.push(" .");const ct=t.PROD_GRP||"",st=t.VOIP_PROD_CD||"",Kt=t.ISP_PROD_CD||"";ct==="V"&&!st&&ie&&(k||ke.push("VOIP    .")),ct==="I"&&Kt&&ie&&(k||ke.push("  ISP .    ."));const ht=(R==null?void 0:R.installedEquipments)||[];return ct!=="V"&&ht.length<1&&ke.push("()  ."),ke},jt=ke=>{Ee(ke),ke.NET_CL&&me(ke.NET_CL),ke.NET_CL_NM&&le(ke.NET_CL_NM),r==null||r("  .","success")},Ve=()=>{if(L)return;const ke=ut();if(ke.length>0){ke.forEach(st=>r==null?void 0:r(st,"error"));return}(t.PROD_GRP||"")!=="V"?dt(!0):Dt(!0)},$t=ke=>{rt(ke),dt(!1),Dt(!0)},Ue=(ke,ct=!1)=>{if(!ke||ke.length===0)return[];const st=localStorage.getItem("userInfo"),Kt=st?JSON.parse(st):{},ht=Kt.userId||"A20130708",qt=(R==null?void 0:R.removalStatus)||{},It=(he,be)=>he==="1"||he==="Y"||be==="1"||be==="Y"?"1":"0";return ke.map(he=>{var tt,Te,_t;const be=he.EQT_NO||he.id||((tt=he.actualEquipment)==null?void 0:tt.id)||"",Oe=qt[be]||{},je=ct?{CRR_TSK_CL:t.WRK_CD||"06",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Kt.crrId||"01",WRKR_ID:ht,EQT_LOSS_YN:It(he.EQT_LOSS_YN,Oe.EQT_LOSS_YN),PART_LOSS_BRK_YN:It(he.PART_LOSS_BRK_YN,Oe.PART_LOSS_BRK_YN),EQT_BRK_YN:It(he.EQT_BRK_YN,Oe.EQT_BRK_YN),EQT_CABL_LOSS_YN:It(he.EQT_CABL_LOSS_YN,Oe.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:It(he.EQT_CRDL_LOSS_YN,Oe.EQT_CRDL_LOSS_YN)}:{};if(he.actualEquipment){const Qe=he.actualEquipment,yt=he.contractEquipment||{};return{...Qe,EQT_NO:Qe.id,EQT_SERNO:Qe.serialNumber,ITEM_MID_CD:Qe.itemMidCd,EQT_CL_CD:Qe.eqtClCd,MAC_ADDRESS:he.macAddress||Qe.macAddress,WRK_ID:t.id,CUST_ID:(Te=t.customer)==null?void 0:Te.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:ht,SVC_CMPS_ID:yt.SVC_CMPS_ID||he.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:yt.BASIC_PROD_CMPS_ID||he.BASIC_PROD_CMPS_ID||"",PROD_CMPS_ID:yt.PROD_CMPS_ID||he.PROD_CMPS_ID||"",SVC_CD:yt.SVC_CD||he.SVC_CD||"",PROD_CD:yt.PROD_CD||he.PROD_CD||"",LENT_YN:he.lentYn||he.LENT_YN||yt.LENT_YN||"",EQT_CHG_GB:he.EQT_CHG_GB||"01",...je}}return{...he,EQT_NO:he.EQT_NO||he.id||"",EQT_SERNO:he.EQT_SERNO||he.serialNumber||"",ITEM_MID_CD:he.ITEM_MID_CD||he.itemMidCd||"",EQT_CL_CD:he.EQT_CL_CD||he.eqtClCd||"",MAC_ADDRESS:he.MAC_ADDRESS||he.macAddress||"",SVC_CMPS_ID:he.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:he.BASIC_PROD_CMPS_ID||"",PROD_CD:he.PROD_CD||"",SVC_CD:he.SVC_CD||"",WRK_ID:t.id,CUST_ID:(_t=t.customer)==null?void 0:_t.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:ht,...je}})},ss=async()=>{var tt,Te,_t,Qe,yt;const ke=Me.replace(/-/g,""),ct=localStorage.getItem("userInfo"),st=ct?JSON.parse(ct):{},Kt=st.userId||"A20130708",ht=c||Mh(t.OP_LNKD_CD),qt=await bg(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let It="";if(ht){let vt=(R==null?void 0:R.prodPromoInfo)||[];if(vt.length===0)try{console.log("[CompleteInternalMove] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),vt=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"06"}),console.log("[CompleteInternalMove] getProdPromotionInfo fallback :",vt.length,"")}catch(ot){console.log("[CompleteInternalMove] getProdPromotionInfo fallback :",ot)}const $e=vt.filter(ot=>(ot.PROD_CMPS_CL==="21"||ot.PROD_CMPS_CL==="22")&&(ot.PROD_STAT_CD==="10"||ot.PROD_STAT_CD==="20")).map(ot=>ot.PROD_CD).filter(ot=>ot);It=$e.length>0?$e.join(",")+",":"",console.log("[CompleteInternalMove] ADD_ON :",It)}const he=(R==null?void 0:R.installedEquipments)||[];if(ht&&he.length>0&&!N){r==null||r("  .","error");return}if(ht&&N)try{const vt=t.OLD_CTRT_ID||t.CTRT_ID||"",{certifyType:$e}=await S5(t,Kt,vt);if($e){const ot=d||($e==="C"?"":""),wt=$e==="U"?(t.CTRT_ID||"")!==vt?vt:t.CTRT_ID||"":void 0,Bt=await yg({order:t,workerId:Kt,certifyRegconfInfo:N,addOnParam:It,reason:ot,certifyType:$e,contIdOld:wt});if(!Bt.success){r==null||r(` : ${Bt.message}`,"error");return}console.log("[CompleteInternalMove] CL-04    ")}}catch(vt){console.error("[CompleteInternalMove] CL-04  :",vt),r==null||r(`  : ${vt.message||"   "}`,"error");return}const be=(R==null?void 0:R.removedEquipments)||[];if(be.length>0&&!qt&&!Le){let vt=!1;for(const $e of be){const ot=$e.actualEquipment||$e,wt=ot.eqtClCd||ot.EQT_CL_CD||"";wt==="090901"||wt==="091001"||wt==="091005"||(vt=!0)}if(vt)try{const $e=be[0],ot=$e.EQT_PROD_CMPS_ID||((tt=$e.actualEquipment)==null?void 0:tt.EQT_PROD_CMPS_ID)||t.EQT_PROD_CMPS_ID||"";console.log("[CompleteInternalMove]   :",{eqtProdCmpsId:ot,voipJoinCtrtId:k});const wt=await la({MSG_ID:"SMR05",CUST_ID:((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:ot,PROD_CD:"",WRK_ID:t.id||"",REG_UID:Kt,ETC_1:"",VOIP_JOIN_CTRT_ID:k||"",WTIME:"3"});if(console.log("[CompleteInternalMove]    :",wt),wt&&wt.PROC_VOIP&&wt.PROC_VOIP.includes("KCT-029"))console.log("[CompleteInternalMove] VoIP KCT-029  ");else if(wt.code!=="SUCCESS"&&wt.code!=="OK"){console.warn("[CompleteInternalMove]    -  :",wt.message),r==null||r("   .","error",!0);return}}catch($e){console.warn("[CompleteInternalMove]      -  :",$e),r==null||r("     .","error",!0);return}}const Oe=async()=>{var wt,Bt;const vt=!!t.ISP_PROD_CD,$e=(R==null?void 0:R.installedEquipments)||[];let ot=!1;if(!qt){const Yt=(R==null?void 0:R.customerEquipments)||$e;for(const Xt of Yt){const ts=Xt.actualEquipment||Xt,Ut=ts.eqtClCd||ts.EQT_CL_CD||"";if(Ut==="090901"||Ut==="091001"||Ut==="091005")continue;(ts.EQT_KND||ts.eqtKnd||"WRKER")==="WRKER"&&(ot=!0)}(vt||Yt.length>0)&&(ot=!0)}if(ot)try{const Yt=t.PROD_GRP||"";let Xt="SMR03",ts="",Ut="",Es="",ys="",Ps="",ps="";Le&&(Xt="STB_CRT"),Yt==="V"&&(Xt="SMR60");let vs=(R==null?void 0:R.prodPromoInfo)||[];if(vs.length===0)try{vs=await dl({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:Kt,PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"01",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||"",WRK_CD:t.WRK_CD||"06",WRK_STAT_CD:t.WRK_STAT_CD||""})}catch(Os){console.log("[CompleteInternalMove] prodPromoInfo  :",Os)}const Ms=((wt=vs.find(Os=>Os.PROD_CMPS_CL==="23"))==null?void 0:wt.PROD_CMPS_ID)||"",cs=vs.find(Os=>Os.PROD_CMPS_CL==="11"),ms=(cs==null?void 0:cs.PROD_CD)||"",Ks=(cs==null?void 0:cs.PROD_GRP)||Yt,Ls=vs.filter(Os=>Os.BASIC_PROD_FL==="V").map(Os=>Os.PROD_CD),nt=Ls.length>0?Ls.join(","):"",Ft=Os=>{const Zt=$e.find(js=>{const hs=js.actualEquipment||js;return(hs.itemMidCd||hs.ITEM_MID_CD)===Os});if(!Zt)return"";const Ds=Zt.actualEquipment||Zt;return Ds.id||Ds.EQT_NO||""};t.VOIP_PROD_CD?(ts=Ft("08"),Ut=Ft("02")):(ts=Ft("05")||Ft("01")||Ft("03")||(Ks==="I"?Ft("02"):"")||Ft("08")||"",Ut=Ft("04")),Es=Ft("07"),Ks==="C"&&(ys=Ft("02")),Ks==="V"&&(Ps=Ft("10")),vt&&(Ps=Ft("21")),(Yt==="V"||vt)&&(ps=k||t.CTRT_ID||"");let Cs=t.id||"";for(const Os of $e){const Zt=Os.actualEquipment||Os,Ds=Zt.eqtClCd||Zt.EQT_CL_CD||"";if(Ds==="091003"||Ds==="091004"){Cs=Zt.id||Zt.EQT_NO||t.id||"";break}if(Ds==="092201"){Cs=Zt.macAddress||Zt.MAC_ADDRESS||Zt.id||Zt.EQT_NO||t.id||"";break}}console.log("[CompleteInternalMove]   :",{msgId:Xt,eqtNo:ts,prodCd:ms,subProdCd:nt,etc1:Ut,etc2:Es,etc3:ys,etc4:Ps});const Ht=await la({MSG_ID:Xt,CUST_ID:((Bt=t.customer)==null?void 0:Bt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:ts,EQT_PROD_CMPS_ID:Ms,PROD_CD:ms,ITV_USR_ID:"",IP_CNT:"",ETC_1:Ut,ETC_2:Es,ETC_3:ys,ETC_4:Ps,SUB_PROD_CD:nt,IF_DTL_ID:"",WRK_ID:Cs,REG_UID:Kt,VOIP_JOIN_CTRT_ID:ps,WTIME:"3"});Ht.code==="SUCCESS"||Ht.code==="OK"?console.log("[CompleteInternalMove]    "):console.warn("[CompleteInternalMove]    :",Ht.message)}catch(Yt){console.log("[CompleteInternalMove]      (  ):",Yt)}},je={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(_t=t.customer)==null?void 0:_t.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||st.crrId||"01",WRKR_ID:Kt,WRKR_CMPL_DT:ke,MEMO:K||" ",STTL_YN:"Y",REG_UID:Kt,CUST_REL:P,CNFM_CUST_NM:((Qe=t.customer)==null?void 0:Qe.name)||"",CNFM_CUST_TELNO:((yt=t.customer)==null?void 0:yt.contactNumber)||"",INSTL_LOC:xe||"",UP_CTRL_CL:q||"",PSN_USE_CORP:O||"",VOIP_USE_CORP:A||"",DTV_USE_CORP:te||"",WRK_ACT_CL:"20",TV_TYPE:"",NET_CL:(se==null?void 0:se.NET_CL)||"",WRNG_TP:(se==null?void 0:se.WRNG_TP)||"",INSTL_TP:(se==null?void 0:se.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:k||"",CHK_CUST_ADDR:f?F?"true":"false":"",CHK_PYM_ADDR:f?ee?"true":"false":"",ADD_ON:It||""},equipmentList:Ue((R==null?void 0:R.installedEquipments)||[],!1),removeEquipmentList:Ue((R==null?void 0:R.removedEquipments)||[],!0),spendItemList:(R==null?void 0:R.spendItems)||[],agreementList:(R==null?void 0:R.agreements)||[],poleList:Ke?[{WRK_ID:t.id,POLE_YN:Ke.POLE_YN,LAN_GB:Ke.LAN_GB||"",REG_UID:Kt}]:[]};U(je,{onSuccess:vt=>{vt.code==="SUCCESS"||vt.code==="OK"?(localStorage.removeItem(w()),t.WRK_STAT_CD="3",Oe(),r==null||r("  .","success"),n()):r==null||r(vt.message||"   .","error",!0)},onError:vt=>{r==null||r(vt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[L&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[ie&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:k,onValueChange:Q,options:H,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Z||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>X(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${u?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:u?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:P,onValueChange:G,options:ft,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{children:xe||""}),At&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(: ",At,")"]})]}),s.jsxs("button",{type:"button",onClick:()=>ue(!0),className:`min-h-10 px-3 sm:px-4 rounded-lg font-bold text-sm whitespace-nowrap flex items-center gap-1.5 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:[s.jsx(rd,{className:"w-4 h-4"}),s.jsx("span",{children:u?"":""})]})]})]}),((R==null?void 0:R.kpiProdGrpCd)==="D"||(R==null?void 0:R.prodGrp)==="D"||t.PROD_GRP==="D")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(Zs,{value:q,onValueChange:V,options:mt,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:K,onChange:ke=>B(ke.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${u?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:u,disabled:u}),!u&&s.jsxs("p",{className:`text-xs text-right mt-1 ${K.length>=500?"text-red-500":"text-gray-400"}`,children:[K.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Me,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>j(!T),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${T?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"DTV ()"}),s.jsx(Zs,{value:te,onValueChange:J,options:Be,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"ISP ()"}),s.jsx(Zs,{value:O,onValueChange:S,options:De,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"VoIP (VoIP)"}),s.jsx(Zs,{value:A,onValueChange:Y,options:Ce,placeholder:"",disabled:u})]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!u&&s.jsx("button",{onClick:Ve,disabled:L,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${L?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:L?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>ye(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:Re,onClose:()=>X(!1),onSave:jt,workId:t.id,initialData:se,workType:t.WRK_CD,customerId:(ds=t.customer)==null?void 0:ds.id,customerName:(Ss=t.customer)==null?void 0:Ss.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:t.KPI_PROD_GRP_CD||"",prodChgGb:t.PROD_CHG_GB||"",chgKpiProdGrpCd:t.CHG_KPI_PROD_GRP_CD||"",prodGrp:t.PROD_GRP||"",wrkDtlTcd:t.WRK_DTL_TCD||"",readOnly:u}),s.jsx(Wa,{isOpen:Ne,onClose:()=>ye(!1),ctrtId:t.CTRT_ID,custId:(Ns=t.customer)==null?void 0:Ns.id}),s.jsx(Of,{isOpen:ne,onClose:()=>ue(!1),onSave:ke=>{et(ke.INSTL_LOC),it(ke.VIEW_MOD_CD),at(ke.VIEW_MOD_NM),ue(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(R==null?void 0:R.prodGrp)||(R==null?void 0:R.PROD_GRP),initialInstlLoc:xe,initialViewModCd:bt,initialViewModNm:At,showToast:r,readOnly:u}),s.jsx(Ng,{isOpen:ze,onClose:()=>dt(!1),onSave:$t,soId:t.SO_ID||""}),s.jsx(ul,{isOpen:We,onClose:()=>Dt(!1),onConfirm:ss,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{equipmentData:R,installInfoData:se,custRel:P,custRelOptions:ft,memo:K,installLocationText:xe,order:t})}),s.jsx(Rb,{isOpen:Tt,onClose:()=>St(!1),wrkCd:t.WRK_CD,wrkId:t.id,rcptId:t.RCPT_ID})]})},I5=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1,certifyReason:d})=>{var It,he,be,Oe;const u=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",f=t.WRK_CD==="07",[m,_]=x.useState(!1),{equipmentData:y,filteringData:g}=$i(),{certifyRegconfInfo:N}=Ba(),C=t.id||"",v=oa(C),R={...y||i||g||{},installedEquipments:v.installedEquipments.length>0?v.installedEquipments:(y==null?void 0:y.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:v.markedForRemoval.length>0?v.markedForRemoval:(y==null?void 0:y.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(v.removalStatus).length>0?v.removalStatus:(y==null?void 0:y.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:U,isPending:L}=od(),w=()=>`work_complete_draft_${t.id}`,[P,G]=x.useState(""),[K,B]=x.useState(""),[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(""),[q,V]=x.useState(""),[F,I]=x.useState(!1),[ee,ae]=x.useState(!1),[T,j]=x.useState(!1),[k,Q]=x.useState(""),[H,$]=x.useState([]),[ie,fe]=x.useState(!1),[pe,de]=x.useState([]),[Re,X]=x.useState(!1),[_e,me]=x.useState(""),[Z,le]=x.useState(""),[se,Ee]=x.useState(void 0),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(!1),[xe,et]=x.useState(""),[bt,it]=x.useState(""),[At,at]=x.useState(""),[We,Dt]=x.useState(!1),[Tt,St]=x.useState(!1),[ze,dt]=x.useState(!1),[Ke,rt]=x.useState(null),[ft,Ot]=x.useState(!1),[mt,Ze]=x.useState([]),[De,Ye]=x.useState(null),[Ce,ge]=x.useState(!1),[Be,ce]=x.useState(""),[Le,Xe]=x.useState(!1),[Pe,Ct]=x.useState("B"),[Me,lt]=x.useState([]),[ut,jt]=x.useState([]),[Ve,$t]=x.useState([]),[Ue,ss]=x.useState([]),[ls,ds]=x.useState([]),[Ss,Ns]=x.useState(()=>{const je=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(je&&je.length>=8)return`${je.slice(0,4)}-${je.slice(4,6)}-${je.slice(6,8)}`;const tt=new Date;return tt.getFullYear()+"-"+String(tt.getMonth()+1).padStart(2,"0")+"-"+String(tt.getDate()).padStart(2,"0")});x.useEffect(()=>{if(u){(async()=>{try{const Te=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(Te){G(Te.CUST_REL||""),B((Te.WRK_PROC_CT||"").replace(/\\n/g,`
`)),S(Te.PSN_USE_CORP||""),Y(Te.VOIP_USE_CORP||""),J(Te.DTV_USE_CORP||"");const _t=Te.UP_CTRL_CL||(R==null?void 0:R.upCtrlCl)||"";console.log("[CompleteMoveRemoval]  :",{API:Te.UP_CTRL_CL,:R==null?void 0:R.upCtrlCl,:_t}),V(_t),me(Te.NET_CL||""),le(Te.NET_CL_NM||""),et(Te.INSTL_LOC||""),Ee({NET_CL:Te.NET_CL||"",NET_CL_NM:Te.NET_CL_NM||"",WRNG_TP:Te.WRNG_TP||"",INSTL_TP:Te.INSTL_TP||"",CB_WRNG_TP:Te.CB_WRNG_TP||"",CB_INSTL_TP:Te.CB_INSTL_TP||"",INOUT_LINE_TP:Te.INOUT_LINE_TP||"",INOUT_LEN:Te.INOUT_LEN||"",DVDR_YN:Te.DVDR_YN||"",BFR_LINE_YN:Te.BFR_LINE_YN||"",CUT_YN:Te.CUT_YN||"",TERM_NO:Te.TERM_NO||"",RCV_STS:Te.RCV_STS||"",SUBTAP_ID:Te.SUBTAP_ID||"",PORT_NUM:Te.PORT_NUM||"",EXTN_TP:Te.EXTN_TP||"",TAB_LBL:Te.TAB_LBL||"",CVT_LBL:Te.CVT_LBL||"",STB_LBL:Te.STB_LBL||""}),Te.VOIP_JOIN_CTRT_ID&&Q(Te.VOIP_JOIN_CTRT_ID),(Te.CHK_CUST_ADDR==="true"||Te.CHK_CUST_ADDR==="Y")&&I(!0),(Te.CHK_PYM_ADDR==="true"||Te.CHK_PYM_ADDR==="Y")&&ae(!0),Te.WRKR_CMPL_DT&&Te.WRKR_CMPL_DT.length>=8&&Ns(`${Te.WRKR_CMPL_DT.slice(0,4)}-${Te.WRKR_CMPL_DT.slice(4,6)}-${Te.WRKR_CMPL_DT.slice(6,8)}`)}}catch(Te){console.error("[WorkCompleteMoveRemoval]     :",Te)}_(!0)})();return}const je=localStorage.getItem(w());if(je)try{const tt=JSON.parse(je);G(tt.custRel||""),B(tt.memo||""),S(tt.internetUse||""),Y(tt.voipUse||""),J(tt.dtvUse||""),V(tt.upCtrlCl||""),me(tt.networkType||""),le(tt.networkTypeName||""),et(tt.installLocationText||""),Ee(tt.installInfoData),tt.voipJoinCtrtId&&Q(tt.voipJoinCtrtId),tt.chkCustAddr!==void 0&&I(tt.chkCustAddr),tt.chkPymAddr!==void 0&&ae(tt.chkPymAddr)}catch(tt){console.error("[WorkCompleteMoveRemoval] localStorage  :",tt)}_(!0)},[t.id,u]),x.useEffect(()=>{if(!m||u)return;const je={custRel:P,memo:K,internetUse:O,voipUse:A,dtvUse:te,upCtrlCl:q,networkType:_e,networkTypeName:Z,installLocationText:xe,installInfoData:se,voipJoinCtrtId:k,chkCustAddr:F,chkPymAddr:ee,savedAt:new Date().toISOString()};localStorage.setItem(w(),JSON.stringify(je))},[P,K,O,A,te,q,_e,Z,xe,se,k,F,ee,m,u]),x.useEffect(()=>{(async()=>{try{const tt=await Jl(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);tt.CMCU005&&lt(tt.CMCU005.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM}))),tt.CMCT015&&(console.log("[CompleteMoveRemoval]  CMCT015 :",tt.CMCT015),jt(tt.CMCT015.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM})))),tt.CMCU057&&$t(tt.CMCU057.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM}))),tt.CMCU110&&ss(tt.CMCU110.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM}))),tt.CMCU148&&ds(tt.CMCU148.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM})))}catch(tt){console.error("[WorkCompleteMoveRemoval]   :",tt)}})()},[]),x.useEffect(()=>{(async()=>{try{const tt=await mc(),Te=(tt==null?void 0:tt.output)||tt||[];Ze(Te);const _t=t.PROD_CD||t.PROD_CD||"",Qe=Te.some(yt=>yt.PROD_CD===_t);Ot(Qe),console.log("[CompleteRelocate] LGHV :",{currentProdCd:_t,isLghv:Qe,prodListCount:Te.length})}catch(tt){console.error("[CompleteRelocate] LGHV   :",tt)}})()},[t.PROD_CD]),x.useEffect(()=>{if(t.WRK_CD!=="07")return;(async()=>{try{const tt=await Cg({WRK_CD:t.WRK_CD||"07",WRK_ID:t.id||"",RCPT_ID:t.RCPT_ID||""});Ye(tt),console.log("[CompleteRelocate] getMoveWorkInfo:",tt)}catch(tt){console.error("[CompleteRelocate] getMoveWorkInfo :",tt)}})()},[t.id,t.WRK_CD]),x.useEffect(()=>{(async()=>{const tt=t.PROD_CD||t.PROD_CD||"",Te=(R==null?void 0:R.prodPromoInfo)||[];if(tt==="PD10018480")console.log("[CompleteRelocate] OTT   :",tt),Xe(!0),Ct("C");else if(Te.some(yt=>yt.PROD_CD==="PD10018160"))console.log("[CompleteRelocate] OTT   : PD10018160"),Xe(!0),Ct("B");else{Xe(!1);return}const _t=t.id||"",Qe=t.directionId||t.WRK_DRCTN_ID||"";if(_t&&Qe)try{const yt=await sx({WRK_ID:_t,WRK_DRCTN_ID:Qe,DATA_TYPE:tt==="PD10018480"?"C":"B"});yt!=null&&yt.EQT_SERNO&&(console.log("[CompleteRelocate]  OTT :",yt.EQT_SERNO),ce(yt.EQT_SERNO))}catch(yt){console.error("[CompleteRelocate] OTT   :",yt)}})()},[t.PROD_CD,t.id,t.directionId,R==null?void 0:R.prodPromoInfo]),x.useEffect(()=>{R!=null&&R.upCtrlCl&&!q?(console.log("[CompleteMoveRemoval] equipmentData  :",R.upCtrlCl),V(R.upCtrlCl)):!q&&m&&!u&&(console.log("[CompleteMoveRemoval]   : 01 ()"),V("01"))},[R==null?void 0:R.upCtrlCl,m,u,q]),x.useEffect(()=>{var Te;if(u)return;const je=((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID;if(!je)return;(async()=>{try{console.log("[WorkCompleteMoveRemoval]     :",je);const _t=await If({CUST_ID:je});console.log("[WorkCompleteMoveRemoval]   :",_t),de(_t||[])}catch(_t){console.error("[WorkCompleteMoveRemoval]     :",_t),de([])}})()},[(It=t.customer)==null?void 0:It.id,t.CUST_ID,u]),x.useEffect(()=>{if(u)return;if(pe.length===0){console.log("[WorkCompleteMoveRemoval]     ...");return}const je=t.PROD_GRP||"",tt=t.VOIP_PROD_CD||"",Te=t.ISP_PROD_CD||"",_t=t.WRK_STAT_CD||"",Qe=t.ADDR_ORD||"";if(console.log("[WorkCompleteMoveRemoval]   :",{prodGrp:je,voipProdCd:tt,ispProdCd:Te,wrkStatCd:_t,addrOrd:Qe,customerCtrtListCount:pe.length}),je==="V"&&!tt){const yt=pe.filter($e=>{const ot=$e.PROD_GRP||"",wt=$e.CTRT_STAT||"",Bt=$e.ADDR_ORD||$e.addr_ord||"";return(ot==="C"||ot==="D"||ot==="I")&&wt==="20"&&(!Qe||Bt===Qe)});console.log("[WorkCompleteMoveRemoval] VoIP   :",yt),yt.length<1&&_t==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const vt=[{value:"",label:""},...yt.map($e=>({value:$e.CTRT_ID||"",label:`[${$e.CTRT_ID}] ${$e.BASIC_PROD_CD_NM||$e.PROD_NM||""}`}))];$(vt),fe(!0);return}if(je==="I"&&Te){const yt=pe.filter($e=>{const ot=$e.PROD_GRP||"",wt=$e.CTRT_STAT||"",Bt=$e.ADDR_ORD||$e.addr_ord||"",Yt=$e.ISP_JOIN_ID||"",Xt=$e.KPI_PROD_GRP_CD||"";return(ot==="D"||ot==="C")&&wt==="20"&&!Yt&&Xt==="D"&&(!Qe||Bt===Qe)});console.log("[WorkCompleteMoveRemoval] ISP   :",yt),yt.length<1&&_t==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const vt=[{value:"",label:""},...yt.map($e=>({value:$e.CTRT_ID||"",label:`[${$e.CTRT_ID}] ${$e.BASIC_PROD_CD_NM||$e.PROD_NM||""}`}))];$(vt),fe(!0);return}fe(!1),$([])},[t.id,t.WRK_STAT_CD,u,r,pe]);const ke=()=>{const je=[];P||je.push("  ."),se!=null&&se.NET_CL||je.push(" ."),xe||je.push(" ."),Ss||je.push(" .");const tt=t.PROD_GRP||"",Te=t.VOIP_PROD_CD||"",_t=t.ISP_PROD_CD||"";if(tt==="V"&&t.WRK_CD==="07"&&De&&De.WRK_STAT_CD!=="4"&&je.push("VOIP         ."),ft&&De&&t.WRK_CD==="07"){const yt=t.CTRT_ID||"",vt=De.OLD_CTRT_ID||"";if(yt!==vt){const $e=De.WRK_STAT_CD||"";if($e==="1"||$e==="2"){const ot=De.OLD_PROD_CD||"";mt.some(wt=>wt.PROD_CD===ot)&&je.push("LGHV STB  ,     .")}}}tt==="V"&&!Te&&ie&&(k||je.push("VOIP    .")),tt==="I"&&_t&&ie&&(k||je.push("  ISP .    .")),Le&&!Be&&je.push("OTT   OTT BOX   .");const Qe=(R==null?void 0:R.installedEquipments)||[];return tt!=="V"&&Qe.length<1&&je.push("()  ."),je},ct=je=>{Ee(je),je.NET_CL&&me(je.NET_CL),je.NET_CL_NM&&le(je.NET_CL_NM),r==null||r("  .","success")},st=()=>{if(L)return;const je=ke();if(je.length>0){je.forEach(Te=>r==null?void 0:r(Te,"error"));return}(t.PROD_GRP||"")!=="V"?dt(!0):Dt(!0)},Kt=je=>{rt(je),dt(!1),Dt(!0)},ht=(je,tt=!1)=>{if(!je||je.length===0)return[];const Te=localStorage.getItem("userInfo"),_t=Te?JSON.parse(Te):{},Qe=_t.userId||"A20130708",yt=(R==null?void 0:R.removalStatus)||{},vt=($e,ot)=>$e==="1"||$e==="Y"||ot==="1"||ot==="Y"?"1":"0";return je.map($e=>{var Yt,Xt,ts;const ot=$e.EQT_NO||$e.id||((Yt=$e.actualEquipment)==null?void 0:Yt.id)||"",wt=yt[ot]||{},Bt=tt?{CRR_TSK_CL:t.WRK_CD||"07",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||_t.crrId||"01",WRKR_ID:Qe,EQT_LOSS_YN:vt($e.EQT_LOSS_YN,wt.EQT_LOSS_YN),PART_LOSS_BRK_YN:vt($e.PART_LOSS_BRK_YN,wt.PART_LOSS_BRK_YN),EQT_BRK_YN:vt($e.EQT_BRK_YN,wt.EQT_BRK_YN),EQT_CABL_LOSS_YN:vt($e.EQT_CABL_LOSS_YN,wt.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:vt($e.EQT_CRDL_LOSS_YN,wt.EQT_CRDL_LOSS_YN)}:{};if($e.actualEquipment){const Ut=$e.actualEquipment,Es=$e.contractEquipment||{};return{...Ut,EQT_NO:Ut.id,EQT_SERNO:Ut.serialNumber,ITEM_MID_CD:Ut.itemMidCd,EQT_CL_CD:Ut.eqtClCd,MAC_ADDRESS:$e.macAddress||Ut.macAddress,WRK_ID:t.id,CUST_ID:(Xt=t.customer)==null?void 0:Xt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:Qe,SVC_CMPS_ID:Es.SVC_CMPS_ID||$e.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Es.BASIC_PROD_CMPS_ID||$e.BASIC_PROD_CMPS_ID||"",PROD_CMPS_ID:Es.PROD_CMPS_ID||$e.PROD_CMPS_ID||"",SVC_CD:Es.SVC_CD||$e.SVC_CD||"",PROD_CD:Es.PROD_CD||$e.PROD_CD||"",LENT_YN:$e.lentYn||$e.LENT_YN||Es.LENT_YN||"",EQT_CHG_GB:$e.EQT_CHG_GB||"01",...Bt}}return{...$e,EQT_NO:$e.EQT_NO||$e.id||"",EQT_SERNO:$e.EQT_SERNO||$e.serialNumber||"",ITEM_MID_CD:$e.ITEM_MID_CD||$e.itemMidCd||"",EQT_CL_CD:$e.EQT_CL_CD||$e.eqtClCd||"",MAC_ADDRESS:$e.MAC_ADDRESS||$e.macAddress||"",SVC_CMPS_ID:$e.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:$e.BASIC_PROD_CMPS_ID||"",PROD_CD:$e.PROD_CD||"",SVC_CD:$e.SVC_CD||"",WRK_ID:t.id,CUST_ID:(ts=t.customer)==null?void 0:ts.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:Qe,...Bt}})},qt=async()=>{var Xt,ts,Ut,Es,ys,Ps,ps,vs,Ms,cs;const je=Ss.replace(/-/g,""),tt=localStorage.getItem("userInfo"),Te=tt?JSON.parse(tt):{},_t=Te.userId||"A20130708",Qe=c||Mh(t.OP_LNKD_CD),yt=await bg(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let vt="";if(Qe){let ms=(R==null?void 0:R.prodPromoInfo)||[];if(ms.length===0)try{console.log("[CompleteRelocate] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),ms=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"07"}),console.log("[CompleteRelocate] getProdPromotionInfo fallback :",ms.length,"")}catch(Ls){console.log("[CompleteRelocate] getProdPromotionInfo fallback :",Ls)}const Ks=ms.filter(Ls=>(Ls.PROD_CMPS_CL==="21"||Ls.PROD_CMPS_CL==="22")&&(Ls.PROD_STAT_CD==="10"||Ls.PROD_STAT_CD==="20")).map(Ls=>Ls.PROD_CD).filter(Ls=>Ls);vt=Ks.length>0?Ks.join(",")+",":"",console.log("[CompleteRelocate] ADD_ON :",vt)}const $e=(R==null?void 0:R.installedEquipments)||[];if(Qe&&$e.length>0&&!N){r==null||r("  .","error");return}if(Qe&&N)try{const ms=t.OLD_CTRT_ID||t.CTRT_ID||"",{certifyType:Ks}=await S5(t,_t,ms);if(Ks){const Ls=d||(Ks==="C"?"":""),nt=Ks==="U"?(t.CTRT_ID||"")!==ms?ms:t.CTRT_ID||"":void 0,Ft=await yg({order:t,workerId:_t,certifyRegconfInfo:N,addOnParam:vt,reason:Ls,certifyType:Ks,contIdOld:nt});if(!Ft.success){r==null||r(` : ${Ft.message}`,"error");return}console.log("[CompleteRelocate] CL-04    ")}}catch(ms){console.error("[CompleteRelocate] CL-04  :",ms),r==null||r(`  : ${ms.message||"   "}`,"error");return}const ot=(R==null?void 0:R.installedEquipments)||[],wt=!!t.ISP_PROD_CD;if(!yt&&(wt||ot.length>0))try{const ms=t.PROD_GRP||"";let Ks="SMR03",Ls="",nt="",Ft="",Cs="",Ht="",Os="";ft&&(Ks="STB_CRT"),ms==="V"&&(Ks="SMR60");const Zt=(R==null?void 0:R.prodPromoInfo)||[],Ds=((Xt=Zt.find(cn=>cn.PROD_CMPS_CL==="23"))==null?void 0:Xt.PROD_CMPS_ID)||"",js=Zt.find(cn=>cn.PROD_CMPS_CL==="11"),hs=(js==null?void 0:js.PROD_CD)||"",Us=(js==null?void 0:js.PROD_GRP)||ms,Qs=Zt.filter(cn=>cn.BASIC_PROD_FL==="V").map(cn=>cn.PROD_CD),Is=Qs.length>0?Qs.join(","):"",_s=cn=>{const cr=ot.find(Fr=>{const Hi=Fr.actualEquipment||Fr;return(Hi.itemMidCd||Hi.ITEM_MID_CD)===cn});if(!cr)return"";const ni=cr.actualEquipment||cr;return ni.id||ni.EQT_NO||""};t.VOIP_PROD_CD?(Ls=_s("08"),nt=_s("02")):(Ls=_s("05")||_s("01")||_s("03")||(Us==="I"?_s("02"):"")||_s("08")||"",nt=_s("04")),Ft=_s("07"),Us==="C"&&(Cs=_s("02")),Us==="V"&&(Ht=_s("10")),wt&&(Ht=_s("21")),(ms==="V"||wt)&&(Os=k||t.CTRT_ID||"");let Lr=t.id||"";const Ir=ot.find(cn=>{const cr=cn.actualEquipment||cn;return(cr.eqtClCd||cr.EQT_CL_CD)==="091003"}),qr=ot.find(cn=>{const cr=cn.actualEquipment||cn;return(cr.eqtClCd||cr.EQT_CL_CD)==="092201"});if(Ir){const cn=Ir.actualEquipment||Ir;Lr=cn.id||cn.EQT_NO||t.id||""}else if(qr){const cn=qr.actualEquipment||qr;Lr=cn.macAddress||cn.MAC_ADDRESS||t.id||""}console.log("[CompleteRelocate]   :",{msgId:Ks,eqtNo:Ls,eqtProdCmpsId:Ds,prodCd:hs,subProdCd:Is,etc1:nt,etc2:Ft,etc3:Cs,etc4:Ht,signalWrkId:Lr});const vr=await la({MSG_ID:Ks,CUST_ID:((ts=t.customer)==null?void 0:ts.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ls,EQT_PROD_CMPS_ID:Ds,PROD_CD:hs,ITV_USR_ID:"",IP_CNT:"",ETC_1:nt,ETC_2:Ft,ETC_3:Cs,ETC_4:Ht,SUB_PROD_CD:Is,IF_DTL_ID:"",WRK_ID:Lr,REG_UID:_t,VOIP_JOIN_CTRT_ID:Os,WTIME:"3"});vr.code==="SUCCESS"||vr.code==="OK"?console.log("[CompleteRelocate]    "):(console.warn("[CompleteRelocate]    :",vr.message),ms!=="V"&&(r==null||r("   .  .","warning")))}catch(ms){console.error("[CompleteRelocate]    :",ms),r==null||r("   .  .","warning")}const Bt=(R==null?void 0:R.removedEquipments)||[];if(Bt.length>0&&!yt&&!ft){let ms=!1;for(const Ls of Bt){const nt=Ls.actualEquipment||Ls,Ft=nt.eqtClCd||nt.EQT_CL_CD||"";Ft==="090901"||Ft==="091001"||Ft==="091005"||(ms=!0)}const Ks=t.PROD_GRP||"";if(t.WRK_CD==="07"&&Ks==="V"&&(ms=!1),ms)try{const Ls=(R==null?void 0:R.removedProdPromoInfo)||(R==null?void 0:R.prodPromoInfo)||[],nt=((Es=(Ut=Ls.find)==null?void 0:Ut.call(Ls,Ht=>Ht.PROD_CMPS_CL==="23"))==null?void 0:Es.PROD_CMPS_ID)||"";let Ft="";Ks==="V"&&(Ft=t.VOIP_PROD_CD?t.CTRT_ID||"":k||t.CTRT_ID||""),console.log("[CompleteRelocate]   :",{msgId:"SMR05",delEqtProdCmpsId:nt,prodGrpForDel:Ks});const Cs=await la({MSG_ID:"SMR05",CUST_ID:((ys=t.customer)==null?void 0:ys.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:nt,PROD_CD:"",WRK_ID:t.id||"",REG_UID:_t,ETC_1:"",ETC_2:"",ETC_3:"",ETC_4:"",VOIP_JOIN_CTRT_ID:Ft,WTIME:"3"});if(Cs.code!=="SUCCESS"&&Cs.code!=="OK"){if((((Ps=Cs.O_IFSVC_RESULT)==null?void 0:Ps.substring(14,20))||"")!=="029"&&((ps=Cs.message)==null?void 0:ps.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteRelocate]    -  :",Cs.message),r==null||r("   .","error",!0);return}}else console.log("[CompleteRelocate]    ")}catch(Ls){console.error("[CompleteRelocate]     :",Ls),r==null||r("   .","error",!0);return}}else Bt.length>0&&ft&&console.log("[CompleteRelocate] LGHV STB  -  skip ( )");const Yt={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(vs=t.customer)==null?void 0:vs.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||Te.crrId||"01",WRKR_ID:_t,WRKR_CMPL_DT:je,MEMO:K||" ",STTL_YN:"Y",REG_UID:_t,CUST_REL:P,CNFM_CUST_NM:((Ms=t.customer)==null?void 0:Ms.name)||"",CNFM_CUST_TELNO:((cs=t.customer)==null?void 0:cs.contactNumber)||"",INSTL_LOC:xe||"",UP_CTRL_CL:q||"",PSN_USE_CORP:O||"",VOIP_USE_CORP:A||"",DTV_USE_CORP:te||"",WRK_ACT_CL:"20",TV_TYPE:"",NET_CL:(se==null?void 0:se.NET_CL)||"",WRNG_TP:(se==null?void 0:se.WRNG_TP)||"",INSTL_TP:(se==null?void 0:se.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:k||"",OLD_CTRT_ID:t.OLD_CTRT_ID||"",CHK_CUST_ADDR:f?F?"true":"false":"",CHK_PYM_ADDR:f?ee?"true":"false":"",ADD_ON:vt||""},equipmentList:ht((R==null?void 0:R.installedEquipments)||[],!1),removeEquipmentList:ht((R==null?void 0:R.removedEquipments)||[],!0),spendItemList:(R==null?void 0:R.spendItems)||[],agreementList:(R==null?void 0:R.agreements)||[],poleList:Ke?[{WRK_ID:t.id,POLE_YN:Ke.POLE_YN,LAN_GB:Ke.LAN_GB||"",REG_UID:_t}]:[]};U(Yt,{onSuccess:ms=>{ms.code==="SUCCESS"||ms.code==="OK"?(localStorage.removeItem(w()),t.WRK_STAT_CD="3",r==null||r("  .","success"),n()):r==null||r(ms.message||"   .","error",!0)},onError:ms=>{r==null||r(ms.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[L&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[ie&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:k,onValueChange:Q,options:H,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Z||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>X(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${u?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:u?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:P,onValueChange:G,options:Me,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{children:xe||""}),At&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(: ",At,")"]})]}),s.jsxs("button",{type:"button",onClick:()=>ue(!0),className:`min-h-10 px-3 sm:px-4 rounded-lg font-bold text-sm whitespace-nowrap flex items-center gap-1.5 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:[s.jsx(rd,{className:"w-4 h-4"}),s.jsx("span",{children:u?"":""})]})]})]}),((R==null?void 0:R.kpiProdGrpCd)==="D"||(R==null?void 0:R.prodGrp)==="D"||t.PROD_GRP==="D")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(Zs,{value:q,onValueChange:V,options:ut,placeholder:"",disabled:u})]}),Le&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["OTT BOX  ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Be,readOnly:!0,placeholder:"SER_NO   ",className:"flex-1 px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600"}),s.jsxs("button",{type:"button",onClick:()=>ge(!0),disabled:u,className:`px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 ${u?"bg-gray-400 text-white cursor-not-allowed":Be?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"SER_NO"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:K,onChange:je=>B(je.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${u?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:u,disabled:u}),!u&&s.jsxs("p",{className:`text-xs text-right mt-1 ${K.length>=500?"text-red-500":"text-gray-400"}`,children:[K.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Ss,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>j(!T),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${T?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"DTV ()"}),s.jsx(Zs,{value:te,onValueChange:J,options:ls,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"ISP ()"}),s.jsx(Zs,{value:O,onValueChange:S,options:Ve,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"VoIP (VoIP)"}),s.jsx(Zs,{value:A,onValueChange:Y,options:Ue,placeholder:"",disabled:u})]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!u&&s.jsx("button",{onClick:st,disabled:L,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${L?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:L?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>ye(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:Re,onClose:()=>X(!1),onSave:ct,workId:t.id,initialData:se,workType:t.WRK_CD,customerId:(he=t.customer)==null?void 0:he.id,customerName:(be=t.customer)==null?void 0:be.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:t.KPI_PROD_GRP_CD||"",prodChgGb:t.PROD_CHG_GB||"",chgKpiProdGrpCd:t.CHG_KPI_PROD_GRP_CD||"",prodGrp:t.PROD_GRP||"",wrkDtlTcd:t.WRK_DTL_TCD||"",readOnly:u}),s.jsx(Wa,{isOpen:Ne,onClose:()=>ye(!1),ctrtId:t.CTRT_ID,custId:(Oe=t.customer)==null?void 0:Oe.id}),s.jsx(Of,{isOpen:ne,onClose:()=>ue(!1),onSave:je=>{et(je.INSTL_LOC),it(je.VIEW_MOD_CD),at(je.VIEW_MOD_NM),ue(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(R==null?void 0:R.prodGrp)||(R==null?void 0:R.PROD_GRP),initialInstlLoc:xe,initialViewModCd:bt,initialViewModNm:At,showToast:r,readOnly:u}),s.jsx(Ng,{isOpen:ze,onClose:()=>dt(!1),onSave:Kt,soId:t.SO_ID||""}),s.jsx(ul,{isOpen:We,onClose:()=>Dt(!1),onConfirm:qt,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{equipmentData:R,installInfoData:se,custRel:P,custRelOptions:Me,memo:K,installLocationText:xe,order:t})}),s.jsx(Rb,{isOpen:Tt,onClose:()=>St(!1),wrkCd:t.WRK_CD,wrkId:t.id,rcptId:t.RCPT_ID}),s.jsx(vb,{isOpen:Ce,onClose:()=>ge(!1),onSave:je=>{ce(je),r==null||r("OTT  .","success")},wrkId:t.id||"",wrkDrctnId:t.directionId||t.WRK_DRCTN_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",dataType:Pe,showToast:r,readOnly:u})]})},O5=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1,certifyMode:c=!1})=>{var be,Oe,je,tt;const d=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[u,f]=x.useState(!1),{equipmentData:m,filteringData:_,removalLineData:y,setRemovalLineData:g}=$i(),{certifyRegconfInfo:N}=Ba(),C=t.id||"",v=oa(C),R=ji(Te=>{var _t;return((_t=Te.workStates[C])==null?void 0:_t.reuseAll)??!1}),U=ji(Te=>Te.setReuseAll),L={...m||i||_||{},installedEquipments:v.installedEquipments.length>0?v.installedEquipments:(m==null?void 0:m.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:v.removeEquipments.length>0?v.removeEquipments:(m==null?void 0:m.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(v.removalStatus).length>0?v.removalStatus:(m==null?void 0:m.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:w,isPending:P}=od(),G=()=>`work_complete_draft_${t.id}`,[K,B]=x.useState(""),[O,S]=x.useState(""),[A,Y]=x.useState(""),[te,J]=x.useState(""),[q,V]=x.useState(!1),[F,I]=x.useState(""),[ee,ae]=x.useState(""),[T,j]=x.useState(void 0),[k,Q]=x.useState(!1),H=y,$=g,[ie,fe]=x.useState(!1),[pe,de]=x.useState(!1),[Re,X]=x.useState(!1),[_e,me]=x.useState(null),[Z,le]=x.useState(!1),[se,Ee]=x.useState(null),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(""),[xe,et]=x.useState(!1),[bt,it]=x.useState(!1),[At,at]=x.useState("none"),[We,Dt]=x.useState(""),[Tt,St]=x.useState(!1),[ze,dt]=x.useState([]),[Ke,rt]=x.useState([]),[ft,Ot]=x.useState([]),[mt,Ze]=x.useState(null),[De,Ye]=x.useState(!1),[Ce,ge]=x.useState(""),[Be,ce]=x.useState(!1),[Le,Xe]=x.useState(null),[Pe,Ct]=x.useState(!1),[Me,lt]=x.useState(!1),[ut,jt]=x.useState(()=>{const Te=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(Te&&Te.length>=8)return`${Te.slice(0,4)}-${Te.slice(4,6)}-${Te.slice(6,8)}`;const _t=new Date;return _t.getFullYear()+"-"+String(_t.getMonth()+1).padStart(2,"0")+"-"+String(_t.getDate()).padStart(2,"0")});x.useEffect(()=>{var _t,Qe;if(Y(((_t=t.customer)==null?void 0:_t.name)||""),J(((Qe=t.customer)==null?void 0:Qe.contactNumber)||t.REQ_CUST_TEL_NO||""),d){console.log("[WorkCompleteRemovalTerminate]   - getWorkReceiptDetail API "),(async()=>{try{const vt=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});vt?(console.log("[WorkCompleteRemovalTerminate] API :",vt),B(vt.CUST_REL||""),S((vt.WRK_PROC_CT||"").replace(/\\n/g,`
`)),I(vt.NET_CL||""),ae(vt.NET_CL_NM||""),j({NET_CL:vt.NET_CL||"",NET_CL_NM:vt.NET_CL_NM||"",WRNG_TP:vt.WRNG_TP||"",INSTL_TP:vt.INSTL_TP||"",CB_WRNG_TP:vt.CB_WRNG_TP||"",CB_INSTL_TP:vt.CB_INSTL_TP||"",INOUT_LINE_TP:vt.INOUT_LINE_TP||"",INOUT_LEN:vt.INOUT_LEN||"",DVDR_YN:vt.DVDR_YN||"",BFR_LINE_YN:vt.BFR_LINE_YN||"",CUT_YN:vt.CUT_YN||"",TERM_NO:vt.TERM_NO||"",RCV_STS:vt.RCV_STS||"",SUBTAP_ID:vt.SUBTAP_ID||"",PORT_NUM:vt.PORT_NUM||"",EXTN_TP:vt.EXTN_TP||"",TAB_LBL:vt.TAB_LBL||"",CVT_LBL:vt.CVT_LBL||"",STB_LBL:vt.STB_LBL||""}),S((vt.WRK_PROC_CT||"").replace(/\\n/g,`
`)),vt.WRKR_CMPL_DT&&vt.WRKR_CMPL_DT.length>=8&&jt(`${vt.WRKR_CMPL_DT.slice(0,4)}-${vt.WRKR_CMPL_DT.slice(4,6)}-${vt.WRKR_CMPL_DT.slice(6,8)}`)):(console.log("[WorkCompleteRemovalTerminate] API  - order  "),B(t.CUST_REL||""),I(t.NET_CL||""),ae(t.NET_CL_NM||""))}catch(vt){console.error("[WorkCompleteRemovalTerminate] API  :",vt),B(t.CUST_REL||""),I(t.NET_CL||""),ae(t.NET_CL_NM||"")}finally{f(!0)}})();return}const Te=localStorage.getItem(G());if(Te)try{const yt=JSON.parse(Te);B(yt.custRel||""),S(yt.memo||""),I(yt.networkType||""),ae(yt.networkTypeName||""),j(yt.installInfoData),yt.cnfmCustNm&&Y(yt.cnfmCustNm),yt.cnfmCustTelno&&J(yt.cnfmCustTelno)}catch(yt){console.error("[WorkCompleteRemovalTerminate] localStorage  :",yt)}f(!0)},[t.id,d]),x.useEffect(()=>{if(!u||d)return;const Te={custRel:K,memo:O,networkType:F,networkTypeName:ee,installInfoData:T,cnfmCustNm:A,cnfmCustTelno:te,savedAt:new Date().toISOString()};localStorage.setItem(G(),JSON.stringify(Te))},[K,O,F,ee,T,A,te,u,d]),x.useEffect(()=>{(async()=>{var _t;try{const Qe=await Jl(["CMCU005"]);Qe.CMCU005&&Ot(Qe.CMCU005.map($e=>({value:$e.COMMON_CD,label:$e.COMMON_CD_NM})));try{const $e=await Cg({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:t.WRKR_ID||"",PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"02",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||((_t=t.customer)==null?void 0:_t.ADDR_ORD)||"",WRK_CD:t.WRK_CD||"08",WRK_STAT_CD:t.WRK_STAT_CD||""});console.log("[CompleteRelocateTerminate] :",$e),me($e);const ot=($e==null?void 0:$e.MVM_TP)||"",wt=($e==null?void 0:$e.WRK_STAT_CD)||"",Bt=($e==null?void 0:$e.CTRT_ID)||"",Yt=($e==null?void 0:$e.OLD_CTRT_ID)||"",Xt=wt==="2";console.log("[CompleteRelocateTerminate]  :",{MVM_TP:ot,WRK_STAT_CD:wt,CTRT_ID:Bt,OLD_CTRT_ID:Yt,shouldReuse:Xt}),!Xt&&R&&U(C,!1)}catch($e){console.error("[CompleteRelocateTerminate]   :",$e)}const yt=await mc();if(yt&&yt.length>0){dt(yt);const $e=t.PROD_CD||t.BASIC_PROD_CD||"",ot=yt.some(wt=>wt.PROD_CD===$e);St(ot),console.log("[WorkCompleteRemovalTerminate] LGHV STB :",{prodCd:$e,isLghv:ot,lghvListCount:yt.length})}const vt=t.CERTIFY_TG||"";if(vt==="Y"){const $e=await ex();rt($e);const ot=t.NEW_PROD_CD||t.PROD_CD||"",wt=t.SO_ID||"",Bt=$e.some(Yt=>Yt.PROD_CD===ot);console.log("[WorkCompleteRemovalTerminate]  :",{certifyTg:vt,newProdCd:ot,soId:wt,isCertifyProd:Bt}),Bt||et(!0)}}catch(Qe){console.error("[WorkCompleteRemovalTerminate]    :",Qe)}})()},[t]);const Ve=Te=>!Te||Te.length!==8?"":`${Te.slice(0,4)}-${Te.slice(4,6)}-${Te.slice(6,8)}`,$t=Te=>Te.replace(/-/g,""),Ue=()=>new Date().toISOString().slice(0,10).replace(/-/g,""),ss=(Te,_t)=>{if(!Te||!_t)return 0;const Qe=new Date(Ve(Te)),yt=new Date(Ve(_t));return Math.ceil((yt.getTime()-Qe.getTime())/(1e3*60*60*24))},ls=x.useCallback(async()=>{const Te=t.RCPT_ID||"",_t=t.CTRT_ID||"";if(!(!Te||!_t)){Ye(!0),Xe(null);try{const Qe=await f5({RCPT_ID:Te,CTRT_ID:_t});if(console.log("[CompleteRemovalTerminate]   :",Qe),Qe){Ze(Qe),ge(Ve(Qe.MMT_SUS_HOPE_DD));const yt=Ue();Qe.WRK_DTL_TCD==="0430"&&Qe.MMT_SUS_HOPE_DD<=yt?(ce(!0),r==null||r("  .   .","warning")):ce(!1)}}catch(Qe){console.error("[CompleteRemovalTerminate]   :",Qe),Xe(Qe.message||"   ")}finally{Ye(!1)}}},[t.RCPT_ID,t.CTRT_ID,r]);x.useEffect(()=>{ls()},[ls]);const ds=()=>{const Te=[];return(!K||K==="[]")&&Te.push("  ."),T!=null&&T.NET_CL||Te.push("  ."),T!=null&&T.WRNG_TP||Te.push("  ."),T!=null&&T.INSTL_TP?T.INSTL_TP!=="77"&&Te.push('   "(77)" .'):Te.push("  ."),ut||Te.push(" ."),st()&&!H&&Te.push("   ."),Te},Ss=Te=>{j(Te),Te.NET_CL&&I(Te.NET_CL),Te.NET_CL_NM&&ae(Te.NET_CL_NM),r==null||r("  .","success")},Ns=async()=>{var Te;it(!0),Dt(""),at("none");try{const _t=localStorage.getItem("userInfo"),Qe=_t?JSON.parse(_t):{},yt=await R_({CTRT_ID:t.CTRT_ID||"",CUST_ID:((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:Qe.userId||"",WRK_ID:t.id||""});yt!=null&&yt.ERROR?(at("error"),Dt(yt.ERROR),r==null||r(` : ${yt.ERROR}`,"error")):(at("success"),Dt(" ."),r==null||r(" .","success"))}catch(_t){console.error("[ CL-06 ]:",_t),at("error"),Dt(_t.message||"    ."),r==null||r(_t.message||"    .","error",!0)}finally{it(!1)}},ke=async()=>{var Te;it(!0),Dt("");try{const _t=localStorage.getItem("userInfo"),Qe=_t?JSON.parse(_t):{},yt=await Jm({CTRT_ID:t.CTRT_ID||"",CUST_ID:((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:Qe.userId||"",WRK_ID:t.id||""}),vt=Array.isArray(yt)?yt[0]:yt;if(vt!=null&&vt.ERROR)at("error"),Dt(` : ${vt.ERROR}`),r==null||r(` : ${vt.ERROR}`,"warning");else{const $e=(vt==null?void 0:vt.RESULT)||(vt==null?void 0:vt.MSG)||JSON.stringify(vt);Dt(` : ${$e}`),r==null||r(" ","info")}}catch(_t){console.error("[ CL-08 ]:",_t),Dt(_t.message||"   ."),r==null||r(_t.message||"   .","error",!0)}finally{it(!1)}},ct=async()=>{var Qe,yt,vt,$e,ot;const Te=(L==null?void 0:L.removedEquipments)||[];if((t.CTRT_STAT||"")==="20")return console.log("[]  20 - "),!0;try{const wt=localStorage.getItem("userInfo"),Yt=(wt?JSON.parse(wt):{}).userId||"A20130708";let Xt="SMR05",ts="";if(Tt){const cs=(_e==null?void 0:_e.NEW_PROD_CD)||"",ms=(_e==null?void 0:_e.OLD_PROD_CD)||"",Ks=(_e==null?void 0:_e.CTRT_ID)||t.CTRT_ID||"",Ls=(_e==null?void 0:_e.OLD_CTRT_ID)||"",nt=ze.some(Cs=>Cs.PROD_CD===cs),Ft=ze.some(Cs=>Cs.PROD_CD===ms);if(nt&&Ft){if(Ks===Ls)return console.log("[] LGHV LL  -   "),le(!0),!0}else{const Cs=Te.find(Ht=>{var Os,Zt;return(Ht.ITEM_MID_CD||Ht.itemMidCd||((Os=Ht.actualEquipment)==null?void 0:Os.ITEM_MID_CD)||((Zt=Ht.actualEquipment)==null?void 0:Zt.itemMidCd))==="04"});Cs&&(ts=Cs.EQT_NO||Cs.id||((Qe=Cs.actualEquipment)==null?void 0:Qe.EQT_NO)||((yt=Cs.actualEquipment)==null?void 0:yt.id)||"")}Xt="STB_DEL"}const Ut=t.DTL_CTRT_ID||t.CTRT_ID||"",Es=Te.some(cs=>{var ms;return cs.CTRT_ID===Ut||((ms=cs.actualEquipment)==null?void 0:ms.CTRT_ID)===Ut});Te.length>0&&!Es&&(console.warn("[]    -   "),r==null||r("    .","warning"));const ys=Te.find(cs=>{var ms;return cs.PROD_CMPS_CL==="23"||((ms=cs.actualEquipment)==null?void 0:ms.PROD_CMPS_CL)==="23"}),Ps=(ys==null?void 0:ys.PROD_CMPS_ID)||((vt=ys==null?void 0:ys.actualEquipment)==null?void 0:vt.PROD_CMPS_ID)||(ys==null?void 0:ys.EQT_PROD_CMPS_ID)||(($e=ys==null?void 0:ys.actualEquipment)==null?void 0:$e.EQT_PROD_CMPS_ID)||"",vs=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"";console.log(`[] ${Xt}  `,{isLghvStb:Tt,eqtProdCmpsId:Ps,etc1:ts,voipJoinCtrtId:vs});const Ms=await la({MSG_ID:Xt,CUST_ID:((ot=t.customer)==null?void 0:ot.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Ps,PROD_CD:"",WRK_ID:t.id||"",REG_UID:Yt,ETC_1:ts,ETC_2:"",ETC_3:"",ETC_4:"",VOIP_JOIN_CTRT_ID:vs,WTIME:"3"});return Ms.code==="SUCCESS"||Ms.code==="OK"||Ms.message&&Ms.message.indexOf("TRUE")>-1&&Ms.message.indexOf("000000")>-1?(console.log("[] :",Ms),le(!0),Ee({success:!0,message:"  "}),!0):(console.warn("[] :",Ms),Ee({success:!1,message:Ms.message||"  "}),!1)}catch(wt){return console.error("[] :",wt),Ee({success:!1,message:wt.message||"  "}),!1}},st=()=>{const Te=t.KPI_PROD_GRP_CD||"",_t=t.VOIP_CTX||"";return["C","D","I"].includes(Te)&&_t!=="T"&&_t!=="R"},Kt=Te=>{console.log("[WorkCompleteRemovalTerminate]   () :",Te),$(Te),r==null||r("  .   .","info")},ht=Te=>{console.log("[WorkCompleteRemovalTerminate]   - AS  :",Te),$(Te),fe(!0)},qt=async Te=>{console.log("[WorkCompleteRemovalTerminate] AS :",Te),de(!0);try{const _t=localStorage.getItem("userInfo"),yt=(_t?JSON.parse(_t):{}).userId||"A20130708",vt=await T_({WRK_ID:t.id,REMOVE_LINE_TP:Te.REMOVE_LINE_TP,REMOVE_GB:Te.REMOVE_GB,REMOVE_STAT:Te.REMOVE_STAT||"",REG_UID:yt});if(vt.code!=="SUCCESS"&&vt.code!=="OK")throw new Error(vt.message||"   .");const $e=await h5({CUST_ID:Te.CUST_ID,RCPT_ID:Te.RCPT_ID||"",WRK_DTL_TCD:Te.WRK_DTL_TCD,WRK_RCPT_CL:Te.WRK_RCPT_CL,WRK_RCPT_CL_DTL:Te.WRK_RCPT_CL_DTL,WRK_HOPE_DTTM:Te.WRK_HOPE_DTTM,MEMO:Te.MEMO||"",EMRG_YN:Te.EMRG_YN||"N",HOLY_YN:Te.HOLY_YN||"N",CRR_ID:Te.CRR_ID||"01",WRKR_ID:Te.WRKR_ID||yt,REG_UID:Te.REG_UID||yt});if($e.code==="SUCCESS"||$e.code==="OK")fe(!1),r==null||r("AS .   .","success");else throw new Error($e.message||"AS .")}catch(_t){r==null||r(_t.message||"AS   .","error",!0)}finally{de(!1)}},It=()=>{if(P)return;if(((L==null?void 0:L.removedEquipments)||[]).some(vt=>{var $e;return vt.PROD_CMPS_CL==="23"||(($e=vt.actualEquipment)==null?void 0:$e.PROD_CMPS_CL)==="23"})){r==null||r("      .  .","error");return}const Qe=ds();if(Qe.length>0){if(Qe.forEach(vt=>r==null?void 0:r(vt,"error")),Qe.some(vt=>vt.includes(""))){const vt=document.getElementById("removal-line-section");vt&&(vt.scrollIntoView({behavior:"smooth",block:"center"}),vt.classList.add("ring-2","ring-red-500","ring-offset-2"),setTimeout(()=>{vt.classList.remove("ring-2","ring-red-500","ring-offset-2")},2e3))}return}const yt=t.TERM_HOPE_DT||t.HOPE_DT||"";if(yt&&ut){const vt=yt.replace(/-/g,"");ut.replace(/-/g,"")<vt&&(r==null||r("  .","warning"))}ue(" ?"),ye(!0)},he=async()=>{var Es,ys,Ps;console.log("[WorkCompleteRemovalTerminate]   ");const Te=localStorage.getItem("userInfo"),_t=Te?JSON.parse(Te):{},Qe=_t.userId||"A20130708";let yt="N";const vt=c||Mh(t.OP_LNKD_CD);if(console.log("[CompleteRelocateTerminate] FTTH :",{IS_CERTIFY_PROD:t.IS_CERTIFY_PROD,OP_LNKD_CD:t.OP_LNKD_CD,isFtth:vt}),vt)try{const ps=t.CTRT_ID||"",vs=await Jm({CTRT_ID:ps,CUST_ID:((Es=t.customer)==null?void 0:Es.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:Qe,WRK_ID:t.id||""}),Ms=Array.isArray(vs)?vs[0]:vs;console.log("[CompleteRelocateTerminate] CL-08 result:",Ms,"ctrtId:",ps),Ms&&!Ms.ERROR&&Ms.CONT_ID===ps&&(yt="Y",console.log("[CompleteRelocateTerminate] CERTIFY_TG=Y (IS_CERTIFY_PROD=1 + CL-08 confirmed)"))}catch(ps){console.log("[CompleteRelocateTerminate] CL-08 query failed:",ps)}if(yt==="Y")try{const ps=(_e==null?void 0:_e.NEW_PROD_CD)||"",vs=(_e==null?void 0:_e.SO_ID)||t.SO_ID||"",Ms=Ke.some(Ls=>Ls.PROD_CD===ps),Ks=(await ka("CMIF006")).map(Ls=>Ls.code).includes(vs);if(console.log("[CompleteRelocateTerminate] CL-06  :",{certifyTg:yt,newProdCd:ps,newSoId:vs,isNewProdCertify:Ms,isNewSoCertify:Ks}),!Ms||!Ks){console.log("[CompleteRelocateTerminate] FTTH CL-06    ");const Ls=await R_({CTRT_ID:t.CTRT_ID||"",CUST_ID:((ys=t.customer)==null?void 0:ys.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:vs||t.SO_ID||"",REG_UID:Qe});if(Ls!=null&&Ls.ERROR){console.error("[CompleteRelocateTerminate] CL-06  :",Ls.ERROR),r==null||r(`  : ${Ls.ERROR}`,"error");return}console.log("[CompleteRelocateTerminate] CL-06    ")}else console.log("[CompleteRelocateTerminate]  /SO certify  CL-06 ")}catch(ps){console.error("[CompleteRelocateTerminate] CL-06  :",ps),r==null||r(`   : ${ps.message||"   "}`,"error");return}if(H&&H.REMOVE_GB==="4")try{console.log("[WorkCompleteRemovalTerminate]   API :",H);const ps=await T_({WRK_ID:t.id||"",REMOVE_LINE_TP:H.REMOVE_LINE_TP||"",REMOVE_GB:H.REMOVE_GB||"4",REMOVE_STAT:H.REMOVE_STAT||"",REG_UID:Qe});if(ps.code!=="SUCCESS"&&ps.code!=="OK"){r==null||r(ps.message||"   .","error",!0);return}console.log("[WorkCompleteRemovalTerminate]    ")}catch(ps){r==null||r(ps.message||"     .","error",!0);return}if(Me&&mt&&Ce){Ct(!0);try{const ps=mt.SUS_HOPE_DD,vs=$t(Ce),Ms=ss(ps,vs),cs=await m5({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",SUS_HOPE_DD:ps,MMT_SUS_HOPE_DD:vs,SUS_DD_NUM:String(Ms),REG_UID:Qe});if(cs.code!=="SUCCESS"){r==null||r(cs.message||"  ","error",!0),Ct(!1);return}console.log("[CompleteRemovalTerminate]   ")}catch(ps){r==null||r(ps.message||"  ","error",!0),Ct(!1);return}Ct(!1)}const $e=(L==null?void 0:L.removedEquipments)||[],ot=(L==null?void 0:L.customerEquipments)||[],wt=(L==null?void 0:L.installedEquipments)||[],Bt=!!t.ISP_PROD_CD,Yt=t.CTRT_STAT||"";if(console.log("[CompleteRelocateTerminate]   :",{signalSent:Z,certifyTg:yt,removedEquipments:$e.length,customerEquipments:ot.length,installedEquipments:wt.length,hasIspProdForSignal:Bt,ctrtStat:Yt,ISP_PROD_CD:t.ISP_PROD_CD,CTRT_STAT:t.CTRT_STAT,shouldSendSignal:!Z&&yt!=="Y"&&($e.length>0||ot.length>0||wt.length>0||Bt)&&Yt!=="20"}),!Z&&yt!=="Y"&&($e.length>0||ot.length>0||wt.length>0||Bt)&&Yt!=="20"&&(r==null||r(" ...","info"),!await ct())){const vs=t.PROD_GRP||"",Ms=(se==null?void 0:se.message)||"";if(vs==="V"&&Ms.indexOf("PROC_VOIP_KCT-029")<0){r==null||r("VoIP   .","error",!0);return}if((t.MSO_OUT_YN||"")==="Y"){r==null||r("MSO      .  .","error");return}if(!window.confirm(` .
  ?`)){console.log("[CompleteRemovalTerminate]      ");return}console.log("[CompleteRemovalTerminate]      ")}const Xt=ut.replace(/-/g,""),ts=ps=>{if(!ps||ps.length===0)return[];const vs=(L==null?void 0:L.removalStatus)||{},Ms=(cs,ms)=>cs==="1"||cs==="Y"||ms==="1"||ms==="Y"?"1":"0";return ps.map(cs=>{var Ft,Cs,Ht,Os;const ms=cs.EQT_NO||cs.id||((Ft=cs.actualEquipment)==null?void 0:Ft.id)||"",Ks=vs[ms]||vs[cs.id]||vs[cs.EQT_NO]||vs[(Cs=cs.actualEquipment)==null?void 0:Cs.id]||vs[cs.serialNumber]||{},Ls=R?"1":"0",nt={CRR_TSK_CL:"02",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||_t.crrId||"01",WRKR_ID:Qe,EQT_LOSS_YN:Ms(cs.EQT_LOSS_YN,Ks.EQT_LOSS_YN),PART_LOSS_BRK_YN:Ms(cs.PART_LOSS_BRK_YN,Ks.PART_LOSS_BRK_YN),EQT_BRK_YN:Ms(cs.EQT_BRK_YN,Ks.EQT_BRK_YN),EQT_CABL_LOSS_YN:Ms(cs.EQT_CABL_LOSS_YN,Ks.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Ms(cs.EQT_CRDL_LOSS_YN,Ks.EQT_CRDL_LOSS_YN),REUSE_YN:Ls};if(cs.actualEquipment){const Zt=cs.actualEquipment,Ds=cs.contractEquipment||{};return{...Zt,EQT_NO:Zt.id,EQT_SERNO:Zt.serialNumber,ITEM_MID_CD:Zt.itemMidCd,EQT_CL_CD:Zt.eqtClCd,MAC_ADDRESS:cs.macAddress||Zt.macAddress,WRK_ID:t.id,CUST_ID:(Ht=t.customer)==null?void 0:Ht.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:Ds.id||Ds.SVC_CMPS_ID||Zt.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Zt.BASIC_PROD_CMPS_ID||Ds.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:Zt.EQT_PROD_CMPS_ID||Ds.id,PROD_CD:Zt.PROD_CD||Ds.PROD_CD||t.PROD_CD||"",SVC_CD:Zt.SVC_CD||Ds.SVC_CD||"",EQT_SALE_AMT:Zt.EQT_SALE_AMT||"0",MST_SO_ID:Zt.MST_SO_ID||t.SO_ID||"",SO_ID:Zt.SO_ID||t.SO_ID||"",REG_UID:Qe,OLD_LENT_YN:Zt.OLD_LENT_YN||"N",LENT:Zt.LENT||"10",ITLLMT_PRD:Zt.ITLLMT_PRD||"00",EQT_USE_STAT_CD:Zt.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:Zt.IF_DTL_ID||"",...nt}}return{...cs,EQT_NO:cs.EQT_NO||cs.id||"",EQT_SERNO:cs.EQT_SERNO||cs.serialNumber||"",ITEM_MID_CD:cs.ITEM_MID_CD||cs.itemMidCd||"",EQT_CL_CD:cs.EQT_CL_CD||cs.eqtClCd||"",MAC_ADDRESS:cs.MAC_ADDRESS||cs.macAddress||"",SVC_CMPS_ID:cs.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:cs.BASIC_PROD_CMPS_ID||"",PROD_CD:cs.PROD_CD||"",SVC_CD:cs.SVC_CD||"",WRK_ID:cs.WRK_ID||t.id,CUST_ID:cs.CUST_ID||((Os=t.customer)==null?void 0:Os.id),CTRT_ID:cs.CTRT_ID||t.CTRT_ID,WRK_CD:cs.WRK_CD||t.WRK_CD,REG_UID:Qe,...nt}})},Ut={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Ps=t.customer)==null?void 0:Ps.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||_t.crrId||"01",WRKR_ID:Qe,WRKR_CMPL_DT:Xt,MEMO:O||" ",STTL_YN:"Y",REG_UID:Qe,CUST_REL:K,CNFM_CUST_NM:A,CNFM_CUST_TELNO:te,REQ_CUST_TEL_NO:te,INSTL_LOC:"",UP_CTRL_CL:"",PSN_USE_CORP:"",VOIP_USE_CORP:"",DTV_USE_CORP:"",WRK_ACT_CL:"20",NET_CL:(T==null?void 0:T.NET_CL)||"",WRNG_TP:(T==null?void 0:T.WRNG_TP)||"",INSTL_TP:(T==null?void 0:T.INSTL_TP)||"77",CB_WRNG_TP:(T==null?void 0:T.CB_WRNG_TP)||"",CB_INSTL_TP:(T==null?void 0:T.CB_INSTL_TP)||"",INOUT_LINE_TP:(T==null?void 0:T.INOUT_LINE_TP)||"",INOUT_LEN:(T==null?void 0:T.INOUT_LEN)||"",DVDR_YN:(T==null?void 0:T.DVDR_YN)||"",BFR_LINE_YN:(T==null?void 0:T.BFR_LINE_YN)||"",CUT_YN:(T==null?void 0:T.CUT_YN)||"",TERM_NO:(T==null?void 0:T.TERM_NO)||"",RCV_STS:(T==null?void 0:T.RCV_STS)||"",SUBTAP_ID:(T==null?void 0:T.SUBTAP_ID)||"",PORT_NUM:(T==null?void 0:T.PORT_NUM)||"",EXTN_TP:(T==null?void 0:T.EXTN_TP)||"",TAB_LBL:(T==null?void 0:T.TAB_LBL)||"",CVT_LBL:(T==null?void 0:T.CVT_LBL)||"",STB_LBL:(T==null?void 0:T.STB_LBL)||"",KPI_PROD_GRP:"",OBS_RCPT_CD:"",OBS_RCPT_DTL_CD:"",VOIP_JOIN_CTRT_ID:"",AGREE_YN:"",ISP_YN:"",AGREE_GB:"",CUST_CLEAN_YN:"",EQT_RMV_FLAG:"",TV_TYPE:""},equipmentList:[],removeEquipmentList:ts((L==null?void 0:L.removedEquipments)||[]),spendItemList:(L==null?void 0:L.spendItems)||[],agreementList:(L==null?void 0:L.agreements)||[],poleList:(L==null?void 0:L.poleResults)||[]};w(Ut,{onSuccess:ps=>{ps.code==="SUCCESS"||ps.code==="OK"?(localStorage.removeItem(G()),t.WRK_STAT_CD="3",r==null||r("  .","success"),n()):r==null||r(ps.message||"   .","error",!0)},onError:ps=>{r==null||r(ps.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[P&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:ee||"",readOnly:!0,disabled:!0,placeholder:"  ()",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>V(!0),className:`px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${d?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:d?"":""})]}),!d&&!(T!=null&&T.NET_CL)&&s.jsx("p",{className:"mt-1 text-xs text-red-500",children:"*    ."})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!d&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:K,onValueChange:B,options:ft,placeholder:" ",required:!0,disabled:d})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:O,onChange:Te=>S(Te.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${d?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:d,disabled:d}),!d&&s.jsxs("p",{className:`text-xs text-right mt-1 ${O.length>=500?"text-red-500":"text-gray-400"}`,children:[O.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:ut,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),xe&&!d&&s.jsxs("div",{className:"p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-semibold text-indigo-800",children:""}),At==="success"&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:""}),At==="error"&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-red-100 text-red-700 rounded-full",children:""})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{type:"button",onClick:Ns,disabled:bt,className:"flex-1 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm font-semibold rounded-lg transition-colors flex items-center justify-center gap-1.5",children:[bt?s.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),s.jsx("span",{children:""})]}),s.jsxs("button",{type:"button",onClick:ke,disabled:bt,className:"flex-1 px-3 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white text-sm font-semibold rounded-lg transition-colors flex items-center justify-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),s.jsx("span",{children:""})]})]}),We&&s.jsx("p",{className:`mt-2 text-xs ${At==="error"?"text-red-600":At==="success"?"text-green-600":"text-gray-600"}`,children:We})]}),Tt&&!d&&s.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-orange-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-sm font-medium text-orange-800",children:"LGHV STB .    STB   ."})]})}),s.jsx(Db,{custId:((be=t.customer)==null?void 0:be.id)||t.CUST_ID||"",rcptId:t.RCPT_ID||"",ctrtId:t.CTRT_ID||"",soId:t.SO_ID||"",termDt:t.TERM_DT||"",wrkCd:t.WRK_CD,showToast:r}),st()&&s.jsx(v5,{onComplete:Kt,onAssignAS:ht,showToast:r,disabled:d,savedData:H,onReset:()=>$(null)}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!d&&s.jsx("button",{onClick:It,disabled:P,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${P?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:P?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>Q(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(hc,{isOpen:q,onClose:()=>V(!1),onSave:Ss,workId:t.id,initialData:T,workType:t.WRK_CD,customerId:t.customer.id,customerName:t.customer.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(L==null?void 0:L.kpiProdGrpCd)||(L==null?void 0:L.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(L==null?void 0:L.prodChgGb)||(L==null?void 0:L.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(L==null?void 0:L.chgKpiProdGrpCd)||(L==null?void 0:L.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(L==null?void 0:L.prodGrp)||(L==null?void 0:L.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:d}),s.jsx(Wa,{isOpen:k,onClose:()=>Q(!1),ctrtId:t.CTRT_ID,custId:t.customer.id}),s.jsx(Rb,{isOpen:Re,onClose:()=>X(!1),moveWorkData:_e,order:t}),s.jsx(D5,{isOpen:ie,onClose:()=>fe(!1),onSave:qt,removalLineData:H,custId:((Oe=t.customer)==null?void 0:Oe.id)||"",custNm:((je=t.customer)==null?void 0:je.name)||"",addrOrd:((tt=t.customer)==null?void 0:tt.ADDR_ORD)||"",address:t.address||"",showToast:r}),s.jsx(ul,{isOpen:Ne,onClose:()=>ye(!1),onConfirm:he,title:" ",message:ne,type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{equipmentData:L,installInfoData:T,custRel:K,custRelOptions:ft,memo:O,order:t})})]})},A3=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:l=!1})=>{var se,Ee,Ne;const c=l||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[d,u]=x.useState(!1),{equipmentData:f,filteringData:m}=$i(),{certifyRegconfInfo:_}=Ba(),y=t.id||"",g=oa(y),N={...f||i||m||{},installedEquipments:g.installedEquipments.length>0?g.installedEquipments:(f==null?void 0:f.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:g.markedForRemoval.length>0?g.markedForRemoval:(f==null?void 0:f.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(g.removalStatus).length>0?g.removalStatus:(f==null?void 0:f.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:C,isPending:v}=od(),R=()=>`work_complete_draft_${t.id}`,[U,L]=x.useState(""),[w,P]=x.useState(""),[G,K]=x.useState(((se=t.customer)==null?void 0:se.name)||""),[B,O]=x.useState(((Ee=t.customer)==null?void 0:Ee.phone)||""),[S,A]=x.useState(!1),[Y,te]=x.useState(!1),[J,q]=x.useState(""),[V,F]=x.useState(""),[I,ee]=x.useState(void 0),[ae,T]=x.useState(!1),[j,k]=x.useState(""),Q=t.MVM_TP==="1"&&["1","2"].includes(t.WRK_STAT_CD||"")&&t.CTRT_ID,[H,$]=x.useState([]),[ie,fe]=x.useState(!1),[pe,de]=x.useState([]),[Re,X]=x.useState(()=>{const ye=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(ye&&ye.length>=8)return`${ye.slice(0,4)}-${ye.slice(4,6)}-${ye.slice(6,8)}`;const ne=new Date;return ne.getFullYear()+"-"+String(ne.getMonth()+1).padStart(2,"0")+"-"+String(ne.getDate()).padStart(2,"0")});x.useEffect(()=>{(async()=>{try{console.log("[WorkCompleteRemoval] getWorkReceiptDetail API ");const ne=await ad({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(ne)if(console.log("[WorkCompleteRemoval] API :",ne),c)L(ne.CUST_REL||""),P((ne.WRK_PROC_CT||"").replace(/\\n/g,`
`)),q(ne.NET_CL||""),F(ne.NET_CL_NM||""),ee({NET_CL:ne.NET_CL||"",NET_CL_NM:ne.NET_CL_NM||"",WRNG_TP:ne.WRNG_TP||"",INSTL_TP:ne.INSTL_TP||"",CB_WRNG_TP:ne.CB_WRNG_TP||"",CB_INSTL_TP:ne.CB_INSTL_TP||"",INOUT_LINE_TP:ne.INOUT_LINE_TP||"",INOUT_LEN:ne.INOUT_LEN||"",DVDR_YN:ne.DVDR_YN||"",BFR_LINE_YN:ne.BFR_LINE_YN||"",CUT_YN:ne.CUT_YN||"",TERM_NO:ne.TERM_NO||"",RCV_STS:ne.RCV_STS||"",SUBTAP_ID:ne.SUBTAP_ID||"",PORT_NUM:ne.PORT_NUM||"",EXTN_TP:ne.EXTN_TP||"",TAB_LBL:ne.TAB_LBL||"",CVT_LBL:ne.CVT_LBL||"",STB_LBL:ne.STB_LBL||""}),P((ne.WRK_PROC_CT||"").replace(/\\n/g,`
`)),ne.WRKR_CMPL_DT&&ne.WRKR_CMPL_DT.length>=8&&X(`${ne.WRKR_CMPL_DT.slice(0,4)}-${ne.WRKR_CMPL_DT.slice(4,6)}-${ne.WRKR_CMPL_DT.slice(6,8)}`);else{const ue=localStorage.getItem(R());if(ue)try{const xe=JSON.parse(ue);xe.installInfoData&&xe.installInfoData.NET_CL?(console.log("[WorkCompleteRemoval] localStorage  "),L(xe.custRel||""),P(xe.memo||""),q(xe.networkType||""),F(xe.networkTypeName||""),ee(xe.installInfoData)):(console.log("[WorkCompleteRemoval] API   "),q(ne.NET_CL||""),F(ne.NET_CL_NM||""),ee({NET_CL:ne.NET_CL||"",NET_CL_NM:ne.NET_CL_NM||"",WRNG_TP:ne.WRNG_TP||"",INSTL_TP:ne.INSTL_TP||"",CB_WRNG_TP:ne.CB_WRNG_TP||"",CB_INSTL_TP:ne.CB_INSTL_TP||"",INOUT_LINE_TP:ne.INOUT_LINE_TP||"",INOUT_LEN:ne.INOUT_LEN||"",DVDR_YN:ne.DVDR_YN||"",BFR_LINE_YN:ne.BFR_LINE_YN||"",CUT_YN:ne.CUT_YN||""}),L(xe.custRel||""),P(xe.memo||""))}catch(xe){console.error("[WorkCompleteRemoval] localStorage  :",xe),q(ne.NET_CL||""),F(ne.NET_CL_NM||""),ee({NET_CL:ne.NET_CL||"",NET_CL_NM:ne.NET_CL_NM||"",WRNG_TP:ne.WRNG_TP||"",INSTL_TP:ne.INSTL_TP||"",CB_WRNG_TP:ne.CB_WRNG_TP||"",CB_INSTL_TP:ne.CB_INSTL_TP||"",INOUT_LINE_TP:ne.INOUT_LINE_TP||"",INOUT_LEN:ne.INOUT_LEN||"",DVDR_YN:ne.DVDR_YN||"",BFR_LINE_YN:ne.BFR_LINE_YN||"",CUT_YN:ne.CUT_YN||""})}else console.log("[WorkCompleteRemoval] localStorage  - API   "),q(ne.NET_CL||""),F(ne.NET_CL_NM||""),ee({NET_CL:ne.NET_CL||"",NET_CL_NM:ne.NET_CL_NM||"",WRNG_TP:ne.WRNG_TP||"",INSTL_TP:ne.INSTL_TP||"",CB_WRNG_TP:ne.CB_WRNG_TP||"",CB_INSTL_TP:ne.CB_INSTL_TP||"",INOUT_LINE_TP:ne.INOUT_LINE_TP||"",INOUT_LEN:ne.INOUT_LEN||"",DVDR_YN:ne.DVDR_YN||"",BFR_LINE_YN:ne.BFR_LINE_YN||"",CUT_YN:ne.CUT_YN||""})}else{console.log("[WorkCompleteRemoval] API   - localStorage  ");const ue=localStorage.getItem(R());if(ue)try{const xe=JSON.parse(ue);L(xe.custRel||""),P(xe.memo||""),q(xe.networkType||""),F(xe.networkTypeName||""),ee(xe.installInfoData)}catch(xe){console.error("[WorkCompleteRemoval] localStorage  :",xe)}}}catch(ne){console.error("[WorkCompleteRemoval] API  :",ne);const ue=localStorage.getItem(R());if(ue)try{const xe=JSON.parse(ue);L(xe.custRel||""),P(xe.memo||""),q(xe.networkType||""),F(xe.networkTypeName||""),ee(xe.installInfoData)}catch(xe){console.error("[WorkCompleteRemoval] localStorage  :",xe)}}finally{u(!0)}})()},[t.id,c]),x.useEffect(()=>{if(!d||c)return;const ye={custRel:U,memo:w,networkType:J,networkTypeName:V,installInfoData:I,savedAt:new Date().toISOString()};localStorage.setItem(R(),JSON.stringify(ye))},[U,w,J,V,I,d,c]),x.useEffect(()=>{(async()=>{try{const ne=await Jl(["CMCU005"]);ne.CMCU005&&$(ne.CMCU005.map(ue=>({value:ue.COMMON_CD,label:ue.COMMON_CD_NM})))}catch(ne){console.error("[WorkCompleteRemoval]    :",ne)}})()},[]),x.useEffect(()=>{(async()=>{try{const ne=await mc(),ue=(ne==null?void 0:ne.output)||ne||[];de(ue);const xe=t.PROD_CD||t.PROD_CD||"",et=ue.some(bt=>bt.PROD_CD===xe);fe(et),console.log("[CompleteRemoval] LGHV :",{currentProdCd:xe,isLghv:et,prodListCount:ue.length})}catch(ne){console.error("[CompleteRemoval] LGHV   :",ne)}})()},[t.PROD_CD]);const _e=()=>{const ye=[];(!G||G.trim()==="")&&ye.push(" ."),(!B||B.trim()==="")&&ye.push(" ."),(!U||U==="[]")&&ye.push("  ."),I!=null&&I.NET_CL||ye.push("  ."),I!=null&&I.WRNG_TP||ye.push("  ."),I!=null&&I.INSTL_TP||ye.push("  ."),Re||ye.push(" .");const ne=t.PROD_GRP||"",ue=(N==null?void 0:N.removedEquipments)||[];return ne!=="V"&&ue.length<1&&ye.push("  .   ."),ye},me=ye=>{ee(ye),ye.NET_CL&&q(ye.NET_CL),ye.NET_CL_NM&&F(ye.NET_CL_NM),r==null||r("  .","success")},Z=()=>{var bt,it;if(v)return;if(((N==null?void 0:N.removedEquipments)||[]).some(At=>{var at;return At.PROD_CMPS_CL==="23"||((at=At.actualEquipment)==null?void 0:at.PROD_CMPS_CL)==="23"})){r==null||r("      .  .","error");return}const ue=_e();if(ue.length>0){ue.forEach(At=>r==null?void 0:r(At,"error"));return}const xe=t.TERM_HOPE_DT||t.HOPE_DT||"";if(xe&&Re){const At=xe.replace(/-/g,"");Re.replace(/-/g,"")<At&&(r==null||r("  .","warning"))}const et=((bt=N==null?void 0:N.removedEquipments)==null?void 0:bt.length)>0||((it=N==null?void 0:N.installedEquipments)==null?void 0:it.length)>0?` ?
(      .)`:" ?";k(et),T(!0)},le=async()=>{var Tt,St,ze,dt,Ke,rt,ft,Ot;console.log("[WorkCompleteRemoval]   ");const ye=Re.replace(/-/g,""),ne=localStorage.getItem("userInfo"),ue=ne?JSON.parse(ne):{},xe=ue.userId||"A20130708",et=t.WRK_DTL_TCD||"";if(et==="0910"||et==="0920"){const mt=et==="0910"?"SMR06":"SMR08";try{const Ze=t.PROD_GRP||"",De=t.VOIP_PROD_CD||"",Ye=Ze==="V"&&De&&t.CTRT_ID||"";let Ce=t.PROD_CD||"",ge="";try{const ce=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"09"}),Le=ce.find(Ct=>Ct.PROD_CMPS_CL==="11");Le&&(Ce=Le.PROD_CD||Ce);const Xe=et==="0910"?"10":"80",Pe=ce.filter(Ct=>Ct.BASIC_PROD_FL==="V"&&Ct.PROD_STAT_CD===Xe).map(Ct=>Ct.PROD_CD);Pe.length>0&&(ge=Pe.join(","))}catch(ce){console.log("[CompleteRemoval] getProdPromotionInfo for buga signal failed:",ce)}console.log(`[CompleteRemoval]  (${mt}) :`,{wrkDtlTcd:et,bugaProdCd:Ce,subProdCd:ge,voipJoinCtrtId:Ye});const Be=await la({MSG_ID:mt,CUST_ID:((Tt=t.customer)==null?void 0:Tt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:"",PROD_CD:Ce,WRK_ID:t.id||"",REG_UID:xe,SUB_PROD_CD:ge,VOIP_JOIN_CTRT_ID:Ye,WTIME:"99"});Be.code!=="SUCCESS"&&Be.code!=="OK"?console.log(`[CompleteRemoval]  (${mt})   ():`,Be.message):console.log(`[CompleteRemoval]  (${mt})  `)}catch(Ze){console.log("[CompleteRemoval]      (  ):",Ze)}}const bt=(N==null?void 0:N.removedEquipments)||[];let it=!1,At=!1;if(bt.length>0){for(const mt of bt){const Ze=mt.actualEquipment||mt,De=Ze.eqtClCd||Ze.EQT_CL_CD||"";De==="090901"||De==="091001"||De==="091005"||(it=!0)}if(it)try{const mt=bt[0],Ze=mt.actualEquipment||mt,De=Ze.PROD_CMPS_ID||mt.PROD_CMPS_ID||Ze.EQT_PROD_CMPS_ID||mt.EQT_PROD_CMPS_ID||"",Ye=t.PROD_GRP||"",Ce=t.VOIP_PROD_CD||"",ge=Ye==="V"&&Ce&&t.CTRT_ID||"";console.log("[CompleteRemoval]  (SMR05) :",{eqtProdCmpsId:De,voipJoinCtrtId:ge});const Be=await la({MSG_ID:"SMR05",CUST_ID:((St=t.customer)==null?void 0:St.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:De,PROD_CD:"",WRK_ID:t.id||"",REG_UID:xe,VOIP_JOIN_CTRT_ID:ge,WTIME:"3"});if(Be.code!=="SUCCESS"&&Be.code!=="OK"){if((((ze=Be.O_IFSVC_RESULT)==null?void 0:ze.substring(14,20))||"")!=="029"&&((dt=Be.message)==null?void 0:dt.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteRemoval]    -  :",Be.message),r==null||r("   .","error",!0);return}}else console.log("[CompleteRemoval]  (SMR05)  ");At=!0}catch(mt){console.error("[CompleteRemoval]     :",mt),r==null||r("   .","error",!0);return}}if(!it){const mt=(N==null?void 0:N.customerEquipments)||[],Ze=(N==null?void 0:N.installedEquipments)||[],De=!!t.ISP_PROD_CD;if(mt.length>0||Ze.length>0||De)try{const Ye=t.PROD_GRP||"",Ce=t.VOIP_PROD_CD||"",ge=Ye==="V"&&Ce&&t.CTRT_ID||"";console.log("[CompleteRemoval]  (SMR05) fallback - del_signal_flag=false, eqt/ISP exists");const Be=await la({MSG_ID:"SMR05",CUST_ID:((Ke=t.customer)==null?void 0:Ke.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:"",PROD_CD:"",WRK_ID:t.id||"",REG_UID:xe,VOIP_JOIN_CTRT_ID:ge,WTIME:"3"});if(Be.code!=="SUCCESS"&&Be.code!=="OK"){if((((rt=Be.O_IFSVC_RESULT)==null?void 0:rt.substring(14,20))||"")!=="029"&&((ft=Be.message)==null?void 0:ft.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteRemoval]   fallback  -  :",Be.message),r==null||r("   .","error",!0);return}}else console.log("[CompleteRemoval]  (SMR05) fallback ");At=!0}catch(Ye){console.error("[CompleteRemoval]   fallback :",Ye),r==null||r("   .","error",!0);return}}const at=(mt,Ze=!1)=>{if(!mt||mt.length===0)return[];const De=(N==null?void 0:N.removalStatus)||{},Ye=(Ce,ge)=>Ce==="1"||Ce==="Y"||ge==="1"||ge==="Y"?"1":"0";return mt.map(Ce=>{var Le,Xe,Pe,Ct;const ge=Ce.EQT_NO||Ce.id||((Le=Ce.actualEquipment)==null?void 0:Le.id)||"",Be=De[ge]||De[Ce.id]||De[Ce.EQT_NO]||De[(Xe=Ce.actualEquipment)==null?void 0:Xe.id]||De[Ce.serialNumber]||{},ce=Ze?{CRR_TSK_CL:t.WRK_CD||"09",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||ue.crrId||"01",WRKR_ID:xe,EQT_LOSS_YN:Ye(Ce.EQT_LOSS_YN,Be.EQT_LOSS_YN),PART_LOSS_BRK_YN:Ye(Ce.PART_LOSS_BRK_YN,Be.PART_LOSS_BRK_YN),EQT_BRK_YN:Ye(Ce.EQT_BRK_YN,Be.EQT_BRK_YN),EQT_CABL_LOSS_YN:Ye(Ce.EQT_CABL_LOSS_YN,Be.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Ye(Ce.EQT_CRDL_LOSS_YN,Be.EQT_CRDL_LOSS_YN),REUSE_YN:Ce.REUSE_YN==="1"||Be.REUSE_YN==="1"?"1":"0"}:{};if(Ce.actualEquipment){const Me=Ce.actualEquipment,lt=Ce.contractEquipment||{};return{...Me,EQT_NO:Me.id,EQT_SERNO:Me.serialNumber,ITEM_MID_CD:Me.itemMidCd,EQT_CL_CD:Me.eqtClCd,MAC_ADDRESS:Ce.macAddress||Me.macAddress,WRK_ID:t.id,CUST_ID:(Pe=t.customer)==null?void 0:Pe.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:lt.id||lt.SVC_CMPS_ID||Me.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Me.BASIC_PROD_CMPS_ID||lt.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:Me.EQT_PROD_CMPS_ID||lt.id,PROD_CD:Me.PROD_CD||lt.PROD_CD||t.PROD_CD||"",SVC_CD:Me.SVC_CD||lt.SVC_CD||"",EQT_SALE_AMT:Me.EQT_SALE_AMT||"0",MST_SO_ID:Me.MST_SO_ID||t.SO_ID||"",SO_ID:Me.SO_ID||t.SO_ID||"",REG_UID:xe,OLD_LENT_YN:Me.OLD_LENT_YN||"N",LENT:Me.LENT||"10",ITLLMT_PRD:Me.ITLLMT_PRD||"00",EQT_USE_STAT_CD:Me.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:Me.IF_DTL_ID||"",...ce}}return{...Ce,EQT_NO:Ce.EQT_NO||Ce.id||"",EQT_SERNO:Ce.EQT_SERNO||Ce.serialNumber||"",ITEM_MID_CD:Ce.ITEM_MID_CD||Ce.itemMidCd||"",EQT_CL_CD:Ce.EQT_CL_CD||Ce.eqtClCd||"",MAC_ADDRESS:Ce.MAC_ADDRESS||Ce.macAddress||"",SVC_CMPS_ID:Ce.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Ce.BASIC_PROD_CMPS_ID||"",PROD_CD:Ce.PROD_CD||"",SVC_CD:Ce.SVC_CD||"",WRK_ID:Ce.WRK_ID||t.id,CUST_ID:Ce.CUST_ID||((Ct=t.customer)==null?void 0:Ct.id),CTRT_ID:Ce.CTRT_ID||t.CTRT_ID,WRK_CD:Ce.WRK_CD||t.WRK_CD,REG_UID:xe,...ce}})},We={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Ot=t.customer)==null?void 0:Ot.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||ue.crrId||"01",WRKR_ID:xe,WRKR_CMPL_DT:ye,MEMO:w||" ",STTL_YN:"Y",REG_UID:xe,CUST_REL:U,CNFM_CUST_NM:G,CNFM_CUST_TELNO:B,REUSE_YN:S?"Y":"N",INSTL_LOC:t.INSTL_LOC||t.installLocation||"",UP_CTRL_CL:"",PSN_USE_CORP:"",VOIP_USE_CORP:"",DTV_USE_CORP:"",WRK_ACT_CL:"20",NET_CL:(I==null?void 0:I.NET_CL)||"",WRNG_TP:(I==null?void 0:I.WRNG_TP)||"",INSTL_TP:(I==null?void 0:I.INSTL_TP)||"",CB_WRNG_TP:(I==null?void 0:I.CB_WRNG_TP)||"",CB_INSTL_TP:(I==null?void 0:I.CB_INSTL_TP)||"",INOUT_LINE_TP:(I==null?void 0:I.INOUT_LINE_TP)||"",INOUT_LEN:(I==null?void 0:I.INOUT_LEN)||"",DVDR_YN:(I==null?void 0:I.DVDR_YN)||"",BFR_LINE_YN:(I==null?void 0:I.BFR_LINE_YN)||"",CUT_YN:(I==null?void 0:I.CUT_YN)||"",TERM_NO:(I==null?void 0:I.TERM_NO)||"",RCV_STS:(I==null?void 0:I.RCV_STS)||"",SUBTAP_ID:(I==null?void 0:I.SUBTAP_ID)||"",PORT_NUM:(I==null?void 0:I.PORT_NUM)||"",EXTN_TP:(I==null?void 0:I.EXTN_TP)||"",TAB_LBL:(I==null?void 0:I.TAB_LBL)||"",CVT_LBL:(I==null?void 0:I.CVT_LBL)||"",STB_LBL:(I==null?void 0:I.STB_LBL)||"",KPI_PROD_GRP:"",OBS_RCPT_CD:"",OBS_RCPT_DTL_CD:"",VOIP_JOIN_CTRT_ID:"",AGREE_YN:"",ISP_YN:"",AGREE_GB:"",CUST_CLEAN_YN:"",EQT_RMV_FLAG:"",TV_TYPE:""},equipmentList:at((N==null?void 0:N.installedEquipments)||[],!1),removeEquipmentList:at((N==null?void 0:N.removedEquipments)||[],!0),spendItemList:(N==null?void 0:N.spendItems)||[],agreementList:(N==null?void 0:N.agreements)||[],poleList:(N==null?void 0:N.poleResults)||[]},Dt=async()=>{var mt;try{const Ze=(N==null?void 0:N.customerEquipments)||[],De=(N==null?void 0:N.installedEquipments)||[],Ye=[...Ze,...De],Ce=["090901","091001","091005"];let ge=!1;for(const ke of Ye){const ct=ke.actualEquipment||ke,st=ct.eqtClCd||ct.EQT_CL_CD||"";if(Ce.includes(st))continue;(ct.EQT_KND||ct.eqtKnd||"WRKER")==="WRKER"&&(ge=!0)}if(!ge&&At&&(ge=!0),!ge){console.log("[CompleteRemoval] SMR03 skip - no WRKER equipment and no SMR05 sent");return}const Be=t.PROD_GRP||"",ce=t.VOIP_PROD_CD||"";let Le=Be==="V"?"SMR60":"SMR03";ie&&Be!=="V"&&(Le="STB_CHG");let Xe=[];try{Xe=await dl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"09"})}catch(ke){console.log("[CompleteRemoval] getProdPromotionInfo failed:",ke)}const Pe=Xe.find(ke=>ke.PROD_CMPS_CL==="23"),Ct=(Pe==null?void 0:Pe.PROD_CMPS_ID)||"",Me=Xe.find(ke=>ke.PROD_CMPS_CL==="11"),lt=(Me==null?void 0:Me.PROD_CD)||"",ut=(Me==null?void 0:Me.PROD_GRP)||Be,jt=Xe.filter(ke=>ke.BASIC_PROD_FL==="V").map(ke=>ke.PROD_CD),Ve=jt.length>0?jt.join(","):"",$t=ke=>{var st,Kt;const ct=Ye.find(ht=>{var qt,It;return(ht.ITEM_MID_CD||ht.itemMidCd||((qt=ht.actualEquipment)==null?void 0:qt.ITEM_MID_CD)||((It=ht.actualEquipment)==null?void 0:It.itemMidCd))===ke});return(ct==null?void 0:ct.EQT_NO)||(ct==null?void 0:ct.id)||((st=ct==null?void 0:ct.actualEquipment)==null?void 0:st.EQT_NO)||((Kt=ct==null?void 0:ct.actualEquipment)==null?void 0:Kt.id)||""};let Ue="";ce?Ue=$t("08"):Ue=$t("05")||$t("01")||$t("03")||(ut==="I"?$t("02"):"")||$t("08")||"";let ss="";ce?ss=$t("02"):ss=$t("04");const ls=$t("07"),ds=ut==="C"?$t("02"):"";let Ss="";$t("10")&&ut==="V"&&(Ss=$t("10")),t.ISP_PROD_CD&&(Ss=$t("21"));let Ns="";Be==="V"&&ce&&(Ns=t.CTRT_ID||""),console.log("[CompleteRemoval] SMR03 installation signal:",{msgId:Le,eqtNo:Ue,eqtProdCmpsId:Ct}),await la({MSG_ID:Le,CUST_ID:((mt=t.customer)==null?void 0:mt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ue,EQT_PROD_CMPS_ID:Ct,PROD_CD:lt,WRK_ID:t.id||"",REG_UID:xe,ETC_1:ss,ETC_2:ls,ETC_3:ds,ETC_4:Ss,SUB_PROD_CD:Ve,VOIP_JOIN_CTRT_ID:Ns,WTIME:"3"}),console.log("[CompleteRemoval] SMR03 installation signal sent")}catch(Ze){console.warn("[CompleteRemoval] SMR03 installation signal error (ignored):",Ze)}};C(We,{onSuccess:mt=>{mt.code==="SUCCESS"||mt.code==="OK"?(localStorage.removeItem(R()),t.WRK_STAT_CD="3",Dt(),r==null||r("  .","success"),n()):r==null||r(mt.message||"   .","error",!0)},onError:mt=>{r==null||r(mt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[v&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:V||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>te(!0),className:`px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${c?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:G,onChange:ye=>K(ye.target.value),placeholder:" ",className:`w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,readOnly:c,disabled:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"tel",value:B,onChange:ye=>O(ye.target.value),placeholder:" ",className:`w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,readOnly:c,disabled:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:U,onValueChange:L,options:H,placeholder:" ",required:!0,disabled:c})]}),Q&&!c&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("input",{type:"checkbox",id:"reuseYn",checked:S,onChange:ye=>A(ye.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"reuseYn",className:"text-sm font-medium text-gray-700",children:" (    )"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:w,onChange:ye=>P(ye.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:c,disabled:c}),!c&&s.jsxs("p",{className:`text-xs text-right mt-1 ${w.length>=500?"text-red-500":"text-gray-400"}`,children:[w.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Re,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsx(Db,{custId:((Ne=t.customer)==null?void 0:Ne.id)||t.CUST_ID||"",rcptId:t.RCPT_ID||"",ctrtId:t.CTRT_ID||"",soId:t.SO_ID||"",termDt:t.TERM_DT||"",wrkCd:t.WRK_CD,showToast:r}),!c&&s.jsx("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:s.jsx("button",{onClick:Z,disabled:v,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${v?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:v?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})})})]})})}),s.jsx(hc,{isOpen:Y,onClose:()=>te(!1),onSave:me,workId:t.id,initialData:I,workType:t.WRK_CD,customerId:t.customer.id,customerName:t.customer.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(N==null?void 0:N.kpiProdGrpCd)||(N==null?void 0:N.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(N==null?void 0:N.prodChgGb)||(N==null?void 0:N.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(N==null?void 0:N.chgKpiProdGrpCd)||(N==null?void 0:N.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(N==null?void 0:N.prodGrp)||(N==null?void 0:N.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:c}),s.jsx(ul,{isOpen:ae,onClose:()=>T(!1),onConfirm:le,title:" ",message:j,type:"confirm",confirmText:"",cancelText:"",children:s.jsx(ld,{equipmentData:N,installInfoData:I,custRel:U,custRelOptions:H,memo:w,order:t})})]})},k3=t=>{const{order:e}=t,[n,r]=x.useState(""),[i,l]=x.useState(!1);if(x.useEffect(()=>{(async()=>{try{const f=e.DTL_CTRT_ID||e.CTRT_ID||"";if(f){console.log("[CompleteLGUInstall] LDAP subscription check:",f,"(DTL_CTRT_ID:",e.DTL_CTRT_ID,", CTRT_ID:",e.CTRT_ID,")");const m=await Cb(f),_=m.exists?"":"";r(_),console.log("[CompleteLGUInstall] LDAP result:",{exists:m.exists,reason:_})}}catch(f){console.log("[CompleteLGUInstall] LDAP check failed, using default:",f),r("")}l(!0)})()},[e.CTRT_ID]),!i)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-sm text-gray-500",children:"LGU+    ..."})]})});const c={certifyMode:!0,certifyReason:n};switch(e.WRK_CD){case"06":return s.jsx(j5,{...t,...c});case"07":return s.jsx(I5,{...t,...c});default:return s.jsx(Ry,{...t,...c})}},U3=t=>{const{order:e}=t,n={certifyMode:!0};return e.WRK_CD==="08"?s.jsx(O5,{...t,...n}):s.jsx(R5,{...t,...n})},B3=t=>s.jsx(T5,{...t,certifyMode:!0}),W3=t=>s.jsx(E5,{...t,certifyMode:!0}),j_=t=>{const{order:e,isCertifyProd:n}=t,r=e.WRK_CD;if(n)switch(r){case"01":case"06":case"07":return s.jsx(k3,{...t});case"02":case"08":return s.jsx(U3,{...t});case"03":return s.jsx(B3,{...t});case"05":return s.jsx(W3,{...t})}switch(r){case"01":return s.jsx(Ry,{...t});case"02":return s.jsx(R5,{...t});case"03":return s.jsx(T5,{...t});case"04":return s.jsx(P3,{...t});case"05":return s.jsx(E5,{...t});case"06":return s.jsx(j5,{...t});case"07":return s.jsx(I5,{...t});case"08":return s.jsx(O5,{...t});case"09":return s.jsx(A3,{...t});default:return console.warn(`[WorkCompleteRouter] Unknown WRK_CD: ${r}, using default form`),s.jsx(Ry,{...t})}},F3=t=>({"01":"","02":"","03":"A/S","04":"","05":"","06":"","07":"","08":"","09":""})[t]||"",K3=()=>Yc().startOf("month").format("YYYY-MM-DD"),Q3=()=>Yc().endOf("month").format("YYYY-MM-DD"),Yl=rx()(ix(t=>({isDrawerOpen:!1,activeTab:"work-receipt",currentView:"today-work",workFilters:{startDate:K3(),endDate:Q3(),filter:"",workTypeFilter:""},selectedWorkItem:null,selectedWorkDirection:null,fontScale:"medium",preferredNavApp:"kakao",showMapView:!1,openDrawer:()=>t({isDrawerOpen:!0}),closeDrawer:()=>t({isDrawerOpen:!1}),setActiveTab:e=>t({activeTab:e}),setCurrentView:e=>t({currentView:e,showMapView:!1}),setShowMapView:e=>t({showMapView:e}),setWorkFilters:e=>t({workFilters:e}),setSelectedWorkItem:e=>t({selectedWorkItem:e}),setSelectedWorkDirection:e=>t({selectedWorkDirection:e}),setFontScale:e=>t({fontScale:e}),setPreferredNavApp:e=>t({preferredNavApp:e})}),{name:"dlive-ui-storage",partialize:t=>({activeTab:t.activeTab,currentView:t.currentView,fontScale:t.fontScale,preferredNavApp:t.preferredNavApp,workFilters:{workTypeFilter:t.workFilters.workTypeFilter}}),merge:(t,e)=>{var u;const n=["","","",""],r=(u=t==null?void 0:t.workFilters)==null?void 0:u.workTypeFilter,i=["small","medium","large","xlarge"],l=t==null?void 0:t.fontScale,c=["kakao","tmap","naver"],d=t==null?void 0:t.preferredNavApp;return{...e,activeTab:(t==null?void 0:t.activeTab)??e.activeTab,currentView:(t==null?void 0:t.currentView)??e.currentView,fontScale:l&&i.includes(l)?l:"medium",preferredNavApp:d&&c.includes(d)?d:"kakao",workFilters:{...e.workFilters,workTypeFilter:r&&n.includes(r)?r:""}}}})),Tb=()=>/iPhone|iPad|iPod/i.test(navigator.userAgent),G3=({lat:t,lng:e,name:n})=>{const r=`kakaomap://route?ep=${t},${e}&by=car`,i=`https://map.kakao.com/link/to/${encodeURIComponent(n)},${t},${e}`;Eb(r,i)},Y3=({lat:t,lng:e,name:n})=>{const r=`tmap://route?goaly=${t}&goalx=${e}&goalname=${encodeURIComponent(n)}`,i=Tb()?"https://apps.apple.com/kr/app/tmap/id431589174":"market://details?id=com.skt.tmap.ku";Eb(r,i)},V3=({lat:t,lng:e,name:n})=>{const r=`nmap://navigation?dlat=${t}&dlng=${e}&dname=${encodeURIComponent(n)}&appname=com.dlive.cona`,i=Tb()?"https://apps.apple.com/kr/app/naver-map/id311867728":"market://details?id=com.nhn.android.nmap";Eb(r,i)};function Eb(t,e){const n=/Android/i.test(navigator.userAgent);if(Tb()||n){if(n&&t.startsWith("kakaomap://")){window.location.href=`intent://route?ep=${t.split("ep=")[1]}#Intent;scheme=kakaomap;package=net.daum.android.map;S.browser_fallback_url=${encodeURIComponent(e)};end`;return}if(n&&t.startsWith("tmap://")){window.location.href=`intent://${t.replace("tmap://","")}#Intent;scheme=tmap;package=com.skt.tmap.ku;S.browser_fallback_url=${encodeURIComponent(e)};end`;return}if(n&&t.startsWith("nmap://")){window.location.href=`intent://${t.replace("nmap://","")}#Intent;scheme=nmap;package=com.nhn.android.nmap;S.browser_fallback_url=${encodeURIComponent(e)};end`;return}window.location.href=t,setTimeout(()=>{document.hidden||(window.location.href=e)},2e3)}else window.open(e,"_blank")}const M5=(t,e)=>{switch(t){case"kakao":G3(e);break;case"tmap":Y3(e);break;case"naver":V3(e);break}};let N0=null;async function jb(){if(N0)return N0;try{const e=await(await fetch("/api/common/getCommonCodeList",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({CODE_IDS:"MOMP001"})})).json(),n=Array.isArray(e)?e:e.MOMP001||e.data||[],r=n.filter(l=>l.REF_CODE==="KAKAO"&&l.COMMON_CD_NM).map(l=>l.COMMON_CD_NM),i=n.filter(l=>(l.REF_CODE==="VWORLD"||l.REF_CODE==="NGII")&&l.COMMON_CD_NM).map(l=>l.COMMON_CD_NM);return N0={kakao:r,vworld:i},console.log(`[MapKeys] MOMP001   - :${r.length}, :${i.length}`),N0}catch(t){return console.error("[MapKeys] MOMP001  :",t),N0={kakao:[],vworld:[]},N0}}function I_(t){return t.length===0?"":t[Math.floor(Math.random()*t.length)]}function $3(){return new Promise(t=>{var r,i,l;if((i=(r=window.kakao)==null?void 0:r.maps)!=null&&i.services){t(!0);return}if((l=window.kakao)!=null&&l.maps){window.kakao.maps.load(()=>t(!!window.kakao.maps.services));return}let e=0;const n=setInterval(async()=>{var c;if(e++,(c=window.kakao)!=null&&c.maps){if(clearInterval(n),window.kakao.maps.services){t(!0);return}window.kakao.maps.load(()=>t(!!window.kakao.maps.services))}else if(e>25){clearInterval(n);const d=await jb(),u=I_(d.kakao);if(!u){t(!1);return}const f=document.createElement("script");f.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=${u}&libraries=services&autoload=false`,f.onload=()=>{var m;(m=window.kakao)!=null&&m.maps?window.kakao.maps.load(()=>t(!!window.kakao.maps.services)):t(!1)},f.onerror=()=>t(!1),document.head.appendChild(f)}},200)})}function H3(t){return new Promise(e=>{var i;const n=window.kakao;if(!((i=n==null?void 0:n.maps)!=null&&i.services)){e(null);return}const r=new n.maps.services.Geocoder;r.addressSearch(t,(l,c)=>{if(c===n.maps.services.Status.OK&&l[0])e({lat:parseFloat(l[0].y),lng:parseFloat(l[0].x)});else{const d=t.replace(/\(.*?\)/g,"").replace(/\d+[]/g,"").replace(/\s{2,}/g," ").trim();d!==t?r.addressSearch(d,(u,f)=>{f===n.maps.services.Status.OK&&u[0]?e({lat:parseFloat(u[0].y),lng:parseFloat(u[0].x)}):e(null)}):e(null)}})})}async function z3(t,e){if(!await $3())return!1;const r=await H3(t);return r?(M5(e,{lat:r.lat,lng:r.lng,name:t}),!0):!1}const q3=t=>t===""||t===""?"bg-blue-50 text-blue-700":t===""?"bg-green-50 text-green-700":t===""?"bg-red-50 text-red-700":"bg-gray-50 text-gray-700",X3=t=>{switch(t){case"D":return"bg-purple-100 text-purple-700 border-purple-200";case"I":return"bg-blue-100 text-blue-700 border-blue-200";case"V":return"bg-green-100 text-green-700 border-green-200";case"C":return"bg-orange-100 text-orange-700 border-orange-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},J3=({item:t,onSelect:e,onComplete:n,onCancel:r,index:i})=>{const[l,c]=x.useState(!1),d=Yl(N=>N.preferredNavApp),u=t.WRK_STAT_CD_NM||t.status||"",f=u===""||u===""||u===hn.Pending,m=t.ADDR||t.address||"",_=t.PROD_GRP||t.KPI_PROD_GRP_CD,y=async N=>{if(N.stopPropagation(),!(!m||l)){c(!0);try{await z3(m,d)||alert("   .")}catch{alert("  .")}finally{c(!1)}}},g=(N,C)=>{N.stopPropagation(),C==="complete"?n(t):C==="cancel"&&r(t)};return s.jsx("div",{onClick:()=>e(t),className:`bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow-md overflow-hidden cursor-pointer transition-all duration-200 active:scale-[0.98] ${f?"":"opacity-60"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i!==void 0&&s.jsx("div",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500 text-white text-xs font-bold",children:i}),s.jsx("span",{className:`flex-shrink-0 px-2 py-1 text-xs font-semibold rounded-md ${q3(u)} whitespace-nowrap`,children:u})]}),s.jsxs("div",{className:"space-y-2 mb-2",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[_&&s.jsx("span",{className:`px-1.5 py-0.5 text-[0.625rem] font-bold rounded border ${X3(_)}`,children:_}),s.jsx("span",{className:"text-xs font-medium text-gray-900 truncate",children:t.WRK_DTL_TCD_NM||t.WRK_CD_NM||t.typeDisplay||"-"})]})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2 border-t border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs font-medium text-gray-900 truncate",children:t.PROD_NM||"-"})]})]}),f&&s.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-gray-100",children:[s.jsx("button",{onClick:N=>g(N,"complete"),className:"flex-1 py-2 rounded-md bg-blue-500 hover:bg-blue-600 text-white text-xs font-semibold transition-colors",children:""}),s.jsx("button",{onClick:N=>g(N,"cancel"),className:"flex-1 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs font-semibold transition-colors",children:""}),s.jsx("button",{onClick:y,disabled:!m||l,className:`flex-shrink-0 w-10 py-2 rounded-md flex items-center justify-center transition-colors ${m?"bg-orange-500 hover:bg-orange-600 text-white shadow-sm shadow-orange-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,title:"",children:l?s.jsx(jn,{className:"w-4 h-4 animate-spin"}):s.jsx(rd,{className:"w-5 h-5",fill:"currentColor"})})]})]})})},z0=({size:t="medium",color:e="cyan",message:n,fullScreen:r=!1,className:i=""})=>{const l={small:"h-4 w-4 border-2",medium:"h-8 w-8 border-2",large:"h-12 w-12 border-3"},c={blue:"border-blue-500 border-t-transparent",cyan:"border-cyan-500 border-t-transparent",gray:"border-gray-500 border-t-transparent",white:"border-white border-t-transparent"},d={small:"text-xs",medium:"text-sm",large:"text-base"},u=s.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 sm:gap-3",children:[s.jsx("div",{className:`
          ${l[t]}
          ${c[e]}
          rounded-full animate-spin
        `}),n&&s.jsx("p",{className:`${d[t]} text-gray-600 text-center`,children:n})]});return r?s.jsx("div",{className:`fixed inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-50 ${i}`,children:u}):s.jsx("div",{className:`flex items-center justify-center p-8 ${i}`,children:u})},Ib=({type:t="error",message:e,onRetry:n,onClose:r,className:i=""})=>{const c={error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",iconBg:"bg-red-100",iconColor:"text-red-500",buttonBg:"bg-red-500 hover:bg-red-600"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",iconBg:"bg-yellow-100",iconColor:"text-yellow-500",buttonBg:"bg-yellow-500 hover:bg-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",iconBg:"bg-blue-100",iconColor:"text-blue-500",buttonBg:"bg-blue-500 hover:bg-blue-600"}}[t],d=()=>{switch(t){case"error":return s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"info":return s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};return s.jsx("div",{className:`
        ${c.bg}
        ${c.border}
        border rounded-lg p-4
        ${i}
      `,children:s.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[s.jsx("div",{className:`${c.iconBg} ${c.iconColor} rounded-full p-2 flex-shrink-0`,children:d()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:`${c.text} text-sm font-medium`,children:e}),n&&s.jsxs("button",{onClick:n,className:`
                mt-3
                ${c.buttonBg}
                text-white
                px-4 py-2
                rounded-lg
                text-sm
                font-medium
                transition-colors
                duration-200
                flex
                items-center
                gap-2
              `,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})," "]})]}),r&&s.jsx("button",{onClick:r,className:`${c.text} hover:opacity-70 transition-opacity flex-shrink-0`,"aria-label":"",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},L5=({direction:t,onBack:e,onNavigateToView:n,userId:r,showToast:i})=>{var O;const[l,c]=x.useState([]),[d,u]=x.useState(null),[f,m]=x.useState(null),[_,y]=x.useState(!1),[g,N]=x.useState(null),[C,v]=x.useState(!1),[R,U]=x.useState(null),L=$i(S=>S.clearPreviousWorkDraft),w=ji(S=>S.clearAllWorkStates);x.useEffect(()=>{(async()=>{var A;try{v(!0),U(null),console.log("WorkItemList - direction  :",t),console.log("WorkItemList - direction.id:",t.id),console.log("API   - WRK_DRCTN_ID:",t.id);const te=(await vy(t.id)).sort((J,q)=>{const V=ae=>ae===""||ae===""?1:ae===""?2:3,F=V(J.WRK_STAT_CD_NM)-V(q.WRK_STAT_CD_NM);if(F!==0)return F;const I=ae=>{const T=ae.WRK_CD,j=ae.WRK_DTL_TCD;return T==="02"||T==="08"||j==="0430"},ee=ae=>{const T=ae.PROD_GRP||"";if(I(ae)){if(T==="I")return 1;if(T==="D")return 2;if(T==="V")return 3}else{if(T==="V")return 1;if(T==="D")return 2;if(T==="I")return 3}return 4};return ee(J)-ee(q)});if(te.length===0){console.log("[WorkItemList]   -    WorkItem ");const J=t,q=F=>F===""?"4":F===""?"3":"2",V={id:t.id,directionId:t.id,type:t.type,typeDisplay:t.typeDisplay,status:t.status===""?"":t.status===""?"":"",scheduledAt:t.scheduledAt,customer:{...t.customer},details:t.details||"",assignedEquipment:[],WRK_CD:J.WRK_CD,WRK_CD_NM:J.WRK_CD_NM,WRK_DTL_TCD:J.WRK_DTL_TCD,WRK_STAT_CD:J.MIN_WRK_STAT_CD||J.WRK_STAT_CD||q(t.status),WRK_STAT_NM:J.WRK_STAT_NM||t.status,WRK_DRCTN_ID:t.id,CTRT_ID:J.CTRT_ID,PROD_NM:J.PROD_NM,PROD_CD:J.PROD_CD,PROD_GRP:J.PROD_GRP,PROD_GRP_NM:J.PROD_GRP_NM,productName:J.PROD_NM,SO_ID:J.SO_ID,SO_NM:J.SO_NM,MST_SO_ID:J.MST_SO_ID,CRR_ID:J.CRR_ID,CRR_NM:J.CRR_NM,CUST_ID:J.CUST_ID||((A=t.customer)==null?void 0:A.id),VIP_GB:J.VIP_GB||"",OST_WORKABLE_STAT:J.OST_WORKABLE_STAT,installLocation:J.installLocation||J.INSTL_LOC,CTRT_STAT:J.CTRT_STAT,CTRT_STAT_NM:J.CTRT_STAT_NM};te.push(V)}c(te),console.log("Work items loaded - :",te.length),console.log("Work items :",te)}catch(Y){console.error("   :",Y),Y instanceof Fs||Y instanceof Error?(U(Y.message),i&&i(Y.message,"error",!0)):(U("   ."),i&&i("   .","error",!0)),c([])}finally{v(!1)}})()},[t.id,i]);const P=S=>{var J,q,V,F,I,ee,ae;console.log("  :",S),console.log("  ID:",S.WRK_ID||S.id),console.log("  :",{WRK_ID:S.WRK_ID,WRK_CD_NM:S.WRK_CD_NM,CUST_NM:S.CUST_NM,PROD_NM:S.PROD_NM});const A=S.WRK_ID||S.id;L(A),Ba.getState().reset(),w(),console.log("[] REQ_CTX :",S.REQ_CTX),console.log("[] REQ_CTX JSON:",JSON.stringify(S.REQ_CTX)),console.log("[VIP ] item.VIP_GB:",S.VIP_GB,"| direction.VIP_GB:",t.VIP_GB,"| direction.customer.isVip:",(J=t.customer)==null?void 0:J.isVip);let Y=S.PROD_NM;if(S.WRK_DTL_TCD==="0520"||S.WRK_DTL_TCD==="0560"){const T=S.WRK_DTL_TCD==="0520"?"0510":"0550",j=l.find(k=>k.WRK_DTL_TCD===T&&k.PROD_GRP===S.PROD_GRP);j&&(Y=j.PROD_NM)}const te={id:S.WRK_ID||S.id,directionId:S.WRK_DRCTN_ID||S.directionId,type:S.WRK_CD_NM==="A/S"?"A/S":"Installation",typeDisplay:S.WRK_CD_NM||S.typeDisplay||"",status:S.WRK_STAT_CD==="3"?"":S.WRK_STAT_CD==="4"||S.WRK_STAT_CD==="7"?"":S.WRK_STAT_CD==="1"||S.WRK_STAT_CD==="2"?"":S.WRK_STAT_CD_NM||S.status||"",scheduledAt:S.WRK_HOPE_DTTM?`${S.WRK_HOPE_DTTM.slice(0,4)}-${S.WRK_HOPE_DTTM.slice(4,6)}-${S.WRK_HOPE_DTTM.slice(6,8)}T${S.WRK_HOPE_DTTM.slice(8,10)}:${S.WRK_HOPE_DTTM.slice(10,12)}:00`:S.scheduledAt||new Date().toISOString(),customer:{id:S.CUST_ID||((q=S.customer)==null?void 0:q.id)||"",name:S.CUST_NM||((V=S.customer)==null?void 0:V.name)||" ",phone:S.REQ_CUST_TEL_NO||((F=S.customer)==null?void 0:F.phone),address:S.ADDR||((I=S.customer)==null?void 0:I.address)||"  ",isVip:!!(S.VIP_GB&&String(S.VIP_GB).length>0)||((ee=t.customer)==null?void 0:ee.isVip)||!1,vipLevel:S.VIP_GB==="VIP_VVIP"?"VVIP":S.VIP_GB?"VIP":(ae=t.customer)==null?void 0:ae.vipLevel},details:S.REQ_CTX||"",assignedEquipment:S.assignedEquipment||[],WRK_CD:S.WRK_CD,WRK_DTL_TCD:S.WRK_DTL_TCD,WRK_STAT_CD:S.WRK_STAT_CD,WRK_STAT_NM:S.WRK_STAT_CD_NM||S.WRK_STAT_NM,WRK_DRCTN_ID:S.WRK_DRCTN_ID,CTRT_ID:S.CTRT_ID,DTL_CTRT_ID:S.DTL_CTRT_ID,RCPT_ID:S.RCPT_ID,productName:S.PROD_NM,PROD_NM:S.PROD_NM,OLD_PROD_CD:S.OLD_PROD_CD,OLD_PROD_NM:S.OLD_PROD_NM,OLD_CTRT_ID:S.OLD_CTRT_ID,OLD_CTRT_STAT:S.OLD_CTRT_STAT,OLD_CTRT_STAT_NM:S.OLD_CTRT_STAT_NM,OLD_PROM_CNT:S.OLD_PROM_CNT,currentProduct:S.OLD_PROD_NM||S.OLD_PROD_CD,newProduct:Y,installLocation:S.INSTL_LOC,MST_SO_ID:S.MST_SO_ID,SO_ID:S.SO_ID,PROD_CD:S.PROD_CD,ADDR_ORD:S.ADDR_ORD,CRR_ID:S.CRR_ID,BLD_ID:S.BLD_ID,CUST_ID:S.CUST_ID,WRKR_ID:S.WRKR_ID,CTRT_STAT:S.CTRT_STAT,CTRT_STAT_NM:S.CTRT_STAT_NM,SO_NM:S.SO_NM,MSO_NM:S.MSO_NM,PYM_MTHD:S.PYM_MTHD,PYM_ACNT_ID:S.PYM_ACNT_ID,APLYMONTH:S.APLYMONTH,PROM_CNT:S.PROM_CNT,CTRT_APLY_STRT_DT:S.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:S.CTRT_APLY_END_DT,VOIP_TEL_NO:S.VOIP_TEL_NO,GRP_ID:S.GRP_ID,GRP_NM:S.GRP_NM,CRR_NM:S.CRR_NM,PROD_GRP:S.PROD_GRP,PROD_GRP_NM:S.PROD_GRP_NM,WRKR_NM:S.WRKR_NM,ACNT_PYM_MTHD:S.ACNT_PYM_MTHD,KPI_PROD_GRP_CD:S.KPI_PROD_GRP_CD,PROD_CHG_GB:S.PROD_CHG_GB,CHG_KPI_PROD_GRP_CD:S.CHG_KPI_PROD_GRP_CD,VOIP_CTX:S.VOIP_CTX,VIP_GB:S.VIP_GB||t.VIP_GB||"",IS_CERTIFY_PROD:S.IS_CERTIFY_PROD,OP_LNKD_CD:S.OP_LNKD_CD,VOIP_PROD_CD:S.VOIP_PROD_CD,ISP_PROD_CD:S.ISP_PROD_CD,WRKR_CMPL_DT:S.WRKR_CMPL_DT,WRK_END_DTTM:S.WRK_END_DTTM,NET_CL:S.NET_CL,NET_CL_NM:S.NET_CL_NM,WRNG_TP:S.WRNG_TP,WRNG_TP_NM:S.WRNG_TP_NM,INSTL_TP:S.INSTL_TP,INSTL_TP_NM:S.INSTL_TP_NM,CB_WRNG_TP:S.CB_WRNG_TP,CB_INSTL_TP:S.CB_INSTL_TP,INOUT_LINE_TP:S.INOUT_LINE_TP,INOUT_LEN:S.INOUT_LEN,DVDR_YN:S.DVDR_YN,BFR_LINE_YN:S.BFR_LINE_YN,CUT_YN:S.CUT_YN,TERM_NO:S.TERM_NO,RCV_STS:S.RCV_STS,SUBTAP_ID:S.SUBTAP_ID,PORT_NUM:S.PORT_NUM,EXTN_TP:S.EXTN_TP,TAB_LBL:S.TAB_LBL,CVT_LBL:S.CVT_LBL,STB_LBL:S.STB_LBL,CUST_REL:S.CUST_REL,UP_CTRL_CL:S.UP_CTRL_CL,PSN_USE_CORP:S.PSN_USE_CORP,VOIP_USE_CORP:S.VOIP_USE_CORP,DTV_USE_CORP:S.DTV_USE_CORP,VIEW_MOD_CD:S.VIEW_MOD_CD,VIEW_MOD_NM:S.VIEW_MOD_NM,MEMO:S.MEMO,TERM_HOPE_DT:S.TERM_HOPE_DT,HOPE_DT:S.HOPE_DT,asReasonCode:S.WRK_RCPT_CL,asDetailCode:S.WRK_RCPT_CL_DTL,OST_WORKABLE_STAT:S.OST_WORKABLE_STAT,WRK_HOPE_DTTM:S.WRK_HOPE_DTTM};console.log("[WorkItemList] handleSelectItem - OST_WORKABLE_STAT:",S.OST_WORKABLE_STAT,"| WRK_CD:",S.WRK_CD),console.log("  :",te),n?n("work-process-flow",te):u(te)},G=S=>{var J,q,V,F,I,ee;console.log("   -  :",S);const A=S.WRK_ID||S.id;L(A),Ba.getState().reset();let Y=S.PROD_NM;if(S.WRK_DTL_TCD==="0520"||S.WRK_DTL_TCD==="0560"){const ae=S.WRK_DTL_TCD==="0520"?"0510":"0550",T=l.find(j=>j.WRK_DTL_TCD===ae&&j.PROD_GRP===S.PROD_GRP);T&&(Y=T.PROD_NM)}const te={id:S.WRK_ID||S.id,directionId:S.WRK_DRCTN_ID||S.directionId,type:S.WRK_CD_NM==="A/S"?"A/S":"Installation",typeDisplay:S.WRK_CD_NM||S.typeDisplay||"",status:S.WRK_STAT_CD==="3"?"":S.WRK_STAT_CD==="4"||S.WRK_STAT_CD==="7"?"":S.WRK_STAT_CD==="1"||S.WRK_STAT_CD==="2"?"":S.WRK_STAT_CD_NM||S.status||"",scheduledAt:S.WRK_HOPE_DTTM?`${S.WRK_HOPE_DTTM.slice(0,4)}-${S.WRK_HOPE_DTTM.slice(4,6)}-${S.WRK_HOPE_DTTM.slice(6,8)}T${S.WRK_HOPE_DTTM.slice(8,10)}:${S.WRK_HOPE_DTTM.slice(10,12)}:00`:S.scheduledAt||new Date().toISOString(),customer:{id:S.CUST_ID||((J=S.customer)==null?void 0:J.id)||"",name:S.CUST_NM||((q=S.customer)==null?void 0:q.name)||" ",phone:S.REQ_CUST_TEL_NO||((V=S.customer)==null?void 0:V.phone),address:S.ADDR||((F=S.customer)==null?void 0:F.address)||"  ",isVip:!!(S.VIP_GB&&String(S.VIP_GB).length>0)||((I=t.customer)==null?void 0:I.isVip)||!1,vipLevel:S.VIP_GB==="VIP_VVIP"?"VVIP":S.VIP_GB?"VIP":(ee=t.customer)==null?void 0:ee.vipLevel},details:S.REQ_CTX||"",assignedEquipment:S.assignedEquipment||[],WRK_CD:S.WRK_CD,WRK_DTL_TCD:S.WRK_DTL_TCD,WRK_STAT_CD:S.WRK_STAT_CD,WRK_STAT_NM:S.WRK_STAT_CD_NM||S.WRK_STAT_NM,WRK_DRCTN_ID:S.WRK_DRCTN_ID,CTRT_ID:S.CTRT_ID,DTL_CTRT_ID:S.DTL_CTRT_ID,RCPT_ID:S.RCPT_ID,productName:S.PROD_NM,PROD_NM:S.PROD_NM,OLD_PROD_CD:S.OLD_PROD_CD,OLD_PROD_NM:S.OLD_PROD_NM,OLD_CTRT_ID:S.OLD_CTRT_ID,OLD_CTRT_STAT:S.OLD_CTRT_STAT,OLD_CTRT_STAT_NM:S.OLD_CTRT_STAT_NM,OLD_PROM_CNT:S.OLD_PROM_CNT,currentProduct:S.OLD_PROD_NM||S.OLD_PROD_CD,newProduct:Y,installLocation:S.INSTL_LOC,MST_SO_ID:S.MST_SO_ID,SO_ID:S.SO_ID,PROD_CD:S.PROD_CD,ADDR_ORD:S.ADDR_ORD,CRR_ID:S.CRR_ID,BLD_ID:S.BLD_ID,CUST_ID:S.CUST_ID,WRKR_ID:S.WRKR_ID,CTRT_STAT:S.CTRT_STAT,CTRT_STAT_NM:S.CTRT_STAT_NM,SO_NM:S.SO_NM,MSO_NM:S.MSO_NM,PYM_MTHD:S.PYM_MTHD,PYM_ACNT_ID:S.PYM_ACNT_ID,APLYMONTH:S.APLYMONTH,PROM_CNT:S.PROM_CNT,CTRT_APLY_STRT_DT:S.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:S.CTRT_APLY_END_DT,VOIP_TEL_NO:S.VOIP_TEL_NO,GRP_ID:S.GRP_ID,GRP_NM:S.GRP_NM,CRR_NM:S.CRR_NM,PROD_GRP:S.PROD_GRP,PROD_GRP_NM:S.PROD_GRP_NM,WRKR_NM:S.WRKR_NM,ACNT_PYM_MTHD:S.ACNT_PYM_MTHD,KPI_PROD_GRP_CD:S.KPI_PROD_GRP_CD,PROD_CHG_GB:S.PROD_CHG_GB,CHG_KPI_PROD_GRP_CD:S.CHG_KPI_PROD_GRP_CD,VOIP_CTX:S.VOIP_CTX,VIP_GB:S.VIP_GB||t.VIP_GB||"",IS_CERTIFY_PROD:S.IS_CERTIFY_PROD,OP_LNKD_CD:S.OP_LNKD_CD,VOIP_PROD_CD:S.VOIP_PROD_CD,ISP_PROD_CD:S.ISP_PROD_CD,WRKR_CMPL_DT:S.WRKR_CMPL_DT,WRK_END_DTTM:S.WRK_END_DTTM,NET_CL:S.NET_CL,NET_CL_NM:S.NET_CL_NM,WRNG_TP:S.WRNG_TP,WRNG_TP_NM:S.WRNG_TP_NM,INSTL_TP:S.INSTL_TP,INSTL_TP_NM:S.INSTL_TP_NM,CB_WRNG_TP:S.CB_WRNG_TP,CB_INSTL_TP:S.CB_INSTL_TP,INOUT_LINE_TP:S.INOUT_LINE_TP,INOUT_LEN:S.INOUT_LEN,DVDR_YN:S.DVDR_YN,BFR_LINE_YN:S.BFR_LINE_YN,CUT_YN:S.CUT_YN,TERM_NO:S.TERM_NO,RCV_STS:S.RCV_STS,SUBTAP_ID:S.SUBTAP_ID,PORT_NUM:S.PORT_NUM,EXTN_TP:S.EXTN_TP,TAB_LBL:S.TAB_LBL,CVT_LBL:S.CVT_LBL,STB_LBL:S.STB_LBL,CUST_REL:S.CUST_REL,UP_CTRL_CL:S.UP_CTRL_CL,PSN_USE_CORP:S.PSN_USE_CORP,VOIP_USE_CORP:S.VOIP_USE_CORP,DTV_USE_CORP:S.DTV_USE_CORP,VIEW_MOD_CD:S.VIEW_MOD_CD,VIEW_MOD_NM:S.VIEW_MOD_NM,MEMO:S.MEMO,TERM_HOPE_DT:S.TERM_HOPE_DT,HOPE_DT:S.HOPE_DT,asReasonCode:S.WRK_RCPT_CL,asDetailCode:S.WRK_RCPT_CL_DTL,OST_WORKABLE_STAT:S.OST_WORKABLE_STAT,WRK_HOPE_DTTM:S.WRK_HOPE_DTTM};console.log("[WorkItemList] handleCompleteWork - OST_WORKABLE_STAT:",S.OST_WORKABLE_STAT,"| WRK_CD:",S.WRK_CD),console.log(" -   :",te),n?n("work-process-flow",te):u(te)},K=S=>{var Y,te;if(console.log("   -  :",S),S.WRK_CD==="08"&&l.find(q=>q.WRK_CD==="07"&&q.CTRT_ID===S.CTRT_ID&&(q.WRK_STAT_CD==="4"||q.WRK_STAT_CD==="7"))){i&&i("      .","error");return}const A={id:S.WRK_ID||S.id,directionId:S.WRK_DRCTN_ID||S.directionId,type:S.WRK_CD_NM==="A/S"?"A/S":"Installation",typeDisplay:S.WRK_CD_NM||S.typeDisplay||"",status:S.WRK_STAT_CD==="3"?"":S.WRK_STAT_CD==="4"||S.WRK_STAT_CD==="7"?"":S.WRK_STAT_CD==="1"||S.WRK_STAT_CD==="2"?"":S.WRK_STAT_CD_NM||"",scheduledAt:S.WRK_HOPE_DTTM?`${S.WRK_HOPE_DTTM.slice(0,4)}-${S.WRK_HOPE_DTTM.slice(4,6)}-${S.WRK_HOPE_DTTM.slice(6,8)}T${S.WRK_HOPE_DTTM.slice(8,10)}:${S.WRK_HOPE_DTTM.slice(10,12)}:00`:new Date().toISOString(),customer:{id:S.CUST_ID||"",name:S.CUST_NM||" ",phone:S.REQ_CUST_TEL_NO,address:S.ADDR||"  ",isVip:!!(S.VIP_GB&&String(S.VIP_GB).length>0)||((Y=t.customer)==null?void 0:Y.isVip)||!1,vipLevel:S.VIP_GB==="VIP_VVIP"?"VVIP":S.VIP_GB?"VIP":(te=t.customer)==null?void 0:te.vipLevel},details:S.REQ_CTX||"",assignedEquipment:[],WRK_CD:S.WRK_CD,CTRT_ID:S.CTRT_ID,WRK_STAT_CD:S.WRK_STAT_CD,RCPT_ID:S.RCPT_ID,SO_ID:S.SO_ID};console.log(" -  :",A),N(A),y(!0)},B=async S=>{if(g){console.log("  - cancelData:",S),console.log("  - cancelTarget:",g),v(!0),y(!1);try{console.log(" API  -  :",S);const A=await yb(S);if(console.log("  API :",A),A.code==="SUCCESS"||A.code==="OK"){i&&i("  .","success");const te=(await vy(t.id)).sort((J,q)=>{const V=F=>F===""||F===""?1:F===""?2:3;return V(J.WRK_STAT_CD_NM)-V(q.WRK_STAT_CD_NM)});c(te)}else i&&i(` : ${A.message}`,"error",!0)}catch(A){console.error(" :",A);const Y=A instanceof Fs?A.message:A.message||"   .";i&&i(Y,"error",!0)}finally{v(!1),N(null)}}};return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsxs("div",{className:"flex-shrink-0 bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-3 shadow-md z-40",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsxs("h1",{className:"text-base font-bold text-white truncate",children:[((O=l[0])==null?void 0:O.CUST_NM)||t.customer.name,t.customer.id&&s.jsxs("span",{className:"font-normal ml-1",children:["(",t.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-white/20 text-white border border-white/30 flex-shrink-0",children:t.typeDisplay})]}),s.jsxs("div",{className:"flex items-center gap-2 text-white/90 flex-shrink-0",children:[s.jsx(xb,{customer:t.customer}),s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-3.5 h-3.5",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),s.jsx("span",{className:"text-xs font-medium",children:D_(t.scheduledAt)})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[s.jsxs("svg",{className:"w-3.5 h-3.5 text-white/70 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-xs text-white/80 truncate",children:t.customer.address})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:C?s.jsx(z0,{size:"medium",message:"   ..."}):R?s.jsx(Ib,{type:"error",message:R,onRetry:()=>window.location.reload()}):l.length===0?s.jsxs("div",{className:"text-center py-10 sm:py-12 px-4 sm:px-6 bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Z_,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2 whitespace-nowrap",children:"  "})]}):s.jsx("div",{className:"space-y-3 pb-4",children:l.map((S,A)=>s.jsx(J3,{item:S,index:A+1,onSelect:P,onComplete:G,onCancel:K},S.WRK_ID||S.id||A))})}),g&&s.jsx(Sb,{isOpen:_,onClose:()=>y(!1),onConfirm:B,workOrder:g,userId:r,showToast:i})]})},w5=({isOpen:t,onClose:e,smsData:n,userId:r})=>{const[i,l]=x.useState(""),[c,d]=x.useState([]),[u,f]=x.useState(""),[m,_]=x.useState(""),[y,g]=x.useState("020"),[N,C]=x.useState(""),[v,R]=x.useState(!1),[U,L]=x.useState(!1),[w,P]=x.useState(null),G=x.useMemo(()=>{let F=0;for(let I=0;I<N.length;I++){const ee=N.charCodeAt(I);F+=ee>127?2:1}return F},[N]),K=2e3,B=G>K,O=x.useMemo(()=>((n==null?void 0:n.WRK_CD)||"")==="03"?J1:J1.filter(I=>I.refCode==="WK"),[n==null?void 0:n.WRK_CD]),S=F=>F.replace(/[-\s\(\)]/g,""),A=F=>{const I=S(F);return I.length>=9&&/^\d+$/.test(I)},Y=F=>{if(!F)return"";const I=F.split(/\s*\[[A-Z]\]|\s*[,\/]\s*/);for(const ee of I){const ae=ee.trim();if(A(ae))return ae}return F.trim()};x.useEffect(()=>{t&&n&&(async()=>{var j;L(!0),P(null);const I=[],ee=new Set,ae=(k,Q)=>{if(!Q)return;const H=Y(Q);if(!H||!A(H))return;const $=S(H);ee.has($)||(ee.add($),I.push({type:k,number:H}))};if(n.CUST_ID)try{const k=await u5({CUST_ID:n.CUST_ID}),Q=k.currentContract||((j=k.contracts)==null?void 0:j[0]);Q&&(ae("",n.WORK_REQ_TEL_NO||Q.WORK_REQ_TEL_NO),ae("",n.REQ_CUST_TEL_NO||Q.REQ_CUST_TEL_NO),ae("",Q.TEL_NO2||n.CUST_TEL_NO2),ae("",Q.TEL_NO1||n.CUST_TEL_NO1))}catch(k){console.error("[SMS] Failed to get phone from contract:",k)}n.SMS_RCV_TEL&&I.length===0&&ae("",n.SMS_RCV_TEL),d(I),I.length>0?(f(I[0].type),l(I[0].number)):(f(""),l(""));let T=n.SMS_SEND_TEL||"";if(!T)try{const k=localStorage.getItem("userInfo");k&&(T=JSON.parse(k).telNo2||"")}catch(k){console.error("[SMS] Failed to get telNo2 from userInfo:",k)}_(T),g("020"),J("020",n),L(!1)})()},[t,n]);const te=F=>F?F.includes(" ")&&F.length>=16?{hour:F.substring(11,13),minute:F.substring(14,16)}:F.includes("T")&&F.length>=16?{hour:F.substring(11,13),minute:F.substring(14,16)}:F.length>=12&&!F.includes("-")?{hour:F.substring(8,10),minute:F.substring(10,12)}:{hour:"",minute:""}:{hour:"",minute:""},J=(F,I)=>{if(!I)return;const ee=I.SO_ID==="328"?"[]":"[]",ae=I.WRK_HOPE_DTTM||"",{hour:T,minute:j}=te(ae),k=I.WRKR_NM_EN||I.WRKR_NM||"",Q=I.WRK_CD_NM||"",H=I.SMS_SEND_TEL||"";let $="";if(F==="020"){const fe=["100","600","327","210"].includes(I.SO_ID)&&I.SO_ID!=="201";$=`${ee} 

`,$+=`!   ''.
`,$+=`     CS  .

`,$+=` : ${Q}
`,fe?$+=` : ${T} ${j}
`:$+=` : ${T}
`,$+=`* CS    .
`,$+=` : ${k} CS ${H}

`,$+=`[]
`,$+=`*           .
`,$+=`* CS         .
`,$+=`* CS   .   .
`}else if(F==="021")$=`${ee}      .`;else if(F==="027")$=`${ee}  ${k}    .()`;else if(F==="028")$=`${ee}  ${k}    ${Q}   .`;else if(F==="138")$=`${ee} .   .`;else if(F==="139"){const ie=H.replace(/-/g,"").replace(/ /g,"");$=`${ee}AS    . :${ie}`}else if(F==="141")$=`${ee}   

`,$+=`    .

`,$+="        ,   ",$+="     .  URL  ",$+=`   .

`,$+="            . .";else if(F==="059_002")$=`${ee} KB  

`,$+=`1. 
`,$+=`https://m.dlive.kr/mobile/event/JoinAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`https://m.kbcard.com/CXHIACRC0002.cms?mainCC=b&allianceCode=04345&solicitorcode=702${r}
`;else if(F==="059"){const ie=(I.CUST_ID||"").slice(-5);$=`${ee}     

`,$+=`1. 
`,$+=`https://m.dlive.kr/mobile/event/JoinAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`https://m.hanacard.co.kr/MPACMM101M.web?_frame=no&CD_PD_SEQ=17176&eno=${r}&${ie}`}else if(F==="235")$=`${ee}    

`,$+=`1. 
`,$+=`https://m.dlive.kr/mobile/event/JoinAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`https://m.hanacard.co.kr/MPACMM101M.web?_frame=no&CD_PD_SEQ=18122&eno=${r}

`,$+=" 1800-0170";else if(F==="059_005"){const ie=I.CUST_ID||"";$=`${ee}  LOCA X Special SE   

`,$+=`1. 
`,$+=`https://m.dlive.kr/front/join/join/DiscountAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`http://m.lottecard.co.kr/spa/card/booth?bId=96893&vtCdKndC=P13791-A13791&cInfo=${ie}${r}
`}else F==="271"&&($="[]  1644-1100 . .");C($)},q=async()=>{if(!n){P("SMS data missing");return}if(!A(i)){P("   . (010, 011 )");return}if(!m.trim()){P(" .");return}if(!N.trim()){P("  .");return}R(!0),P(null);try{const F=J1.find(ae=>ae.code===y),I={SMS_EML_TYPE:y.substring(0,3),SO_ID:n.SO_ID,USER_SMS:i,SEND_SMS:m,USER_ID:n.CUST_ID,USER_NAME:n.CUST_NM,MAP01:N,KKO_MSG_ID:(F==null?void 0:F.kkoMsgId)||"KKO020_003",REG_UID:r,TRANS_YN:"N",SMS_EML_CL:"20"},ee=await w4(I);ee.code==="SUCCESS"?(alert("  ."),e()):P(ee.message||"  .")}catch(F){console.error("[SMS] Send error:",F),P(F.message||"    .")}finally{R(!1)}},V=s.jsxs("div",{className:"flex gap-2 w-full",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors",disabled:v,children:""}),s.jsx("button",{onClick:q,disabled:v||B,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:v?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(pb,{size:16}),""]})})]});return s.jsx(_a,{isOpen:t,onClose:e,title:"",size:"medium",footer:U?void 0:V,children:U?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-500 text-sm",children:"  ..."})]}):s.jsxs("div",{className:"space-y-4",children:[w&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:w}),n&&s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"font-medium",children:n.CUST_NM})]}),n.WRK_CD_NM&&s.jsxs("div",{className:"flex justify-between mt-1",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"font-medium",children:n.WRK_CD_NM})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),c.length>1?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-24 flex-shrink-0",children:s.jsx(Zs,{value:u,onValueChange:F=>{f(F);const I=c.find(ee=>ee.type===F);I&&l(I.number)},options:c.map(F=>({value:F.type,label:F.type})),placeholder:""})}),s.jsx("input",{type:"tel",value:i,onChange:F=>l(F.target.value),className:"flex-1 px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"})]}):s.jsx("input",{type:"tel",value:i,onChange:F=>l(F.target.value),placeholder:"010-1234-5678",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"tel",value:m,onChange:F=>_(F.target.value),placeholder:"010-1234-5678",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx(Zs,{value:y,onValueChange:F=>{g(F),n&&J(F,n),["059_002","059","235","059_005","271"].includes(F)&&_("1644-1100")},options:O.map(F=>({value:F.code,label:F.name})),placeholder:"  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("textarea",{value:N,onChange:F=>C(F.target.value),rows:8,className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none",placeholder:"  "}),s.jsxs("div",{className:`mt-1 text-right text-sm ${B?"text-red-600 font-medium":"text-gray-500"}`,children:[G," / ",K," bytes",B&&" ()"]})]})]})})},Z3=Array.from({length:13},(t,e)=>{const n=(e+9).toString().padStart(2,"0");return{value:n,label:`${n}`}}),eP=Array.from({length:6},(t,e)=>{const n=(e*10).toString().padStart(2,"0");return{value:n,label:`${n}`}}),iC=t=>{if(!t)return"-";const e=t.replace(/\D/g,"");return e.length>=10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:e.length>=6?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6)}`:t},P5=({isOpen:t,onClose:e,direction:n,onSuccess:r,showToast:i,userInfo:l})=>{const[c,d]=x.useState(""),[u,f]=x.useState(null),[m,_]=x.useState([]),[y,g]=x.useState(!1),[N,C]=x.useState(!1),[v,R]=x.useState(!1),[U,L]=x.useState(""),[w,P]=x.useState(""),[G,K]=x.useState(""),[B,O]=x.useState(""),[S,A]=x.useState([]),[Y,te]=x.useState(""),[J,q]=x.useState(""),[V,F]=x.useState(""),[I,ee]=x.useState(""),[ae,T]=x.useState(""),[j,k]=x.useState(!0),Q=x.useRef(null),H=x.useRef(null),$=x.useRef(null);x.useEffect(()=>{if(t){const se=n.WRK_HOPE_DTTM||"",Ee=n.scheduledAt||"";let Ne=new Date().toISOString().split("T")[0],ye="",ne="";if(se&&se.length>=8)Ne=`${se.substring(0,4)}-${se.substring(4,6)}-${se.substring(6,8)}`,se.length>=12&&(ye=se.substring(8,10),ne=se.substring(10,12));else if(Ee){const ue=new Date(Ee);isNaN(ue.getTime())||(Ne=ue.toISOString().split("T")[0],ye=String(ue.getHours()).padStart(2,"0"),ne=String(ue.getMinutes()).padStart(2,"0"))}L(Ne),P(ye),K(ne),te(Ne),q(ye),F(ne),d(""),f(null),_([]),O(""),ee(""),T(""),k(!0),ie()}},[t,n]);const ie=async()=>{try{await Promise.all([pe(),fe()])}finally{k(!1)}},fe=async()=>{try{const se=n.WRK_DRCTN_ID||n.id;if(!se)return;const Ee=n.CRR_NM||"",Ne=n.WRKR_NM||"";if(Ee||Ne){ee(Ee),T(Ne);return}const ye=await vy(se);if(ye&&ye.length>0){const ne=ye[0];ee(ne.CRR_NM||""),T(ne.WRKR_NM||""),console.log("[]   :",{CRR_NM:ne.CRR_NM,WRKR_NM:ne.WRKR_NM})}}catch(se){console.error("    :",se)}},pe=async()=>{try{const se=await ka("CMWO224");A(se||[])}catch(se){console.error("   :",se)}},de=()=>U!==Y||w!==J||G!==V;x.useEffect(()=>{const se=Ee=>{Q.current&&!Q.current.contains(Ee.target)&&g(!1)};if(y)return document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[y]);const Re=se=>{d(se),f(null),H.current&&clearTimeout(H.current),se.trim().length>=2?H.current=setTimeout(()=>{X(se.trim())},300):(_([]),g(!1))},X=async se=>{C(!0),g(!0);try{const Ee=await l_({USR_NM:se,SO_ID:(l==null?void 0:l.soId)||""});_(Ee||[])}catch(Ee){console.error("Worker search failed:",Ee),_([])}finally{C(!1)}},_e=se=>{f(se),d(se.USR_NM),g(!1)},me=async()=>{const se=U.replace(/-/g,"");if(se.length<8){i==null||i(" .","error");return}if(!w){i==null||i(" .","error");return}if(!G){i==null||i(" .","error");return}const Ee=new Date,Ne=`${Ee.getFullYear()}${String(Ee.getMonth()+1).padStart(2,"0")}${String(Ee.getDate()).padStart(2,"0")}${String(Ee.getHours()).padStart(2,"0")}${String(Ee.getMinutes()).padStart(2,"0")}`,ye=`${se}${w}${G}`;if(Number(ye)<Number(Ne)){i==null||i("   .","error");return}if(!u){i==null||i(" .","error");return}if(!n.WRK_DRCTN_ID&&!n.id){i==null||i(" ID .","error");return}if(de()&&!B){i==null||i(" .  .","error");return}R(!0);try{const ne=U.replace(/-/g,""),ue=w&&G?`${ne}${w}${G}`:void 0,xe=de(),et=!0;let bt="";xe&&et?bt="AL":et&&(bt="WR");const it=n,At=new Date,at=`${At.getFullYear()}${String(At.getMonth()+1).padStart(2,"0")}${String(At.getDate()).padStart(2,"0")}`,We=ne===at,Dt={CNTL_FG:"UPMODE",NMLEVEL:"3",WRK_DRCTN_ID:n.WRK_DRCTN_ID||n.id,WRKR_ID:u.USR_ID,CRR_ID:u.CRR_ID||(l==null?void 0:l.crrId)||"",POST_ID:u.POST_ID||"",DIV_DATE:ne,DIV_DT:ne,DIV_HH:w||"",DIV_MI:G||"",WRK_HOPE_DTTM:ue||"",RCPT_ID:it.RCPT_ID||"",WRK_ID:n.id||it.WRK_ID||"",REG_UID:(l==null?void 0:l.userId)||"",CHG_UID:(l==null?void 0:l.userId)||"",HOLY_YN:"N",SMS_YN:We?"Y":"N",DIV_RESULT:"",O_WRK_DIV_ID:"",WRK_DIV_CL:"",...B&&{CHG_RSN:B},...bt&&{CHG_GB:bt}};console.log("Worker adjustment params:",Dt);const Tt=await j4(Dt);console.log("Worker adjustment result:",Tt);const St=Tt==null?void 0:Tt.result;if(Array.isArray(St)&&St.length>0){const ze=St[0];if(ze.MSGCODE&&ze.MSGCODE!=="SUCCESS"&&ze.MSGCODE!=="0"){const dt=ze.MESSAGE||ze.MSG||"  .";i==null||i(dt,"error");return}}if(Tt!=null&&Tt.code&&Tt.code!=="SUCCESS"&&Tt.code!=="0"){const ze=Tt.message||Tt.MESSAGE||"  .";i==null||i(ze,"error");return}i==null||i("  .","success"),r==null||r(),e()}catch(ne){console.error("Worker adjustment failed:",ne),i==null||i(ne.message||"  .","error")}finally{R(!1)}},Z=()=>{var se;return s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"space-y-1.5 text-sm",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"font-mono text-gray-700",children:iC(n.WRK_DRCTN_ID||n.id)})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"text-blue-600 font-medium",children:n.typeDisplay||n.WRK_CD_NM})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:((se=n.customer)==null?void 0:se.name)||n.CUST_NM})]})]})})},le=s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:e,disabled:v,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 whitespace-nowrap",children:""}),s.jsx("button",{type:"button",onClick:me,disabled:v||!u,className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:v?"...":""})]});return s.jsxs(_a,{isOpen:t,onClose:e,title:" ",size:"medium",footer:j?void 0:le,children:[j?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(z0,{size:"medium",message:"  ..."})}):s.jsxs("div",{className:"space-y-4",children:[Z(),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",ref:Q,children:[s.jsxs("div",{className:"relative",children:[s.jsx(yu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:c,onChange:se=>Re(se.target.value),onFocus:()=>m.length>0&&g(!0),placeholder:"  (2 )",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u&&s.jsx("button",{type:"button",onClick:()=>{f(null),d(""),_([])},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(bi,{className:"w-4 h-4"})})]}),y&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-30",children:N?s.jsx("div",{className:"p-4 text-center",children:s.jsx(z0,{size:"small",message:"..."})}):m.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(Ih,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),s.jsx("p",{className:"text-sm",children:"  ."})]}):m.map(se=>{const Ee=se.CORP_NM||se.CRR_NM||"",Ne=se.TEL_NO3||se.TEL_NO2||se.HP_NO||se.PDATEL_NO||"";return s.jsxs("button",{type:"button",onMouseDown:ye=>ye.preventDefault(),onClick:()=>_e(se),className:"w-full p-3 text-left hover:bg-blue-50 transition-colors border-b border-gray-100 last:border-b-0",children:[s.jsx("div",{className:"font-medium text-gray-900",children:se.USR_NM}),s.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[se.USR_ID,Ee&&`  ${Ee}`,Ne&&`  ${iC(Ne)}`]})]},se.USR_ID)})})]})]}),u&&(()=>{const se=u.CORP_NM||u.CRR_NM||"",Ee=u.TEL_NO3||u.TEL_NO2||u.HP_NO||u.PDATEL_NO||"";return s.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("div",{className:"font-semibold text-gray-900 text-base mb-2",children:u.USR_NM}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:u.USR_ID})]}),se&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:se})]}),Ee&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:iC(Ee)})]})]})]})})(),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[" ",s.jsx("span",{className:"font-normal text-blue-600"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",ref:$,value:U,onChange:se=>L(se.target.value),className:"absolute opacity-0 pointer-events-none h-0 w-0",tabIndex:-1}),s.jsxs("button",{type:"button",onClick:()=>{var se,Ee;return(Ee=(se=$.current)==null?void 0:se.showPicker)==null?void 0:Ee.call(se)},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer bg-white flex items-center justify-between",children:[s.jsx("span",{className:`text-sm sm:text-base ${U?"text-gray-900":"text-gray-500"}`,children:U||" "}),s.jsx(Cf,{className:"w-4 h-4 text-gray-400"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Zs,{value:w,onValueChange:P,options:[{value:"",label:" "},...Z3.map(se=>({value:se.value,label:se.label}))],placeholder:" "})}),s.jsx("div",{className:"flex-1",children:s.jsx(Zs,{value:G,onValueChange:K,options:[{value:"",label:" "},...eP.map(se=>({value:se.value,label:se.label}))],placeholder:" "})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["  ",de()&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:B,onValueChange:O,options:[{value:"",label:" "},...S.map(se=>({value:se.code,label:se.name}))],placeholder:" "}),de()&&s.jsx("p",{className:"mt-1 text-xs text-orange-600",children:"      ."})]}),s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 rounded-lg",children:[s.jsx(Wr,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-amber-700",children:"         ."})]})]}),v&&s.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-lg",children:s.jsx(z0,{size:"medium",message:"  ..."})})]})},tP=({onBack:t,userInfo:e,showToast:n})=>{const[r,i]=x.useState(null),[l,c]=x.useState(!1),[d,u]=x.useState(!0),[f,m]=x.useState(!1),[_,y]=x.useState(!1),[g,N]=x.useState([]);x.useEffect(()=>{C(),v()},[e]);const C=async()=>{u(!0);try{const B=await g4({SO_ID:e==null?void 0:e.soId,CRR_ID:e==null?void 0:e.crrId,WRKR_ID:e==null?void 0:e.userId});if(console.log("[SafetyCheckList] Raw API items:",B),B&&B.length>0){let O=[];e!=null&&e.userId&&(O=await d5(e.userId),console.log("[SafetyCheckList] Today results:",O),O.length>0&&y(!0));const S=new Map;O.forEach(Y=>{Y.ITEM_ID&&S.set(Y.ITEM_ID,Y.ANSWER_VALUE||"N")});const A=B.sort((Y,te)=>(Y.DISPLAY_ORDER||0)-(te.DISPLAY_ORDER||0)).map(Y=>({id:Y.ITEM_ID,label:Y.QUESTION_TEXT,required:Y.IS_REQUIRED==="Y",imageRequired:Y.IMAGE_REQUIRED_YN==="Y",checked:S.get(String(Y.ITEM_ID))==="Y",photo:void 0}));console.log("[SafetyCheckList] Mapped items:",A),N(A)}else console.log("[SafetyCheckList] No items from API"),n&&n("    .","warning")}catch(B){console.error("[SafetyCheckList] Failed to load checklist:",B),n&&n("   ","error",!0)}finally{u(!1)}},v=async()=>{const B=(e==null?void 0:e.soId)||"",O=(e==null?void 0:e.crrId)||"";if(!(!B||!O))try{const S=await _4({SO_ID:B,CRR_ID:O});if(S&&S.length>0){const A=S.sort((te,J)=>J.INSP_END_DT.localeCompare(te.INSP_END_DT))[0];i(A);const Y=new Date().toISOString().slice(0,10).replace(/-/g,"");A.INSP_END_DT<Y&&(c(!0),n&&n(" .   .","warning"))}}catch(S){console.error("  :",S)}},R=B=>{N(O=>O.map(S=>S.id===B?{...S,checked:!S.checked}:S))},U=B=>new Promise((O,S)=>{const A=new Image;A.onload=()=>{try{const Y=document.createElement("canvas"),te=1920;let J=A.width,q=A.height;(J>te||q>te)&&(J>q?(q=q/J*te,J=te):(J=J/q*te,q=te)),Y.width=J,Y.height=q;const V=Y.getContext("2d");if(!V){S(new Error("Canvas context not available"));return}V.drawImage(A,0,0,J,q);const F=new Date,I=`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}-${String(F.getDate()).padStart(2,"0")} ${String(F.getHours()).padStart(2,"0")}:${String(F.getMinutes()).padStart(2,"0")}:${String(F.getSeconds()).padStart(2,"0")}`,ee=Math.max(16,Math.floor(J/25));V.font=`bold ${ee}px Arial`;const ae=V.measureText(I).width,T=10,j=ee+T*2,k=ae+T*2;V.fillStyle="rgba(0, 0, 0, 0.6)",V.fillRect(J-k-10,q-j-10,k,j),V.fillStyle="#FFFFFF",V.fillText(I,J-ae-T-10,q-T-15);const Q=Y.toDataURL("image/jpeg",.85);O(Q)}catch(Y){S(Y)}},A.onerror=()=>S(new Error("Image load failed")),A.src=URL.createObjectURL(B)}),L=async(B,O)=>{const S=O.target.files;if(S&&S.length>0)try{const A=await U(S[0]);N(Y=>Y.map(te=>te.id===B?{...te,photo:A,checked:!0}:te)),console.log("[SafetyCheckList]    ( , Base64 )")}catch(A){console.error("[SafetyCheckList]   :",A),n&&n("  .","error")}},w=B=>{N(O=>O.map(S=>S.id===B?{...S,photo:void 0}:S))},P=()=>g.filter(S=>S.required&&!S.checked).length>0?(n&&n("    .","warning"),!1):g.filter(S=>S.imageRequired&&!S.photo).length>0?(n&&n("   .","warning"),!1):!0,G=async()=>{if(!P())return;const B=(e==null?void 0:e.userId)||"mobile_user";m(!0);try{const O=g.map(te=>String(te.id)).join(","),S=g.map(te=>te.checked?"Y":"N").join(","),A="N";console.log("   :",{USR_ID:B,ANS_ITEM_IDS:O,ANS_VALUES:S,IMG_PATHS:"(empty - image upload not implemented)"});const Y=await p4({USR_ID:B,IMG_PATHS:A,ANS_ITEM_IDS:O,ANS_VALUES:S});console.log("  :",Y),Y.code==="SUCCESS"||Y.code==="OK"?(n&&n(" .","success"),await C(),await v()):n&&n(`  : ${Y.message||"   "}`,"error",!0)}catch(O){console.error("  :",O),n&&n("  API  .","warning")}finally{m(!1)}},K=()=>{const B=g.filter(S=>S.required);if(B.length===0)return 100;const O=B.filter(S=>S.checked).length;return Math.round(O/B.length*100)};return d?s.jsxs("div",{className:"text-center p-10",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-cyan-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-gray-600",children:" ..."})]}):g.length===0?s.jsx("div",{className:"max-w-4xl mx-auto pb-6",children:s.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Wr,{className:"w-6 h-6 text-yellow-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-yellow-800 font-bold mb-1",children:"  "}),s.jsx("p",{className:"text-sm text-yellow-700",children:"DB     .  ."})]})]})})}):s.jsxs("div",{className:"max-w-4xl mx-auto pb-6",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-500 text-white p-4 sm:p-5 rounded-xl shadow-lg mb-6 relative",children:s.jsxs("div",{className:"flex items-start gap-2 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 z-10 min-w-0 flex flex-col justify-between h-36 sm:h-44",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"p-1.5 sm:p-2 bg-white/20 rounded-lg flex-shrink-0",children:s.jsx(pv,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),s.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:""})]}),s.jsx("p",{className:"text-xs sm:text-sm text-white/90",children:"  "}),s.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 text-xs",children:[s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""}),s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""}),s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""}),s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""})]})]}),s.jsx("div",{className:"flex-shrink-0 w-28 h-28 sm:w-36 sm:h-36 relative",children:s.jsx("img",{src:"/safeimage1-Photoroom.png",alt:" ",className:"absolute -right-4 -bottom-10 drop-shadow-xl !w-[170px] !h-auto !max-w-none"})})]})}),l&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Wr,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-red-800 font-bold mb-1",children:" "}),s.jsx("p",{className:"text-sm text-red-700",children:" .      ."})]})]})}),r&&!l&&s.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Vi,{className:"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-green-800 font-bold mb-1",children:"  "}),s.jsxs("p",{className:"text-sm text-green-700",children:[": ",r.INSP_END_DT.slice(0,4),"-",r.INSP_END_DT.slice(4,6),"-",r.INSP_END_DT.slice(6,8)]})]})]})}),_&&s.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Vi,{className:"w-6 h-6 text-blue-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-blue-800 font-bold mb-1",children:"   "}),s.jsx("p",{className:"text-sm text-blue-700",children:"   .     ."})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden mb-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 p-3 sm:p-4 flex items-center gap-2 sm:gap-3",children:[s.jsx(pv,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"}),s.jsx("h3",{className:"text-base sm:text-lg font-bold text-white",children:" "}),s.jsxs("span",{className:"ml-auto text-white/80 text-sm",children:[g.length," "]})]}),s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:g.map((B,O)=>{var S;return s.jsxs("div",{className:`p-3 rounded-lg border ${B.checked?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:B.checked,onChange:()=>R(B.id),className:"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-900 whitespace-pre-line",children:[O+1,". ",(S=B.label)==null?void 0:S.replace(/\r\n/g,`
`).replace(/  - /g,`
- `),B.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),B.imageRequired&&s.jsxs("span",{className:"ml-2 inline-flex items-center gap-1 px-2 py-0.5 rounded bg-orange-100 text-orange-700 text-xs",children:[s.jsx(fv,{className:"w-3 h-3"}),""]})]}),B.checked&&s.jsx(Vi,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]}),B.imageRequired&&s.jsx("div",{className:"mt-3 ml-8",children:B.photo?s.jsxs("div",{className:"relative inline-block",children:[s.jsx("img",{src:B.photo,alt:" ",className:"w-24 h-24 object-cover rounded-lg border-2 border-green-300"}),s.jsx("button",{onClick:()=>w(B.id),className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:s.jsx(bi,{className:"w-3 h-3"})})]}):s.jsxs("label",{className:"inline-flex items-center gap-2 px-4 py-2 border-2 border-dashed border-orange-300 rounded-lg hover:border-orange-500 hover:bg-orange-50 cursor-pointer transition-all",children:[s.jsx(fv,{className:"w-4 h-4 text-orange-500"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:" "}),s.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:A=>L(B.id,A),className:"hidden"})]})})]},B.id)})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("button",{onClick:G,disabled:f||K()<100,className:"w-full py-3 sm:py-4 bg-gradient-to-r from-blue-600 to-cyan-500 text-white rounded-xl font-bold text-base sm:text-lg shadow-lg hover:from-blue-700 hover:to-cyan-600 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:f?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})," ..."]}):" "}),K()<100&&s.jsx("p",{className:"text-center text-sm text-red-600 mt-2",children:"   "})]}),s.jsx("div",{className:"mt-3 p-2.5 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-xs text-blue-800",children:[s.jsx("span",{className:"text-red-500 font-bold",children:"*"}),"     "]})})]})},sP=({onBack:t})=>{const[e,n]=x.useState([]),[r,i]=x.useState(!1),[l,c]=x.useState(null),[d,u]=x.useState(new Date().toISOString().slice(0,10));x.useEffect(()=>{f()},[]);const f=async()=>{try{i(!0),c(null);const m={};d&&(m.HOPE_DT=d.replace(/-/g,""));const _=await x4(m);n(_),console.log("  :",_.length)}catch(m){console.error("  :",m),c("  .")}finally{i(!1)}};return s.jsxs("div",{children:[s.jsx("div",{className:"mb-3",children:s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"mb-3 bg-white rounded-lg shadow-sm border border-gray-200 p-3",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"date",value:d,onChange:m=>u(m.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",style:{colorScheme:"light"}})]}),s.jsx("button",{onClick:f,disabled:r,className:"w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded font-medium text-sm shadow-md transition-all disabled:opacity-50",children:""})]})}),r?s.jsxs("div",{className:"text-center p-10",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-orange-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-gray-600",children:" ..."})]}):l?s.jsxs("div",{className:"text-center p-10 bg-white rounded-lg shadow-sm border border-red-200",children:[s.jsx("p",{className:"text-red-500",children:l}),s.jsx("button",{onClick:f,className:"mt-4 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:" "})]}):s.jsx(s.Fragment,{children:e.length>0?s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:s.jsx("div",{className:"max-h-96 overflow-y-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""})]})}),s.jsx("tbody",{children:e.map((m,_)=>s.jsxs("tr",{className:"hover:bg-orange-50 transition-colors",children:[s.jsx("td",{className:"px-2 py-2 text-xs text-gray-900 border-b",children:m.WRKR_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.WRK_CD_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.ING_CNT||0}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.CMPL_CNT||0}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.SUM_CNT||0})]},`${m.WRK_ID}-${_}`))})]})})}):s.jsx("div",{className:"text-center py-10 bg-white rounded-lg shadow-sm border border-gray-200",children:s.jsx("p",{className:"text-gray-500 text-sm",children:"   "})})})]})},nP=({isOpen:t,onClose:e,onSelectCustomer:n})=>{const[r,i]=x.useState(""),[l,c]=x.useState(""),[d,u]=x.useState(""),[f,m]=x.useState(""),[_,y]=x.useState([]),[g,N]=x.useState(!1),[C,v]=x.useState(!1),R=()=>{i(""),c(""),u(""),m(""),y([]),v(!1)},U=async()=>{N(!0),v(!0),y([]);try{let w=[];if(l.trim())w=await t3(l.trim());else if(r.trim())w=await e3(r.trim());else if(d.trim())w=await Z4(d.trim());else if(f.trim())w=await s3(f.trim());else{alert("  ."),N(!1);return}y(w)}catch(w){console.error("Customer search error:",w)}finally{N(!1)}},L=w=>{const P={...w};l.trim()&&!P.CTRT_ID&&(P.CTRT_ID=l.trim()),n(P),e()};return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12 bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[90%] max-w-md max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500 rounded-t-xl",children:[s.jsx("h3",{className:"text-white font-bold text-base",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:R,className:"px-3 py-1 text-xs bg-white/20 text-white rounded-full hover:bg-white/30",children:""}),s.jsx("button",{onClick:e,className:"text-white",children:s.jsx(bi,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"p-4 space-y-3 border-b",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:r,onChange:w=>i(w.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:"ID ",maxLength:10})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:l,onChange:w=>c(w.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:"ID ",maxLength:15})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:""}),s.jsx("input",{type:"tel",value:d,onChange:w=>u(w.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:" ",maxLength:15})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:f,onChange:w=>m(w.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:" ",maxLength:20})]}),s.jsxs("div",{className:"flex gap-2 pt-1",children:[s.jsxs("button",{onClick:U,disabled:g,className:"flex-1 flex items-center justify-center gap-1 bg-blue-500 hover:bg-blue-600 text-white py-2.5 rounded-lg font-medium text-sm disabled:opacity-50",children:[s.jsx(yu,{className:"h-4 w-4"}),""]}),s.jsx("button",{onClick:e,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2.5 rounded-lg font-medium text-sm",children:""})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:g?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-3 border-blue-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:" ..."})]}):_.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:[" ",_.length,""]}),_.map((w,P)=>s.jsx("button",{onClick:()=>L(w),className:"w-full text-left p-3 bg-gray-50 hover:bg-blue-50 border border-gray-200 rounded-lg transition-colors",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[w.CUST_NM||"-"," ",s.jsxs("span",{className:"text-gray-400 text-xs",children:["(",w.CUST_ID,")"]})]}),w.CTRT_ID&&s.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[": ",w.CTRT_ID," | ",w.BASIC_PROD_CD_NM||w.PROD_NM||"-"]}),w.ADDR&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5 truncate",children:w.ADDR})]}),s.jsxs("div",{className:"text-right",children:[w.CTRT_STAT_NM&&s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700",children:w.CTRT_STAT_NM}),w.SO_NM&&s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:w.SO_NM})]})]})},P))]}):C?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-gray-500",children:"  ."})}):s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-gray-400",children:"     ."})})})]})}):null},A5=({onBack:t,userInfo:e,showToast:n})=>{const[r,i]=x.useState(!1),[l,c]=x.useState(null),[d,u]=x.useState([]),[f,m]=x.useState(null),[_,y]=x.useState(!1),[g,N]=x.useState("all"),[C,v]=x.useState(""),[R,U]=x.useState(!1),[L,w]=x.useState(!1),[P,G]=x.useState("basic"),K=x.useRef([]),B=x.useRef([]),O=x.useRef([]),S=x.useRef(!1);x.useEffect(()=>{S.current||(S.current=!0,(async()=>{try{const[ze,dt,Ke]=await Promise.all([mc().catch(()=>[]),ex().catch(()=>[]),ka("CMIF006").catch(()=>[])]);K.current=ze||[],B.current=dt||[],O.current=(Ke||[]).map(rt=>rt.code||rt.COMMON_CD)}catch(ze){console.error("[SignalIntegration]    :",ze)}})())},[]);const A=ze=>{const dt=ze.BASIC_PROD_CD||ze.PROD_CD||"",Ke=ze.SO_ID||"";return dt&&K.current.some(rt=>rt.PROD_CD===dt)?"lgu":dt&&B.current.includes(dt)&&Ke&&O.current.includes(Ke)?"ftth":"basic"},[Y,te]=x.useState(!1),[J,q]=x.useState(""),[V,F]=x.useState(()=>{const ze=new Date;return ze.setDate(ze.getDate()-7),ze.toISOString().slice(0,10)}),[I,ee]=x.useState(new Date().toISOString().slice(0,10)),[ae,T]=x.useState(!1),[j,k]=x.useState(!1),[Q,H]=x.useState([]),[$,ie]=x.useState(null),[fe,pe]=x.useState([]),[de,Re]=x.useState([]),[X,_e]=x.useState([]),[me,Z]=x.useState(null),[le,se]=x.useState([]),[Ee,Ne]=x.useState([]),ye=ze=>{if(!ze)return"-";const dt=ze.replace(/[^0-9]/g,"");return dt.length===10?`${dt.slice(0,3)}-${dt.slice(3,6)}-${dt.slice(6)}`:ze},ne=ze=>{if(!ze)return"-";const dt=ze.replace(/[-: T]/g,"");return dt.length>=14?`${dt.slice(0,4)}-${dt.slice(4,6)}-${dt.slice(6,8)} ${dt.slice(8,10)}:${dt.slice(10,12)}:${dt.slice(12,14)}`:dt.length>=8?`${dt.slice(0,4)}-${dt.slice(4,6)}-${dt.slice(6,8)}`:ze},ue=()=>{H([]),ie(null),pe([]),Re([]),_e([]),Z(null),se([]),Ne([])},xe=async ze=>{if(c(ze),u([]),m(null),ue(),w(!0),ze.CTRT_ID){const dt={CTRT_ID:ze.CTRT_ID,CUST_ID:ze.CUST_ID,BASIC_PROD_CD_NM:ze.BASIC_PROD_CD_NM||ze.PROD_NM,CTRT_STAT_NM:ze.CTRT_STAT_NM,SO_NM:ze.SO_NM,ADDR:ze.ADDR};m(dt),q(ze.CTRT_ID)}if(ze.CUST_ID)try{const dt=await n3(ze.CUST_ID);if(dt.length>0){u(dt);const Ke=ze.CTRT_ID;if(Ke){const rt=dt.find(ft=>ft.CTRT_ID===Ke);if(rt){m(rt),q(rt.CTRT_ID);const ft=A(rt);G(ft)}else console.log("[SignalIntegration]   CTRT_ID  ,  CTRT_ID :",Ke),q(Ke)}else if(!f&&dt.length===1){m(dt[0]),q(dt[0].CTRT_ID);const rt=A(dt[0]);G(rt)}}}catch(dt){console.error("Failed to load contract list:",dt)}finally{w(!1)}else w(!1);ze.CTRT_ID&&te(!0)};x.useEffect(()=>{Y&&!L&&J&&(te(!1),bt())},[Y,L,J]);const et=ze=>{if((f==null?void 0:f.CTRT_ID)===ze.CTRT_ID&&R){U(!1);return}m(ze),q(ze.CTRT_ID),ue();const dt=A(ze);G(dt),U(!1)},bt=async()=>{const ze=J.trim();if(!ze){n==null||n("ID .","warning");return}T(!0),ue(),U(!0);try{const dt=V.replace(/-/g,""),Ke=new Date(I);Ke.setDate(Ke.getDate()+1);const rt=Ke.toISOString().slice(0,10).replace(/-/g,"");if(P==="basic"){const Ot=await q4({CTRT_ID:ze,STRT_DTTM1:dt,STRT_DTTM2:rt,CALL_GB:"M"});H(Ot.slice(0,100))}else if(P==="lgu"){const Ot=await Y4({CTRT_ID:ze,STRT_DTTM1:dt,STRT_DTTM2:rt,CALL_GB:"M"});_e(Ot.slice(0,100))}else{const Ot=await Zw({CTRT_ID:ze,STRT_DTTM1:dt,STRT_DTTM2:rt});Ne(Ot.slice(0,100))}const ft=P==="basic"?Q.length:P==="lgu"?X.length:Ee.length;n==null||n(" .","success")}catch(dt){console.error("Signal history query error:",dt),n==null||n("  .","error")}finally{T(!1)}},it=async ze=>{if(ie(ze),pe([]),Re([]),!!ze.IF_DTL_ID){k(!0);try{const{svcRslt:dt,svcDtlRslt:Ke}=await X4(ze.IF_DTL_ID);pe(dt),Re(Ke)}catch(dt){console.error("Detail query error:",dt)}finally{k(!1)}}},At=async ze=>{if(Z(ze),se([]),!!ze.JOB_ID){k(!0);try{const dt=await z4(ze.JOB_ID);se(dt)}catch(dt){console.error("LGU detail query error:",dt)}finally{k(!1)}}},at=d.filter(ze=>ze.CTRT_STAT_NM===""||ze.CTRT_STAT==="10"),We=g==="active"?at:d,Dt=C?We.filter(ze=>(ze.CTRT_ID||"").includes(C)||(ze.BASIC_PROD_CD_NM||ze.PROD_NM||"").includes(C)||(ze.ADDR||ze.INSTL_ADDR||"").includes(C)):We,St=(P==="basic"?Q.length:P==="lgu"?X.length:Ee.length)>0;return s.jsxs("div",{className:"flex-1 overflow-y-auto px-3 pt-2 pb-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 w-14 flex-shrink-0",children:""}),s.jsxs("button",{onClick:()=>i(!0),className:"flex-1 flex items-center gap-2 px-3 py-2.5 border border-gray-300 rounded-lg text-left hover:bg-gray-50 transition-colors",children:[l?s.jsxs("span",{className:"text-sm text-gray-900 truncate",children:[l.CUST_NM||"-"," (",l.CUST_ID,")"]}):s.jsx("span",{className:"text-sm text-gray-400",children:", ID, ID, "}),s.jsx(yu,{className:"h-4 w-4 text-gray-400 ml-auto flex-shrink-0"})]})]})}),L&&s.jsxs("div",{className:"text-center py-8 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-[3px] border-blue-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"   ..."})]}),d.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsxs("button",{onClick:()=>U(!R),className:"w-full px-3 py-2.5 border-b border-gray-100 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-800 flex items-center gap-1.5",children:[s.jsx("span",{className:"text-blue-500",children:"|"}),"   ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",Dt.length,")"]}),R&&f&&s.jsxs("span",{className:"text-xs font-normal text-gray-500 ml-1",children:["- ",ye(f.CTRT_ID)," (",f.BASIC_PROD_CD_NM||f.PROD_NM||"",")"]})]}),R?s.jsx(sr,{className:"h-4 w-4 text-gray-400"}):s.jsx(Mr,{className:"h-4 w-4 text-gray-400"})]}),!R&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-3 py-1.5 border-b border-gray-100 flex items-center justify-end",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsxs("button",{onClick:()=>N("all"),className:`px-2.5 py-1 text-xs rounded-full font-medium ${g==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-500"}`,children:["(",d.length,")"]}),s.jsxs("button",{onClick:()=>N("active"),className:`px-2.5 py-1 text-xs rounded-full font-medium ${g==="active"?"bg-blue-500 text-white":"bg-gray-100 text-gray-500"}`,children:["(",at.length,")"]})]})}),s.jsx("div",{className:"px-3 py-2 border-b border-gray-50",children:s.jsxs("div",{className:"relative",children:[s.jsx(r5,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"}),s.jsx("input",{type:"text",value:C,onChange:ze=>v(ze.target.value),className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-200 rounded-md bg-gray-50 focus:bg-white focus:border-blue-300 focus:outline-none",placeholder:"ID, ,  "})]})}),s.jsx("div",{className:`${_?"max-h-72":"max-h-44"} overflow-y-auto`,children:Dt.map((ze,dt)=>s.jsx("button",{onClick:()=>et(ze),className:`w-full text-left px-3 py-2.5 border-b border-gray-50 transition-colors ${(f==null?void 0:f.CTRT_ID)===ze.CTRT_ID?"bg-blue-50 border-l-3 border-l-blue-500":"hover:bg-gray-50"}`,children:s.jsxs("div",{className:"flex items-start gap-2.5",children:[s.jsx("span",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${(f==null?void 0:f.CTRT_ID)===ze.CTRT_ID?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:dt+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:ze.BASIC_PROD_CD_NM||ze.PROD_NM||"-"}),s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full flex-shrink-0 ml-2 ${ze.CTRT_STAT_NM===""?"bg-green-100 text-green-700":ze.CTRT_STAT_NM===""?"bg-blue-100 text-blue-600":ze.CTRT_STAT_NM===""?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:ze.CTRT_STAT_NM||"-"})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[s.jsxs("span",{children:[" ID: ",ye(ze.CTRT_ID)]}),s.jsx("span",{className:"text-gray-300",children:"|"}),s.jsx("span",{children:ze.SO_NM||"N/A"})]}),(ze.ADDR||ze.INSTL_ADDR)&&s.jsx("p",{className:"mt-0.5 text-xs text-gray-400 truncate",children:ze.INSTL_ADDR||ze.ADDR})]})]})},ze.CTRT_ID||dt))}),Dt.length>3&&s.jsx("button",{onClick:()=>y(!_),className:"w-full py-1.5 text-xs text-blue-500 hover:bg-blue-50 flex items-center justify-center gap-1",children:_?s.jsxs(s.Fragment,{children:[s.jsx(Mr,{className:"h-3 w-3"})," "]}):s.jsxs(s.Fragment,{children:[s.jsx(sr,{className:"h-3 w-3"})," "]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:J,onChange:ze=>q(ze.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none",placeholder:"ID ",maxLength:15})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsx("input",{type:"date",value:V,onChange:ze=>F(ze.target.value),className:"flex-1 px-2 py-2 text-sm border border-gray-300 rounded-lg",style:{colorScheme:"light"}}),s.jsx("span",{className:"text-gray-400 text-sm",children:"~"}),s.jsx("input",{type:"date",value:I,onChange:ze=>ee(ze.target.value),className:"flex-1 px-2 py-2 text-sm border border-gray-300 rounded-lg",style:{colorScheme:"light"}})]}),s.jsx("button",{onClick:bt,disabled:ae,className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-2.5 rounded-lg font-medium text-sm shadow-sm transition-all disabled:opacity-50",children:ae?" ...":""})]}),ae?s.jsxs("div",{className:"text-center py-10 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-7 w-7 border-[3px] border-blue-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"  ..."})]}):St?s.jsxs(s.Fragment,{children:[P==="basic"&&Q.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",Q.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full min-w-[780px]",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"(KCT)"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"SO_ID"})]})}),s.jsx("tbody",{children:Q.map((ze,dt)=>s.jsxs("tr",{onClick:()=>it(ze),className:`cursor-pointer transition-colors ${($==null?void 0:$.IF_DTL_ID)===ze.IF_DTL_ID?"bg-blue-100":dt%2===0?"bg-white":"bg-gray-50/50"} hover:bg-blue-50`,children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.IF_DTL_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[140px] truncate",children:ze.PROD_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.MSG_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[120px] truncate",children:ze.MSG_ID_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:ze.RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:ze.RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:ze.PROC_RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:ze.PROC_RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.SO_ID||"-"})]},`${ze.IF_DTL_ID}-${dt}`))})]})})})]}),P==="basic"&&$&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["ID: ",$.IF_DTL_ID]})]})}),j?s.jsx("div",{className:"text-center py-6",children:s.jsx("div",{className:"inline-block animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"})}):fe.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[700px]",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:fe.map((ze,dt)=>s.jsxs("tr",{className:dt%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.REQ_SYSTEM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.IF_DTL_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ne(ze.REG_DTTM)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.IF_TP||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:ze.SYSTEM_RSLT_CD&&ze.SYSTEM_RSLT_CD.startsWith("0")?"text-green-600":"text-red-600",children:ze.SYSTEM_RSLT_CD||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.SYSTEM_RSLT_MSG||"-"})]},dt))})]})}):s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-xs text-gray-400",children:"  "})}),de.length>0&&s.jsxs("div",{className:"border-t border-gray-200",children:[s.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-100",children:s.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:" "})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[700px]",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "}),s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "}),s.jsx("th",{className:"px-2 py-1.5 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "}),s.jsx("th",{className:"px-2 py-1.5 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "})]})}),s.jsx("tbody",{children:de.map((ze,dt)=>{var Ke,rt;return s.jsxs("tr",{className:dt%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.IF_DTL_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.IF_TP||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:(Ke=ze.TMS_PROC_STATUS_NM)!=null&&Ke.includes("")?"text-green-600":"text-orange-600",children:ze.TMS_PROC_STATUS_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:(rt=ze.LS_PROC_STATUS_NM)!=null&&rt.includes("")?"text-green-600":"text-orange-600",children:ze.LS_PROC_STATUS_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.TMS_ERR_MSG||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.LS_ERR_MSG||"-"})]},dt)})})]})})]})]}),P==="lgu"&&X.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",X.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full min-w-[780px]",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"(KCT)"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"SO_ID"})]})}),s.jsx("tbody",{children:X.map((ze,dt)=>s.jsxs("tr",{onClick:()=>At(ze),className:`cursor-pointer transition-colors ${(me==null?void 0:me.JOB_ID)===ze.JOB_ID?"bg-blue-100":dt%2===0?"bg-white":"bg-gray-50/50"} hover:bg-blue-50`,children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.JOB_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[140px] truncate",children:ze.PROD_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.MSG_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[120px] truncate",children:ze.MSG_ID_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:ze.RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:ze.RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:ze.PROC_RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:ze.PROC_RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.SO_ID||"-"})]},`${ze.JOB_ID}-${dt}`))})]})})})]}),P==="lgu"&&me&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["ID: ",me.JOB_ID]})]})}),j?s.jsx("div",{className:"text-center py-6",children:s.jsx("div",{className:"inline-block animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"})}):le.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[700px]",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:le.map((ze,dt)=>s.jsxs("tr",{className:dt%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.REQ_SYSTEM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.JOB_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ne(ze.REG_DTTM)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.RS_FCODE||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:ze.RS_FCODE&&ze.RS_FCODE.startsWith("0")?"text-green-600":"text-red-600",children:ze.RS_FCODE||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.RS_FMSG||"-"})]},dt))})]})}):s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-xs text-gray-400",children:"  "})})]}),P==="ftth"&&Ee.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:["  ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",Ee.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full min-w-[850px]",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"AP_MAC"}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:Ee.map((ze,dt)=>s.jsxs("tr",{className:dt%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.SEQ_API||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:ze.CMD||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[120px] truncate",children:ze.MSG_TP_DESC||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ne(ze.REQ_DATE)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[140px] truncate",children:ze.RESULT||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ne(ze.RES_DATE)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.MAC_ADDR||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:ze.SO_NM||"-"})]},`${ze.SEQ_API}-${dt}`))})]})})})]})]}):!ae&&J||ae?null:s.jsx("div",{className:"text-center py-10 bg-white rounded-lg shadow-sm border border-gray-200",children:s.jsx("p",{className:"text-sm text-gray-400",children:"  ID   "})}),s.jsx(nP,{isOpen:r,onClose:()=>i(!1),onSelectCustomer:xe})]})},k5=({onClick:t,workCount:e})=>s.jsxs("button",{onClick:t,className:"fixed bottom-24 right-4 z-40 w-14 h-14 bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-105 active:scale-95",style:{boxShadow:"0 4px 14px rgba(59, 130, 246, 0.4)"},title:" ",children:[s.jsx(HL,{className:"w-6 h-6"}),e!==void 0&&e>0&&s.jsx("span",{className:"absolute -top-1 -right-1 min-w-5 h-5 px-1.5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:e>99?"99+":e})]}),il={ADD:"add",REMOVE:"remove"},Nf={PROPERTYCHANGE:"propertychange"},Rn={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class ax{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function rP(t,e,n){let r,i;n=n||Jc;let l=0,c=t.length,d=!1;for(;l<c;)r=l+(c-l>>1),i=+n(t[r],e),i<0?l=r+1:(c=r,d=!i);return d?l:~l}function Jc(t,e){return t>e?1:t<e?-1:0}function iP(t,e){return t<e?1:t>e?-1:0}function Ob(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if(typeof n=="function"){for(let i=1;i<r;++i){const l=t[i];if(l===e)return i;if(l<e)return n(e,t[i-1],l)>0?i-1:i}return r-1}if(n>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(n<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function aP(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function Mb(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let i=0;i<r;i++)t[t.length]=n[i]}function Du(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function lP(t,e,n){const r=e||Jc;return t.every(function(i,l){if(l===0)return!0;const c=r(t[l-1],i);return!(c>0||c===0)})}function eg(){return!0}function lx(){return!1}function tg(){}function U5(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return(!n||this!==r||!Du(i,n))&&(r=this,n=i,e=t.apply(this,arguments)),e}}function oP(t){function e(){let n;try{n=t()}catch(r){return Promise.reject(r)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function Sg(t){for(const e in t)delete t[e]}function Sf(t){let e;for(e in t)return!1;return!e}class cd{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class ox extends ax{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(n)||i.push(n)}dispatchEvent(e){const n=typeof e=="string",r=n?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const l=n?new cd(e):e;l.target||(l.target=this.eventTarget_||this);const c=this.dispatching_||(this.dispatching_={}),d=this.pendingRemovals_||(this.pendingRemovals_={});r in c||(c[r]=0,d[r]=0),++c[r];let u;for(let f=0,m=i.length;f<m;++f)if("handleEvent"in i[f]?u=i[f].handleEvent(l):u=i[f].call(this,l),u===!1||l.propagationStopped){u=!1;break}if(--c[r]===0){let f=d[r];for(delete d[r];f--;)this.removeEventListener(r,tg);delete c[r]}return u}disposeInternal(){this.listeners_&&Sg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(n);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=tg,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}}function er(t,e,n,r,i){if(i){const c=n;n=function(d){return t.removeEventListener(e,n),c.call(r??this,d)}}else r&&r!==t&&(n=n.bind(r));const l={target:t,type:e,listener:n};return t.addEventListener(e,n),l}function O_(t,e,n,r){return er(t,e,n,r,!0)}function Hr(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Sg(t))}class vg extends ox{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Rn.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let l=0;l<r;++l)i[l]=er(this,e[l],n);return i}return er(this,e,n)}onceInternal(e,n){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let l=0;l<i;++l)r[l]=O_(this,e[l],n)}else r=O_(this,e,n);return n.ol_key=r,r}unInternal(e,n){const r=n.ol_key;if(r)cP(r);else if(Array.isArray(e))for(let i=0,l=e.length;i<l;++i)this.removeEventListener(e[i],n);else this.removeEventListener(e,n)}}vg.prototype.on;vg.prototype.once;vg.prototype.un;function cP(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Hr(t[e]);else Hr(t)}function Zn(){throw new Error("Unimplemented abstract method.")}let dP=0;function tr(t){return t.ol_uid||(t.ol_uid=String(++dP))}class Bv extends cd{constructor(e,n,r){super(e),this.key=n,this.oldValue=r}}class gc extends vg{constructor(e){super(),this.on,this.once,this.un,tr(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new Bv(r,e,n)),r=Nf.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new Bv(r,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,r){const i=this.values_||(this.values_={});if(r)i[e]=n;else{const l=i[e];i[e]=n,l!==n&&this.notify(e,l)}}setProperties(e,n){for(const r in e)this.set(r,e[r],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Sf(this.values_)&&(this.values_=null),n||this.notify(e,r)}}}const Wv={LENGTH:"length"};class Mp extends cd{constructor(e,n,r){super(e),this.element=n,this.index=r}}let Vl=class extends gc{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,r=e.length;n<r;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)e(n[r],r,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Wv.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new Mp(il.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)if(n[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Mp(il.REMOVE,n,e)),n}setAt(e,n){const r=this.getLength();if(e>=r){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const i=this.array_[e];this.array_[e]=n,this.dispatchEvent(new Mp(il.REMOVE,i,e)),this.dispatchEvent(new Mp(il.ADD,n,e))}updateLength_(){this.set(Wv.LENGTH,this.array_.length)}assertUnique_(e,n){const r=this.array_;for(let i=0,l=r.length;i<l;++i)if(r[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}};class U0 extends cd{constructor(e,n,r){super(e),this.map=n,this.frameState=r!==void 0?r:null}}class Zd extends U0{constructor(e,n,r,i,l,c){super(e,n,l),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=c}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const hi={SINGLECLICK:"singleclick",CLICK:Rn.CLICK,DBLCLICK:Rn.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ch=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",uP=Ch.includes("safari")&&!Ch.includes("chrom");uP&&(Ch.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ch));const hP=Ch.includes("webkit")&&!Ch.includes("edge"),B5=Ch.includes("macintosh"),fP=typeof devicePixelRatio<"u"?devicePixelRatio:1,$l=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,W5=typeof Image<"u"&&Image.prototype.decode,F5=(function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t})(),Ty={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class mP extends ox{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=er(r,Ty.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=er(r,Ty.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Rn.TOUCHMOVE,this.boundHandleTouchMove_,F5?{passive:!1}:!1)}emulateClick_(e){let n=new Zd(hi.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new Zd(hi.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Zd(hi.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const n=e,r=n.pointerId;if(n.type==hi.POINTERUP||n.type==hi.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==n.target){delete this.trackedTouches_[i];break}}else(n.type==hi.POINTERDOWN||n.type==hi.POINTERMOVE)&&(this.trackedTouches_[r]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new Zd(hi.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Hr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new Zd(hi.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(er(r,hi.POINTERMOVE,this.handlePointerMove_,this),er(r,hi.POINTERUP,this.handlePointerUp_,this),er(this.element_,hi.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(er(this.element_.getRootNode(),hi.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new Zd(hi.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Zd(hi.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Hr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Rn.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Hr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Hr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const eu={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Da={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},ln={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function dr(t,e){if(!t)throw new Error(e)}const M_=1/0;class gP{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Sg(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,r=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){dr(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=M_?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,r=this.priorities_,i=n.length,l=n[e],c=r[e],d=e;for(;e<i>>1;){const u=this.getLeftChildIndex_(e),f=this.getRightChildIndex_(e),m=f<i&&r[f]<r[u]?f:u;n[e]=n[m],r[e]=r[m],e=m}n[e]=l,r[e]=c,this.siftDown_(d,e)}siftDown_(e,n){const r=this.elements_,i=this.priorities_,l=r[n],c=i[n];for(;n>e;){const d=this.getParentIndex_(n);if(i[d]>c)r[n]=r[d],i[n]=i[d],n=d;else break}r[n]=l,i[n]=c}reprioritize(){const e=this.priorityFunction_,n=this.elements_,r=this.priorities_;let i=0;const l=n.length;let c,d,u;for(d=0;d<l;++d)c=n[d],u=e(c),u==M_?delete this.queuedElements_[this.keyFunction_(c)]:(r[i]=u,n[i++]=c);n.length=i,r.length=i,this.heapify_()}}class pP extends gP{constructor(e,n){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(Rn.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,r=n.getState();if(r===ln.LOADED||r===ln.ERROR||r===ln.EMPTY){r!==ln.ERROR&&n.removeEventListener(Rn.CHANGE,this.boundHandleTileChange_);const i=n.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let r=0;for(;this.tilesLoading_<e&&r<n&&this.getCount()>0;){const i=this.dequeue()[0],l=i.getKey();i.getState()===ln.IDLE&&!(l in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++r,i.load())}}}function _P(t,e,n,r,i){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return M_;const l=t.viewState.center,c=r[0]-l[0],d=r[1]-l[1];return 65536*Math.log(i)+Math.sqrt(c*c+d*d)/i}const Ra={ANIMATING:0,INTERACTING:1},So={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function zr(t,e,n){return Math.min(Math.max(t,e),n)}function xP(t,e,n,r,i,l){const c=i-n,d=l-r;if(c!==0||d!==0){const u=((t-n)*c+(e-r)*d)/(c*c+d*d);u>1?(n=i,r=l):u>0&&(n+=c*u,r+=d*u)}return q0(t,e,n,r)}function q0(t,e,n,r){const i=n-t,l=r-e;return i*i+l*l}function CP(t){const e=t.length;for(let r=0;r<e;r++){let i=r,l=Math.abs(t[r][r]);for(let d=r+1;d<e;d++){const u=Math.abs(t[d][r]);u>l&&(l=u,i=d)}if(l===0)return null;const c=t[i];t[i]=t[r],t[r]=c;for(let d=r+1;d<e;d++){const u=-t[d][r]/t[r][r];for(let f=r;f<e+1;f++)r==f?t[d][f]=0:t[d][f]+=u*t[r][f]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}function Fv(t){return t*180/Math.PI}function _u(t){return t*Math.PI/180}function X0(t,e){const n=t%e;return n*e<0?n+e:n}function Gl(t,e,n){return t+n*(e-t)}function cx(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function Lp(t,e){return Math.floor(cx(t,e))}function wp(t,e){return Math.ceil(cx(t,e))}function Ey(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}function Kv(t,e,n){return(function(r,i,l,c,d){if(!r)return;if(!i&&!e)return r;const u=e?0:l[0]*i,f=e?0:l[1]*i,m=d?d[0]:0,_=d?d[1]:0;let y=t[0]+u/2+m,g=t[2]-u/2+m,N=t[1]+f/2+_,C=t[3]-f/2+_;y>g&&(y=(g+y)/2,g=y),N>C&&(N=(C+N)/2,C=N);let v=zr(r[0],y,g),R=zr(r[1],N,C);if(c&&n&&i){const U=30*i;v+=-U*Math.log(1+Math.max(0,y-r[0])/U)+U*Math.log(1+Math.max(0,r[0]-g)/U),R+=-U*Math.log(1+Math.max(0,N-r[1])/U)+U*Math.log(1+Math.max(0,r[1]-C)/U)}return[v,R]})}function yP(t){return t}const na={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function jy(t){const e=Zl();for(let n=0,r=t.length;n<r;++n)Ym(e,t[n]);return e}function Lb(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function K5(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Q5(t,e,n){let r,i;return e<t[0]?r=t[0]-e:t[2]<e?r=e-t[2]:r=0,n<t[1]?i=t[1]-n:t[3]<n?i=n-t[3]:i=0,r*r+i*i}function vf(t,e){return G5(t,e[0],e[1])}function wm(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function G5(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Iy(t,e){const n=t[0],r=t[1],i=t[2],l=t[3],c=e[0],d=e[1];let u=na.UNKNOWN;return c<n?u=u|na.LEFT:c>i&&(u=u|na.RIGHT),d<r?u=u|na.BELOW:d>l&&(u=u|na.ABOVE),u===na.UNKNOWN&&(u=na.INTERSECTING),u}function Zl(){return[1/0,1/0,-1/0,-1/0]}function bu(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function dx(t){return bu(1/0,1/0,-1/0,-1/0,t)}function Y5(t,e){const n=t[0],r=t[1];return bu(n,r,n,r,e)}function wb(t,e,n,r,i){const l=dx(i);return V5(l,t,e,n,r)}function sg(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function bP(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Ym(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function V5(t,e,n,r,i){for(;n<r;n+=i)NP(t,e[n],e[n+1]);return t}function NP(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function $5(t,e){let n;return n=e(ux(t)),n||(n=e(hx(t)),n)||(n=e(fx(t)),n)||(n=e(Lh(t)),n)?n:!1}function Oy(t){let e=0;return Dg(t)||(e=_r(t)*Ua(t)),e}function ux(t){return[t[0],t[1]]}function hx(t){return[t[2],t[1]]}function yh(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function SP(t,e){let n;if(e==="bottom-left")n=ux(t);else if(e==="bottom-right")n=hx(t);else if(e==="top-left")n=Lh(t);else if(e==="top-right")n=fx(t);else throw new Error("Invalid corner");return n}function My(t,e,n,r,i){const[l,c,d,u,f,m,_,y]=H5(t,e,n,r);return bu(Math.min(l,d,f,_),Math.min(c,u,m,y),Math.max(l,d,f,_),Math.max(c,u,m,y),i)}function H5(t,e,n,r){const i=e*r[0]/2,l=e*r[1]/2,c=Math.cos(n),d=Math.sin(n),u=i*c,f=i*d,m=l*c,_=l*d,y=t[0],g=t[1];return[y-u+_,g-f-m,y-u-_,g-f+m,y+u-_,g+f+m,y+u+_,g+f-m,y-u+_,g-f-m]}function Ua(t){return t[3]-t[1]}function fh(t,e,n){const r=n||Zl();return ol(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):dx(r),r}function Lh(t){return[t[0],t[3]]}function fx(t){return[t[2],t[3]]}function _r(t){return t[2]-t[0]}function ol(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Dg(t){return t[2]<t[0]||t[3]<t[1]}function vP(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function DP(t,e,n){let r=!1;const i=Iy(t,e),l=Iy(t,n);if(i===na.INTERSECTING||l===na.INTERSECTING)r=!0;else{const c=t[0],d=t[1],u=t[2],f=t[3],m=e[0],_=e[1],y=n[0],g=n[1],N=(g-_)/(y-m);let C,v;l&na.ABOVE&&!(i&na.ABOVE)&&(C=y-(g-f)/N,r=C>=c&&C<=u),!r&&l&na.RIGHT&&!(i&na.RIGHT)&&(v=g-(y-u)*N,r=v>=d&&v<=f),!r&&l&na.BELOW&&!(i&na.BELOW)&&(C=y-(g-d)/N,r=C>=c&&C<=u),!r&&l&na.LEFT&&!(i&na.LEFT)&&(v=g-(y-c)*N,r=v>=d&&v<=f)}return r}function z5(t,e){const n=e.getExtent(),r=yh(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const i=_r(n),c=Math.floor((r[0]-n[0])/i)*i;t[0]-=c,t[2]-=c}return t}function q5(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];z5(t,e);const i=_r(r);if(_r(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function RP(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function L_(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function Pb(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,l=t[1]*n+t[0]*r;return t[0]=i,t[1]=l,t}function TP(t,e){return t[0]*=e,t[1]*=e,t}function X5(t,e){if(e.canWrapX()){const n=_r(e.getExtent()),r=EP(t,e,n);r&&(t[0]-=r*n)}return t}function EP(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||_r(r),i=Math.floor((t[0]-r[0])/n)),i}function jP(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),i=[(e[0]-t[0])/r,(e[1]-t[1])/r],l=[-i[1],i[0]],c=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),d=[(n[0]-t[0])/c,(n[1]-t[1])/c];let u=r===0||c===0?0:Math.acos(zr(d[0]*i[0]+d[1]*i[1],-1,1));return u=Math.max(u,1e-5),d[0]*l[0]+d[1]*l[1]>0?u:Math.PI*2-u}function J5(t){return Math.pow(t,3)}function Mf(t){return 1-J5(1-t)}function IP(t){return 3*t*t-2*t*t*t}function OP(t){return t}const MP=63710088e-1;function Qv(t,e,n){n=n||MP;const r=_u(t[1]),i=_u(e[1]),l=(i-r)/2,c=_u(e[0]-t[0])/2,d=Math.sin(l)*Math.sin(l)+Math.sin(c)*Math.sin(c)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}function Z5(...t){console.warn(...t)}const Ab={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class kb{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ab[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Rg=6378137,G0=Math.PI*Rg,LP=[-G0,-G0,G0,G0],wP=[-180,-85,180,85],Pp=Rg*Math.log(Math.tan(Math.PI/2));class S0 extends kb{constructor(e){super({code:e,units:"m",extent:LP,global:!0,worldExtent:wP,getPointResolution:function(n,r){return n/Math.cosh(r[1]/Rg)}})}}const Gv=[new S0("EPSG:3857"),new S0("EPSG:102100"),new S0("EPSG:102113"),new S0("EPSG:900913"),new S0("http://www.opengis.net/def/crs/EPSG/0/3857"),new S0("http://www.opengis.net/gml/srs/epsg.xml#3857")];function PP(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let l=0;l<i;l+=r){e[l]=G0*t[l]/180;let c=Rg*Math.log(Math.tan(Math.PI*(+t[l+1]+90)/360));c>Pp?c=Pp:c<-Pp&&(c=-Pp),e[l+1]=c}return e}function AP(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let l=0;l<i;l+=r)e[l]=180*t[l]/G0,e[l+1]=360*Math.atan(Math.exp(t[l+1]/Rg))/Math.PI-90;return e}const kP=6378137,Yv=[-180,-90,180,90],UP=Math.PI*kP/180;class Gu extends kb{constructor(e,n){super({code:e,units:"degrees",extent:Yv,axisOrientation:n,global:!0,metersPerUnit:UP,worldExtent:Yv})}}const Vv=[new Gu("CRS:84"),new Gu("EPSG:4326","neu"),new Gu("urn:ogc:def:crs:OGC:1.3:CRS84"),new Gu("urn:ogc:def:crs:OGC:2:84"),new Gu("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Gu("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Gu("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ly={};function BP(t){return Ly[t]||Ly[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function WP(t,e){Ly[t]=e}let J0={};function ng(t,e,n){const r=t.getCode(),i=e.getCode();r in J0||(J0[r]={}),J0[r][i]=n}function aC(t,e){return t in J0&&e in J0[t]?J0[t][e]:null}const w_=.9996,Xl=.00669438,mx=Xl*Xl,gx=mx*Xl,eh=Xl/(1-Xl),$v=Math.sqrt(1-Xl),Df=(1-$v)/(1+$v),eE=Df*Df,Ub=eE*Df,Bb=Ub*Df,tE=Bb*Df,sE=1-Xl/4-3*mx/64-5*gx/256,FP=3*Xl/8+3*mx/32+45*gx/1024,KP=15*mx/256+45*gx/1024,QP=35*gx/3072,GP=3/2*Df-27/32*Ub+269/512*tE,YP=21/16*eE-55/32*Bb,VP=151/96*Ub-417/128*tE,$P=1097/512*Bb,P_=6378137;function HP(t,e,n){const r=t-5e5,c=(n.north?e:e-1e7)/w_/(P_*sE),d=c+GP*Math.sin(2*c)+YP*Math.sin(4*c)+VP*Math.sin(6*c)+$P*Math.sin(8*c),u=Math.sin(d),f=u*u,m=Math.cos(d),_=u/m,y=_*_,g=y*y,N=1-Xl*f,C=Math.sqrt(1-Xl*f),v=P_/C,R=(1-Xl)/N,U=eh*m**2,L=U*U,w=r/(v*w_),P=w*w,G=P*w,K=G*w,B=K*w,O=B*w,S=d-_/R*(P/2-K/24*(5+3*y+10*U-4*L-9*eh))+O/720*(61+90*y+298*U+45*g-252*eh-3*L);let A=(w-G/6*(1+2*y+U)+B/120*(5-2*U+28*y-3*L+8*eh+24*g))/m;return A=Ey(A+_u(nE(n.number)),-Math.PI,Math.PI),[Fv(A),Fv(S)]}const Hv=-80,zv=84,zP=-180,qP=180;function XP(t,e,n){t=Ey(t,zP,qP),e<Hv?e=Hv:e>zv&&(e=zv);const r=_u(e),i=Math.sin(r),l=Math.cos(r),c=i/l,d=c*c,u=d*d,f=_u(t),m=nE(n.number),_=_u(m),y=P_/Math.sqrt(1-Xl*i**2),g=eh*l**2,N=l*Ey(f-_,-Math.PI,Math.PI),C=N*N,v=C*N,R=v*N,U=R*N,L=U*N,w=P_*(sE*r-FP*Math.sin(2*r)+KP*Math.sin(4*r)-QP*Math.sin(6*r)),P=w_*y*(N+v/6*(1-d+g)+U/120*(5-18*d+u+72*g-58*eh))+5e5;let G=w_*(w+y*c*(C/2+R/24*(5-d+9*g+4*g**2)+L/720*(61-58*d+u+600*g-330*eh)));return n.north||(G+=1e7),[P,G]}function nE(t){return(t-1)*6-180+3}const JP=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function rE(t){let e=0;for(const i of JP){const l=t.match(i);if(l){e=parseInt(l[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function qv(t,e){return function(n,r,i,l){const c=n.length;i=i>1?i:2,l=l??i,r||(i>2?r=n.slice():r=new Array(c));for(let d=0;d<c;d+=l){const u=n[d],f=n[d+1],m=t(u,f,e);r[d]=m[0],r[d+1]=m[1]}return r}}function ZP(t){return rE(t)?new kb({code:t,units:"m"}):null}function eA(t){const e=rE(t.getCode());return e?{forward:qv(XP,e),inverse:qv(HP,e)}:null}const tA=[eA],sA=[ZP];let wy=!0;function iE(t){wy=!1}function Wb(t,e){if(e!==void 0){for(let n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function Py(t){WP(t.getCode(),t),ng(t,t,Wb)}function nA(t){t.forEach(Py)}function hl(t){if(typeof t!="string")return t;const e=BP(t);if(e)return e;for(const n of sA){const r=n(t);if(r)return r}return null}function Xv(t,e,n,r){t=hl(t);let i;const l=t.getPointResolutionFunc();if(l)i=l(e,n);else{const c=t.getUnits();if(c=="degrees"&&!r||r=="degrees")i=e;else{const d=Kb(t,hl("EPSG:4326"));if(!d&&c!=="degrees")i=e*t.getMetersPerUnit();else{let f=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];f=d(f,f,2);const m=Qv(f.slice(0,2),f.slice(2,4)),_=Qv(f.slice(4,6),f.slice(6,8));i=(m+_)/2}const u=t.getMetersPerUnit();u!==void 0&&(i/=u)}}return i}function Jv(t){nA(t),t.forEach(function(e){t.forEach(function(n){e!==n&&ng(e,n,Wb)})})}function rA(t,e,n,r){t.forEach(function(i){e.forEach(function(l){ng(i,l,n),ng(l,i,r)})})}function Fb(t,e){return t?typeof t=="string"?hl(t):t:hl(e)}function iA(t){return(function(e,n,r,i){const l=e.length;r=r!==void 0?r:2,i=i??r,n=n!==void 0?n:new Array(l);for(let c=0;c<l;c+=i){const d=t(e.slice(c,c+r)),u=d.length;for(let f=0,m=i;f<m;++f)n[c+f]=f>=u?e[c+f]:d[f]}return n})}function kc(t,e){return iE(),Qb(t,"EPSG:4326","EPSG:3857")}function c_(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Kb(t,e)===Wb)&&n}function Kb(t,e){const n=t.getCode(),r=e.getCode();let i=aC(n,r);if(i)return i;let l=null,c=null;for(const u of tA)l||(l=u(t)),c||(c=u(e));if(!l&&!c)return null;const d="EPSG:4326";if(c)if(l)i=lC(l.inverse,c.forward);else{const u=aC(n,d);u&&(i=lC(u,c.forward))}else{const u=aC(d,r);u&&(i=lC(l.inverse,u))}return i&&(Py(t),Py(e),ng(t,e,i)),i}function lC(t,e){return function(n,r,i,l){return r=t(n,r,i,l),e(r,r,i,l)}}function A_(t,e){const n=hl(t),r=hl(e);return Kb(n,r)}function Qb(t,e,n){const r=A_(e,n);if(!r){const i=hl(e).getCode(),l=hl(n).getCode();throw new Error(`No transform available between ${i} and ${l}`)}return r(t,void 0,t.length)}function Ay(t,e){return t}function Gc(t,e){return wy&&!L_(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(wy=!1,Z5("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function aE(t,e){return t}function uu(t,e){return t}function aA(){Jv(Gv),Jv(Vv),rA(Vv,Gv,PP,AP)}aA();new Array(6);function Io(){return[1,0,0,1,0,0]}function lA(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function ra(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function id(t,e,n,r,i,l,c,d){const u=Math.sin(l),f=Math.cos(l);return t[0]=r*f,t[1]=i*u,t[2]=-r*u,t[3]=i*f,t[4]=c*r*f-d*r*u+e,t[5]=c*i*u+d*i*f+n,t}function lE(t,e){const n=oA(e);dr(n!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],l=e[2],c=e[3],d=e[4],u=e[5];return t[0]=c/n,t[1]=-i/n,t[2]=-l/n,t[3]=r/n,t[4]=(l*u-c*d)/n,t[5]=-(r*u-i*d)/n,t}function oA(t){return t[0]*t[3]-t[1]*t[2]}const cA=[1e5,1e5,1e5,1e5,2,2];function dA(t){return"matrix("+t.join(", ")+")"}function ky(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function uA(t,e){const n=ky(t),r=ky(e);for(let i=0;i<6;++i)if(Math.round((n[i]-r[i])*cA[i])!==0)return!1;return!0}function xu(t,e,n,r,i,l,c){l=l||[],c=c||2;let d=0;for(let u=e;u<n;u+=r){const f=t[u],m=t[u+1];l[d++]=i[0]*f+i[2]*m+i[4],l[d++]=i[1]*f+i[3]*m+i[5];for(let _=2;_<c;_++)l[d++]=t[u+_]}return l&&l.length!=d&&(l.length=d),l}function oE(t,e,n,r,i,l,c){c=c||[];const d=Math.cos(i),u=Math.sin(i),f=l[0],m=l[1];let _=0;for(let y=e;y<n;y+=r){const g=t[y]-f,N=t[y+1]-m;c[_++]=f+g*d-N*u,c[_++]=m+g*u+N*d;for(let C=y+2;C<y+r;++C)c[_++]=t[C]}return c&&c.length!=_&&(c.length=_),c}function hA(t,e,n,r,i,l,c,d){d=d||[];const u=c[0],f=c[1];let m=0;for(let _=e;_<n;_+=r){const y=t[_]-u,g=t[_+1]-f;d[m++]=u+i*y,d[m++]=f+l*g;for(let N=_+2;N<_+r;++N)d[m++]=t[N]}return d&&d.length!=m&&(d.length=m),d}function fA(t,e,n,r,i,l,c){c=c||[];let d=0;for(let u=e;u<n;u+=r){c[d++]=t[u]+i,c[d++]=t[u+1]+l;for(let f=u+2;f<u+r;++f)c[d++]=t[f]}return c&&c.length!=d&&(c.length=d),c}const Zv=Io(),mA=[NaN,NaN];class gA extends gc{constructor(){super(),this.extent_=Zl(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=U5((e,n,r)=>{if(!r)return this.getSimplifiedGeometry(n);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return Zn()}closestPointXY(e,n,r,i){return Zn()}containsXY(e,n){return this.closestPointXY(e,n,mA,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Zn()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&dx(n),this.extentRevision_=this.getRevision()}return vP(this.extent_,e)}rotate(e,n){Zn()}scale(e,n,r){Zn()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Zn()}getType(){return Zn()}applyTransform(e){Zn()}intersectsExtent(e){return Zn()}translate(e,n){Zn()}transform(e,n){const r=hl(e),i=r.getUnits()=="tile-pixels"?function(l,c,d){const u=r.getExtent(),f=r.getWorldExtent(),m=Ua(f)/Ua(u);id(Zv,f[0],f[3],m,-m,0,0,0);const _=xu(l,0,l.length,d,Zv,c),y=A_(r,n);return y?y(_,_,d):_}:A_(r,n);return this.applyTransform(i),this}}class Gb extends gA{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return wb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Zn()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=eD(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){Zn()}setLayout(e,n,r){let i;if(e)i=eD(e);else{for(let l=0;l<r;++l){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}i=n.length,e=pA(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();oE(r,0,r.length,i,e,n,r),this.changed()}}scale(e,n,r){n===void 0&&(n=e),r||(r=yh(this.getExtent()));const i=this.getFlatCoordinates();if(i){const l=this.getStride();hA(i,0,i.length,l,e,n,r,i),this.changed()}}translate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();fA(r,0,r.length,i,e,n,r),this.changed()}}}function pA(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function eD(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function _A(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return xu(r,0,r.length,i,e,n)}function cE(t,e,n,r){let i=0;const l=t[n-r],c=t[n-r+1];let d=0,u=0;for(;e<n;e+=r){const f=t[e]-l,m=t[e+1]-c;i+=u*f-d*m,d=f,u=m}return i/2}function xA(t,e,n,r){let i=0;for(let l=0,c=n.length;l<c;++l){const d=n[l];i+=cE(t,e,d,r),e=d}return i}function tD(t,e,n,r,i,l,c){const d=t[e],u=t[e+1],f=t[n]-d,m=t[n+1]-u;let _;if(f===0&&m===0)_=e;else{const y=((i-d)*f+(l-u)*m)/(f*f+m*m);if(y>1)_=n;else if(y>0){for(let g=0;g<r;++g)c[g]=Gl(t[e+g],t[n+g],y);c.length=r;return}else _=e}for(let y=0;y<r;++y)c[y]=t[_+y];c.length=r}function dE(t,e,n,r,i){let l=t[e],c=t[e+1];for(e+=r;e<n;e+=r){const d=t[e],u=t[e+1],f=q0(l,c,d,u);f>i&&(i=f),l=d,c=u}return i}function CA(t,e,n,r,i){for(let l=0,c=n.length;l<c;++l){const d=n[l];i=dE(t,e,d,r,i),e=d}return i}function uE(t,e,n,r,i,l,c,d,u,f,m){if(e==n)return f;let _,y;if(i===0){if(y=q0(c,d,t[e],t[e+1]),y<f){for(_=0;_<r;++_)u[_]=t[e+_];return u.length=r,y}return f}m=m||[NaN,NaN];let g=e+r;for(;g<n;)if(tD(t,g-r,g,r,c,d,m),y=q0(c,d,m[0],m[1]),y<f){for(f=y,_=0;_<r;++_)u[_]=m[_];u.length=r,g+=r}else g+=r*Math.max((Math.sqrt(y)-Math.sqrt(f))/i|0,1);if(tD(t,n-r,e,r,c,d,m),y=q0(c,d,m[0],m[1]),y<f){for(f=y,_=0;_<r;++_)u[_]=m[_];u.length=r}return f}function yA(t,e,n,r,i,l,c,d,u,f,m){m=m||[NaN,NaN];for(let _=0,y=n.length;_<y;++_){const g=n[_];f=uE(t,e,g,r,i,l,c,d,u,f,m),e=g}return f}function bA(t,e,n,r){for(let i=0,l=n.length;i<l;++i)t[e++]=n[i];return e}function hE(t,e,n,r){for(let i=0,l=n.length;i<l;++i){const c=n[i];for(let d=0;d<r;++d)t[e++]=c[d]}return e}function NA(t,e,n,r,i){i=i||[];let l=0;for(let c=0,d=n.length;c<d;++c){const u=hE(t,e,n[c],r);i[l++]=u,e=u}return i.length=l,i}function Y0(t,e,n,r,i){i=i!==void 0?i:[];let l=0;for(let c=e;c<n;c+=r)i[l++]=t.slice(c,c+r);return i.length=l,i}function k_(t,e,n,r,i){i=i!==void 0?i:[];let l=0;for(let c=0,d=n.length;c<d;++c){const u=n[c];i[l++]=Y0(t,e,u,r,i[l]),e=u}return i.length=l,i}function sD(t,e,n,r,i){i=i!==void 0?i:[];let l=0;for(let c=0,d=n.length;c<d;++c){const u=n[c];i[l++]=u.length===1&&u[0]===e?[]:k_(t,e,u,r,i[l]),e=u[u.length-1]}return i.length=l,i}function Yb(t,e,n,r,i,l,c){const d=(n-e)/r;if(d<3){for(;e<n;e+=r)l[c++]=t[e],l[c++]=t[e+1];return c}const u=new Array(d);u[0]=1,u[d-1]=1;const f=[e,n-r];let m=0;for(;f.length>0;){const _=f.pop(),y=f.pop();let g=0;const N=t[y],C=t[y+1],v=t[_],R=t[_+1];for(let U=y+r;U<_;U+=r){const L=t[U],w=t[U+1],P=xP(L,w,N,C,v,R);P>g&&(m=U,g=P)}g>i&&(u[(m-e)/r]=1,y+r<m&&f.push(y,m),m+r<_&&f.push(m,_))}for(let _=0;_<d;++_)u[_]&&(l[c++]=t[e+_*r],l[c++]=t[e+_*r+1]);return c}function SA(t,e,n,r,i,l,c,d){for(let u=0,f=n.length;u<f;++u){const m=n[u];c=Yb(t,e,m,r,i,l,c),d.push(c),e=m}return c}function Hu(t,e){return e*Math.round(t/e)}function vA(t,e,n,r,i,l,c){if(e==n)return c;let d=Hu(t[e],i),u=Hu(t[e+1],i);e+=r,l[c++]=d,l[c++]=u;let f,m;do if(f=Hu(t[e],i),m=Hu(t[e+1],i),e+=r,e==n)return l[c++]=f,l[c++]=m,c;while(f==d&&m==u);for(;e<n;){const _=Hu(t[e],i),y=Hu(t[e+1],i);if(e+=r,_==f&&y==m)continue;const g=f-d,N=m-u,C=_-d,v=y-u;if(g*v==N*C&&(g<0&&C<g||g==C||g>0&&C>g)&&(N<0&&v<N||N==v||N>0&&v>N)){f=_,m=y;continue}l[c++]=f,l[c++]=m,d=f,u=m,f=_,m=y}return l[c++]=f,l[c++]=m,c}function fE(t,e,n,r,i,l,c,d){for(let u=0,f=n.length;u<f;++u){const m=n[u];c=vA(t,e,m,r,i,l,c),d.push(c),e=m}return c}class rg extends Gb{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new rg(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,r,i){return i<Q5(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(dE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),uE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,r,i))}getArea(){return cE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Y0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=Yb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new rg(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=hE(this.flatCoordinates,0,e,this.stride),this.changed()}}class Z0 extends Gb{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new Z0(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const l=this.flatCoordinates,c=q0(e,n,l[0],l[1]);if(c<i){const d=this.stride;for(let u=0;u<d;++u)r[u]=l[u];return r.length=d,c}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Y5(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return G5(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bA(this.flatCoordinates,0,e,this.stride),this.changed()}}function DA(t,e,n,r,i){return!$5(i,function(c){return!th(t,e,n,r,c[0],c[1])})}function th(t,e,n,r,i,l){let c=0,d=t[n-r],u=t[n-r+1];for(;e<n;e+=r){const f=t[e],m=t[e+1];u<=l?m>l&&(f-d)*(l-u)-(i-d)*(m-u)>0&&c++:m<=l&&(f-d)*(l-u)-(i-d)*(m-u)<0&&c--,d=f,u=m}return c!==0}function mE(t,e,n,r,i,l){if(n.length===0||!th(t,e,n[0],r,i,l))return!1;for(let c=1,d=n.length;c<d;++c)if(th(t,n[c-1],n[c],r,i,l))return!1;return!0}function Vb(t,e,n,r,i,l,c){let d,u,f,m,_,y,g;const N=i[l+1],C=[];for(let U=0,L=n.length;U<L;++U){const w=n[U];for(m=t[w-r],y=t[w-r+1],d=e;d<w;d+=r)_=t[d],g=t[d+1],(N<=y&&g<=N||y<=N&&N<=g)&&(f=(N-y)/(g-y)*(_-m)+m,C.push(f)),m=_,y=g}let v=NaN,R=-1/0;for(C.sort(Jc),m=C[0],d=1,u=C.length;d<u;++d){_=C[d];const U=Math.abs(_-m);U>R&&(f=(m+_)/2,mE(t,e,n,r,f,N)&&(v=f,R=U)),m=_}return isNaN(v)&&(v=i[l]),c?(c.push(v,N,R),c):[v,N,R]}function RA(t,e,n,r,i){let l=[];for(let c=0,d=n.length;c<d;++c){const u=n[c];l=Vb(t,e,u,r,i,2*c,l),e=u[u.length-1]}return l}function TA(t,e,n,r,i){let l;for(e+=r;e<n;e+=r)if(l=i(t.slice(e-r,e),t.slice(e,e+r)),l)return l;return!1}function gE(t,e,n,r,i,l){return l=l??V5(Zl(),t,e,n,r),ol(i,l)?l[0]>=i[0]&&l[2]<=i[2]||l[1]>=i[1]&&l[3]<=i[3]?!0:TA(t,e,n,r,function(c,d){return DP(i,c,d)}):!1}function pE(t,e,n,r,i){return!!(gE(t,e,n,r,i)||th(t,e,n,r,i[0],i[1])||th(t,e,n,r,i[0],i[3])||th(t,e,n,r,i[2],i[1])||th(t,e,n,r,i[2],i[3]))}function EA(t,e,n,r,i){if(!pE(t,e,n[0],r,i))return!1;if(n.length===1)return!0;for(let l=1,c=n.length;l<c;++l)if(DA(t,n[l-1],n[l],r,i)&&!gE(t,n[l-1],n[l],r,i))return!1;return!0}function jA(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const l=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=l}e+=r,n-=r}}function $b(t,e,n,r){let i=0,l=t[n-r],c=t[n-r+1];for(;e<n;e+=r){const d=t[e],u=t[e+1];i+=(d-l)*(u+c),l=d,c=u}return i===0?void 0:i>0}function IA(t,e,n,r,i){i=i!==void 0?i:!1;for(let l=0,c=n.length;l<c;++l){const d=n[l],u=$b(t,e,d,r);if(l===0){if(i&&u||!i&&!u)return!1}else if(i&&!u||!i&&u)return!1;e=d}return!0}function nD(t,e,n,r,i){i=i!==void 0?i:!1;for(let l=0,c=n.length;l<c;++l){const d=n[l],u=$b(t,e,d,r);(l===0?i&&u||!i&&!u:i&&!u||!i&&u)&&jA(t,e,d,r),e=d}return e}function OA(t,e){const n=[];let r=0,i=0,l;for(let c=0,d=e.length;c<d;++c){const u=e[c],f=$b(t,r,u,2);if(l===void 0&&(l=f),f===l)n.push(e.slice(i,c+1));else{if(n.length===0)continue;n[n.length-1].push(e[i])}i=c+1,r=u}return n}class ig extends Gb{constructor(e,n,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&r?(this.setFlatCoordinates(n,e),this.ends_=r):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?Mb(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ig(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<Q5(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(CA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return mE(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return xA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),nD(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,k_(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=yh(this.getExtent());this.flatInteriorPoint_=Vb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Z0(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new rg(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,r=this.ends_,i=[];let l=0;for(let c=0,d=r.length;c<d;++c){const u=r[c],f=new rg(n.slice(l,u),e);i.push(f),l=u}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;IA(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=nD(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=fE(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,r),new ig(n,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return EA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=NA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function rD(t){if(Dg(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],l=[e,n,e,i,r,i,r,n,e,n];return new ig(l,"XY",[l.length])}function Hb(t,e,n,r){const i=_r(e)/n[0],l=Ua(e)/n[1];return r?Math.min(t,Math.max(i,l)):Math.min(t,Math.min(i,l))}function zb(t,e,n){let r=Math.min(t,e);const i=50;return r*=Math.log(1+i*Math.max(0,t/e-1))/i+1,n&&(r=Math.max(r,n),r/=Math.log(1+i*Math.max(0,n/t-1))/i+1),zr(r,n/2,e*2)}function MA(t,e,n,r){return e=e!==void 0?e:!0,(function(i,l,c,d){if(i!==void 0){const u=t[0],f=t[t.length-1],m=n?Hb(u,n,c,r):u;if(d)return e?zb(i,m,f):zr(i,f,m);const _=Math.min(m,i),y=Math.floor(Ob(t,_,l));return t[y]>m&&y<t.length-1?t[y+1]:t[y]}})}function LA(t,e,n,r,i,l){return r=r!==void 0?r:!0,n=n!==void 0?n:0,(function(c,d,u,f){if(c!==void 0){const m=i?Hb(e,i,u,l):e;if(f)return r?zb(c,m,n):zr(c,n,m);const _=1e-9,y=Math.ceil(Math.log(e/m)/Math.log(t)-_),g=-d*(.5-_)+.5,N=Math.min(m,c),C=Math.floor(Math.log(e/N)/Math.log(t)+g),v=Math.max(y,C),R=e/Math.pow(t,v);return zr(R,n,m)}})}function iD(t,e,n,r,i){return n=n!==void 0?n:!0,(function(l,c,d,u){if(l!==void 0){const f=r?Hb(t,r,d,i):t;return!n||!u?zr(l,e,f):zb(l,f,e)}})}function qb(t){if(t!==void 0)return 0}function aD(t){if(t!==void 0)return t}function wA(t){const e=2*Math.PI/t;return(function(n,r){if(r)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n})}function PA(t){const e=_u(5);return(function(n,r){return r||n===void 0?n:Math.abs(n)<=e?0:n})}const AA=42,Xb=256,oC=0;class ic extends gc{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Fb(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&iE(),e.center&&(e.center=Gc(e.center,this.projection_)),e.extent&&(e.extent=uu(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const d in So)delete n[d];this.setProperties(n,!0);const r=UA(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=kA(e),l=r.constraint,c=BA(e);this.constraints_={center:i,resolution:l,rotation:c},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];n=n||[0,0,0,0];const l=this.getResolution(),c=l/2*(i[3]-n[3]+n[1]-i[1]),d=l/2*(i[0]-n[0]+n[2]-i[2]);this.setCenterInternal([r[0]+c,r[1]-d])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let r=0;r<n.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Gc(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Gc(i.anchor,this.getProjection())),n[r]=i}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const m=arguments[i];m.center&&this.setCenterInternal(m.center),m.zoom!==void 0?this.setZoom(m.zoom):m.resolution&&this.setResolution(m.resolution),m.rotation!==void 0&&this.setRotation(m.rotation)}if(i===n){r&&Ap(r,!0);return}let l=Date.now(),c=this.targetCenter_.slice(),d=this.targetResolution_,u=this.targetRotation_;const f=[];for(;i<n;++i){const m=arguments[i],_={start:l,complete:!1,anchor:m.anchor,duration:m.duration!==void 0?m.duration:1e3,easing:m.easing||IP,callback:r};if(m.center&&(_.sourceCenter=c,_.targetCenter=m.center.slice(),c=_.targetCenter),m.zoom!==void 0?(_.sourceResolution=d,_.targetResolution=this.getResolutionForZoom(m.zoom),d=_.targetResolution):m.resolution&&(_.sourceResolution=d,_.targetResolution=m.resolution,d=_.targetResolution),m.rotation!==void 0){_.sourceRotation=u;const y=X0(m.rotation-u+Math.PI,2*Math.PI)-Math.PI;_.targetRotation=u+y,u=_.targetRotation}WA(_)?_.complete=!0:l+=_.duration,f.push(_)}this.animations_.push(f),this.setHint(Ra.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ra.ANIMATING]>0}getInteracting(){return this.hints_[Ra.INTERACTING]>0}cancelAnimations(){this.setHint(Ra.ANIMATING,-this.hints_[Ra.ANIMATING]);let e;for(let n=0,r=this.animations_.length;n<r;++n){const i=this.animations_[n];if(i[0].callback&&Ap(i[0].callback,!1),!e)for(let l=0,c=i.length;l<c;++l){const d=i[l];if(!d.complete){e=d.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let l=!0;for(let c=0,d=i.length;c<d;++c){const u=i[c];if(u.complete)continue;const f=e-u.start;let m=u.duration>0?f/u.duration:1;m>=1?(u.complete=!0,m=1):l=!1;const _=u.easing(m);if(u.sourceCenter){const y=u.sourceCenter[0],g=u.sourceCenter[1],N=u.targetCenter[0],C=u.targetCenter[1];this.nextCenter_=u.targetCenter;const v=y+_*(N-y),R=g+_*(C-g);this.targetCenter_=[v,R]}if(u.sourceResolution&&u.targetResolution){const y=_===1?u.targetResolution:u.sourceResolution+_*(u.targetResolution-u.sourceResolution);if(u.anchor){const g=this.getViewportSize_(this.getRotation()),N=this.constraints_.resolution(y,0,g,!0);this.targetCenter_=this.calculateCenterZoom(N,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=_===1?X0(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+_*(u.targetRotation-u.sourceRotation);if(u.anchor){const g=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(g,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),n=!0,!u.complete)break}if(l){this.animations_[r]=null,this.setHint(Ra.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const c=i[0].callback;c&&Ap(c,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-n[0],i[1]-n[1]],Pb(r,e-this.getRotation()),RP(r,n)),r}calculateCenterZoom(e,n){let r;const i=this.getCenterInternal(),l=this.getResolution();if(i!==void 0&&l!==void 0){const c=n[0]-e*(n[0]-i[0])/l,d=n[1]-e*(n[1]-i[1])/l;r=[c,d]}return r}getViewportSize_(e){const n=this.viewportSize_;if(e){const r=n[0],i=n[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Ay(e,this.getProjection())}getCenterInternal(){return this.get(So.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return aE(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();dr(n,"The view center is not defined");const r=this.getResolution();dr(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return dr(i!==void 0,"The view rotation is not defined"),My(n,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(So.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(uu(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const r=_r(e)/n[0],i=Ua(e)/n[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return(function(l){return n/Math.pow(e,l*i)})}getRotation(){return this.get(So.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,l=Math.log(r/i)/n;return(function(c){return Math.log(r/c)/n/l})}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const l=this.padding_;if(l){const c=this.getViewportSizeMinusPadding_();i=cC(i,this.getViewportSize_(),[c[0]/2+l[3],c[1]/2+l[0]],n,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,r,i;if(this.resolutions_){const l=Ob(this.resolutions_,e,1);n=l,r=this.resolutions_[l],l==this.resolutions_.length-1?i=2:i=r/this.resolutions_[l+1]}else r=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){var n;if((n=this.resolutions_)!=null&&n.length){if(this.resolutions_.length===1)return this.resolutions_[0];const r=zr(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[r]/this.resolutions_[r+1];return this.resolutions_[r]/Math.pow(i,zr(e-r,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let r;if(dr(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){dr(!Dg(e),"Cannot fit empty extent provided as `geometry`");const i=uu(e,this.getProjection());r=rD(i)}else if(e.getType()==="Circle"){const i=uu(e.getExtent(),this.getProjection());r=rD(i),r.rotate(this.getRotation(),yh(i))}else r=e;this.fitInternal(r,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),r=Math.cos(n),i=Math.sin(-n),l=e.getFlatCoordinates(),c=e.getStride();let d=1/0,u=1/0,f=-1/0,m=-1/0;for(let _=0,y=l.length;_<y;_+=c){const g=l[_]*r-l[_+1]*i,N=l[_]*i+l[_+1]*r;d=Math.min(d,g),u=Math.min(u,N),f=Math.max(f,g),m=Math.max(m,N)}return[d,u,f,m]}fitInternal(e,n){n=n||{};let r=n.size;r||(r=this.getViewportSizeMinusPadding_());const i=n.padding!==void 0?n.padding:[0,0,0,0],l=n.nearest!==void 0?n.nearest:!1;let c;n.minResolution!==void 0?c=n.minResolution:n.maxZoom!==void 0?c=this.getResolutionForZoom(n.maxZoom):c=0;const d=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(d,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);u=isNaN(u)?c:Math.max(u,c),u=this.getConstrainedResolution(u,l?0:1);const f=this.getRotation(),m=Math.sin(f),_=Math.cos(f),y=yh(d);y[0]+=(i[1]-i[3])/2*u,y[1]+=(i[0]-i[2])/2*u;const g=y[0]*_-y[1]*m,N=y[1]*_+y[0]*m,C=this.getConstrainedCenter([g,N],u),v=n.callback?n.callback:tg;n.duration!==void 0?this.animateInternal({resolution:u,center:C,duration:n.duration,easing:n.easing},v):(this.targetResolution_=u,this.targetCenter_=C,this.applyTargetState_(!1,!0),Ap(v,!0))}centerOn(e,n,r){this.centerOnInternal(Gc(e,this.getProjection()),n,r)}centerOnInternal(e,n,r){this.setCenterInternal(cC(e,n,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,r,i){let l;const c=this.padding_;if(c&&e){const d=this.getViewportSizeMinusPadding_(-r),u=cC(e,i,[d[0]/2+c[3],d[1]/2+c[0]],n,r);l=[e[0]-u[0],e[1]-u[1]]}return l}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=Ay(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&Gc(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),l=this.constraints_.resolution(this.targetResolution_*e,0,i,r);n&&(this.targetCenter_=this.calculateCenterZoom(l,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=Gc(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);n&&(this.targetCenter_=this.calculateCenterRotate(i,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Gc(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const r=this.getAnimating()||this.getInteracting()||n,i=this.constraints_.rotation(this.targetRotation_,r),l=this.getViewportSize_(i),c=this.constraints_.resolution(this.targetResolution_,0,l,r),d=this.constraints_.center(this.targetCenter_,c,l,r,this.calculateCenterShift(this.targetCenter_,c,i,l));this.get(So.ROTATION)!==i&&this.set(So.ROTATION,i),this.get(So.RESOLUTION)!==c&&(this.set(So.RESOLUTION,c),this.set("zoom",this.getZoom(),!0)),(!d||!this.get(So.CENTER)||!L_(this.get(So.CENTER),d))&&this.set(So.CENTER,d),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,r){e=e!==void 0?e:200;const i=n||0,l=this.constraints_.rotation(this.targetRotation_),c=this.getViewportSize_(l),d=this.constraints_.resolution(this.targetResolution_,i,c),u=this.constraints_.center(this.targetCenter_,d,c,!1,this.calculateCenterShift(this.targetCenter_,d,l,c));if(e===0&&!this.cancelAnchor_){this.targetResolution_=d,this.targetRotation_=l,this.targetCenter_=u,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==d||this.getRotation()!==l||!this.getCenterInternal()||!L_(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:l,center:u,resolution:d,duration:e,easing:Mf,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ra.INTERACTING,1)}endInteraction(e,n,r){r=r&&Gc(r,this.getProjection()),this.endInteractionInternal(e,n,r)}endInteractionInternal(e,n,r){this.getInteracting()&&(this.setHint(Ra.INTERACTING,-1),this.resolveConstraints(e,n,r))}getConstrainedCenter(e,n){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),r)}getConstrainedZoom(e,n){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,n))}getConstrainedResolution(e,n){n=n||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,r)}}function Ap(t,e){setTimeout(function(){t(e)},0)}function kA(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return Kv(t.extent,t.constrainOnlyCenter,n)}const e=Fb(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,Kv(n,!1,!1)}return yP}function UA(t){let e,n,r,c=t.minZoom!==void 0?t.minZoom:oC,d=t.maxZoom!==void 0?t.maxZoom:28;const u=t.zoomFactor!==void 0?t.zoomFactor:2,f=t.multiWorld!==void 0?t.multiWorld:!1,m=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,_=t.showFullExtent!==void 0?t.showFullExtent:!1,y=Fb(t.projection,"EPSG:3857"),g=y.getExtent();let N=t.constrainOnlyCenter,C=t.extent;if(!f&&!C&&y.isGlobal()&&(N=!1,C=g),t.resolutions!==void 0){const v=t.resolutions;n=v[c],r=v[d]!==void 0?v[d]:v[v.length-1],t.constrainResolution?e=MA(v,m,!N&&C,_):e=iD(n,r,m,!N&&C,_)}else{const R=(g?Math.max(_r(g),Ua(g)):360*Ab.degrees/y.getMetersPerUnit())/Xb/Math.pow(2,oC),U=R/Math.pow(2,28-oC);n=t.maxResolution,n!==void 0?c=0:n=R/Math.pow(u,c),r=t.minResolution,r===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?r=n/Math.pow(u,d):r=R/Math.pow(u,d):r=U),d=c+Math.floor(Math.log(n/r)/Math.log(u)),r=n/Math.pow(u,d-c),t.constrainResolution?e=LA(u,n,r,m,!N&&C,_):e=iD(n,r,m,!N&&C,_)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:c,zoomFactor:u}}function BA(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?PA():n===!1?aD:typeof n=="number"?wA(n):aD}return qb}function WA(t){return!(t.sourceCenter&&t.targetCenter&&!L_(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function cC(t,e,n,r,i){const l=Math.cos(-i);let c=Math.sin(-i),d=t[0]*l-t[1]*c,u=t[1]*l+t[0]*c;d+=(e[0]/2-n[0])*r,u+=(n[1]-e[1]/2)*r,c=-c;const f=d*l-u*c,m=u*l+d*c;return[f,m]}const kp="ol-hidden",px="ol-unselectable",Jb="ol-control",lD="ol-collapsed",FA=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),oD=["style","variant","weight","size","lineHeight","family"],Uy={normal:400,bold:700},By=function(t){const e=t.match(FA);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=oD.length;r<i;++r){const l=e[r+1];l!==void 0&&(n[oD[r]]=typeof l=="string"?l.trim():l)}return isNaN(Number(n.weight))&&n.weight in Uy&&(n.weight=Uy[n.weight]),n.families=n.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),n};function Ii(t,e,n,r){let i;return n&&n.length?i=n.shift():$l?i=new class extends OffscreenCanvas{constructor(){super(...arguments);lr(this,"style",{})}}(t??300,e??150):i=document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let dC;function U_(){return dC||(dC=Ii(1,1)),dC}function _x(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function cD(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function KA(t){for(;t.lastChild;)t.lastChild.remove()}function QA(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],l=e[r];if(!i&&!l)break;if(i!==l){if(!i){t.appendChild(l);continue}if(!l){t.removeChild(i),--r;continue}t.insertBefore(l,i)}}}function _E(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,n,r){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,r)}})}function hu(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}class Zb extends gc{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var n;this.map_&&((n=this.element)==null||n.remove());for(let r=0,i=this.listenerKeys.length;r<i;++r)Hr(this.listenerKeys[r]);if(this.listenerKeys.length=0,this.map_=e,e){const r=this.target_??e.getOverlayContainerStopEvent();this.element&&r.appendChild(this.element),this.render!==tg&&this.listenerKeys.push(er(e,eu.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class GA extends Zb{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:n+"-expand",l=e.collapseLabel!==void 0?e.collapseLabel:"",c=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof l=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=l,this.collapseLabel_.className=c):this.collapseLabel_=l;const d=e.label!==void 0?e.label:"i";typeof d=="string"?(this.label_=document.createElement("span"),this.label_.textContent=d,this.label_.className=i):this.label_=d;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Rn.CLICK,this.handleClick_.bind(this),!1);const f=n+" "+px+" "+Jb+(this.collapsed_&&this.collapsible_?" "+lD:"")+(this.collapsible_?"":" ol-uncollapsible"),m=this.element;m.className=f,m.appendChild(this.toggleButton_),m.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),r=new Set(n.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!n.some(l=>{var c;return((c=l.getSource())==null?void 0:c.getAttributionsCollapsible())===!1});this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(i=>oP(()=>i))),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Du(n,this.renderedAttributions_)){KA(this.ulElement_);for(let i=0,l=n.length;i<l;++i){const c=document.createElement("li");c.innerHTML=n[i],this.ulElement_.appendChild(c)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(lD),this.collapsed_?cD(this.collapseLabel_,this.label_):cD(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class YA extends Zb{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const l=e.tipLabel?e.tipLabel:"Reset rotation",c=document.createElement("button");c.className=n+"-reset",c.setAttribute("type","button"),c.title=l,c.appendChild(this.label_),c.addEventListener(Rn.CLICK,this.handleClick_.bind(this),!1);const d=n+" "+px+" "+Jb,u=this.element;u.className=d,u.appendChild(c),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(kp)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:Mf}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const r=n.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const l=this.element.classList.contains(kp);!l&&r===0?this.element.classList.add(kp):l&&r!==0&&this.element.classList.remove(kp)}this.label_.style.transform=i}this.rotation_=r}}class VA extends Zb{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",l=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",c=e.zoomInLabel!==void 0?e.zoomInLabel:"+",d=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",f=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",m=document.createElement("button");m.className=i,m.setAttribute("type","button"),m.title=u,m.appendChild(typeof c=="string"?document.createTextNode(c):c),m.addEventListener(Rn.CLICK,this.handleClick_.bind(this,r),!1);const _=document.createElement("button");_.className=l,_.setAttribute("type","button"),_.title=f,_.appendChild(typeof d=="string"?document.createTextNode(d):d),_.addEventListener(Rn.CLICK,this.handleClick_.bind(this,-r),!1);const y=n+" "+px+" "+Jb,g=this.element;g.className=y,g.appendChild(m),g.appendChild(_),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const l=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:l,duration:this.duration_,easing:Mf})):r.setZoom(l)}}}function $A(t){t=t||{};const e=new Vl;return(t.zoom!==void 0?t.zoom:!0)&&e.push(new VA(t.zoomOptions)),(t.rotate!==void 0?t.rotate:!0)&&e.push(new YA(t.rotateOptions)),(t.attribution!==void 0?t.attribution:!0)&&e.push(new GA(t.attributionOptions)),e}class HA{constructor(e,n,r){this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let r=n-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[n+2]-this.points_[r+2];if(i<1e3/60)return!1;const l=this.points_[n]-this.points_[r],c=this.points_[n+1]-this.points_[r+1];return this.angle_=Math.atan2(c,l),this.initialVelocity_=Math.sqrt(l*l+c*c)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const dD={ACTIVE:"active"};class Tg extends gc{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(dD.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(dD.ACTIVE,e)}setMap(e){this.map_=e}}function zA(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:OP,center:t.getConstrainedCenter(i)})}}function eN(t,e,n,r){const i=t.getZoom();if(i===void 0)return;const l=t.getConstrainedZoom(i+e),c=t.getResolutionForZoom(l);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:c,anchor:n,duration:r!==void 0?r:250,easing:Mf})}class qA extends Tg{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==hi.DBLCLICK){const r=e.originalEvent,i=e.map,l=e.coordinate,c=r.shiftKey?-this.delta_:this.delta_,d=i.getView();eN(d,c,l,this.duration_),r.preventDefault(),n=!0}return!n}}function Wy(t){const e=arguments;return function(n){let r=!0;for(let i=0,l=e.length;i<l&&(r=r&&e[i](n),!!r);++i);return r}}const XA=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},JA=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)},xE=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?JA(t):!0},ZA=eg,CE=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(hP&&B5&&e.ctrlKey)},yE=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},e6=function(t){const e=t.originalEvent;return B5?e.metaKey:e.ctrlKey},t6=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},bE=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},uC=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},s6=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Eg extends Tg{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==hi.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==hi.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==hi.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,n=this.stopDown(r)}else e.type==hi.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function tN(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}class n6 extends Eg{constructor(e){super({stopDown:lx}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:Wy(yE,s6);this.condition_=e.onFocusOnly?Wy(xE,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const r=this.targetPointers,i=n.getEventPixel(tN(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const l=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],d=e.map.getView();TP(l,d.getResolution()),Pb(l,d.getRotation()),d.adjustCenterInternal(l)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),l=this.kinetic_.getAngle(),c=r.getCenterInternal(),d=n.getPixelFromCoordinateInternal(c),u=n.getCoordinateFromPixelInternal([d[0]-i*Math.cos(l),d[1]-i*Math.sin(l)]);r.animateInternal({center:r.getConstrainedCenter(u),duration:500,easing:Mf})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class r6 extends Eg{constructor(e){e=e||{},super({stopDown:lx}),this.condition_=e.condition?e.condition:XA,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!uC(e))return;const n=e.map,r=n.getView();if(r.getConstraints().rotation===qb)return;const i=n.getSize(),l=e.pixel,c=Math.atan2(i[1]/2-l[1],l[0]-i[0]/2);if(this.lastAngle_!==void 0){const d=c-this.lastAngle_;r.adjustRotationInternal(-d)}this.lastAngle_=c}handleUpEvent(e){return uC(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return uC(e)&&CE(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class i6 extends ax{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],n[0])+r,i.top=Math.min(e[1],n[1])+r,i.width=Math.abs(n[0]-e[0])+r,i.height=Math.abs(n[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new ig([i])}getGeometry(){return this.geometry_}}const v0={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class vm extends cd{constructor(e,n,r){super(e),this.coordinate=n,this.mapBrowserEvent=r}}class a6 extends Eg{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new i6(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??CE,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,r){const i=r[0]-n[0],l=r[1]-n[1];return i*i+l*l>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new vm(v0.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new vm(n?v0.BOXEND:v0.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new vm(v0.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new vm(v0.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new vm(v0.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class l6 extends a6{constructor(e){e=e||{};const n=e.condition?e.condition:t6;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const l=r.rotatedExtentForGeometry(i),c=r.getResolutionForExtentInternal(l),d=r.getResolution()/c;i=i.clone(),i.scale(d*d)}r.fitInternal(i,{duration:this.duration_,easing:Mf})}}const Yu={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class o6 extends Tg{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return yE(n)&&bE(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==Rn.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==Yu.DOWN||i==Yu.LEFT||i==Yu.RIGHT||i==Yu.UP)){const c=e.map.getView(),d=c.getResolution()*this.pixelDelta_;let u=0,f=0;i==Yu.DOWN?f=-d:i==Yu.LEFT?u=-d:i==Yu.RIGHT?u=d:f=d;const m=[u,f];Pb(m,c.getRotation()),zA(c,m,this.duration_),r.preventDefault(),n=!0}}return!n}}class c6 extends Tg{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!e6(n)&&bE(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==Rn.KEYDOWN||e.type==Rn.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const l=e.map,c=i==="+"?this.delta_:-this.delta_,d=l.getView();eN(d,c,void 0,this.duration_),r.preventDefault(),n=!0}}return!n}}const d6=40,u6=300;class h6 extends Tg{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:ZA;this.condition_=e.onFocusOnly?Wy(xE,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Rn.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let l=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:l*=d6;break;case WheelEvent.DOM_DELTA_PAGE:l*=u6;break}if(l===0)return!1;this.lastDelta_=l;const c=Date.now();this.startTime_===void 0&&(this.startTime_=c),(!this.mode_||c-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(l)<4?"trackpad":"wheel");const d=r.getView();if(this.mode_==="trackpad"&&!(d.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(d.getAnimating()&&d.cancelAnimations(),d.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),d.adjustZoom(-l/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=c,!1;this.totalDelta_+=l;const u=Math.max(this.timeout_-(c-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),u),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let r=-zr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),eN(n,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class f6 extends Eg{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=lx),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const r=this.targetPointers[0],i=this.targetPointers[1],l=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const u=l-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=u}this.lastAngle_=l;const c=e.map,d=c.getView();d.getConstraints().rotation!==qb&&(this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(tN(this.targetPointers))),this.rotating_&&(c.render(),d.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class m6 extends Eg{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=lx),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const r=this.targetPointers[0],i=this.targetPointers[1],l=r.clientX-i.clientX,c=r.clientY-i.clientY,d=Math.sqrt(l*l+c*c);this.lastDistance_!==void 0&&(n=this.lastDistance_/d),this.lastDistance_=d;const u=e.map,f=u.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(tN(this.targetPointers))),u.render(),f.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function g6(t){t=t||{};const e=new Vl,n=new HA(-.005,.05,100);return(t.altShiftDragRotate!==void 0?t.altShiftDragRotate:!0)&&e.push(new r6),(t.doubleClickZoom!==void 0?t.doubleClickZoom:!0)&&e.push(new qA({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan!==void 0?t.dragPan:!0)&&e.push(new n6({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate!==void 0?t.pinchRotate:!0)&&e.push(new f6),(t.pinchZoom!==void 0?t.pinchZoom:!0)&&e.push(new m6({duration:t.zoomDuration})),(t.keyboard!==void 0?t.keyboard:!0)&&(e.push(new o6),e.push(new c6({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom!==void 0?t.mouseWheelZoom:!0)&&e.push(new h6({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom!==void 0?t.shiftDragZoom:!0)&&e.push(new l6({duration:t.zoomDuration})),e}const gr={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class NE extends gc{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[gr.OPACITY]=e.opacity!==void 0?e.opacity:1,dr(typeof n[gr.OPACITY]=="number","Layer opacity must be a number"),n[gr.VISIBLE]=e.visible!==void 0?e.visible:!0,n[gr.Z_INDEX]=e.zIndex,n[gr.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[gr.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[gr.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[gr.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return n.opacity=zr(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return Zn()}getLayerStatesArray(e){return Zn()}getExtent(){return this.get(gr.EXTENT)}getMaxResolution(){return this.get(gr.MAX_RESOLUTION)}getMinResolution(){return this.get(gr.MIN_RESOLUTION)}getMinZoom(){return this.get(gr.MIN_ZOOM)}getMaxZoom(){return this.get(gr.MAX_ZOOM)}getOpacity(){return this.get(gr.OPACITY)}getSourceState(){return Zn()}getVisible(){return this.get(gr.VISIBLE)}getZIndex(){return this.get(gr.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(gr.EXTENT,e)}setMaxResolution(e){this.set(gr.MAX_RESOLUTION,e)}setMinResolution(e){this.set(gr.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(gr.MAX_ZOOM,e)}setMinZoom(e){this.set(gr.MIN_ZOOM,e)}setOpacity(e){dr(typeof e=="number","Layer opacity must be a number"),this.set(gr.OPACITY,e)}setVisible(e){this.set(gr.VISIBLE,e)}setZIndex(e){this.set(gr.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Kd={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class tu extends cd{constructor(e,n){super(e),this.layer=n}}const hC={LAYERS:"layers"};class Lf extends NE{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let r=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(hC.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Vl(r.slice(),{unique:!0}):dr(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Vl(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Hr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(er(e,il.ADD,this.handleLayersAdd_,this),er(e,il.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(Hr);Sg(this.listenerKeys_);const n=e.getArray();for(let r=0,i=n.length;r<i;r++){const l=n[r];this.registerLayerListeners_(l),this.dispatchEvent(new tu(Kd.ADDLAYER,l))}this.changed()}registerLayerListeners_(e){const n=[er(e,Nf.PROPERTYCHANGE,this.handleLayerChange_,this),er(e,Rn.CHANGE,this.handleLayerChange_,this)];e instanceof Lf&&n.push(er(e,Kd.ADDLAYER,this.handleLayerGroupAdd_,this),er(e,Kd.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[tr(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new tu(Kd.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new tu(Kd.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new tu(Kd.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,r=tr(n);this.listenerKeys_[r].forEach(Hr),delete this.listenerKeys_[r],this.dispatchEvent(new tu(Kd.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(hC.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const r=n.getArray();for(let i=0,l=r.length;i<l;++i)this.dispatchEvent(new tu(Kd.REMOVELAYER,r[i]))}this.set(hC.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],r=n.length;this.getLayers().forEach(function(c){c.getLayerStatesArray(n)});const i=this.getLayerState();let l=i.zIndex;!e&&i.zIndex===void 0&&(l=0);for(let c=r,d=n.length;c<d;c++){const u=n[c];u.opacity*=i.opacity,u.visible=u.visible&&i.visible,u.maxResolution=Math.min(u.maxResolution,i.maxResolution),u.minResolution=Math.max(u.minResolution,i.minResolution),u.minZoom=Math.max(u.minZoom,i.minZoom),u.maxZoom=Math.min(u.maxZoom,i.maxZoom),i.extent!==void 0&&(u.extent!==void 0?u.extent=fh(u.extent,i.extent):u.extent=i.extent),u.zIndex===void 0&&(u.zIndex=l)}return n}getSourceState(){return"ready"}}const Hl={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class xx extends NE{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(gr.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(gr.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Hr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=er(e,Rn.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof ic?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&r&&(n.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(n.layerStatesArray){if(i=n.layerStatesArray.find(c=>c.layer===this),!i)return!1}else i=this.getLayerState();const l=this.getExtent();return sN(i,n.viewState)&&(!l||ol(l,n.extent))}getAttributions(e){var l;if(!this.isVisible(e))return[];const n=(l=this.getSource())==null?void 0:l.getAttributions();if(!n)return[];const r=e instanceof ic?e.getViewStateAndExtent():e;let i=n(r);return Array.isArray(i)||(i=[i]),i}render(e,n){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(gr.MAP,e)}getMapInternal(){return this.get(gr.MAP)}setMap(e){this.mapPrecomposeKey_&&(Hr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Hr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=er(e,Hl.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=er(this,Rn.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);dr(!n.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}setSource(e){this.set(gr.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function sN(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}function SE(t,e,n=0,r=t.length-1,i=p6){for(;r>n;){if(r-n>600){const u=r-n+1,f=e-n+1,m=Math.log(u),_=.5*Math.exp(2*m/3),y=.5*Math.sqrt(m*_*(u-_)/u)*(f-u/2<0?-1:1),g=Math.max(n,Math.floor(e-f*_/u+y)),N=Math.min(r,Math.floor(e+(u-f)*_/u+y));SE(t,e,g,N,i)}const l=t[e];let c=n,d=r;for(Dm(t,n,e),i(t[r],l)>0&&Dm(t,n,r);c<d;){for(Dm(t,c,d),c++,d--;i(t[c],l)<0;)c++;for(;i(t[d],l)>0;)d--}i(t[n],l)===0?Dm(t,n,d):(d++,Dm(t,d,r)),d<=e&&(n=d+1),e<=d&&(r=d-1)}}function Dm(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function p6(t,e){return t<e?-1:t>e?1:0}let vE=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!Bp(e,n))return r;const i=this.toBBox,l=[];for(;n;){for(let c=0;c<n.children.length;c++){const d=n.children[c],u=n.leaf?i(d):d;Bp(e,u)&&(n.leaf?r.push(d):mC(e,u)?this._all(d,r):l.push(d))}n=l.pop()}return r}collides(e){let n=this.data;if(!Bp(e,n))return!1;const r=[];for(;n;){for(let i=0;i<n.children.length;i++){const l=n.children[i],c=n.leaf?this.toBBox(l):l;if(Bp(e,c)){if(n.leaf||mC(e,c))return!0;r.push(l)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=B0([]),this}remove(e,n){if(!e)return this;let r=this.data;const i=this.toBBox(e),l=[],c=[];let d,u,f;for(;r||l.length;){if(r||(r=l.pop(),u=l[l.length-1],d=c.pop(),f=!0),r.leaf){const m=_6(e,r.children,n);if(m!==-1)return r.children.splice(m,1),l.push(r),this._condense(l),this}!f&&!r.leaf&&mC(r,i)?(l.push(r),c.push(d),d=0,u=r,r=r.children[0]):u?(d++,r=u.children[d],f=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,i){const l=r-n+1;let c=this._maxEntries,d;if(l<=c)return d=B0(e.slice(n,r+1)),D0(d,this.toBBox),d;i||(i=Math.ceil(Math.log(l)/Math.log(c)),c=Math.ceil(l/Math.pow(c,i-1))),d=B0([]),d.leaf=!1,d.height=i;const u=Math.ceil(l/c),f=u*Math.ceil(Math.sqrt(c));uD(e,n,r,f,this.compareMinX);for(let m=n;m<=r;m+=f){const _=Math.min(m+f-1,r);uD(e,m,_,u,this.compareMinY);for(let y=m;y<=_;y+=u){const g=Math.min(y+u-1,_);d.children.push(this._build(e,y,g,i-1))}}return D0(d,this.toBBox),d}_chooseSubtree(e,n,r,i){for(;i.push(n),!(n.leaf||i.length-1===r);){let l=1/0,c=1/0,d;for(let u=0;u<n.children.length;u++){const f=n.children[u],m=fC(f),_=y6(e,f)-m;_<c?(c=_,l=m<l?m:l,d=f):_===c&&m<l&&(l=m,d=f)}n=d||n.children[0]}return n}_insert(e,n,r){const i=r?e:this.toBBox(e),l=[],c=this._chooseSubtree(i,this.data,n,l);for(c.children.push(e),Am(c,i);n>=0&&l[n].children.length>this._maxEntries;)this._split(l,n),n--;this._adjustParentBBoxes(i,l,n)}_split(e,n){const r=e[n],i=r.children.length,l=this._minEntries;this._chooseSplitAxis(r,l,i);const c=this._chooseSplitIndex(r,l,i),d=B0(r.children.splice(c,r.children.length-c));d.height=r.height,d.leaf=r.leaf,D0(r,this.toBBox),D0(d,this.toBBox),n?e[n-1].children.push(d):this._splitRoot(r,d)}_splitRoot(e,n){this.data=B0([e,n]),this.data.height=e.height+1,this.data.leaf=!1,D0(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let i,l=1/0,c=1/0;for(let d=n;d<=r-n;d++){const u=Pm(e,0,d,this.toBBox),f=Pm(e,d,r,this.toBBox),m=b6(u,f),_=fC(u)+fC(f);m<l?(l=m,i=d,c=_<c?_:c):m===l&&_<c&&(c=_,i=d)}return i||r-n}_chooseSplitAxis(e,n,r){const i=e.leaf?this.compareMinX:x6,l=e.leaf?this.compareMinY:C6,c=this._allDistMargin(e,n,r,i),d=this._allDistMargin(e,n,r,l);c<d&&e.children.sort(i)}_allDistMargin(e,n,r,i){e.children.sort(i);const l=this.toBBox,c=Pm(e,0,n,l),d=Pm(e,r-n,r,l);let u=Up(c)+Up(d);for(let f=n;f<r-n;f++){const m=e.children[f];Am(c,e.leaf?l(m):m),u+=Up(c)}for(let f=r-n-1;f>=n;f--){const m=e.children[f];Am(d,e.leaf?l(m):m),u+=Up(d)}return u}_adjustParentBBoxes(e,n,r){for(let i=r;i>=0;i--)Am(n[i],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():D0(e[n],this.toBBox)}};function _6(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function D0(t,e){Pm(t,0,t.children.length,e,t)}function Pm(t,e,n,r,i){i||(i=B0(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let l=e;l<n;l++){const c=t.children[l];Am(i,t.leaf?r(c):c)}return i}function Am(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function x6(t,e){return t.minX-e.minX}function C6(t,e){return t.minY-e.minY}function fC(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Up(t){return t.maxX-t.minX+(t.maxY-t.minY)}function y6(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function b6(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),l=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,l-r)}function mC(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Bp(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function B0(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function uD(t,e,n,r,i){const l=[e,n];for(;l.length;){if(n=l.pop(),e=l.pop(),n-e<=r)continue;const c=e+Math.ceil((n-e)/r/2)*r;SE(t,c,e,n,i),l.push(e,c,c,n)}}const nN=[NaN,NaN,NaN,0];let gC;function N6(){return gC||(gC=Ii(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),gC}const S6=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,v6=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,D6=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,R6=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Wp(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function Vm(t){throw new Error('failed to parse "'+t+'" as color')}function DE(t){if(t.toLowerCase().startsWith("rgb")){const l=t.match(v6)||t.match(S6)||t.match(D6);if(l){const c=l[4],d=100/255;return[zr(Wp(l[1],d)+.5|0,0,255),zr(Wp(l[2],d)+.5|0,0,255),zr(Wp(l[3],d)+.5|0,0,255),c!==void 0?zr(Wp(c,100),0,1):1]}Vm(t)}if(t.startsWith("#")){if(R6.test(t)){const l=t.substring(1),c=l.length<=4?1:2,d=[0,0,0,255];for(let u=0,f=l.length;u<f;u+=c){let m=parseInt(l.substring(u,u+c),16);c===1&&(m+=m<<4),d[u/c]=m}return d[3]=d[3]/255,d}Vm(t)}const e=N6();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&Vm(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return DE(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=cx(i[3]/255,3),i}function T6(t){return typeof t=="string"?t:iN(t)}const E6=1024,Rm={};let pC=0;function j6(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function _C(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function xC(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function CC(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function yC(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function hD(t){const e=CC(t[0]),n=CC(t[1]),r=CC(t[2]),i=yC(e*.222488403+n*.716873169+r*.06060791),l=500*(yC(e*.452247074+n*.399439023+r*.148375274)-i),c=200*(i-yC(e*.016863605+n*.117638439+r*.865350722)),d=Math.atan2(c,l)*(180/Math.PI);return[116*i-16,Math.sqrt(l*l+c*c),d<0?d+360:d,t[3]]}function I6(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=xC(e),l=xC(e+n/500*Math.cos(r)),c=xC(e-n/200*Math.sin(r)),d=_C(l*3.021973625-i*1.617392459-c*.404875592),u=_C(l*-.943766287+i*1.916279586+c*.027607165),f=_C(l*.069407491-i*.22898585+c*1.159737864);return[zr(d+.5|0,0,255),zr(u+.5|0,0,255),zr(f+.5|0,0,255),t[3]]}function rN(t){if(t==="none")return nN;if(Rm.hasOwnProperty(t))return Rm[t];if(pC>=E6){let n=0;for(const r in Rm)(n++&3)===0&&(delete Rm[r],--pC)}const e=DE(t);e.length!==4&&Vm(t);for(const n of e)isNaN(n)&&Vm(t);return Rm[t]=e,++pC,e}function bh(t){return Array.isArray(t)?t:rN(t)}function iN(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let r=t[2];r!=(r|0)&&(r=r+.5|0);const i=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+r+","+i+")"}function fD(t){return t[0]>0&&t[1]>0}function O6(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function cl(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}let wh=0;const Aa=1<<wh++,Un=1<<wh++,al=1<<wh++,Eo=1<<wh++,Nh=1<<wh++,km=1<<wh++,Fp=Math.pow(2,wh)-1,aN={[Aa]:"boolean",[Un]:"number",[al]:"string",[Eo]:"color",[Nh]:"number[]",[km]:"size"},M6=Object.keys(aN).map(Number).sort(Jc);function L6(t){return t in aN}function Um(t){const e=[];for(const n of M6)Bm(t,n)&&e.push(aN[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Bm(t,e){return(t&e)===e}function Qd(t,e){return t===e}class Ki{constructor(e,n){if(!L6(e))throw new Error(`literal expressions must have a specific type, got ${Um(e)}`);this.type=e,this.value=n}}class w6{constructor(e,n,...r){this.type=e,this.operator=n,this.args=r}}function RE(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function pa(t,e,n){switch(typeof t){case"boolean":{if(Qd(e,al))return new Ki(al,t?"true":"false");if(!Bm(e,Aa))throw new Error(`got a boolean, but expected ${Um(e)}`);return new Ki(Aa,t)}case"number":{if(Qd(e,km))return new Ki(km,cl(t));if(Qd(e,Aa))return new Ki(Aa,!!t);if(Qd(e,al))return new Ki(al,t.toString());if(!Bm(e,Un))throw new Error(`got a number, but expected ${Um(e)}`);return new Ki(Un,t)}case"string":{if(Qd(e,Eo))return new Ki(Eo,rN(t));if(Qd(e,Aa))return new Ki(Aa,!!t);if(!Bm(e,al))throw new Error(`got a string, but expected ${Um(e)}`);return new Ki(al,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return Y6(t,e,n);for(const r of t)if(typeof r!="number")throw new Error("expected an array of numbers");if(Qd(e,km)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new Ki(km,t)}if(Qd(e,Eo)){if(t.length===3)return new Ki(Eo,[...t,1]);if(t.length===4)return new Ki(Eo,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!Bm(e,Nh))throw new Error(`got an array of numbers, but expected ${Um(e)}`);return new Ki(Nh,t)}const as={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},P6={[as.Get]:gn(Dn(1,1/0),mD),[as.Var]:gn(Dn(1,1),A6),[as.Has]:gn(Dn(1,1/0),mD),[as.Id]:gn(k6,R0),[as.Concat]:gn(Dn(2,1/0),or(al)),[as.GeometryType]:gn(U6,R0),[as.LineMetric]:gn(R0),[as.Resolution]:gn(bC,R0),[as.Zoom]:gn(bC,R0),[as.Time]:gn(bC,R0),[as.Any]:gn(Dn(2,1/0),or(Aa)),[as.All]:gn(Dn(2,1/0),or(Aa)),[as.Not]:gn(Dn(1,1),or(Aa)),[as.Equal]:gn(Dn(2,2),or(Fp)),[as.NotEqual]:gn(Dn(2,2),or(Fp)),[as.GreaterThan]:gn(Dn(2,2),or(Un)),[as.GreaterThanOrEqualTo]:gn(Dn(2,2),or(Un)),[as.LessThan]:gn(Dn(2,2),or(Un)),[as.LessThanOrEqualTo]:gn(Dn(2,2),or(Un)),[as.Multiply]:gn(Dn(2,1/0),gD),[as.Coalesce]:gn(Dn(2,1/0),gD),[as.Divide]:gn(Dn(2,2),or(Un)),[as.Add]:gn(Dn(2,1/0),or(Un)),[as.Subtract]:gn(Dn(2,2),or(Un)),[as.Clamp]:gn(Dn(3,3),or(Un)),[as.Mod]:gn(Dn(2,2),or(Un)),[as.Pow]:gn(Dn(2,2),or(Un)),[as.Abs]:gn(Dn(1,1),or(Un)),[as.Floor]:gn(Dn(1,1),or(Un)),[as.Ceil]:gn(Dn(1,1),or(Un)),[as.Round]:gn(Dn(1,1),or(Un)),[as.Sin]:gn(Dn(1,1),or(Un)),[as.Cos]:gn(Dn(1,1),or(Un)),[as.Atan]:gn(Dn(1,2),or(Un)),[as.Sqrt]:gn(Dn(1,1),or(Un)),[as.Match]:gn(Dn(4,1/0),pD,W6),[as.Between]:gn(Dn(3,3),or(Un)),[as.Interpolate]:gn(Dn(6,1/0),pD,F6),[as.Case]:gn(Dn(3,1/0),B6,K6),[as.In]:gn(Dn(2,2),Q6),[as.Number]:gn(Dn(1,1/0),or(Fp)),[as.String]:gn(Dn(1,1/0),or(Fp)),[as.Array]:gn(Dn(1,1/0),or(Un)),[as.Color]:gn(Dn(1,4),or(Un)),[as.Band]:gn(Dn(1,3),or(Un)),[as.Palette]:gn(Dn(2,2),G6),[as.ToString]:gn(Dn(1,1),or(Aa|Un|al|Eo))};function mD(t,e,n){const r=t.length-1,i=new Array(r);for(let l=0;l<r;++l){const c=t[l+1];switch(typeof c){case"number":{i[l]=new Ki(Un,c);break}case"string":{i[l]=new Ki(al,c);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${c}`)}l===0&&n.properties.add(String(c))}return i}function A6(t,e,n){const r=t[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return n.variables.add(r),[new Ki(al,r)]}function k6(t,e,n){n.featureId=!0}function U6(t,e,n){n.geometryType=!0}function bC(t,e,n){n.mapState=!0}function R0(t,e,n){const r=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function Dn(t,e){return function(n,r,i){const l=n[0],c=n.length-1;if(t===e){if(c!==t){const d=t===1?"":"s";throw new Error(`expected ${t} argument${d} for ${l}, got ${c}`)}}else if(c<t||c>e){const d=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${d} arguments for ${l}, got ${c}`)}}}function gD(t,e,n){const r=t.length-1,i=new Array(r);for(let l=0;l<r;++l){const c=pa(t[l+1],e,n);i[l]=c}return i}function or(t){return function(e,n,r){const i=e.length-1,l=new Array(i);for(let c=0;c<i;++c){const d=pa(e[c+1],t,r);l[c]=d}return l}}function B6(t,e,n){const r=t[0],i=t.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function pD(t,e,n){const r=t[0],i=t.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function W6(t,e,n){const r=t.length-1,i=al|Un|Aa,l=pa(t[1],i,n),c=pa(t[t.length-1],e,n),d=new Array(r-2);for(let u=0;u<r-2;u+=2){try{const f=pa(t[u+2],l.type,n);d[u]=f}catch(f){throw new Error(`failed to parse argument ${u+1} of match expression: ${f.message}`)}try{const f=pa(t[u+3],c.type,n);d[u+1]=f}catch(f){throw new Error(`failed to parse argument ${u+2} of match expression: ${f.message}`)}}return[l,...d,c]}function F6(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const u=r[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);i=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const l=new Ki(Un,i);let c;try{c=pa(t[2],Un,n)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const d=new Array(t.length-3);for(let u=0;u<d.length;u+=2){try{const f=pa(t[u+3],Un,n);d[u]=f}catch(f){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${f.message}`)}try{const f=pa(t[u+4],e,n);d[u+1]=f}catch(f){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${f.message}`)}}return[l,c,...d]}function K6(t,e,n){const r=pa(t[t.length-1],e,n),i=new Array(t.length-1);for(let l=0;l<i.length-1;l+=2){try{const c=pa(t[l+1],Aa,n);i[l]=c}catch(c){throw new Error(`failed to parse argument ${l} of case expression: ${c.message}`)}try{const c=pa(t[l+2],r.type,n);i[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of case expression: ${c.message}`)}}return i[i.length-1]=r,i}function Q6(t,e,n){let r=t[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=al}else i=Un;const l=new Array(r.length);for(let d=0;d<l.length;d++)try{const u=pa(r[d],i,n);l[d]=u}catch(u){throw new Error(`failed to parse haystack item ${d} for "in" expression: ${u.message}`)}return[pa(t[1],i,n),...l]}function G6(t,e,n){let r;try{r=pa(t[1],Un,n)}catch(c){throw new Error(`failed to parse first argument in palette expression: ${c.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const l=new Array(i.length);for(let c=0;c<l.length;c++){let d;try{d=pa(i[c],Eo,n)}catch(u){throw new Error(`failed to parse color at index ${c} in palette expression: ${u.message}`)}if(!(d instanceof Ki))throw new Error(`the palette color at index ${c} must be a literal value`);l[c]=d}return[r,...l]}function gn(...t){return function(e,n,r){const i=e[0];let l;for(let c=0;c<t.length;c++){const d=t[c](e,n,r);if(c==t.length-1){if(!d)throw new Error("expected last argument validator to return the parsed args");l=d}}return new w6(n,i,...l)}}function Y6(t,e,n){const r=t[0],i=P6[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}function TE(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return TE(t.getGeometries()[0]);default:return""}}function EE(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function fc(t,e,n){const r=pa(t,e,n);return Oo(r)}function Oo(t,e){if(t instanceof Ki){if(t.type===Eo&&typeof t.value=="string"){const r=rN(t.value);return function(){return r}}return function(){return t.value}}const n=t.operator;switch(n){case as.Number:case as.String:case as.Coalesce:return V6(t);case as.Get:case as.Var:case as.Has:return $6(t);case as.Id:return r=>r.featureId;case as.GeometryType:return r=>r.geometryType;case as.Concat:{const r=t.args.map(i=>Oo(i));return i=>"".concat(...r.map(l=>l(i).toString()))}case as.Resolution:return r=>r.resolution;case as.Any:case as.All:case as.Between:case as.In:case as.Not:return z6(t);case as.Equal:case as.NotEqual:case as.LessThan:case as.LessThanOrEqualTo:case as.GreaterThan:case as.GreaterThanOrEqualTo:return H6(t);case as.Multiply:case as.Divide:case as.Add:case as.Subtract:case as.Clamp:case as.Mod:case as.Pow:case as.Abs:case as.Floor:case as.Ceil:case as.Round:case as.Sin:case as.Cos:case as.Atan:case as.Sqrt:return q6(t);case as.Case:return X6(t);case as.Match:return J6(t);case as.Interpolate:return Z6(t);case as.ToString:return ek(t);default:throw new Error(`Unsupported operator ${n}`)}}function V6(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let l=0;l<r;++l)i[l]=Oo(t.args[l]);switch(n){case as.Coalesce:return l=>{for(let c=0;c<r;++c){const d=i[c](l);if(typeof d<"u"&&d!==null)return d}throw new Error("Expected one of the values to be non-null")};case as.Number:case as.String:return l=>{for(let c=0;c<r;++c){const d=i[c](l);if(typeof d===n)return d}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function $6(t,e){const r=t.args[0].value;switch(t.operator){case as.Get:return i=>{const l=t.args;let c=i.properties[r];for(let d=1,u=l.length;d<u;++d){const m=l[d].value;c=c[m]}return c};case as.Var:return i=>i.variables[r];case as.Has:return i=>{const l=t.args;if(!(r in i.properties))return!1;let c=i.properties[r];for(let d=1,u=l.length;d<u;++d){const m=l[d].value;if(!c||!Object.hasOwn(c,m))return!1;c=c[m]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function H6(t,e){const n=t.operator,r=Oo(t.args[0]),i=Oo(t.args[1]);switch(n){case as.Equal:return l=>r(l)===i(l);case as.NotEqual:return l=>r(l)!==i(l);case as.LessThan:return l=>r(l)<i(l);case as.LessThanOrEqualTo:return l=>r(l)<=i(l);case as.GreaterThan:return l=>r(l)>i(l);case as.GreaterThanOrEqualTo:return l=>r(l)>=i(l);default:throw new Error(`Unsupported comparison operator ${n}`)}}function z6(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let l=0;l<r;++l)i[l]=Oo(t.args[l]);switch(n){case as.Any:return l=>{for(let c=0;c<r;++c)if(i[c](l))return!0;return!1};case as.All:return l=>{for(let c=0;c<r;++c)if(!i[c](l))return!1;return!0};case as.Between:return l=>{const c=i[0](l),d=i[1](l),u=i[2](l);return c>=d&&c<=u};case as.In:return l=>{const c=i[0](l);for(let d=1;d<r;++d)if(c===i[d](l))return!0;return!1};case as.Not:return l=>!i[0](l);default:throw new Error(`Unsupported logical operator ${n}`)}}function q6(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let l=0;l<r;++l)i[l]=Oo(t.args[l]);switch(n){case as.Multiply:return l=>{let c=1;for(let d=0;d<r;++d)c*=i[d](l);return c};case as.Divide:return l=>i[0](l)/i[1](l);case as.Add:return l=>{let c=0;for(let d=0;d<r;++d)c+=i[d](l);return c};case as.Subtract:return l=>i[0](l)-i[1](l);case as.Clamp:return l=>{const c=i[0](l),d=i[1](l);if(c<d)return d;const u=i[2](l);return c>u?u:c};case as.Mod:return l=>i[0](l)%i[1](l);case as.Pow:return l=>Math.pow(i[0](l),i[1](l));case as.Abs:return l=>Math.abs(i[0](l));case as.Floor:return l=>Math.floor(i[0](l));case as.Ceil:return l=>Math.ceil(i[0](l));case as.Round:return l=>Math.round(i[0](l));case as.Sin:return l=>Math.sin(i[0](l));case as.Cos:return l=>Math.cos(i[0](l));case as.Atan:return r===2?l=>Math.atan2(i[0](l),i[1](l)):l=>Math.atan(i[0](l));case as.Sqrt:return l=>Math.sqrt(i[0](l));default:throw new Error(`Unsupported numeric operator ${n}`)}}function X6(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Oo(t.args[i]);return i=>{for(let l=0;l<n-1;l+=2)if(r[l](i))return r[l+1](i);return r[n-1](i)}}function J6(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Oo(t.args[i]);return i=>{const l=r[0](i);for(let c=1;c<n-1;c+=2)if(l===r[c](i))return r[c+1](i);return r[n-1](i)}}function Z6(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Oo(t.args[i]);return i=>{const l=r[0](i),c=r[1](i);let d,u;for(let f=2;f<n;f+=2){const m=r[f](i);let _=r[f+1](i);const y=Array.isArray(_);if(y&&(_=j6(_)),m>=c)return f===2?_:y?tk(l,c,d,u,m,_):Wm(l,c,d,u,m,_);d=m,u=_}return u}}function ek(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let l=0;l<r;++l)i[l]=Oo(t.args[l]);switch(n){case as.ToString:return l=>{const c=i[0](l);return t.args[0].type===Eo?iN(c):c.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function Wm(t,e,n,r,i,l){const c=i-n;if(c===0)return r;const d=e-n,u=t===1?d/c:(Math.pow(t,d)-1)/(Math.pow(t,c)-1);return r+u*(l-r)}function tk(t,e,n,r,i,l){if(i-n===0)return r;const d=hD(r),u=hD(l);let f=u[2]-d[2];f>180?f-=360:f<-180&&(f+=360);const m=[Wm(t,e,n,d[0],i,u[0]),Wm(t,e,n,d[1],i,u[1]),d[2]+Wm(t,e,n,0,i,f),Wm(t,e,n,r[3],i,l[3])];return I6(m)}const Sn={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function sk(t,e,n){const r=t;let i=!0,l=!1,c=!1;const d=[O_(r,Rn.LOAD,function(){c=!0,l||e()})];return r.src&&W5?(l=!0,r.decode().then(function(){i&&e()}).catch(function(u){i&&(c?e():n())})):d.push(O_(r,Rn.ERROR,n)),function(){i=!1,d.forEach(Hr)}}function nk(t,e){return new Promise((n,r)=>{function i(){c(),n(t)}function l(){c(),r(new Error("Image load error"))}function c(){t.removeEventListener("load",i),t.removeEventListener("error",l)}t.addEventListener("load",i),t.addEventListener("error",l)})}function rk(t,e){return e&&(t.src=e),t.src&&W5?new Promise((n,r)=>t.decode().then(()=>n(t)).catch(i=>t.complete&&t.width?n(t):r(i))):nk(t)}class ik{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const r=this.cache_[n];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n){const r=NC(e,n);return r in this.cache_?this.cache_[r]:null}getPattern(e,n){const r=NC(e,n);return r in this.patternCache_?this.patternCache_[r]:null}set(e,n,r,i){const l=NC(e,n),c=l in this.cache_;this.cache_[l]=r,i&&(r.getImageState()===Sn.IDLE&&r.load(),r.getImageState()===Sn.LOADING?r.ready().then(()=>{this.patternCache_[l]=U_().createPattern(r.getImage(1),"repeat")}):this.patternCache_[l]=U_().createPattern(r.getImage(1),"repeat")),c||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function NC(t,e){const n=e?bh(e):"null";return t+":"+n}const zl=new ik;let Tm=null;class jE extends ox{constructor(e,n,r,i,l){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r==null?void 0:r.crossOrigin,this.referrerPolicy_=r==null?void 0:r.referrerPolicy,this.canvas_={},this.color_=l,this.imageState_=i===void 0?Sn.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Sn.LOADED){Tm||(Tm=Ii(1,1,void 0,{willReadFrequently:!0})),Tm.drawImage(this.image_,0,0);try{Tm.getImageData(0,0,1,1),this.tainted_=!1}catch{Tm=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Rn.CHANGE)}handleImageError_(){this.imageState_=Sn.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Sn.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}setImage(e){this.image_=e}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],r=Ii(e,n);r.fillRect(0,0,e,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Sn.IDLE){this.image_||this.initializeImage_(),this.imageState_=Sn.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&rk(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Sn.LOADED)return;const n=this.image_,r=Ii(Math.ceil(n.width*e),Math.ceil(n.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(n,0,0),r.globalCompositeOperation="multiply",r.fillStyle=T6(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(n,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Sn.LOADED||this.imageState_===Sn.ERROR)e();else{const n=()=>{(this.imageState_===Sn.LOADED||this.imageState_===Sn.ERROR)&&(this.removeEventListener(Rn.CHANGE,n),e())};this.addEventListener(Rn.CHANGE,n)}})),this.ready_}}function $m(t,e,n,r,i,l){let c=e===void 0?void 0:zl.get(e,i);return c||(c=new jE(t,t&&"src"in t?t.src||void 0:e,n,r,i),zl.set(e,i,c,l)),l&&c&&!zl.getPattern(e,i)&&zl.set(e,i,c,l),c}function lc(t){return t?Array.isArray(t)?iN(t):typeof t=="object"&&"src"in t?ak(t):t:null}function ak(t){if(!t.offset||!t.size)return zl.getPattern(t.src,t.color);const e=t.src+":"+t.offset,n=zl.getPattern(e,t.color);if(n)return n;const r=zl.get(t.src,null);if(r.getImageState()!==Sn.LOADED)return null;const i=Ii(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),$m(i.canvas,e,void 0,Sn.LOADED,t.color,!0),zl.getPattern(e,t.color)}const IE="10px sans-serif",ll="#000",Rf="round",Zc=[],ed=0,Tf="round",ag=10,lk=0,lg="#000",og="center",B_="middle",sh=[0,0,0,0],cg=1,W0=new gc;let Em=null,_D;const Fy={},ok=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function ck(t,e,n){return`${t} ${e} 16px "${n}"`}const dk=(function(){let e,n;async function r(l){await n.ready;const c=await n.load(l);if(c.length===0)return!1;const d=By(l),u=d.families[0].toLowerCase(),f=d.weight;return c.some(m=>{const _=m.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Uy[m.weight]||m.weight;return _===u&&m.style===d.style&&y==f})}async function i(){await n.ready;let l=!0;const c=W0.getProperties(),d=Object.keys(c).filter(u=>c[u]<100);for(let u=d.length-1;u>=0;--u){const f=d[u];let m=c[f];m<100&&(await r(f)?(Sg(Fy),W0.set(f,100)):(m+=10,W0.set(f,m,!0),m<100&&(l=!1)))}e=void 0,l||(e=setTimeout(i,100))}return async function(l){n||(n=$l?self.fonts:document.fonts);const c=By(l);if(!c)return;const d=c.families;let u=!1;for(const f of d){if(ok.has(f))continue;const m=ck(c.style,c.weight,f);W0.get(m)===void 0&&(W0.set(m,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(i,100))}})(),uk=(function(){let t;return function(e){let n=Fy[e];if(n==null){if($l){const r=By(e),i=OE(e,"g");n=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);Fy[e]=n}return n}})();function OE(t,e){return Em||(Em=Ii(1,1)),t!=_D&&(Em.font=t,_D=Em.font),Em.measureText(e)}function ME(t,e){return OE(t,e).width}function xD(t,e,n){if(e in n)return n[e];const r=e.split(`
`).reduce((i,l)=>Math.max(i,ME(t,l)),0);return n[e]=r,r}function hk(t,e){const n=[],r=[],i=[];let l=0,c=0,d=0,u=0;for(let f=0,m=e.length;f<=m;f+=2){const _=e[f];if(_===`
`||f===m){l=Math.max(l,c),i.push(c),c=0,d+=u,u=0;continue}const y=e[f+1]||t.font,g=ME(y,_);n.push(g),c+=g;const N=uk(y);r.push(N),u=Math.max(u,N)}return{width:l,height:d,widths:n,heights:r,lineWidths:i}}function fk(t,e,n,r,i,l,c,d,u,f,m){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=_=>_.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(u,f),t.scale(m[0],m[1]),mk(r,t)):m[0]<0||m[1]<0?(t.translate(u,f),t.scale(m[0],m[1]),t.drawImage(r,i,l,c,d,0,0,c,d)):t.drawImage(r,i,l,c,d,u,f,c*m[0],d*m[1]),t.restore()}function mk(t,e){const n=t.contextInstructions;for(let r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}class Cx{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=cl(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Cx({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Zn()}getImage(e){return Zn()}getHitDetectionImage(){return Zn()}getPixelRatio(e){return 1}getImageState(){return Zn()}getImageSize(){return Zn()}getOrigin(){return Zn()}getSize(){return Zn()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=cl(e)}listenImageChange(e){Zn()}load(){Zn()}unlistenImageChange(e){Zn()}ready(){return Promise.resolve()}}class yx extends Cx{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Sn.LOADING:Sn.LOADED,this.imageState_===Sn.LOADING&&this.ready().then(()=>this.imageState_=Sn.LOADED),this.render()}clone(){const e=this.getScale(),n=new yx({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-n[0]/r[0],e[1]/2+n[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var l,c;const n=(l=this.fill_)==null?void 0:l.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let i=(c=zl.get(r,null))==null?void 0:c.getImage(1);if(!i){const d=this.renderOptions_,u=Math.ceil(d.size*e),f=Ii(u,u);this.draw_(d,f,e),i=f.canvas;const m=new jE(i,void 0,null,Sn.LOADED,null);zl.set(r,null,m),createImageBitmap(i).then(_=>{m.setImage(_)})}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}setRadius(e){this.radius!==e&&(this.radius=e,this.render())}getRadius2(){return this.radius2_}setRadius2(e){this.radius2_!==e&&(this.radius2_=e,this.render())}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,r){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let i=this.radius,l=this.radius2_===void 0?i:this.radius2_;if(i<l){const G=i;i=l,l=G}const c=this.radius2_===void 0?this.points_:this.points_*2,d=2*Math.PI/c,u=l*Math.sin(d),f=Math.sqrt(l*l-u*u),m=i-f,_=Math.sqrt(u*u+m*m),y=_/u;if(e==="miter"&&y<=r)return y*n;const g=n/2/y,N=n/2*(m/_),v=Math.sqrt((i+g)*(i+g)+N*N)-i;if(this.radius2_===void 0||e==="bevel")return v*2;const R=i*Math.sin(d),U=Math.sqrt(i*i-R*R),L=l-U,P=Math.sqrt(R*R+L*L)/R;if(P<=r){const G=P*n/2-l-i;return 2*Math.max(v,G)}return v*2}createRenderOptions(){let e=Rf,n=Tf,r=0,i=null,l=0,c,d=0;this.stroke_&&(c=lc(this.stroke_.getColor()??lg),d=this.stroke_.getWidth()??cg,i=this.stroke_.getLineDash(),l=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??Tf,e=this.stroke_.getLineCap()??Rf,r=this.stroke_.getMiterLimit()??ag);const u=this.calculateLineJoinSize_(n,d,r),f=Math.max(this.radius,this.radius2_||0),m=Math.ceil(2*f+u);return{strokeStyle:c,strokeWidth:d,size:m,lineCap:e,lineDash:i,lineDashOffset:l,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,r){if(n.scale(r,r),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let i=this.fill_.getColor();i===null&&(i=ll),n.fillStyle=lc(i),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=bh(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(n=Ii(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const r=this.radius;if(n===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);const l=this.angle_-Math.PI/2,c=2*Math.PI/n;for(let d=0;d<n;d++){const u=l+d*c,f=d%2===0?r:i;e.lineTo(f*Math.cos(u),f*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=ll,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class bx extends yx{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new bx({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}}class Ef{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ef({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=$m(null,e.src,{crossOrigin:"anonymous"},void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===Sn.IDLE&&n.load(),n.getImageState()===Sn.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?tr(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:bh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function CD(t,e,n,r){return n!==void 0&&r!==void 0?[n/t,r/e]:n!==void 0?n/t:r!==void 0?r/e:1}class mh extends Cx{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,l=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:l,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.referrerPolicy_=e.referrerPolicy;const c=e.img!==void 0?e.img:null;let d=e.src;dr(!(d!==void 0&&c),"`image` and `src` cannot be provided at the same time"),(d===void 0||d.length===0)&&c&&(d=c.src||tr(c)),dr(d!==void 0&&d.length>0,"A defined and non-empty `src` or `image` must be provided"),dr(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Sn.IDLE:c!==void 0&&("complete"in c?c.complete?u=c.src?Sn.LOADED:Sn.IDLE:u=Sn.LOADING:u=Sn.LOADED),this.color_=e.color!==void 0?bh(e.color):null,this.iconImage_=$m(c,d,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let f,m;if(e.size)[f,m]=e.size;else{const _=this.getImage(1);if(_.width&&_.height)f=_.width,m=_.height;else if(_ instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(CD(g[0],g[1],e.width,e.height))};this.listenImageChange(y);return}}f!==void 0&&this.setScale(CD(f,m,e.width,e.height))}}clone(){let e,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new mh({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),r=this.getScaleArray();return[e[0]-n[0]/r[0],e[1]+n[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}setColor(e){const n=e?bh(e):null;if(this.color_===n||this.color_&&n&&this.color_.length===n.length&&this.color_.every((c,d)=>c===n[d]))return;this.color_=n;const r=this.getSrc(),i=r!==void 0?null:this.getHitDetectionImage(),l=r!==void 0?Sn.IDLE:this.iconImage_.getImageState();this.iconImage_=$m(i,r,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},l,this.color_)}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=$m(null,e,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},Sn.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Sn.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Sn.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Rn.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Rn.CHANGE,e)}ready(){return this.iconImage_.ready()}}class Nx{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.offset_=e.offset,this.width_=e.width}clone(){const e=this.getColor();return new Nx({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),offset:this.getOffset(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getOffset(){return this.offset_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setOffset(e){this.offset_=e}setWidth(e){this.width_=e}}class cc{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=yD,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new cc({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=yD,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function gk(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(dr(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let SC=null;function LE(t,e){if(!SC){const n=new Ef({color:"rgba(255,255,255,0.4)"}),r=new Nx({color:"#3399CC",width:1.25});SC=[new cc({image:new bx({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return SC}function yD(t){return t.getGeometry()}const pk="#333";class lN{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=cl(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ef({color:pk}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new lN({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ef?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=cl(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}function _k(t){return!0}function xk(t){const e=RE(),n=Ck(t,e),r=EE();return function(i,l){if(r.properties=i.getPropertiesInternal(),r.resolution=l,e.featureId){const c=i.getId();c!==void 0?r.featureId=c:r.featureId=null}return e.geometryType&&(r.geometryType=TE(i.getGeometry())),n(r)}}function bD(t){const e=RE(),n=t.length,r=new Array(n);for(let c=0;c<n;++c)r[c]=Ky(t[c],e);const i=EE(),l=new Array(n);return function(c,d){if(i.properties=c.getPropertiesInternal(),i.resolution=d,e.featureId){const f=c.getId();f!==void 0?i.featureId=f:i.featureId=null}let u=0;for(let f=0;f<n;++f){const m=r[f](i);m&&(l[u]=m,u+=1)}return l.length=u,l}}function Ck(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const l=t[i],c="filter"in l?fc(l.filter,Aa,e):_k;let d;if(Array.isArray(l.style)){const u=l.style.length;d=new Array(u);for(let f=0;f<u;++f)d[f]=Ky(l.style[f],e)}else d=[Ky(l.style,e)];r[i]={filter:c,styles:d}}return function(i){const l=[];let c=!1;for(let d=0;d<n;++d){const u=r[d].filter;if(u(i)&&!(t[d].else&&c)){c=!0;for(const f of r[d].styles){const m=f(i);m&&l.push(m)}}}return l}}function Ky(t,e){const n=dg(t,"",e),r=ug(t,"",e),i=yk(t,e),l=bk(t,e),c=ga(t,"z-index",e);if(!n&&!r&&!i&&!l&&!Sf(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const d=new cc;return function(u){let f=!0;if(n){const m=n(u);m&&(f=!1),d.setFill(m)}if(r){const m=r(u);m&&(f=!1),d.setStroke(m)}if(i){const m=i(u);m&&(f=!1),d.setText(m)}if(l){const m=l(u);m&&(f=!1),d.setImage(m)}return c&&d.setZIndex(c(u)),f?null:d}}function dg(t,e,n){let r;if(e+"fill-pattern-src"in t)r=Dk(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return l=>null;r=Sx(t,e+"fill-color",n)}if(!r)return null;const i=new Ef;return function(l){const c=r(l);return c===nN?null:(i.setColor(c),i)}}function ug(t,e,n){const r=ga(t,e+"stroke-width",n),i=Sx(t,e+"stroke-color",n);if(!r&&!i)return null;const l=Vc(t,e+"stroke-line-cap",n),c=Vc(t,e+"stroke-line-join",n),d=wE(t,e+"stroke-line-dash",n),u=ga(t,e+"stroke-line-dash-offset",n),f=ga(t,e+"stroke-miter-limit",n),m=ga(t,e+"stroke-offset",n),_=new Nx;return function(y){if(i){const g=i(y);if(g===nN)return null;_.setColor(g)}if(r&&_.setWidth(r(y)),l){const g=l(y);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");_.setLineCap(g)}if(c){const g=c(y);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");_.setLineJoin(g)}return d&&_.setLineDash(d(y)),u&&_.setLineDashOffset(u(y)),f&&_.setMiterLimit(f(y)),m&&_.setOffset(m(y)),_}}function yk(t,e){const n="text-",r=Vc(t,n+"value",e);if(!r)return null;const i=dg(t,n,e),l=dg(t,n+"background-",e),c=ug(t,n,e),d=ug(t,n+"background-",e),u=Vc(t,n+"font",e),f=ga(t,n+"max-angle",e),m=ga(t,n+"offset-x",e),_=ga(t,n+"offset-y",e),y=ef(t,n+"overflow",e),g=Vc(t,n+"placement",e),N=ga(t,n+"repeat",e),C=vx(t,n+"scale",e),v=ef(t,n+"rotate-with-view",e),R=ga(t,n+"rotation",e),U=Vc(t,n+"align",e),L=Vc(t,n+"justify",e),w=Vc(t,n+"baseline",e),P=ef(t,n+"keep-upright",e),G=wE(t,n+"padding",e),K=Dx(t,n+"declutter-mode"),B=new lN({declutterMode:K});return function(O){if(B.setText(r(O)),i&&B.setFill(i(O)),l&&B.setBackgroundFill(l(O)),c&&B.setStroke(c(O)),d&&B.setBackgroundStroke(d(O)),u&&B.setFont(u(O)),f&&B.setMaxAngle(f(O)),m&&B.setOffsetX(m(O)),_&&B.setOffsetY(_(O)),y&&B.setOverflow(y(O)),g){const S=g(O);if(S!=="point"&&S!=="line")throw new Error("Expected point or line for text-placement");B.setPlacement(S)}if(N&&B.setRepeat(N(O)),C&&B.setScale(C(O)),v&&B.setRotateWithView(v(O)),R&&B.setRotation(R(O)),U){const S=U(O);if(S!=="left"&&S!=="center"&&S!=="right"&&S!=="end"&&S!=="start")throw new Error("Expected left, right, center, start, or end for text-align");B.setTextAlign(S)}if(L){const S=L(O);if(S!=="left"&&S!=="right"&&S!=="center")throw new Error("Expected left, right, or center for text-justify");B.setJustify(S)}if(w){const S=w(O);if(S!=="bottom"&&S!=="top"&&S!=="middle"&&S!=="alphabetic"&&S!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");B.setTextBaseline(S)}return G&&B.setPadding(G(O)),P&&B.setKeepUpright(P(O)),B}}function bk(t,e){return"icon-src"in t?Nk(t,e):"shape-points"in t?Sk(t,e):"circle-radius"in t?vk(t,e):null}function Nk(t,e){const n="icon-",r=n+"src",i=PE(t[r],r),l=W_(t,n+"anchor",e),c=vx(t,n+"scale",e),d=ga(t,n+"opacity",e),u=W_(t,n+"displacement",e),f=ga(t,n+"rotation",e),m=ef(t,n+"rotate-with-view",e),_=SD(t,n+"anchor-origin"),y=vD(t,n+"anchor-x-units"),g=vD(t,n+"anchor-y-units"),N=dd(t,n+"color");let C,v=null;N!==void 0&&(Array.isArray(N)&&N.length>0&&typeof N[0]=="string"?v=Sx(t,n+"color",e):C=AE(N,n+"color"));const R=Tk(t,n+"cross-origin"),U=Ek(t,n+"offset"),L=SD(t,n+"offset-origin"),w=Qy(t,n+"width"),P=Qy(t,n+"height"),G=Rk(t,n+"size"),K=Dx(t,n+"declutter-mode"),B={src:i,anchorOrigin:_,anchorXUnits:y,anchorYUnits:g,crossOrigin:R,offset:U,offsetOrigin:L,height:P,width:w,size:G,declutterMode:K};let O=null;return function(S){if(O)v&&O.setColor(v(S));else{const A=v?v(S):C;O=new mh(A!==void 0?Object.assign({},B,{color:A}):Object.assign({},B))}return d&&O.setOpacity(d(S)),u&&O.setDisplacement(u(S)),f&&O.setRotation(f(S)),m&&O.setRotateWithView(m(S)),c&&O.setScale(c(S)),l&&O.setAnchor(l(S)),O}}function Sk(t,e){const n="shape-",r=n+"points",i=n+"radius",l=oN(t[r],r);if(!(i in t))throw new Error(`Expected a number for ${i}`);const c=ga(t,i,e),d=typeof t[i]=="number"?t[i]:5,u=n+"radius2",f=ga(t,u,e),m=typeof t[u]=="number"?t[u]:void 0,_=dg(t,n,e),y=ug(t,n,e),g=vx(t,n+"scale",e),N=W_(t,n+"displacement",e),C=ga(t,n+"rotation",e),v=ef(t,n+"rotate-with-view",e),R=Qy(t,n+"angle"),U=Dx(t,n+"declutter-mode"),L=new yx({points:l,radius:d,radius2:m,angle:R,declutterMode:U});return function(w){return c&&L.setRadius(c(w)),f&&L.setRadius2(f(w)),_&&L.setFill(_(w)),y&&L.setStroke(y(w)),N&&L.setDisplacement(N(w)),C&&L.setRotation(C(w)),v&&L.setRotateWithView(v(w)),g&&L.setScale(g(w)),L}}function vk(t,e){const n="circle-",r=dg(t,n,e),i=ug(t,n,e),l=ga(t,n+"radius",e),c=vx(t,n+"scale",e),d=W_(t,n+"displacement",e),u=ga(t,n+"rotation",e),f=ef(t,n+"rotate-with-view",e),m=Dx(t,n+"declutter-mode"),_=new bx({radius:5,declutterMode:m});return function(y){return l&&_.setRadius(l(y)),r&&_.setFill(r(y)),i&&_.setStroke(i(y)),d&&_.setDisplacement(d(y)),u&&_.setRotation(u(y)),f&&_.setRotateWithView(f(y)),c&&_.setScale(c(y)),_}}function dd(t,e){if(!(e in t))return;const n=t[e];return n===void 0?void 0:n}function ga(t,e,n){const r=dd(t,e);if(r===void 0)return;const i=fc(r,Un,n);return function(l){return oN(i(l),e)}}function Vc(t,e,n){const r=dd(t,e);if(r===void 0)return null;const i=fc(r,al,n);return function(l){return PE(i(l),e)}}function Dk(t,e,n){const r=Vc(t,e+"pattern-src",n),i=ND(t,e+"pattern-offset",n),l=ND(t,e+"pattern-size",n),c=Sx(t,e+"color",n);return function(d){return{src:r(d),offset:i&&i(d),size:l&&l(d),color:c&&c(d)}}}function ef(t,e,n){const r=dd(t,e);if(r===void 0)return null;const i=fc(r,Aa,n);return function(l){const c=i(l);if(typeof c!="boolean")throw new Error(`Expected a boolean for ${e}`);return c}}function Sx(t,e,n){const r=dd(t,e);if(r===void 0)return null;const i=fc(r,Eo,n);return function(l){return AE(i(l),e)}}function wE(t,e,n){const r=dd(t,e);if(r===void 0)return null;if(Array.isArray(r)&&(r.length===0||typeof r[0]!="string")){const l=r.map((c,d)=>{if(typeof c=="number")return()=>c;const u=fc(c,Un,n);return function(f){return oN(u(f),`${e}[${d}]`)}});return function(c){const d=new Array(l.length);for(let u=0;u<l.length;++u)d[u]=l[u](c);return d}}const i=fc(r,Nh,n);return function(l){return jg(i(l),e)}}function W_(t,e,n){const r=dd(t,e);if(r===void 0)return null;const i=fc(r,Nh,n);return function(l){const c=jg(i(l),e);if(c.length!==2)throw new Error(`Expected two numbers for ${e}`);return c}}function ND(t,e,n){const r=dd(t,e);if(r===void 0)return null;const i=fc(r,Nh,n);return function(l){return kE(i(l),e)}}function vx(t,e,n){const r=dd(t,e);if(r===void 0)return null;const i=fc(r,Nh|Un,n);return function(l){return jk(i(l),e)}}function Qy(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function Rk(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return cl(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function Tk(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function SD(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function vD(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function Ek(t,e){const n=t[e];if(n!==void 0)return jg(n,e)}function Dx(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function jg(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if(typeof t[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function PE(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function oN(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function AE(t,e){if(typeof t=="string")return t;const n=jg(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function kE(t,e){const n=jg(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function jk(t,e){return typeof t=="number"?t:kE(t,e)}const DD={RENDER_ORDER:"renderOrder"};class UE extends xx{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(DD.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new vE(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(DD.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?LE:e;const n=Ik(e);this.styleFunction_=e===null?void 0:gk(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function Ik(t){if(t===void 0)return LE;if(!t)return null;if(typeof t=="function"||t instanceof cc)return t;if(!Array.isArray(t))return bD([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof cc){const i=new Array(e);for(let l=0;l<e;++l){const c=t[l];if(!(c instanceof cc))throw new Error("Expected a list of style instances");i[l]=c}return i}if("style"in n){const i=new Array(e);for(let l=0;l<e;++l){const c=t[l];if(!("style"in c))throw new Error("Expected a list of rules with a style property");i[l]=c}return xk(i)}return bD(t)}class BE extends cd{constructor(e,n,r,i){super(e),this.inversePixelTransform=n,this.frameState=r,this.context=i}}class Ok extends ax{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){Zn()}calculateMatrices2D(e){const n=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;id(r,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),lE(i,r)}forEachFeatureAtCoordinate(e,n,r,i,l,c,d,u){let f;const m=n.viewState;function _(w,P,G,K){return l.call(c,P,w?G:null,K)}const y=m.projection,g=X5(e.slice(),y),N=[[0,0]];if(y.canWrapX()&&i){const w=y.getExtent(),P=_r(w);N.push([-P,0],[P,0])}const C=n.layerStatesArray,v=C.length,R=[],U=[];for(let w=0;w<N.length;w++)for(let P=v-1;P>=0;--P){const G=C[P],K=G.layer;if(K.hasRenderer()&&sN(G,m)&&d.call(u,K)){const B=K.getRenderer(),O=K.getSource();if(B&&O){const S=O.getWrapX()?g:e,A=_.bind(null,G.managed);U[0]=S[0]+N[w][0],U[1]=S[1]+N[w][1],f=B.forEachFeatureAtCoordinate(U,n,r,A,R)}if(f)return f}}if(R.length===0)return;const L=1/R.length;return R.forEach((w,P)=>w.distanceSq+=P*L),R.sort((w,P)=>w.distanceSq-P.distanceSq),R.some(w=>f=w.callback(w.feature,w.layer,w.geometry)),f}hasFeatureAtCoordinate(e,n,r,i,l,c){return this.forEachFeatureAtCoordinate(e,n,r,i,eg,this,l,c)!==void 0}getMap(){return this.map_}renderFrame(e){Zn()}scheduleExpireIconCache(e){zl.canExpireCache()&&e.postRenderFunctions.push(Mk)}}function Mk(t,e){zl.expire()}class Lk extends Ok{constructor(e){super(e),this.fontChangeListenerKey_=er(W0,Nf.PROPERTYCHANGE,e.redrawText,e),this.element_=$l?_E():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=px+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const r=this.getMap();if(r.hasListener(e)){const i=new BE(e,void 0,n);r.dispatchEvent(i)}}disposeInternal(){Hr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Hl.PRECOMPOSE,e);const n=e.layerStatesArray.sort((f,m)=>f.zIndex-m.zIndex);n.some(f=>f.layer instanceof UE&&f.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const l=[];let c=null;for(let f=0,m=n.length;f<m;++f){const _=n[f];e.layerIndex=f;const y=_.layer,g=y.getSourceState();if(!sN(_,i)||g!="ready"&&g!="undefined"){y.unrender();continue}const N=y.render(e,c);N&&(N!==c&&(this.children_.push(N),c=N),l.push(_))}this.declutter(e,l),QA(this.element_,this.children_);const u=this.getMap().getTargetElement();if(hu(u)){const f=u.getContext("2d");for(const m of this.children_){const _=m.firstElementChild||m,y=m.style.backgroundColor;if(y&&(!hu(_)||_.width>0)&&(f.fillStyle=y,f.fillRect(0,0,u.width,u.height)),hu(_)&&_.width>0){f.save();const g=m.style.opacity||_.style.opacity;f.globalAlpha=g===""?1:Number(g);const N=_.style.transform;if(N)f.transform(...ky(N));else{const C=parseFloat(_.style.width)/_.width,v=parseFloat(_.style.height)/_.height;f.transform(C,0,0,v,0,0)}f.drawImage(_,0,0),f.restore()}}}this.dispatchRenderEvent(Hl.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let r=n.length-1;r>=0;--r){const i=n[r],l=i.layer;l.getDeclutter()&&l.renderDeclutter(e,i)}n.forEach(r=>r.layer.renderDeferred(e))}}}function WE(t){if(t instanceof xx){t.setMapInternal(null);return}t instanceof Lf&&t.getLayers().forEach(WE)}function FE(t,e){if(t instanceof xx){t.setMapInternal(e);return}if(t instanceof Lf){const n=t.getLayers().getArray();for(let r=0,i=n.length;r<i;++r)FE(n[r],e)}}let wk=class extends gc{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=Pk(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:fP,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Io(),this.pixelToCoordinateTransform_=Io(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,$l||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,$l||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||($l?new Vl:$A()),this.interactions=n.interactions||($l?new Vl:g6({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new pP(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Da.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Da.VIEW,this.handleViewChanged_),this.addChangeListener(Da.SIZE,this.handleSizeChanged_),this.addChangeListener(Da.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const r=this;e.view&&!(e.view instanceof ic)&&e.view.then(function(i){r.setView(new ic(i))}),this.controls.addEventListener(il.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(il.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(il.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(il.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(il.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(il.REMOVE,i=>{const l=i.element.getId();l!==void 0&&delete this.overlayIdIndex_[l.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){FE(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){var e;this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),(e=this.resizeObserver_)==null||e.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const l=r.hitTolerance!==void 0?r.hitTolerance:0,c=r.layerFilter!==void 0?r.layerFilter:eg,d=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,l,d,n,null,c,null)}getFeaturesAtPixel(e,n){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},n),r}getAllLayers(){const e=[];function n(r){r.forEach(function(i){i instanceof Lf?n(i.getLayers()):e.push(i)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const i=n.layerFilter!==void 0?n.layerFilter:eg,l=n.hitTolerance!==void 0?n.hitTolerance:0,c=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,l,c,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),l=r.width/i[0],c=r.height/i[1],d="changedTouches"in e?e.changedTouches[0]:e;return[(d.clientX-r.left)/l,(d.clientY-r.top)/c]}getTarget(){return this.get(Da.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Ay(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?ra(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Da.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Vl){n.setLayers(e);return}const r=n.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,r=e.length;n<r;++n){const i=e[n];if(!i.visible)continue;const l=i.layer.getRenderer();if(l&&!l.ready)return!0;const c=i.layer.getSource();if(c&&c.loading)return!0}return!1}getPixelFromCoordinate(e){const n=Gc(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?ra(n.coordinateToPixelTransform,e.slice(0,2)):null}getPixelRatio(){return this.pixelRatio_}setPixelRatio(e){this.pixelRatio_!==e&&(this.pixelRatio_=e,this.render())}getRenderer(){return this.renderer_}getSize(){return this.get(Da.SIZE)}getView(){return this.get(Da.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,r,i){return _P(this.frameState_,e,n,r,i)}handleBrowserEvent(e,n){n=n||e.type;const r=new Zd(n,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,r=n.type;if(r===Ty.POINTERDOWN||r===Rn.WHEEL||r===Rn.KEYDOWN){const i=this.getOwnerDocument(),l=this.viewport_.getRootNode?this.viewport_.getRootNode():i,c=n.target,d=l instanceof ShadowRoot?l.host===c?l.host.ownerDocument:l:l===i?i.documentElement:l;if(this.overlayContainerStopEvent_.contains(c)||!d.contains(c))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let l=i.length-1;l>=0;l--){const c=i[l];if(c.getMap()!==this||!c.getActive()||!this.getTargetElement())continue;if(!c.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let i=this.maxTilesLoading_,l=i;if(e){const c=e.viewHints;if(c[Ra.ANIMATING]||c[Ra.INTERACTING]){const d=Date.now()-e.time>8;i=d?0:8,l=d?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,l))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Hl.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Hl.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new U0(eu.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new U0(eu.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,l=r.length;i<l;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){var r,i;if(this.mapBrowserEventHandler_){for(let l=0,c=this.targetChangeHandlerKeys_.length;l<c;++l)Hr(this.targetChangeHandlerKeys_[l]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Rn.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Rn.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!hu(this.targetElement_)){(r=this.resizeObserver_)==null||r.unobserve(this.targetElement_);const l=this.targetElement_.getRootNode();l instanceof ShadowRoot&&this.resizeObserver_.unobserve(l.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(hu(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Lk(this)),!hu(n)){this.mapBrowserEventHandler_=new mP(this,this.moveTolerance_);for(const c in hi)this.mapBrowserEventHandler_.addEventListener(hi[c],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Rn.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Rn.WHEEL,this.boundHandleBrowserEvent_,F5?{passive:!1}:!1);let l;if(this.keyboardEventTarget_)l=this.keyboardEventTarget_;else{const c=n.getRootNode();l=c instanceof ShadowRoot?c.host:n}if(this.targetChangeHandlerKeys_=[er(l,Rn.KEYDOWN,this.handleBrowserEvent,this),er(l,Rn.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const c=n.getRootNode();c instanceof ShadowRoot&&this.resizeObserver_.observe(c.host),(i=this.resizeObserver_)==null||i.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Hr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Hr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=er(e,Nf.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=er(e,Rn.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Hr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new tu("addlayer",e)),this.layerGroupPropertyListenerKeys_=[er(e,Nf.PROPERTYCHANGE,this.render,this),er(e,Rn.CHANGE,this.render,this),er(e,"addlayer",this.handleLayerAdd_,this),er(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,r=e.length;n<r;++n){const i=e[n].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){WE(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),r=this.getView(),i=this.frameState_;let l=null;if(n!==void 0&&fD(n)&&r&&r.isDef()){const c=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),d=r.getState();if(l={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:My(d.center,d.resolution,d.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:d,viewHints:c,wantedTiles:{},mapId:tr(this),renderTargets:{}},d.nextCenter&&d.nextResolution){const u=isNaN(d.nextRotation)?d.rotation:d.nextRotation;l.nextExtent=My(d.nextCenter,d.nextResolution,u,n)}}this.frameState_=l,this.renderer_.renderFrame(l),l&&(l.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,l.postRenderFunctions),i&&(!this.previousExtent_||!Dg(this.previousExtent_)&&!sg(l.extent,this.previousExtent_))&&(this.dispatchEvent(new U0(eu.MOVESTART,this,i)),this.previousExtent_=dx(this.previousExtent_)),this.previousExtent_&&!l.viewHints[Ra.ANIMATING]&&!l.viewHints[Ra.INTERACTING]&&!sg(l.extent,this.previousExtent_)&&(this.dispatchEvent(new U0(eu.MOVEEND,this,l)),K5(l.extent,this.previousExtent_))),this.dispatchEvent(new U0(eu.POSTRENDER,this,l)),this.renderComplete_=(this.hasListener(eu.LOADSTART)||this.hasListener(eu.LOADEND)||this.hasListener(Hl.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new tu("removelayer",n)),this.set(Da.LAYERGROUP,e)}setSize(e){this.set(Da.SIZE,e)}setTarget(e){this.set(Da.TARGET,e)}setView(e){if(!e||e instanceof ic){this.set(Da.VIEW,e);return}this.set(Da.VIEW,new ic);const n=this;e.then(function(r){n.setView(new ic(r))})}updateSize(){const e=this.getTargetElement();let n;if(e){let i,l;if(hu(e)){const c=e.getContext("2d").getTransform();i=e.width/c.a,l=e.height/c.d}else{const c=getComputedStyle(e);i=e.offsetWidth-parseFloat(c.borderLeftWidth)-parseFloat(c.paddingLeft)-parseFloat(c.paddingRight)-parseFloat(c.borderRightWidth),l=e.offsetHeight-parseFloat(c.borderTopWidth)-parseFloat(c.paddingTop)-parseFloat(c.paddingBottom)-parseFloat(c.borderBottomWidth)}!isNaN(i)&&!isNaN(l)&&(n=[Math.max(0,i),Math.max(0,l)],!fD(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Z5("No map visible because the map container's width or height are 0."))}const r=this.getSize();n&&(!r||!Du(n,r))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function Pk(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new Lf({layers:t.layers});n[Da.LAYERGROUP]=r,n[Da.TARGET]=t.target,n[Da.VIEW]=t.view instanceof ic?t.view:new ic;let i;t.controls!==void 0&&(Array.isArray(t.controls)?i=new Vl(t.controls.slice()):(dr(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls));let l;t.interactions!==void 0&&(Array.isArray(t.interactions)?l=new Vl(t.interactions.slice()):(dr(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),l=t.interactions));let c;return t.overlays!==void 0?Array.isArray(t.overlays)?c=new Vl(t.overlays.slice()):(dr(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),c=t.overlays):c=new Vl,{controls:i,interactions:l,keyboardEventTarget:e,overlays:c,values:n}}class cN extends ox{constructor(e,n,r){super(),r=r||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Rn.CHANGE)}release(){this.setState(ln.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ln.EMPTY){if(this.state!==ln.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Zn()}getAlpha(e,n){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=n,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=n-r+1e3/60;return i>=this.transition_?1:J5(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Gy(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const Ak=new Error("disposed"),kk=[256,256];class RD extends cN{constructor(e){const n=ln.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Gy(this.data_);return e?[e.width,e.height]:kk}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ln.IDLE&&this.state!==ln.ERROR)return;this.state=ln.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=ln.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=ln.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Ak),this.controller_=null),super.disposeInternal()}}class KE extends cN{constructor(e,n,r,i,l,c){super(e,n,c),this.crossOrigin_=i==null?void 0:i.crossOrigin,this.referrerPolicy_=i==null?void 0:i.referrerPolicy,this.src_=r,this.key=r,this.image_,$l?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)),this.unlisten_=null,this.tileLoadFunction_=l}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ln.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}getReferrerPolicy(){return this.referrerPolicy_}handleImageError_(){this.state=ln.ERROR,this.unlistenImage_(),this.image_=Uk(),this.changed()}handleImageLoad_(){if($l)this.state=ln.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ln.LOADED:this.state=ln.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==ln.ERROR&&(this.state=ln.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)),this.state==ln.IDLE&&(this.state=ln.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=sk(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Uk(){const t=Ii(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}class dN{constructor(e,n,r,i){this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function T0(t,e,n,r,i){return i!==void 0?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new dN(t,e,n,r)}let vC;const tf=[];function TD(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function DC(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function Bk(){if(vC===void 0){const t=Ii(6,6,tf);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",TD(t,4,5,4,0),TD(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;vC=DC(e,0)||DC(e,4)||DC(e,8),_x(t),tf.push(t.canvas)}return vC}function ED(t,e,n,r){const i=Qb(n,e,t);let l=Xv(e,r,n);const c=e.getMetersPerUnit();c!==void 0&&(l*=c);const d=t.getMetersPerUnit();d!==void 0&&(l/=d);const u=t.getExtent();if(!u||vf(u,i)){const f=Xv(t,l,i)/l;isFinite(f)&&f>0&&(l/=f)}return l}function Wk(t,e,n,r){const i=yh(n);let l=ED(t,e,i,r);return(!isFinite(l)||l<=0)&&$5(n,function(c){return l=ED(t,e,c,r),isFinite(l)&&l>0}),l}function Fk(t,e,n,r,i,l,c,d,u,f,m,_,y,g){const N=Ii(Math.round(n*t),Math.round(n*e),tf);if(_||(N.imageSmoothingEnabled=!1),u.length===0)return N.canvas;N.scale(n,n);function C(P){return Math.round(P*n)/n}N.globalCompositeOperation="lighter";const v=Zl();u.forEach(function(P,G,K){bP(v,P.extent)});let R;const U=n/r,L=(_?1:1+Math.pow(2,-24))/U;R=Ii(Math.round(_r(v)*U),Math.round(Ua(v)*U),tf),_||(R.imageSmoothingEnabled=!1),u.forEach(function(P,G,K){if(P.image.width>0&&P.image.height>0){if(P.clipExtent){R.save();const Y=(P.clipExtent[0]-v[0])*U,te=-(P.clipExtent[3]-v[3])*U,J=_r(P.clipExtent)*U,q=Ua(P.clipExtent)*U;R.rect(_?Y:Math.round(Y),_?te:Math.round(te),_?J:Math.round(Y+J)-Math.round(Y),_?q:Math.round(te+q)-Math.round(te)),R.clip()}const B=(P.extent[0]-v[0])*U,O=-(P.extent[3]-v[3])*U,S=_r(P.extent)*U,A=Ua(P.extent)*U;R.drawImage(P.image,f,f,P.image.width-2*f,P.image.height-2*f,_?B:Math.round(B),_?O:Math.round(O),_?S:Math.round(B+S)-Math.round(B),_?A:Math.round(O+A)-Math.round(O)),P.clipExtent&&R.restore()}});const w=Lh(c);return d.getTriangles().forEach(function(P,G,K){const B=P.source,O=P.target;let S=B[0][0],A=B[0][1],Y=B[1][0],te=B[1][1],J=B[2][0],q=B[2][1];const V=C((O[0][0]-w[0])/l),F=C(-(O[0][1]-w[1])/l),I=C((O[1][0]-w[0])/l),ee=C(-(O[1][1]-w[1])/l),ae=C((O[2][0]-w[0])/l),T=C(-(O[2][1]-w[1])/l),j=S,k=A;S=0,A=0,Y-=j,te-=k,J-=j,q-=k;const Q=[[Y,te,0,0,I-V],[J,q,0,0,ae-V],[0,0,Y,te,ee-F],[0,0,J,q,T-F]],H=CP(Q);if(!H)return;if(N.save(),N.beginPath(),Bk()||!_){N.moveTo(I,ee);const ie=4,fe=V-I,pe=F-ee;for(let de=0;de<ie;de++)N.lineTo(I+C((de+1)*fe/ie),ee+C(de*pe/(ie-1))),de!=ie-1&&N.lineTo(I+C((de+1)*fe/ie),ee+C((de+1)*pe/(ie-1)));N.lineTo(ae,T)}else N.moveTo(I,ee),N.lineTo(V,F),N.lineTo(ae,T);N.clip(),N.transform(H[0],H[2],H[1],H[3],V,F),N.translate(v[0]-j,v[3]-k);let $;if(R)$=R.canvas,N.scale(L,-L);else{const ie=u[0],fe=ie.extent;$=ie.image,N.scale(_r(fe)/$.width,-Ua(fe)/$.height)}N.drawImage($,0,0),N.restore()}),R&&(_x(R),tf.push(R.canvas)),m&&(N.save(),N.globalCompositeOperation="source-over",N.strokeStyle="black",N.lineWidth=1,d.getTriangles().forEach(function(P,G,K){const B=P.target,O=(B[0][0]-w[0])/l,S=-(B[0][1]-w[1])/l,A=(B[1][0]-w[0])/l,Y=-(B[1][1]-w[1])/l,te=(B[2][0]-w[0])/l,J=-(B[2][1]-w[1])/l;N.beginPath(),N.moveTo(A,Y),N.lineTo(O,S),N.lineTo(te,J),N.closePath(),N.stroke()}),N.restore()),N.canvas}const Kk=10,jD=.25;class Qk{constructor(e,n,r,i,l,c,d){this.sourceProj_=e,this.targetProj_=n;let u={};const f=d?iA(L=>ra(d,Qb(L,this.targetProj_,this.sourceProj_))):A_(this.targetProj_,this.sourceProj_);this.transformInv_=function(L){const w=L[0]+"/"+L[1];return u[w]||(u[w]=f(L)),u[w]},this.maxSourceExtent_=i,this.errorThresholdSquared_=l*l,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&_r(i)>=_r(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?_r(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?_r(this.targetProj_.getExtent()):null;const m=Lh(r),_=fx(r),y=hx(r),g=ux(r),N=this.transformInv_(m),C=this.transformInv_(_),v=this.transformInv_(y),R=this.transformInv_(g),U=Kk+(c?Math.max(0,Math.ceil(Math.log2(Oy(r)/(c*c*256*256)))):0);if(this.addQuad_(m,_,y,g,N,C,v,R,U),this.wrapsXInSource_){let L=1/0;this.triangles_.forEach(function(w,P,G){L=Math.min(L,w.source[0][0],w.source[1][0],w.source[2][0])}),this.triangles_.forEach(w=>{if(Math.max(w.source[0][0],w.source[1][0],w.source[2][0])-L>this.sourceWorldWidth_/2){const P=[[w.source[0][0],w.source[0][1]],[w.source[1][0],w.source[1][1]],[w.source[2][0],w.source[2][1]]];P[0][0]-L>this.sourceWorldWidth_/2&&(P[0][0]-=this.sourceWorldWidth_),P[1][0]-L>this.sourceWorldWidth_/2&&(P[1][0]-=this.sourceWorldWidth_),P[2][0]-L>this.sourceWorldWidth_/2&&(P[2][0]-=this.sourceWorldWidth_);const G=Math.min(P[0][0],P[1][0],P[2][0]);Math.max(P[0][0],P[1][0],P[2][0])-G<this.sourceWorldWidth_/2&&(w.source=P)}})}u={}}addTriangle_(e,n,r,i,l,c){this.triangles_.push({source:[i,l,c],target:[e,n,r]})}addQuad_(e,n,r,i,l,c,d,u,f){const m=jy([l,c,d,u]),_=this.sourceWorldWidth_?_r(m)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&_>.5&&_<1;let N=!1;if(f>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const v=jy([e,n,r,i]);N=_r(v)/this.targetWorldWidth_>jD||N}!g&&this.sourceProj_.isGlobal()&&_&&(N=_>jD||N)}if(!N&&this.maxSourceExtent_&&isFinite(m[0])&&isFinite(m[1])&&isFinite(m[2])&&isFinite(m[3])&&!ol(m,this.maxSourceExtent_))return;let C=0;if(!N&&(!isFinite(l[0])||!isFinite(l[1])||!isFinite(c[0])||!isFinite(c[1])||!isFinite(d[0])||!isFinite(d[1])||!isFinite(u[0])||!isFinite(u[1]))){if(f>0)N=!0;else if(C=(!isFinite(l[0])||!isFinite(l[1])?8:0)+(!isFinite(c[0])||!isFinite(c[1])?4:0)+(!isFinite(d[0])||!isFinite(d[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),C!=1&&C!=2&&C!=4&&C!=8)return}if(f>0){if(!N){const v=[(e[0]+r[0])/2,(e[1]+r[1])/2],R=this.transformInv_(v);let U;g?U=(X0(l[0],y)+X0(d[0],y))/2-X0(R[0],y):U=(l[0]+d[0])/2-R[0];const L=(l[1]+d[1])/2-R[1];N=U*U+L*L>this.errorThresholdSquared_}if(N){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const v=[(n[0]+r[0])/2,(n[1]+r[1])/2],R=this.transformInv_(v),U=[(i[0]+e[0])/2,(i[1]+e[1])/2],L=this.transformInv_(U);this.addQuad_(e,n,v,U,l,c,R,L,f-1),this.addQuad_(U,v,r,i,L,R,d,u,f-1)}else{const v=[(e[0]+n[0])/2,(e[1]+n[1])/2],R=this.transformInv_(v),U=[(r[0]+i[0])/2,(r[1]+i[1])/2],L=this.transformInv_(U);this.addQuad_(e,v,U,i,l,R,L,u,f-1),this.addQuad_(v,n,r,U,R,c,d,L,f-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(C&11)==0&&this.addTriangle_(e,r,i,l,d,u),(C&14)==0&&this.addTriangle_(e,r,n,l,d,c),C&&((C&13)==0&&this.addTriangle_(n,i,e,c,u,l),(C&7)==0&&this.addTriangle_(n,i,r,c,u,d))}calculateSourceExtent(){const e=Zl();return this.triangles_.forEach(function(n,r,i){const l=n.source;Ym(e,l[0]),Ym(e,l[1]),Ym(e,l[2])}),e}getTriangles(){return this.triangles_}}const Gk=.5;class QE extends cN{constructor(e,n,r,i,l,c,d,u,f,m,_,y){super(l,ln.IDLE,y),this.renderEdges_=_!==void 0?_:!1,this.pixelRatio_=d,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=i,this.wrappedTileCoord_=c||l,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const g=i.getTileCoordExtent(this.wrappedTileCoord_),N=this.targetTileGrid_.getExtent();let C=this.sourceTileGrid_.getExtent();const v=N?fh(g,N):g;if(Oy(v)===0){this.state=ln.EMPTY;return}const R=e.getExtent();R&&(C?C=fh(C,R):C=R);const U=i.getResolution(this.wrappedTileCoord_[0]),L=Wk(e,r,v,U);if(!isFinite(L)||L<=0){this.state=ln.EMPTY;return}const w=m!==void 0?m:Gk;if(this.triangulation_=new Qk(e,r,v,C,L*w,U),this.triangulation_.getTriangles().length===0){this.state=ln.EMPTY;return}this.sourceZ_=n.getZForResolution(L);let P=this.triangulation_.calculateSourceExtent();if(C&&(e.canWrapX()?(P[1]=zr(P[1],C[1],C[3]),P[3]=zr(P[3],C[1],C[3])):P=fh(P,C)),!Oy(P))this.state=ln.EMPTY;else{let G=0,K=0;e.canWrapX()&&(G=_r(R),K=Math.floor((P[0]-R[0])/G)),q5(P.slice(),e,!0).forEach(O=>{const S=n.getTileRangeForExtentAndZ(O,this.sourceZ_);for(let A=S.minX;A<=S.maxX;A++)for(let Y=S.minY;Y<=S.maxY;Y++){const te=K*G;this.sourceTiles_.push({getTile:()=>f(this.sourceZ_,A,Y,d),offset:te})}++K}),this.sourceTiles_.length===0&&(this.state=ln.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{var i;const r=n.tile;if(r&&r.getState()==ln.LOADED){const l=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);l[0]+=n.offset,l[2]+=n.offset;const c=(i=this.clipExtent_)==null?void 0:i.slice();c&&(c[0]+=n.offset,c[2]+=n.offset),e.push({extent:l,clipExtent:c,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=ln.ERROR;else{const n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i=typeof r=="number"?r:r[0],l=typeof r=="number"?r:r[1],c=this.targetTileGrid_.getResolution(n),d=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Fk(i,l,this.pixelRatio_,d,this.sourceTileGrid_.getExtent(),c,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ln.LOADED}this.changed()}load(){for(const e of this.sourceTiles_)e.tile=e.getTile();if(this.state==ln.IDLE){this.state=ln.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const r=n.getState();if(r==ln.IDLE||r==ln.LOADING){e++;const i=er(n,Rn.CHANGE,l=>{const c=n.getState();(c==ln.LOADED||c==ln.ERROR||c==ln.EMPTY)&&(Hr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},r,i){n.getState()==ln.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Hr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(_x(this.canvas_.getContext("2d")),tf.push(this.canvas_),this.canvas_=null),this.sourceTiles_.length=0,super.release()}}class ID{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof ax&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const r=this.entries_[e];return dr(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const n=this.entries_[e];return dr(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.key_;return e}getValues(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var n;return(n=this.entries_[e])==null?void 0:n.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){dr(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function F_(t,e,n,r){return r!==void 0?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function Yk(t,e,n){return t+"/"+e+"/"+n}function d_(t,e,n,r,i){return`${tr(t)},${e},${Yk(n,r,i)}`}function Vk(t){return $k(t[0],t[1],t[2])}function $k(t,e,n){return(e<<t)+n}function Hk(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const l=e.getFullTileRange(n);return l?l.containsXY(r,i):!0}class GE{constructor(){lr(this,"pushMethodArgs_",(...e)=>(this.push_(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(U_(),{get:(e,n)=>{if(typeof U_()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,r)=>(this.push_(n,r),!0)})}push_(...e){const n=this.instructions_,r=this.zIndex+this.offset_;n[r]||(n[r]=[]),n[r].push(...e)}pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let r=0,i=n.length;r<i;++r){const l=n[r];if(typeof l=="function"){l(e);continue}const c=n[++r];if(typeof e[l]=="function")e[l](...c);else{if(typeof c=="function"){e[l]=c(e);continue}e[l]=c}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const zk=5;class qk extends vg{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=zk}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Zn()}getData(e){return null}prepareFrame(e){return Zn()}renderFrame(e,n){return Zn()}forEachFeatureAtCoordinate(e,n,r,i,l){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===Sn.LOADED||n.getState()===Sn.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=Sn.LOADED&&n!=Sn.ERROR&&e.addEventListener(Rn.CHANGE,this.boundHandleImageChange_),n==Sn.IDLE&&(e.load(),n=e.getState()),n==Sn.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const OD=[];let F0=null;function Xk(){F0=Ii(1,1,void 0,{willReadFrequently:!0})}class YE extends qk{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Io(),this.pixelTransform=Io(),this.inversePixelTransform=Io(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,r){F0||Xk(),F0.clearRect(0,0,1,1);let i;try{F0.drawImage(e,n,r,1,1,0,0,1,1),i=F0.getImageData(0,0,1,1).data}catch{return F0=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,n,r){const i=this.getLayer().getClassName();let l,c;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&Du(bh(e.style.backgroundColor),bh(r)))){const d=e.firstElementChild;hu(d)&&(c=d.getContext("2d"))}if(c&&uA(c.canvas.style.transform,n)?(this.container=e,this.context=c,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){l=$l?_E():document.createElement("div"),l.className=i;let d=l.style;d.position="absolute",d.width="100%",d.height="100%",c=Ii();const u=c.canvas;l.appendChild(u),d=u.style,d.position="absolute",d.left="0",d.transformOrigin="top left",this.container=l,this.context=c}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,n,r){const i=Lh(r),l=fx(r),c=hx(r),d=ux(r);ra(n.coordinateToPixelTransform,i),ra(n.coordinateToPixelTransform,l),ra(n.coordinateToPixelTransform,c),ra(n.coordinateToPixelTransform,d);const u=this.inversePixelTransform;ra(u,i),ra(u,l),ra(u,c),ra(u,d),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.lineTo(Math.round(c[0]),Math.round(c[1])),e.lineTo(Math.round(d[0]),Math.round(d[1])),e.clip()}prepareContainer(e,n){const r=e.extent,i=e.viewState.resolution,l=e.viewState.rotation,c=e.pixelRatio,d=Math.round(_r(r)/i*c),u=Math.round(Ua(r)/i*c);id(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/c,1/c,l,-d/2,-u/2),lE(this.inversePixelTransform,this.pixelTransform);const f=dA(this.pixelTransform);if(this.useContainer(n,f,this.getBackground(e)),!this.containerReused){const m=this.context.canvas;m.width!=d||m.height!=u?(m.width=d,m.height=u):this.context.clearRect(0,0,d,u),f!==m.style.transform&&(m.style.transform=f)}}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){const l=new BE(e,this.inversePixelTransform,r,n);i.dispatchEvent(l)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(Hl.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(Hl.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new GE),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Hl.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Hl.POSTRENDER,this.context,e))}getRenderTransform(e,n,r,i,l,c,d){const u=l/2,f=c/2,m=i/n,_=-m,y=-e[0]+d,g=-e[1];return id(this.tempTransform,u,f,m,_,-r,y,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function RC(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function Jk(t,e,n){const r=t[n];return r?r.delete(e):!1}function MD(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=fh(e,uu(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=fh(e,i))}return e}class Zk extends YE{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zl(),this.tempTileRange_=new dN(0,0,0,0),this.tempTileCoord_=F_(0,0,0);const r=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new ID(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new ID(512)),this.sourceTileCache_}getOrCreateTile(e,n,r,i){const l=this.tileCache_,d=this.getLayer().getSource(),u=d_(d,d.getKey(),e,n,r);let f;if(l.containsKey(u))f=l.get(u);else{const m=i.viewState.projection,_=d.getProjection();if(f=d.getTile(e,n,r,i.pixelRatio,m,!_||c_(_,m)?void 0:this.getSourceTileCache()),!f)return null;l.set(u,f)}return f}getTile(e,n,r,i){const l=this.getOrCreateTile(e,n,r,i);return l||null}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=ra(n.pixelToCoordinateTransform,e.slice()),l=r.getExtent();if(l&&!vf(l,i))return null;const c=n.viewState,d=r.getRenderSource(),u=d.getTileGridForProjection(c.projection),f=d.getTilePixelRatio(n.pixelRatio);for(let m=u.getZForResolution(c.resolution);m>=u.getMinZoom();--m){const _=u.getTileCoordForCoordAndZ(i,m),y=this.getTile(m,_[1],_[2],n);if(!y||y.getState()!==ln.LOADED)continue;const g=u.getOrigin(m),N=cl(u.getTileSize(m)),C=u.getResolution(m);let v;if(y instanceof KE||y instanceof QE)v=y.getImage();else if(y instanceof RD){if(v=Gy(y.getData()),!v)continue}else continue;const R=Math.floor(f*((i[0]-g[0])/C-_[1]*N[0])),U=Math.floor(f*((g[1]-i[1])/C-_[2]*N[1])),L=Math.round(f*d.getGutterForProjection(c.projection));return this.getImageData(v,R+L,U+L)}return null}prepareFrame(e){var i;this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const r=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),(i=this.sourceTileCache_)==null||i.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,r,i,l){const c=e.viewState,d=this.getLayer(),u=d.getRenderSource(),f=u.getTileGridForProjection(c.projection),m=tr(u);m in e.wantedTiles||(e.wantedTiles[m]={});const _=e.wantedTiles[m],y=d.getMapInternal(),g=Math.max(r-l,f.getMinZoom(),f.getZForResolution(Math.min(d.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(d.getMinZoom(),0)):f.getResolution(0)),u.zDirection)),N=c.rotation,C=N?H5(c.center,c.resolution,N,e.size):void 0;for(let v=r;v>=g;--v){const R=f.getTileRangeForExtentAndZ(n,v,this.tempTileRange_),U=f.getResolution(v);for(let L=R.minX;L<=R.maxX;++L)for(let w=R.minY;w<=R.maxY;++w){if(N&&!f.tileCoordIntersectsViewport([v,L,w],C))continue;const P=this.getTile(v,L,w,e);if(!P||!RC(i,P,v))continue;const K=P.getKey();if(_[K]=!0,P.getState()===ln.IDLE&&!e.tileQueue.isKeyQueued(K)){const B=F_(v,L,w,this.tempTileCoord_);e.tileQueue.enqueue([P,m,f.getTileCoordCenter(B),U])}}}}findStaleTile_(e,n){const r=this.tileCache_,i=e[0],l=e[1],c=e[2],d=this.getStaleKeys();for(let u=0;u<d.length;++u){const f=d_(this.getLayer().getSource(),d[u],i,l,c);if(r.containsKey(f)){const m=r.peek(f);if(m.getState()===ln.LOADED)return m.endTransition(tr(this)),RC(n,m,i),!0}}return!1}findAltTiles_(e,n,r,i){const l=e.getTileRangeForTileCoordAndZ(n,r,this.tempTileRange_);if(!l)return!1;let c=!0;const d=this.tileCache_,u=this.getLayer().getRenderSource(),f=u.getKey();for(let m=l.minX;m<=l.maxX;++m)for(let _=l.minY;_<=l.maxY;++_){const y=d_(u,f,r,m,_);let g=!1;if(d.containsKey(y)){const N=d.peek(y);N.getState()===ln.LOADED&&(RC(i,N,r),g=!0)}g||(c=!1)}return c}renderFrame(e,n){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,l=i.projection,c=i.resolution,d=i.center,u=e.pixelRatio,f=this.getLayer(),m=f.getSource(),_=m.getTileGridForProjection(l),y=_.getZForResolution(c,m.zDirection),g=_.getResolution(y),N=m.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==N&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=N):this.renderedSourceKey_=N;let C=e.extent;const v=m.getTilePixelRatio(u);this.prepareContainer(e,n);const R=this.context.canvas.width,U=this.context.canvas.height,L=r.extent&&uu(r.extent);L&&(C=fh(C,uu(r.extent)));const w=g*R/2/v,P=g*U/2/v,G=[d[0]-w,d[1]-P,d[0]+w,d[1]+P],K={};this.renderedTiles.length=0;const B=f.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const I=_.getZForResolution(i.nextResolution,m.zDirection),ee=MD(e,e.nextExtent);this.enqueueTiles(e,ee,I,K,B)}const O=MD(e,C);if(this.enqueueTiles(e,O,y,K,0),B>0&&setTimeout(()=>{this.enqueueTiles(e,O,y-1,K,B-1)},0),!(y in K))return this.container;const S=tr(this),A=e.time;for(const I of K[y]){const ee=I.getState();if(ee===ln.EMPTY)continue;const ae=I.tileCoord;if(ee===ln.LOADED&&I.getAlpha(S,A)===1){I.endTransition(S);continue}if(ee!==ln.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ae,K)){Jk(K,I,y),e.animate=!0;continue}if(this.findAltTiles_(_,ae,y+1,K))continue;const k=_.getMinZoom();for(let Q=y-1;Q>=k&&!this.findAltTiles_(_,ae,Q,K);--Q);}const Y=g/c*u/v,te=this.getRenderContext(e);id(this.tempTransform,R/2,U/2,Y,Y,0,-R/2,-U/2),r.extent&&this.clipUnrotated(te,e,L),m.getInterpolate()||(te.imageSmoothingEnabled=!1),this.preRender(te,e);const J=Object.keys(K).map(Number);J.sort(Jc);let q;const V=[],F=[];for(let I=J.length-1;I>=0;--I){const ee=J[I],ae=m.getTilePixelSize(ee,u,l),j=_.getResolution(ee)/g,k=ae[0]*j*Y,Q=ae[1]*j*Y,H=_.getTileCoordForCoordAndZ(Lh(G),ee),$=_.getTileCoordExtent(H),ie=ra(this.tempTransform,[v*($[0]-G[0])/g,v*(G[3]-$[3])/g]),fe=v*m.getGutterForProjection(l);for(const pe of K[ee]){if(pe.getState()!==ln.LOADED)continue;const de=pe.tileCoord,Re=H[1]-de[1],X=Math.round(ie[0]-(Re-1)*k),_e=H[2]-de[2],me=Math.round(ie[1]-(_e-1)*Q),Z=Math.round(ie[0]-Re*k),le=Math.round(ie[1]-_e*Q),se=X-Z,Ee=me-le,Ne=J.length===1;let ye=!1;q=[Z,le,Z+se,le,Z+se,le+Ee,Z,le+Ee];for(let ne=0,ue=V.length;ne<ue;++ne)if(!Ne&&ee<F[ne]){const xe=V[ne];ol([Z,le,Z+se,le+Ee],[xe[0],xe[3],xe[4],xe[7]])&&(ye||(te.save(),ye=!0),te.beginPath(),te.moveTo(q[0],q[1]),te.lineTo(q[2],q[3]),te.lineTo(q[4],q[5]),te.lineTo(q[6],q[7]),te.moveTo(xe[6],xe[7]),te.lineTo(xe[4],xe[5]),te.lineTo(xe[2],xe[3]),te.lineTo(xe[0],xe[1]),te.clip())}V.push(q),F.push(ee),this.drawTile(pe,e,Z,le,se,Ee,fe,Ne),ye&&te.restore(),this.renderedTiles.unshift(pe),this.updateUsedTiles(e.usedTiles,m,pe)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!sg(this.renderedExtent_,G),this.renderedExtent_=G,this.renderedPixelRatio=u,this.postRender(this.context,e),r.extent&&te.restore(),te.imageSmoothingEnabled=!0,this.renderComplete){const I=(ee,ae)=>{var Q;const T=tr(m),j=ae.wantedTiles[T],k=j?Object.keys(j).length:0;this.updateCacheSize(k),this.tileCache_.expireCache(),(Q=this.sourceTileCache_)==null||Q.expireCache()};e.postRenderFunctions.push(I)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,r,i,l,c,d,u){let f;if(e instanceof RD){if(f=Gy(e.getData()),!f)throw new Error("Rendering array data is not yet supported")}else f=this.getTileImage(e);if(!f)return;const m=this.getRenderContext(n),_=tr(this),y=n.layerStatesArray[n.layerIndex],g=y.opacity*(u?e.getAlpha(_,n.time):1),N=g!==m.globalAlpha;N&&(m.save(),m.globalAlpha=g),m.drawImage(f,d,d,f.width-2*d,f.height-2*d,r,i,l,c),N&&m.restore(),g!==y.opacity?n.animate=!0:u&&e.endTransition(_)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,r){const i=tr(n);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Kp={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class e8 extends xx{constructor(e){e=e||{};const n=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Kp.PRELOAD)}setPreload(e){this.set(Kp.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Kp.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Kp.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class t8 extends e8{constructor(e){super(e)}createRenderer(){return new Zk(this,{cacheSize:this.getCacheSize()})}}class VE{drawCustom(e,n,r,i,l){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,r){}drawFeature(e,n,r){}drawGeometryCollection(e,n,r){}drawLineString(e,n,r){}drawMultiLineString(e,n,r){}drawMultiPoint(e,n,r){}drawMultiPolygon(e,n,r){}drawPoint(e,n,r){}drawPolygon(e,n,r){}drawText(e,n,r){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const an={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Qp=[an.FILL],fu=[an.STROKE],nh=[an.BEGIN_PATH],LD=[an.CLOSE_PATH];class Ig extends VE{constructor(e,n,r,i){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(r){return r*n})}appendFlatPointCoordinates(e,n){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,l=this.coordinates;let c=l.length;for(let d=0,u=e.length;d<u;d+=n)i[0]=e[d],i[1]=e[d+1],vf(r,i)&&(l[c++]=i[0],l[c++]=i[1]);return c}appendFlatLineCoordinates(e,n,r,i,l,c){const d=this.coordinates;let u=d.length;const f=this.getBufferedMaxExtent();c&&(n+=i);let m=e[n],_=e[n+1];const y=this.tmpCoordinate_;let g=!0,N,C,v;for(N=n+i;N<r;N+=i)y[0]=e[N],y[1]=e[N+1],v=Iy(f,y),v!==C?(g&&(d[u++]=m,d[u++]=_,g=!1),d[u++]=y[0],d[u++]=y[1]):v===na.INTERSECTING?(d[u++]=y[0],d[u++]=y[1],g=!1):g=!0,m=y[0],_=y[1],C=v;return(l&&g||N===n+i)&&(d[u++]=m,d[u++]=_),u}drawCustomCoordinates_(e,n,r,i,l){for(let c=0,d=r.length;c<d;++c){const u=r[c],f=this.appendFlatLineCoordinates(e,n,u,i,!1,!1);l.push(f),n=u}return n}drawCustom(e,n,r,i,l){this.beginGeometry(e,n,l);const c=e.getType(),d=e.getStride(),u=this.coordinates.length;let f,m,_,y,g;switch(c){case"MultiPolygon":f=e.getOrientedFlatCoordinates(),y=[];const N=e.getEndss();g=0;for(let C=0,v=N.length;C<v;++C){const R=[];g=this.drawCustomCoordinates_(f,g,N[C],d,R),y.push(R)}this.instructions.push([an.CUSTOM,u,y,e,r,sD,l]),this.hitDetectionInstructions.push([an.CUSTOM,u,y,e,i||r,sD,l]);break;case"Polygon":case"MultiLineString":_=[],f=c=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),g=this.drawCustomCoordinates_(f,0,e.getEnds(),d,_),this.instructions.push([an.CUSTOM,u,_,e,r,k_,l]),this.hitDetectionInstructions.push([an.CUSTOM,u,_,e,i||r,k_,l]);break;case"LineString":case"Circle":f=e.getFlatCoordinates(),m=this.appendFlatLineCoordinates(f,0,f.length,d,!1,!1),this.instructions.push([an.CUSTOM,u,m,e,r,Y0,l]),this.hitDetectionInstructions.push([an.CUSTOM,u,m,e,i||r,Y0,l]);break;case"MultiPoint":f=e.getFlatCoordinates(),m=this.appendFlatPointCoordinates(f,d),m>u&&(this.instructions.push([an.CUSTOM,u,m,e,r,Y0,l]),this.hitDetectionInstructions.push([an.CUSTOM,u,m,e,i||r,Y0,l]));break;case"Point":f=e.getFlatCoordinates(),this.coordinates.push(f[0],f[1]),m=this.coordinates.length,this.instructions.push([an.CUSTOM,u,m,e,r,void 0,l]),this.hitDetectionInstructions.push([an.CUSTOM,u,m,e,i||r,void 0,l]);break}this.endGeometry(n)}beginGeometry(e,n,r){this.beginGeometryInstruction1_=[an.BEGIN_GEOMETRY,n,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[an.BEGIN_GEOMETRY,n,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const r=e.length;let i,l,c=-1;for(n=0;n<r;++n)i=e[n],l=i[0],l==an.END_GEOMETRY?c=n:l==an.BEGIN_GEOMETRY&&(i[2]=n,aP(this.hitDetectionInstructions,c,n),c=-1)}fillStyleToState(e,n={}){if(e){const r=e.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=lc(r||ll)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const r=e.getColor();n.strokeStyle=lc(r||lg);const i=e.getLineCap();n.lineCap=i!==void 0?i:Rf;const l=e.getLineDash();n.lineDash=l?l.slice():Zc;const c=e.getLineDashOffset();n.lineDashOffset=c||ed;const d=e.getLineJoin();n.lineJoin=d!==void 0?d:Tf;const u=e.getWidth();n.lineWidth=u!==void 0?u:cg;const f=e.getMiterLimit();n.miterLimit=f!==void 0?f:ag;const m=e.getOffset();n.strokeOffset=m??lk,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0,n.strokeOffset=void 0;return n}setFillStrokeStyle(e,n){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(n,r)}createFill(e){const n=e.fillStyle,r=[an.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[an.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,n){const r=e.strokeStyle,i=e.lineCap,l=e.lineDash,c=e.lineDashOffset,d=e.lineJoin,u=e.lineWidth,f=e.miterLimit,m=e.strokeOffset;(e.currentStrokeStyle!=r||e.currentLineCap!=i||l!=e.currentLineDash&&!Du(e.currentLineDash,l)||e.currentLineDashOffset!=c||e.currentLineJoin!=d||e.currentLineWidth!=u||e.currentMiterLimit!=f||e.currentStrokeOffset!=m)&&(n.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=l,e.currentLineDashOffset=c,e.currentLineJoin=d,e.currentLineWidth=u,e.currentMiterLimit=f,e.currentStrokeOffset=m)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[an.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=K5(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Lb(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class s8 extends Ig{constructor(e,n,r,i){super(e,n,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,r){if(!this.image_||this.maxExtent&&!vf(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length,d=this.appendFlatPointCoordinates(i,l);this.instructions.push([an.DRAW_IMAGE,c,d,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([an.DRAW_IMAGE,c,d,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,r){if(!this.image_)return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),l=[];for(let u=0,f=i.length;u<f;u+=e.getStride())(!this.maxExtent||vf(this.maxExtent,i.slice(u,u+2)))&&l.push(i[u],i[u+1]);const c=this.coordinates.length,d=this.appendFlatPointCoordinates(l,2);this.instructions.push([an.DRAW_IMAGE,c,d,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([an.DRAW_IMAGE,c,d,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const r=e.getAnchor(),i=e.getSize(),l=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=l[0],this.originY_=l[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class n8 extends Ig{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinates_(e,n,r,i,l){const c=this.coordinates.length,d=this.appendFlatLineCoordinates(e,n,r,i,!1,!1);return this.instructions.push([an.MOVE_TO_LINE_TO,c,d,l*this.pixelRatio]),this.hitDetectionInstructions.push([an.MOVE_TO_LINE_TO,c,d,l]),r}drawLineString(e,n,r){const i=this.state,l=i.strokeStyle,c=i.lineWidth,d=i.strokeOffset;if(l===void 0||c===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zc,ed],nh);const u=e.getFlatCoordinates(),f=e.getStride();this.drawFlatCoordinates_(u,0,u.length,f,d),this.hitDetectionInstructions.push(fu),this.endGeometry(n)}drawMultiLineString(e,n,r){const i=this.state,l=i.strokeStyle,c=i.lineWidth,d=i.strokeOffset;if(l===void 0||c===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zc,ed],nh);const u=e.getEnds(),f=e.getFlatCoordinates(),m=e.getStride();let _=0;for(let y=0,g=u.length;y<g;++y)_=this.drawFlatCoordinates_(f,_,u[y],m,d);this.hitDetectionInstructions.push(fu),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(fu),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(fu),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(nh)}}class wD extends Ig{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinatess_(e,n,r,i,l){const c=this.state,d=c.fillStyle!==void 0,u=c.strokeStyle!==void 0,f=r.length;this.instructions.push(nh),this.hitDetectionInstructions.push(nh);for(let m=0;m<f;++m){const _=r[m],y=this.coordinates.length,g=this.appendFlatLineCoordinates(e,n,_,i,!0,!u);this.instructions.push([an.MOVE_TO_LINE_TO,y,g,l*this.pixelRatio,!0]),this.hitDetectionInstructions.push([an.MOVE_TO_LINE_TO,y,g,l,!0]),u&&(this.instructions.push(LD),this.hitDetectionInstructions.push(LD)),n=_}return d&&(this.instructions.push(Qp),this.hitDetectionInstructions.push(Qp)),u&&(this.instructions.push(fu),this.hitDetectionInstructions.push(fu)),n}drawCircle(e,n,r){const i=this.state,l=i.fillStyle,c=i.strokeStyle,d=i.strokeOffset;if(l===void 0&&c===void 0||this.handleStrokeOffset_(()=>this.drawCircle(e,n,r)))return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,ll]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zc,ed]);const u=e.getFlatCoordinates(),f=e.getStride(),m=this.coordinates.length;this.appendFlatLineCoordinates(u,0,u.length,f,!1,!1);const _=[an.CIRCLE,m,d];this.instructions.push(nh,_),this.hitDetectionInstructions.push(nh,_),i.fillStyle!==void 0&&(this.instructions.push(Qp),this.hitDetectionInstructions.push(Qp)),i.strokeStyle!==void 0&&(this.instructions.push(fu),this.hitDetectionInstructions.push(fu)),this.endGeometry(n)}drawPolygon(e,n,r){const i=this.state,l=i.fillStyle,c=i.strokeStyle,d=i.strokeOffset;if(l===void 0&&c===void 0||this.handleStrokeOffset_(()=>this.drawPolygon(e,n,r)))return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,ll]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zc,ed]);const u=e.getEnds(),f=e.getOrientedFlatCoordinates(),m=e.getStride();this.drawFlatCoordinatess_(f,0,u,m,d),this.endGeometry(n)}drawMultiPolygon(e,n,r){const i=this.state,l=i.fillStyle,c=i.strokeStyle,d=i.strokeOffset;if(l===void 0&&c===void 0||this.handleStrokeOffset_(()=>this.drawMultiPolygon(e,n,r)))return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,ll]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Zc,ed]);const u=e.getEndss(),f=e.getOrientedFlatCoordinates(),m=e.getStride();let _=0;for(let y=0,g=u.length;y<g;++y)_=this.drawFlatCoordinatess_(f,_,u[y],m,d);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let r=0,i=n.length;r<i;++r)n[r]=Hu(n[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}handleStrokeOffset_(e){const n=this.state,r=n.fillStyle,i=n.strokeStyle,l=n.strokeOffset;return Math.abs(l)>0&&r!==void 0&&i!==void 0?(n.strokeStyle=void 0,n.strokeOffset=0,e(),n.fillStyle=void 0,n.strokeStyle=i,n.strokeOffset=l,e(),n.fillStyle=r,!0):!1}}function r8(t,e,n,r,i){const l=[];let c=n,d=0,u=e.slice(n,2);for(;d<t&&c+i<r;){const[f,m]=u.slice(-2),_=e[c+i],y=e[c+i+1],g=Math.sqrt((_-f)*(_-f)+(y-m)*(y-m));if(d+=g,d>=t){const N=(t-d+g)/g,C=Gl(f,_,N),v=Gl(m,y,N);u.push(C,v),l.push(u),u=[C,v],d==t&&(c+=i),d=0}else if(d<t)u.push(e[c+i],e[c+i+1]),c+=i;else{const N=g-d,C=Gl(f,_,N/g),v=Gl(m,y,N/g);u.push(C,v),l.push(u),u=[C,v],d=0,c+=i}}return d>0&&l.push(u),l}function i8(t,e,n,r,i){let l=n,c=n,d=0,u=0,f=n,m,_,y,g,N,C,v,R,U,L;for(_=n;_<r;_+=i){const w=e[_],P=e[_+1];N!==void 0&&(U=w-N,L=P-C,g=Math.sqrt(U*U+L*L),v!==void 0&&(u+=y,m=Math.acos((v*U+R*L)/(y*g)),m>t&&(u>d&&(d=u,l=f,c=_),u=0,f=_-i)),y=g,v=U,R=L),N=w,C=P}return u+=g,u>d?[f,_]:[l,c]}const K_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class a8 extends Ig{constructor(e,n,r,i){super(e,n,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ll]={fillStyle:ll},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,r){const i=this.textFillState_,l=this.textStrokeState_,c=this.textState_;if(this.text_===""||!c||!i&&!l)return;const d=this.coordinates;let u=d.length;const f=e.getType();let m=null,_=e.getStride();if(c.placement==="line"&&(f=="LineString"||f=="MultiLineString"||f=="Polygon"||f=="MultiPolygon")){if(!ol(this.maxExtent,e.getExtent()))return;let y;if(m=e.getFlatCoordinates(),f=="LineString")y=[m.length];else if(f=="MultiLineString")y=e.getEnds();else if(f=="Polygon")y=e.getEnds().slice(0,1);else if(f=="MultiPolygon"){const v=e.getEndss();y=[];for(let R=0,U=v.length;R<U;++R)y.push(v[R][0])}this.beginGeometry(e,n,r);const g=c.repeat,N=g?void 0:c.textAlign;let C=0;for(let v=0,R=y.length;v<R;++v){let U;g?U=r8(g*this.resolution,m,C,y[v],_):U=[m.slice(C,y[v])];for(let L=0,w=U.length;L<w;++L){const P=U[L];let G=0,K=P.length;if(N==null){const O=i8(c.maxAngle,P,0,P.length,2);G=O[0],K=O[1]}for(let O=G;O<K;O+=_)d.push(P[O],P[O+1]);const B=d.length;C=y[v],this.drawChars_(u,B),u=B}}this.endGeometry(n)}else{let y=c.overflow?null:[];switch(f){case"Point":case"MultiPoint":m=e.getFlatCoordinates();break;case"LineString":m=e.getFlatMidpoint();break;case"Circle":m=e.getCenter();break;case"MultiLineString":m=e.getFlatMidpoints(),_=2;break;case"Polygon":m=e.getFlatInteriorPoint(),c.overflow||y.push(m[2]/this.resolution),_=3;break;case"MultiPolygon":const w=e.getFlatInteriorPoints();m=[];for(let P=0,G=w.length;P<G;P+=3)c.overflow||y.push(w[P+2]/this.resolution),m.push(w[P],w[P+1]);if(m.length===0)return;_=2;break}const g=this.appendFlatPointCoordinates(m,_);if(g===u)return;if(y&&(g-u)/2!==m.length/_){let w=u/2;y=y.filter((P,G)=>{const K=d[(w+G)*2]===m[G*_]&&d[(w+G)*2+1]===m[G*_+1];return K||--w,K})}this.saveTextStates_();const N=c.backgroundFill?this.createFill(this.fillStyleToState(c.backgroundFill)):null,C=c.backgroundStroke?this.createStroke(this.strokeStyleToState(c.backgroundStroke)):null;this.beginGeometry(e,n,r);let v=c.padding;if(v!=sh&&(c.scale[0]<0||c.scale[1]<0)){let w=c.padding[0],P=c.padding[1],G=c.padding[2],K=c.padding[3];c.scale[0]<0&&(P=-P,K=-K),c.scale[1]<0&&(w=-w,G=-G),v=[w,P,G,K]}const R=this.pixelRatio;this.instructions.push([an.DRAW_IMAGE,u,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,v==sh?sh:v.map(function(w){return w*R}),N,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const U=1/R,L=N?N.slice(0):null;L&&(L[1]=ll),this.hitDetectionInstructions.push([an.DRAW_IMAGE,u,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[U,U],NaN,this.declutterMode_,this.declutterImageWithText_,v,L,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ll:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const l=this.textKey_;l in this.textStates||(this.textStates[l]={font:n.font,textAlign:n.textAlign||og,justify:n.justify,textBaseline:n.textBaseline||B_,scale:n.scale});const c=this.fillKey_;r&&(c in this.fillStates||(this.fillStates[c]={fillStyle:r.fillStyle}))}drawChars_(e,n){const r=this.textStrokeState_,i=this.textState_,l=this.strokeKey_,c=this.textKey_,d=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,f=K_[i.textBaseline],m=this.textOffsetY_*u,_=this.text_,y=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([an.DRAW_CHARS,e,n,f,i.overflow,d,i.maxAngle,u,m,l,y*u,_,c,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([an.DRAW_CHARS,e,n,f,i.overflow,d&&ll,i.maxAngle,u,m,l,y*u,_,c,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let r,i,l;if(!e)this.text_="";else{const c=e.getFill();c?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=lc(c.getColor()||ll)):(i=null,this.textFillState_=i);const d=e.getStroke();if(!d)l=null,this.textStrokeState_=l;else{l=this.textStrokeState_,l||(l={},this.textStrokeState_=l);const C=d.getLineDash(),v=d.getLineDashOffset(),R=d.getWidth(),U=d.getMiterLimit();l.lineCap=d.getLineCap()||Rf,l.lineDash=C?C.slice():Zc,l.lineDashOffset=v===void 0?ed:v,l.lineJoin=d.getLineJoin()||Tf,l.lineWidth=R===void 0?cg:R,l.miterLimit=U===void 0?ag:U,l.strokeStyle=lc(d.getColor()||lg)}r=this.textState_;const u=e.getFont()||IE;dk(u);const f=e.getScaleArray();r.overflow=e.getOverflow(),r.font=u,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||B_,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||sh,r.scale=f===void 0?[1,1]:f;const m=e.getOffsetX(),_=e.getOffsetY(),y=e.getRotateWithView(),g=e.getKeepUpright(),N=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=m===void 0?0:m,this.textOffsetY_=_===void 0?0:_,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=N===void 0?0:N,this.strokeKey_=l?(typeof l.strokeStyle=="string"?l.strokeStyle:tr(l.strokeStyle))+l.lineCap+l.lineDashOffset+"|"+l.lineWidth+l.lineJoin+l.miterLimit+"["+l.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+tr(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const l8={Circle:wD,Default:Ig,Image:s8,LineString:n8,Polygon:wD,Text:a8};class o8{constructor(e,n,r,i){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const r=this.buildersByZIndex_[n];for(const i in r){const l=r[i].finish();e[n][i]=l}}return e}getBuilder(e,n){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let l=i[n];if(l===void 0){const c=l8[n];l=new c(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[n]=l}return l}}function c8(t,e,n,r){let i=t[e],l=t[e+1],c=0;for(let d=e+r;d<n;d+=r){const u=t[d],f=t[d+1];c+=Math.sqrt((u-i)*(u-i)+(f-l)*(f-l)),i=u,l=f}return c}function d8(t,e,n,r,i,l){i=i??[],l=l??e;const c=t[0],d=t[1],u=t[t.length-4],f=t[t.length-3];let m,_,y,g,N,C,v,R,U=0;for(let L=0;L<t.length;L+=e){y=m,g=_,N=void 0,C=void 0,L+e<t.length&&(N=t[L+e],C=t[L+e+1]),r&&L===0&&(y=u,g=f),r&&L===t.length-2&&(N=c,C=d),m=t[L],_=t[L+1],[v,R]=u_(m,_,y,g,N,C,n),i[U++]=v,i[U++]=R;for(let w=2;w<l;w++)i[U++]=t[L+w]}return i.length!=U&&(i.length=U),i}function u_(t,e,n,r,i,l,c){let d,u;n!==void 0&&r!==void 0?(d=t-n,u=e-r):i!==void 0&&l!==void 0?(d=i-t,u=l-e):(d=1,u=0);const f=Math.hypot(d,u),m=d/f,_=u/f;if(d=-_,u=m,n===void 0||r===void 0)return[t+d*c,e+u*c];if(i===void 0||l===void 0)return[t+d*c,e+u*c];const y=jP([t,e],[n,r],[i,l]);if(Math.cos(y)>.998)return[t+m*c,e+_*c];const g=Math.cos(y/2),N=Math.sin(y/2),C=N*d+g*u,v=-g*d+N*u,R=C*(1/N),U=v*(1/N);return[t+R*c,e+U*c]}function u8(t,e,n,r,i,l,c,d,u,f,m,_,y=!0){let g=t[e],N=t[e+1],C=0,v=0,R=0,U=0;function L(){C=g,v=N,e+=r,g=t[e],N=t[e+1],U+=R,R=Math.sqrt((g-C)*(g-C)+(N-v)*(N-v))}do L();while(e<n-r&&U+R<l);let w=R===0?0:(l-U)/R;const P=Gl(C,g,w),G=Gl(v,N,w),K=e-r,B=U,O=l+d*u(f,i,m);for(;e<n-r&&U+R<O;)L();w=R===0?0:(O-U)/R;const S=Gl(C,g,w),A=Gl(v,N,w);let Y=!1;if(y)if(_){const F=[P,G,S,A];oE(F,0,4,2,_,F,F),Y=F[0]>F[2]}else Y=P>S;const te=Math.PI,J=[],q=K+r===e;e=K,R=0,U=B,g=t[e],N=t[e+1];let V;if(q){L(),V=Math.atan2(N-v,g-C),Y&&(V+=V>0?-te:te);const F=(S+P)/2,I=(A+G)/2;return J[0]=[F,I,(O-l)/2,V,i],J}i=i.replace(/\n/g," ");for(let F=0,I=i.length;F<I;){L();let ee=Math.atan2(N-v,g-C);if(Y&&(ee+=ee>0?-te:te),V!==void 0){let H=ee-V;if(H+=H>te?-2*te:H<-te?2*te:0,Math.abs(H)>c)return null}V=ee;const ae=F;let T=0;for(;F<I;++F){const H=Y?I-F-1:F,$=d*u(f,i[H],m);if(e+r<n&&U+R<l+T+$/2)break;T+=$}if(F===ae)continue;const j=Y?i.substring(I-ae,I-F):i.substring(ae,F);w=R===0?0:(l+T/2-U)/R;const k=Gl(C,g,w),Q=Gl(v,N,w);J.push([k,Q,T/2,ee,j]),l+=T}return J}const E0=Zl(),Gd=[],Uc=[],Bc=[],Yd=[];function PD(t){return t[3].declutterBox}const AD=new RegExp("[-----]");function TC(t,e){return e==="start"?e=AD.test(t)?"right":"left":e==="end"&&(e=AD.test(t)?"left":"right"),K_[e]}function h8(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function f8(t,e,n){return n%2===0&&(t+=e),t}class m8{constructor(e,n,r,i,l){this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Io(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=l?new GE:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,r,i){const l=e+n+r+i;if(this.labels_[l])return this.labels_[l];const c=i?this.strokeStates[i]:null,d=r?this.fillStates[r]:null,u=this.textStates[n],f=this.pixelRatio,m=[u.scale[0]*f,u.scale[1]*f],_=u.justify?K_[u.justify]:TC(Array.isArray(e)?e[0]:e,u.textAlign||og),y=i&&c.lineWidth?c.lineWidth:0,g=Array.isArray(e)?e:String(e).split(`
`).reduce(h8,[]),{width:N,height:C,widths:v,heights:R,lineWidths:U}=hk(u,g),L=N+y,w=[],P=(L+2)*m[0],G=(C+y)*m[1],K={width:P<0?Math.floor(P):Math.ceil(P),height:G<0?Math.floor(G):Math.ceil(G),contextInstructions:w};(m[0]!=1||m[1]!=1)&&w.push("scale",m),i&&(w.push("strokeStyle",c.strokeStyle),w.push("lineWidth",y),w.push("lineCap",c.lineCap),w.push("lineJoin",c.lineJoin),w.push("miterLimit",c.miterLimit),w.push("setLineDash",[c.lineDash]),w.push("lineDashOffset",c.lineDashOffset)),r&&w.push("fillStyle",d.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const B=.5-_;let O=_*L+B*y;const S=[],A=[];let Y=0,te=0,J=0,q=0,V;for(let F=0,I=g.length;F<I;F+=2){const ee=g[F];if(ee===`
`){te+=Y,Y=0,O=_*L+B*y,++q;continue}const ae=g[F+1]||u.font;ae!==V&&(i&&S.push("font",ae),r&&A.push("font",ae),V=ae),Y=Math.max(Y,R[J]);const T=[ee,O+B*v[J]+_*(v[J]-U[q]),.5*(y+Y)+te];O+=v[J],i&&S.push("strokeText",T),r&&A.push("fillText",T),++J}return Array.prototype.push.apply(w,S),Array.prototype.push.apply(w,A),this.labels_[l]=K,K}replayTextBackground_(e,n,r,i,l,c,d){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,l),e.lineTo.apply(e,n),c&&(this.alignAndScaleFill_=c[2],e.fillStyle=c[1],this.fill_(e)),d&&(this.setStrokeStyle_(e,d),e.stroke())}calculateImageOrLabelDimensions_(e,n,r,i,l,c,d,u,f,m,_,y,g,N,C,v){d*=y[0],u*=y[1];let R=r-d,U=i-u;const L=l+f>e?e-f:l,w=c+m>n?n-m:c,P=N[3]+L*y[0]+N[1],G=N[0]+w*y[1]+N[2],K=R-N[3],B=U-N[0];(C||_!==0)&&(Gd[0]=K,Yd[0]=K,Gd[1]=B,Uc[1]=B,Uc[0]=K+P,Bc[0]=Uc[0],Bc[1]=B+G,Yd[1]=Bc[1]);let O;return _!==0?(O=id(Io(),r,i,1,1,_,-r,-i),ra(O,Gd),ra(O,Uc),ra(O,Bc),ra(O,Yd),bu(Math.min(Gd[0],Uc[0],Bc[0],Yd[0]),Math.min(Gd[1],Uc[1],Bc[1],Yd[1]),Math.max(Gd[0],Uc[0],Bc[0],Yd[0]),Math.max(Gd[1],Uc[1],Bc[1],Yd[1]),E0)):bu(Math.min(K,K+P),Math.min(B,B+G),Math.max(K,K+P),Math.max(B,B+G),E0),g&&(R=Math.round(R),U=Math.round(U)),{drawImageX:R,drawImageY:U,drawImageW:L,drawImageH:w,originX:f,originY:m,declutterBox:{minX:E0[0],minY:E0[1],maxX:E0[2],maxY:E0[3],value:v},canvasTransform:O,scale:y}}replayImageOrLabel_(e,n,r,i,l,c,d){const u=!!(c||d),f=i.declutterBox,m=d?d[2]*i.scale[0]/2:0;return f.minX-m<=n[0]&&f.maxX+m>=0&&f.minY-m<=n[1]&&f.maxY+m>=0&&(u&&this.replayTextBackground_(e,Gd,Uc,Bc,Yd,c,d),fk(e,i.canvasTransform,l,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const r=ra(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),n!==1&&e.scale(n,n)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,r,i){const l=this.textStates[n],c=this.createLabel(e,n,i,r),d=this.strokeStates[r],u=this.pixelRatio,f=TC(Array.isArray(e)?e[0]:e,l.textAlign||og),m=K_[l.textBaseline||B_],_=d&&d.lineWidth?d.lineWidth:0,y=c.width/u-2*l.scale[0],g=f*y+2*(.5-f)*_,N=m*c.height/u+2*(.5-m)*_;return{label:c,anchorX:g,anchorY:N}}execute_(e,n,r,i,l,c,d,u){const f=this.zIndexContext_;let m;this.pixelCoordinates_&&Du(r,this.renderedTransform_)?m=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),m=xu(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),lA(this.renderedTransform_,r));let _=0;const y=i.length;let g=0,N,C,v,R,U,L,w,P,G,K,B,O,S,A,Y,te,J=0,q=0;const V=this.coordinateCache_,F=this.viewRotation_,I=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,ee={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:F},ae=this.instructions!=i||this.overlaps?0:200;let T,j,k,Q;for(;_<y;){const H=i[_];switch(H[0]){case an.BEGIN_GEOMETRY:T=H[1],Q=H[3],T.getGeometry()?d!==void 0&&!ol(d,Q.getExtent())?_=H[2]+1:++_:_=H[2],f&&(f.zIndex=H[4]);break;case an.BEGIN_PATH:J>ae&&(this.fill_(e),J=0),q>ae&&(e.stroke(),q=0),!J&&!q&&(e.beginPath(),P=NaN,G=NaN),++_;break;case an.CIRCLE:g=H[1],R=H[2]??0;const ie=m[g],fe=m[g+1],pe=m[g+2]-R,de=m[g+3]-R,Re=pe-ie,X=de-fe,_e=Math.sqrt(Re*Re+X*X);e.moveTo(ie+_e,fe),e.arc(ie,fe,_e,0,2*Math.PI,!0),++_;break;case an.CLOSE_PATH:e.closePath(),++_;break;case an.CUSTOM:g=H[1],N=H[2];const me=H[3],Z=H[4],le=H[5];ee.geometry=me,ee.feature=T,_ in V||(V[_]=[]);const se=V[_];le?le(m,g,N,2,se):(se[0]=m[g],se[1]=m[g+1],se.length=2),f&&(f.zIndex=H[6]),Z(se,ee),++_;break;case an.DRAW_IMAGE:g=H[1],N=H[2],O=H[3],C=H[4],v=H[5];let Ee=H[6];const Ne=H[7],ye=H[8],ne=H[9],ue=H[10];let xe=H[11];const et=H[12];let bt=H[13];w=H[14]||"declutter";const it=H[15];if(!O&&H.length>=20){S=H[19],A=H[20],Y=H[21],te=H[22];const Xe=this.drawLabelWithPointPlacement_(S,A,Y,te);O=Xe.label,H[3]=O;const Pe=H[23];C=(Xe.anchorX-Pe)*this.pixelRatio,H[4]=C;const Ct=H[24];v=(Xe.anchorY-Ct)*this.pixelRatio,H[5]=v,Ee=O.height,H[6]=Ee,bt=O.width,H[13]=bt}let At;H.length>25&&(At=H[25]);let at,We,Dt;H.length>17?(at=H[16],We=H[17],Dt=H[18]):(at=sh,We=null,Dt=null),ue&&I?xe+=F:!ue&&!I&&(xe-=F);let Tt=0;for(;g<N;g+=2){if(At&&At[Tt++]<bt/this.pixelRatio)continue;const Xe=this.calculateImageOrLabelDimensions_(O.width,O.height,m[g],m[g+1],bt,Ee,C,v,ye,ne,xe,et,l,at,!!We||!!Dt,T),Pe=[e,n,O,Xe,Ne,We,Dt];if(u){let Ct,Me,lt;if(it){const Ve=N-g;if(!it[Ve]){it[Ve]={args:Pe,declutterMode:w};continue}const $t=it[Ve];Ct=$t.args,Me=$t.declutterMode,delete it[Ve],lt=PD(Ct)}let ut,jt;if(Ct&&(Me!=="declutter"||!u.collides(lt))&&(ut=!0),(w!=="declutter"||!u.collides(Xe.declutterBox))&&(jt=!0),Me==="declutter"&&w==="declutter"){const Ve=ut&&jt;ut=Ve,jt=Ve}ut&&(Me!=="none"&&u.insert(lt),this.replayImageOrLabel_.apply(this,Ct)),jt&&(w!=="none"&&u.insert(Xe.declutterBox),this.replayImageOrLabel_.apply(this,Pe))}else this.replayImageOrLabel_.apply(this,Pe)}++_;break;case an.DRAW_CHARS:const St=H[1],ze=H[2],dt=H[3],Ke=H[4];te=H[5];const rt=H[6],ft=H[7],Ot=H[8];Y=H[9];const mt=H[10];S=H[11],Array.isArray(S)&&(S=S.reduce(f8,"")),A=H[12];const Ze=[H[13],H[13]];w=H[14]||"declutter";const De=H[15],Ye=this.textStates[A],Ce=Ye.font,ge=[Ye.scale[0]*ft,Ye.scale[1]*ft];let Be;Ce in this.widths_?Be=this.widths_[Ce]:(Be={},this.widths_[Ce]=Be);const ce=c8(m,St,ze,2),Le=Math.abs(ge[0])*xD(Ce,S,Be);if(Ke||Le<=ce){const Xe=this.textStates[A].textAlign,Pe=(ce-Le)*TC(S,Xe),Ct=u8(m,St,ze,2,S,Pe,rt,Math.abs(ge[0]),xD,Ce,Be,I?0:this.viewRotation_,De);e:if(Ct){const Me=[];let lt,ut,jt,Ve,$t;if(Y)for(lt=0,ut=Ct.length;lt<ut;++lt){$t=Ct[lt],jt=$t[4],Ve=this.createLabel(jt,A,"",Y),C=$t[2]+(ge[0]<0?-mt:mt),v=dt*Ve.height+(.5-dt)*2*mt*ge[1]/ge[0]-Ot;const Ue=this.calculateImageOrLabelDimensions_(Ve.width,Ve.height,$t[0],$t[1],Ve.width,Ve.height,C,v,0,0,$t[3],Ze,!1,sh,!1,T);if(u&&w==="declutter"&&u.collides(Ue.declutterBox))break e;Me.push([e,n,Ve,Ue,1,null,null])}if(te)for(lt=0,ut=Ct.length;lt<ut;++lt){$t=Ct[lt],jt=$t[4],Ve=this.createLabel(jt,A,te,""),C=$t[2],v=dt*Ve.height-Ot;const Ue=this.calculateImageOrLabelDimensions_(Ve.width,Ve.height,$t[0],$t[1],Ve.width,Ve.height,C,v,0,0,$t[3],Ze,!1,sh,!1,T);if(u&&w==="declutter"&&u.collides(Ue.declutterBox))break e;Me.push([e,n,Ve,Ue,1,null,null])}u&&w!=="none"&&u.load(Me.map(PD));for(let Ue=0,ss=Me.length;Ue<ss;++Ue)this.replayImageOrLabel_.apply(this,Me[Ue])}}++_;break;case an.END_GEOMETRY:if(c!==void 0){T=H[1];const Xe=c(T,Q,w);if(Xe)return Xe}++_;break;case an.FILL:ae?J++:this.fill_(e),++_;break;case an.MOVE_TO_LINE_TO:for(g=H[1],N=H[2],R=H[3],U=H[4]??!1,j=m[g],k=m[g+1],R&&(L=g,[j,k]=u_(j,k,U?m[N-4]:void 0,U?m[N-3]:void 0,m[g+2],m[g+3],R)),e.moveTo(j,k),P=j+.5|0,G=k+.5|0,g+=2;g<N;g+=2)j=m[g],k=m[g+1],K=j+.5|0,B=k+.5|0,(g==N-2||K!==P||B!==G)&&(R&&(g==N-2?[j,k]=u_(j,k,m[g-2],m[g-1],U?m[L+2]:void 0,U?m[L+3]:void 0,R):[j,k]=u_(j,k,m[g-2],m[g-1],m[g+2],m[g+3],R)),e.lineTo(j,k),P=K,G=B);++_;break;case an.SET_FILL_STYLE:this.alignAndScaleFill_=H[2],J&&(this.fill_(e),J=0,q&&(e.stroke(),q=0)),e.fillStyle=H[1],++_;break;case an.SET_STROKE_STYLE:q&&(e.stroke(),q=0),this.setStrokeStyle_(e,H),++_;break;case an.STROKE:ae?q++:e.stroke(),++_;break;default:++_;break}}J&&this.fill_(e),q&&e.stroke()}execute(e,n,r,i,l,c){this.viewRotation_=i,this.execute_(e,n,r,this.instructions,l,void 0,void 0,c)}executeHitDetection(e,n,r,i,l){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,i,l)}}const Xu=["Polygon","Circle","LineString","Image","Text","Default"],$E=["Image","Text"],g8=Xu.filter(t=>!$E.includes(t));let HE=!1,zE=!1;function p8(){let t=0;const e=r=>{const i=Ii(1,1,null,{willReadFrequently:r});let l=0;const c=performance.now();for(;performance.now()-c<50;++l)i.fillStyle=`rgba(255,0,${l%256},1)`,i.fillRect(0,0,1,1),i.getImageData(0,0,1,1);return t=l>t?l:t,l};HE={[e(!0)]:!0,[e(!1)]:!1,[e(void 0)]:void 0}[t],zE=!0}class _8{constructor(e,n,r,i,l,c,d){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=c,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Io(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(l,d)}clip(e,n){const r=this.getClipCoords(n);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,n){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const l=e[r];for(const c in l){const d=l[c];i[c]=new m8(this.resolution_,this.pixelRatio_,this.overlaps_,d,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const r=this.executorsByZIndex_[n];for(let i=0,l=e.length;i<l;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,n,r,i,l,c){zE===!1&&p8(),i=Math.round(i);const d=i*2+1,u=id(this.hitDetectionTransform_,i+.5,i+.5,1/n,-1/n,-r,-e[0],-e[1]),f=!this.hitDetectionContext_;f&&(this.hitDetectionContext_=Ii(d,d,null,{willReadFrequently:HE}));const m=this.hitDetectionContext_;m.canvas.width!==d||m.canvas.height!==d?(m.canvas.width=d,m.canvas.height=d):f||m.clearRect(0,0,d,d);let _;this.renderBuffer_!==void 0&&(_=Zl(),Ym(_,e),Lb(_,n*(this.renderBuffer_+i),_));const y=x8(i);let g;function N(P,G,K){const B=m.getImageData(0,0,d,d).data;for(let O=0,S=y.length;O<S;O++)if(B[y[O]]>0){if(!c||K==="none"||g!=="Image"&&g!=="Text"||c.includes(P)){const A=(y[O]-3)/4,Y=i-A%d,te=i-(A/d|0),J=l(P,G,Y*Y+te*te);if(J)return J}m.clearRect(0,0,d,d);break}}const C=Object.keys(this.executorsByZIndex_).map(Number);C.sort(Jc);let v,R,U,L,w;for(v=C.length-1;v>=0;--v){const P=C[v].toString();for(U=this.executorsByZIndex_[P],R=Xu.length-1;R>=0;--R)if(g=Xu[R],L=U[g],L!==void 0&&(w=L.executeHitDetection(m,u,r,N,_),w))return w}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const r=n[0],i=n[1],l=n[2],c=n[3],d=[r,i,r,c,l,c,l,i];return xu(d,0,8,2,e,d),d}isEmpty(){return Sf(this.executorsByZIndex_)}execute(e,n,r,i,l,c,d){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(d?iP:Jc),c=c||Xu;const f=Xu.length;for(let m=0,_=u.length;m<_;++m){const y=u[m].toString(),g=this.executorsByZIndex_[y];for(let N=0,C=c.length;N<C;++N){const v=c[N],R=g[v];if(R!==void 0){const U=d===null?void 0:R.getZIndexContext(),L=U?U.getContext():e,w=this.maxExtent_&&v!=="Image"&&v!=="Text";if(w&&(L.save(),this.clip(L,r)),!U||v==="Text"||v==="Image"?R.execute(L,n,r,i,l,d):U.pushFunction(P=>R.execute(P,n,r,i,l,d)),w&&L.restore(),U){U.offset();const P=u[m]*f+Xu.indexOf(v);this.deferredZIndexContexts_[P]||(this.deferredZIndexContexts_[P]=[]),this.deferredZIndexContexts_[P].push(U)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(Jc);for(let r=0,i=n.length;r<i;++r)e[n[r]].forEach(l=>{l.draw(this.renderedContext_),l.clear()}),e[n[r]].length=0}}const EC={};function x8(t){if(EC[t]!==void 0)return EC[t];const e=t*2+1,n=t*t,r=new Array(n+1);for(let l=0;l<=t;++l)for(let c=0;c<=t;++c){const d=l*l+c*c;if(d>n)break;let u=r[d];u||(u=[],r[d]=u),u.push(((t+l)*e+(t+c))*4+3),l>0&&u.push(((t-l)*e+(t+c))*4+3),c>0&&(u.push(((t+l)*e+(t-c))*4+3),l>0&&u.push(((t-l)*e+(t-c))*4+3))}const i=[];for(let l=0,c=r.length;l<c;++l)r[l]&&i.push(...r[l]);return EC[t]=i,i}class C8 extends VE{constructor(e,n,r,i,l,c,d){super(),this.context_=e,this.pixelRatio_=n,this.extent_=r,this.transform_=i,this.transformRotation_=i?cx(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=l,this.squaredTolerance_=c,this.userTransform_=d,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Io()}drawImages_(e,n,r,i){if(!this.image_)return;const l=xu(e,n,r,i,this.transform_,this.pixelCoordinates_),c=this.context_,d=this.tmpLocalTransform_,u=c.globalAlpha;this.imageOpacity_!=1&&(c.globalAlpha=u*this.imageOpacity_);let f=this.imageRotation_;this.transformRotation_===0&&(f-=this.viewRotation_),this.imageRotateWithView_&&(f+=this.viewRotation_);for(let m=0,_=l.length;m<_;m+=2){const y=l[m]-this.imageAnchorX_,g=l[m+1]-this.imageAnchorY_;if(f!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const N=y+this.imageAnchorX_,C=g+this.imageAnchorY_;id(d,N,C,1,1,f,-N,-C),c.save(),c.transform.apply(c,d),c.translate(N,C),c.scale(this.imageScale_[0],this.imageScale_[1]),c.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),c.restore()}else c.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(c.globalAlpha=u)}drawText_(e,n,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const l=xu(e,n,r,i,this.transform_,this.pixelCoordinates_),c=this.context_;let d=this.textRotation_;for(this.transformRotation_===0&&(d-=this.viewRotation_),this.textRotateWithView_&&(d+=this.viewRotation_);n<r;n+=i){const u=l[n]+this.textOffsetX_,f=l[n+1]+this.textOffsetY_;d!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(c.save(),c.translate(u-this.textOffsetX_,f-this.textOffsetY_),c.rotate(d),c.translate(this.textOffsetX_,this.textOffsetY_),c.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&c.strokeText(this.text_,0,0),this.textFillState_&&c.fillText(this.text_,0,0),c.restore()):(this.textStrokeState_&&c.strokeText(this.text_,u,f),this.textFillState_&&c.fillText(this.text_,u,f))}}moveToLineTo_(e,n,r,i,l,c){const d=this.context_;let u=xu(e,n,r,i,this.transform_,this.pixelCoordinates_);Math.abs(c)>0&&(u=d8(u,i,c,l,u)),d.moveTo(u[0],u[1]);let f=u.length;l&&(f-=2);for(let m=2;m<f;m+=2)d.lineTo(u[m],u[m+1]);return l&&d.closePath(),r}drawRings_(e,n,r,i,l){for(let c=0,d=r.length;c<d;++c)n=this.moveToLineTo_(e,n,r[c],i,!0,l);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ol(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=_A(e,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],i=n[3]-n[1],l=Math.sqrt(r*r+i*i),c=this.context_;c.beginPath(),c.arc(n[0],n[1],l,0,2*Math.PI),this.fillState_&&c.fill(),this.strokeState_&&c.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const r=n.getGeometryFunction()(e);r&&(this.setStyle(n),this.drawGeometry(r))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let r=0,i=n.length;r<i;++r)this.drawGeometry(n[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ol(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1,this.strokeState_.strokeOffset),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(ol(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let l=0;const c=e.getEnds(),d=e.getStride();r.beginPath();for(let u=0,f=c.length;u<f;++u)l=this.moveToLineTo_(i,l,c[u],d,!1,this.strokeState_.strokeOffset);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){var n;if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ol(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=this.context_;r.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride(),(n=this.strokeState_)==null?void 0:n.strokeOffset),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}if(this.text_!==""){const r=e.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}}drawMultiPolygon(e){var n;if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ol(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getOrientedFlatCoordinates();let l=0;const c=e.getEndss(),d=e.getStride();r.beginPath();for(let u=0,f=c.length;u<f;++u){const m=c[u];l=this.drawRings_(i,l,m,d,(n=this.strokeState_)==null?void 0:n.strokeOffset)}this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}if(this.text_!==""){const r=e.getFlatInteriorPoints();this.drawText_(r,0,r.length,2)}}}setContextFillState_(e){const n=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,n.lineCap=e.lineCap),Du(r.lineDash,e.lineDash)||n.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:og;r?(r.font!=e.font&&(r.font=e.font,n.font=e.font),r.textAlign!=i&&(r.textAlign=i,n.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=i,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:lc(r||ll)}}if(!n)this.strokeState_=null;else{const r=n.getColor(),i=n.getLineCap(),l=n.getLineDash(),c=n.getLineDashOffset(),d=n.getLineJoin(),u=n.getWidth(),f=n.getMiterLimit(),m=l||Zc,_=n.getOffset();this.strokeState_={lineCap:i!==void 0?i:Rf,lineDash:this.pixelRatio_===1?m:m.map(y=>y*this.pixelRatio_),lineDashOffset:(c||ed)*this.pixelRatio_,lineJoin:d!==void 0?d:Tf,lineWidth:(u!==void 0?u:cg)*this.pixelRatio_,miterLimit:f!==void 0?f:ag,strokeStyle:lc(r||lg),strokeOffset:(_??0)*this.pixelRatio_}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),l=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=n[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=l[0],this.imageOriginY_=l[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const c=e.getScaleArray();this.imageScale_=[c[0]*this.pixelRatio_/r,c[1]*this.pixelRatio_/r],this.imageWidth_=n[0]*r}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const g=n.getColor();this.textFillState_={fillStyle:lc(g||ll)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const g=r.getColor(),N=r.getLineCap(),C=r.getLineDash(),v=r.getLineDashOffset(),R=r.getLineJoin(),U=r.getWidth(),L=r.getMiterLimit();this.textStrokeState_={lineCap:N!==void 0?N:Rf,lineDash:C||Zc,lineDashOffset:v||ed,lineJoin:R!==void 0?R:Tf,lineWidth:U!==void 0?U:cg,miterLimit:L!==void 0?L:ag,strokeStyle:lc(g||lg)}}const i=e.getFont(),l=e.getOffsetX(),c=e.getOffsetY(),d=e.getRotateWithView(),u=e.getRotation(),f=e.getScaleArray(),m=e.getText(),_=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:i!==void 0?i:IE,textAlign:_!==void 0?_:og,textBaseline:y!==void 0?y:B_},this.text_=m!==void 0?Array.isArray(m)?m.reduce((g,N,C)=>g+=C%2?" ":N,""):m:"",this.textOffsetX_=l!==void 0?this.pixelRatio_*l:0,this.textOffsetY_=c!==void 0?this.pixelRatio_*c:0,this.textRotateWithView_=d!==void 0?d:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*f[0],this.pixelRatio_*f[1]]}}}const ac=.5;function y8(t,e,n,r,i,l,c,d,u){const f=i,m=t[0]*ac,_=t[1]*ac,y=Ii(m,_);y.imageSmoothingEnabled=!1;const g=y.canvas,N=new C8(y,ac,i,null,c,d,null),C=n.length,v=Math.floor((256*256*256-1)/C),R={};for(let L=1;L<=C;++L){const w=n[L-1],P=w.getStyleFunction()||r;if(!P)continue;let G=P(w,l);if(!G)continue;Array.isArray(G)||(G=[G]);const B=(L*v).toString(16).padStart(7,"#00000");for(let O=0,S=G.length;O<S;++O){const A=G[O],Y=A.getGeometryFunction()(w);if(!Y||!ol(f,Y.getExtent()))continue;const te=A.clone(),J=te.getFill();J&&J.setColor(B);const q=te.getStroke();q&&(q.setColor(B),q.setLineDash(null)),te.setText(void 0);const V=A.getImage();if(V){const ae=V.getImageSize();if(!ae)continue;const T=Ii(ae[0],ae[1],void 0,{alpha:!1}),j=T.canvas;T.fillStyle=B,T.fillRect(0,0,j.width,j.height),te.setImage(new mh({img:j,anchor:V.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:V.getOrigin(),opacity:1,size:V.getSize(),scale:V.getScale(),rotation:V.getRotation(),rotateWithView:V.getRotateWithView()}))}const F=te.getZIndex()||0;let I=R[F];I||(I={},R[F]=I,I.Polygon=[],I.Circle=[],I.LineString=[],I.Point=[]);const ee=Y.getType();if(ee==="GeometryCollection"){const ae=Y.getGeometriesArrayRecursive();for(let T=0,j=ae.length;T<j;++T){const k=ae[T];I[k.getType().replace("Multi","")].push(k,te)}}else I[ee.replace("Multi","")].push(Y,te)}}const U=Object.keys(R).map(Number).sort(Jc);for(let L=0,w=U.length;L<w;++L){const P=R[U[L]];for(const G in P){const K=P[G];for(let B=0,O=K.length;B<O;B+=2){N.setStyle(K[B+1]);for(let S=0,A=e.length;S<A;++S)N.setTransform(e[S]),N.drawGeometry(K[B])}}}return y.getImageData(0,0,g.width,g.height)}function b8(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*ac),l=Math.floor(Math.round(t[1])*ac),c=(zr(i,0,n.width-1)+zr(l,0,n.height-1)*n.width)*4,d=n.data[c],u=n.data[c+1],m=n.data[c+2]+256*(u+256*d),_=Math.floor((256*256*256-1)/e.length);m&&m%_===0&&r.push(e[m/_-1])}return r}const N8=.5,qE={Point:I8,LineString:T8,Polygon:M8,MultiPoint:O8,MultiLineString:E8,MultiPolygon:j8,GeometryCollection:R8,Circle:v8};function S8(t,e){return parseInt(tr(t),10)-parseInt(tr(e),10)}function kD(t,e){const n=XE(t,e);return n*n}function XE(t,e){return N8*t/e}function v8(t,e,n,r,i){const l=n.getFill(),c=n.getStroke();if(l||c){const u=t.getBuilder(n.getZIndex(),"Circle");u.setFillStrokeStyle(l,c),u.drawCircle(e,r,i)}const d=n.getText();if(d&&d.getText()){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(d),u.drawText(e,r)}}function UD(t,e,n,r,i,l,c,d){const u=[],f=n.getImage();if(f){let y=!0;const g=f.getImageState();g==Sn.LOADED||g==Sn.ERROR?y=!1:g==Sn.IDLE&&f.load(),y&&u.push(f.ready())}const m=n.getFill();m&&m.loading()&&u.push(m.ready());const _=u.length>0;return _&&Promise.all(u).then(()=>i(null)),D8(t,e,n,r,l,c,d),_}function D8(t,e,n,r,i,l,c){const d=n.getGeometryFunction()(e);if(!d)return;const u=d.simplifyTransformed(r,i);if(n.getRenderer())JE(t,u,n,e,c);else{const m=qE[u.getType()];m(t,u,n,e,c,l)}}function JE(t,e,n,r,i){if(e.getType()=="GeometryCollection"){const c=e.getGeometries();for(let d=0,u=c.length;d<u;++d)JE(t,c[d],n,r,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i)}function R8(t,e,n,r,i,l){const c=e.getGeometriesArray();let d,u;for(d=0,u=c.length;d<u;++d){const f=qE[c[d].getType()];f(t,c[d],n,r,i,l)}}function T8(t,e,n,r,i){const l=n.getStroke();if(l){const d=t.getBuilder(n.getZIndex(),"LineString");d.setFillStrokeStyle(null,l),d.drawLineString(e,r,i)}const c=n.getText();if(c&&c.getText()){const d=t.getBuilder(n.getZIndex(),"Text");d.setTextStyle(c),d.drawText(e,r,i)}}function E8(t,e,n,r,i){const l=n.getStroke();if(l){const d=t.getBuilder(n.getZIndex(),"LineString");d.setFillStrokeStyle(null,l),d.drawMultiLineString(e,r,i)}const c=n.getText();if(c&&c.getText()){const d=t.getBuilder(n.getZIndex(),"Text");d.setTextStyle(c),d.drawText(e,r,i)}}function j8(t,e,n,r,i){const l=n.getFill(),c=n.getStroke();if(c||l){const u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(l,c),u.drawMultiPolygon(e,r,i)}const d=n.getText();if(d&&d.getText()){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(d),u.drawText(e,r,i)}}function I8(t,e,n,r,i,l){const c=n.getImage(),d=n.getText(),u=d&&d.getText(),f=l&&c&&u?{}:void 0;if(c){if(c.getImageState()!=Sn.LOADED)return;const m=t.getBuilder(n.getZIndex(),"Image");m.setImageStyle(c,f),m.drawPoint(e,r,i)}if(u){const m=t.getBuilder(n.getZIndex(),"Text");m.setTextStyle(d,f),m.drawText(e,r,i)}}function O8(t,e,n,r,i,l){const c=n.getImage(),d=c&&c.getOpacity()!==0,u=n.getText(),f=u&&u.getText(),m=l&&d&&f?{}:void 0;if(d){if(c.getImageState()!=Sn.LOADED)return;const _=t.getBuilder(n.getZIndex(),"Image");_.setImageStyle(c,m),_.drawMultiPoint(e,r,i)}if(f){const _=t.getBuilder(n.getZIndex(),"Text");_.setTextStyle(u,m),_.drawText(e,r,i)}}function M8(t,e,n,r,i){const l=n.getFill(),c=n.getStroke();if(l||c){const u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(l,c),u.drawPolygon(e,r,i)}const d=n.getText();if(d&&d.getText()){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(d),u.drawText(e,r,i)}}class L8 extends YE{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipExtent_=null,this.extendX_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zl(),this.wrappedRenderedExtent_=Zl(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,r){const i=n.extent,l=n.viewState,c=l.center,d=l.resolution,u=l.projection,f=l.rotation,m=u.getExtent(),_=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),g=n.pixelRatio,N=n.viewHints,C=!(N[Ra.ANIMATING]||N[Ra.INTERACTING]),v=this.context,R=Math.round(_r(i)/d*g),U=Math.round(Ua(i)/d*g),L=_.getWrapX()&&u.canWrapX(),w=L?_r(m):null,P=L?Math.ceil((i[2]-m[2])/w)+(this.extendX_?2:1):1;let G=L?Math.floor((i[0]-m[0])/w)-(this.extendX_?1:0):0;do{let K=this.getRenderTransform(c,d,0,g,R,U,G*w);n.declutter&&(K=K.slice(0)),e.execute(v,[v.canvas.width,v.canvas.height],K,f,C,r===void 0?Xu:r?$E:g8,r?y&&n.declutter[y]:void 0)}while(++G<P)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Ii(this.context.canvas.width,this.context.canvas.height,OD))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,_x(this.context),OD.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.clipExtent_&&this.clipUnrotated(this.context,e,this.clipExtent_),this.replayGroup_.renderDeferred(),this.clipExtent_&&(this.context.restore(),this.clipExtent_=null),this.resetDrawContext_())}renderFrame(e,n){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,n);const l=this.context,c=this.replayGroup_;let d=c&&!c.isEmpty();if(!d&&!(this.getLayer().hasListener(Hl.PRERENDER)||this.getLayer().hasListener(Hl.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(l,e),i.projection,this.clipExtent_=null;let u=!1;if(d&&r.extent&&this.clipping){const f=uu(r.extent);d=ol(f,e.extent),d&&!wm(f,e.extent)&&(e.declutter?this.clipExtent_=f:(this.clipUnrotated(l,e,f),u=!0))}return d&&this.renderWorlds(c,e,this.getLayer().getDeclutter()?!1:void 0),u&&l.restore(),this.postRender(l,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,l=this.renderedResolution_,c=this.renderedRotation_,d=this.renderedProjection_,u=this.wrappedRenderedExtent_,f=this.getLayer(),m=[],_=r[0]*ac,y=r[1]*ac;m.push(this.getRenderTransform(i,l,c,ac,_,y,0).slice());const g=f.getSource(),N=d.getExtent();if(g.getWrapX()&&d.canWrapX()&&!wm(N,u)){let C=u[0];const v=_r(N);let R=0,U;for(;C<N[0];)--R,U=v*R,m.push(this.getRenderTransform(i,l,c,ac,_,y,U).slice()),C+=v;for(R=0,C=u[2];C>N[2];)++R,U=v*R,m.push(this.getRenderTransform(i,l,c,ac,_,y,U).slice()),C-=v}this.hitDetectionImageData_=y8(r,m,this.renderedFeatures_,f.getStyleFunction(),u,l,c,kD(l,this.renderedPixelRatio_))}n(b8(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,r,i,l){var y,g;if(!this.replayGroup_)return;const c=n.viewState.resolution,d=n.viewState.rotation,u=this.getLayer(),f={},m=function(N,C,v){const R=tr(N),U=f[R];if(U){if(U!==!0&&v<U.distanceSq){if(v===0)return f[R]=!0,l.splice(l.lastIndexOf(U),1),i(N,u,C);U.geometry=C,U.distanceSq=v}}else{if(v===0)return f[R]=!0,i(N,u,C);l.push(f[R]={feature:N,layer:u,geometry:C,distanceSq:v,callback:i})}},_=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,c,d,r,m,_?(g=(y=n.declutter)==null?void 0:y[_])==null?void 0:g.all().map(N=>N.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),r=n.getSource();if(!r)return!1;const i=e.viewHints[Ra.ANIMATING],l=e.viewHints[Ra.INTERACTING],c=n.getUpdateWhileAnimating(),d=n.getUpdateWhileInteracting();if(this.ready&&!c&&i||!d&&l)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,f=e.viewState,m=f.projection,_=f.resolution,y=e.pixelRatio,g=n.getRevision(),N=n.getRenderBuffer();let C=n.getRenderOrder();C===void 0&&(C=S8);const v=f.center.slice(),R=Lb(u,N*_),U=R.slice(),L=[R.slice()],w=m.getExtent(),P=r.getWrapX()&&m.canWrapX();if(this.extendX_=!1,P){const q=r.getExtent();q&&!Dg(q)&&(this.extendX_=q[0]<w[0]||q[2]>w[2])}if(P&&(!wm(w,e.extent)||this.extendX_)){const q=_r(w),V=Math.max(_r(R)/2,q);let F=w[0],I=w[2];this.extendX_&&(F-=q,I+=q),R[0]=F-V,R[2]=I+V,X5(v,m);const ee=z5(L[0],m);ee[0]<w[0]&&ee[2]<w[2]?L.push([ee[0]+q,ee[1],ee[2]+q,ee[3]]):ee[0]>w[0]&&ee[2]>w[2]&&L.push([ee[0]-q,ee[1],ee[2]-q,ee[3]])}if(this.ready&&this.renderedResolution_==_&&this.renderedPixelRatio_===y&&this.renderedRevision_==g&&this.renderedRenderOrder_==C&&this.renderedFrameDeclutter_===!!e.declutter&&wm(this.wrappedRenderedExtent_,R))return Du(this.renderedExtent_,U)||(this.hitDetectionImageData_=null,this.renderedExtent_=U),this.renderedCenter_=v,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const G=new o8(XE(_,y),R,_,y);let K;for(let q=0,V=L.length;q<V;++q)r.loadFeatures(L[q],_,m);const B=kD(_,y);let O=!0;const S=(q,V)=>{let F;const I=q.getStyleFunction()||n.getStyleFunction();if(I&&(F=I(q,_)),F){const ee=this.renderFeature(q,B,F,G,K,this.getLayer().getDeclutter(),V);O=O&&!ee}},A=aE(R),Y=r.getFeaturesInExtent(A);C&&Y.sort(C);for(let q=0,V=Y.length;q<V;++q)S(Y[q],q);this.renderedFeatures_=Y,this.ready=O;const te=G.finish(),J=new _8(R,_,y,r.getOverlaps(),te,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=_,this.renderedRevision_=g,this.renderedRenderOrder_=C,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=U,this.wrappedRenderedExtent_=R,this.renderedCenter_=v,this.renderedProjection_=m,this.renderedPixelRatio_=y,this.replayGroup_=J,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,r,i,l,c,d){if(!r)return!1;let u=!1;if(Array.isArray(r))for(let f=0,m=r.length;f<m;++f)u=UD(i,e,r[f],n,this.boundHandleStyleImageChange_,l,c,d)||u;else u=UD(i,e,r,n,this.boundHandleStyleImageChange_,l,c,d);return u}}class w8 extends UE{constructor(e){super(e)}createRenderer(){return new L8(this)}}let P8=!1;function A8(t,e,n,r,i,l,c){const d=new XMLHttpRequest;d.open("GET",typeof t=="function"?t(n,r,i):t,!0),e.getType()=="arraybuffer"&&(d.responseType="arraybuffer"),d.withCredentials=P8,d.onload=function(u){if(!d.status||d.status>=200&&d.status<300){const f=e.getType();try{let m;f=="text"||f=="json"?m=d.responseText:f=="xml"?m=d.responseXML||d.responseText:f=="arraybuffer"&&(m=d.response),m?l(e.readFeatures(m,{extent:n,featureProjection:i}),e.readProjection(m)):c()}catch{c()}}else c()},d.onerror=c,d.send()}function BD(t,e){return function(n,r,i,l,c){A8(t,e,n,r,i,(d,u)=>{this.addFeatures(d),l!==void 0&&l(d)},()=>{this.changed(),c!==void 0&&c()})}}function k8(t,e){return[[-1/0,-1/0,1/0,1/0]]}class Hm extends gc{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new Hm(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Hr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=er(e,Rn.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?U8(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function U8(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(dr(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}function B8(t,e,n,r){const i=[];let l=Zl();for(let c=0,d=n.length;c<d;++c){const u=n[c];l=wb(t,e,u[0],r),i.push((l[0]+l[2])/2,(l[1]+l[3])/2),e=u[u.length-1]}return i}function WD(t,e,n,r,i,l,c){let d,u;const f=(n-e)/r;if(f===1)d=e;else if(f===2)d=e,u=i;else if(f!==0){let m=t[e],_=t[e+1],y=0;const g=[0];for(let v=e+r;v<n;v+=r){const R=t[v],U=t[v+1];y+=Math.sqrt((R-m)*(R-m)+(U-_)*(U-_)),g.push(y),m=R,_=U}const N=i*y,C=rP(g,N);C<0?(u=(N-g[-C-2])/(g[-C-1]-g[-C-2]),d=e+(-C-2)*r):d=e+C*r}c=c>1?c:2,l=l||new Array(c);for(let m=0;m<c;++m)l[m]=d===void 0?NaN:u===void 0?t[d+m]:Gl(t[d+m],t[d+r+m],u);return l}const FD=Io();class To{constructor(e,n,r,i,l,c){this.styleFunction,this.extent_,this.id_=c,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=l,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Y5(this.flatCoordinates_):wb(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=yh(this.getExtent());this.flatInteriorPoints_=Vb(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=OA(this.flatCoordinates_,this.ends_),n=B8(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=RA(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=WD(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const r=this.ends_;for(let i=0,l=r.length;i<l;++i){const c=r[i],d=WD(e,n,c,2,.5);Mb(this.flatMidpoints_,d),n=c}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=hl(e);const n=e.getExtent(),r=e.getWorldExtent();if(n&&r){const i=Ua(r)/Ua(n);id(FD,r[0],r[3],i,-i,0,0,0),xu(this.flatCoordinates_,0,this.flatCoordinates_.length,2,FD,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new To(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=U5((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=Yb(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=SA(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=fE(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new To(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}To.prototype.getFlatCoordinates=To.prototype.getOrientedFlatCoordinates;class KD{constructor(e){this.rbush_=new vE(e),this.items_={}}insert(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[tr(n)]=r}load(e,n){const r=new Array(n.length);for(let i=0,l=n.length;i<l;i++){const c=e[i],d=n[i],u={minX:c[0],minY:c[1],maxX:c[2],maxY:c[3],value:d};r[i]=u,this.items_[tr(d)]=u}this.rbush_.load(r)}remove(e){const n=tr(e),r=this.items_[n];return delete this.items_[n],this.rbush_.remove(r)!==null}update(e,n){const r=this.items_[tr(n)],i=[r.minX,r.minY,r.maxX,r.maxY];sg(i,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let r;for(let i=0,l=e.length;i<l;i++)if(r=n(e[i]),r)return r;return r}isEmpty(){return Sf(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return bu(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class ZE extends gc{constructor(e){super(),this.projection=hl(e.projection),this.attributions_=QD(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(r,i){n.viewResolver=r,n.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=QD(e),this.changed()}setState(e){this.state_=e,this.changed()}}function QD(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const Wl={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Vd extends cd{constructor(e,n,r){super(e),this.feature=n,this.features=r}}class W8 extends ZE{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=tg,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(dr(this.format_,"`format` must be set when `url` is set"),this.loader_=BD(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:k8;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new KD:null,this.loadedExtentsRtree_=new KD,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!n&&r===void 0&&(r=new Vl(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=tr(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new Vd(Wl.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof To||(this.featureChangeKeys_[e]=[er(n,Rn.CHANGE,this.handleFeatureChange_,this),er(n,Nf.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let r=!0;if(n.getId()!==void 0){const i=String(n.getId());if(!(i in this.idIndex_))this.idIndex_[i]=n;else if(n instanceof To){const l=this.idIndex_[i];l instanceof To?Array.isArray(l)?l.push(n):this.idIndex_[i]=[l,n]:r=!1}else r=!1}return r&&(dr(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],r=[],i=[];for(let l=0,c=e.length;l<c;l++){const d=e[l],u=tr(d);this.addToIndex_(u,d)&&r.push(d)}for(let l=0,c=r.length;l<c;l++){const d=r[l],u=tr(d);this.setupChangeEvents_(u,d);const f=d.getGeometry();if(f){const m=f.getExtent();n.push(m),i.push(d)}else this.nullGeometryFeatures_[u]=d}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(Wl.ADDFEATURE))for(let l=0,c=r.length;l<c;l++)this.dispatchEvent(new Vd(Wl.ADDFEATURE,r[l]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(Wl.ADDFEATURE,function(r){n||(n=!0,e.push(r.feature),n=!1)}),this.addEventListener(Wl.REMOVEFEATURE,function(r){n||(n=!0,e.remove(r.feature),n=!1)}),e.addEventListener(il.ADD,r=>{n||(n=!0,this.addFeature(r.element),n=!1)}),e.addEventListener(il.REMOVE,r=>{n||(n=!0,this.removeFeature(r.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(Hr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new Vd(Wl.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const l=i.getGeometry();if(l instanceof To||l.intersectsCoordinate(e))return n(i)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof To||i.intersectsExtent(e)){const l=n(r);if(l)return l}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Sf(this.nullGeometryFeatures_)||Mb(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){n.push(r)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=q5(e,n);return[].concat(...i.map(l=>this.featuresRtree_.getInExtent(l)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const r=e[0],i=e[1];let l=null;const c=[NaN,NaN];let d=1/0;const u=[-1/0,-1/0,1/0,1/0];return n=n||eg,this.featuresRtree_.forEachInExtent(u,function(f){if(n(f)){const m=f.getGeometry(),_=d;if(d=m instanceof To?0:m.closestPointXY(r,i,c,d),d<_){l=f;const y=Math.sqrt(d);u[0]=r-y,u[1]=i-y,u[2]=r+y,u[3]=i+y}}}),l}getExtent(e){var n;return((n=this.featuresRtree_)==null?void 0:n.getExtent(e))??null}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,r=tr(n),i=n.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{const c=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(c,n)):this.featuresRtree_&&this.featuresRtree_.update(c,n)}const l=n.getId();if(l!==void 0){const c=l.toString();this.idIndex_[c]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[c]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new Vd(Wl.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:tr(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Sf(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,r){const i=this.loadedExtentsRtree_,l=this.strategy_(e,n,r);for(let c=0,d=l.length;c<d;++c){const u=l[c];i.forEachInExtent(u,function(m){return wm(m.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Vd(Wl.FEATURESLOADSTART)),this.loader_.call(this,u,n,r,m=>{--this.loadingExtentsCount_,this.dispatchEvent(new Vd(Wl.FEATURESLOADEND,void 0,m))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Vd(Wl.FEATURESLOADERROR))}),i.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,r=n.forEachInExtent(e,function(i){if(sg(i.extent,e))return i});r&&n.remove(r)}removeFeatures(e){let n=!1;for(let r=0,i=e.length;r<i;++r)n=this.removeFeatureInternal(e[r])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=tr(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e);const r=this.featureChangeKeys_[n];r==null||r.forEach(Hr),delete this.featureChangeKeys_[n];const i=e.getId();if(i!==void 0){const l=i.toString(),c=this.idIndex_[l];c===e?delete this.idIndex_[l]:Array.isArray(c)&&(c.splice(c.indexOf(e),1),c.length===1&&(this.idIndex_[l]=c[0]))}return delete this.uidIndex_[n],this.hasListener(Wl.REMOVEFEATURE)&&this.dispatchEvent(new Vd(Wl.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){dr(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(BD(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}const j0=[0,0,0],$d=5;class ej{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,dr(lP(this.resolutions_,(i,l)=>l-i),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let i=0,l=this.resolutions_.length-1;i<l;++i)if(!n)n=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,dr(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Lh(r)),dr(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,dr(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Xb,dr(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,l)=>{const c=new dN(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const d=this.getTileRangeForExtentAndZ(r,l);c.minX=Math.max(d.minX,c.minX),c.maxX=Math.min(d.maxX,c.maxX),c.minY=Math.max(d.minY,c.minY),c.maxY=Math.min(d.maxY,c.maxY)}return c}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,n,r){const i=this.getTileRangeForExtentAndZ(e,n);for(let l=i.minX,c=i.maxX;l<=c;++l)for(let d=i.minY,u=i.maxY;d<=u;++d)r([n,l,d])}forEachTileCoordParentTileRange(e,n,r,i){let l,c,d,u=null,f=e[0]-1;for(this.zoomFactor_===2?(c=e[1],d=e[2]):u=this.getTileCoordExtent(e,i);f>=this.minZoom;){if(c!==void 0&&d!==void 0?(c=Math.floor(c/2),d=Math.floor(d/2),l=T0(c,c,d,d,r)):l=this.getTileRangeForExtentAndZ(u,f,r),n(f,l))return!0;--f}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getOrigins(){return this.origins_}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const l=e[1]*2,c=e[2]*2;return T0(l,l+1,c,c+1,n)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,r){if(n>this.maxZoom||n<this.minZoom)return null;const i=e[0],l=e[1],c=e[2];if(n===i)return T0(l,c,l,c,r);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,n-i),f=Math.floor(l*u),m=Math.floor(c*u);if(n<i)return T0(f,f,m,m,r);const _=Math.floor(u*(l+1))-1,y=Math.floor(u*(c+1))-1;return T0(f,_,m,y,r)}const d=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(d,n,r)}getTileRangeForExtentAndZ(e,n,r){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,j0);const i=j0[1],l=j0[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,j0);const c=j0[1],d=j0[2];return T0(i,c,l,d,r)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=cl(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*i[0]*r,n[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,n){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),l=cl(this.getTileSize(e[0]),this.tmpSize_),c=r[0]+e[1]*l[0]*i,d=r[1]-(e[2]+1)*l[1]*i,u=c+l[0]*i,f=d+l[1]*i;return bu(c,d,u,f,n)}getTileCoordForCoordAndResolution(e,n,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,r)}getTileCoordForXYAndResolution_(e,n,r,i,l){const c=this.getZForResolution(r),d=r/this.getResolution(c),u=this.getOrigin(c),f=cl(this.getTileSize(c),this.tmpSize_);let m=d*(e-u[0])/r/f[0],_=d*(u[1]-n)/r/f[1];return i?(m=wp(m,$d)-1,_=wp(_,$d)-1):(m=Lp(m,$d),_=Lp(_,$d)),F_(c,m,_,l)}getTileCoordForXYAndZ_(e,n,r,i,l){const c=this.getOrigin(r),d=this.getResolution(r),u=cl(this.getTileSize(r),this.tmpSize_);let f=(e-c[0])/d/u[0],m=(c[1]-n)/d/u[1];return i?(f=wp(f,$d)-1,m=wp(m,$d)-1):(f=Lp(f,$d),m=Lp(m,$d)),F_(r,f,m,l)}getTileCoordForCoordAndZ(e,n,r){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const r=Ob(this.resolutions_,e,n||0);return zr(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return pE(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,r=new Array(n);for(let i=this.minZoom;i<n;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function tj(t){let e=t.getDefaultTileGrid();return e||(e=G8(t),t.setDefaultTileGrid(e)),e}function F8(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),l=uN(n);if(!vf(l,i)){const c=_r(l),d=Math.ceil((l[0]-i[0])/c);return i[0]+=c*d,t.getTileCoordForCoordAndZ(i,r)}return e}function K8(t,e,n,r){r=r!==void 0?r:"top-left";const i=sj(t,e,n);return new ej({extent:t,origin:SP(t,r),resolutions:i,tileSize:n})}function Q8(t){const e=t||{},n=e.extent||hl("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:sj(n,e.maxZoom,e.tileSize,e.maxResolution)};return new ej(r)}function sj(t,e,n,r){e=e!==void 0?e:AA,n=cl(n!==void 0?n:Xb);const i=Ua(t),l=_r(t);r=r>0?r:Math.max(l/n[0],i/n[1]);const c=e+1,d=new Array(c);for(let u=0;u<c;++u)d[u]=r/Math.pow(2,u);return d}function G8(t,e,n,r){const i=uN(t);return K8(i,e,n,r)}function uN(t){t=hl(t);let e=t.getExtent();if(!e){const n=180*Ab.degrees/t.getMetersPerUnit();e=bu(-n,-n,n,n)}return e}const Y8=/\{z\}/g,V8=/\{x\}/g,$8=/\{y\}/g,H8=/\{-y\}/g;function z8(t,e,n,r,i){return t.replace(Y8,e.toString()).replace(V8,n.toString()).replace($8,r.toString()).replace(H8,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function q8(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let l;for(l=r;l<=i;++l)e.push(t.replace(n[0],String.fromCharCode(l)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}function X8(t,e){return(function(n,r,i){if(!n)return;let l;const c=n[0];if(e){const d=e.getFullTileRange(c);d&&(l=d.getHeight()-1)}return z8(t,c,n[1],n[2],l)})}function J8(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=X8(t[i],e);return Z8(r)}function Z8(t){return t.length===1?t[0]:(function(e,n,r){if(!e)return;const i=Vk(e),l=X0(i,t.length);return t[l](e,n,r)})}class e7 extends ZE{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&cl(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||tr(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,r,i,l,c){return Zn()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:tj(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),l=this.getTilePixelRatio(n),c=cl(i.getTileSize(e),this.tmpSize);return l==1?c:O6(c,l,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const r=n!==void 0?n:this.getProjection(),i=n!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=F8(i,e,r)),Hk(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class t7 extends cd{constructor(e,n){super(e),this.tile=n}}const jC={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class hN extends e7{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===hN.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,r=tr(n),i=n.getState();let l;i==ln.LOADING?(this.tileLoadingKeys_[r]=!0,l=jC.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],l=i==ln.ERROR?jC.TILELOADERROR:i==ln.LOADED?jC.TILELOADEND:void 0),l!=null&&this.dispatchEvent(new t7(l,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=q8(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(J8(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,r){}}class s7 extends hN{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:n7,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.referrerPolicy=e.referrerPolicy,this.tileClass=e.tileClass!==void 0?e.tileClass:KE,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!c_(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||c_(n,e)))return this.tileGrid;const r=tr(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=tj(e)),this.tileGridForProjection[r]}createTile_(e,n,r,i,l,c){const d=[e,n,r],u=this.getTileCoordForTileUrlFunction(d,l),f=u?this.tileUrlFunction(u,i,l):void 0,m=new this.tileClass(d,f!==void 0?ln.IDLE:ln.EMPTY,f!==void 0?f:"",{crossOrigin:this.crossOrigin,referrerPolicy:this.referrerPolicy},this.tileLoadFunction,this.tileOptions);return m.key=c,m.addEventListener(Rn.CHANGE,this.handleTileChange.bind(this)),m}getTile(e,n,r,i,l,c){const d=this.getProjection();if(!d||!l||c_(d,l))return this.getTileInternal(e,n,r,i,d||l);const u=[e,n,r],f=this.getKey(),m=this.getTileGridForProjection(d),_=this.getTileGridForProjection(l),y=this.getTileCoordForTileUrlFunction(u,l),g=new QE(d,m,l,_,u,y,this.getTilePixelRatio(i),this.getGutter(),(N,C,v,R)=>this.getTileInternal(N,C,v,R,d,c),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=f,g}getTileInternal(e,n,r,i,l,c){const d=this.getKey(),u=d_(this,d,e,n,r);if(c&&c.containsKey(u))return c.get(u);const f=this.createTile_(e,n,r,i,l,d);return c==null||c.set(u,f),f}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const r=hl(e);if(r){const i=tr(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=n)}}}function n7(t,e){if($l){const n=t.getCrossOrigin();let r="same-origin",i="same-origin";n==="anonymous"||n===""?(r="cors",i="omit"):n==="use-credentials"&&(r="cors",i="include");const l={mode:r,credentials:i,referrerPolicy:t.getReferrerPolicy()};fetch(e,l).then(c=>{if(!c.ok)throw new Error(`HTTP ${c.status}`);return c.blob()}).then(c=>createImageBitmap(c)).then(c=>{var f;const d=t.getImage();d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0),(f=c.close)==null||f.call(c),d.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class r7 extends s7{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:Q8({extent:uN(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,referrerPolicy:e.referrerPolicy,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const I0={:"#DC2626",:"#16A34A",:"#9CA3AF",default:"#EF4444"},i7="A4EED0C3-BED4-315A-AF7B-B47F94357975";function a7(t,e){const n=e+1,r=n>=100?9:n>=10?11:13,i=`<svg xmlns="http://www.w3.org/2000/svg" width="36" height="48" viewBox="0 0 36 48">
    <path fill="${t}" stroke="#fff" stroke-width="2" d="M18 2C9.163 2 2 9.163 2 18c0 12 16 28 16 28s16-16 16-28c0-8.837-7.163-16-16-16z"/>
    <circle fill="#fff" cx="18" cy="18" r="10"/>
    <text x="18" y="22" text-anchor="middle" font-size="${r}" font-weight="bold" fill="${t}" font-family="Arial,sans-serif">${n}</text>
  </svg>`;return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(i)}function IC(){return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <circle cx="20" cy="20" r="18" fill="#3B82F6" fill-opacity="0.15" stroke="#3B82F6" stroke-width="1.5" stroke-opacity="0.4"/>
    <circle cx="20" cy="20" r="9" fill="#3B82F6" stroke="#fff" stroke-width="3"/>
  </svg>`)}function l7(){return new Promise(t=>{var r,i,l;if((i=(r=window.kakao)==null?void 0:r.maps)!=null&&i.services){t(!0);return}if((l=window.kakao)!=null&&l.maps){window.kakao.maps.load(()=>t(!!window.kakao.maps.services));return}let e=0;const n=setInterval(async()=>{var c;if(e++,(c=window.kakao)!=null&&c.maps){if(clearInterval(n),window.kakao.maps.services){t(!0);return}window.kakao.maps.load(()=>t(!!window.kakao.maps.services))}else if(e>25){clearInterval(n);const d=await jb(),u=I_(d.kakao);if(!u){t(!1);return}const f=document.createElement("script");f.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=${u}&libraries=services&autoload=false`,f.onload=()=>{var m;(m=window.kakao)!=null&&m.maps?window.kakao.maps.load(()=>t(!!window.kakao.maps.services)):t(!1)},f.onerror=()=>t(!1),document.head.appendChild(f)}},200)})}function o7(t){return new Promise(e=>{var r,i;if(!((i=(r=window.kakao)==null?void 0:r.maps)!=null&&i.services)){e(null);return}const n=new window.kakao.maps.services.Geocoder;n.addressSearch(t,(l,c)=>{if(c===window.kakao.maps.services.Status.OK&&l[0])e({lat:parseFloat(l[0].y),lng:parseFloat(l[0].x)});else{const d=t.replace(/\(.*?\)/g,"").replace(/\d+[]/g,"").replace(/\s{2,}/g," ").trim();d!==t?n.addressSearch(d,(u,f)=>{f===window.kakao.maps.services.Status.OK&&u[0]?e({lat:parseFloat(u[0].y),lng:parseFloat(u[0].x)}):e(null)}):e(null)}})})}const nj=({workOrders:t,onBack:e,onSelectWork:n})=>{var I,ee;const r=x.useRef(null),i=x.useRef(null),l=x.useRef(null),c=x.useRef(null),d=x.useRef(null),u=x.useRef(null),f=x.useRef([]),m=x.useRef(null),_=x.useRef([]),y=x.useRef(null),[g,N]=x.useState("vworld"),[C,v]=x.useState(!0),[R,U]=x.useState(null),L=x.useRef(!0),w=x.useRef(!0),[P,G]=x.useState(0),[K,B]=x.useState(0),[O,S]=x.useState(null),[A,Y]=x.useState(null);x.useEffect(()=>{let ae=!1;return(async()=>{var Z,le,se,Ee,Ne;const T=await jb(),j=I_(T.vworld)||i7;if(console.log(`[Map] VWorld  : ${j.substring(0,8)}...`),ae)return;const k=new W8;c.current=k;const Q=new r7({url:`https://api.vworld.kr/req/wmts/1.0.0/${j}/Base/{z}/{y}/{x}.png`,maxZoom:19,attributions:" VWorld"});let H=0;Q.on("tileloaderror",()=>{H++,H>=3&&L.current&&(L.current=!1,console.warn("[Map] VWorld   ,   "),w.current?N("kakao"):U("    .   ."))});const $=new wk({target:r.current,layers:[new t8({source:Q}),new w8({source:k})],view:new ic({center:kc([126.978,37.5665]),zoom:8,maxZoom:19,minZoom:6})});l.current=$,$.on("click",ye=>{const ne=$.forEachFeatureAtPixel(ye.pixel,ue=>ue);if(ne){const ue=ne.get("workId"),xe=_.current.find(et=>et.work.id===ue);xe&&(S(xe.work),Y(xe.coords),$.getView().animate({center:kc([xe.coords.lng,xe.coords.lat]),zoom:Math.max($.getView().getZoom()||14,14),duration:300}))}else S(null),Y(null)}),$.on("pointermove",ye=>{const ne=$.forEachFeatureAtPixel(ye.pixel,()=>!0);$.getTargetElement().style.cursor=ne?"pointer":""});let ie=null;const fe=()=>{var ye,ne;try{if(!((ne=(ye=window.kakao)==null?void 0:ye.maps)!=null&&ne.Map)||!i.current)return null;const ue=new window.kakao.maps.Map(i.current,{center:new window.kakao.maps.LatLng(37.5665,126.978),level:8});return u.current=ue,window.kakao.maps.event.addListener(ue,"click",()=>{S(null),Y(null)}),w.current=!0,console.log("[Map]   "),ue}catch(ue){return console.warn("[Map]   :",ue),w.current=!1,L.current?N("vworld"):U("    .   ."),null}};if(!((Z=window.kakao)!=null&&Z.maps)){const ye=I_(T.kakao);ye?(console.log(`[Map]  SDK    (: ${ye.substring(0,8)}...)`),await new Promise(ne=>{const ue=document.createElement("script");ue.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=${ye}&libraries=services&autoload=false`,ue.onload=()=>{var xe;console.log("[Map]  SDK   "),(xe=window.kakao)!=null&&xe.maps?window.kakao.maps.load(()=>{console.log("[Map]  maps.load() "),ne()}):ne()},ue.onerror=()=>{console.error("[Map]  SDK   "),ne()},document.head.appendChild(ue)})):console.warn("[Map] MOMP001   ")}if(ae)return;(le=window.kakao)!=null&&le.maps?window.kakao.maps.Map?ie=fe():window.kakao.maps.load(()=>{ie=fe()}):(w.current=!1,console.warn("[Map]  SDK  "));const pe=(ye,ne)=>{y.current={lat:ye,lng:ne};const ue=IC(),xe=new Hm({geometry:new Z0(kc([ne,ye]))});if(xe.set("isMyLocation",!0),xe.setStyle(new cc({image:new mh({src:ue,anchor:[.5,.5],scale:1})})),k.addFeature(xe),d.current=xe,ie){const et=new window.kakao.maps.MarkerImage(ue,new window.kakao.maps.Size(40,40),{offset:new window.kakao.maps.Point(20,20)}),bt=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(ye,ne),image:et,map:ie,zIndex:10});m.current=bt}console.log(`[Map]   : ${ye}, ${ne}`)};if(navigator.geolocation&&navigator.geolocation.getCurrentPosition(ye=>{ae||pe(ye.coords.latitude,ye.coords.longitude)},ye=>console.warn("[Map]   :",ye.message),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}),!await l7()){U("     ."),v(!1);return}!ie&&((Ee=(se=window.kakao)==null?void 0:se.maps)!=null&&Ee.Map)&&(ie=fe()),console.log(`[Map] Geocoding : ${t.length}`);const Re=[],X=[];let _e=0;for(let ye=0;ye<t.length;ye++){if(ae)return;const ne=t[ye],ue=(Ne=ne.customer)==null?void 0:Ne.address;if(ue){ye>0&&await new Promise(et=>setTimeout(et,80));const xe=await o7(ue);if(xe){const et=I0[ne.status]||I0.default,bt=a7(et,ye),it=new Hm({geometry:new Z0(kc([xe.lng,xe.lat]))});if(it.set("workId",ne.id),it.setStyle(new cc({image:new mh({src:bt,anchor:[.5,1],scale:1})})),k.addFeature(it),X.push(kc([xe.lng,xe.lat])),ie){const At=new window.kakao.maps.MarkerImage(bt,new window.kakao.maps.Size(36,48),{offset:new window.kakao.maps.Point(18,48)}),at=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(xe.lat,xe.lng),image:At,map:ie}),We=ne,Dt=xe;window.kakao.maps.event.addListener(at,"click",()=>{S(We),Y(Dt),ie.panTo(new window.kakao.maps.LatLng(Dt.lat,Dt.lng))}),f.current.push(at)}Re.push({work:ne,coords:xe}),_e++,console.log(`[Map] ${ye+1}/${t.length} : "${ue}"  ${xe.lat},${xe.lng}`)}else console.warn(`[Map] ${ye+1}/${t.length} : "${ue}"`)}G(ye+1),B(_e)}_.current=Re,console.log(`[Map] Geocoding : ${_e}/${t.length} `);const me=y.current;if(me&&X.push(kc([me.lng,me.lat])),X.length>0&&(X.length===1?$.getView().animate({center:X[0],zoom:15,duration:300}):$.getView().fit(jy(X),{padding:[60,60,60,60],maxZoom:16,duration:300})),ie&&(Re.length>0||me)){const ye=new window.kakao.maps.LatLngBounds;Re.forEach(ne=>{ye.extend(new window.kakao.maps.LatLng(ne.coords.lat,ne.coords.lng))}),me&&ye.extend(new window.kakao.maps.LatLng(me.lat,me.lng)),ie.setBounds(ye)}v(!1)})(),()=>{ae=!0,l.current&&(l.current.setTarget(void 0),l.current=null),c.current=null,d.current=null,f.current.forEach(T=>T.setMap(null)),f.current=[],m.current&&m.current.setMap(null),m.current=null,u.current=null,y.current=null}},[t]),x.useEffect(()=>{const ae=setTimeout(()=>{if(g==="vworld"&&l.current)l.current.updateSize();else if(g==="kakao"&&u.current&&(u.current.relayout(),_.current.length>0)){const T=new window.kakao.maps.LatLngBounds;_.current.forEach(j=>{T.extend(new window.kakao.maps.LatLng(j.coords.lat,j.coords.lng))}),u.current.setBounds(T)}},150);return()=>clearTimeout(ae)},[g]);const te=x.useCallback(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(ae=>{const{latitude:T,longitude:j}=ae.coords;if(y.current={lat:T,lng:j},d.current)d.current.getGeometry().setCoordinates(kc([j,T]));else if(c.current){const k=new Hm({geometry:new Z0(kc([j,T]))});k.set("isMyLocation",!0),k.setStyle(new cc({image:new mh({src:IC(),anchor:[.5,.5],scale:1})})),c.current.addFeature(k),d.current=k}if(m.current)m.current.setPosition(new window.kakao.maps.LatLng(T,j));else if(u.current){const k=new window.kakao.maps.MarkerImage(IC(),new window.kakao.maps.Size(40,40),{offset:new window.kakao.maps.Point(20,20)});m.current=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(T,j),image:k,map:u.current,zIndex:10})}g==="vworld"&&l.current?l.current.getView().animate({center:kc([j,T]),zoom:15,duration:500}):g==="kakao"&&u.current&&(u.current.panTo(new window.kakao.maps.LatLng(T,j)),u.current.setLevel(3))},()=>alert("    ."),{enableHighAccuracy:!0,timeout:1e4})},[g]),J=Yl(ae=>ae.preferredNavApp),q=x.useCallback(()=>{var ae;!A||!O||M5(J,{lat:A.lat,lng:A.lng,name:((ae=O.customer)==null?void 0:ae.address)||""})},[A,O,J]),V=x.useCallback(()=>{S(null),Y(null)},[]),F=x.useCallback(()=>{N(ae=>{const T=ae==="vworld"?"kakao":"vworld";return T==="kakao"&&!w.current?(alert(`    .
 SDK  .`),ae):T==="vworld"&&!L.current?(alert(`     .
VWorld   .`),ae):T}),V()},[V]);return s.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col",style:{zIndex:200},children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b border-gray-200",children:[s.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-gray-700",children:[s.jsx(mb,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:""})]}),s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:" "}),s.jsxs("button",{onClick:F,className:"flex items-center gap-1 px-3 py-1.5 rounded-full text-xs font-semibold border",style:{background:g==="vworld"?"#EFF6FF":"#FEF9C3",color:g==="vworld"?"#1D4ED8":"#92400E",borderColor:g==="vworld"?"#BFDBFE":"#FDE68A"},children:[s.jsx(FL,{className:"w-3.5 h-3.5"}),g==="vworld"?"":""]})]}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("div",{ref:r,className:"absolute inset-0",style:{display:g==="vworld"?"block":"none"}}),s.jsx("div",{ref:i,className:"absolute inset-0",style:{display:g==="kakao"?"block":"none"}}),C&&!R&&s.jsxs("div",{className:"absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-10",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),s.jsxs("p",{className:"text-gray-600",children:["  ... (",P,"/",t.length,")"]}),K>0&&s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[K,"  "]})]}),R&&s.jsxs("div",{className:"absolute inset-0 bg-white flex flex-col items-center justify-center z-10 p-6",children:[s.jsx("p",{className:"text-gray-700 text-center mb-4",children:R}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg",children:""})]}),!C&&!R&&s.jsx("div",{className:"absolute top-3 left-3 bg-white/90 backdrop-blur rounded-lg shadow p-2.5 z-20",children:s.jsxs("div",{className:"flex gap-3 text-[11px]",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full border-2 border-blue-500",style:{background:"#3B82F6"}}),s.jsx("span",{className:"text-gray-600 font-semibold",children:" "})]}),[["#DC2626",""],["#16A34A",""],["#EF4444",""],["#9CA3AF",""]].map(([ae,T])=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:ae}}),s.jsx("span",{className:"text-gray-600",children:T})]},T))]})}),s.jsx("button",{onClick:te,title:" ",className:"absolute bottom-20 right-4 w-11 h-11 bg-white rounded-full shadow-lg flex items-center justify-center z-20",style:{bottom:O?"220px":"80px"},children:s.jsx(tw,{className:"w-5 h-5 text-blue-500"})}),s.jsxs("button",{onClick:e,className:"absolute left-4 px-4 py-2.5 bg-white rounded-full shadow-lg flex items-center gap-2 z-20",style:{bottom:O?"220px":"80px"},children:[s.jsx(gb,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]}),O&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-30 px-3 pb-3",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-100 p-4 max-w-lg mx-auto relative",children:[s.jsx("button",{onClick:V,className:"absolute top-3 right-3 p-1",children:s.jsx(bi,{size:16,className:"text-gray-400"})}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold",style:{background:`${I0[O.status]||I0.default}15`,color:I0[O.status]||I0.default},children:O.typeDisplay||O.type}),s.jsx("span",{className:"px-2 py-0.5 rounded bg-gray-100 text-gray-500 text-xs",children:O.status})]}),s.jsx("div",{className:"font-semibold text-[15px] text-gray-900 mb-1 pr-6",children:((I=O.customer)==null?void 0:I.name)||" "}),s.jsx("div",{className:"text-[13px] text-gray-500 mb-3 leading-snug",children:((ee=O.customer)==null?void 0:ee.address)||" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{var ae;(ae=O.customer)!=null&&ae.phone&&(window.location.href=`tel:${O.customer.phone}`)},className:"flex-1 py-2.5 rounded-lg bg-blue-500 text-white text-xs font-medium active:bg-blue-600",children:""}),s.jsx("button",{onClick:q,className:"flex-1 py-2.5 rounded-lg bg-purple-500 text-white text-xs font-medium active:bg-purple-600",children:""}),s.jsx("button",{onClick:()=>n(O),className:"flex-1 py-2.5 rounded-lg bg-emerald-500 text-white text-xs font-medium active:bg-emerald-600",children:""})]})]})})]}),s.jsx("div",{className:"px-4 py-2.5 bg-white border-t border-gray-200",children:s.jsxs("div",{className:"text-center text-sm text-gray-500",children:[" ",t.length," ",K>0&&!C&&`(${K} )`]})})]})};function td(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function fN(t,e=[]){let n=[];function r(l,c){const d=x.createContext(c),u=n.length;n=[...n,c];const f=_=>{var R;const{scope:y,children:g,...N}=_,C=((R=y==null?void 0:y[t])==null?void 0:R[u])||d,v=x.useMemo(()=>N,Object.values(N));return s.jsx(C.Provider,{value:v,children:g})};f.displayName=l+"Provider";function m(_,y){var C;const g=((C=y==null?void 0:y[t])==null?void 0:C[u])||d,N=x.useContext(g);if(N)return N;if(c!==void 0)return c;throw new Error(`\`${_}\` must be used within \`${l}\``)}return[f,m]}const i=()=>{const l=n.map(c=>x.createContext(c));return function(d){const u=(d==null?void 0:d[t])||l;return x.useMemo(()=>({[`__scope${t}`]:{...d,[t]:u}}),[d,u])}};return i.scopeName=t,[r,c7(i,...e)]}function c7(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const c=r.reduce((d,{useScope:u,scopeName:f})=>{const _=u(l)[`__scope${f}`];return{...d,..._}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return n.scopeName=e.scopeName,n}function GD(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function rj(...t){return e=>{let n=!1;const r=t.map(i=>{const l=GD(i,e);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let i=0;i<r.length;i++){const l=r[i];typeof l=="function"?l():GD(t[i],null)}}}}function Q_(...t){return x.useCallback(rj(...t),t)}function Yy(t){const e=d7(t),n=x.forwardRef((r,i)=>{const{children:l,...c}=r,d=x.Children.toArray(l),u=d.find(h7);if(u){const f=u.props.children,m=d.map(_=>_===u?x.Children.count(f)>1?x.Children.only(null):x.isValidElement(f)?f.props.children:null:_);return s.jsx(e,{...c,ref:i,children:x.isValidElement(f)?x.cloneElement(f,void 0,m):null})}return s.jsx(e,{...c,ref:i,children:l})});return n.displayName=`${t}.Slot`,n}function d7(t){const e=x.forwardRef((n,r)=>{const{children:i,...l}=n;if(x.isValidElement(i)){const c=m7(i),d=f7(l,i.props);return i.type!==x.Fragment&&(d.ref=r?rj(r,c):c),x.cloneElement(i,d)}return x.Children.count(i)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var u7=Symbol("radix.slottable");function h7(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===u7}function f7(t,e){const n={...e};for(const r in e){const i=t[r],l=e[r];/^on[A-Z]/.test(r)?i&&l?n[r]=(...d)=>{const u=l(...d);return i(...d),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...l}:r==="className"&&(n[r]=[i,l].filter(Boolean).join(" "))}return{...t,...n}}function m7(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function g7(t){const e=t+"CollectionProvider",[n,r]=fN(e),[i,l]=n(e,{collectionRef:{current:null},itemMap:new Map}),c=C=>{const{scope:v,children:R}=C,U=Gi.useRef(null),L=Gi.useRef(new Map).current;return s.jsx(i,{scope:v,itemMap:L,collectionRef:U,children:R})};c.displayName=e;const d=t+"CollectionSlot",u=Yy(d),f=Gi.forwardRef((C,v)=>{const{scope:R,children:U}=C,L=l(d,R),w=Q_(v,L.collectionRef);return s.jsx(u,{ref:w,children:U})});f.displayName=d;const m=t+"CollectionItemSlot",_="data-radix-collection-item",y=Yy(m),g=Gi.forwardRef((C,v)=>{const{scope:R,children:U,...L}=C,w=Gi.useRef(null),P=Q_(v,w),G=l(m,R);return Gi.useEffect(()=>(G.itemMap.set(w,{ref:w,...L}),()=>void G.itemMap.delete(w))),s.jsx(y,{[_]:"",ref:P,children:U})});g.displayName=m;function N(C){const v=l(t+"CollectionConsumer",C);return Gi.useCallback(()=>{const U=v.collectionRef.current;if(!U)return[];const L=Array.from(U.querySelectorAll(`[${_}]`));return Array.from(v.itemMap.values()).sort((G,K)=>L.indexOf(G.ref.current)-L.indexOf(K.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:c,Slot:f,ItemSlot:g},N,r]}var G_=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},p7=WT[" useId ".trim().toString()]||(()=>{}),_7=0;function ij(t){const[e,n]=x.useState(p7());return G_(()=>{n(r=>r??String(_7++))},[t]),e?`radix-${e}`:""}var x7=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],wf=x7.reduce((t,e)=>{const n=Yy(`Primitive.${e}`),r=x.forwardRef((i,l)=>{const{asChild:c,...d}=i,u=c?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(u,{...d,ref:l})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function C7(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}var y7=WT[" useInsertionEffect ".trim().toString()]||G_;function aj({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[i,l,c]=b7({defaultProp:e,onChange:n}),d=t!==void 0,u=d?t:i;{const m=x.useRef(t!==void 0);x.useEffect(()=>{const _=m.current;_!==d&&console.warn(`${r} is changing from ${_?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=d},[d,r])}const f=x.useCallback(m=>{var _;if(d){const y=N7(m)?m(t):m;y!==t&&((_=c.current)==null||_.call(c,y))}else l(m)},[d,t,l,c]);return[u,f]}function b7({defaultProp:t,onChange:e}){const[n,r]=x.useState(t),i=x.useRef(n),l=x.useRef(e);return y7(()=>{l.current=e},[e]),x.useEffect(()=>{var c;i.current!==n&&((c=l.current)==null||c.call(l,n),i.current=n)},[n,i]),[n,r,l]}function N7(t){return typeof t=="function"}var S7=x.createContext(void 0);function lj(t){const e=x.useContext(S7);return t||e||"ltr"}var OC="rovingFocusGroup.onEntryFocus",v7={bubbles:!1,cancelable:!0},Og="RovingFocusGroup",[Vy,oj,D7]=g7(Og),[R7,cj]=fN(Og,[D7]),[T7,E7]=R7(Og),dj=x.forwardRef((t,e)=>s.jsx(Vy.Provider,{scope:t.__scopeRovingFocusGroup,children:s.jsx(Vy.Slot,{scope:t.__scopeRovingFocusGroup,children:s.jsx(j7,{...t,ref:e})})}));dj.displayName=Og;var j7=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:l,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:u,onEntryFocus:f,preventScrollOnEntryFocus:m=!1,..._}=t,y=x.useRef(null),g=Q_(e,y),N=lj(l),[C,v]=aj({prop:c,defaultProp:d??null,onChange:u,caller:Og}),[R,U]=x.useState(!1),L=C7(f),w=oj(n),P=x.useRef(!1),[G,K]=x.useState(0);return x.useEffect(()=>{const B=y.current;if(B)return B.addEventListener(OC,L),()=>B.removeEventListener(OC,L)},[L]),s.jsx(T7,{scope:n,orientation:r,dir:N,loop:i,currentTabStopId:C,onItemFocus:x.useCallback(B=>v(B),[v]),onItemShiftTab:x.useCallback(()=>U(!0),[]),onFocusableItemAdd:x.useCallback(()=>K(B=>B+1),[]),onFocusableItemRemove:x.useCallback(()=>K(B=>B-1),[]),children:s.jsx(wf.div,{tabIndex:R||G===0?-1:0,"data-orientation":r,..._,ref:g,style:{outline:"none",...t.style},onMouseDown:td(t.onMouseDown,()=>{P.current=!0}),onFocus:td(t.onFocus,B=>{const O=!P.current;if(B.target===B.currentTarget&&O&&!R){const S=new CustomEvent(OC,v7);if(B.currentTarget.dispatchEvent(S),!S.defaultPrevented){const A=w().filter(V=>V.focusable),Y=A.find(V=>V.active),te=A.find(V=>V.id===C),q=[Y,te,...A].filter(Boolean).map(V=>V.ref.current);fj(q,m)}}P.current=!1}),onBlur:td(t.onBlur,()=>U(!1))})})}),uj="RovingFocusGroupItem",hj=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:l,children:c,...d}=t,u=ij(),f=l||u,m=E7(uj,n),_=m.currentTabStopId===f,y=oj(n),{onFocusableItemAdd:g,onFocusableItemRemove:N,currentTabStopId:C}=m;return x.useEffect(()=>{if(r)return g(),()=>N()},[r,g,N]),s.jsx(Vy.ItemSlot,{scope:n,id:f,focusable:r,active:i,children:s.jsx(wf.span,{tabIndex:_?0:-1,"data-orientation":m.orientation,...d,ref:e,onMouseDown:td(t.onMouseDown,v=>{r?m.onItemFocus(f):v.preventDefault()}),onFocus:td(t.onFocus,()=>m.onItemFocus(f)),onKeyDown:td(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){m.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const R=M7(v,m.orientation,m.dir);if(R!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let L=y().filter(w=>w.focusable).map(w=>w.ref.current);if(R==="last")L.reverse();else if(R==="prev"||R==="next"){R==="prev"&&L.reverse();const w=L.indexOf(v.currentTarget);L=m.loop?L7(L,w+1):L.slice(w+1)}setTimeout(()=>fj(L))}}),children:typeof c=="function"?c({isCurrentTabStop:_,hasTabStop:C!=null}):c})})});hj.displayName=uj;var I7={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function O7(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function M7(t,e,n){const r=O7(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return I7[r]}function fj(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function L7(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var w7=dj,P7=hj;function A7(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var mj=t=>{const{present:e,children:n}=t,r=k7(e),i=typeof n=="function"?n({present:r.isPresent}):x.Children.only(n),l=Q_(r.ref,U7(i));return typeof n=="function"||r.isPresent?x.cloneElement(i,{ref:l}):null};mj.displayName="Presence";function k7(t){const[e,n]=x.useState(),r=x.useRef(null),i=x.useRef(t),l=x.useRef("none"),c=t?"mounted":"unmounted",[d,u]=A7(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const f=Gp(r.current);l.current=d==="mounted"?f:"none"},[d]),G_(()=>{const f=r.current,m=i.current;if(m!==t){const y=l.current,g=Gp(f);t?u("MOUNT"):g==="none"||(f==null?void 0:f.display)==="none"?u("UNMOUNT"):u(m&&y!==g?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,u]),G_(()=>{if(e){let f;const m=e.ownerDocument.defaultView??window,_=g=>{const C=Gp(r.current).includes(CSS.escape(g.animationName));if(g.target===e&&C&&(u("ANIMATION_END"),!i.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",f=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},y=g=>{g.target===e&&(l.current=Gp(r.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",_),e.addEventListener("animationend",_),()=>{m.clearTimeout(f),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",_),e.removeEventListener("animationend",_)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:x.useCallback(f=>{r.current=f?getComputedStyle(f):null,n(f)},[])}}function Gp(t){return(t==null?void 0:t.animationName)||"none"}function U7(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Rx="Tabs",[B7]=fN(Rx,[cj]),gj=cj(),[W7,mN]=B7(Rx),pj=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:l,orientation:c="horizontal",dir:d,activationMode:u="automatic",...f}=t,m=lj(d),[_,y]=aj({prop:r,onChange:i,defaultProp:l??"",caller:Rx});return s.jsx(W7,{scope:n,baseId:ij(),value:_,onValueChange:y,orientation:c,dir:m,activationMode:u,children:s.jsx(wf.div,{dir:m,"data-orientation":c,...f,ref:e})})});pj.displayName=Rx;var _j="TabsList",xj=x.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,l=mN(_j,n),c=gj(n);return s.jsx(w7,{asChild:!0,...c,orientation:l.orientation,dir:l.dir,loop:r,children:s.jsx(wf.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:e})})});xj.displayName=_j;var Cj="TabsTrigger",yj=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...l}=t,c=mN(Cj,n),d=gj(n),u=Sj(c.baseId,r),f=vj(c.baseId,r),m=r===c.value;return s.jsx(P7,{asChild:!0,...d,focusable:!i,active:m,children:s.jsx(wf.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":f,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...l,ref:e,onMouseDown:td(t.onMouseDown,_=>{!i&&_.button===0&&_.ctrlKey===!1?c.onValueChange(r):_.preventDefault()}),onKeyDown:td(t.onKeyDown,_=>{[" ","Enter"].includes(_.key)&&c.onValueChange(r)}),onFocus:td(t.onFocus,()=>{const _=c.activationMode!=="manual";!m&&!i&&_&&c.onValueChange(r)})})})});yj.displayName=Cj;var bj="TabsContent",Nj=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:l,...c}=t,d=mN(bj,n),u=Sj(d.baseId,r),f=vj(d.baseId,r),m=r===d.value,_=x.useRef(m);return x.useEffect(()=>{const y=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(y)},[]),s.jsx(mj,{present:i||m,children:({present:y})=>s.jsx(wf.div,{"data-state":m?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":u,hidden:!y,id:f,tabIndex:0,...c,ref:e,style:{...t.style,animationDuration:_.current?"0s":void 0},children:y&&l})})});Nj.displayName=bj;function Sj(t,e){return`${t}-trigger-${e}`}function vj(t,e){return`${t}-content-${e}`}var F7=pj,Dj=xj,Rj=yj,Tj=Nj;function Ej(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Ej(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function K7(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Ej(t))&&(r&&(r+=" "),r+=e);return r}const Q7=(t,e)=>{const n=new Array(t.length+e.length);for(let r=0;r<t.length;r++)n[r]=t[r];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n},G7=(t,e)=>({classGroupId:t,validator:e}),jj=(t=new Map,e=null,n)=>({nextPart:t,validators:e,classGroupId:n}),Y_="-",YD=[],Y7="arbitrary..",V7=t=>{const e=H7(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:c=>{if(c.startsWith("[")&&c.endsWith("]"))return $7(c);const d=c.split(Y_),u=d[0]===""&&d.length>1?1:0;return Ij(d,u,e)},getConflictingClassGroupIds:(c,d)=>{if(d){const u=r[c],f=n[c];return u?f?Q7(f,u):u:f||YD}return n[c]||YD}}},Ij=(t,e,n)=>{if(t.length-e===0)return n.classGroupId;const i=t[e],l=n.nextPart.get(i);if(l){const f=Ij(t,e+1,l);if(f)return f}const c=n.validators;if(c===null)return;const d=e===0?t.join(Y_):t.slice(e).join(Y_),u=c.length;for(let f=0;f<u;f++){const m=c[f];if(m.validator(d))return m.classGroupId}},$7=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=t.slice(1,-1),n=e.indexOf(":"),r=e.slice(0,n);return r?Y7+r:void 0})(),H7=t=>{const{theme:e,classGroups:n}=t;return z7(n,e)},z7=(t,e)=>{const n=jj();for(const r in t){const i=t[r];gN(i,n,r,e)}return n},gN=(t,e,n,r)=>{const i=t.length;for(let l=0;l<i;l++){const c=t[l];q7(c,e,n,r)}},q7=(t,e,n,r)=>{if(typeof t=="string"){X7(t,e,n);return}if(typeof t=="function"){J7(t,e,n,r);return}Z7(t,e,n,r)},X7=(t,e,n)=>{const r=t===""?e:Oj(e,t);r.classGroupId=n},J7=(t,e,n,r)=>{if(eU(t)){gN(t(r),e,n,r);return}e.validators===null&&(e.validators=[]),e.validators.push(G7(n,t))},Z7=(t,e,n,r)=>{const i=Object.entries(t),l=i.length;for(let c=0;c<l;c++){const[d,u]=i[c];gN(u,Oj(e,d),n,r)}},Oj=(t,e)=>{let n=t;const r=e.split(Y_),i=r.length;for(let l=0;l<i;l++){const c=r[l];let d=n.nextPart.get(c);d||(d=jj(),n.nextPart.set(c,d)),n=d}return n},eU=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,tU=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=Object.create(null),r=Object.create(null);const i=(l,c)=>{n[l]=c,e++,e>t&&(e=0,r=n,n=Object.create(null))};return{get(l){let c=n[l];if(c!==void 0)return c;if((c=r[l])!==void 0)return i(l,c),c},set(l,c){l in n?n[l]=c:i(l,c)}}},$y="!",VD=":",sU=[],$D=(t,e,n,r,i)=>({modifiers:t,hasImportantModifier:e,baseClassName:n,maybePostfixModifierPosition:r,isExternal:i}),nU=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=i=>{const l=[];let c=0,d=0,u=0,f;const m=i.length;for(let C=0;C<m;C++){const v=i[C];if(c===0&&d===0){if(v===VD){l.push(i.slice(u,C)),u=C+1;continue}if(v==="/"){f=C;continue}}v==="["?c++:v==="]"?c--:v==="("?d++:v===")"&&d--}const _=l.length===0?i:i.slice(u);let y=_,g=!1;_.endsWith($y)?(y=_.slice(0,-1),g=!0):_.startsWith($y)&&(y=_.slice(1),g=!0);const N=f&&f>u?f-u:void 0;return $D(l,g,y,N)};if(e){const i=e+VD,l=r;r=c=>c.startsWith(i)?l(c.slice(i.length)):$D(sU,!1,c,void 0,!0)}if(n){const i=r;r=l=>n({className:l,parseClassName:i})}return r},rU=t=>{const e=new Map;return t.orderSensitiveModifiers.forEach((n,r)=>{e.set(n,1e6+r)}),n=>{const r=[];let i=[];for(let l=0;l<n.length;l++){const c=n[l],d=c[0]==="[",u=e.has(c);d||u?(i.length>0&&(i.sort(),r.push(...i),i=[]),r.push(c)):i.push(c)}return i.length>0&&(i.sort(),r.push(...i)),r}},iU=t=>({cache:tU(t.cacheSize),parseClassName:nU(t),sortModifiers:rU(t),...V7(t)}),aU=/\s+/,lU=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:l}=e,c=[],d=t.trim().split(aU);let u="";for(let f=d.length-1;f>=0;f-=1){const m=d[f],{isExternal:_,modifiers:y,hasImportantModifier:g,baseClassName:N,maybePostfixModifierPosition:C}=n(m);if(_){u=m+(u.length>0?" "+u:u);continue}let v=!!C,R=r(v?N.substring(0,C):N);if(!R){if(!v){u=m+(u.length>0?" "+u:u);continue}if(R=r(N),!R){u=m+(u.length>0?" "+u:u);continue}v=!1}const U=y.length===0?"":y.length===1?y[0]:l(y).join(":"),L=g?U+$y:U,w=L+R;if(c.indexOf(w)>-1)continue;c.push(w);const P=i(R,v);for(let G=0;G<P.length;++G){const K=P[G];c.push(L+K)}u=m+(u.length>0?" "+u:u)}return u},oU=(...t)=>{let e=0,n,r,i="";for(;e<t.length;)(n=t[e++])&&(r=Mj(n))&&(i&&(i+=" "),i+=r);return i},Mj=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=Mj(t[r]))&&(n&&(n+=" "),n+=e);return n},cU=(t,...e)=>{let n,r,i,l;const c=u=>{const f=e.reduce((m,_)=>_(m),t());return n=iU(f),r=n.cache.get,i=n.cache.set,l=d,d(u)},d=u=>{const f=r(u);if(f)return f;const m=lU(u,n);return i(u,m),m};return l=c,(...u)=>l(oU(...u))},dU=[],Fi=t=>{const e=n=>n[t]||dU;return e.isThemeGetter=!0,e},Lj=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,wj=/^\((?:(\w[\w-]*):)?(.+)\)$/i,uU=/^\d+\/\d+$/,hU=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,fU=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mU=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,gU=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,pU=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,O0=t=>uU.test(t),In=t=>!!t&&!Number.isNaN(Number(t)),Hd=t=>!!t&&Number.isInteger(Number(t)),MC=t=>t.endsWith("%")&&In(t.slice(0,-1)),Wc=t=>hU.test(t),_U=()=>!0,xU=t=>fU.test(t)&&!mU.test(t),Pj=()=>!1,CU=t=>gU.test(t),yU=t=>pU.test(t),bU=t=>!Hs(t)&&!zs(t),NU=t=>Pf(t,Uj,Pj),Hs=t=>Lj.test(t),Vu=t=>Pf(t,Bj,xU),LC=t=>Pf(t,TU,In),HD=t=>Pf(t,Aj,Pj),SU=t=>Pf(t,kj,yU),Yp=t=>Pf(t,Wj,CU),zs=t=>wj.test(t),jm=t=>Af(t,Bj),vU=t=>Af(t,EU),zD=t=>Af(t,Aj),DU=t=>Af(t,Uj),RU=t=>Af(t,kj),Vp=t=>Af(t,Wj,!0),Pf=(t,e,n)=>{const r=Lj.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Af=(t,e,n=!1)=>{const r=wj.exec(t);return r?r[1]?e(r[1]):n:!1},Aj=t=>t==="position"||t==="percentage",kj=t=>t==="image"||t==="url",Uj=t=>t==="length"||t==="size"||t==="bg-size",Bj=t=>t==="length",TU=t=>t==="number",EU=t=>t==="family-name",Wj=t=>t==="shadow",jU=()=>{const t=Fi("color"),e=Fi("font"),n=Fi("text"),r=Fi("font-weight"),i=Fi("tracking"),l=Fi("leading"),c=Fi("breakpoint"),d=Fi("container"),u=Fi("spacing"),f=Fi("radius"),m=Fi("shadow"),_=Fi("inset-shadow"),y=Fi("text-shadow"),g=Fi("drop-shadow"),N=Fi("blur"),C=Fi("perspective"),v=Fi("aspect"),R=Fi("ease"),U=Fi("animate"),L=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...w(),zs,Hs],G=()=>["auto","hidden","clip","visible","scroll"],K=()=>["auto","contain","none"],B=()=>[zs,Hs,u],O=()=>[O0,"full","auto",...B()],S=()=>[Hd,"none","subgrid",zs,Hs],A=()=>["auto",{span:["full",Hd,zs,Hs]},Hd,zs,Hs],Y=()=>[Hd,"auto",zs,Hs],te=()=>["auto","min","max","fr",zs,Hs],J=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],q=()=>["start","end","center","stretch","center-safe","end-safe"],V=()=>["auto",...B()],F=()=>[O0,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...B()],I=()=>[t,zs,Hs],ee=()=>[...w(),zD,HD,{position:[zs,Hs]}],ae=()=>["no-repeat",{repeat:["","x","y","space","round"]}],T=()=>["auto","cover","contain",DU,NU,{size:[zs,Hs]}],j=()=>[MC,jm,Vu],k=()=>["","none","full",f,zs,Hs],Q=()=>["",In,jm,Vu],H=()=>["solid","dashed","dotted","double"],$=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ie=()=>[In,MC,zD,HD],fe=()=>["","none",N,zs,Hs],pe=()=>["none",In,zs,Hs],de=()=>["none",In,zs,Hs],Re=()=>[In,zs,Hs],X=()=>[O0,"full",...B()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Wc],breakpoint:[Wc],color:[_U],container:[Wc],"drop-shadow":[Wc],ease:["in","out","in-out"],font:[bU],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Wc],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Wc],shadow:[Wc],spacing:["px",In],text:[Wc],"text-shadow":[Wc],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",O0,Hs,zs,v]}],container:["container"],columns:[{columns:[In,Hs,zs,d]}],"break-after":[{"break-after":L()}],"break-before":[{"break-before":L()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:G()}],"overflow-x":[{"overflow-x":G()}],"overflow-y":[{"overflow-y":G()}],overscroll:[{overscroll:K()}],"overscroll-x":[{"overscroll-x":K()}],"overscroll-y":[{"overscroll-y":K()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:O()}],"inset-x":[{"inset-x":O()}],"inset-y":[{"inset-y":O()}],start:[{start:O()}],end:[{end:O()}],top:[{top:O()}],right:[{right:O()}],bottom:[{bottom:O()}],left:[{left:O()}],visibility:["visible","invisible","collapse"],z:[{z:[Hd,"auto",zs,Hs]}],basis:[{basis:[O0,"full","auto",d,...B()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[In,O0,"auto","initial","none",Hs]}],grow:[{grow:["",In,zs,Hs]}],shrink:[{shrink:["",In,zs,Hs]}],order:[{order:[Hd,"first","last","none",zs,Hs]}],"grid-cols":[{"grid-cols":S()}],"col-start-end":[{col:A()}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":S()}],"row-start-end":[{row:A()}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":te()}],"auto-rows":[{"auto-rows":te()}],gap:[{gap:B()}],"gap-x":[{"gap-x":B()}],"gap-y":[{"gap-y":B()}],"justify-content":[{justify:[...J(),"normal"]}],"justify-items":[{"justify-items":[...q(),"normal"]}],"justify-self":[{"justify-self":["auto",...q()]}],"align-content":[{content:["normal",...J()]}],"align-items":[{items:[...q(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...q(),{baseline:["","last"]}]}],"place-content":[{"place-content":J()}],"place-items":[{"place-items":[...q(),"baseline"]}],"place-self":[{"place-self":["auto",...q()]}],p:[{p:B()}],px:[{px:B()}],py:[{py:B()}],ps:[{ps:B()}],pe:[{pe:B()}],pt:[{pt:B()}],pr:[{pr:B()}],pb:[{pb:B()}],pl:[{pl:B()}],m:[{m:V()}],mx:[{mx:V()}],my:[{my:V()}],ms:[{ms:V()}],me:[{me:V()}],mt:[{mt:V()}],mr:[{mr:V()}],mb:[{mb:V()}],ml:[{ml:V()}],"space-x":[{"space-x":B()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":B()}],"space-y-reverse":["space-y-reverse"],size:[{size:F()}],w:[{w:[d,"screen",...F()]}],"min-w":[{"min-w":[d,"screen","none",...F()]}],"max-w":[{"max-w":[d,"screen","none","prose",{screen:[c]},...F()]}],h:[{h:["screen","lh",...F()]}],"min-h":[{"min-h":["screen","lh","none",...F()]}],"max-h":[{"max-h":["screen","lh",...F()]}],"font-size":[{text:["base",n,jm,Vu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,zs,LC]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",MC,Hs]}],"font-family":[{font:[vU,Hs,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,zs,Hs]}],"line-clamp":[{"line-clamp":[In,"none",zs,LC]}],leading:[{leading:[l,...B()]}],"list-image":[{"list-image":["none",zs,Hs]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",zs,Hs]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:I()}],"text-color":[{text:I()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:[In,"from-font","auto",zs,Vu]}],"text-decoration-color":[{decoration:I()}],"underline-offset":[{"underline-offset":[In,"auto",zs,Hs]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",zs,Hs]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",zs,Hs]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ee()}],"bg-repeat":[{bg:ae()}],"bg-size":[{bg:T()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Hd,zs,Hs],radial:["",zs,Hs],conic:[Hd,zs,Hs]},RU,SU]}],"bg-color":[{bg:I()}],"gradient-from-pos":[{from:j()}],"gradient-via-pos":[{via:j()}],"gradient-to-pos":[{to:j()}],"gradient-from":[{from:I()}],"gradient-via":[{via:I()}],"gradient-to":[{to:I()}],rounded:[{rounded:k()}],"rounded-s":[{"rounded-s":k()}],"rounded-e":[{"rounded-e":k()}],"rounded-t":[{"rounded-t":k()}],"rounded-r":[{"rounded-r":k()}],"rounded-b":[{"rounded-b":k()}],"rounded-l":[{"rounded-l":k()}],"rounded-ss":[{"rounded-ss":k()}],"rounded-se":[{"rounded-se":k()}],"rounded-ee":[{"rounded-ee":k()}],"rounded-es":[{"rounded-es":k()}],"rounded-tl":[{"rounded-tl":k()}],"rounded-tr":[{"rounded-tr":k()}],"rounded-br":[{"rounded-br":k()}],"rounded-bl":[{"rounded-bl":k()}],"border-w":[{border:Q()}],"border-w-x":[{"border-x":Q()}],"border-w-y":[{"border-y":Q()}],"border-w-s":[{"border-s":Q()}],"border-w-e":[{"border-e":Q()}],"border-w-t":[{"border-t":Q()}],"border-w-r":[{"border-r":Q()}],"border-w-b":[{"border-b":Q()}],"border-w-l":[{"border-l":Q()}],"divide-x":[{"divide-x":Q()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Q()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...H(),"hidden","none"]}],"divide-style":[{divide:[...H(),"hidden","none"]}],"border-color":[{border:I()}],"border-color-x":[{"border-x":I()}],"border-color-y":[{"border-y":I()}],"border-color-s":[{"border-s":I()}],"border-color-e":[{"border-e":I()}],"border-color-t":[{"border-t":I()}],"border-color-r":[{"border-r":I()}],"border-color-b":[{"border-b":I()}],"border-color-l":[{"border-l":I()}],"divide-color":[{divide:I()}],"outline-style":[{outline:[...H(),"none","hidden"]}],"outline-offset":[{"outline-offset":[In,zs,Hs]}],"outline-w":[{outline:["",In,jm,Vu]}],"outline-color":[{outline:I()}],shadow:[{shadow:["","none",m,Vp,Yp]}],"shadow-color":[{shadow:I()}],"inset-shadow":[{"inset-shadow":["none",_,Vp,Yp]}],"inset-shadow-color":[{"inset-shadow":I()}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:I()}],"ring-offset-w":[{"ring-offset":[In,Vu]}],"ring-offset-color":[{"ring-offset":I()}],"inset-ring-w":[{"inset-ring":Q()}],"inset-ring-color":[{"inset-ring":I()}],"text-shadow":[{"text-shadow":["none",y,Vp,Yp]}],"text-shadow-color":[{"text-shadow":I()}],opacity:[{opacity:[In,zs,Hs]}],"mix-blend":[{"mix-blend":[...$(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":$()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[In]}],"mask-image-linear-from-pos":[{"mask-linear-from":ie()}],"mask-image-linear-to-pos":[{"mask-linear-to":ie()}],"mask-image-linear-from-color":[{"mask-linear-from":I()}],"mask-image-linear-to-color":[{"mask-linear-to":I()}],"mask-image-t-from-pos":[{"mask-t-from":ie()}],"mask-image-t-to-pos":[{"mask-t-to":ie()}],"mask-image-t-from-color":[{"mask-t-from":I()}],"mask-image-t-to-color":[{"mask-t-to":I()}],"mask-image-r-from-pos":[{"mask-r-from":ie()}],"mask-image-r-to-pos":[{"mask-r-to":ie()}],"mask-image-r-from-color":[{"mask-r-from":I()}],"mask-image-r-to-color":[{"mask-r-to":I()}],"mask-image-b-from-pos":[{"mask-b-from":ie()}],"mask-image-b-to-pos":[{"mask-b-to":ie()}],"mask-image-b-from-color":[{"mask-b-from":I()}],"mask-image-b-to-color":[{"mask-b-to":I()}],"mask-image-l-from-pos":[{"mask-l-from":ie()}],"mask-image-l-to-pos":[{"mask-l-to":ie()}],"mask-image-l-from-color":[{"mask-l-from":I()}],"mask-image-l-to-color":[{"mask-l-to":I()}],"mask-image-x-from-pos":[{"mask-x-from":ie()}],"mask-image-x-to-pos":[{"mask-x-to":ie()}],"mask-image-x-from-color":[{"mask-x-from":I()}],"mask-image-x-to-color":[{"mask-x-to":I()}],"mask-image-y-from-pos":[{"mask-y-from":ie()}],"mask-image-y-to-pos":[{"mask-y-to":ie()}],"mask-image-y-from-color":[{"mask-y-from":I()}],"mask-image-y-to-color":[{"mask-y-to":I()}],"mask-image-radial":[{"mask-radial":[zs,Hs]}],"mask-image-radial-from-pos":[{"mask-radial-from":ie()}],"mask-image-radial-to-pos":[{"mask-radial-to":ie()}],"mask-image-radial-from-color":[{"mask-radial-from":I()}],"mask-image-radial-to-color":[{"mask-radial-to":I()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[In]}],"mask-image-conic-from-pos":[{"mask-conic-from":ie()}],"mask-image-conic-to-pos":[{"mask-conic-to":ie()}],"mask-image-conic-from-color":[{"mask-conic-from":I()}],"mask-image-conic-to-color":[{"mask-conic-to":I()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ee()}],"mask-repeat":[{mask:ae()}],"mask-size":[{mask:T()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",zs,Hs]}],filter:[{filter:["","none",zs,Hs]}],blur:[{blur:fe()}],brightness:[{brightness:[In,zs,Hs]}],contrast:[{contrast:[In,zs,Hs]}],"drop-shadow":[{"drop-shadow":["","none",g,Vp,Yp]}],"drop-shadow-color":[{"drop-shadow":I()}],grayscale:[{grayscale:["",In,zs,Hs]}],"hue-rotate":[{"hue-rotate":[In,zs,Hs]}],invert:[{invert:["",In,zs,Hs]}],saturate:[{saturate:[In,zs,Hs]}],sepia:[{sepia:["",In,zs,Hs]}],"backdrop-filter":[{"backdrop-filter":["","none",zs,Hs]}],"backdrop-blur":[{"backdrop-blur":fe()}],"backdrop-brightness":[{"backdrop-brightness":[In,zs,Hs]}],"backdrop-contrast":[{"backdrop-contrast":[In,zs,Hs]}],"backdrop-grayscale":[{"backdrop-grayscale":["",In,zs,Hs]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[In,zs,Hs]}],"backdrop-invert":[{"backdrop-invert":["",In,zs,Hs]}],"backdrop-opacity":[{"backdrop-opacity":[In,zs,Hs]}],"backdrop-saturate":[{"backdrop-saturate":[In,zs,Hs]}],"backdrop-sepia":[{"backdrop-sepia":["",In,zs,Hs]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":B()}],"border-spacing-x":[{"border-spacing-x":B()}],"border-spacing-y":[{"border-spacing-y":B()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",zs,Hs]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[In,"initial",zs,Hs]}],ease:[{ease:["linear","initial",R,zs,Hs]}],delay:[{delay:[In,zs,Hs]}],animate:[{animate:["none",U,zs,Hs]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[C,zs,Hs]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:pe()}],"rotate-x":[{"rotate-x":pe()}],"rotate-y":[{"rotate-y":pe()}],"rotate-z":[{"rotate-z":pe()}],scale:[{scale:de()}],"scale-x":[{"scale-x":de()}],"scale-y":[{"scale-y":de()}],"scale-z":[{"scale-z":de()}],"scale-3d":["scale-3d"],skew:[{skew:Re()}],"skew-x":[{"skew-x":Re()}],"skew-y":[{"skew-y":Re()}],transform:[{transform:[zs,Hs,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:X()}],"translate-x":[{"translate-x":X()}],"translate-y":[{"translate-y":X()}],"translate-z":[{"translate-z":X()}],"translate-none":["translate-none"],accent:[{accent:I()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:I()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",zs,Hs]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",zs,Hs]}],fill:[{fill:["none",...I()]}],"stroke-w":[{stroke:[In,jm,Vu,LC]}],stroke:[{stroke:["none",...I()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},IU=cU(jU);function pN(...t){return IU(K7(t))}const Fj=F7,_N=x.forwardRef(({className:t,...e},n)=>s.jsx(Dj,{ref:n,className:pN("inline-flex h-10 items-center justify-start rounded-md bg-muted p-1 text-muted-foreground overflow-x-auto scrollbar-hide",t),...e}));_N.displayName=Dj.displayName;const xN=x.forwardRef(({className:t,...e},n)=>s.jsx(Rj,{ref:n,className:pN("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));xN.displayName=Rj.displayName;const Ql=x.forwardRef(({className:t,...e},n)=>s.jsx(Tj,{ref:n,className:pN("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Ql.displayName=Tj.displayName;const Kj=t=>QM({queryKey:["workOrders",t.startDate,t.endDate],queryFn:()=>m4(t),enabled:!!t.startDate&&!!t.endDate,staleTime:120*1e3,gcTime:300*1e3}),OU=({onNavigateToMenu:t,onNavigateToView:e,onNavigateToComingSoon:n,userInfo:r,showToast:i})=>{const{setSelectedWorkItem:l,setSelectedWorkDirection:c}=Yl(),[d,u]=x.useState(null),[f,m]=x.useState(null),[_,y]=x.useState(null),[g,N]=x.useState(!1),[C,v]=x.useState(null),[R,U]=x.useState(!1),[L,w]=x.useState(null),[P,G]=x.useState(!1),[K,B]=x.useState(null),[O,S]=x.useState({}),[A,Y]=x.useState(!1),{activeTab:te,setActiveTab:J,workFilters:q,setWorkFilters:V}=Yl(),[F,I]=x.useState(!1),[ee,ae]=x.useState(!0),T=x.useRef(null),j=x.useRef([]),k=x.useRef(null),Q=x.useRef(0),[H,$]=x.useState(!1),[ie,fe]=x.useState(()=>{const ge=localStorage.getItem("safety_warning_dismissed");if(ge){const Be=new Date(ge).toDateString(),ce=new Date().toDateString();return Be===ce}return!1}),{showMapView:pe,setShowMapView:de}=Yl(),Re=[{id:"safety-check",title:""},{id:"work-receipt",title:""},{id:"work-result-signal",title:""},{id:"signal-interlock",title:""}],X="YYYY-MM-DD",{startDate:_e,endDate:me,filter:Z,workTypeFilter:le=""}=q;x.useEffect(()=>{const ge=setTimeout(()=>{if(te==="work-receipt"){const Be=Yl.getState().workFilters;Yl.getState().setWorkFilters({...Be,filter:""})}},100);return()=>clearTimeout(ge)},[te]);const{data:se=[],isLoading:Ee,error:Ne,refetch:ye}=Kj({startDate:_e,endDate:me}),ne=(Ne==null?void 0:Ne.message)||null,ue=ge=>{V({...q,...ge})},xe=ge=>{const Be=Yc(ge);ue({startDate:Be.startOf("month").format(X),endDate:Be.endOf("month").format(X)})},et=ge=>{const Be=Yc(ge);ue({startDate:Be.startOf("month").format(X),endDate:Be.endOf("month").format(X)})},bt=()=>{const ge=Yc(_e).subtract(1,"month");ue({startDate:ge.startOf("month").format(X),endDate:ge.endOf("month").format(X)})},it=()=>{const ge=Yc(_e).add(1,"month");ue({startDate:ge.startOf("month").format(X),endDate:ge.endOf("month").format(X)})};x.useEffect(()=>{if(!$n()&&se.length>0){Y(!0);const ge={};se.forEach(Be=>{const ce=c4(Be.PROD_GRPS,Be.WRK_STATS);ce&&ce.total>0?ge[Be.id]=ce:ge[Be.id]={total:1,pending:1,completed:0,cancelled:0,pendingByProdGrp:{},completedByProdGrp:{}}}),S(ge),Y(!1)}else se.length===0&&Y(!1)},[se]),x.useEffect(()=>{if(te==="work-receipt"){const ge=Yc(_e),Be=Yc(me),ce=ge.date()===1,Le=Be.date()===Be.endOf("month").date();if(!ce||!Le){const Xe=Yc();ue({startDate:Xe.startOf("month").format(X),endDate:Xe.endOf("month").format(X)})}}},[te]),x.useEffect(()=>{te==="work-receipt"&&(async()=>{if(r!=null&&r.userId)try{const Be=await d5(r.userId),ce=Be&&Be.length>0;$(!ce)}catch(Be){console.error("  :",Be),$(!1)}})()},[r,te]),x.useEffect(()=>{const ge=k.current;if(!ge)return;let Be=!1,ce=null;const Le=Ct=>{ce&&clearTimeout(ce),ce=setTimeout(()=>{ae(Me=>Me===Ct?Me:Ct)},50)},Xe=()=>{const Ct=ge.scrollTop,Me=Ct-Q.current,lt=ge.scrollHeight-ge.clientHeight;if(lt<=30){Le(!0),Q.current=Ct,Be=!1;return}const ut=Ct>=lt-10,jt=Ct<=10;if(ut||jt){Q.current=Ct,Be=!1;return}if(Math.abs(Me)<15){Be=!1;return}Me>0&&Ct>80?Le(!1):Me<-5&&Le(!0),Q.current=Ct,Be=!1},Pe=()=>{Be||(requestAnimationFrame(Xe),Be=!0)};return ge.addEventListener("scroll",Pe,{passive:!0}),()=>{ge.removeEventListener("scroll",Pe),ce&&clearTimeout(ce)}},[]);const At=async(ge,Be)=>{await ye(),d&&d.id===ge&&u(null)},at=ge=>{c(ge),e?e("work-item-list"):m(ge)},We=ge=>{var Le,Xe,Pe;const Be=Ct=>Ct?Ct.includes("T")||Ct.includes("-")?Ct.replace(/[-:T]/g,"").substring(0,12):Ct:"",ce={SO_ID:ge.SO_ID||"",CUST_ID:ge.CUST_ID||((Le=ge.customer)==null?void 0:Le.id)||"",CUST_NM:((Xe=ge.customer)==null?void 0:Xe.name)||"",SMS_RCV_TEL:((Pe=ge.customer)==null?void 0:Pe.phone)||ge.REQ_CUST_TEL_NO||"",SMS_SEND_TEL:"",WRK_HOPE_DTTM:Be(ge.scheduledAt),WRKR_NM:(r==null?void 0:r.userName)||"",WRKR_NM_EN:(r==null?void 0:r.userNameEn)||(r==null?void 0:r.userName)||"",WRK_CD:ge.WRK_CD||"",WRK_CD_NM:ge.typeDisplay||"",WRK_DRCTN_ID:ge.WRK_DRCTN_ID||ge.id||"",RCPT_ID:ge.RCPT_ID||""};w(ce),U(!0)},Dt=ge=>{B(ge),G(!0)},Tt=()=>{ye()},St=async ge=>{if(C){setIsLoading(!0),N(!1);try{const Be=await yb(ge);Be.code==="SUCCESS"||Be.code==="OK"?(i&&i("  .","success"),await At(C.id,hn.Cancelled)):i&&i(` : ${Be.message}`,"error",!0)}catch(Be){console.error(" :",Be);const ce=Be instanceof Fs?Be.message:Be.message||"   .";i&&i(ce,"error",!0)}finally{setIsLoading(!1),v(null)}}},ze=ge=>{l(ge),e?e("work-complete-form"):y(ge)},dt=async()=>{y(null),u(null),await ye(),i&&i("  .","success")};if(!e){if(_)return s.jsx(j_,{order:_,onBack:()=>y(null),onSuccess:dt,showToast:i});if(f)return s.jsx(L5,{direction:f,onBack:()=>m(null)});if(d)return s.jsx(N5,{order:d,onBack:()=>u(null),onUpdateStatus:At,onComplete:ze},d.id)}const Ke=se.filter(ge=>{if(Z!==""){const Be=O[ge.id],ce=(Be==null?void 0:Be.isEmpty)===!0;if(Z===hn.Cancelled){if(ge.status!==hn.Cancelled&&!ce)return!1}else if(ce||ge.status!==Z)return!1}return!(le&&le!==""&&ge.WRK_CD_NM!==le)}),rt=()=>{let ge=0;return Z!==""&&ge++,le!==""&&ge++,ge},ft=()=>{ue({filter:"",workTypeFilter:""})},Ot=Ke,mt=ge=>ge===""?se.length:se.filter(Be=>{const ce=O[Be.id],Le=(ce==null?void 0:ce.isEmpty)===!0;return ge===hn.Cancelled?Be.status===hn.Cancelled||Le:Le?!1:Be.status===ge}).length,Ze=ge=>{J(ge);const Be=()=>{const Le=T.current;if(!Le)return;const Xe=Re.findIndex(lt=>lt.id===ge),Pe=j.current[Xe];if(!Pe)return;const Ct=Le.getBoundingClientRect().width,Me=Pe.offsetLeft-Ct/2+Pe.offsetWidth/2;Le.scrollTo({left:Me,behavior:"smooth"})};if(typeof window<"u"&&("requestAnimationFrame"in window?requestAnimationFrame(Be):setTimeout(Be,50)),!["work-receipt","safety-check","signal-interlock","work-result-signal","lgu-construction","lgu-network-fault"].includes(ge)){const Le=Re.find(Xe=>Xe.id===ge);Le&&n&&n(Le.title)}},De={:1,:2,"A/S":3,:4,:5,:6,:7,:8,:9},Ye=x.useMemo(()=>{const ge=new Set;se.forEach(ce=>{ce.WRK_CD_NM&&ge.add(ce.WRK_CD_NM)});const Be=Array.from(ge).sort((ce,Le)=>{const Xe=De[ce]??99,Pe=De[Le]??99;return Xe-Pe});return[{value:"",label:""},...Be.map(ce=>({value:ce,label:ce}))]},[se]);x.useEffect(()=>{const ge=Ye.map(Be=>Be.value);le&&!ge.includes(le)&&ue({workTypeFilter:""})},[Ye,le]);const Ce=x.useMemo(()=>[{value:"",label:` (${mt("")})`,shortLabel:""},{value:hn.Pending,label:` (${mt(hn.Pending)})`,shortLabel:""},{value:hn.Completed,label:` (${mt(hn.Completed)})`,shortLabel:""},{value:hn.Cancelled,label:` (${mt(hn.Cancelled)})`,shortLabel:""}],[se]);return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col overflow-hidden",children:[s.jsxs(Fj,{value:te,onValueChange:Ze,className:"w-full flex flex-col h-full overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200",children:s.jsx(_N,{ref:T,className:"w-full justify-start bg-white rounded-none h-auto py-2 px-3 overflow-x-auto border-none",children:Re.map((ge,Be)=>s.jsx(xN,{value:ge.id,ref:ce=>j.current[Be]=ce,className:"data-[state=active]:bg-blue-500 data-[state=active]:text-white data-[state=inactive]:text-gray-600 rounded-full px-4 py-2 text-sm font-medium flex-shrink-0 mx-1 transition-colors",children:ge.title},ge.id))})}),s.jsxs(Ql,{value:"work-receipt",className:"flex-1 data-[state=active]:flex flex-col overflow-hidden",children:[s.jsx("div",{className:`flex-shrink-0 bg-gray-50 grid transition-[grid-template-rows] duration-300 ease-out ${ee?"grid-rows-[1fr]":"grid-rows-[0fr]"}`,style:{willChange:"grid-template-rows"},children:s.jsxs("div",{className:`min-h-0 overflow-hidden px-3 pt-1 transition-opacity duration-200 ${ee?"opacity-100":"opacity-0"}`,children:[H&&!ie&&s.jsx("div",{className:"mb-3 bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ql,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsx("div",{children:s.jsx("h3",{className:"text-sm font-semibold text-yellow-800",children:"   ."})})]}),s.jsx("button",{onClick:()=>{fe(!0),localStorage.setItem("safety_warning_dismissed",new Date().toISOString())},className:"text-yellow-600 hover:text-yellow-800 transition-colors",title:"",children:s.jsx(bi,{className:"w-4 h-4"})})]})}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 mb-3 overflow-hidden",children:[s.jsx("div",{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{onClick:bt,className:"p-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors",children:s.jsx(t5,{className:"w-5 h-5 text-gray-500"})}),s.jsxs("div",{className:"flex-1 flex items-center justify-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:_e,onChange:ge=>xe(ge.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",style:{colorScheme:"light"}}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:new Date(_e).toLocaleDateString("ko-KR",{month:"short",day:"numeric"})})]}),s.jsx("span",{className:"text-gray-300",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:me,onChange:ge=>et(ge.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",style:{colorScheme:"light"}}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:new Date(me).toLocaleDateString("ko-KR",{month:"short",day:"numeric"})})]})]}),s.jsx("button",{onClick:it,className:"p-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors",children:s.jsx(xL,{className:"w-5 h-5 text-gray-500"})})]})}),s.jsxs("button",{onClick:()=>I(!F),className:"w-full px-4 py-2.5 flex items-center justify-between border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"text-sm text-gray-600",children:""}),rt()>0&&s.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500 text-white text-xs font-medium rounded-full",children:rt()})]}),s.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${F?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&s.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:""}),s.jsx(Zs,{value:Z,onValueChange:ge=>ue({filter:ge}),options:Ce})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:""}),s.jsx(Zs,{value:le,onValueChange:ge=>ue({workTypeFilter:ge}),options:Ye})]}),s.jsx("button",{onClick:ft,className:`p-2 rounded-lg transition-colors flex-shrink-0 ${rt()>0?"text-blue-600 bg-blue-50 hover:bg-blue-100":"text-gray-400 bg-gray-100"}`,title:" ",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),s.jsxs("div",{ref:k,className:"flex-1 overflow-y-auto px-3 pb-4",children:[Ee||A?s.jsx(z0,{size:"medium",message:Ee?"   ...":"   ..."}):ne?s.jsx(Ib,{type:"error",message:ne,onRetry:()=>ye()}):s.jsx("div",{children:Ke.length>0?s.jsx("div",{className:"space-y-3",children:Ot.map((ge,Be)=>s.jsx(qw,{direction:ge,index:Be+1,onSelect:at,onSms:We,onWorkerAdjust:Dt,workStatusCounts:O[ge.id]},ge.id))}):s.jsxs("div",{className:"text-center py-10 sm:py-12 px-4 sm:px-6 bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Z_,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2 whitespace-nowrap",children:"   "})]})}),C&&s.jsx(Sb,{isOpen:g,onClose:()=>{N(!1),v(null)},onConfirm:St,workOrder:C,userId:r==null?void 0:r.userId,showToast:i}),s.jsx(w5,{isOpen:R,onClose:()=>U(!1),smsData:L,userId:(r==null?void 0:r.userId)||""}),K&&s.jsx(P5,{isOpen:P,onClose:()=>{G(!1),B(null)},direction:K,onSuccess:Tt,showToast:i,userInfo:r})]})]}),s.jsx(Ql,{value:"safety-check",className:"px-3 pt-1 overflow-y-auto",children:s.jsx(tP,{onBack:t,userInfo:r,showToast:i})}),s.jsx(Ql,{value:"work-result-signal",className:"px-3 pt-1 overflow-y-auto",children:s.jsx(sP,{onBack:t})}),s.jsx(Ql,{value:"signal-interlock",className:"mt-0 flex-1 data-[state=active]:flex flex-col overflow-hidden",children:s.jsx(A5,{onBack:t,userInfo:r,showToast:i})})]}),te==="work-receipt"&&!Ee&&!ne&&Ke.length>0&&s.jsx(k5,{onClick:()=>de(!0),workCount:Ke.length}),pe&&s.jsx(nj,{workOrders:Ke,onBack:()=>de(!1),onSelectWork:ge=>{de(!1),at(ge)}})]})},MU=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.286zm0 13.036h.008v.008h-.008v-.008z"})}),LU=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 00-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H4.5a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})}),wU=t=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),PU=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})}),AU=({onLogin:t})=>{const[e,n]=x.useState("A20117965"),[r,i]=x.useState("dlive12!@#$"),[l,c]=x.useState(!1),[d,u]=x.useState(!1),[f,m]=x.useState(null),[_,y]=x.useState(!1),g=async(v,R=!1)=>{if(v.preventDefault(),!(!e||!r)){u(!0),m(null),y(!1);try{const U=await Dv(e,r,R?"Y":"N");if(console.log("[Login] API :",U),console.log("[Login] telNo2:",U.telNo2),U.LOGIN_DUP_YN==="Y"||U.code==="LOGIN_DUP"){y(!0),u(!1);return}U.ok?(localStorage.removeItem("demoMode"),t(U.userId,U.userName,U.userNameEn,U.userRole,U.crrId,U.soId,U.mstSoId,U.telNo2,U.AUTH_SO_List)):m(" .")}catch(U){U.message&&U.message.includes("401")?m("   ."):U.message&&U.message.includes("400")?m("   ."):m("   ."),console.error(" :",U)}finally{u(!1)}}},N=async()=>{u(!0),y(!1);try{const v=await Dv(e,r,"Y");console.log("[Login]   :",v),v.ok?(localStorage.removeItem("demoMode"),t(v.userId,v.userName,v.userNameEn,v.userRole,v.crrId,v.soId,v.mstSoId,v.telNo2,v.AUTH_SO_List)):m(" .")}catch(v){m("   ."),console.error("  :",v)}finally{u(!1)}},C="w-full py-3 bg-white border border-gray-200 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition";return s.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 font-sans bg-gray-100",children:[s.jsxs("div",{className:"w-full max-w-sm mx-auto bg-white rounded-2xl shadow-xl p-8 space-y-8",children:[s.jsx("div",{className:"text-center space-y-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h1",{className:"text-4xl font-bold tracking-wider text-blue-600",children:"D'LIVE"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"CONA"})]})}),s.jsxs("form",{onSubmit:g,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"username",className:"sr-only",children:" ID"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:s.jsx(MU,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:`${C} pl-10 pr-3`,placeholder:" ID",value:e,onChange:v=>n(v.target.value)})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:s.jsx(LU,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{id:"password",name:"password",type:l?"text":"password",required:!0,className:`${C} pl-10 pr-10`,placeholder:"",value:r,onChange:v=>i(v.target.value)}),s.jsx("div",{className:"absolute inset-y-0 right-0 pr-3.5 flex items-center",children:s.jsx("button",{type:"button",onClick:()=>c(!l),className:"text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":l?" ":" ",children:l?s.jsx(PU,{className:"h-5 w-5"}):s.jsx(wU,{className:"h-5 w-5"})})})]})]}),f&&s.jsx("div",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg",children:f}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-3 px-4 border border-transparent text-base font-bold rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:d?" ...":""}),s.jsxs("button",{type:"button",onClick:()=>{localStorage.setItem("demoMode","true"),t("demo","demo","demo")},className:"w-full flex items-center justify-center gap-2 py-2 px-4 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[s.jsx(Ew,{className:"w-4 h-4"}),"UI  "]})]})]}),s.jsxs("div",{className:"mt-8 text-center",children:[s.jsx("div",{className:"mb-3",children:s.jsx("p",{className:"text-sm font-medium tracking-wide text-blue-600",children:"Smart Life Coordinator"})}),s.jsx("p",{className:"text-xs font-semibold text-blue-600",children:"COPYRIGHT 2025. D'LIVE CO. LTD"})]})]}),_&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"   "}),s.jsxs("p",{className:"text-sm text-gray-600",children:["     .",s.jsx("br",{}),"     ."]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>y(!1),className:"flex-1 py-2.5 px-4 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition",children:""}),s.jsx("button",{onClick:N,disabled:d,className:"flex-1 py-2.5 px-4 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:d?" ...":" "})]})]})})]})},kU=[{id:"work-management",title:" ",description:"   ",icon:s.jsx(pu,{className:"h-10 w-10 text-white"})},{id:"customer-management",title:" ",description:"    ",icon:s.jsx(a5,{className:"h-10 w-10 text-white"})},{id:"equipment-management",title:" ",description:" , ,  ",icon:s.jsx(yf,{className:"h-10 w-10 text-white"})},{id:"other-management",title:" ",description:"     ",icon:s.jsx(_b,{className:"h-10 w-10 text-white"})}],qD=({onSelectMenu:t})=>{const e=n=>{switch(n){case"work-management":t("work-management");break;case"customer-management":t("customer-management");break;case"equipment-management":t("equipment-management");break;case"other-management":t("other-management");break;default:t("coming-soon")}};return s.jsx("div",{className:"px-4 pt-8",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:kU.map((n,r)=>s.jsxs("button",{onClick:()=>e(n.id),className:"group text-left p-6 bg-white rounded-xl shadow-lg hover:shadow-cyan-500/30 transition-all duration-300 transform hover:-translate-y-1 flex items-center space-x-6",style:{animationDelay:`${r*100}ms`},children:[s.jsx("div",{className:"bg-gradient-to-br from-cyan-400 to-cyan-500 rounded-lg p-4 group-hover:scale-110 transition-transform",children:n.icon}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-cyan-500 transition-colors",children:n.title}),s.jsx("p",{className:"text-gray-500 mt-1",children:n.description})]})]},n.id))})})},CN=({tabs:t,activeTab:e,onTabChange:n,className:r=""})=>{const i=x.useRef(null),l=x.useRef([]);return s.jsx("div",{className:`
        bg-white border-b border-gray-200
        ${r}
      `,children:s.jsx("div",{ref:i,className:"w-full justify-start bg-white rounded-none h-auto py-2 px-3 overflow-x-auto border-none",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:s.jsx("div",{className:"flex",children:t.map((c,d)=>s.jsx("button",{ref:u=>l.current[d]=u,onClick:()=>n(c.id),className:`
                rounded-full px-4 py-2 text-sm font-medium flex-shrink-0 mx-1 transition-colors
                ${e===c.id?"bg-blue-500 text-white":"text-gray-600"}
              `,children:c.title},c.id))})})})},Fm=({onNavigateToMenu:t,title:e="  .",description:n="    .  !",category:r})=>{const[i,l]=x.useState(""),d=(()=>{switch(r){case"customer-management":return[{id:"customer-info",title:"",description:"    "},{id:"business-bot",title:"",description:"   "}];case"equipment-management":return[{id:"equipment-assignment",title:"/",description:"    "},{id:"equipment-status",title:"",description:"  "},{id:"equipment-movement",title:" ",description:"    "},{id:"equipment-recovery",title:"  ",description:"   "}];case"other-management":return[{id:"overtime-application",title:"",description:"  "},{id:"overtime-input",title:"",description:"   "},{id:"announcements",title:"",description:" "}];default:return[]}})(),u=d.length>0;Gi.useEffect(()=>{u&&!i&&l(d[0].id)},[u,i,d]);const f=m=>{l(m)};return s.jsxs("div",{className:"",children:[u&&s.jsx(CN,{tabs:d,activeTab:i,onTabChange:f}),s.jsxs("div",{className:"text-center p-10 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e}),s.jsx("p",{className:"text-gray-600 mb-8",children:n}),s.jsx("button",{onClick:t,className:"px-6 py-2 bg-cyan-500 text-white font-bold rounded-md hover:bg-cyan-600 transition-colors",children:"  "})]})]})},UU=({currentView:t,onNavigate:e,onSelectMenu:n})=>{const r=l=>{n(l),e==null||e(l)},i=[{id:"work-management",label:"",icon:Z_},{id:"customer-management",label:"",icon:Pw},{id:"equipment-management",label:"",icon:lL},{id:"other-management",label:"",icon:n5}];return s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-200 z-50",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex h-[52px]",children:i.map(l=>{const c=t===l.id,d=l.icon;return s.jsxs("button",{onClick:()=>r(l.id),className:"flex-1 flex flex-col items-center justify-center gap-0.5 px-2 py-1 transition-all duration-200 active:scale-95 touch-manipulation",children:[s.jsx(d,{className:`
                    transition-all duration-200
                    ${c?"h-5 w-5 text-blue-600":"h-5 w-5 text-gray-500"}
                  `,strokeWidth:c?2.5:2}),s.jsx("span",{className:`
                    text-[10px] transition-all duration-200
                    ${c?"text-blue-600 font-bold":"text-gray-500 font-medium"}
                  `,children:l.label})]},l.id)})})})})},Zo=({label:t,value:e,children:n})=>s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("td",{className:"px-2 py-2 text-xs sm:text-sm font-medium text-gray-700 bg-blue-100 border-r border-gray-200 w-1/3",children:t}),s.jsx("td",{className:"px-2 py-2 text-xs sm:text-sm text-gray-900 w-2/3",children:n||e||"-"})]}),BU=t=>({1:"",2:"",3:"",4:"",7:"",9:""})[t||""]||t||"-",WU=t=>{if(!t)return new Date().toLocaleString("ko-KR");if(t.length>=8){const e=t.slice(0,4),n=t.slice(4,6),r=t.slice(6,8);if(t.length>=14){const i=t.slice(8,10),l=t.slice(10,12);return`${e}-${n}-${r} ${i}:${l}`}return`${e}-${n}-${r}`}return t},FU=({order:t,onBack:e})=>{var l,c,d,u;const n=localStorage.getItem("userInfo"),r=n?JSON.parse(n):{},i=r.userName||r.userId||"";return s.jsx("div",{className:"h-full overflow-y-auto max-w-4xl mx-auto p-2 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"bg-blue-600 text-white px-3 py-2 text-sm sm:text-base font-semibold",children:[d3(t.WRK_CD)," [1.]"]}),s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden",children:s.jsx("table",{className:"w-full",children:s.jsxs("tbody",{children:[s.jsx(Zo,{label:"",value:t.PROD_NM||t.productName||"-"}),s.jsx(Zo,{label:"",value:t.WRK_CD?`${t.WRK_CD} (${t.WRK_CD_NM||t.typeDisplay||""})`:"-"}),s.jsx(Zo,{label:"",value:((l=t.customer)==null?void 0:l.id)||t.CUST_ID||"-"}),s.jsx(Zo,{label:"",value:((c=t.customer)==null?void 0:c.name)||"-"}),s.jsx(Zo,{label:"",value:((d=t.customer)==null?void 0:d.phone)||"-"}),s.jsx(Zo,{label:"",value:t.CTRT_ID||"-"}),s.jsx(Zo,{label:"",value:t.installLocation||"-"}),s.jsx(Zo,{label:"CELL NO",value:t.cellNo||"-"}),s.jsx(Zo,{label:"",value:((u=t.customer)==null?void 0:u.address)||"-"}),s.jsx(Zo,{label:"",value:t.SO_NM||"-"})]})})}),s.jsxs("div",{className:"mt-4",children:[A0(t.WRK_CD)&&s.jsxs("div",{className:"bg-green-50 border border-green-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-green-800 mb-2 flex items-center gap-1",children:[s.jsx(Vi,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-green-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    ( )"})]})]}),k0(t.WRK_CD)&&s.jsxs("div",{className:"bg-orange-50 border border-orange-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-orange-800 mb-2 flex items-center gap-1",children:[s.jsx(pu,{size:16}),"A/S   "]}),s.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[s.jsx("li",{children:" /    "}),s.jsx("li",{children:" A/S      "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "})]})]}),(Qm(t.WRK_CD)||Gm(t.WRK_CD))&&s.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-red-800 mb-2 flex items-center gap-1",children:[s.jsx(yf,{size:16}),"/  "]}),s.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsxs("li",{children:[" ",Qm(t.WRK_CD)?"()    ":"  "]}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "})]})]}),o_(t.WRK_CD)&&s.jsxs("div",{className:"bg-purple-50 border border-purple-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-purple-800 mb-2 flex items-center gap-1",children:[s.jsx(uc,{size:16}),"  "]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"     ( )"}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),Gm(t.WRK_CD)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-blue-800 mb-2 flex items-center gap-1",children:[s.jsx(rd,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),y5(t.WRK_CD,t.WRK_DTL_TCD)&&s.jsxs("div",{className:"bg-orange-50 border border-orange-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-orange-800 mb-2 flex items-center gap-1",children:[s.jsx(rw,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    (:20)"}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"     "})]})]}),b5(t.WRK_CD,t.WRK_DTL_TCD)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-blue-800 mb-2 flex items-center gap-1",children:[s.jsx(Vi,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    (:30/37)"}),s.jsx("li",{children:"   "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),t.WRK_CD==="06"&&s.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "})]})]}),t.WRK_CD==="04"&&s.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[s.jsxs("li",{children:[" ",t.WRK_DTL_TCD==="0430"?" ":t.WRK_DTL_TCD==="0440"?" ":"  "]}),s.jsx("li",{children:"   "}),s.jsx("li",{children:"   "})]})]}),t.WRK_CD==="09"&&s.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]})]}),t.MEMO&&s.jsxs("div",{className:"mt-4 bg-gray-50 p-3 rounded-lg",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 whitespace-pre-wrap",children:t.MEMO})]}),s.jsxs("div",{className:"mt-4 bg-green-50 border border-green-300 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-green-800 mb-2",children:" "}),s.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-green-700",children:[s.jsxs("div",{children:[": ",WU(t.WRKR_CMPL_DT||t.WRK_END_DTTM)]}),s.jsxs("div",{children:[": ",i]}),s.jsxs("div",{children:[" ID: ",t.id]}),t.WRK_CD&&s.jsxs("div",{children:[" : ",t.WRK_CD," (",t.WRK_CD_NM||t.typeDisplay,")"]}),t.CTRT_ID&&s.jsxs("div",{children:[" ID: ",t.CTRT_ID]}),s.jsxs("div",{children:[": ",BU(t.WRK_STAT_CD)]})]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:e,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors text-sm sm:text-base",children:""})})]})]})})},KU=({onNavigateToView:t,onNavigateToComingSoon:e,userInfo:n,showToast:r})=>{const{setSelectedWorkItem:i,setSelectedWorkDirection:l}=Yl(),[c,d]=x.useState(!1),[u,f]=x.useState(!1),[m,_]=x.useState(null),[y,g]=x.useState(!1),[N,C]=x.useState(null),{workFilters:v}=Yl(),{startDate:R,endDate:U}=v,L=new Date,w=L.toISOString().split("T")[0],{data:P=[],isLoading:G,error:K,refetch:B}=Kj({startDate:R,endDate:U}),O=P.filter(T=>T.scheduledAt?T.scheduledAt.split("T")[0]===w:!1),S=(K==null?void 0:K.message)||null,Y=(T=>{const j=["","","","","","",""],k=T.getFullYear(),Q=T.getMonth()+1,H=T.getDate(),$=j[T.getDay()];return{full:`${k} ${Q} ${H} (${$})`,short:`${Q} ${H}`}})(L),te={pending:O.filter(T=>T.status===hn.Pending),completed:O.filter(T=>T.status===hn.Completed),cancelled:O.filter(T=>T.status===hn.Cancelled)},J=T=>{l(T),t&&t("work-item-list")},q=(T,j)=>{T.stopPropagation(),j?window.location.href=`tel:${j}`:r&&r(" .","warning")},V=(T,j)=>{T.stopPropagation(),C(j),g(!0)},F=(T,j)=>{T.stopPropagation();const k=H=>H?H.includes("T")||H.includes("-")?H.replace(/[-:T]/g,"").substring(0,12):H:"",Q={SO_ID:j.SO_ID||"328",CUST_ID:j.CUST_ID||j.customer.id||"",CUST_NM:j.customer.name||"",SMS_RCV_TEL:j.customer.phone||"",SMS_SEND_TEL:"",WRK_HOPE_DTTM:k(j.scheduledAt),WRKR_NM:(n==null?void 0:n.userName)||"",WRKR_NM_EN:(n==null?void 0:n.userNameEn)||(n==null?void 0:n.userName)||"",WRK_CD:j.WRK_CD||"",WRK_CD_NM:j.typeDisplay||"",WRK_DRCTN_ID:j.WRK_DRCTN_ID||j.id||"",RCPT_ID:j.RCPT_ID||""};_(Q),f(!0)},I=T=>{switch(T){case hn.Pending:return"bg-blue-100 text-blue-800 border-blue-300";case hn.Completed:return"bg-green-100 text-green-800 border-green-300";case hn.Cancelled:return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-700 border-gray-300"}},ee=(T,j)=>s.jsx("div",{onClick:()=>J(T),className:"bg-white rounded-xl shadow-sm hover:shadow-md border border-gray-100 transition-all duration-200 cursor-pointer active:scale-[0.99] mb-3 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[j!==void 0&&s.jsx("div",{className:"flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full bg-blue-500 text-white text-sm font-bold",children:j}),s.jsxs("h3",{className:"font-bold text-gray-900 text-base truncate",children:[T.customer.name,T.customer.id&&s.jsxs("span",{className:"text-gray-400 font-normal ml-1",children:["(",T.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),s.jsx(xb,{customer:T.customer})]}),s.jsx("div",{className:"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end",children:s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${I(T.status)}`,children:T.status})})]}),s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-blue-50 text-blue-700 border border-blue-200",children:T.typeDisplay}),T.WRK_CD==="04"&&T.WRK_DTL_TCD==="0440"&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-cyan-50 text-cyan-700 border border-cyan-200",children:""})]}),s.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:T.scheduledAt?new Date(T.scheduledAt).toLocaleString("ko-KR",{month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):" "})]})]}),s.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[s.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:T.customer.address||"  "})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("button",{onClick:k=>q(k,T.customer.phone),className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),""]}),s.jsxs("button",{onClick:k=>F(k,T),className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),""]}),s.jsxs("button",{onClick:k=>V(k,T),className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"whitespace-nowrap",children:""})]})]})]})},T.id),ae=(T,j,k,Q,H)=>j.length===0?null:s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:`flex items-center justify-between mb-3 px-4 py-2 rounded-lg ${k} shadow-sm`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[H,s.jsx("h3",{className:`font-bold text-base ${Q}`,children:T})]}),s.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full bg-white ${Q} font-bold text-sm shadow-sm`,children:j.length})]}),s.jsx("div",{className:"space-y-3",children:j.map(($,ie)=>ee($,ie+1))})]});return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-blue-600 text-white shadow-lg z-30",children:s.jsx("div",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Cf,{className:"w-5 h-5"}),s.jsx("h1",{className:"text-xl font-bold",children:" "})]}),s.jsx("p",{className:"text-blue-100 text-sm",children:Y.full})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-3xl font-bold",children:O.length}),s.jsx("div",{className:"text-xs text-blue-100",children:" "})]})]})})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-3 py-4",children:G?s.jsx(z0,{size:"medium",message:"   ..."}):S?s.jsx(Ib,{type:"error",message:S,onRetry:()=>window.location.reload()}):O.length===0?s.jsx("div",{className:"text-center py-16 px-6",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8 mx-auto max-w-sm border border-gray-200",children:[s.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Cf,{className:"w-10 h-10 text-blue-600"})}),s.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-800 mb-2 whitespace-nowrap",children:"   "}),s.jsx("p",{className:"text-gray-500",children:"  !"})]})}):s.jsxs("div",{children:[ae("",te.pending,"bg-blue-100","text-blue-700",s.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:s.jsx(y_,{className:"w-4 h-4 text-white"})})),ae("",te.completed,"bg-green-100","text-green-700",s.jsx("div",{className:"w-6 h-6 rounded-full bg-green-600 flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})),ae("",te.cancelled,"bg-red-100","text-red-700",s.jsx("div",{className:"w-6 h-6 rounded-full bg-red-600 flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}))]})}),!G&&!S&&O.length>0&&s.jsx("div",{className:"flex-shrink-0 bg-white border-t border-gray-200 shadow-lg px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-around text-center max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:te.pending.length}),s.jsx("div",{className:"text-xs text-gray-600",children:""})]}),s.jsx("div",{className:"w-px h-10 bg-gray-300"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:te.completed.length}),s.jsx("div",{className:"text-xs text-gray-600",children:""})]}),s.jsx("div",{className:"w-px h-10 bg-gray-300"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:te.cancelled.length}),s.jsx("div",{className:"text-xs text-gray-600",children:""})]})]})}),!G&&!S&&O.length>0&&s.jsx(k5,{onClick:()=>d(!0),workCount:O.length}),c&&s.jsx(nj,{workOrders:O,onBack:()=>d(!1),onSelectWork:T=>{d(!1),J(T)}}),s.jsx(w5,{isOpen:u,onClose:()=>f(!1),smsData:m,userId:(n==null?void 0:n.userId)||""}),N&&s.jsx(P5,{isOpen:y,onClose:()=>{g(!1),C(null)},direction:N,onSuccess:()=>{B()},showToast:r,userInfo:n})]})},QU=({workItem:t,onNext:e,onBack:n})=>{var ae,T,j,k,Q;const[r,i]=x.useState(null),[l,c]=x.useState(!1),[d,u]=x.useState(null),[f,m]=x.useState(null),[_,y]=x.useState(!1),[g,N]=x.useState([]),C=t.WRK_CD==="05",v=t.WRK_CD==="07",R=t.WRK_CD==="08",U=v||R,[L,w]=x.useState(null),[P,G]=x.useState(!1),[K,B]=x.useState(null);x.useEffect(()=>{(async()=>{const $=C&&t.DTL_CTRT_ID?t.DTL_CTRT_ID:t.CTRT_ID;if(!$){console.log("[ContractInfo] CTRT_ID  - getCtrtDetailInfo ");return}c(!0),u(null);try{console.log("[ContractInfo] getCtrtDetailInfo  :",{CTRT_ID:$,CUST_ID:t.CUST_ID,isProductChange:C,DTL_CTRT_ID:t.DTL_CTRT_ID});const ie=await g5($,t.CUST_ID);if(ie&&(console.log("[ContractInfo] getCtrtDetailInfo :",ie),i({PROM_CNT:ie.PROM_CNT,CTRT_APLY_STRT_DT:ie.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:ie.CTRT_APLY_END_DT,GRP_ID:ie.GRP_ID,GRP_NM:ie.GRP_NM,IP_CNT:ie.IP_CNT,SO_NM:ie.SO_NM,BASIC_PROD_CD_NM:ie.BASIC_PROD_CD_NM})),C&&t.CUST_ID){console.log("[ContractInfo]  - getFullContractInfo  ");const fe=await u5({CUST_ID:t.CUST_ID,CTRT_ID:t.CTRT_ID});console.log("[ContractInfo] getFullContractInfo :",fe),N(fe.contracts||[])}}catch(ie){console.error("[ContractInfo]    :",ie),u(ie.message||"   .")}finally{c(!1)}})()},[C,t.CUST_ID,t.CTRT_ID,t.DTL_CTRT_ID]),x.useEffect(()=>{(async()=>{if(!t.CUST_ID){console.log("[ContractInfo] CUST_ID  -    ");return}y(!0);try{console.log("[ContractInfo]    :",{CUST_ID:t.CUST_ID,WRK_DRCTN_ID:t.WRK_DRCTN_ID});const $=await P4(t.CUST_ID,t.WRK_DRCTN_ID);console.log("[ContractInfo]    :",$),m($)}catch($){console.error("[ContractInfo]    :",$)}finally{y(!1)}})()},[t.CUST_ID,t.WRK_DRCTN_ID]),x.useEffect(()=>{(async()=>{if(t.WRK_DRCTN_ID)try{const $=await p5(t.WRK_DRCTN_ID);$&&(console.log("[ContractInfo] getAfterProcInfo :",$),B($))}catch($){console.error("[ContractInfo] getAfterProcInfo :",$)}})()},[t.WRK_DRCTN_ID]),x.useEffect(()=>{(async()=>{const $=t.WRK_ID||t.id;if(!U||!$){console.log("[ContractInfo]     (WRK_CD:",t.WRK_CD,", WRK_ID:",$,")");return}G(!0);try{console.log("[ContractInfo]    :",{WRK_CD:t.WRK_CD,WRK_ID:$,RCPT_ID:t.RCPT_ID});const ie=await Cg({WRK_CD:t.WRK_CD||"",WRK_ID:$,RCPT_ID:t.RCPT_ID});console.log("[ContractInfo]    :",ie),w(ie)}catch(ie){console.error("[ContractInfo]    :",ie)}finally{G(!1)}})()},[U,t.WRK_CD,t.WRK_ID,t.id,t.RCPT_ID]);const[O,S]=x.useState([]),[A,Y]=x.useState(null),[te,J]=x.useState(!1),[q,V]=x.useState(null),[F,I]=x.useState(!1);x.useEffect(()=>{var $,ie,fe;if(console.log("[ContractInfo] VIP :",{"customer.isVip":($=t.customer)==null?void 0:$.isVip,VIP_GB:t.VIP_GB,customer:t.customer}),((ie=t.customer)==null?void 0:ie.isVip)||t.VIP_GB&&String(t.VIP_GB).length>0){const pe=((fe=t.customer)==null?void 0:fe.vipLevel)||(t.VIP_GB==="VIP_VVIP"?"VVIP":"VIP");Y({label:"VIP",value:`${pe} .`})}else Y(null)},[(ae=t.customer)==null?void 0:ae.isVip,(T=t.customer)==null?void 0:T.vipLevel,t.VIP_GB]),x.useEffect(()=>{(async()=>{var ie;if(!(((ie=t.customer)==null?void 0:ie.isVip)||t.VIP_GB&&String(t.VIP_GB).length>0)){V(null);return}I(!0);try{console.log("[ContractInfo] VIP  DB  ");const fe=await Zm({COMMON_GRP:"MOWO001",COMMON_CD:"AL1"});console.log("[ContractInfo] VIP  DB  :",fe),fe&&fe.length>0&&fe[0].REF_CODE?V(fe[0].REF_CODE):V(null)}catch(fe){console.error("[ContractInfo] VIP  DB  :",fe),V(null)}finally{I(!1)}})()},[(j=t.customer)==null?void 0:j.isVip,t.VIP_GB]),x.useEffect(()=>{var fe,pe,de,Re,X;const H=[],$=t.WRK_CD||((fe=f==null?void 0:f.workAlarm)==null?void 0:fe.WRK_CD);if(_||!f){S([]);return}K&&(K.CLOSE_DANGER==="Y"?H.push({label:"",value:" "}):H.push({label:"",value:"  "})),f.workAlarm&&(f.workAlarm.OTT_SALE_DESC&&H.push({label:"OTT",value:f.workAlarm.OTT_SALE_DESC}),f.workAlarm.BUNDLE_ISP_TG==="Y"&&H.push({label:"",value:" "}),["01","05","07"].includes($||"")&&f.workAlarm.PYM_MTHD==="01"&&f.workAlarm.ATMT_YN==="Y"&&H.push({label:"",value:"/Email"}),["01","05","06","07"].includes($||"")&&f.workAlarm.RLNM_AUTH_YN_NM&&H.push({label:"",value:f.workAlarm.RLNM_AUTH_YN_NM}),f.workAlarm.COUPON_VAL&&f.workAlarm.COUPON_VAL!=="0"&&Number(f.workAlarm.COUPON_VAL)>0&&H.push({label:"VOD",value:` ${Number(f.workAlarm.COUPON_VAL).toLocaleString()}`}));const ie=((pe=f.vodLastDate)==null?void 0:pe.max_dt)||((de=f.vodLastDate)==null?void 0:de.MAX_DT);if(ie&&String(ie).trim().length>7&&H.push({label:"VOD",value:`(6M)VOD: ${YU(String(ie))}`}),(Re=f.specialVod5k)!=null&&Re.BIGO&&H.push({label:"",value:f.specialVod5k.BIGO}),(X=f.custBasicInfo)!=null&&X.SMS_RCV_YN){const _e=String(f.custBasicInfo.SMS_RCV_YN);_e==="Y"?H.push({label:"",value:""}):_e==="N"&&H.push({label:"",value:""})}if(f.specialBigo&&f.specialBigo.length>0){const _e=f.specialBigo.find(me=>me.SPECIAL_GB==="G"&&me.BIGO);_e&&H.push({label:"",value:_e.BIGO||""})}H.length>0&&console.log("[ContractInfo]  :",H),S(H)},[f,_,t.WRK_CD,K]);const ee={PROM_CNT:(r==null?void 0:r.PROM_CNT)||t.PROM_CNT,CTRT_APLY_STRT_DT:(r==null?void 0:r.CTRT_APLY_STRT_DT)||t.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:(r==null?void 0:r.CTRT_APLY_END_DT)||t.CTRT_APLY_END_DT,GRP_ID:(r==null?void 0:r.GRP_ID)||t.GRP_ID,GRP_NM:(r==null?void 0:r.GRP_NM)||t.GRP_NM,IP_CNT:(r==null?void 0:r.IP_CNT)||t.IP_CNT,SO_NM:(r==null?void 0:r.SO_NM)||t.SO_NM,MSO_NM:t.MSO_NM};return s.jsxs("div",{className:"px-3 sm:px-4 py-4 sm:py-6 pb-4 space-y-3 sm:space-y-4 overflow-x-hidden",children:[l&&s.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-3 sm:p-4",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"animate-spin w-4 h-4 sm:w-5 sm:h-5 border-2 border-blue-500 border-t-transparent rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-xs sm:text-sm text-blue-700",children:"    ..."})]})}),d&&!l&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-100 rounded-xl p-3 sm:p-4",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-xs sm:text-sm text-yellow-700",children:d})]})}),!l&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:" "}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0",children:[s.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:[t.customer.name,t.customer.id&&s.jsxs("span",{className:"text-gray-400 font-normal ml-1",children:["(",t.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),t.customer.isVip&&s.jsx("span",{className:`
                  px-1.5 sm:px-2 py-0.5 rounded-full text-[0.625rem] sm:text-xs font-semibold flex-shrink-0
                  ${t.customer.vipLevel==="VVIP"?"bg-purple-100 text-purple-700":"bg-yellow-100 text-yellow-700"}
                `,children:t.customer.vipLevel})]})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.customer.phone||"-"})]}),s.jsxs("div",{className:"flex items-start pt-1 border-t border-gray-100",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 leading-relaxed flex-1 break-words",children:t.customer.address})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-all",children:Qi(t.PYM_ACNT_ID)||"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.PYM_MTHD||"-"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:ee.PROM_CNT?`${ee.PROM_CNT}`:"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:ee.CTRT_APLY_STRT_DT?XD(ee.CTRT_APLY_STRT_DT):"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:ee.CTRT_APLY_END_DT?XD(ee.CTRT_APLY_END_DT):"-"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:ee.GRP_ID||"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:ee.GRP_NM||"-"})]})]})]}),A&&s.jsxs("div",{className:"bg-amber-50 border border-amber-300 rounded-lg overflow-hidden",children:[s.jsxs("button",{onClick:()=>J(!te),className:"w-full flex items-center justify-between px-3 py-2 hover:bg-amber-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-xs sm:text-sm font-bold text-amber-600 w-20 sm:w-24 flex-shrink-0",children:"VIP"}),s.jsx("span",{className:"text-xs sm:text-sm font-bold text-amber-700",children:A.value})]}),s.jsx("svg",{className:`w-4 h-4 text-amber-600 transition-transform duration-200 ${te?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),te&&s.jsx("div",{className:"px-3 py-3 border-t border-amber-200 bg-amber-50",children:s.jsx("div",{className:"text-xs sm:text-sm text-amber-800",children:F?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-amber-500 border-t-transparent rounded-full"}),s.jsx("span",{children:"VIP   ..."})]}):q?s.jsx("p",{className:"whitespace-pre-wrap",children:q}):s.jsx("p",{className:"text-amber-600",children:"VIP .   ."})})})]}),O.length>0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsx("div",{className:"space-y-2 sm:space-y-3",children:O.map((H,$)=>s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:H.label}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words flex-1",children:H.value})]},$))})]}),C?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 pb-2 border-b border-gray-200",children:" "}),s.jsx("div",{className:"space-y-2",children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:t.OLD_PROD_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:"ID"}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-700",children:Qi(t.OLD_CTRT_ID||t.CTRT_ID)})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-700",children:t.OLD_CTRT_STAT_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-700",children:t.OLD_PROM_CNT?`${t.OLD_PROM_CNT}`:"-"})]})]})})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[s.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-2 pb-2 border-b border-blue-200",children:" "}),s.jsx("div",{className:"space-y-2",children:(()=>{const H=g.find(ie=>ie.CTRT_ID===t.DTL_CTRT_ID),$=(r==null?void 0:r.BASIC_PROD_CD_NM)||(H==null?void 0:H.BASIC_PROD_CD_NM);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-700 break-words",children:$||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:"ID"}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-600",children:Qi(t.DTL_CTRT_ID||(H==null?void 0:H.CTRT_ID))})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-600",children:(H==null?void 0:H.CTRT_STAT_NM)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-600",children:H!=null&&H.PROM_CNT?`${H.PROM_CNT}`:"-"})]})]})})()})]})]})]}):U?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),P?s.jsxs("div",{className:"flex items-center justify-center gap-2 py-4",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full"}),s.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"   ..."})]}):s.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[s.jsxs("div",{className:`rounded-lg p-3 ${R?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[s.jsx("div",{className:`text-xs font-semibold mb-2 pb-2 border-b ${R?"text-blue-600 border-blue-200":"text-gray-500 border-gray-200"}`,children:""}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${R?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${R?"text-blue-700":"text-gray-900"}`,children:R?(r==null?void 0:r.BASIC_PROD_CD_NM)||"-":(L==null?void 0:L.PROD_NM)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${R?"text-blue-400":"text-gray-400"}`,children:"ID"}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${R?"text-blue-600":"text-gray-700"}`,children:Qi(R?t.CTRT_ID:(L==null?void 0:L.OLD_CTRT_ID)||(L==null?void 0:L.CTRT_ID))})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${R?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${R?"text-blue-600":"text-gray-700"}`,children:R?((k=t.customer)==null?void 0:k.address)||"-":(L==null?void 0:L.ADDR_ORD)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${R?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${R?"text-blue-600":"text-gray-700"}`,children:R?t.WRK_STAT_NM||"-":(L==null?void 0:L.WRK_STAT_NM)||"-"})]})]})]}),s.jsxs("div",{className:`rounded-lg p-3 ${v?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[s.jsx("div",{className:`text-xs font-semibold mb-2 pb-2 border-b ${v?"text-blue-600 border-blue-200":"text-gray-500 border-gray-200"}`,children:""}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${v?"text-blue-700":"text-gray-900"}`,children:v?(r==null?void 0:r.BASIC_PROD_CD_NM)||"-":(L==null?void 0:L.PROD_NM)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:"ID"}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${v?"text-blue-600":"text-gray-700"}`,children:Qi(v?t.CTRT_ID:L==null?void 0:L.CTRT_ID)})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${v?"text-blue-600":"text-gray-700"}`,children:v?((Q=t.customer)==null?void 0:Q.address)||"-":(L==null?void 0:L.ADDR_ORD)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${v?"text-blue-600":"text-gray-700"}`,children:v?t.WRK_STAT_NM||"-":(L==null?void 0:L.WRK_STAT_NM)||"-"})]})]})]})]})]}):s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:"ID"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:Qi(t.CTRT_ID)})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.CTRT_STAT_NM||GU(t.CTRT_STAT)})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words flex-1",children:(r==null?void 0:r.BASIC_PROD_CD_NM)||t.productName||"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:"IP"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:ee.IP_CNT||"-"})]})]})]})]})]})},GU=t=>({10:"",20:"",30:"",37:"()",90:""})[t||""]||"  ",XD=t=>{if(!t)return"-";const e=String(t),n=e.replace(/\D/g,"");return n.length>=8?`${n.slice(0,4)}-${n.slice(4,6)}-${n.slice(6,8)}`:e||"-"},YU=t=>!t||t.length<8?"-":`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`,VU=({workItem:t,onNext:e,onBack:n,showToast:r})=>{var K,B,O;const[i,l]=x.useState(!1),[c,d]=x.useState([]),[u,f]=x.useState(!1),[m,_]=x.useState(!1),[y,g]=x.useState(!1),[N,C]=x.useState([]),[v,R]=x.useState(!1),[U,L]=x.useState(!1);x.useEffect(()=>{(async()=>{var A;if((A=t.customer)!=null&&A.id&&!m){f(!0);try{const Y=await I4(t.customer.id);d(Y),_(!0)}catch(Y){console.error("  :",Y),d([]),_(!0)}finally{f(!1)}}})()},[(K=t.customer)==null?void 0:K.id]),x.useEffect(()=>{(async()=>{var A;if((A=t.customer)!=null&&A.id&&!U){R(!0);try{const Y=await O4(t.customer.id);C(Y),L(!0)}catch(Y){console.error("  :",Y),C([]),L(!0)}finally{R(!1)}}})()},[(B=t.customer)==null?void 0:B.id]);const w=()=>{l(!i)},P=()=>{g(!y)},G=()=>{r&&r("   .","info")};return s.jsxs("div",{className:"px-3 sm:px-4 py-4 sm:py-6 pb-3 sm:pb-4 space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:"  "}),s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:"ID"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:Qi(t.RCPT_ID)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:"ID"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:Qi(t.id)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-blue-600 whitespace-nowrap",children:t.typeDisplay})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:HU(t.WRK_STAT_CD)})]}),s.jsxs("div",{className:"flex items-center justify-between pt-1.5 sm:pt-2 mt-1.5 sm:mt-2 border-t border-gray-100",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-blue-600 whitespace-nowrap",children:zU(t.scheduledAt)})]})]})]}),$U(t),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2.5 sm:mb-3",children:"  "}),s.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 rounded-lg text-xs sm:text-sm text-gray-700 leading-relaxed min-h-20 whitespace-pre-line",children:(O=t.details)==null?void 0:O.replace(/  /g,`
`)})]}),t.installLocation&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2.5 sm:mb-3",children:" "}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 p-2.5 sm:p-3 bg-gray-50 rounded-lg",children:[s.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.installLocation})]})]}),t.cellNo&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2.5 sm:mb-3",children:" "}),s.jsxs("div",{className:"flex items-center justify-between gap-2 p-2.5 sm:p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:t.cellNo}),s.jsxs("button",{className:"min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 bg-green-500 hover:bg-green-600 text-white text-xs sm:text-sm font-medium rounded-lg transition-colors flex items-center gap-1.5 sm:gap-2 whitespace-nowrap flex-shrink-0",children:[s.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"})})," "]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsxs("button",{onClick:w,className:"w-full p-3 sm:p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:""}),u?s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-500 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:"..."}):m&&s.jsxs("span",{className:"px-1.5 sm:px-2 py-0.5 bg-blue-100 text-blue-700 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:[c.length,""]})]}),s.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 text-gray-400 transition-transform flex-shrink-0 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&s.jsx("div",{className:"border-t border-gray-100 p-3 sm:p-5",children:u?s.jsxs("div",{className:"flex items-center justify-center py-6 sm:py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-blue-500"}),s.jsx("span",{className:"ml-2 sm:ml-3 text-xs sm:text-sm text-gray-500",children:" ..."})]}):c.length===0?s.jsx("div",{className:"text-center py-6 sm:py-8 text-gray-500 text-xs sm:text-sm",children:" 7  ."}):s.jsx("div",{className:"space-y-2.5 sm:space-y-3 max-h-64 sm:max-h-80 overflow-y-auto",children:c.map((S,A)=>s.jsxs("div",{className:"p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5 sm:mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0",children:[s.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-medium rounded whitespace-nowrap ${S.MSG_TYP==="KKO"?"bg-yellow-100 text-yellow-700":S.MSG_TYP==="LMS"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:S.MSG_TYP||"SMS"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:S.EML_SMS_SND_TP_NM||"-"})]}),s.jsx("span",{className:`text-[0.625rem] sm:text-xs font-medium whitespace-nowrap ${S.RESULT===""?"text-green-600":S.RESULT===""?"text-red-600":"text-gray-500"}`,children:S.RESULT||"-"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2 text-[0.625rem] sm:text-xs text-gray-500 mb-1.5 sm:mb-2",children:[s.jsxs("div",{className:"truncate",children:[": ",S.CELL_PHN||"-"]}),s.jsxs("div",{className:"truncate",children:[": ",S.SMS_RCV_NO||"-"]}),S.SEND_TIME&&s.jsxs("div",{className:"col-span-2",children:[": ",S.SEND_TIME]}),S.REG_NM&&s.jsxs("div",{className:"col-span-2",children:[": ",S.REG_NM]})]}),S.MESSAGE&&s.jsx("div",{className:"mt-1.5 sm:mt-2 p-2 bg-white rounded border border-gray-200 text-xs sm:text-sm text-gray-700 whitespace-pre-wrap",children:S.MESSAGE})]},A))})})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:s.jsxs("button",{onClick:G,className:"w-full p-3 sm:p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:""})]}),s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsxs("button",{onClick:P,className:"w-full p-3 sm:p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:""}),v?s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-500 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:"..."}):U&&s.jsxs("span",{className:"px-1.5 sm:px-2 py-0.5 bg-green-100 text-green-700 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:[N.length,""]})]}),s.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 text-gray-400 transition-transform flex-shrink-0 ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&s.jsx("div",{className:"border-t border-gray-100 p-3 sm:p-5",children:v?s.jsxs("div",{className:"flex items-center justify-center py-6 sm:py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-green-500"}),s.jsx("span",{className:"ml-2 sm:ml-3 text-xs sm:text-sm text-gray-500",children:" ..."})]}):N.length===0?s.jsx("div",{className:"text-center py-6 sm:py-8 text-gray-500 text-xs sm:text-sm",children:" ."}):s.jsx("div",{className:"space-y-2.5 sm:space-y-3 max-h-64 sm:max-h-80 overflow-y-auto",children:N.map((S,A)=>s.jsxs("div",{className:"p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5 sm:mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0",children:[s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-medium rounded whitespace-nowrap bg-green-100 text-green-700",children:S.RCPT_TP_NM||""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:S.CNSL_MST_CL_NM||"-"})]}),s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500 whitespace-nowrap",children:S.START_DD||"-"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2 text-[0.625rem] sm:text-xs text-gray-500 mb-1.5 sm:mb-2",children:[S.CNSL_MID_CL_NM&&s.jsxs("div",{className:"truncate",children:[": ",S.CNSL_MID_CL_NM]}),S.CNSL_SLV_CL_NM&&s.jsxs("div",{className:"truncate",children:[": ",S.CNSL_SLV_CL_NM]}),S.CNSL_RSLT_NM&&s.jsxs("div",{className:"truncate",children:[": ",S.CNSL_RSLT_NM]}),S.RCPT_PSN_NM&&s.jsxs("div",{className:"truncate",children:[": ",S.RCPT_PSN_NM]})]}),S.REQ_CTX&&s.jsxs("div",{className:"mt-1.5 sm:mt-2 p-2 bg-white rounded border border-gray-200 text-xs sm:text-sm text-gray-700",children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"whitespace-pre-wrap",children:S.REQ_CTX})]}),S.PROC_CT&&s.jsxs("div",{className:"mt-1.5 sm:mt-2 p-2 bg-blue-50 rounded border border-blue-100 text-xs sm:text-sm text-gray-700",children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-600 mb-1",children:""}),s.jsx("div",{className:"whitespace-pre-wrap",children:S.PROC_CT})]})]},A))})})]})]})},$U=t=>{const e=t.WRK_CD;return e==="0410"||e==="06"?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-5",children:[s.jsx("h4",{className:"text-base font-bold text-gray-900 mb-4",children:"  "}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.mmtSusCd&&s.jsxs("div",{className:"space-y-1 col-span-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"  "}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.mmtSusCd})]}),t.susHopeDd&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:" "}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:JD(t.susHopeDd)})]}),t.mmtSusHopeDd&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:" "}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:JD(t.mmtSusHopeDd)})]}),t.termDays&&s.jsxs("div",{className:"space-y-1 col-span-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"  "}),s.jsxs("p",{className:"text-sm font-medium text-blue-600",children:[t.termDays,""]})]})]})]}):null},HU=t=>({1:"",2:"",3:"",4:"",7:"",9:""})[t||""]||"  ",zU=t=>{try{const e=new Date(t),n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0");return`${n}-${r}-${i} ${l}:${c}`}catch{return t}},JD=t=>t&&t.length===8?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t,Ph=({isOpen:t,onClose:e,prodCd:n,ctrtId:r,prodGrp:i,prodNm:l,wrkCdNm:c,onSave:d,showToast:u,customerEquipmentCount:f=0,installedEquipmentCount:m=0})=>{const[_,y]=x.useState([]),[g,N]=x.useState([]),[C,v]=x.useState({}),[R,U]=x.useState([]),[L,w]=x.useState([]),[P,G]=x.useState([]),[K,B]=x.useState([]),[O,S]=x.useState(""),[A,Y]=x.useState([]),[te,J]=x.useState(!1),[q,V]=x.useState(!1),[F,I]=x.useState(""),[ee,ae]=x.useState("1");x.useEffect(()=>{t&&T()},[t,n,r]);const T=async()=>{J(!0);try{console.log("[Modal]     "),console.log("  PROD_CD:",n),console.log("  CTRT_ID:",r);const le=await y4(n,r);console.log("[Modal]   :",le);const se=await b4("LENT,EQT_USE_STAT,ITLLMT_PRD");console.log("[Modal]  :",se);let Ee=[],Ne=[],ye=[];const ne=at=>Array.isArray(at)?at.map(We=>{if(typeof We=="string"||typeof We=="number"){const rt=String(We);return{COMMON_CD:rt,COMMON_CD_NM:rt}}const Dt=(We==null?void 0:We.COMMON_CD)??(We==null?void 0:We.CODE)??(We==null?void 0:We.CD)??(We==null?void 0:We.value)??(We==null?void 0:We.COMMONCODE)??(We==null?void 0:We.code),Tt=(We==null?void 0:We.COMMON_CD_NM)??(We==null?void 0:We.CD_NM)??(We==null?void 0:We.NAME)??(We==null?void 0:We.label)??(We==null?void 0:We.text)??(We==null?void 0:We.COMMONCDNM)??(We==null?void 0:We.name),St=(We==null?void 0:We.REF_CODE)??(We==null?void 0:We.REF)??(We==null?void 0:We.refCode)??(We==null?void 0:We.ref),ze=(We==null?void 0:We.COMMON_GRP)??(We==null?void 0:We.GROUP)??(We==null?void 0:We.group),dt=(We==null?void 0:We.SORT_NO)??(We==null?void 0:We.SORT)??(We==null?void 0:We.order)??void 0,Ke=(We==null?void 0:We.DEFAULT_YN)??(We==null?void 0:We.DEFAULT)??(We==null?void 0:We.default)??void 0;return{COMMON_CD:typeof Dt=="string"?Dt:Dt!=null?String(Dt):"",COMMON_CD_NM:typeof Tt=="string"?Tt:Tt!=null?String(Tt):"",REF_CODE:typeof St=="string"?St:St!=null?String(St):void 0,COMMON_GRP:ze!=null?String(ze):void 0,SORT_NO:typeof dt=="number"?dt:dt!=null?Number(dt):void 0,DEFAULT_YN:Ke!=null?String(Ke):void 0}}).filter(We=>We.COMMON_CD):[];if(se&&!Array.isArray(se)&&typeof se=="object"){const at=(Array.isArray(se.LENT)?se.LENT:void 0)??(Array.isArray(se.CMCU027)?se.CMCU027:[]),We=(Array.isArray(se.EQT_USE_STAT)?se.EQT_USE_STAT:void 0)??(Array.isArray(se.CMEP314)?se.CMEP314:[]),Dt=(Array.isArray(se.ITLLMT_PRD)?se.ITLLMT_PRD:void 0)??(Array.isArray(se.CMCU064)?se.CMCU064:[]),Tt=(Ke,rt)=>Array.isArray(Ke)?Ke.length>0&&!("COMMON_GRP_NM"in(Ke[0]||{})||"GROUP_NM"in(Ke[0]||{}))?Ke:Ke.filter(ft=>{const Ot=String((ft==null?void 0:ft.COMMON_GRP_NM)||(ft==null?void 0:ft.GROUP_NM)||"");return rt.some(mt=>Ot.indexOf(mt)>=0)}):[],St=Tt(at,[""]),ze=Tt(We,["",""]),dt=Tt(Dt,["","",""]);Ee=ne(St.length?St:at),Ne=ne(ze.length?ze:We),ye=ne(dt.length?dt:Dt)}else{let at=[];Array.isArray(se)?at=ne(se):se!=null&&se.codes&&Array.isArray(se.codes)&&(at=ne(se.codes)),at.length>0&&(Ee=at.filter(We=>We.COMMON_GRP==="LENT"||We.COMMON_GRP==="CMCU027"),Ne=at.filter(We=>We.COMMON_GRP==="EQT_USE_STAT"||We.COMMON_GRP==="CMEP314"),ye=at.filter(We=>We.COMMON_GRP==="ITLLMT_PRD"||We.COMMON_GRP==="CMCU064"))}console.log("   :",(Ee==null?void 0:Ee.length)||0,""),console.log("   :",(Ne==null?void 0:Ne.length)||0,""),console.log("   :",(ye==null?void 0:ye.length)||0,""),U(Ee||[]),w(Ne||[]),G(ye||[]);try{const We=(await Zm({COMMON_GRP:"LGCT001"})).map(Dt=>Dt.COMMON_CD).filter(Boolean);Y(We),console.log("  LG   (LGCT001):",We.length,"")}catch(at){console.warn("  LGCT001  , AP  :",at),Y([])}const ue=le.output2||[];console.log("   :",ue.length),console.log("    ( ):",ue[0]);const xe=i==="V"?"09":"10",et=ue.filter(at=>(!at.SEL||at.SEL==="0")&&at.EQT===xe);N(et),console.log("    :",et.length,"(PROD_GRP:",i,",  EQT:",xe,")");const bt=ue.map((at,We)=>(console.log(`  [${We}]:`,{EQT:at.EQT,PROD_TYP:at.PROD_TYP,EQUIP_SEQ:at.EQUIP_SEQ,SVC_CMPS_ID:at.SVC_CMPS_ID,SEL:at.SEL}),{...at,SEL:at.SEL||"0",LENT:at.LENT||"10",EQT_USE_STAT_CD:at.EQT_USE_STAT_CD||"1",ITLLMT_PRD:at.ITLLMT_PRD||"00",PROD_TYP:at.PROD_TYP||"2",EQUIP_SEQ:at.EQUIP_SEQ||at.SVC_CMPS_ID||String(We+1)}));if(y(bt),le.output1&&le.output1.length>0){const at=le.output1[0];console.log("[Modal]   :",at);const We=at.ITEM_MID_CDS||"",Dt=at.EQT_CLS||"",Tt=(at.LENTS||"").replace(/\[|\]/g,""),St=at.EQT_USE_STATS||"",ze=at.ITLLMT_PRDS||"",dt=at.EQT_SALE_AMTS||"",Ke=at.PROD_CMPS_CLS||"",rt=at.PROD_GRPS||"",ft=at.PROD_CDS||"",Ot=at.SVC_CDS||"";console.log("[Modal] PROD_CMPS_CLS :",Ke,"(:",Ke.length,")");const mt=Math.floor(We.length/10),Ze=[...bt],Ye=(Ce=>{const ge=[];let Be=0;for(;Be<Ce.length;){const ce=Ce.charAt(Be);Be++;let Le="";for(;Be<Ce.length&&/\d/.test(Ce.charAt(Be))&&(Le+=Ce.charAt(Be),Be++,!(Le.length>=2)););(ce||Le)&&ge.push({prodTyp:ce,equipSeq:Le})}return ge})(Ke);console.log("[Modal] PROD_CMPS_CLS :",Ye);for(let Ce=0;Ce<mt;Ce++){const ge=We.substr(Ce*10,10).trim(),Be=Dt.substr(Ce*10,10).trim(),ce=Tt.substr(Ce*2,2).trim(),Le=St.substr(Ce*1,1).trim(),Xe=ze.substr(Ce*2,2).trim(),Pe=dt.substr(Ce*10,10).trim(),Ct=rt.charAt(Ce)||"D",Me=ft.substr(Ce*10,10).trim(),lt=Ot.substr(Ce*10,10).trim(),ut=Ye[Ce]||{prodTyp:"2",equipSeq:String(Ce+1)},jt=Ze.findIndex(Ve=>Ve.SEL!=="1"&&Ve.EQT===ge);jt>-1&&(Ze[jt]={...Ze[jt],SEL:"1",EQT_CL:Be,LENT:ce||"10",EQT_USE_STAT_CD:Le||"1",ITLLMT_PRD:Xe||"00",EQT_SALE_AMT:parseInt(Pe)||0,PROD_TYP:Ze[jt].PROD_TYP,EQUIP_SEQ:Ze[jt].EQUIP_SEQ,PROD_GRP:Ct||Ze[jt].PROD_GRP,PROD_CD:Me||Ze[jt].PROD_CD,SVC_CD:lt||Ze[jt].SVC_CD},console.log(`  [${jt}]  (output2   ):`,{EQT:Ze[jt].EQT,PROD_TYP:Ze[jt].PROD_TYP,EQUIP_SEQ:Ze[jt].EQUIP_SEQ,SEL:"1"}))}console.log("[Modal]   :",Ze.filter(Ce=>Ce.SEL==="1")),y(Ze)}B(le.output3||[]);const it=await C4(n,r),At={};it.forEach(at=>{At[at.EQT_CD]||(At[at.EQT_CD]=[]),At[at.EQT_CD].some(We=>We.EQT_CL_CD===at.EQT_CL_CD)||At[at.EQT_CD].push({EQT_CL_CD:at.EQT_CL_CD,EQT_CL_NM:at.EQT_CL_NM,SUB_EQT_1:at.SUB_EQT_1,SUB_EQT_2:at.SUB_EQT_2,SUB_EQT_3:at.SUB_EQT_3,DEL_EQT_1:at.DEL_EQT_1,DEL_EQT_2:at.DEL_EQT_2,DEL_EQT_3:at.DEL_EQT_3})}),ue.forEach(at=>{const We=at.EQT_CD||at.EQT;if(!We)return;At[We]||(At[We]=[]),!At[We].some(Tt=>Tt.EQT_CL_CD===at.EQT_CL)&&at.EQT_CL&&at.EQT_CL_NM&&At[We].push({EQT_CL_CD:at.EQT_CL,EQT_CL_NM:at.EQT_CL_NM,SUB_EQT_1:at.SUB_EQT_1,SUB_EQT_2:at.SUB_EQT_2,SUB_EQT_3:at.SUB_EQT_3,DEL_EQT_1:at.DEL_EQT_1,DEL_EQT_2:at.DEL_EQT_2,DEL_EQT_3:at.DEL_EQT_3})}),v(At),console.log("   (API ):",At),console.log("[Modal]   ")}catch(le){console.error("[Modal]   :",le),u==null||u("   .","error",!0)}finally{J(!1)}},j=le=>{const se=[..._],Ee=se[le],Ne=Ee.SEL,ye=Ne==="1"?"0":"1";se[le].SEL=ye,console.log(`[Modal]  : [${le}] ${Ee.EQT} - SEL: ${Ne}  ${ye}`);const ne=[];if(Ee.EQT_CL){const xe=(C[Ee.EQT_CD]||[]).find(et=>et.EQT_CL_CD===Ee.EQT_CL);xe&&(xe.SUB_EQT_1&&ne.push(xe.SUB_EQT_1),xe.SUB_EQT_2&&ne.push(xe.SUB_EQT_2),xe.SUB_EQT_3&&ne.push(xe.SUB_EQT_3))}if(ye==="0"&&ne.length>0){let ue=0;se.forEach((xe,et)=>{if(et!==le){const bt=k(xe.EQT);ne.includes(bt)&&xe.SEL==="1"&&(xe.SEL="0",ue++,console.log(`[Modal]   - SUB_EQT  : ${xe.EQT_NM||xe.EQT}`))}}),ue>0&&(u==null||u(`${ue}    .`,"info"))}if(ye==="1"&&ne.length>0&&Ee.EQT_CL){let ue=0;se.forEach((xe,et)=>{if(et!==le){const bt=k(xe.EQT);ne.includes(bt)&&xe.SEL!=="1"&&(xe.SEL="1",ue++,console.log(`[Modal]   - SUB_EQT  : ${xe.EQT_NM||xe.EQT}`))}}),ue>0&&(u==null||u(`${ue}    .`,"info"))}y(se),console.log(`      : ${se.filter(ue=>ue.SEL==="1").length}`)},k=le=>(le==null?"":String(le).trim()).padStart(2,"0"),Q=(le,se,Ee)=>{const Ne=[..._];if(Ne[le][se]=Ee,se==="EQT_CL"){const ye=Ne[le],ue=(C[ye.EQT_CD]||[]).find(xe=>xe.EQT_CL_CD===Ee);if(ue){Ne[le].EQT_CL_NM=ue.EQT_CL_NM,console.log("[Modal]  :",{index:le,EQT_CL_CD:Ee,EQT_CL_NM:ue.EQT_CL_NM});const xe=[],et=[];ue.SUB_EQT_1&&xe.push(ue.SUB_EQT_1),ue.SUB_EQT_2&&xe.push(ue.SUB_EQT_2),ue.SUB_EQT_3&&xe.push(ue.SUB_EQT_3),ue.DEL_EQT_1&&et.push(ue.DEL_EQT_1),ue.DEL_EQT_2&&et.push(ue.DEL_EQT_2),ue.DEL_EQT_3&&et.push(ue.DEL_EQT_3),console.log("[Modal]   :",{EQT:ye.EQT,model:Ee,modelName:ue.EQT_CL_NM,SUB_EQTs:xe,DEL_EQTs:et});let bt=0,it=0;if(xe.length>0&&Ne.forEach((We,Dt)=>{if(Dt!==le){const Tt=k(We.EQT);xe.includes(Tt)&&We.SEL!=="1"&&(We.SEL="1",bt++,console.log(`[Modal] SUB_EQT  : ${We.EQT_NM||We.EQT} (EQT: ${Tt})`))}}),et.length>0&&Ne.forEach((We,Dt)=>{if(Dt!==le){const Tt=k(We.EQT);et.includes(Tt)&&We.SEL==="1"&&(We.SEL="0",it++,console.log(`[Modal] DEL_EQT  : ${We.EQT_NM||We.EQT} (EQT: ${Tt})`))}}),bt>0||it>0){const We=[];bt>0&&We.push(`${bt}   `),it>0&&We.push(`${it}   `),u==null||u(We.join(", "),"info")}const At=Ee==="090491",at=ye.EQT==="21"||ye.EQT==="22";(At||at)&&(Ne[le].LENT="40",console.log(`[Modal]   LENT=40  : ${At?"XCAS":"EQT="+ye.EQT}`))}}se==="LENT"&&(Ee!=="31"&&(Ne[le].ITLLMT_PRD="00"),["30","31","60"].includes(Ee)||(Ne[le].EQT_USE_STAT_CD="1")),y(Ne)},H=()=>{if(!F){u==null||u("  .","warning");return}const le=parseInt(ee);if(isNaN(le)||le<1){u==null||u("  .","warning");return}const se=g.find(Ne=>Ne.EQT===F);if(!se)return;const Ee=[..._];for(let Ne=0;Ne<le;Ne++)Ee.push({...se,SEL:"1",LENT:"10",EQT_USE_STAT_CD:"1",ITLLMT_PRD:"00",PROD_TYP:se.PROD_TYP||"2",EQUIP_SEQ:se.EQUIP_SEQ||se.SVC_CMPS_ID||String(Ee.length+1)});y(Ee),ae("1")},$=async()=>{if(console.log(`
 [Modal]    `),m>0){u==null||u("      .   .","error");return}console.log("  equipmentList :",_.length,""),console.log("    SEL :"),_.forEach((ue,xe)=>{console.log(`    [${xe}] ${ue.EQT} - SEL: "${ue.SEL}" (: ${ue.SEL==="1"?"O":"X"})`)});const le=_.filter(ue=>ue.SEL==="1");if(console.log(" :",le.length,""),le.forEach((ue,xe)=>{console.log(`  [${xe}] ${ue.EQT} - PROD_TYP: ${ue.PROD_TYP}, EQUIP_SEQ: ${ue.EQUIP_SEQ}`)}),le.length===0){u==null||u("  .","warning");return}const se=ue=>(ue==null?"":String(ue).trim()).padStart(2,"0"),Ee=ue=>{const xe=se(ue.EQT),et=se(ue.ITEM_MID_CD),bt=se(ue.ITM_MID_CD),it=se(ue.EQT_CD);return xe==="04"||et==="04"||bt==="04"||it==="04"};le.filter(Ee);const Ne=le.filter(ue=>ue.EQT==="10").length,ye=le[0];if(ye&&ye.CMPS_QTY_FROM==="2"){if(Ne!==2){u==null||u("   2 .","warning");return}}else if(A.includes(n)&&Ne>1){u==null||u("    1 .","warning");return}const ne=le.filter(ue=>ue.EQT==="09").length;if(ne>180){u==null||u(` 180  . HANDY : ${ne}`,"warning");return}if(Ne>180){u==null||u(` 180  . (AP) : ${Ne}`,"warning");return}V(!0);try{console.log(" [Modal] onSave  - selectedEquipments:",le.length,""),console.log("    :"),le.forEach((ue,xe)=>{console.log(`    [${xe}]`,{EQT:ue.EQT,SEL:ue.SEL,PROD_TYP:ue.PROD_TYP,EQUIP_SEQ:ue.EQUIP_SEQ,PROD_GRP:ue.PROD_GRP,PROD_CD:ue.PROD_CD,SVC_CD:ue.SVC_CD,EQT_CL:ue.EQT_CL,LENT:ue.LENT,EQT_USE_STAT_CD:ue.EQT_USE_STAT_CD,ITLLMT_PRD:ue.ITLLMT_PRD})}),await d(le,O),e()}catch(ue){console.error("[Modal]  :",ue)}finally{V(!1)}},ie=le=>K.filter(se=>se.PRED==="1"&&se.EQT_USE_STAT_CD===le.EQT_USE_STAT_CD&&se.EQT_CL_CD===le.EQT_CL),fe=le=>{const se=R.find(Ee=>Ee.COMMON_CD===le);return se?se.COMMON_CD_NM:le},pe=(le,se)=>{const Ee=le.LENT_YN,Ne=le.EQT_CL;if(!Ee||typeof Ee!="string"||!se||se.length===0)return console.log("[] LENT_YN    ",{lentYn:Ee,allLentCodesCount:se.length}),[];const ye=Ee.split("|").map(xe=>xe.trim()).filter(Boolean);if(!ye.length)return console.log("[] LENT_YN     ",{lentYn:Ee}),[];const ne=new Set;if(ye.forEach(xe=>{if(xe.length>=7){const et=xe.substring(0,6),bt=xe.charAt(6);Ne&&et===Ne&&ne.add(bt)}}),console.log("[]  ",{eqtCl:Ne,lentYn:Ee,tokens:ye,allowedRefCodes:Array.from(ne),allLentCodes:se.map(xe=>({code:xe.COMMON_CD,name:xe.COMMON_CD_NM,refCode:xe.REF_CODE}))}),ne.size===0)return console.log("[]  REF_CODE    "),[];const ue=se.filter(xe=>{const et=xe.REF_CODE,bt=et&&ne.has(et);return console.log(`  - ${xe.COMMON_CD} (${xe.COMMON_CD_NM}): REF_CODE=${et}  ${bt?"":""}`),bt}).map(xe=>xe.COMMON_CD);return console.log("[]  :",ue),ue},de=le=>{const se=L.find(Ee=>Ee.COMMON_CD===le);return se?se.COMMON_CD_NM:le},Re=x.useMemo(()=>(R||[]).map(se=>({value:se.COMMON_CD,label:se.COMMON_CD_NM||se.COMMON_CD,SORT_NO:se.SORT_NO,DEFAULT_YN:se.DEFAULT_YN,REF_CODE:se.REF_CODE})),[R]);x.useMemo(()=>(L||[]).map(se=>({value:se.COMMON_CD,label:se.COMMON_CD_NM||se.COMMON_CD})),[L]);const X=x.useMemo(()=>(P||[]).map(se=>({value:se.COMMON_CD,label:se.COMMON_CD_NM||se.COMMON_CD})),[P]),_e=x.useMemo(()=>(g||[]).map(le=>({value:le.EQT,label:le.EQT_NM})),[g]),me=te?null:s.jsxs("div",{className:"modal-subheader",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("span",{className:"info-value",title:r,children:r||"-"})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("span",{className:"info-value",title:c,children:c||"-"})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("span",{className:"info-value",title:l,children:l||"-"})]}),i==="V"&&X.length>0&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("div",{className:"info-select",children:s.jsx(Zs,{value:O||"",onValueChange:S,options:X,placeholder:""})})]})]}),Z=s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:e,disabled:q,children:""}),s.jsx("button",{className:"btn btn-primary btn-sm",onClick:$,disabled:q||te,children:q?" ...":""})]});return s.jsx(_a,{isOpen:t,onClose:e,title:"  ",size:"large",subHeader:me,footer:Z,children:s.jsx("div",{className:"equipment-model-change-modal-content",children:te?s.jsxs("div",{className:"loading-message",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"   ..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"add-equipment-section",children:[s.jsx("h3",{children:" "}),s.jsxs("div",{className:"add-equipment-form",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Zs,{value:F,onValueChange:I,options:_e,placeholder:"  "})}),s.jsx("input",{type:"number",className:"count-input",value:ee,onChange:le=>ae(le.target.value),min:"1",max:"99"}),s.jsx("span",{className:"unit",children:""}),s.jsx("button",{className:"add-btn",onClick:H,children:""})]})]}),s.jsxs("div",{className:"equipment-section",children:[s.jsxs("h3",{children:["  (",_.filter(le=>le.SEL==="1").length," )"]}),_.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:"  ."})}):s.jsx("div",{className:"equipment-list",children:_.map((le,se)=>{const Ee=C[le.EQT_CD]||[],Ne=le.SEL==="1";Ne&&["30","31","60"].includes(le.LENT);const ye=Ne&&le.LENT==="31",ne=ie(le);return s.jsxs("div",{className:`equipment-item ${Ne?"selected":""}`,children:[s.jsx("div",{className:"equipment-header",children:s.jsxs("label",{className:"checkbox-wrapper",children:[s.jsx("input",{type:"checkbox",checked:Ne,onChange:()=>j(se)}),s.jsxs("span",{className:"equipment-title",children:[le.EQT_NM,le.EQT_BASIC_YN==="Y"&&s.jsx("span",{className:"badge",children:""})]})]})}),Ne&&s.jsxs("div",{className:"equipment-details",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsx("div",{style:{flex:1},children:s.jsx(Zs,{value:le.EQT_CL||"",onValueChange:ue=>Q(se,"EQT_CL",ue),options:(()=>{const ue=(Ee||[]).map(xe=>({value:xe.EQT_CL_CD,label:xe.EQT_CL_NM}));return ue.length===0&&console.warn("  .",{eqtCd:le.EQT_CD,models:Ee}),ue})(),placeholder:""})})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsx("div",{style:{flex:1},children:s.jsx(Zs,{value:le.LENT||"10",onValueChange:ue=>Q(se,"LENT",ue),options:(()=>{let ue=pe(le,R||[]);ue.includes("31")&&(ie(le).some(bt=>bt.PRED==="1")||(ue=ue.filter(bt=>bt!=="31")));const xe=Re.filter(et=>ue.includes(et.value));return xe.length===0&&console.warn("   .",{eq:le,allowed:ue}),xe.map(et=>({value:et.value,label:et.label}))})(),placeholder:""})})]}),ye&&s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsx("div",{style:{flex:1},children:s.jsx(Zs,{value:le.ITLLMT_PRD||"00",onValueChange:ue=>Q(se,"ITLLMT_PRD",ue),options:(()=>{const ue=[{value:"00",label:""},...ne.map(xe=>({value:xe.INSTL_PERD,label:`${xe.INSTL_PERD}`}))];return ne.length===0&&console.warn("  .",{eq:le,installmentPeriods:ne}),ue})(),placeholder:""})})]}),le.EQT_SALE_AMT>0&&s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsxs("span",{className:"price",children:[le.EQT_SALE_AMT.toLocaleString(),""]})]})]}),!Ne&&s.jsxs("div",{className:"equipment-summary",children:[s.jsx("span",{className:"tag",children:fe(le.LENT)}),s.jsx("span",{className:"tag",children:de(le.EQT_USE_STAT_CD)})]})]},se)})})]})]})})})},Ah=({isOpen:t,onClose:e,ctrtId:n})=>{const[r,i]=x.useState([]),[l,c]=x.useState(!1),[d,u]=x.useState(null),f=async()=>{if(!n){console.error("[LDAP] ID ");return}c(!0),u(null);try{console.log("[LDAP]   CTRT_ID:",n);const y=await Cb(n);console.log("[LDAP]  :",y),i(y.data||[])}catch(y){console.error("[LDAP]  :",y),u(y instanceof Error?y.message:"   ")}finally{c(!1)}};x.useEffect(()=>{t&&n&&f()},[t,n]);const m=s.jsxs("div",{className:"text-xs text-gray-700 space-y-0.5",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-600",children:"ID:"})," ",s.jsx("span",{className:"font-medium text-blue-700",children:Qi(n)})]}),s.jsx("div",{className:"text-gray-600",children:"LGU+ LDAP  "})]}),_=s.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:""});return s.jsx(_a,{isOpen:t,onClose:e,title:"LDAP",size:"medium",subHeader:m,footer:_,children:s.jsxs("div",{children:[l&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:" ..."})}),d&&s.jsx("div",{className:"flex items-center justify-center py-8 px-4",children:s.jsx("div",{className:"text-red-500 text-xs text-center",children:d})}),!l&&!d&&r.length===0&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:"LDAP  "})}),!l&&!d&&r.length>0&&s.jsx("div",{className:"space-y-2.5 p-2.5",children:r.map((y,g)=>s.jsx("div",{className:`rounded-lg border shadow-sm p-2.5 ${g%2===0?"bg-white border-gray-200":"bg-gray-50 border-gray-200"}`,children:s.jsxs("div",{className:"space-y-1.5",children:[y.ONT_EQT_NO&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"ONT :"})," ",y.ONT_EQT_NO]})}),y.ONT_MAC_ADDR&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"ONT MAC:"})," ",y.ONT_MAC_ADDR]})}),y.AP_EQT_NO&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"AP :"})," ",y.AP_EQT_NO]})}),y.AP_MAC_ADDR&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"AP MAC:"})," ",y.AP_MAC_ADDR]})}),y.PROC_DV_CD&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",y.PROC_DV_CD]})}),y.PRSS_RSLT_CD&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",s.jsx("span",{className:y.PRSS_RSLT_CD==="0000"?"text-green-600":"text-red-600",children:y.PRSS_RSLT_CD})]})}),y.PRSS_RSLT_MSG&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",y.PRSS_RSLT_MSG]})}),y.REG_DTTM&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",y.REG_DTTM]})})]})},g))})]})})},kh=t=>({"01":"","02":"","03":"A/S","04":"","05":"","06":"","07":"","08":"","09":""})[t||""]||"",Cu=t=>({10:"",20:"",30:"",40:"",90:""})[t||""]||"",qU=["091001","091005","091006","091401","092401","090251"],Mg=t=>!t||["01","05","06","07","09"].includes(t)?"01":["02","08"].includes(t)?"02":t==="03"?"03":t==="04"?"04":"01",yN=t=>t.LENT_YN==="40"||t.VOIP_CUSTOWN_EQT==="Y"||t.eqtClCd==="090852",ZD=t=>`equipment_draft_${t}`,eR=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var at;const g=t.id,N=c||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:C}=$i(),{initWorkState:v,setApiData:R,setDataLoaded:U,addInstalledEquipment:L,removeInstalledEquipment:w,setInstalledEquipments:P,clearInstalledEquipments:G,setSelectedContract:K,setSelectedStock:B,setSignalStatus:O,setSignalResult:S}=ji(),{contractEquipments:A,technicianEquipments:Y,installedEquipments:te,selectedContract:J,selectedStock:q,signalStatus:V,signalResult:F,filteringData:I,isReady:ee}=oa(g),[ae,T]=x.useState(!1),[j,k]=x.useState(!1),[Q,H]=x.useState(!1),[$,ie]=x.useState(!1),[fe,pe]=x.useState(!1),[de,Re]=x.useState(!1),[X,_e]=x.useState(!1),[me,Z]=x.useState(0);x.useEffect(()=>{if(ee&&(te.length>0||A.length>0)){console.log("[-]    -   ");return}v(g),le()},[t.id]);const le=async(We=!1)=>{var Dt,Tt,St,ze,dt,Ke;try{let rt;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!We)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),rt=i;else{We?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const ge=localStorage.getItem("userInfo");if(!ge){console.error("  .");return}const Be=JSON.parse(ge),ce=t.WRK_CD||"",Le=t.WRK_DTL_TCD||"",Xe={WRKR_ID:t.WRKR_ID||Be.userId||Be.workerId||"",SO_ID:t.SO_ID||Be.soId,WRK_ID:t.id,CUST_ID:(Dt=t.customer)==null?void 0:Dt.id,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ce,WRK_DTL_TCD:Le,WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-]    (API )"),console.log("[-] :",Xe),rt=await to(Xe),We&&l&&(console.log("[-]   preloadedData "),l(rt))}console.log("[-] :"),console.log("  -  (output2):",((Tt=rt.contractEquipments)==null?void 0:Tt.length)||0,""),console.log("  -  (output3):",((St=rt.technicianEquipments)==null?void 0:St.length)||0,""),console.log("  -  (output4):",((ze=rt.customerEquipments)==null?void 0:ze.length)||0,"");const Ot={kpiProdGrpCd:rt.kpiProdGrpCd,prodChgGb:rt.prodChgGb,chgKpiProdGrpCd:rt.chgKpiProdGrpCd,prodGrp:rt.prodGrp};C(Ot),window.__equipmentFilterData=Ot;const mt=(rt.contractEquipments||[]).map(ge=>({id:ge.SVC_CMPS_ID||ge.PROD_CMPS_ID,type:ge.ITEM_MID_NM||ge.EQT_NM,model:ge.EQT_CL_NM,serialNumber:"N/A",itemMidCd:ge.ITEM_MID_CD,eqtClCd:ge.EQT_CL_CD||ge.EQT_CL,SVC_CMPS_ID:ge.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ge.BASIC_PROD_CMPS_ID,PROD_CD:ge.PROD_CD,SVC_CD:ge.SVC_CD})),Ze=(rt.technicianEquipments||[]).map(ge=>({id:ge.EQT_NO,type:ge.ITEM_MID_NM,model:ge.EQT_CL_NM,serialNumber:ge.EQT_SERNO,itemMidCd:ge.ITEM_MID_CD,eqtClCd:ge.EQT_CL_CD||ge.EQT_CL,macAddress:ge.MAC_ADDRESS,SVC_CMPS_ID:ge.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ge.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:ge.EQT_PROD_CMPS_ID,PROD_CD:ge.PROD_CD,SVC_CD:ge.SVC_CD,EQT_SALE_AMT:ge.EQT_SALE_AMT,MST_SO_ID:ge.MST_SO_ID,SO_ID:ge.SO_ID,OLD_LENT_YN:ge.OLD_LENT_YN,LENT:ge.LENT,ITLLMT_PRD:ge.ITLLMT_PRD,EQT_USE_STAT_CD:ge.EQT_USE_STAT_CD})),De=new Set,Ye=(rt.customerEquipments||[]).map(ge=>{const Be=mt.find(ce=>ce.itemMidCd===ge.ITEM_MID_CD&&!De.has(ce.id));return Be&&De.add(Be.id),{contractEquipment:Be||{id:"unknown",type:ge.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:ge.ITEM_MID_CD},actualEquipment:{id:ge.EQT_NO,type:ge.ITEM_MID_NM,model:ge.EQT_CL_NM,serialNumber:ge.EQT_SERNO,itemMidCd:ge.ITEM_MID_CD,macAddress:ge.MAC_ADDRESS||ge.MAC_ADDR,EQT_KND:ge.EQT_KND,EQT_CL_CD:ge.EQT_CL_CD},macAddress:ge.MAC_ADDRESS||ge.MAC_ADDR,installLocation:ge.INSTL_LCTN}});console.log("[-]  :"),console.log("  -  :",mt.length,""),console.log("  -  :",Ze.length,""),console.log("  -  :",Ye.length,""),R(g,{contractEquipments:mt,technicianEquipments:Ze,filteringData:Ot}),Z(Ye.length);const Ce=ji.getState().getWorkState(g);Ye.length>0&&!((dt=Ce==null?void 0:Ce.installedEquipments)!=null&&dt.length)?(console.log("[-] API     :",Ye.length,""),P(g,Ye)):(Ke=Ce==null?void 0:Ce.installedEquipments)!=null&&Ke.length,requestAnimationFrame(()=>U(g,!0))}catch(rt){console.error("[-]    :",rt),R(g,{contractEquipments:[],technicianEquipments:[]}),P(g,[]),requestAnimationFrame(()=>U(g,!0))}},se=x.useCallback(We=>{const Dt=te.find(Tt=>Tt.contractEquipment.id===We.id);(J==null?void 0:J.id)===We.id?(K(g,null),B(g,null)):(K(g,We),Dt?B(g,Dt.actualEquipment):B(g,null))},[g,te,J]),Ee=x.useCallback(We=>{(q==null?void 0:q.id)===We.id?B(g,null):B(g,We)},[g,q]),Ne=x.useCallback(()=>{if(!J||!q)return;if(J.itemMidCd!==q.itemMidCd||J.model!==q.model){r==null||r("      .","warning");return}console.log("[-]  :",{:J.type,:`${q.type} (S/N: ${q.serialNumber})`});const We={contractEquipment:J,actualEquipment:q,macAddress:q.macAddress||"",installLocation:""};L(g,We),O(g,"idle"),B(g,null)},[g,J,q]),ye=async(We,Dt)=>{try{const Tt=localStorage.getItem("userInfo");if(!Tt){r==null||r("  .","error");return}const St=JSON.parse(Tt),ze=We.map((Ke,rt)=>{let ft=Ke.ITEM_MID_CD||Ke.ITM_MID_CD||Ke.EQT||Ke.EQT_CD||"",Ot=Ke.EQT_CL||Ke.EQT_CL_CD||"",mt=Ke.SVC_CMPS_ID||Ke.PROD_CMPS_ID||Ke.SVC_CMPS_SEQ||Ke.EQUIP_SEQ||"";return ft=String(ft).trim().padStart(2,"0"),Ot=String(Ot).trim().padStart(6,"0"),mt=String(mt||rt+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||St.crrId||"",WRKR_ID:t.WRKR_ID||St.userId||St.workerId||"",REG_UID:St.userId||St.workerId||"A20130708",ITEM_MID_CD:ft,EQT_CL:Ot,SVC_CMPS_ID:mt,EQT:ft,EQT_CD:ft,LENT:String(Ke.LENT||"10"),EQT_USE_STAT_CD:String(Ke.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Ke.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Ke.EQT_SALE_AMT||0),PROD_GRP:String(Ke.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Ke.PROD_CD||t.PROD_CD||""),SVC_CD:String(Ke.SVC_CD||""),PROM_CNT:Dt||"",SEL:"1",EQT_BASIC_YN:String(Ke.EQT_BASIC_YN||"N"),PROD_TYP:Ke.PROD_TYP,EQUIP_SEQ:Ke.EQUIP_SEQ}}),dt=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:Dt||"",equipments:ze});if(dt.MSGCODE==="SUCCESS"||dt.MSGCODE==="0"||dt.code==="SUCCESS")r==null||r("  .","success"),G(g),B(g,null),await le(!0);else throw new Error(dt.MESSAGE||dt.message||"   .")}catch(Tt){throw console.error("[-]    :",Tt),r==null||r(Tt.message||"     .","error",!0),Tt}},ne=We=>te.find(Dt=>{var St,ze;return(((St=Dt.actualEquipment)==null?void 0:St.itemMidCd)||((ze=Dt.actualEquipment)==null?void 0:ze.ITEM_MID_CD)||"")===We}),ue=()=>{var rt,ft,Ot,mt,Ze,De,Ye,Ce,ge,Be,ce,Le,Xe,Pe;const We=t.PROD_GRP||"";if(t.VOIP_PROD_CD||""){const Ct=ne("08");return Ct?{eqtNo:((rt=Ct.actualEquipment)==null?void 0:rt.id)||((ft=Ct.actualEquipment)==null?void 0:ft.EQT_NO)||"",itemMidCd:"08"}:null}const Tt=ne("05");if(Tt)return{eqtNo:((Ot=Tt.actualEquipment)==null?void 0:Ot.id)||((mt=Tt.actualEquipment)==null?void 0:mt.EQT_NO)||"",itemMidCd:"05"};const St=ne("01");if(St)return{eqtNo:((Ze=St.actualEquipment)==null?void 0:Ze.id)||((De=St.actualEquipment)==null?void 0:De.EQT_NO)||"",itemMidCd:"01"};const ze=ne("03");if(ze)return{eqtNo:((Ye=ze.actualEquipment)==null?void 0:Ye.id)||((Ce=ze.actualEquipment)==null?void 0:Ce.EQT_NO)||"",itemMidCd:"03"};if(We==="I"){const Ct=ne("02");if(Ct)return{eqtNo:((ge=Ct.actualEquipment)==null?void 0:ge.id)||((Be=Ct.actualEquipment)==null?void 0:Be.EQT_NO)||"",itemMidCd:"02"}}const dt=ne("08");if(dt)return{eqtNo:((ce=dt.actualEquipment)==null?void 0:ce.id)||((Le=dt.actualEquipment)==null?void 0:Le.EQT_NO)||"",itemMidCd:"08"};const Ke=ne("04");return Ke?{eqtNo:((Xe=Ke.actualEquipment)==null?void 0:Xe.id)||((Pe=Ke.actualEquipment)==null?void 0:Pe.EQT_NO)||"",itemMidCd:"04"}:null},xe=()=>(t.PROD_GRP||"")==="V"?"SMR60":"SMR03",et=async()=>{var ft,Ot;const We=mt=>{var Ce,ge,Be;const Ze=((Ce=mt.actualEquipment)==null?void 0:Ce.eqtClCd)||mt.eqtClCd||"",De=((ge=mt.actualEquipment)==null?void 0:ge.itemMidCd)||mt.itemMidCd||"",Ye=(((Be=mt.actualEquipment)==null?void 0:Be.type)||mt.type||"").toLowerCase();return!!(Ze.startsWith("0904")||De==="05"||Ye.includes("stb")||Ye.includes("")||Ye.includes(""))},Dt=mt=>{var Ce,ge,Be;const Ze=((Ce=mt.actualEquipment)==null?void 0:Ce.eqtClCd)||mt.eqtClCd||"",De=((ge=mt.actualEquipment)==null?void 0:ge.itemMidCd)||mt.itemMidCd||"",Ye=(((Be=mt.actualEquipment)==null?void 0:Be.type)||mt.type||"").toLowerCase();return!!(Ze.startsWith("0902")||De==="04"||Ye.includes("modem")||Ye.includes("")||Ye.includes(""))};if(te.length===0){r==null||r("    . STB    .","warning"),O(g,"fail");return}const Tt=t.PROD_GRP||"",St=t.VOIP_PROD_CD||"";if(Tt==="V"&&!St&&!t.CTRT_JOIN_ID){r==null||r("VoIP   .","warning"),O(g,"fail");return}const ze=t.ISP_PROD_CD||"";if(Tt==="I"&&ze&&!t.CTRT_JOIN_ID){r==null||r("  ISP .   .","warning"),O(g,"fail");return}const dt=ue(),Ke=te.some(We),rt=te.some(Dt);if(!Ke&&!rt&&!dt){r==null||r("  STB    .","warning"),O(g,"fail");return}try{pe(!0),ie(!0),S(g," ...");const mt=localStorage.getItem("userInfo");if(!mt){S(g,"    ."),O(g,"fail"),pe(!1);return}const Ze=JSON.parse(mt),De=Ze.userId||Ze.id||"UNKNOWN",Ye=(dt==null?void 0:dt.eqtNo)||"",Ce=te.find(We),ge=te.find(Dt),Be=((ft=Ce==null?void 0:Ce.actualEquipment)==null?void 0:ft.id)||"",ce=((Ot=ge==null?void 0:ge.actualEquipment)==null?void 0:Ot.id)||"",Le=xe(),Xe=await Su(De,t.CTRT_ID||"",t.id,Le,Be||Ye,ce||"");Xe.O_IFSVC_RESULT&&Xe.O_IFSVC_RESULT.startsWith("TRUE")?(S(g,` 

: ${Xe.O_IFSVC_RESULT||""}`),O(g,"success")):(S(g,` 

${Xe.MESSAGE||"   "}`),O(g,"fail"))}catch(mt){S(g,` 

${mt.message||"   "}`),O(g,"fail")}finally{pe(!1)}},bt=x.useMemo(()=>{const We=new Set(te.map(Tt=>Tt.actualEquipment.id));let Dt=Y.filter(Tt=>!We.has(Tt.id));return J&&(Dt=Dt.filter(Tt=>Tt.itemMidCd===J.itemMidCd&&Tt.model===J.model)),Dt},[Y,te,J]),it=()=>{Re(!0),setTimeout(()=>{Re(!1),r==null||r("    .","info")},500)},At=async()=>{if(!(X||N)){_e(!0);try{await le(!0),r==null||r("  .","success")}catch(We){console.error("[-]  :",We),r==null||r("   .","error")}finally{_e(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4 relative",children:[X&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-20 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsx("button",{onClick:At,disabled:X||N,className:`p-1.5 rounded-lg transition-all ${X||N?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:s.jsx(Ei,{className:`w-4 h-4 ${X?"animate-spin":""}`})})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[A.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{N||T(!0)},disabled:N,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||N,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N||t.PROD_GRP==="V"?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-50":V==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":V==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>{if(t.PROD_GRP==="V"){r==null||r("VOIP    .","info");return}!N&&!fe&&et()},children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-orange-200 bg-orange-50 text-orange-600 hover:bg-orange-100 hover:border-orange-300 transition-all active:scale-95 min-h-[56px] opacity-50 cursor-not-allowed",disabled:!0,title:"     ",children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300 transition-all active:scale-95 min-h-[56px]",onClick:()=>H(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${t.PROD_GRP==="V"?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-50":"border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300"}`,onClick:()=>{if(t.PROD_GRP==="V"){r==null||r("VOIP    .","info");return}k(!0)},children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:""})]})]})]}),ee?A.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:A.map(We=>{const Dt=te.find(St=>St.contractEquipment.id===We.id),Tt=(J==null?void 0:J.id)===We.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${N?Dt?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Tt?"border-blue-500 bg-blue-50 cursor-pointer":Dt?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!N&&se(We),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:We.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:We.model})]}),Dt&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",Dt.actualEquipment.model]})}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",Dt.actualEquipment.serialNumber]}),Dt.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",Dt.macAddress]})]})]})},We.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!N&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!J||!te.some(We=>We.contractEquipment.id===(J==null?void 0:J.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-red-500 bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer active:scale-95"}`,onClick:()=>{J&&(w(g,J.id),O(g,"idle"),B(g,null),r==null||r("  .","info"))},disabled:!J||!te.some(We=>We.contractEquipment.id===(J==null?void 0:J.id)),title:"   ",children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!J||!q||te.some(We=>We.actualEquipment.id===q.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:Ne,disabled:!J||!q||te.some(We=>We.actualEquipment.id===q.id),title:"   ",children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!N&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 sm:p-4 border-b border-gray-100 gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",J&&s.jsxs("span",{className:"text-blue-600",children:[" (",J.type,")"]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[J?bt.length:0,""]})]}),J?bt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:bt.map(We=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(q==null?void 0:q.id)===We.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Ee(We),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:We.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:We.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",We.serialNumber]}),We.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",We.macAddress]})]})]}),(q==null?void 0:q.id)===We.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},We.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})]}),(()=>{var St;const We=t.WRK_CD_NM||kh(t.WRK_CD)||t.workType||"-",Dt=t.PROD_NM||t.productName||((St=t.customer)==null?void 0:St.productName)||"-",Tt=t.CTRT_STAT_NM||Cu(t.CTRT_STAT)||"-";return s.jsx(Ph,{isOpen:ae,onClose:()=>T(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:Tt,prodGrp:t.PROD_GRP||"",prodNm:Dt,wrkCdNm:We,onSave:ye,showToast:r,installedEquipmentCount:te.length})})(),!N&&s.jsx("button",{onClick:it,disabled:de,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${de?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:j,onClose:()=>k(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((at=t.customer)==null?void 0:at.id)}),s.jsx(Ah,{isOpen:Q,onClose:()=>H(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),$&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!fe&&ie(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:We=>We.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:fe?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):V==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:F})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:F})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${V==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>ie(!1),disabled:fe,children:fe?" ...":""})})]})}),document.body)]})},XU=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1})=>{const d=t.id,u=c||t.WRK_STAT_CD==="4"||t.status==="",{initWorkState:f,setApiData:m,setDataLoaded:_,toggleRemovalStatus:y,setFullRemovalStatus:g}=ji(),{removeEquipments:N,removalStatus:C,isReady:v}=oa(d),[R,U]=x.useState(!1);x.useEffect(()=>{if(v&&N.length>0){console.log("[-]    -   ");return}f(d),L()},[t.id]);const L=async(G=!1)=>{var K,B,O;try{console.log("[-]    - isWorkCompleted:",u,"WRK_STAT_CD:",t.WRK_STAT_CD);let S;if(i&&!G)console.log("[-] Pre-loaded   - API  "),S=i;else{const Y=localStorage.getItem("userInfo");if(!Y){console.error("  .");return}const te=JSON.parse(Y),J={WRKR_ID:t.WRKR_ID||te.userId||te.workerId||"",SO_ID:t.SO_ID||te.soId,WRK_ID:t.id,CUST_ID:((K=t.customer)==null?void 0:K.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"02",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-]    (API )"),console.log("[-] :",J),S=await to(J)}console.log("[-] :"),console.log("  -  (output5):",((B=S.removedEquipments)==null?void 0:B.length)||0,""),((O=S.removedEquipments)==null?void 0:O.length)>0&&console.log("[-]  API [0]:",S.removedEquipments[0]);const A=(S.removedEquipments||[]).map(Y=>({...Y,id:Y.EQT_NO,type:Y.ITEM_MID_NM,model:Y.EQT_CL_NM,serialNumber:Y.EQT_SERNO,itemMidCd:Y.ITEM_MID_CD,eqtClCd:Y.EQT_CL_CD||Y.EQT_CL,macAddress:Y.MAC_ADDRESS||Y.MAC_ADDR,installLocation:Y.INSTL_LCTN}));console.log("[-]  :"),console.log("  -  :",A.length,""),m(d,{removeEquipments:A}),requestAnimationFrame(()=>_(d,!0))}catch(S){console.error("[-]    :",S),r==null||r("   .","error",!0),m(d,{removeEquipments:[]}),requestAnimationFrame(()=>_(d,!0))}},w=(G,K)=>{y(d,G,K)},P=async()=>{if(!(R||u)){U(!0);try{await L(!0),r==null||r("  .","success")}catch(G){console.error("[-]  :",G),r==null||r("   .","error")}finally{U(!1)}}};return s.jsx("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[R&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(uc,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Ei,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-500"}),""]}),s.jsxs("button",{onClick:P,disabled:R||u,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${R||u?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(uc,{className:`w-3.5 h-3.5 ${R?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2 sm:px-2.5 py-0.5 sm:py-1 bg-orange-100 text-orange-700 text-[0.625rem] sm:text-xs font-semibold rounded-full",children:[N.length,""]})]}),N.length===0?s.jsx("div",{className:"py-12 text-center",children:s.jsx("div",{className:"text-sm text-gray-500",children:"   "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:N.map(G=>{const K=G.id,B=C[K]||{},O=yN(G);return s.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:G.model||G.type}),s.jsxs("div",{className:"text-xs text-gray-600",children:["S/N: ",G.serialNumber]}),G.macAddress&&s.jsxs("div",{className:"text-xs text-gray-500",children:["MAC: ",G.macAddress]})]}),s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:G.EQT_LOC_TP_NM||""})]}),!u&&!c&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${O?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_LOSS_YN==="1",onChange:()=>!O&&w(K,"EQT_LOSS_YN"),disabled:O,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${O?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.PART_LOSS_BRK_YN==="1",onChange:()=>!O&&w(K,"PART_LOSS_BRK_YN"),disabled:O,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${O?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_BRK_YN==="1",onChange:()=>!O&&w(K,"EQT_BRK_YN"),disabled:O,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${O?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_CABL_LOSS_YN==="1",onChange:()=>!O&&w(K,"EQT_CABL_LOSS_YN"),disabled:O,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${O?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_CRDL_LOSS_YN==="1",onChange:()=>!O&&w(K,"EQT_CRDL_LOSS_YN"),disabled:O,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]})]}),O&&!u&&s.jsx("div",{className:"mt-2 text-xs text-orange-600 bg-orange-50 p-2 rounded",children:"   "})]},G.id)})})]})})},JU=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var Ye;const g=t.id,N=c||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:C}=$i(),{initWorkState:v,setApiData:R,setDataLoaded:U,addInstalledEquipment:L,removeInstalledEquipment:w,setInstalledEquipments:P,clearInstalledEquipments:G,setSelectedContract:K,setSelectedStock:B,clearSelection:O,toggleRemovalStatus:S,addMarkedForRemoval:A,removeMarkedForRemoval:Y,setMarkedForRemoval:te,setPendingLossStatusList:J,setSignalStatus:q,setSignalResult:V,setFullRemovalStatus:F}=ji(),{contractEquipments:I,technicianEquipments:ee,removeEquipments:ae,installedEquipments:T,removalStatus:j,markedForRemoval:k,pendingLossStatusList:Q,selectedContract:H,selectedStock:$,signalStatus:ie,signalResult:fe,filteringData:pe,isReady:de}=oa(g),[Re,X]=x.useState(0),[_e,me]=x.useState("removal"),[Z,le]=x.useState(!1),[se,Ee]=x.useState(!1),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(!1),[xe,et]=x.useState(!1),[bt,it]=x.useState(!1),[At,at]=x.useState(!1);x.useEffect(()=>{if(de&&(T.length>0||k.length>0||I.length>0)){console.log("[-AS]    -   ");return}v(g),We()},[t.id]);const We=async(Ce=!1)=>{var ge,Be,ce,Le,Xe;try{let Pe;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Ce)console.log("[-AS] Pre-loaded   -",i.contractEquipments.length," "),Pe=i;else{Ce?console.log("[-AS]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-AS] preloadedApiData   - API ");const Ue=localStorage.getItem("userInfo");if(!Ue){console.error("  .");return}const ss=JSON.parse(Ue),ls=Mg(t.WRK_CD),ds={WRKR_ID:t.WRKR_ID||ss.userId||ss.workerId||"",SO_ID:t.SO_ID||ss.soId,WRK_ID:t.id,CUST_ID:((ge=t.customer)==null?void 0:ge.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ls,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-AS] API :",ds),Pe=await to(ds),Ce&&l&&(console.log("[-AS]   preloadedData "),l(Pe))}console.log("[-AS] API :",{contractEquipments:((Be=Pe.contractEquipments)==null?void 0:Be.length)||0,technicianEquipments:((ce=Pe.technicianEquipments)==null?void 0:ce.length)||0,customerEquipments:((Le=Pe.customerEquipments)==null?void 0:Le.length)||0,removedEquipments:((Xe=Pe.removedEquipments)==null?void 0:Xe.length)||0});const Me={kpiProdGrpCd:Pe.kpiProdGrpCd,prodChgGb:Pe.prodChgGb,chgKpiProdGrpCd:Pe.chgKpiProdGrpCd,prodGrp:Pe.prodGrp};C(Me),window.__equipmentFilterData=Me;const lt=(Pe.contractEquipments||[]).map(Ue=>({id:Ue.SVC_CMPS_ID||Ue.PROD_CMPS_ID,type:Ue.ITEM_MID_NM||Ue.EQT_NM,model:Ue.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD})),ut=(Pe.technicianEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ue.EQT_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD,EQT_SALE_AMT:Ue.EQT_SALE_AMT,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,OLD_LENT_YN:Ue.OLD_LENT_YN,LENT:Ue.LENT,LENT_YN:Ue.LENT_YN,ITLLMT_PRD:Ue.ITLLMT_PRD,EQT_USE_STAT_CD:Ue.EQT_USE_STAT_CD})),jt=new Set,Ve=(Pe.customerEquipments||[]).map(Ue=>{const ss=lt.find(ls=>ls.itemMidCd===Ue.ITEM_MID_CD&&!jt.has(ls.id));return ss&&jt.add(ss.id),{contractEquipment:ss||{id:"unknown",type:Ue.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD},actualEquipment:{id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT},macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN}}),$t=(Pe.removedEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT}));if(R(g,{contractEquipments:lt,technicianEquipments:ut,removeEquipments:$t}),X(Ve.length),Ve.length>0){const Ue=new Set(k.map(Ns=>Ns.id)),ss=Ve.filter(Ns=>!Ue.has(Ns.actualEquipment.id)),ls=[],ds=[];if(ss.forEach(Ns=>{const ke=lt.find(ct=>ct.itemMidCd===Ns.actualEquipment.itemMidCd);ke&&ke.eqtClCd===Ns.actualEquipment.eqtClCd?ls.push(Ns):ds.push(Ns.actualEquipment)}),ds.length>0){const Ns=[...k,...ds.filter(ke=>!k.some(ct=>ct.id===ke.id))];te(g,Ns),console.log("[-AS]     :",ds.length,"")}console.log("[-AS] API    :",Ve.length,"   :",ls.length,",  :",ds.length,""),P(g,ls);const Ss=localStorage.getItem(ZD(t.id));if(Ss)try{const Ns=JSON.parse(Ss);Ns.lastSignalStatus&&q(g,Ns.lastSignalStatus),Ns.removalStatus&&Object.keys(Ns.removalStatus).length>0&&F(g,Ns.removalStatus),Ns.pendingLossStatusList&&Ns.pendingLossStatusList.length>0&&J(g,Ns.pendingLossStatusList)}catch{}}else{const Ue=localStorage.getItem(ZD(t.id));if(Ue)try{const ss=JSON.parse(Ue);ss.installedEquipments&&ss.installedEquipments.length>0&&(console.log("[-AS] localStorage  :",ss.installedEquipments.length,""),P(g,ss.installedEquipments)),ss.markedForRemoval&&ss.markedForRemoval.length>0&&te(g,ss.markedForRemoval),ss.removalStatus&&Object.keys(ss.removalStatus).length>0&&F(g,ss.removalStatus),ss.pendingLossStatusList&&ss.pendingLossStatusList.length>0&&J(g,ss.pendingLossStatusList),ss.lastSignalStatus&&q(g,ss.lastSignalStatus)}catch(ss){console.warn("[-AS] localStorage   :",ss)}}requestAnimationFrame(()=>U(g,!0))}catch(Pe){console.error("[-AS]    :",Pe),requestAnimationFrame(()=>U(g,!0))}},Dt=Ce=>{const ge=T.find(Be=>Be.contractEquipment.id===Ce.id&&Be.actualEquipment.eqtClCd===Ce.eqtClCd);(H==null?void 0:H.id)===Ce.id?(K(g,null),B(g,null)):(K(g,Ce),ge?B(g,ge.actualEquipment):B(g,null))},Tt=Ce=>{($==null?void 0:$.id)===Ce.id?B(g,null):B(g,Ce)},St=()=>{if(!H||!$)return;if(H.itemMidCd!==$.itemMidCd||H.model!==$.model){r==null||r("      .","warning");return}const Ce=t.CTRT_STAT;if(Ce&&Ce!=="20"){const Be=Cu(Ce);r==null||r(` ${Be}     .`,"error");return}const ge=T.findIndex(Be=>Be.contractEquipment.id===H.id);if(ge>=0){const Be=[...T];Be[ge]={contractEquipment:H,actualEquipment:$,macAddress:$.macAddress||"",installLocation:""},P(g,Be)}else{const Be={contractEquipment:H,actualEquipment:$,macAddress:$.macAddress||"",installLocation:""};P(g,[...T,Be])}q(g,"idle"),B(g,null)},ze=()=>{if(!$)return;const Ce=t.CTRT_STAT;if(Ce&&Ce!=="20"){const Le=Cu(Ce);r==null||r(` ${Le}     .`,"error");return}const ge=T.findIndex(Le=>Le.actualEquipment.id===$.id);if(ge>=0){const Le=[...T],Xe=Le.splice(ge,1)[0];P(g,Le);const Pe=Xe.actualEquipment;k.some(Me=>Me.id===Pe.id)||te(g,[...k,Pe]),q(g,"idle"),B(g,null);return}if(k.some(Le=>Le.id===$.id))return;ae.some(Le=>Le.id===$.id)&&te(g,[...k,$])},dt=async(Ce,ge)=>{try{const Be=localStorage.getItem("userInfo");if(!Be){r==null||r("  .","error");return}const ce=JSON.parse(Be),Le=Ce.map((Pe,Ct)=>{let Me=Pe.ITEM_MID_CD||Pe.ITM_MID_CD||Pe.EQT||Pe.EQT_CD||"",lt=Pe.EQT_CL||Pe.EQT_CL_CD||"",ut=Pe.SVC_CMPS_ID||Pe.PROD_CMPS_ID||Pe.SVC_CMPS_SEQ||Pe.EQUIP_SEQ||"";return Me=String(Me).trim().padStart(2,"0"),lt=String(lt).trim().padStart(6,"0"),ut=String(ut||Ct+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||ce.crrId||"",WRKR_ID:t.WRKR_ID||ce.userId||ce.workerId||"",REG_UID:ce.userId||ce.workerId||"A20130708",ITEM_MID_CD:Me,EQT_CL:lt,SVC_CMPS_ID:ut,EQT:Me,EQT_CD:Me,LENT:String(Pe.LENT||"10"),EQT_USE_STAT_CD:String(Pe.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Pe.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Pe.EQT_SALE_AMT||0),PROD_GRP:String(Pe.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Pe.PROD_CD||t.PROD_CD||""),SVC_CD:String(Pe.SVC_CD||""),PROM_CNT:ge||"",SEL:"1",EQT_BASIC_YN:String(Pe.EQT_BASIC_YN||"N"),PROD_TYP:Pe.PROD_TYP,EQUIP_SEQ:Pe.EQUIP_SEQ}}),Xe=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:ge||"",equipments:Le});if(Xe.MSGCODE==="SUCCESS"||Xe.MSGCODE==="0"||Xe.code==="SUCCESS"){r==null||r("  .","success");const Pe=T.filter(Ct=>!ee.some(Me=>Me.id===Ct.actualEquipment.id));if(Pe.length>0){const Ct=Pe.map(lt=>lt.actualEquipment),Me=[...k,...Ct.filter(lt=>!k.some(ut=>ut.id===lt.id))];te(g,Me),console.log("[]    :",Ct.length,"")}G(g),B(g,null),await We(!0)}else throw new Error(Xe.MESSAGE||Xe.message||"   .")}catch(Be){throw console.error("[] :",Be),r==null||r(Be.message||"     .","error",!0),Be}},Ke=async()=>{var Ce,ge,Be,ce;if(T.length===0){r==null||r("    .","warning"),q(g,"fail");return}try{et(!0),ue(!0),V(g," ...");const Le=localStorage.getItem("userInfo");if(!Le){V(g,"    ."),q(g,"fail"),et(!1);return}const Xe=JSON.parse(Le),Pe=Xe.userId||Xe.id||"UNKNOWN",Ct=Ue=>{var Ss,Ns,ke,ct,st;const ss=((Ss=Ue.actualEquipment)==null?void 0:Ss.eqtClCd)||Ue.eqtClCd||((Ns=Ue.actualEquipment)==null?void 0:Ns.EQT_CL_CD)||"",ls=((ke=Ue.actualEquipment)==null?void 0:ke.itemMidCd)||Ue.itemMidCd||((ct=Ue.actualEquipment)==null?void 0:ct.ITEM_MID_CD)||"",ds=(((st=Ue.actualEquipment)==null?void 0:st.type)||Ue.type||"").toLowerCase();return!!(ss.startsWith("0904")||ls==="02"||ds.includes("stb")||ds.includes(""))},Me=Ue=>{var Ss,Ns,ke,ct,st;const ss=((Ss=Ue.actualEquipment)==null?void 0:Ss.eqtClCd)||Ue.eqtClCd||((Ns=Ue.actualEquipment)==null?void 0:Ns.EQT_CL_CD)||"",ls=((ke=Ue.actualEquipment)==null?void 0:ke.itemMidCd)||Ue.itemMidCd||((ct=Ue.actualEquipment)==null?void 0:ct.ITEM_MID_CD)||"",ds=(((st=Ue.actualEquipment)==null?void 0:st.type)||Ue.type||"").toLowerCase();return!!(ss.startsWith("0902")||ls==="03"||ds.includes("modem")||ds.includes(""))},lt=T.find(Ct),ut=T.find(Me),jt=((Ce=lt==null?void 0:lt.actualEquipment)==null?void 0:Ce.id)||"",Ve=((ge=ut==null?void 0:ut.actualEquipment)==null?void 0:ge.id)||"",$t=await Su(Pe,t.CTRT_ID||"",t.id,"SMR03",jt||((ce=(Be=T[0])==null?void 0:Be.actualEquipment)==null?void 0:ce.id)||"",Ve||"");$t.O_IFSVC_RESULT&&$t.O_IFSVC_RESULT.startsWith("TRUE")?(V(g,` 

: ${$t.O_IFSVC_RESULT||""}`),q(g,"success")):(V(g,` 

${$t.MESSAGE||"   "}`),q(g,"fail"))}catch(Le){V(g,` 

${Le.message||"   "}`),q(g,"fail")}finally{et(!1)}},rt=(Ce,ge,Be)=>{const ce={...j,[Ce]:{...j[Ce]||{},[ge]:Be==="1"?"0":"1"}};F(g,ce)},ft=()=>{const Ce=new Set(T.map(Be=>Be.actualEquipment.id));let ge=ee.filter(Be=>!Ce.has(Be.id));return H&&(ge=ge.filter(Be=>Be.itemMidCd===H.itemMidCd&&Be.model===H.model)),ge},Ot=()=>{const Ce=new Set(T.map(Be=>Be.actualEquipment.id));let ge=k.filter(Be=>!Ce.has(Be.id));return H&&(ge=ge.filter(Be=>Be.itemMidCd===H.itemMidCd&&Be.model===H.model)),ge},mt=()=>{it(!0),setTimeout(()=>{it(!1),r==null||r("    .","info")},500)},Ze=async()=>{if(!(At||N)){at(!0);try{await We(!0),r==null||r("  .","success")}catch(Ce){console.error("[-AS]  :",Ce),r==null||r("   .","error")}finally{at(!1)}}},De=ft();return Ot(),s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[At&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsxs("button",{onClick:Ze,disabled:At||N,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${At||N?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ei,{className:`w-3.5 h-3.5 ${At?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[I.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{if(N)return;const Ce=t.CTRT_STAT;if(Ce&&Ce!=="20"){r==null||r("A/S   (20)   .","warning");return}le(!0)},disabled:N,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||N,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":ie==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":ie==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!N&&!xe&&Ke(),disabled:N||xe,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300 transition-all active:scale-95 min-h-[56px]",onClick:()=>d?ye(!0):Ee(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:d?"LDAP":""})]})]})]}),de?I.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:I.map(Ce=>{const ge=T.find(ce=>ce.contractEquipment.id===Ce.id&&ce.actualEquipment.eqtClCd===Ce.eqtClCd),Be=(H==null?void 0:H.id)===Ce.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${N?ge?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Be?"border-blue-500 bg-blue-50 cursor-pointer":ge?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!N&&Dt(Ce),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ce.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ce.model})]}),ge&&(()=>{const ce=ee.some(Le=>Le.id===ge.actualEquipment.id);return s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",ge.actualEquipment.model]}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ce?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:ce?"":""})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",ge.actualEquipment.serialNumber]}),ge.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",ge.macAddress]})]})})()]})},Ce.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!N&&s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!$||!T.some(Ce=>Ce.actualEquipment.id===($==null?void 0:$.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!$)return;if(ee.some(Le=>Le.id===$.id)){if(_e!=="stock"){r==null||r("  .   .","warning");return}const Le=T.findIndex(Xe=>Xe.actualEquipment.id===$.id);if(Le>=0){const Xe=[...T];Xe.splice(Le,1),P(g,Xe),B(g,null),console.log("=== [-]     ==="),console.log(":",Xe.map(Pe=>({type:Pe.actualEquipment.type,model:Pe.actualEquipment.model,serialNumber:Pe.actualEquipment.serialNumber,id:Pe.actualEquipment.id}))),console.log(":",k.map(Pe=>({type:Pe.type,model:Pe.model,serialNumber:Pe.serialNumber,id:Pe.id,removalStatus:j[Pe.id]||{}}))),r==null||r("  .","success")}return}const ge=T.findIndex(Le=>Le.actualEquipment.id===$.id);let Be=[...T],ce=[...k];if(ge>=0){const Xe=Be.splice(ge,1)[0].actualEquipment;ce.some(Ct=>Ct.id===Xe.id)||(ce=[...ce,Xe])}console.log("=== [-]     ==="),console.log(":",Be.map(Le=>({type:Le.actualEquipment.type,model:Le.actualEquipment.model,serialNumber:Le.actualEquipment.serialNumber,id:Le.actualEquipment.id}))),console.log(":",ce.map(Le=>({type:Le.type,model:Le.model,serialNumber:Le.serialNumber,id:Le.id,removalStatus:j[Le.id]||{}}))),ze(),me("removal")},disabled:!$||!T.some(Ce=>Ce.actualEquipment.id===($==null?void 0:$.id)),children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!$||T.some(Ce=>Ce.actualEquipment.id===($==null?void 0:$.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!$)return;if(k.some(Pe=>Pe.id===$.id)){if(H&&(H.itemMidCd!==$.itemMidCd||H.eqtClCd!==$.eqtClCd)){r==null||r("      .","warning");return}const Pe=H||I.find(Me=>Me.itemMidCd===$.itemMidCd&&Me.eqtClCd===$.eqtClCd);if(!Pe){r==null||r("      .   .","warning");return}if(T.find(Me=>Me.contractEquipment.id===Pe.id&&!ee.some(lt=>lt.id===Me.actualEquipment.id))){r==null||r("   .","warning");return}if(Pe){const Me={contractEquipment:Pe,actualEquipment:$,macAddress:$.macAddress},lt=[...T,Me],ut=k.filter(Ve=>Ve.id!==$.id);P(g,lt),te(g,ut);const jt={...j};delete jt[$.id],F(g,jt),B(g,null),console.log("=== [-]     ==="),console.log(":",lt.map(Ve=>({type:Ve.actualEquipment.type,model:Ve.actualEquipment.model,serialNumber:Ve.actualEquipment.serialNumber,id:Ve.actualEquipment.id}))),console.log(":",ut.map(Ve=>({type:Ve.type,model:Ve.model,serialNumber:Ve.serialNumber,id:Ve.id,removalStatus:jt[Ve.id]||{}}))),r==null||r("   .","success")}else r==null||r("    .","error");return}if(!H){r==null||r("   .","warning");return}const ge=T.find(Pe=>Pe.contractEquipment.itemMidCd===H.itemMidCd&&!ee.some(Ct=>Ct.id===Pe.actualEquipment.id)),Be=ge&&k.some(Pe=>Pe.id===ge.actualEquipment.id);if(ge&&!Be){r==null||r("   .","warning");return}const ce={contractEquipment:H,actualEquipment:$,macAddress:$.macAddress||""},Le=T.findIndex(Pe=>Pe.contractEquipment.id===H.id);let Xe;Le>=0?(Xe=[...T],Xe[Le]=ce):Xe=[...T,ce],console.log("=== [-]     ==="),console.log(":",Xe.map(Pe=>({type:Pe.actualEquipment.type,model:Pe.actualEquipment.model,serialNumber:Pe.actualEquipment.serialNumber,id:Pe.actualEquipment.id}))),console.log(":",k.map(Pe=>({type:Pe.type,model:Pe.model,serialNumber:Pe.serialNumber,id:Pe.id,removalStatus:j[Pe.id]||{}}))),St()},disabled:!$||T.some(Ce=>Ce.actualEquipment.id===($==null?void 0:$.id)),children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!N&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${_e==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>me("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),k.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${_e==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:k.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${_e==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>me("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),H&&De.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${_e==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:De.length})]})})]}),_e==="removal"?s.jsx(s.Fragment,{children:k.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:k.map((Ce,ge)=>{const Be=Ce.id,ce=j[Be]||{},Le=ce.EQT_LOSS_YN==="1"||ce.PART_LOSS_BRK_YN==="1"||ce.EQT_BRK_YN==="1"||ce.EQT_CABL_LOSS_YN==="1"||ce.EQT_CRDL_LOSS_YN==="1",Xe=($==null?void 0:$.id)===Ce.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Xe?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>Tt(Ce),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ce.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Ce.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Ce.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${Le?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:Le?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(Pe=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${ce[Pe.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Ct=>{Ct.stopPropagation(),rt(Be,Pe.key,ce[Pe.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:ce[Pe.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:Pe.label})]},Pe.key))})]},Be||ge)})})}):s.jsx(s.Fragment,{children:H?De.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:De.map(Ce=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${($==null?void 0:$.id)===Ce.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Tt(Ce),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ce.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ce.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Ce.serialNumber]}),Ce.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Ce.macAddress]})]})]}),($==null?void 0:$.id)===Ce.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Ce.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var ce;const Ce=t.WRK_CD_NM||kh(t.WRK_CD)||t.workType||"-",ge=t.PROD_NM||t.productName||((ce=t.customer)==null?void 0:ce.productName)||"-",Be=t.CTRT_STAT_NM||Cu(t.CTRT_STAT)||"-";return s.jsx(Ph,{isOpen:Z,onClose:()=>le(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:Be,prodGrp:t.PROD_GRP||"",prodNm:ge,wrkCdNm:Ce,onSave:dt,showToast:r,installedEquipmentCount:T.length})})(),!N&&s.jsx("button",{onClick:mt,disabled:bt,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${bt?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:se,onClose:()=>Ee(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((Ye=t.customer)==null?void 0:Ye.id)}),s.jsx(Ah,{isOpen:Ne,onClose:()=>ye(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),ne&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!xe&&ue(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Ce=>Ce.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:xe?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):ie==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:fe})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:fe})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${ie==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>ue(!1),disabled:xe,children:xe?" ...":""})})]})}),document.body)]})},ZU=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var Ze;const g=t.id,N=c||t.WRK_STAT_CD==="4"||t.status==="",C=t.WRK_DTL_TCD==="0440",{setFilteringData:v}=$i(),{initWorkState:R,setApiData:U,setDataLoaded:L,addInstalledEquipment:w,removeInstalledEquipment:P,setInstalledEquipments:G,setSelectedContract:K,setSelectedStock:B,clearSelection:O,toggleRemovalStatus:S,setFullRemovalStatus:A,addMarkedForRemoval:Y,removeMarkedForRemoval:te,setMarkedForRemoval:J,setSignalStatus:q,setSignalResult:V}=ji(),{contractEquipments:F,technicianEquipments:I,removeEquipments:ee,installedEquipments:ae,markedForRemoval:T,removalStatus:j,selectedContract:k,selectedStock:Q,signalStatus:H,signalResult:$,filteringData:ie,isReady:fe}=oa(g),[pe,de]=x.useState(0),[Re,X]=x.useState("removal"),[_e,me]=x.useState(!1),[Z,le]=x.useState(!1),[se,Ee]=x.useState(!1),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(!1),[xe,et]=x.useState(!1),[bt,it]=x.useState(!1);x.useEffect(()=>{if(fe&&(ae.length>0||T.length>0||F.length>0)){console.log("[-]    -   ");return}R(g),At()},[t.id]);const At=async(De=!1)=>{var Ye,Ce,ge,Be,ce;try{let Le;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!De)console.log("[-Suspension] Pre-loaded   -",i.contractEquipments.length," "),Le=i;else{De?console.log("[-Suspension]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-Suspension] preloadedApiData   - API ");const Ue=localStorage.getItem("userInfo");if(!Ue){console.error("  .");return}const ss=JSON.parse(Ue),ls=Mg(t.WRK_CD),ds={WRKR_ID:t.WRKR_ID||ss.userId||ss.workerId||"",SO_ID:t.SO_ID||ss.soId,WRK_ID:t.id,CUST_ID:((Ye=t.customer)==null?void 0:Ye.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ls,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-Suspension] API :",ds),Le=await to(ds),De&&l&&(console.log("[-Suspension]   preloadedData "),l(Le))}console.log("[-Suspension] API :",{contractEquipments:((Ce=Le.contractEquipments)==null?void 0:Ce.length)||0,technicianEquipments:((ge=Le.technicianEquipments)==null?void 0:ge.length)||0,customerEquipments:((Be=Le.customerEquipments)==null?void 0:Be.length)||0,removedEquipments:((ce=Le.removedEquipments)==null?void 0:ce.length)||0});const Pe={kpiProdGrpCd:Le.kpiProdGrpCd,prodChgGb:Le.prodChgGb,chgKpiProdGrpCd:Le.chgKpiProdGrpCd,prodGrp:Le.prodGrp};v(Pe),window.__equipmentFilterData=Pe;const Ct=(Le.contractEquipments||[]).map(Ue=>({id:Ue.SVC_CMPS_ID||Ue.PROD_CMPS_ID,type:Ue.ITEM_MID_NM||Ue.EQT_NM,model:Ue.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD})),Me=(Le.technicianEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ue.EQT_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD,EQT_SALE_AMT:Ue.EQT_SALE_AMT,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,OLD_LENT_YN:Ue.OLD_LENT_YN,LENT:Ue.LENT,LENT_YN:Ue.LENT_YN,ITLLMT_PRD:Ue.ITLLMT_PRD,EQT_USE_STAT_CD:Ue.EQT_USE_STAT_CD})),lt=new Set,ut=(Le.customerEquipments||[]).map(Ue=>{const ss=Ct.find(ls=>ls.itemMidCd===Ue.ITEM_MID_CD&&!lt.has(ls.id));return ss&&lt.add(ss.id),{contractEquipment:ss||{id:"unknown",type:Ue.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD},actualEquipment:{id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT},macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN}}),jt=(Le.removedEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT}));U(g,{contractEquipments:Ct,technicianEquipments:Me,removeEquipments:jt,filteringData:Pe}),de(ut.length);const Ve=T||[],$t=ae||[];if(ut.length>0)if(console.log("[-Suspension] API    :",ut.length,""),Ve.length>0){console.log("[-Suspension] Zustand  :",Ve.length,"");const Ue=new Set(Ve.map(ls=>ls.id)),ss=ut.filter(ls=>!Ue.has(ls.actualEquipment.id));console.log("[-Suspension]     :",ss.length,""),G(g,ss)}else{const Ue=new Set(Ct.map(ds=>ds.SVC_CMPS_ID).filter(Boolean)),ss=[],ls=[];ut.forEach(ds=>{const Ss=ds.actualEquipment.SVC_CMPS_ID,Ns=ds.actualEquipment.EQT_KND;Ss&&!Ue.has(Ss)&&Ns==="CUST"?ss.push(ds.actualEquipment):ls.push(ds)}),ss.length>0?(console.log("[-Suspension]  :      :",ss.length,""),J(g,ss),G(g,ls)):G(g,ut)}else $t.length>0&&console.log("[-Suspension] Zustand  :",$t.length,"");requestAnimationFrame(()=>L(g,!0))}catch(Le){console.error("[-Suspension]    :",Le),requestAnimationFrame(()=>L(g,!0))}},at=async(De,Ye)=>{try{const Ce=localStorage.getItem("userInfo");if(!Ce){r==null||r("  .","error");return}const ge=JSON.parse(Ce),Be=De.map((Le,Xe)=>{let Pe=Le.ITEM_MID_CD||Le.ITM_MID_CD||Le.EQT||Le.EQT_CD||"",Ct=Le.EQT_CL||Le.EQT_CL_CD||"",Me=Le.SVC_CMPS_ID||Le.PROD_CMPS_ID||Le.SVC_CMPS_SEQ||Le.EQUIP_SEQ||"";return Pe=String(Pe).trim().padStart(2,"0"),Ct=String(Ct).trim().padStart(6,"0"),Me=String(Me||Xe+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||ge.crrId||"",WRKR_ID:t.WRKR_ID||ge.userId||ge.workerId||"",REG_UID:ge.userId||ge.workerId||"A20130708",ITEM_MID_CD:Pe,EQT_CL:Ct,SVC_CMPS_ID:Me,EQT:Pe,EQT_CD:Pe,LENT:String(Le.LENT||"10"),EQT_USE_STAT_CD:String(Le.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Le.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Le.EQT_SALE_AMT||0),PROD_GRP:String(Le.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Le.PROD_CD||t.PROD_CD||""),SVC_CD:String(Le.SVC_CD||""),PROM_CNT:Ye||"",SEL:"1",EQT_BASIC_YN:String(Le.EQT_BASIC_YN||"N"),PROD_TYP:Le.PROD_TYP,EQUIP_SEQ:Le.EQUIP_SEQ}}),ce=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:Ye||"",equipments:Be});if(ce.MSGCODE==="SUCCESS"||ce.MSGCODE==="0"||ce.code==="SUCCESS")r==null||r("  .","success"),G(g,[]),J(g,[]),O(g),await At(!0);else throw new Error(ce.MESSAGE||ce.message||"   .")}catch(Ce){throw console.error("[-]    :",Ce),r==null||r(Ce.message||"     .","error",!0),Ce}},We=De=>{const Ye=ae.find(Ce=>Ce.contractEquipment.id===De.id);(k==null?void 0:k.id)===De.id?(K(g,null),B(g,null)):(K(g,De),Ye?B(g,Ye.actualEquipment):B(g,null))},Dt=()=>{if(!k||!Q)return;if(k.itemMidCd!==Q.itemMidCd||k.model!==Q.model){r==null||r("      .","warning");return}if(T.some(Be=>Be.id===Q.id)){St(Q);return}const Ye=ae.find(Be=>Be.contractEquipment.id===k.id&&!I.some(ce=>ce.id===Be.actualEquipment.id)),Ce=Ye&&T.some(Be=>Be.id===Ye.actualEquipment.id);if(Ye&&!Ce){r==null||r("   .","warning");return}const ge=ae.findIndex(Be=>Be.contractEquipment.id===k.id);if(ge>=0){const Be=[...ae];Be[ge]={contractEquipment:k,actualEquipment:Q,macAddress:Q.macAddress||"",installLocation:""},G(g,Be)}else{const Be={contractEquipment:k,actualEquipment:Q,macAddress:Q.macAddress||"",installLocation:""};G(g,[...ae,Be])}q(g,"idle"),B(g,null)},Tt=()=>{if(!Q)return;const De=ae.findIndex(ge=>ge.actualEquipment.id===Q.id);if(De>=0){const ge=[...ae],Be=ge.splice(De,1)[0];G(g,ge);const ce=Be.actualEquipment;T.some(Xe=>Xe.id===ce.id)||Y(g,ce),q(g,"idle"),B(g,null);return}if(T.some(ge=>ge.id===Q.id))return;ee.some(ge=>ge.id===Q.id)&&Y(g,Q)},St=De=>{if(T.findIndex(ce=>ce.id===De.id)===-1){r==null||r("       .","error");return}if(k&&(k.itemMidCd!==De.itemMidCd||k.model!==De.model)){r==null||r("      .","warning");return}const Ce=k||F.find(ce=>ce.itemMidCd===De.itemMidCd&&ce.model===De.model);if(!Ce){r==null||r("      .","warning");return}if(Ce&&ae.find(Le=>Le.contractEquipment.id===Ce.id&&!I.some(Xe=>Xe.id===Le.actualEquipment.id))){r==null||r("   .","warning");return}const ge={contractEquipment:Ce,actualEquipment:{...De,EQT_CHG_GB:"3"},macAddress:De.macAddress};G(g,[...ae,ge]),te(g,De.id);const Be={...j};delete Be[De.id],A(g,Be),B(g,null),console.log("[-Suspension]  :",De.model||De.type),r==null||r(" .","success")},ze=async()=>{var De,Ye,Ce,ge;if(ae.length===0){r==null||r("    .","warning"),q(g,"fail");return}try{et(!0),ue(!0),V(g," ...");const Be=localStorage.getItem("userInfo");if(!Be){V(g,"    ."),q(g,"fail"),et(!1);return}const ce=JSON.parse(Be),Le=ce.userId||ce.id||"UNKNOWN",Xe=Ve=>{var ls,ds,Ss,Ns,ke;const $t=((ls=Ve.actualEquipment)==null?void 0:ls.eqtClCd)||Ve.eqtClCd||((ds=Ve.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((Ss=Ve.actualEquipment)==null?void 0:Ss.itemMidCd)||Ve.itemMidCd||((Ns=Ve.actualEquipment)==null?void 0:Ns.ITEM_MID_CD)||"",ss=(((ke=Ve.actualEquipment)==null?void 0:ke.type)||Ve.type||"").toLowerCase();return!!($t.startsWith("0904")||Ue==="02"||ss.includes("stb")||ss.includes(""))},Pe=Ve=>{var ls,ds,Ss,Ns,ke;const $t=((ls=Ve.actualEquipment)==null?void 0:ls.eqtClCd)||Ve.eqtClCd||((ds=Ve.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((Ss=Ve.actualEquipment)==null?void 0:Ss.itemMidCd)||Ve.itemMidCd||((Ns=Ve.actualEquipment)==null?void 0:Ns.ITEM_MID_CD)||"",ss=(((ke=Ve.actualEquipment)==null?void 0:ke.type)||Ve.type||"").toLowerCase();return!!($t.startsWith("0902")||Ue==="03"||ss.includes("modem")||ss.includes(""))},Ct=ae.find(Xe),Me=ae.find(Pe),lt=((De=Ct==null?void 0:Ct.actualEquipment)==null?void 0:De.id)||"",ut=((Ye=Me==null?void 0:Me.actualEquipment)==null?void 0:Ye.id)||"",jt=await Su(Le,t.CTRT_ID||"",t.id,"SMR03",lt||((ge=(Ce=ae[0])==null?void 0:Ce.actualEquipment)==null?void 0:ge.id)||"",ut||"");jt.O_IFSVC_RESULT&&jt.O_IFSVC_RESULT.startsWith("TRUE")?(V(g,` 

: ${jt.O_IFSVC_RESULT||""}`),q(g,"success")):(V(g,` 

${jt.MESSAGE||"   "}`),q(g,"fail"))}catch(Be){V(g,` 

${Be.message||"   "}`),q(g,"fail")}finally{et(!1)}},dt=(De,Ye,Ce)=>{const ge={...j,[De]:{...j[De]||{},[Ye]:Ce==="1"?"0":"1"}};A(g,ge)},Ke=De=>{(Q==null?void 0:Q.id)===De.id?B(g,null):B(g,De)},rt=()=>{const De=new Set(ae.map(Ce=>Ce.actualEquipment.id));let Ye=I.filter(Ce=>!De.has(Ce.id));return k&&(Ye=Ye.filter(Ce=>Ce.itemMidCd===k.itemMidCd&&Ce.model===k.model)),Ye},ft=()=>{ye(!0),setTimeout(()=>{ye(!1),r==null||r("    .","info")},500)},Ot=async()=>{if(!(bt||N)){it(!0);try{await At(!0),r==null||r("  .","success")}catch(De){console.error("[-]  :",De),r==null||r("   .","error")}finally{it(!1)}}},mt=rt();return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[bt&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsxs("button",{onClick:Ot,disabled:bt||N,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${bt||N?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ei,{className:`w-3.5 h-3.5 ${bt?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[F.length,""]})]}),s.jsxs("div",{className:`grid gap-2 ${C?"grid-cols-3":"grid-cols-1"}`,children:[C&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{N||Ee(!0)},disabled:N,children:[s.jsx(_b,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||N,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":H==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":H==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!N&&!xe&&ze(),disabled:N||xe,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>d?le(!0):me(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:d?"LDAP":""})]})]})]}),fe?F.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:F.map(De=>{const Ye=ae.find(ge=>ge.contractEquipment.id===De.id),Ce=(k==null?void 0:k.id)===De.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${N?Ye?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":C?Ce?"border-blue-500 bg-blue-50 cursor-pointer":Ye?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer":Ye?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default"}`,onClick:()=>!N&&We(De),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:De.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:De.model})]}),Ye&&(()=>{const ge=I.some(Be=>Be.id===Ye.actualEquipment.id);return s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",Ye.actualEquipment.model]}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ge?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:ge?"":""})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",Ye.actualEquipment.serialNumber]}),Ye.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",Ye.macAddress]})]})})()]})},De.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!N&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!Q||!ae.some(De=>De.actualEquipment.id===Q.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!Q)return;if(I.some(Ye=>Ye.id===Q.id)){const Ye=ae.findIndex(Ce=>Ce.actualEquipment.id===Q.id);if(Ye>=0){const Ce=[...ae];Ce.splice(Ye,1),G(g,Ce),B(g,null),r==null||r("  .","success")}return}Tt(),X("removal")},disabled:!Q||!ae.some(De=>De.actualEquipment.id===Q.id),children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),C&&s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!k||!Q||ae.some(De=>De.actualEquipment.id===Q.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:Dt,disabled:!k||!Q||ae.some(De=>De.actualEquipment.id===Q.id),children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!N&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${Re==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>X("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),T.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${Re==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:T.length})]})}),C&&s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${Re==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>X("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),k&&mt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${Re==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:mt.length})]})})]}),Re==="removal"?s.jsx(s.Fragment,{children:T.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:T.map((De,Ye)=>{const Ce=De.id,ge=j[Ce]||{},Be=ge.EQT_LOSS_YN==="1"||ge.PART_LOSS_BRK_YN==="1"||ge.EQT_BRK_YN==="1"||ge.EQT_CABL_LOSS_YN==="1"||ge.EQT_CRDL_LOSS_YN==="1",ce=(Q==null?void 0:Q.id)===De.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${ce?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>Ke(De),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:De.type}),s.jsx("div",{className:"text-xs text-gray-600",children:De.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",De.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${Be?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:Be?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(Le=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${ge[Le.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Xe=>{Xe.stopPropagation(),dt(Ce,Le.key,ge[Le.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:ge[Le.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:Le.label})]},Le.key))})]},Ce||Ye)})})}):s.jsx(s.Fragment,{children:k?mt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:mt.map(De=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(Q==null?void 0:Q.id)===De.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Ke(De),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:De.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:De.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",De.serialNumber]}),De.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",De.macAddress]})]})]}),(Q==null?void 0:Q.id)===De.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},De.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),!N&&C&&s.jsx("button",{onClick:ft,disabled:Ne,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${Ne?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:_e,onClose:()=>me(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((Ze=t.customer)==null?void 0:Ze.id)}),s.jsx(Ah,{isOpen:Z,onClose:()=>le(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),C&&(()=>{const De=t.PROD_NM||t.details||"-",Ye=t.WRK_CD_NM||kh(t.WRK_CD)||"-";return s.jsx(Ph,{isOpen:se,onClose:()=>Ee(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",prodGrp:t.PROD_GRP||"",prodNm:De,wrkCdNm:Ye,onSave:at,showToast:r,installedEquipmentCount:ae.length})})(),ne&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!xe&&ue(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:De=>De.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:xe?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):H==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:$})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:$})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${H==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>ue(!1),disabled:xe,children:xe?" ...":""})})]})}),document.body)]})},e9=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var mt;const g=t.id,N=c||t.WRK_STAT_CD==="4"||t.status==="",[C,v]=x.useState(""),{setFilteringData:R}=$i(),{initWorkState:U,setApiData:L,setDataLoaded:w,setInstalledEquipments:P,setSelectedContract:G,setSelectedStock:K,toggleRemovalStatus:B,setFullRemovalStatus:O,addMarkedForRemoval:S,removeMarkedForRemoval:A,setMarkedForRemoval:Y,setSignalStatus:te,setSignalResult:J}=ji(),{contractEquipments:q,technicianEquipments:V,removeEquipments:F,installedEquipments:I,markedForRemoval:ee,removalStatus:ae,pendingLossStatusList:T,selectedContract:j,selectedStock:k,signalStatus:Q,signalResult:H,filteringData:$,isReady:ie}=oa(g),[fe,pe]=x.useState(0),[de,Re]=x.useState("removal"),[X,_e]=x.useState(!1),[me,Z]=x.useState(!1),[le,se]=x.useState(!1),[Ee,Ne]=x.useState(!1),[ye,ne]=x.useState(!1),[ue,xe]=x.useState(!1),[et,bt]=x.useState(!1),[it,At]=x.useState("");x.useEffect(()=>{const Ze=t.DTL_CTRT_ID||t.CTRT_ID;Ze&&g5(Ze,t.CUST_ID).then(De=>{De!=null&&De.BASIC_PROD_CD_NM&&At(De.BASIC_PROD_CD_NM)})},[t.DTL_CTRT_ID,t.CTRT_ID,t.CUST_ID]),x.useEffect(()=>{if(ie&&(I.length>0||ee.length>0||q.length>0)){console.log("[-]    -   ");return}U(g),at()},[t.id]);const at=async(Ze=!1)=>{var De,Ye,Ce,ge,Be;try{let ce;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Ze)console.log("[Equipment-ProductChange] Using preloadedApiData with",i.contractEquipments.length,"contract equipments"),ce=i;else{Ze?console.log("[Equipment-ProductChange] Force refresh - calling API"):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[Equipment-ProductChange] preloadedApiData has no contract equipments, calling API fresh");const Ue=localStorage.getItem("userInfo");if(!Ue){console.error("User info not found");return}const ss=JSON.parse(Ue),ls=t.DTL_CTRT_ID||t.CTRT_ID,ds={WRKR_ID:t.WRKR_ID||ss.userId||ss.workerId||"",SO_ID:t.SO_ID||ss.soId,WRK_ID:t.id,CUST_ID:((De=t.customer)==null?void 0:De.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:ls,OLD_CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"05",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[Equipment-ProductChange] API call (DTL_CTRT_ID ):",ds),ce=await to(ds),Ze&&l&&(console.log("[Equipment-ProductChange] Updating parent preloadedData"),l(ce))}console.log("[Equipment-ProductChange] API response:",{contractEquipments:((Ye=ce.contractEquipments)==null?void 0:Ye.length)||0,technicianEquipments:((Ce=ce.technicianEquipments)==null?void 0:Ce.length)||0,customerEquipments:((ge=ce.customerEquipments)==null?void 0:ge.length)||0,removedEquipments:((Be=ce.removedEquipments)==null?void 0:Be.length)||0});const Xe={kpiProdGrpCd:ce.kpiProdGrpCd,prodChgGb:ce.prodChgGb,chgKpiProdGrpCd:ce.chgKpiProdGrpCd,prodGrp:ce.prodGrp};R(Xe),window.__equipmentFilterData=Xe;const Pe=(ce.contractEquipments||[]).map(Ue=>({id:Ue.SVC_CMPS_ID||Ue.PROD_CMPS_ID,type:Ue.ITEM_MID_NM||Ue.EQT_NM,model:Ue.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD})),Ct=ce.chgResnCd||t.CHG_RESN_CD||"";v(Ct);let Me=(ce.technicianEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ue.EQT_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD,EQT_SALE_AMT:Ue.EQT_SALE_AMT,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,OLD_LENT_YN:Ue.OLD_LENT_YN,LENT:Ue.LENT,LENT_YN:Ue.LENT_YN,ITLLMT_PRD:Ue.ITLLMT_PRD,EQT_USE_STAT_CD:Ue.EQT_USE_STAT_CD,BAR_CD:Ue.BAR_CD,CHG_RESN_CD:Ue.CHG_RESN_CD}));Ct==="H08"&&(Me=Me.filter(Ue=>(Ue.itemMidCd!=="04",!0)),console.log("[Equipment-ProductChange] CHG_RESN_CD=H08 (ARPU) - STB BAR_CD  "));const lt=new Set,ut=(ce.customerEquipments||[]).map(Ue=>{const ss=Pe.find(ls=>ls.itemMidCd===Ue.ITEM_MID_CD&&!lt.has(ls.id));return ss&&lt.add(ss.id),{contractEquipment:ss||{id:"unknown",type:Ue.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD},actualEquipment:{id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT},macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN}}),jt=(ce.removedEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT}));L(g,{contractEquipments:Pe,technicianEquipments:Me,removeEquipments:jt,filteringData:Xe}),pe(ut.length),console.log("[Equipment-ProductChange] ====== Equipment Initialization Started ======");const Ve=I||[],$t=ee||[];if(ut.length>0?(console.log("[Equipment-ProductChange] Using customer equipment from API:",ut.length,"items"),P(g,ut)):Ve.length>0&&console.log("[Equipment-ProductChange] Zustand  :",Ve.length,""),jt.length>0&&$t.length===0)console.log("[Equipment-ProductChange] API output5  markedForRemoval :",jt.length,""),Y(g,jt);else if(jt.length>0){const Ue=new Set($t.map(ls=>ls.id)),ss=jt.filter(ls=>!Ue.has(ls.id));ss.length>0&&(console.log("[Equipment-ProductChange] API output5  :",ss.length," "),Y(g,[...$t,...ss]))}console.log("[Equipment-ProductChange] ====== Equipment Initialization Complete ======"),requestAnimationFrame(()=>w(g,!0))}catch(ce){console.error("[Equipment-ProductChange] Failed to load equipment data:",ce),requestAnimationFrame(()=>w(g,!0))}},We=Ze=>{const De=I.find(Ye=>Ye.contractEquipment.id===Ze.id);(j==null?void 0:j.id)===Ze.id?(G(g,null),K(g,null)):(G(g,Ze),De?K(g,De.actualEquipment):K(g,null))},Dt=Ze=>{(k==null?void 0:k.id)===Ze.id?K(g,null):K(g,Ze)},Tt=()=>{if(!j||!k)return;if(j.itemMidCd!==k.itemMidCd||j.model!==k.model){r==null||r("      .","warning");return}const Ze=F.some(Ce=>Ce.id===k.id);console.log("[Equipment-ProductChange] Registering equipment:",{contractEquipment:j.type,stockEquipment:`${k.type} (S/N: ${k.serialNumber})`,isReuse:Ze});const De=I.findIndex(Ce=>Ce.contractEquipment.id===j.id),Ye={...k,EQT_CHG_GB:Ze?"3":k.EQT_CHG_GB||"1"};if(De>=0){const Ce=[...I];Ce[De]={contractEquipment:j,actualEquipment:Ye,macAddress:k.macAddress||"",installLocation:""},P(g,Ce)}else{const Ce={contractEquipment:j,actualEquipment:Ye,macAddress:k.macAddress||"",installLocation:""};P(g,[...I,Ce])}Ze&&A(g,k.id),te(g,"idle"),K(g,null)},St=()=>{if(!k)return;const Ze=I.findIndex(Ce=>Ce.actualEquipment.id===k.id);if(Ze>=0){const Ce=[...I],ge=Ce.splice(Ze,1)[0];P(g,Ce);const Be=ge.actualEquipment;ee.some(Le=>Le.id===Be.id)||S(g,Be),te(g,"idle"),K(g,null);return}if(ee.some(Ce=>Ce.id===k.id))return;F.some(Ce=>Ce.id===k.id)&&S(g,k)},ze=async(Ze,De)=>{try{const Ye=localStorage.getItem("userInfo");if(!Ye){r==null||r("  .","error");return}const Ce=JSON.parse(Ye),ge=t.DTL_CTRT_ID||t.CTRT_ID,Be=Ze.map((Le,Xe)=>{let Pe=Le.ITEM_MID_CD||Le.ITM_MID_CD||Le.EQT||Le.EQT_CD||"",Ct=Le.EQT_CL||Le.EQT_CL_CD||"",Me=Le.SVC_CMPS_ID||Le.PROD_CMPS_ID||Le.SVC_CMPS_SEQ||Le.EQUIP_SEQ||"";return Pe=String(Pe).trim().padStart(2,"0"),Ct=String(Ct).trim().padStart(6,"0"),Me=String(Me||Xe+1),{CTRT_ID:ge,RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Ce.crrId||"",WRKR_ID:t.WRKR_ID||Ce.userId||Ce.workerId||"",REG_UID:Ce.userId||Ce.workerId||"A20130708",ITEM_MID_CD:Pe,EQT_CL:Ct,SVC_CMPS_ID:Me,EQT:Pe,EQT_CD:Pe,LENT:String(Le.LENT||"10"),EQT_USE_STAT_CD:String(Le.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Le.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Le.EQT_SALE_AMT||0),PROD_GRP:String(Le.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Le.PROD_CD||t.PROD_CD||""),SVC_CD:String(Le.SVC_CD||""),PROM_CNT:De||"",SEL:"1",EQT_BASIC_YN:String(Le.EQT_BASIC_YN||"N"),PROD_TYP:Le.PROD_TYP,EQUIP_SEQ:Le.EQUIP_SEQ}}),ce=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:ge,CRR_ID:t.CRR_ID||"",PROM_CNT:De||"",equipments:Be});if(ce.MSGCODE==="SUCCESS"||ce.MSGCODE==="0"||ce.code==="SUCCESS")r==null||r("  .","success"),await at(!0);else throw new Error(ce.MESSAGE||ce.message||"   .")}catch(Ye){throw console.error("[] :",Ye),r==null||r(Ye.message||"     .","error",!0),Ye}},dt=async()=>{var Ze,De,Ye,Ce;if(I.length===0){r==null||r("    .","warning"),te(g,"fail");return}try{ne(!0),Ne(!0),J(g," ...");const ge=localStorage.getItem("userInfo");if(!ge){J(g,"    ."),te(g,"fail"),ne(!1);return}const Be=JSON.parse(ge),ce=Be.userId||Be.id||"UNKNOWN",Le=Ve=>{var ls,ds,Ss,Ns,ke;const $t=((ls=Ve.actualEquipment)==null?void 0:ls.eqtClCd)||Ve.eqtClCd||((ds=Ve.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((Ss=Ve.actualEquipment)==null?void 0:Ss.itemMidCd)||Ve.itemMidCd||((Ns=Ve.actualEquipment)==null?void 0:Ns.ITEM_MID_CD)||"",ss=(((ke=Ve.actualEquipment)==null?void 0:ke.type)||Ve.type||"").toLowerCase();return!!($t.startsWith("0904")||Ue==="02"||ss.includes("stb")||ss.includes(""))},Xe=Ve=>{var ls,ds,Ss,Ns,ke;const $t=((ls=Ve.actualEquipment)==null?void 0:ls.eqtClCd)||Ve.eqtClCd||((ds=Ve.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((Ss=Ve.actualEquipment)==null?void 0:Ss.itemMidCd)||Ve.itemMidCd||((Ns=Ve.actualEquipment)==null?void 0:Ns.ITEM_MID_CD)||"",ss=(((ke=Ve.actualEquipment)==null?void 0:ke.type)||Ve.type||"").toLowerCase();return!!($t.startsWith("0902")||Ue==="03"||ss.includes("modem")||ss.includes(""))},Pe=I.find(Le),Ct=I.find(Xe),Me=((Ze=Pe==null?void 0:Pe.actualEquipment)==null?void 0:Ze.id)||"",lt=((De=Ct==null?void 0:Ct.actualEquipment)==null?void 0:De.id)||"",ut=t.DTL_CTRT_ID||t.CTRT_ID,jt=await Su(ce,ut,t.id,"SMR03",Me||((Ce=(Ye=I[0])==null?void 0:Ye.actualEquipment)==null?void 0:Ce.id)||"",lt||"");jt.O_IFSVC_RESULT&&jt.O_IFSVC_RESULT.startsWith("TRUE")?(J(g,` 

: ${jt.O_IFSVC_RESULT||""}`),te(g,"success")):(J(g,` 

${jt.MESSAGE||"   "}`),te(g,"fail"))}catch(ge){J(g,` 

${ge.message||"   "}`),te(g,"fail")}finally{ne(!1)}},Ke=(Ze,De)=>{B(g,Ze,De)},rt=x.useMemo(()=>{const Ze=new Set(I.map(Ye=>Ye.actualEquipment.id));let De=V.filter(Ye=>!Ze.has(Ye.id));return j&&(De=De.filter(Ye=>Ye.itemMidCd===j.itemMidCd&&Ye.model===j.model)),De},[I,V,j]);x.useMemo(()=>{const Ze=new Set(I.map(Ye=>Ye.actualEquipment.id));let De=ee.filter(Ye=>!Ze.has(Ye.id));return j&&(De=De.filter(Ye=>Ye.itemMidCd===j.itemMidCd&&Ye.model===j.model)),De},[I,ee,j]);const ft=()=>{xe(!0),setTimeout(()=>{xe(!1),r==null||r("    .","info")},500)},Ot=async()=>{if(!(et||N)){bt(!0);try{await at(!0),r==null||r("  .","success")}catch(Ze){console.error("[-]  :",Ze),r==null||r("   .","error")}finally{bt(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[et&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 gap-1",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900 truncate",children:["  ",it&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",it,")"]})]}),s.jsxs("button",{onClick:Ot,disabled:et||N,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${et||N?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ei,{className:`w-3.5 h-3.5 ${et?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[q.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{N||_e(!0)},disabled:N,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||N,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${N?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":Q==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":Q==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!N&&!ye&&dt(),disabled:N||ye,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300 transition-all active:scale-95 min-h-[56px]",onClick:()=>d?se(!0):Z(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:d?"LDAP":""})]})]})]}),ie?q.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:q.map(Ze=>{const De=I.find(Ce=>Ce.contractEquipment.id===Ze.id),Ye=(j==null?void 0:j.id)===Ze.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${N?De?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Ye?"border-blue-500 bg-blue-50 cursor-pointer":De?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!N&&We(Ze),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ze.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ze.model})]}),De&&(()=>{const Ce=V.some(ge=>ge.id===De.actualEquipment.id);return s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",De.actualEquipment.model]}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${Ce?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:Ce?"":""})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",De.actualEquipment.serialNumber]}),De.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",De.macAddress]})]})})()]})},Ze.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"  ..."})]})})]}),!N&&s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${t.WRK_DTL_TCD==="0510"||!k||!I.some(Ze=>Ze.actualEquipment.id===(k==null?void 0:k.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(t.WRK_DTL_TCD==="0510"||!k)return;if(V.some(ge=>ge.id===k.id)){if(de!=="stock"){r==null||r("  .   .","warning");return}const ge=I.findIndex(Be=>Be.actualEquipment.id===k.id);if(ge>=0){const Be=[...I];Be.splice(ge,1),P(g,Be),K(g,null),console.log("=== [-]     ==="),console.log(":",Be.map(ce=>({type:ce.actualEquipment.type,model:ce.actualEquipment.model,serialNumber:ce.actualEquipment.serialNumber,id:ce.actualEquipment.id}))),console.log(":",ee.map(ce=>({type:ce.type,model:ce.model,serialNumber:ce.serialNumber,id:ce.id,removalStatus:ae[ce.id]||{}}))),r==null||r("  .","success")}return}const De=I.findIndex(ge=>ge.actualEquipment.id===k.id);let Ye=[...I],Ce=[...ee];if(De>=0){const Be=Ye.splice(De,1)[0].actualEquipment;Ce.some(Le=>Le.id===Be.id)||(Ce=[...Ce,Be])}console.log("=== [-]     ==="),console.log(":",Ye.map(ge=>({type:ge.actualEquipment.type,model:ge.actualEquipment.model,serialNumber:ge.actualEquipment.serialNumber,id:ge.actualEquipment.id}))),console.log(":",Ce.map(ge=>({type:ge.type,model:ge.model,serialNumber:ge.serialNumber,id:ge.id,removalStatus:ae[ge.id]||{}}))),St(),Re("removal")},disabled:t.WRK_DTL_TCD==="0510"||!k||!I.some(Ze=>Ze.actualEquipment.id===(k==null?void 0:k.id)),children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!k||I.some(Ze=>Ze.actualEquipment.id===(k==null?void 0:k.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!k)return;if(ee.some(Be=>Be.id===k.id)){if(j&&(j.itemMidCd!==k.itemMidCd||j.eqtClCd!==k.eqtClCd)){r==null||r("      .","warning");return}const Be=j||q.find(Me=>Me.itemMidCd===k.itemMidCd&&Me.eqtClCd===k.eqtClCd);if(!Be){r==null||r("      .   .","warning");return}if(I.find(Me=>Me.contractEquipment.id===Be.id)){r==null||r("   .","warning");return}const Le={contractEquipment:Be,actualEquipment:k,macAddress:k.macAddress},Xe=[...I,Le],Pe=ee.filter(Me=>Me.id!==k.id);P(g,Xe),Y(g,Pe);const Ct={...ae};delete Ct[k.id],O(g,Ct),K(g,null),console.log("=== [-]     ==="),console.log(":",Xe.map(Me=>({type:Me.actualEquipment.type,model:Me.actualEquipment.model,serialNumber:Me.actualEquipment.serialNumber,id:Me.actualEquipment.id}))),console.log(":",Pe.map(Me=>({type:Me.type,model:Me.model,serialNumber:Me.serialNumber,id:Me.id,removalStatus:Ct[Me.id]||{}}))),r==null||r("   .","success");return}if(!j){r==null||r("   .","warning");return}if(I.find(Be=>Be.contractEquipment.id===j.id)){r==null||r("   .","warning");return}const Ye={contractEquipment:j,actualEquipment:k,macAddress:k.macAddress||""},Ce=I.findIndex(Be=>Be.contractEquipment.id===j.id);let ge;Ce>=0?(ge=[...I],ge[Ce]=Ye):ge=[...I,Ye],console.log("=== [-]     ==="),console.log(":",ge.map(Be=>({type:Be.actualEquipment.type,model:Be.actualEquipment.model,serialNumber:Be.actualEquipment.serialNumber,id:Be.actualEquipment.id}))),console.log(":",ee.map(Be=>({type:Be.type,model:Be.model,serialNumber:Be.serialNumber,id:Be.id,removalStatus:ae[Be.id]||{}}))),Tt()},disabled:!k||I.some(Ze=>Ze.actualEquipment.id===(k==null?void 0:k.id)),children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!N&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${de==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>Re("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),ee.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${de==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:ee.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${de==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>Re("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),j&&rt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${de==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:rt.length})]})})]}),de==="removal"?s.jsx(s.Fragment,{children:ee.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:ee.map((Ze,De)=>{const Ye=Ze.id,Ce=ae[Ye]||{},ge=Ce.EQT_LOSS_YN==="1"||Ce.PART_LOSS_BRK_YN==="1"||Ce.EQT_BRK_YN==="1"||Ce.EQT_CABL_LOSS_YN==="1"||Ce.EQT_CRDL_LOSS_YN==="1",Be=(k==null?void 0:k.id)===Ze.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Be?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>Dt(Ze),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ze.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Ze.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Ze.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${ge?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:ge?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(ce=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${Ce[ce.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Le=>{Le.stopPropagation(),Ke(Ye,ce.key)},children:[s.jsx("input",{type:"checkbox",checked:Ce[ce.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:ce.label})]},ce.key))})]},Ye||De)})})}):s.jsx(s.Fragment,{children:j?rt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:rt.map(Ze=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(k==null?void 0:k.id)===Ze.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Dt(Ze),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ze.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ze.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Ze.serialNumber]}),Ze.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Ze.macAddress]})]})]}),(k==null?void 0:k.id)===Ze.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Ze.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Ce;const Ze=t.WRK_CD_NM||kh(t.WRK_CD)||t.workType||"-",De=t.PROD_NM||t.productName||((Ce=t.customer)==null?void 0:Ce.productName)||"-",Ye=t.CTRT_STAT_NM||Cu(t.CTRT_STAT)||"-";return s.jsx(Ph,{isOpen:X,onClose:()=>_e(!1),prodCd:t.PROD_CD||"",ctrtId:t.DTL_CTRT_ID||t.CTRT_ID||"",ctrtStatNm:Ye,prodGrp:t.PROD_GRP||"",prodNm:De,wrkCdNm:Ze,onSave:ze,showToast:r,installedEquipmentCount:I.length,customerEquipmentCount:fe})})(),!N&&s.jsx("button",{onClick:ft,disabled:ue,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${ue?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:"Barcode Scan",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:me,onClose:()=>Z(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID,custId:t.CUST_ID||((mt=t.customer)==null?void 0:mt.id)}),s.jsx(Ah,{isOpen:le,onClose:()=>se(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),Ee&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!ye&&Ne(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Ze=>Ze.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:ye?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):Q==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:H})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:H})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${Q==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>Ne(!1),disabled:ye,children:ye?" ...":""})})]})}),document.body)]})},t9=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var dt;const g=c||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:N}=$i(),C=t.id,{initWorkState:v,setApiData:R,setDataLoaded:U,setInstalledEquipments:L,setMarkedForRemoval:w,addMarkedForRemoval:P,removeMarkedForRemoval:G,setSelectedContract:K,setSelectedStock:B,setSignalStatus:O,setSignalResult:S,setPendingLossStatusList:A,setRemovalStatus:Y}=ji(),{contractEquipments:te,technicianEquipments:J,customerEquipments:q,removeEquipments:V,installedEquipments:F,markedForRemoval:I,removalStatus:ee,pendingLossStatusList:ae,selectedContract:T,selectedStock:j,signalStatus:k,signalResult:Q,isReady:H}=oa(C);q.length;const[$,ie]=x.useState(!1),[fe,pe]=x.useState(!1),[de,Re]=x.useState(!1),[X,_e]=x.useState(!1),[me,Z]=x.useState(!1),[le,se]=x.useState(!1),[Ee,Ne]=x.useState(!1),[ye,ne]=x.useState("stock");x.useEffect(()=>{if(H&&(F.length>0||I.length>0||te.length>0)){console.log("[-]    -   ");return}v(C),ue()},[t.id]);const ue=async(Ke=!1)=>{var rt,ft,Ot,mt,Ze;try{let De;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Ke)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),De=i;else{Ke?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const Me=localStorage.getItem("userInfo");if(!Me){console.error("  .");return}const lt=JSON.parse(Me),ut=Mg(t.WRK_CD),jt={WRKR_ID:t.WRKR_ID||lt.userId||lt.workerId||"",SO_ID:t.SO_ID||lt.soId,WRK_ID:t.id,CUST_ID:((rt=t.customer)==null?void 0:rt.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ut,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-] API :",jt),De=await to(jt),Ke&&l&&(console.log("[-]   preloadedData "),l(De))}console.log("[-] API :",{contractEquipments:((ft=De.contractEquipments)==null?void 0:ft.length)||0,technicianEquipments:((Ot=De.technicianEquipments)==null?void 0:Ot.length)||0,customerEquipments:((mt=De.customerEquipments)==null?void 0:mt.length)||0,removedEquipments:((Ze=De.removedEquipments)==null?void 0:Ze.length)||0});const Ce={kpiProdGrpCd:De.kpiProdGrpCd,prodChgGb:De.prodChgGb,chgKpiProdGrpCd:De.chgKpiProdGrpCd,prodGrp:De.prodGrp};N(Ce),window.__equipmentFilterData=Ce;const ge=(De.contractEquipments||[]).map(Me=>({id:Me.SVC_CMPS_ID||Me.PROD_CMPS_ID,type:Me.ITEM_MID_NM||Me.EQT_NM,model:Me.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Me.ITEM_MID_CD,eqtClCd:Me.EQT_CL_CD||Me.EQT_CL,SVC_CMPS_ID:Me.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Me.BASIC_PROD_CMPS_ID,PROD_CD:Me.PROD_CD,SVC_CD:Me.SVC_CD})),Be=(De.technicianEquipments||[]).map(Me=>({id:Me.EQT_NO,type:Me.ITEM_MID_NM,model:Me.EQT_CL_NM,serialNumber:Me.EQT_SERNO,itemMidCd:Me.ITEM_MID_CD,eqtClCd:Me.EQT_CL_CD||Me.EQT_CL,macAddress:Me.MAC_ADDRESS,SVC_CMPS_ID:Me.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Me.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Me.EQT_PROD_CMPS_ID,PROD_CD:Me.PROD_CD,SVC_CD:Me.SVC_CD,EQT_SALE_AMT:Me.EQT_SALE_AMT,MST_SO_ID:Me.MST_SO_ID,SO_ID:Me.SO_ID,OLD_LENT_YN:Me.OLD_LENT_YN,LENT:Me.LENT,LENT_YN:Me.LENT_YN,ITLLMT_PRD:Me.ITLLMT_PRD,EQT_USE_STAT_CD:Me.EQT_USE_STAT_CD})),ce=new Set,Le=(De.customerEquipments||[]).map(Me=>{const lt=ge.find(ut=>ut.itemMidCd===Me.ITEM_MID_CD&&!ce.has(ut.id));return lt&&ce.add(lt.id),{contractEquipment:lt||{id:"unknown",type:Me.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Me.ITEM_MID_CD},actualEquipment:{id:Me.EQT_NO,type:Me.ITEM_MID_NM,model:Me.EQT_CL_NM,serialNumber:Me.EQT_SERNO,itemMidCd:Me.ITEM_MID_CD,eqtClCd:Me.EQT_CL_CD||Me.EQT_CL,macAddress:Me.MAC_ADDRESS||Me.MAC_ADDR,LENT_YN:Me.LENT_YN,VOIP_CUSTOWN_EQT:Me.VOIP_CUSTOWN_EQT},macAddress:Me.MAC_ADDRESS||Me.MAC_ADDR,installLocation:Me.INSTL_LCTN}}),Xe=(De.customerEquipments||[]).map(Me=>({id:Me.EQT_NO,type:Me.ITEM_MID_NM,model:Me.EQT_CL_NM,serialNumber:Me.EQT_SERNO,itemMidCd:Me.ITEM_MID_CD,eqtClCd:Me.EQT_CL_CD||Me.EQT_CL,macAddress:Me.MAC_ADDRESS||Me.MAC_ADDR,SVC_CMPS_ID:Me.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Me.BASIC_PROD_CMPS_ID,LENT_YN:Me.LENT_YN,VOIP_CUSTOWN_EQT:Me.VOIP_CUSTOWN_EQT})),Pe=(De.removedEquipments||[]).map(Me=>({id:Me.EQT_NO,type:Me.ITEM_MID_NM,model:Me.EQT_CL_NM,serialNumber:Me.EQT_SERNO,itemMidCd:Me.ITEM_MID_CD,eqtClCd:Me.EQT_CL_CD||Me.EQT_CL,macAddress:Me.MAC_ADDRESS||Me.MAC_ADDR,installLocation:Me.INSTL_LCTN,SVC_CMPS_ID:Me.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Me.BASIC_PROD_CMPS_ID,MST_SO_ID:Me.MST_SO_ID,SO_ID:Me.SO_ID,LENT_YN:Me.LENT_YN,VOIP_CUSTOWN_EQT:Me.VOIP_CUSTOWN_EQT}));R(C,{contractEquipments:ge,technicianEquipments:Be,customerEquipments:Xe,removeEquipments:Pe,filteringData:Ce});const Ct=I||[];if(Le.length>0)if(console.log("[-] API     :",Le.length,""),Ct.length>0){const Me=new Set(Ct.map(ut=>ut.id)),lt=Le.filter(ut=>!Me.has(ut.actualEquipment.id));L(C,lt)}else L(C,Le);requestAnimationFrame(()=>U(C,!0))}catch(De){console.error("[-]    :",De),requestAnimationFrame(()=>U(C,!0))}},xe=Ke=>Ke?qU.includes(Ke):!1,et=Ke=>{const rt=F.find(ft=>ft.contractEquipment.id===Ke.id);(T==null?void 0:T.id)===Ke.id?(K(C,null),B(C,null)):(K(C,Ke),rt?B(C,rt.actualEquipment):B(C,null))},bt=Ke=>{(j==null?void 0:j.id)===Ke.id?B(C,null):B(C,Ke)},it=()=>{if(!T||!j)return;if(T.itemMidCd!==j.itemMidCd||T.model!==j.model){r==null||r("      .","warning");return}const Ke=j.eqtClCd||j.EQT_CL_CD;if(!xe(Ke)){r==null||r(`     .
`,"error");return}const rt=F.findIndex(ft=>ft.contractEquipment.id===T.id);if(rt>=0){const ft=[...F];ft[rt]={contractEquipment:T,actualEquipment:j,macAddress:j.macAddress||"",installLocation:""},L(C,ft)}else{const ft={contractEquipment:T,actualEquipment:j,macAddress:j.macAddress||"",installLocation:""};L(C,[...F,ft])}O(C,"idle"),B(C,null)},At=()=>{if(!j)return;const Ke=j.eqtClCd||j.EQT_CL_CD;if(!xe(Ke)){r==null||r(`     .
`,"error");return}const rt=F.findIndex(mt=>mt.actualEquipment.id===j.id);if(rt>=0){const mt=[...F],Ze=mt.splice(rt,1)[0];L(C,mt);const De=Ze.actualEquipment;I.some(Ce=>Ce.id===De.id)||P(C,De),O(C,"idle"),B(C,null),ne("removal");return}if(I.some(mt=>mt.id===j.id))return;V.some(mt=>mt.id===j.id)&&(P(C,j),ne("removal"))},at=async(Ke,rt)=>{try{const ft=localStorage.getItem("userInfo");if(!ft){r==null||r("  .","error");return}const Ot=JSON.parse(ft),mt=Ke.map((De,Ye)=>{let Ce=De.ITEM_MID_CD||De.ITM_MID_CD||De.EQT||De.EQT_CD||"",ge=De.EQT_CL||De.EQT_CL_CD||"",Be=De.SVC_CMPS_ID||De.PROD_CMPS_ID||De.SVC_CMPS_SEQ||De.EQUIP_SEQ||"";return Ce=String(Ce).trim().padStart(2,"0"),ge=String(ge).trim().padStart(6,"0"),Be=String(Be||Ye+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Ot.crrId||"",WRKR_ID:t.WRKR_ID||Ot.userId||Ot.workerId||"",REG_UID:Ot.userId||Ot.workerId||"A20130708",ITEM_MID_CD:Ce,EQT_CL:ge,SVC_CMPS_ID:Be,EQT:Ce,EQT_CD:Ce,LENT:String(De.LENT||"10"),EQT_USE_STAT_CD:String(De.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(De.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(De.EQT_SALE_AMT||0),PROD_GRP:String(De.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(De.PROD_CD||t.PROD_CD||""),SVC_CD:String(De.SVC_CD||""),PROM_CNT:rt||"",SEL:"1",EQT_BASIC_YN:String(De.EQT_BASIC_YN||"N"),PROD_TYP:De.PROD_TYP,EQUIP_SEQ:De.EQUIP_SEQ}}),Ze=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:rt||"",equipments:mt});if(Ze.MSGCODE==="SUCCESS"||Ze.MSGCODE==="0"||Ze.code==="SUCCESS")r==null||r("  .","success"),await ue(!0);else throw new Error(Ze.MESSAGE||Ze.message||"   .")}catch(ft){throw console.error("[] :",ft),r==null||r(ft.message||"     .","error",!0),ft}},We=async()=>{var Ke,rt,ft,Ot;if(F.length===0){r==null||r("    .","warning"),O(C,"fail");return}try{Z(!0),_e(!0),S(C," ...");const mt=localStorage.getItem("userInfo");if(!mt){S(C,"    ."),O(C,"fail"),Z(!1);return}const Ze=JSON.parse(mt),De=Ze.userId||Ze.id||"UNKNOWN",Ye=Pe=>{var ut,jt,Ve,$t,Ue;const Ct=((ut=Pe.actualEquipment)==null?void 0:ut.eqtClCd)||Pe.eqtClCd||((jt=Pe.actualEquipment)==null?void 0:jt.EQT_CL_CD)||"",Me=((Ve=Pe.actualEquipment)==null?void 0:Ve.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",lt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Ct.startsWith("0904")||Me==="02"||lt.includes("stb")||lt.includes(""))},Ce=Pe=>{var ut,jt,Ve,$t,Ue;const Ct=((ut=Pe.actualEquipment)==null?void 0:ut.eqtClCd)||Pe.eqtClCd||((jt=Pe.actualEquipment)==null?void 0:jt.EQT_CL_CD)||"",Me=((Ve=Pe.actualEquipment)==null?void 0:Ve.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",lt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Ct.startsWith("0902")||Me==="03"||lt.includes("modem")||lt.includes(""))},ge=F.find(Ye),Be=F.find(Ce),ce=((Ke=ge==null?void 0:ge.actualEquipment)==null?void 0:Ke.id)||"",Le=((rt=Be==null?void 0:Be.actualEquipment)==null?void 0:rt.id)||"",Xe=await Su(De,t.CTRT_ID||"",t.id,"SMR03",ce||((Ot=(ft=F[0])==null?void 0:ft.actualEquipment)==null?void 0:Ot.id)||"",Le||"");Xe.O_IFSVC_RESULT&&Xe.O_IFSVC_RESULT.startsWith("TRUE")?(S(C,` 

: ${Xe.O_IFSVC_RESULT||""}`),O(C,"success")):(S(C,` 

${Xe.MESSAGE||"   "}`),O(C,"fail"))}catch(mt){S(C,` 

${mt.message||"   "}`),O(C,"fail")}finally{Z(!1)}},Dt=(Ke,rt,ft)=>{Y(C,Ke,rt,ft==="1"?"0":"1")},Tt=x.useMemo(()=>{const Ke=new Set(F.map(ft=>ft.actualEquipment.id));let rt=J.filter(ft=>!Ke.has(ft.id));return T&&(rt=rt.filter(ft=>ft.itemMidCd===T.itemMidCd&&ft.model===T.model)),rt},[F,J,T]);x.useMemo(()=>{const Ke=new Set(F.map(ft=>ft.actualEquipment.id));let rt=I.filter(ft=>!Ke.has(ft.id));return T&&(rt=rt.filter(ft=>ft.itemMidCd===T.itemMidCd&&ft.model===T.model)),rt},[F,I,T]);const St=()=>{se(!0),setTimeout(()=>{se(!1),r==null||r("    .","info")},500)},ze=async()=>{if(!(Ee||g)){Ne(!0);try{await ue(!0),r==null||r("  .","success")}catch(Ke){console.error("[-]  :",Ke),r==null||r("   .","error")}finally{Ne(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[Ee&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsx("button",{onClick:ze,disabled:Ee||g,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${Ee||g?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:s.jsx(Ei,{className:`w-4 h-4 ${Ee?"animate-spin":""}`})})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[te.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>!g&&ie(!0),disabled:g,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||g,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":k==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":k==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!g&&!me&&We(),disabled:g||me,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>d?Re(!0):pe(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:d?"LDAP":""})]})]})]}),H?te.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:te.map(Ke=>{const rt=F.find(Ot=>Ot.contractEquipment.id===Ke.id),ft=(T==null?void 0:T.id)===Ke.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${g?rt?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":ft?"border-blue-500 bg-blue-50 cursor-pointer":rt?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!g&&et(Ke),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ke.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ke.model})]}),rt&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",rt.actualEquipment.model]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",rt.actualEquipment.serialNumber]}),rt.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",rt.macAddress]})]})]})},Ke.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!g&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!j||!(F.some(Ke=>Ke.actualEquipment.id===j.id)||V.some(Ke=>Ke.id===j.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-red-500 bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer active:scale-95"}`,onClick:At,disabled:!j||!(F.some(Ke=>Ke.actualEquipment.id===j.id)||V.some(Ke=>Ke.id===j.id)),children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!T||!j||F.some(Ke=>Ke.actualEquipment.id===j.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:it,disabled:!T||!j||F.some(Ke=>Ke.actualEquipment.id===j.id),children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!g&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ye==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>ne("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),I.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ye==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:I.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ye==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>ne("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),T&&Tt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ye==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:Tt.length})]})})]}),ye==="removal"?s.jsx(s.Fragment,{children:I.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:I.map((Ke,rt)=>{const ft=Ke.id,Ot=ee[ft]||{},mt=Ot.EQT_LOSS_YN==="1"||Ot.PART_LOSS_BRK_YN==="1"||Ot.EQT_BRK_YN==="1"||Ot.EQT_CABL_LOSS_YN==="1"||Ot.EQT_CRDL_LOSS_YN==="1",Ze=(j==null?void 0:j.id)===Ke.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Ze?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>bt(Ke),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ke.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Ke.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Ke.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${mt?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:mt?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(De=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${Ot[De.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Ye=>{Ye.stopPropagation(),Dt(ft,De.key,Ot[De.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:Ot[De.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:De.label})]},De.key))})]},ft||rt)})})}):s.jsx(s.Fragment,{children:T?Tt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:Tt.map(Ke=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(j==null?void 0:j.id)===Ke.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>bt(Ke),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ke.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ke.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Ke.serialNumber]}),Ke.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Ke.macAddress]})]})]}),(j==null?void 0:j.id)===Ke.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Ke.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Ot;const Ke=t.WRK_CD_NM||kh(t.WRK_CD)||t.workType||"-",rt=t.PROD_NM||t.productName||((Ot=t.customer)==null?void 0:Ot.productName)||"-",ft=t.CTRT_STAT_NM||Cu(t.CTRT_STAT)||"-";return s.jsx(Ph,{isOpen:$,onClose:()=>ie(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:ft,prodGrp:t.PROD_GRP||"",prodNm:rt,wrkCdNm:Ke,onSave:at,showToast:r,installedEquipmentCount:F.length})})(),!g&&s.jsx("button",{onClick:St,disabled:le,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${le?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:fe,onClose:()=>pe(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((dt=t.customer)==null?void 0:dt.id)}),s.jsx(Ah,{isOpen:de,onClose:()=>Re(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),X&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!me&&_e(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Ke=>Ke.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:me?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):k==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:Q})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:Q})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${k==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>_e(!1),disabled:me,children:me?" ...":""})})]})}),document.body)]})},s9=t=>{switch(t){case"10":return"";case"20":return"";case"40":return"";default:return t||"-"}},n9=({isOpen:t,onClose:e,removedEquipmentsData:n=[],custId:r,rcptId:i,wrkId:l,ctrtId:c,mstSoId:d="",soId:u="",crrId:f="",wrkrId:m="",chgUid:_="",wrkCd:y="07",hideTransfer:g=!1,deferLossProcessing:N=!1,showToast:C,onSuccess:v,onSaveLossStatus:R,alreadyProcessedSerials:U=new Set})=>{const[L,w]=x.useState(!0),[P,G]=x.useState(!1),[K,B]=x.useState([]),[O,S]=x.useState([]),[A,Y]=x.useState(new Set),[te,J]=x.useState(null),[q,V]=x.useState(!1),[F,I]=x.useState(new Map),[ee,ae]=x.useState({}),[T,j]=x.useState([]),[k,Q]=x.useState(new Set),[H,$]=x.useState(!1);x.useEffect(()=>{t&&r&&i&&(w(!0),$(!1),J(null),B([]),S([]),Y(new Set),ae({}),Q(new Set),ie())},[t,r,i,l]);const ie=async()=>{w(!0),J(null);try{const[se,Ee,Ne]=await Promise.all([_5({CUST_ID:r,RCPT_ID:i}),x5({WRK_ID:l}),to({WRK_ID:l,WRKR_ID:m,SO_ID:u,CUST_ID:r,CTRT_ID:c,RCPT_ID:i})]);S(Ee);const ye=se.length>0?se.map(ue=>({...ue,ITEM_MID_CD:ue.ITEM_MID_CD||(ue.ITEM_CD?ue.ITEM_CD.substring(2,4):void 0)})):n.map(ue=>({EQT_NO:ue.EQT_NO,EQT_SERNO:ue.EQT_SERNO,EQT_CL_CD:ue.EQT_CL_CD||ue.EQT_CL,EQT_CL:ue.EQT_CL||ue.EQT_CL_CD,EQT_CL_NM:ue.EQT_CL_NM||"",ITEM_MID_CD:ue.ITEM_MID_CD,ITEM_MID_NM:ue.ITEM_MID_NM||"",ITEM_NM:ue.ITEM_MID_NM||"",MAC_ADDRESS:ue.MAC_ADDRESS||"",SVC_CMPS_ID:ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ue.BASIC_PROD_CMPS_ID,LENT_YN:ue.LENT_YN,LENT_YN_NM:ue.LENT_YN_NM||s9(ue.LENT_YN),VOIP_CUSTOWN_EQT:ue.VOIP_CUSTOWN_EQT}));if(console.log("[]   :",ye.length,"",se.length>0?"(API )":"(  )"),B(ye),ye&&ye.length>0){console.log("[]   ():",JSON.stringify(ye[0],null,2));const ue=ye.map(xe=>({EQT_NO:xe.EQT_NO,EQT_SERNO:xe.EQT_SERNO,EQT_CL_CD:xe.EQT_CL_CD||xe.EQT_CL,EQT_CL:xe.EQT_CL||xe.EQT_CL_CD,ITEM_MID_CD:xe.ITEM_MID_CD,SVC_CMPS_ID:xe.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:xe.BASIC_PROD_CMPS_ID,LENT_YN:xe.LENT_YN}));j(ue),console.log("[] EQT_NO :",ue.length,""),ue.forEach((xe,et)=>{console.log(`[] ${et+1}: EQT_SERNO=${xe.EQT_SERNO}, EQT_NO=${xe.EQT_NO}, EQT_CL_CD=${xe.EQT_CL_CD}`)})}const ne=new Map;ye.forEach(ue=>{ue.EQT_SERNO&&ne.set(ue.EQT_SERNO,ue.EQT_CL_NM||ue.ITEM_NM||"-")}),I(ue=>new Map([...ue,...ne])),ye.length===0&&J("      .")}catch(se){console.error("   :",se),J(se.message||"   .")}finally{w(!1),requestAnimationFrame(()=>{$(!0)})}},fe=se=>{Y(Ee=>{const Ne=new Set(Ee);return Ne.has(se)?(Ne.delete(se),ae(ye=>{const ne={...ye};return delete ne[se],ne})):Ne.add(se),Ne})},pe=()=>{if(A.size===K.length)Y(new Set),ae({});else{const se=K.filter(Ee=>Ee.EQT_SERNO).map(Ee=>Ee.EQT_SERNO);Y(new Set(se))}},de=(se,Ee)=>{ae(Ne=>{var ye;return{...Ne,[se]:{...Ne[se],[Ee]:((ye=Ne[se])==null?void 0:ye[Ee])==="1"?"0":"1"}}})},Re=se=>{const Ee=ee[se];return Ee?Ee.EQT_LOSS_YN==="1"||Ee.PART_LOSS_BRK_YN==="1"||Ee.EQT_BRK_YN==="1"||Ee.EQT_CABL_LOSS_YN==="1"||Ee.EQT_CRDL_LOSS_YN==="1":!1},X=()=>{if(A.size===0){C==null||C("  .","error");return}if(g){const se=[];if(A.forEach(Ee=>{Re(Ee)||se.push(Ee)}),se.length>0){C==null||C(" (,  ) .","error");return}}V(!0)},_e=async()=>{V(!1),G(!0);try{const se=new Map(F);A.forEach(at=>{const We=K.find(Dt=>Dt.EQT_SERNO===at);We&&We.EQT_SERNO&&se.set(We.EQT_SERNO,We.EQT_CL_NM||We.ITEM_NM||"-")}),I(se);let Ee=0,Ne=0,ye=0,ne=0;const ue=[],xe=[],et=[],bt=[];for(const at of A){const We=K.find(St=>St.EQT_SERNO===at),Dt=ee[at]||{};if(Re(at)&&We){console.log(`[]   - ${at}`,Dt);const St=T.find(De=>De.EQT_SERNO===at)||n.find(De=>De.EQT_SERNO===at),ze=(St==null?void 0:St.EQT_NO)||We.EQT_NO||"",dt=(St==null?void 0:St.ITEM_MID_CD)||We.ITEM_MID_CD||"",Ke=(St==null?void 0:St.EQT_CL_CD)||(St==null?void 0:St.EQT_CL)||We.EQT_CL_CD||We.EQT_CL||"",rt=(St==null?void 0:St.EQT_CL_NM)||We.EQT_CL_NM||"",ft=(St==null?void 0:St.SVC_CMPS_ID)||We.SVC_CMPS_ID||"",Ot=(St==null?void 0:St.BASIC_PROD_CMPS_ID)||We.BASIC_PROD_CMPS_ID||"",mt=(St==null?void 0:St.LENT_YN)||We.LENT_YN||"";if(N&&R){console.log(`[]   defer - ${at}`),bt.push({EQT_NO:ze,EQT_SERNO:at,EQT_CL_CD:Ke,EQT_CL:Ke,EQT_CL_NM:rt,ITEM_MID_CD:dt,SVC_CMPS_ID:ft,BASIC_PROD_CMPS_ID:Ot,LENT_YN:mt,EQT_LOSS_YN:Dt.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:Dt.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:Dt.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:Dt.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:Dt.EQT_CRDL_LOSS_YN||"0"}),ye++,et.push(at);continue}if(!ze){console.error(`[] EQT_NO  - ${at}`),ne++;continue}const Ze=await k4({WRK_ID:l,CUST_ID:r,CTRT_ID:c,MST_SO_ID:d,SO_ID:u,EQT_NO:ze,ITEM_MID_CD:dt,EQT_CL_CD:Ke,EQT_CL:Ke,EQT_CL_NM:rt,REG_UID:_,WRK_CD:y,CRR_ID:f,WRKR_ID:m,RCPT_ID:i,SVC_CMPS_ID:ft,BASIC_PROD_CMPS_ID:Ot,OLD_LENT_YN:mt,EQT_CHG_GB:"02",REUSE_YN:"0",EQT_LOSS_YN:Dt.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:Dt.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:Dt.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:Dt.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:Dt.EQT_CRDL_LOSS_YN||"0"});if((Ze==null?void 0:Ze.MSGCODE)==="SUCCESS"){ye++,et.push(at),Q(De=>new Set([...De,at]));try{await Su(_||m||"",c,l,"SMR05",ze,"")}catch(De){console.log("[]    ():",De)}}else ne++,console.error(`[]    - ${at}:`,Ze==null?void 0:Ze.MESSAGE)}else{if(g){console.log(`[] hideTransfer=true,   - ${at} `);continue}const St=await A4({MST_SO_ID:d,SO_ID:u,CUST_ID:r,CTRT_ID:c,RCPT_ID:i,WRK_ID:l,WRK_CD:y,CRR_ID:f,WRKR_ID:m,EQT_SERNO:at,CHG_UID:_});if((St==null?void 0:St.MSGCODE)==="SUCCESS")Ee++,et.push(at);else if((St==null?void 0:St.MSGCODE)==="CHARGE")ue.push(at);else{Ne++;const ze=(St==null?void 0:St.message)||(St==null?void 0:St.MESSAGE);ze&&xe.push(ze)}}}bt.length>0&&R&&(console.log("[EquipmentMoveModal]    (  ):",bt.length,""),R(bt)),await ie(),Y(new Set),ae({});const it=Ee+ye,At=Ne+ne;if(ue.length>0)C==null||C(` [${ue.join(", ")}]   .`,"error");else if(At>0){const at=xe.length>0?xe.join(`
`):`  (: ${Ee}, : ${ye}, : ${At})`;C==null||C(at,"error")}else ye>0&&Ee>0?C==null||C(` ${Ee},  ${ye} `,"success"):ye>0?C==null||C(` ${ye} `,"success"):C==null||C("  .","success");it>0&&(v==null||v(et))}catch(se){console.error("  :",se),C==null||C(se.message||"  .","error",!0)}finally{G(!1)}},me=se=>O.some(Ee=>Ee.EQT_SERNO===se&&Ee.SUCCESS_GUBN==="SUCCESS")||k.has(se)||U.has(se),Z=se=>k.has(se)||U.has(se),le=s.jsxs(s.Fragment,{children:[!g&&s.jsx("button",{onClick:X,disabled:P||A.size===0,className:"flex-1 px-3 sm:px-4 py-2 sm:py-2.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg text-sm sm:text-base font-semibold transition-colors flex items-center justify-center gap-2",children:P?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),s.jsxs("span",{children:[" (",A.size,")"]})]})}),s.jsx("button",{onClick:()=>{if(g&&N&&R&&A.size>0){const se=[];for(const Ee of A){const Ne=K.find(ne=>ne.EQT_SERNO===Ee),ye=ee[Ee]||{};if(Ne){const ne=T.find(ue=>ue.EQT_SERNO===Ee)||n.find(ue=>ue.EQT_SERNO===Ee);se.push({EQT_NO:(ne==null?void 0:ne.EQT_NO)||Ne.EQT_NO||"",EQT_SERNO:Ee,EQT_CL_CD:(ne==null?void 0:ne.EQT_CL_CD)||(ne==null?void 0:ne.EQT_CL)||Ne.EQT_CL_CD||Ne.EQT_CL||"",EQT_CL:(ne==null?void 0:ne.EQT_CL)||(ne==null?void 0:ne.EQT_CL_CD)||Ne.EQT_CL||Ne.EQT_CL_CD||"",EQT_CL_NM:(ne==null?void 0:ne.EQT_CL_NM)||Ne.EQT_CL_NM||"",ITEM_MID_CD:(ne==null?void 0:ne.ITEM_MID_CD)||Ne.ITEM_MID_CD||"",SVC_CMPS_ID:(ne==null?void 0:ne.SVC_CMPS_ID)||Ne.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:(ne==null?void 0:ne.BASIC_PROD_CMPS_ID)||Ne.BASIC_PROD_CMPS_ID||"",LENT_YN:(ne==null?void 0:ne.LENT_YN)||Ne.LENT_YN||"",EQT_LOSS_YN:ye.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:ye.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:ye.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:ye.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:ye.EQT_CRDL_LOSS_YN||"0"})}}se.length>0&&(console.log("[EquipmentMoveModal]    :",se.length,""),R(se),C==null||C(` ${se.length} .`,"success"))}e()},disabled:P,className:`${g?"flex-1":""} px-3 sm:px-4 py-2 sm:py-2.5 ${g?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"} rounded-lg text-sm sm:text-base font-semibold transition-colors disabled:opacity-50`,children:g?"":""})]});return s.jsxs(s.Fragment,{children:[s.jsx(_a,{isOpen:t,onClose:P?()=>{}:e,title:g?"":"  ",size:"large",footer:le,children:L||!H?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"   ..."})]}):te&&K.length===0&&O.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-red-500 mb-2",children:te}),s.jsx("button",{onClick:()=>{$(!1),ie()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700",children:" "})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:" "}),s.jsx("button",{onClick:pe,className:"text-xs text-blue-600 hover:underline",children:A.size===K.length?"":""})]}),K.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg",children:O.some(se=>se.SUCCESS_GUBN==="SUCCESS")?"   .":"    ."}):s.jsx("div",{className:"space-y-2",children:K.map((se,Ee)=>{const Ne=se.EQT_SERNO||"",ye=Ne?me(Ne):!1,ne=Ne?A.has(Ne):!1,ue=ee[Ne]||{},xe=Re(Ne);return s.jsx("div",{className:`p-3 rounded-lg border ${ye?"bg-green-50 border-green-200":xe?"bg-orange-50 border-orange-300":ne?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:ne,onChange:()=>Ne&&fe(Ne),disabled:ye||P,className:"mt-1 w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500 disabled:opacity-50"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-900",children:se.EQT_CL_NM||se.ITEM_NM||""}),ye&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:Z(Ne)?"":""}),xe&&!ye&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-orange-100 text-orange-700 rounded-full",children:""}),ne&&!xe&&!ye&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded-full",children:""})]}),s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[s.jsxs("div",{children:["S/N: ",se.EQT_SERNO||"-"]}),s.jsxs("div",{className:"flex gap-4 mt-1",children:[s.jsx("span",{children:se.LENT_YN_NM||"-"}),s.jsx("span",{children:se.NOTRECEV||"-"}),s.jsx("span",{children:se.EQT_STAT_CD||"-"})]}),se.MAC_ADDRESS&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["MAC: ",se.MAC_ADDRESS]})]}),ne&&!ye&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 mt-3 border-t border-gray-200",children:[s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ue.EQT_LOSS_YN==="1",onChange:()=>de(Ne,"EQT_LOSS_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ue.PART_LOSS_BRK_YN==="1",onChange:()=>de(Ne,"PART_LOSS_BRK_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ue.EQT_BRK_YN==="1",onChange:()=>de(Ne,"EQT_BRK_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ue.EQT_CABL_LOSS_YN==="1",onChange:()=>de(Ne,"EQT_CABL_LOSS_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ue.EQT_CRDL_LOSS_YN==="1",onChange:()=>de(Ne,"EQT_CRDL_LOSS_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]})]})]})]})},se.EQT_SERNO||Ee)})})]}),O.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsx("div",{className:"max-h-48 overflow-auto space-y-2",children:O.map((se,Ee)=>s.jsxs("div",{className:`p-3 rounded-lg border ${se.SUCCESS_GUBN==="SUCCESS"?"bg-green-50 border-green-200":se.SUCCESS_GUBN==="CHARGE"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsxs("span",{className:"text-xs text-gray-500 shrink-0",children:["#",Ee+1]}),s.jsx("span",{className:"font-medium text-gray-900 text-sm truncate",children:F.get(se.EQT_SERNO||"")||se.EQT_CL_NM||se.ITEM_NM||"-"})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full whitespace-nowrap shrink-0 ${se.SUCCESS_GUBN==="SUCCESS"?"bg-green-500 text-white":se.SUCCESS_GUBN==="CHARGE"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:se.SUCCESS_GUBN==="SUCCESS"?"":se.SUCCESS_GUBN==="CHARGE"?"":se.SUCCESS_GUBN||"-"})]}),s.jsxs("div",{className:"mt-1.5 text-xs text-gray-600 font-mono",children:["S/N: ",se.EQT_SERNO||"-"]})]},se.EQT_SERNO||Ee))})]})]})}),!g&&s.jsx(ul,{isOpen:q,onClose:()=>V(!1),onConfirm:_e,title:"",message:" ?     .",type:"confirm",confirmText:"",cancelText:""})]})},r9=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var ge,Be;const g=c||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:N}=$i(),C=t.id,{initWorkState:v,setApiData:R,setDataLoaded:U,setInstalledEquipments:L,setMarkedForRemoval:w,addMarkedForRemoval:P,removeMarkedForRemoval:G,setSelectedContract:K,setSelectedStock:B,setSignalStatus:O,setSignalResult:S,setPendingLossStatusList:A,setRemovalStatus:Y}=ji(),{contractEquipments:te,technicianEquipments:J,customerEquipments:q,removeEquipments:V,installedEquipments:F,markedForRemoval:I,removalStatus:ee,pendingLossStatusList:ae,selectedContract:T,selectedStock:j,signalStatus:k,signalResult:Q,isReady:H}=oa(C),$=q.length,[ie,fe]=x.useState(!1),[pe,de]=x.useState(!1),[Re,X]=x.useState(!1),[_e,me]=x.useState(!1),[Z,le]=x.useState(!1),[se,Ee]=x.useState(!1),[Ne,ye]=x.useState(!1),[ne,ue]=x.useState(!1),[xe,et]=x.useState("stock"),[bt,it]=x.useState([]),[At,at]=x.useState(new Set),[We,Dt]=x.useState(new Set),Tt=t.WRK_CD==="07"&&q.length===0?bt.filter(ce=>!At.has(ce.EQT_SERNO||"")).length:0;x.useEffect(()=>{if(H&&(F.length>0||I.length>0||te.length>0)){console.log("[-]    -   ");return}v(C),St()},[t.id]);const St=async(ce=!1)=>{var Le,Xe,Pe,Ct,Me,lt;try{let ut;const jt=localStorage.getItem("userInfo"),Ve=jt?JSON.parse(jt):null;if(console.log("[-] WRKR_ID :",{"workItem.WRKR_ID":t.WRKR_ID,"user.userId":Ve==null?void 0:Ve.userId,"user.workerId":Ve==null?void 0:Ve.workerId," WRKR_ID":t.WRKR_ID||(Ve==null?void 0:Ve.userId)||(Ve==null?void 0:Ve.workerId)||"",forceRefresh:ce}),i&&i.contractEquipments&&i.contractEquipments.length>0&&!ce)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),console.log('[-]  preloaded    -    " "  '),ut=i;else{ce?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const ht=localStorage.getItem("userInfo");if(!ht){console.error("  .");return}const qt=JSON.parse(ht),It=Mg(t.WRK_CD),he={WRKR_ID:t.WRKR_ID||qt.userId||qt.workerId||"",SO_ID:t.SO_ID||qt.soId,WRK_ID:t.id,CUST_ID:((Le=t.customer)==null?void 0:Le.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:It,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-] API :",he),ut=await to(he),ce&&l&&(console.log("[-]   preloadedData "),l(ut))}console.log("[-] API :",{contractEquipments:((Xe=ut.contractEquipments)==null?void 0:Xe.length)||0,technicianEquipments:((Pe=ut.technicianEquipments)==null?void 0:Pe.length)||0,customerEquipments:((Ct=ut.customerEquipments)==null?void 0:Ct.length)||0,removedEquipments:((Me=ut.removedEquipments)==null?void 0:Me.length)||0});const Ue=((lt=t.customer)==null?void 0:lt.id)||t.CUST_ID||"",ss=t.RCPT_ID||"";if(Ue&&ss)try{const ht=await _5({CUST_ID:Ue,RCPT_ID:ss});console.log("[-]  :",ht.length,""),it(ht)}catch(ht){console.error("[-]    :",ht)}const ls={kpiProdGrpCd:ut.kpiProdGrpCd,prodChgGb:ut.prodChgGb,chgKpiProdGrpCd:ut.chgKpiProdGrpCd,prodGrp:ut.prodGrp};N(ls),window.__equipmentFilterData=ls;const ds=(ut.contractEquipments||[]).map(ht=>({id:ht.SVC_CMPS_ID||ht.PROD_CMPS_ID,type:ht.ITEM_MID_NM||ht.EQT_NM,model:ht.EQT_CL_NM,serialNumber:"N/A",itemMidCd:ht.ITEM_MID_CD,eqtClCd:ht.EQT_CL_CD||ht.EQT_CL,SVC_CMPS_ID:ht.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ht.BASIC_PROD_CMPS_ID,PROD_CD:ht.PROD_CD,SVC_CD:ht.SVC_CD})),Ss=(ut.technicianEquipments||[]).map(ht=>({id:ht.EQT_NO,type:ht.ITEM_MID_NM,model:ht.EQT_CL_NM,serialNumber:ht.EQT_SERNO,itemMidCd:ht.ITEM_MID_CD,eqtClCd:ht.EQT_CL_CD||ht.EQT_CL,macAddress:ht.MAC_ADDRESS,SVC_CMPS_ID:ht.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ht.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:ht.EQT_PROD_CMPS_ID,PROD_CD:ht.PROD_CD,SVC_CD:ht.SVC_CD,EQT_SALE_AMT:ht.EQT_SALE_AMT,MST_SO_ID:ht.MST_SO_ID,SO_ID:ht.SO_ID,OLD_LENT_YN:ht.OLD_LENT_YN,LENT:ht.LENT,LENT_YN:ht.LENT_YN,ITLLMT_PRD:ht.ITLLMT_PRD,EQT_USE_STAT_CD:ht.EQT_USE_STAT_CD})),Ns=new Set,ke=(ut.customerEquipments||[]).map(ht=>{const qt=ds.find(It=>It.itemMidCd===ht.ITEM_MID_CD&&!Ns.has(It.id));return qt&&Ns.add(qt.id),{contractEquipment:qt||{id:"unknown",type:ht.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:ht.ITEM_MID_CD},actualEquipment:{id:ht.EQT_NO,type:ht.ITEM_MID_NM,model:ht.EQT_CL_NM,serialNumber:ht.EQT_SERNO,itemMidCd:ht.ITEM_MID_CD,eqtClCd:ht.EQT_CL_CD||ht.EQT_CL,macAddress:ht.MAC_ADDRESS||ht.MAC_ADDR,LENT_YN:ht.LENT_YN,VOIP_CUSTOWN_EQT:ht.VOIP_CUSTOWN_EQT},macAddress:ht.MAC_ADDRESS||ht.MAC_ADDR,installLocation:ht.INSTL_LCTN}}),ct=(ut.customerEquipments||[]).map(ht=>({id:ht.EQT_NO,type:ht.ITEM_MID_NM,model:ht.EQT_CL_NM,serialNumber:ht.EQT_SERNO,itemMidCd:ht.ITEM_MID_CD,eqtClCd:ht.EQT_CL_CD||ht.EQT_CL,macAddress:ht.MAC_ADDRESS||ht.MAC_ADDR,SVC_CMPS_ID:ht.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ht.BASIC_PROD_CMPS_ID,LENT_YN:ht.LENT_YN,VOIP_CUSTOWN_EQT:ht.VOIP_CUSTOWN_EQT})),st=(ut.removedEquipments||[]).map(ht=>({id:ht.EQT_NO,type:ht.ITEM_MID_NM,model:ht.EQT_CL_NM,serialNumber:ht.EQT_SERNO,itemMidCd:ht.ITEM_MID_CD,eqtClCd:ht.EQT_CL_CD||ht.EQT_CL,macAddress:ht.MAC_ADDRESS||ht.MAC_ADDR,installLocation:ht.INSTL_LCTN,SVC_CMPS_ID:ht.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ht.BASIC_PROD_CMPS_ID,MST_SO_ID:ht.MST_SO_ID,SO_ID:ht.SO_ID,LENT_YN:ht.LENT_YN,VOIP_CUSTOWN_EQT:ht.VOIP_CUSTOWN_EQT}));R(C,{contractEquipments:ds,technicianEquipments:Ss,customerEquipments:ct,removeEquipments:st,filteringData:ls}),t.WRK_CD==="07"&&t.id&&x5({WRK_ID:t.id}).then(ht=>{const qt=new Set(ht.filter(It=>It.SUCCESS_GUBN==="SUCCESS").map(It=>It.EQT_SERNO).filter(Boolean));qt.size>0&&at(qt)}).catch(()=>{});const Kt=I||[];if(ke.length>0)if(console.log("[-] API     :",ke.length,""),Kt.length>0){const ht=new Set(Kt.map(It=>It.id)),qt=ke.filter(It=>!ht.has(It.actualEquipment.id));L(C,qt)}else L(C,ke);requestAnimationFrame(()=>U(C,!0))}catch(ut){console.error("[-]    :",ut),requestAnimationFrame(()=>U(C,!0))}},ze=ce=>{const Le=F.find(Xe=>Xe.contractEquipment.id===ce.id);(T==null?void 0:T.id)===ce.id?(K(C,null),B(C,null)):(K(C,ce),Le?B(C,Le.actualEquipment):B(C,null))},dt=ce=>{(j==null?void 0:j.id)===ce.id?B(C,null):B(C,ce)},Ke=()=>{if(!T||!j)return;if(T.itemMidCd!==j.itemMidCd||T.model!==j.model){r==null||r("      .","warning");return}const ce=F.findIndex(Le=>Le.contractEquipment.id===T.id);if(ce>=0){const Le=[...F];Le[ce]={contractEquipment:T,actualEquipment:j,macAddress:j.macAddress||"",installLocation:""},L(C,Le)}else{const Le={contractEquipment:T,actualEquipment:j,macAddress:j.macAddress||"",installLocation:""};L(C,[...F,Le])}O(C,"idle"),B(C,null)},rt=()=>{if(!j)return;const ce=F.findIndex(Pe=>Pe.actualEquipment.id===j.id);if(ce>=0){const Pe=[...F],Ct=Pe.splice(ce,1)[0];L(C,Pe);const Me=Ct.actualEquipment;I.some(ut=>ut.id===Me.id)||P(C,Me),O(C,"idle"),B(C,null),et("removal");return}if(I.some(Pe=>Pe.id===j.id))return;V.some(Pe=>Pe.id===j.id)&&(P(C,j),et("removal"))},ft=async(ce,Le)=>{try{const Xe=localStorage.getItem("userInfo");if(!Xe){r==null||r("  .","error");return}const Pe=JSON.parse(Xe),Ct=ce.map((lt,ut)=>{let jt=lt.ITEM_MID_CD||lt.ITM_MID_CD||lt.EQT||lt.EQT_CD||"",Ve=lt.EQT_CL||lt.EQT_CL_CD||"",$t=lt.SVC_CMPS_ID||lt.PROD_CMPS_ID||lt.SVC_CMPS_SEQ||lt.EQUIP_SEQ||"";return jt=String(jt).trim().padStart(2,"0"),Ve=String(Ve).trim().padStart(6,"0"),$t=String($t||ut+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Pe.crrId||"",WRKR_ID:t.WRKR_ID||Pe.userId||Pe.workerId||"",REG_UID:Pe.userId||Pe.workerId||"A20130708",ITEM_MID_CD:jt,EQT_CL:Ve,SVC_CMPS_ID:$t,EQT:jt,EQT_CD:jt,LENT:String(lt.LENT||"10"),EQT_USE_STAT_CD:String(lt.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(lt.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(lt.EQT_SALE_AMT||0),PROD_GRP:String(lt.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(lt.PROD_CD||t.PROD_CD||""),SVC_CD:String(lt.SVC_CD||""),PROM_CNT:Le||"",SEL:"1",EQT_BASIC_YN:String(lt.EQT_BASIC_YN||"N"),PROD_TYP:lt.PROD_TYP,EQUIP_SEQ:lt.EQUIP_SEQ}}),Me=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:Le||"",equipments:Ct});if(Me.MSGCODE==="SUCCESS"||Me.MSGCODE==="0"||Me.code==="SUCCESS")r==null||r("  .","success"),await St(!0);else throw new Error(Me.MESSAGE||Me.message||"   .")}catch(Xe){throw console.error("[] :",Xe),r==null||r(Xe.message||"     .","error",!0),Xe}},Ot=async()=>{var ce,Le,Xe,Pe;if(F.length===0){r==null||r("    .","warning"),O(C,"fail");return}try{Ee(!0),le(!0),S(C," ...");const Ct=localStorage.getItem("userInfo");if(!Ct){S(C,"    ."),O(C,"fail"),Ee(!1);return}const Me=JSON.parse(Ct),lt=Me.userId||Me.id||"UNKNOWN",ut=ds=>{var ct,st,Kt,ht,qt;const Ss=((ct=ds.actualEquipment)==null?void 0:ct.eqtClCd)||ds.eqtClCd||((st=ds.actualEquipment)==null?void 0:st.EQT_CL_CD)||"",Ns=((Kt=ds.actualEquipment)==null?void 0:Kt.itemMidCd)||ds.itemMidCd||((ht=ds.actualEquipment)==null?void 0:ht.ITEM_MID_CD)||"",ke=(((qt=ds.actualEquipment)==null?void 0:qt.type)||ds.type||"").toLowerCase();return!!(Ss.startsWith("0904")||Ns==="02"||ke.includes("stb")||ke.includes(""))},jt=ds=>{var ct,st,Kt,ht,qt;const Ss=((ct=ds.actualEquipment)==null?void 0:ct.eqtClCd)||ds.eqtClCd||((st=ds.actualEquipment)==null?void 0:st.EQT_CL_CD)||"",Ns=((Kt=ds.actualEquipment)==null?void 0:Kt.itemMidCd)||ds.itemMidCd||((ht=ds.actualEquipment)==null?void 0:ht.ITEM_MID_CD)||"",ke=(((qt=ds.actualEquipment)==null?void 0:qt.type)||ds.type||"").toLowerCase();return!!(Ss.startsWith("0902")||Ns==="03"||ke.includes("modem")||ke.includes(""))},Ve=F.find(ut),$t=F.find(jt),Ue=((ce=Ve==null?void 0:Ve.actualEquipment)==null?void 0:ce.id)||"",ss=((Le=$t==null?void 0:$t.actualEquipment)==null?void 0:Le.id)||"",ls=await Su(lt,t.CTRT_ID||"",t.id,"SMR03",Ue||((Pe=(Xe=F[0])==null?void 0:Xe.actualEquipment)==null?void 0:Pe.id)||"",ss||"");ls.O_IFSVC_RESULT&&ls.O_IFSVC_RESULT.startsWith("TRUE")?(S(C,` 

: ${ls.O_IFSVC_RESULT||""}`),O(C,"success")):(S(C,` 

${ls.MESSAGE||"   "}`),O(C,"fail"))}catch(Ct){S(C,` 

${Ct.message||"   "}`),O(C,"fail")}finally{Ee(!1)}},mt=ce=>{console.log("[-]    (  API  ):",ce.length,"");const Le=new Set(ce.map(Pe=>Pe.EQT_SERNO)),Xe=ae.filter(Pe=>!Le.has(Pe.EQT_SERNO));A(C,[...Xe,...ce])},Ze=x.useMemo(()=>{const ce=new Set(F.map(Pe=>Pe.actualEquipment.id));let Le=J.filter(Pe=>!ce.has(Pe.id));return T&&(Le=Le.filter(Pe=>Pe.itemMidCd===T.itemMidCd&&Pe.model===T.model)),(At.size>0||We.size>0)&&Le.sort((Pe,Ct)=>{const Me=Pe.serialNumber||"",lt=Ct.serialNumber||"",ut=We.has(Me),jt=We.has(lt),Ve=At.has(Me),$t=At.has(lt);return ut&&!jt?-1:!ut&&jt?1:Ve&&!$t?-1:!Ve&&$t?1:0}),Le},[F,J,T,At,We]);x.useMemo(()=>{const ce=new Set(F.map(Xe=>Xe.actualEquipment.id));let Le=I.filter(Xe=>!ce.has(Xe.id));return T&&(Le=Le.filter(Xe=>Xe.itemMidCd===T.itemMidCd&&Xe.model===T.model)),Le},[F,I,T]);const De=x.useMemo(()=>{const ce=new Set(F.map(Xe=>Xe.actualEquipment.id));return[...I,...V.filter(Xe=>!ce.has(Xe.id)&&!I.some(Pe=>Pe.id===Xe.id))]},[I,V,F]),Ye=()=>{ye(!0),setTimeout(()=>{ye(!1),r==null||r("    .","info")},500)},Ce=async()=>{if(!(ne||g)){ue(!0);try{await St(!0),r==null||r("  .","success")}catch(ce){console.error("[-]  :",ce),r==null||r("   .","error")}finally{ue(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[ne&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsx("button",{onClick:Ce,disabled:ne||g,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${ne||g?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:s.jsx(Ei,{className:`w-4 h-4 ${ne?"animate-spin":""}`})})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[te.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>!g&&fe(!0),disabled:g,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||g,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":k==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":k==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!g&&!se&&Ot(),disabled:g||se,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:`relative flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g||q.length>0?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-indigo-200 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:border-indigo-300"}`,onClick:()=>!g&&q.length===0&&me(!0),disabled:g||q.length>0,children:[Tt>0&&s.jsx("span",{className:"absolute -top-1.5 -right-1.5 min-w-[20px] h-5 px-1.5 flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full shadow-sm",children:Tt}),s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>d?X(!0):de(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:d?"LDAP":""})]})]})]}),H?te.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:te.map(ce=>{const Le=F.find(Pe=>Pe.contractEquipment.id===ce.id),Xe=(T==null?void 0:T.id)===ce.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${g?Le?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Xe?"border-blue-500 bg-blue-50 cursor-pointer":Le?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!g&&ze(ce),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:ce.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:ce.model})]}),Le&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",Le.actualEquipment.model]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",Le.actualEquipment.serialNumber]}),Le.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",Le.macAddress]})]})]})},ce.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!g&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!j||!F.some(ce=>ce.actualEquipment.id===(j==null?void 0:j.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-red-500 bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer active:scale-95"}`,onClick:rt,disabled:!j||!F.some(ce=>ce.actualEquipment.id===(j==null?void 0:j.id)),children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!j||F.some(ce=>ce.actualEquipment.id===(j==null?void 0:j.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!j)return;if(I.some(Xe=>Xe.id===j.id)){if(T&&(T.itemMidCd!==j.itemMidCd||T.model!==j.model)){r==null||r("      .","warning");return}const Xe=T||te.find(Me=>Me.itemMidCd===j.itemMidCd&&Me.model===j.model);if(!Xe){r==null||r("  .","warning");return}if(F.find(Me=>Me.contractEquipment.id===Xe.id)){r==null||r("   .","warning");return}const Ct={contractEquipment:Xe,actualEquipment:j,macAddress:j.macAddress||""};L(C,[...F,Ct]),G(C,j.id),B(C,null),r==null||r(" .","success");return}if(!T){r==null||r("   .","warning");return}if(F.find(Xe=>Xe.contractEquipment.id===T.id)){r==null||r("   .","warning");return}Ke()},disabled:!j||F.some(ce=>ce.actualEquipment.id===(j==null?void 0:j.id)),children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!g&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[ne&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),q.length>0?s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${xe==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>et("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${xe==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:De.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${xe==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>et("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),T&&Ze.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${xe==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:Ze.length})]})})]}):s.jsx("div",{className:"py-3 px-4 border-b-2 border-blue-500",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-sm font-semibold text-blue-600",children:""}),T&&Ze.length>0&&s.jsx("span",{className:"px-2 py-0.5 text-xs font-bold rounded-full bg-blue-500 text-white",children:Ze.length})]})}),q.length>0&&xe==="removal"?s.jsx("div",{className:"p-3 sm:p-4 space-y-3 max-h-80 overflow-y-auto",children:De.map((ce,Le)=>{const Xe=ce.id,Pe=(j==null?void 0:j.id)===Xe,Ct=I.some(Me=>Me.id===Xe);return s.jsx("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Pe?"border-blue-500 bg-blue-50":Ct?"border-red-200 bg-red-50 hover:border-red-300":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>dt(ce),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold ${Ct?"bg-red-500 text-white":"bg-orange-500 text-white"}`,children:Ct?"":Le+1}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:ce.type}),s.jsx("div",{className:"text-xs text-gray-600",children:ce.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",ce.serialNumber]}),ce.macAddress&&s.jsxs("div",{className:"text-xs text-gray-500",children:["MAC: ",ce.macAddress]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${Ct?"bg-red-500 text-white":"bg-orange-500 text-white"}`,children:Ct?"":""})]})},`removal-${Xe||Le}`)})}):s.jsx(s.Fragment,{children:T?Ze.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:Ze.map(ce=>{const Le=ce.serialNumber||"",Xe=We.has(Le),Pe=At.has(Le),Ct=Xe||Pe;return s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(j==null?void 0:j.id)===ce.id?"border-blue-500 bg-blue-50":Xe?"border-purple-500 bg-purple-50 ring-2 ring-purple-300 ring-opacity-50 animate-pulse":Pe?"border-purple-400 bg-purple-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>dt(ce),children:[Ct&&s.jsx("div",{className:`absolute -top-2 left-3 px-2 py-0.5 text-white text-[0.625rem] sm:text-xs font-bold rounded-full shadow-sm ${Xe?"bg-purple-600":"bg-purple-500"}`,children:Xe?" ":""}),s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:ce.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:ce.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",ce.serialNumber]}),ce.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",ce.macAddress]})]})]}),(j==null?void 0:j.id)===ce.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},ce.id)})}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Pe;const ce=t.WRK_CD_NM||kh(t.WRK_CD)||t.workType||"-",Le=t.PROD_NM||t.productName||((Pe=t.customer)==null?void 0:Pe.productName)||"-",Xe=t.CTRT_STAT_NM||Cu(t.CTRT_STAT)||"-";return s.jsx(Ph,{isOpen:ie,onClose:()=>fe(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:Xe,prodGrp:t.PROD_GRP||"",prodNm:Le,wrkCdNm:ce,onSave:ft,showToast:r,installedEquipmentCount:F.length,customerEquipmentCount:$})})(),!g&&s.jsx("button",{onClick:Ye,disabled:Ne,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${Ne?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:pe,onClose:()=>de(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((ge=t.customer)==null?void 0:ge.id)}),s.jsx(Ah,{isOpen:Re,onClose:()=>X(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),s.jsx(n9,{isOpen:_e,onClose:()=>{me(!1),St(!0)},removedEquipmentsData:(V.length>0?V:q).map(ce=>({EQT_NO:ce.id||ce.EQT_NO||"",EQT_SERNO:ce.serialNumber||ce.EQT_SERNO||"",EQT_CL_CD:ce.eqtClCd||ce.EQT_CL_CD||ce.EQT_CL||"",EQT_CL_NM:ce.model||ce.EQT_CL_NM||"",ITEM_MID_CD:ce.itemMidCd||ce.ITEM_MID_CD||"",ITEM_MID_NM:ce.type||ce.ITEM_MID_NM||"",MAC_ADDRESS:ce.macAddress||ce.MAC_ADDRESS||"",SVC_CMPS_ID:ce.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:ce.BASIC_PROD_CMPS_ID||"",LENT_YN:ce.LENT_YN||"",VOIP_CUSTOWN_EQT:ce.VOIP_CUSTOWN_EQT||""})),custId:t.CUST_ID||((Be=t.customer)==null?void 0:Be.id)||"",rcptId:t.RCPT_ID||"",wrkId:t.id,ctrtId:t.CTRT_ID||"",hideTransfer:!1,mstSoId:t.MST_SO_ID||"",soId:t.SO_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",chgUid:t.REG_UID||t.WRKR_ID||"",showToast:r,deferLossProcessing:!1,onSaveLossStatus:mt,alreadyProcessedSerials:At,onSuccess:ce=>{console.log("[EquipmentMoveRemoval]   -  :",ce),at(new Set([...At,...ce])),Dt(new Set(ce)),setTimeout(()=>{Dt(new Set)},1e4)}}),Z&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!se&&le(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:ce=>ce.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:se?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):k==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:Q})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:Q})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${k==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>le(!1),disabled:se,children:se?" ...":""})})]})}),document.body)]})},i9=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1})=>{const d=t.id,u=c||t.WRK_STAT_CD==="4"||t.status==="",{initWorkState:f,setApiData:m,setDataLoaded:_,toggleRemovalStatus:y,setFullRemovalStatus:g,setRemovalStatus:N,setReuseAll:C}=ji(),{removeEquipments:v,removalStatus:R,isReady:U}=oa(d),[L,w]=x.useState(!1),[P,G]=x.useState(!1),K=ji(J=>{var q;return((q=J.workStates[d])==null?void 0:q.reuseAll)??!1}),B=J=>{C(d,J)},O=async J=>{var q;try{const V=localStorage.getItem("userInfo"),F=V?JSON.parse(V):{},I=await Cg({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:t.WRKR_ID||F.userId||"",PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"02",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||((q=t.customer)==null?void 0:q.ADDR_ORD)||"",WRK_CD:t.WRK_CD||"08",WRK_STAT_CD:t.WRK_STAT_CD||""}),ee=(I==null?void 0:I.MVM_TP)||"",ae=(I==null?void 0:I.WRK_STAT_CD)||"",T=(I==null?void 0:I.CTRT_ID)||"",j=(I==null?void 0:I.OLD_CTRT_ID)||"",k=ae==="2";G(k),console.log("[-]  :",{WRK_STAT_CD:ae,CTRT_ID:T,OLD_CTRT_ID:j,:k}),J&&(k?(C(d,!0),console.log("[-]   : true")):C(d,!1))}catch(V){console.error("[-]   :",V),G(!1),J&&C(d,!1)}};x.useEffect(()=>{const J=!U||v.length===0;if(O(J),!J){console.log("[-]    -   , reuseAll:",K);return}f(d),S()},[t.id]);const S=async(J=!1)=>{var q,V;try{console.log("[-]    - isWorkCompleted:",u,"WRK_STAT_CD:",t.WRK_STAT_CD);let F;if(i&&!J)console.log("[-] Pre-loaded   - API  "),F=i;else{const ee=localStorage.getItem("userInfo");if(!ee){console.error("  .");return}const ae=JSON.parse(ee),T={WRKR_ID:t.WRKR_ID||ae.userId||ae.workerId||"",SO_ID:t.SO_ID||ae.soId,WRK_ID:t.id,CUST_ID:((q=t.customer)==null?void 0:q.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"08",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-]    (API )"),console.log("[-] :",T),F=await to(T)}console.log("[-] :"),console.log("  -  (output5):",((V=F.removedEquipments)==null?void 0:V.length)||0,"");const I=(F.removedEquipments||[]).map(ee=>({...ee,id:ee.EQT_NO,type:ee.ITEM_MID_NM,model:ee.EQT_CL_NM,serialNumber:ee.EQT_SERNO,itemMidCd:ee.ITEM_MID_CD,eqtClCd:ee.EQT_CL_CD||ee.EQT_CL,macAddress:ee.MAC_ADDRESS||ee.MAC_ADDR,installLocation:ee.INSTL_LCTN}));console.log("[-]  :"),console.log("  -  :",I.length,""),m(d,{removeEquipments:I}),requestAnimationFrame(()=>_(d,!0))}catch(F){console.error("[-]    :",F),r==null||r("   .","error",!0),m(d,{removeEquipments:[]}),requestAnimationFrame(()=>_(d,!0))}},A=()=>{const J=!K;B(J),v.forEach(q=>{N(d,q.id,"REUSE_YN",J?"1":"0"),J&&(N(d,q.id,"EQT_LOSS_YN","0"),N(d,q.id,"PART_LOSS_BRK_YN","0"),N(d,q.id,"EQT_BRK_YN","0"),N(d,q.id,"EQT_CABL_LOSS_YN","0"),N(d,q.id,"EQT_CRDL_LOSS_YN","0"))}),J&&(r==null||r("   .   .","info"))},Y=(J,q)=>{var F;y(d,J,q),(((F=R[J])==null?void 0:F[q])||"0")==="0"&&K&&(B(!1),v.forEach(I=>{N(d,I.id,"REUSE_YN","0")}),r==null||r("    .","warning"))},te=async()=>{if(!(L||u)){w(!0);try{await S(!0),r==null||r("  .","success")}catch(J){console.error("[-]  :",J),r==null||r("   .","error")}finally{w(!1)}}};return s.jsx("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[L&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(uc,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Ei,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-500"}),""]}),s.jsxs("button",{onClick:te,disabled:L||u,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${L||u?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(uc,{className:`w-3.5 h-3.5 ${L?"animate-spin":""}`}),s.jsx("span",{children:" "})]}),P&&!u&&!c&&v.length>0&&s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg cursor-pointer hover:bg-blue-50 active:bg-blue-100",children:[s.jsx("input",{type:"checkbox",checked:K,onChange:A,className:"w-4 h-4 rounded border-blue-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-xs text-blue-700 font-medium",children:""})]})]}),s.jsxs("span",{className:"px-2 sm:px-2.5 py-0.5 sm:py-1 bg-orange-100 text-orange-700 text-[0.625rem] sm:text-xs font-semibold rounded-full",children:[v.length,""]})]}),v.length===0?s.jsx("div",{className:"py-12 text-center",children:s.jsx("div",{className:"text-sm text-gray-500",children:"   "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:v.map(J=>{const q=J.id,V=R[q]||{},F=yN(J);return s.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:J.model||J.type}),s.jsxs("div",{className:"text-xs text-gray-600",children:["S/N: ",J.serialNumber]}),J.macAddress&&s.jsxs("div",{className:"text-xs text-gray-500",children:["MAC: ",J.macAddress]})]}),s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:J.EQT_LOC_TP_NM||""})]}),!u&&!c&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${F?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_LOSS_YN==="1",onChange:()=>Y(q,"EQT_LOSS_YN"),disabled:F,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${F?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.PART_LOSS_BRK_YN==="1",onChange:()=>Y(q,"PART_LOSS_BRK_YN"),disabled:F,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${F?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_BRK_YN==="1",onChange:()=>Y(q,"EQT_BRK_YN"),disabled:F,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${F?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_CABL_LOSS_YN==="1",onChange:()=>Y(q,"EQT_CABL_LOSS_YN"),disabled:F,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${F?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_CRDL_LOSS_YN==="1",onChange:()=>Y(q,"EQT_CRDL_LOSS_YN"),disabled:F,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]})]}),F&&!u&&s.jsx("div",{className:"mt-2 text-xs text-orange-600 bg-orange-50 p-2 rounded",children:"   "})]},J.id)})})]})})},a9=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u="",onLdapConnect:f,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:y=!1})=>{var dt;const g=c||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:N}=$i(),C=t.id,{initWorkState:v,setApiData:R,setDataLoaded:U,setInstalledEquipments:L,addMarkedForRemoval:w,setMarkedForRemoval:P,toggleRemovalStatus:G,setFullRemovalStatus:K,setSelectedContract:B,setSelectedStock:O,setSignalStatus:S,setSignalResult:A,clearSelection:Y}=ji(),{contractEquipments:te,technicianEquipments:J,customerEquipments:q,removeEquipments:V,installedEquipments:F,markedForRemoval:I,removalStatus:ee,selectedContract:ae,selectedStock:T,signalStatus:j,signalResult:k,isReady:Q}=oa(C),H=q.length,[$,ie]=x.useState(!1),[fe,pe]=x.useState(!1),[de,Re]=x.useState(!1),[X,_e]=x.useState(!1),[me,Z]=x.useState(!1),[le,se]=x.useState(!1),[Ee,Ne]=x.useState(!1),[ye,ne]=x.useState("stock");x.useEffect(()=>{if(Q&&(F.length>0||I.length>0||te.length>0)){console.log("[-]    -   ");return}v(C),ue()},[t.id]);const ue=async(Ke=!1)=>{var rt,ft,Ot,mt,Ze,De,Ye,Ce;try{let ge;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Ke)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),ge=i;else{Ke?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const Ve=localStorage.getItem("userInfo");if(!Ve){console.error("  .");return}const $t=JSON.parse(Ve),Ue=Mg(t.WRK_CD),ss={WRKR_ID:t.WRKR_ID||$t.userId||$t.workerId||"",SO_ID:t.SO_ID||$t.soId,WRK_ID:t.id,CUST_ID:((rt=t.customer)==null?void 0:rt.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:Ue,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-] API :",ss),ge=await to(ss),Ke&&l&&(console.log("[-]   preloadedData "),l(ge))}console.log("=== [-] API Output  ==="),console.log("  output1 ():",ge.productInfo||"N/A"),console.log("  output2 ():",((ft=ge.contractEquipments)==null?void 0:ft.length)||0,""),((Ot=ge.contractEquipments)==null?void 0:Ot.length)>0&&ge.contractEquipments.forEach((Ve,$t)=>{console.log(`    [${$t}] ${Ve.ITEM_MID_NM} / ${Ve.EQT_CL_NM} / SVC_CMPS_ID: ${Ve.SVC_CMPS_ID}`)}),console.log("  output3 ():",((mt=ge.technicianEquipments)==null?void 0:mt.length)||0,""),console.log("  output4 ():",((Ze=ge.customerEquipments)==null?void 0:Ze.length)||0,""),((De=ge.customerEquipments)==null?void 0:De.length)>0&&ge.customerEquipments.forEach((Ve,$t)=>{console.log(`    [${$t}] ${Ve.ITEM_MID_NM} / ${Ve.EQT_CL_NM} / EQT_NO: ${Ve.EQT_NO} / S/N: ${Ve.EQT_SERNO}`)}),console.log("  output5 ():",((Ye=ge.removedEquipments)==null?void 0:Ye.length)||0,""),((Ce=ge.removedEquipments)==null?void 0:Ce.length)>0&&ge.removedEquipments.forEach((Ve,$t)=>{console.log(`    [${$t}] ${Ve.ITEM_MID_NM} / ${Ve.EQT_CL_NM} / EQT_NO: ${Ve.EQT_NO} / S/N: ${Ve.EQT_SERNO}`)}),console.log("==========================================");const ce={kpiProdGrpCd:ge.kpiProdGrpCd,prodChgGb:ge.prodChgGb,chgKpiProdGrpCd:ge.chgKpiProdGrpCd,prodGrp:ge.prodGrp};N(ce),window.__equipmentFilterData=ce;const Le=(ge.contractEquipments||[]).map(Ve=>({id:Ve.SVC_CMPS_ID||Ve.PROD_CMPS_ID,type:Ve.ITEM_MID_NM||Ve.EQT_NM,model:Ve.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ve.ITEM_MID_CD,eqtClCd:Ve.EQT_CL_CD||Ve.EQT_CL,SVC_CMPS_ID:Ve.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ve.BASIC_PROD_CMPS_ID,PROD_CD:Ve.PROD_CD,SVC_CD:Ve.SVC_CD})),Xe=(ge.technicianEquipments||[]).map(Ve=>({id:Ve.EQT_NO,type:Ve.ITEM_MID_NM,model:Ve.EQT_CL_NM,serialNumber:Ve.EQT_SERNO,itemMidCd:Ve.ITEM_MID_CD,eqtClCd:Ve.EQT_CL_CD||Ve.EQT_CL,macAddress:Ve.MAC_ADDRESS,SVC_CMPS_ID:Ve.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ve.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ve.EQT_PROD_CMPS_ID,PROD_CD:Ve.PROD_CD,SVC_CD:Ve.SVC_CD,EQT_SALE_AMT:Ve.EQT_SALE_AMT,MST_SO_ID:Ve.MST_SO_ID,SO_ID:Ve.SO_ID,OLD_LENT_YN:Ve.OLD_LENT_YN,LENT:Ve.LENT,LENT_YN:Ve.LENT_YN,ITLLMT_PRD:Ve.ITLLMT_PRD,EQT_USE_STAT_CD:Ve.EQT_USE_STAT_CD})),Pe=new Set,Ct=(ge.customerEquipments||[]).map(Ve=>{const $t=Le.find(Ue=>Ue.itemMidCd===Ve.ITEM_MID_CD&&!Pe.has(Ue.id));return $t&&Pe.add($t.id),{contractEquipment:$t||{id:"unknown",type:Ve.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ve.ITEM_MID_CD},actualEquipment:{id:Ve.EQT_NO,type:Ve.ITEM_MID_NM,model:Ve.EQT_CL_NM,serialNumber:Ve.EQT_SERNO,itemMidCd:Ve.ITEM_MID_CD,eqtClCd:Ve.EQT_CL_CD||Ve.EQT_CL,macAddress:Ve.MAC_ADDRESS||Ve.MAC_ADDR,LENT_YN:Ve.LENT_YN,VOIP_CUSTOWN_EQT:Ve.VOIP_CUSTOWN_EQT},macAddress:Ve.MAC_ADDRESS||Ve.MAC_ADDR,installLocation:Ve.INSTL_LCTN}}),Me=(ge.removedEquipments||[]).map(Ve=>({id:Ve.EQT_NO,type:Ve.ITEM_MID_NM,model:Ve.EQT_CL_NM,serialNumber:Ve.EQT_SERNO,itemMidCd:Ve.ITEM_MID_CD,eqtClCd:Ve.EQT_CL_CD||Ve.EQT_CL,macAddress:Ve.MAC_ADDRESS||Ve.MAC_ADDR,installLocation:Ve.INSTL_LCTN,SVC_CMPS_ID:Ve.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ve.BASIC_PROD_CMPS_ID,MST_SO_ID:Ve.MST_SO_ID,SO_ID:Ve.SO_ID,LENT_YN:Ve.LENT_YN,VOIP_CUSTOWN_EQT:Ve.VOIP_CUSTOWN_EQT}));R(C,{contractEquipments:Le,technicianEquipments:Xe,removeEquipments:Me,filteringData:ce});const lt=I||[],ut=F||[];if(console.log("[-]   :",{existingMarkedForRemoval:lt.length,existingInstalledEquipments:ut.length,apiInstalled:Ct.length,apiRemoved:Me.length}),lt.length===0&&ut.length===0)console.log("[-]   - API  "),Ct.length>0&&(console.log("[-]   :",Ct.length,""),L(C,Ct)),Me.length>0&&(console.log("[-]  markedForRemoval :",Me.length,""),P(C,Me));else if(console.log("[-]  -   "),Ct.length>0){const Ve=new Set(lt.map(Ue=>Ue.id)),$t=Ct.filter(Ue=>!Ve.has(Ue.actualEquipment.id));L(C,$t)}requestAnimationFrame(()=>U(C,!0))}catch(ge){console.error("[-]    :",ge),requestAnimationFrame(()=>U(C,!0))}},xe=Ke=>{const rt=F.find(ft=>ft.contractEquipment.id===Ke.id);(ae==null?void 0:ae.id)===Ke.id?(B(C,null),O(C,null)):(B(C,Ke),rt?O(C,rt.actualEquipment):O(C,null))},et=Ke=>{(T==null?void 0:T.id)===Ke.id?O(C,null):O(C,Ke)},bt=()=>{if(!ae||!T)return;if(ae.itemMidCd!==T.itemMidCd||ae.model!==T.model){r==null||r("      .","warning");return}const Ke=F.findIndex(rt=>rt.contractEquipment.id===ae.id);if(Ke>=0){const rt=[...F];rt[Ke]={contractEquipment:ae,actualEquipment:T,macAddress:T.macAddress||"",installLocation:""},L(C,rt)}else{const rt={contractEquipment:ae,actualEquipment:T,macAddress:T.macAddress||"",installLocation:""};L(C,[...F,rt])}S(C,"idle"),O(C,null)},it=()=>{if(!T)return;const Ke=F.findIndex(Ot=>Ot.actualEquipment.id===T.id);if(Ke>=0){const Ot=[...F],mt=Ot.splice(Ke,1)[0];L(C,Ot);const Ze=mt.actualEquipment;I.some(Ye=>Ye.id===Ze.id)||w(C,Ze),S(C,"idle"),O(C,null);return}if(I.some(Ot=>Ot.id===T.id))return;V.some(Ot=>Ot.id===T.id)&&w(C,T)},At=async(Ke,rt)=>{try{const ft=localStorage.getItem("userInfo");if(!ft){r==null||r("  .","error");return}const Ot=JSON.parse(ft),mt=Ke.map((De,Ye)=>{let Ce=De.ITEM_MID_CD||De.ITM_MID_CD||De.EQT||De.EQT_CD||"",ge=De.EQT_CL||De.EQT_CL_CD||"",Be=De.SVC_CMPS_ID||De.PROD_CMPS_ID||De.SVC_CMPS_SEQ||De.EQUIP_SEQ||"";return Ce=String(Ce).trim().padStart(2,"0"),ge=String(ge).trim().padStart(6,"0"),Be=String(Be||Ye+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Ot.crrId||"",WRKR_ID:t.WRKR_ID||Ot.userId||Ot.workerId||"",REG_UID:Ot.userId||Ot.workerId||"A20130708",ITEM_MID_CD:Ce,EQT_CL:ge,SVC_CMPS_ID:Be,EQT:Ce,EQT_CD:Ce,LENT:String(De.LENT||"10"),EQT_USE_STAT_CD:String(De.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(De.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(De.EQT_SALE_AMT||0),PROD_GRP:String(De.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(De.PROD_CD||t.PROD_CD||""),SVC_CD:String(De.SVC_CD||""),PROM_CNT:rt||"",SEL:"1",EQT_BASIC_YN:String(De.EQT_BASIC_YN||"N"),PROD_TYP:De.PROD_TYP,EQUIP_SEQ:De.EQUIP_SEQ}}),Ze=await Oh({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:rt||"",equipments:mt});if(Ze.MSGCODE==="SUCCESS"||Ze.MSGCODE==="0"||Ze.code==="SUCCESS")r==null||r("  .","success"),await ue(!0);else throw new Error(Ze.MESSAGE||Ze.message||"   .")}catch(ft){throw console.error("[] :",ft),r==null||r(ft.message||"     .","error",!0),ft}},at=async()=>{var Ke,rt,ft,Ot;if(F.length===0){r==null||r("    .","warning"),S(C,"fail");return}try{Z(!0),_e(!0),A(C," ...");const mt=localStorage.getItem("userInfo");if(!mt){A(C,"    ."),S(C,"fail"),Z(!1);return}const Ze=JSON.parse(mt),De=Ze.userId||Ze.id||"UNKNOWN",Ye=Pe=>{var ut,jt,Ve,$t,Ue;const Ct=((ut=Pe.actualEquipment)==null?void 0:ut.eqtClCd)||Pe.eqtClCd||((jt=Pe.actualEquipment)==null?void 0:jt.EQT_CL_CD)||"",Me=((Ve=Pe.actualEquipment)==null?void 0:Ve.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",lt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Ct.startsWith("0904")||Me==="02"||lt.includes("stb")||lt.includes(""))},Ce=Pe=>{var ut,jt,Ve,$t,Ue;const Ct=((ut=Pe.actualEquipment)==null?void 0:ut.eqtClCd)||Pe.eqtClCd||((jt=Pe.actualEquipment)==null?void 0:jt.EQT_CL_CD)||"",Me=((Ve=Pe.actualEquipment)==null?void 0:Ve.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",lt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Ct.startsWith("0902")||Me==="03"||lt.includes("modem")||lt.includes(""))},ge=F.find(Ye),Be=F.find(Ce),ce=((Ke=ge==null?void 0:ge.actualEquipment)==null?void 0:Ke.id)||"",Le=((rt=Be==null?void 0:Be.actualEquipment)==null?void 0:rt.id)||"",Xe=await Su(De,t.CTRT_ID||"",t.id,"SMR03",ce||((Ot=(ft=F[0])==null?void 0:ft.actualEquipment)==null?void 0:Ot.id)||"",Le||"");Xe.O_IFSVC_RESULT&&Xe.O_IFSVC_RESULT.startsWith("TRUE")?(A(C,` 

: ${Xe.O_IFSVC_RESULT||""}`),S(C,"success")):(A(C,` 

${Xe.MESSAGE||"   "}`),S(C,"fail"))}catch(mt){A(C,` 

${mt.message||"   "}`),S(C,"fail")}finally{Z(!1)}},We=(Ke,rt,ft)=>{const Ot={...ee,[Ke]:{...ee[Ke]||{},[rt]:ft==="1"?"0":"1"}};K(C,Ot)},Dt=()=>{if(!T||!I.some(Ye=>Ye.id===T.id))return;if(ae&&(ae.itemMidCd!==T.itemMidCd||ae.model!==T.model)){r==null||r("      .","warning");return}const rt=ae||te.find(Ye=>Ye.itemMidCd===T.itemMidCd&&Ye.model===T.model);if(!rt){r==null||r("      .","warning");return}if(F.find(Ye=>Ye.contractEquipment.id===rt.id)){r==null||r("   .","warning");return}const Ot={contractEquipment:rt,actualEquipment:T,macAddress:T.macAddress||"",installLocation:""},mt=[...F,Ot],Ze=I.filter(Ye=>Ye.id!==T.id);L(C,mt),P(C,Ze);const De={...ee};delete De[T.id],K(C,De),O(C,null),console.log("[-]  :",{:mt.length,:Ze.length}),r==null||r("   .","success")},Tt=x.useMemo(()=>{const Ke=new Set(F.map(ft=>ft.actualEquipment.id));let rt=J.filter(ft=>!Ke.has(ft.id));return ae&&(rt=rt.filter(ft=>ft.itemMidCd===ae.itemMidCd&&ft.model===ae.model)),rt},[F,J,ae]),St=()=>{se(!0),setTimeout(()=>{se(!1),r==null||r("    .","info")},500)},ze=async()=>{if(!(Ee||g)){Ne(!0);try{await ue(!0),r==null||r("  .","success")}catch(Ke){console.error("[-]  :",Ke),r==null||r("   .","error")}finally{Ne(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[Ee&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ei,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsxs("button",{onClick:ze,disabled:Ee||g,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${Ee||g?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ei,{className:`w-3.5 h-3.5 ${Ee?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[te.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{g||ie(!0)},disabled:g,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),d?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":y?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>f==null?void 0:f(),disabled:_||g,children:[_?s.jsx(jn,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":j==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":j==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!g&&!me&&at(),disabled:g||me,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>d?Re(!0):pe(!0),children:[s.jsx(nd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:d?"LDAP":""})]})]})]}),Q?te.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:te.map(Ke=>{const rt=F.find(Ot=>Ot.contractEquipment.id===Ke.id),ft=(ae==null?void 0:ae.id)===Ke.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${g?rt?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":ft?"border-blue-500 bg-blue-50 cursor-pointer":rt?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!g&&xe(Ke),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ke.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ke.model})]}),rt&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",rt.actualEquipment.model]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",rt.actualEquipment.serialNumber]}),rt.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",rt.macAddress]})]})]})},Ke.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!g&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!T||!F.some(Ke=>Ke.actualEquipment.id===(T==null?void 0:T.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!T)return;if(J.some(rt=>rt.id===T.id)){if(ye!=="stock"){r==null||r("  .   .","warning");return}const rt=F.findIndex(ft=>ft.actualEquipment.id===T.id);if(rt>=0){const ft=[...F];ft.splice(rt,1),L(C,ft),O(C,null),r==null||r("  .","success")}return}it(),ne("removal")},disabled:!T||!F.some(Ke=>Ke.actualEquipment.id===(T==null?void 0:T.id)),children:s.jsx(Rh,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!T||F.some(Ke=>Ke.actualEquipment.id===(T==null?void 0:T.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!T)return;if(I.some(Ot=>Ot.id===T.id)){Dt();return}if(!ae){r==null||r("   .","warning");return}const rt=F.find(Ot=>Ot.contractEquipment.id===ae.id&&!J.some(mt=>mt.id===Ot.actualEquipment.id)),ft=rt&&I.some(Ot=>Ot.id===rt.actualEquipment.id);if(rt&&!ft){r==null||r("   .","warning");return}bt()},disabled:!T||F.some(Ke=>Ke.actualEquipment.id===(T==null?void 0:T.id)),children:s.jsx(Th,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!g&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ye==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>ne("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),I.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ye==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:I.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ye==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>ne("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),ae&&Tt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ye==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:Tt.length})]})})]}),ye==="removal"?s.jsx(s.Fragment,{children:I.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:I.map((Ke,rt)=>{const ft=Ke.id,Ot=ee[ft]||{},mt=Ot.EQT_LOSS_YN==="1"||Ot.PART_LOSS_BRK_YN==="1"||Ot.EQT_BRK_YN==="1"||Ot.EQT_CABL_LOSS_YN==="1"||Ot.EQT_CRDL_LOSS_YN==="1",Ze=(T==null?void 0:T.id)===Ke.id,De=yN(Ke);return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Ze?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>et(Ke),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ke.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Ke.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Ke.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${mt?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:mt?"":""})]}),!De&&s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(Ye=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${Ot[Ye.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Ce=>{Ce.stopPropagation(),We(ft,Ye.key,Ot[Ye.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:Ot[Ye.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:Ye.label})]},Ye.key))}),De&&s.jsx("div",{className:"mt-2 text-xs text-orange-600 bg-orange-100 p-2 rounded",children:"   "})]},ft||rt)})})}):s.jsx(s.Fragment,{children:ae?Tt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:Tt.map(Ke=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(T==null?void 0:T.id)===Ke.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>et(Ke),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ke.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ke.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Ke.serialNumber]}),Ke.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Ke.macAddress]})]})]}),(T==null?void 0:T.id)===Ke.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Ke.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Ot;const Ke=t.WRK_CD_NM||kh(t.WRK_CD)||t.workType||"-",rt=t.PROD_NM||t.productName||((Ot=t.customer)==null?void 0:Ot.productName)||"-",ft=t.CTRT_STAT_NM||Cu(t.CTRT_STAT)||"-";return s.jsx(Ph,{isOpen:$,onClose:()=>ie(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:ft,prodGrp:t.PROD_GRP||"",prodNm:rt,wrkCdNm:Ke,onSave:At,showToast:r,installedEquipmentCount:F.length,customerEquipmentCount:H})})(),!g&&s.jsx("button",{onClick:St,disabled:le,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${le?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(jh,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(Wa,{isOpen:fe,onClose:()=>pe(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((dt=t.customer)==null?void 0:dt.id)}),s.jsx(Ah,{isOpen:de,onClose:()=>Re(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),X&&vu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!me&&_e(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Ke=>Ke.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:me?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(jn,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):j==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(Eh,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:k})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(Lo,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:k})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${j==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>_e(!1),disabled:me,children:me?" ...":""})})]})}),document.body)]})},l9=t=>{const{workItem:e}=t,n=e.WRK_CD;switch(n){case"01":return s.jsx(eR,{...t});case"02":return s.jsx(XU,{...t});case"03":return s.jsx(JU,{...t});case"04":return s.jsx(ZU,{...t});case"05":return s.jsx(e9,{...t});case"06":return s.jsx(t9,{...t});case"07":return s.jsx(r9,{...t});case"08":return s.jsx(i9,{...t});case"09":return s.jsx(a9,{...t});default:return console.warn(`[EquipmentRouter] Unknown WRK_CD: ${n}, using default (Install)`),s.jsx(eR,{...t})}},o9=({ctrtId:t,certifyOpLnkdCd:e,installedEquipments:n,showToast:r})=>{const[i,l]=x.useState(!1),{ldapResult:c,setLdapResult:d}=Ba();return{handleLdapConnect:async(m=!1)=>{const _=["F","FG","Z","ZG"].includes(e),y=["N","NG"].includes(e),g=n.some(C=>{var R,U,L,w;const v=((R=C.actualEquipment)==null?void 0:R.ITEM_MID_CD)||((U=C.actualEquipment)==null?void 0:U.itemMidCd)||((L=C.contractEquipment)==null?void 0:L.ITEM_MID_CD)||((w=C.contractEquipment)==null?void 0:w.itemMidCd)||C.ITEM_MID_CD||C.itemMidCd||"";return v==="02"||v==="31"}),N=n.some(C=>{var R,U,L,w;const v=((R=C.actualEquipment)==null?void 0:R.ITEM_MID_CD)||((U=C.actualEquipment)==null?void 0:U.itemMidCd)||((L=C.contractEquipment)==null?void 0:L.ITEM_MID_CD)||((w=C.contractEquipment)==null?void 0:w.itemMidCd)||C.ITEM_MID_CD||C.itemMidCd||"";return v==="10"||v==="32"});if(_){if(!g){r==null||r("FTTH  ONT  .","warning");return}if(!N){r==null||r("FTTH  AP  .","warning");return}}else if(y&&!N){r==null||r("  AP  .","warning");return}if(n.length<1){r==null||r(" .","warning");return}if(!t){r==null||r(" ID .","error");return}l(!0);try{console.log("[useLdapConnect]  :",{ctrtId:t,opLnkdCd:e});const C=await Cb(t);if(console.log("[useLdapConnect]  :",C),C.exists&&C.data.length>0){const v=C.data[0];d(v),r==null||r("LDAP  .","success")}else d({_empty:!0}),r==null||r("LDAP  . (  )","info")}catch(C){console.error("[useLdapConnect]  :",C),r==null||r(C.message||"LDAP  .","error")}finally{l(!1)}},ldapLoading:i,ldapResult:c,isLdapDone:!!c}},c9=["01","05","06","07"],d9=({equipList:t,portList:e,isFtth:n,onEquipChange:r,selectedEqipId:i,onClose:l,showToast:c,entrNo:d,entrRqstNo:u,workItem:f})=>{const m=t.find(q=>q.EQIP_ID===i),_=x.useMemo(()=>t.map(q=>({value:q.EQIP_ID,label:`${q.EQIP_ID} - ${q.ESTB_PLC_NM||q.EQIP_NM||""}`})),[t]),[y,g]=x.useState(!1),[N,C]=x.useState([]),[v,R]=x.useState(!1),[U,L]=x.useState(!1),[w,P]=x.useState([]),[G,K]=x.useState(""),[B,O]=x.useState(""),[S,A]=x.useState(!1),Y=async()=>{if(g(!0),!(N.length>0)){R(!0);try{const q=await Zm({COMMON_GRP:"LGCT015"});C(q||[])}catch(q){console.error("[PortStatusModal] LGCT015  :",q)}finally{R(!1)}}},te=async()=>{if(L(!0),!(w.length>0))try{const q=await Jl(["LGWO001"]),V=(q==null?void 0:q.LGWO001)||(q==null?void 0:q.output13)||[];P(Array.isArray(V)?V:[])}catch(q){console.error("[PortStatusModal] LGWO001  :",q)}},J=async(q,V)=>{if(!G){c==null||c(" .","warning");return}if(!B.trim()){c==null||c("  .","warning");return}A(!0);try{const F=await n4({ENTR_RQST_NO:q.entrRqstNo||"",CONS_REQ_RSN_CD:G,HSVC_INCR_RSN_CNTN:B,HSVC_CONS_RQMN_DIVS_CD:"2",SBGN_DEAL_NM:V.crrNm||V.name||"",SBGN_DEAL_TLNO:"",SBGN_EGNR_NM:V.name||V.userName||"",SBGN_EGNR_HPHN_TLNO:V.phone||V.hpNo||"",CTRT_ID:q.ctrtId||"",RCPT_ID:q.rcptId||"",WRK_ID:q.wrkId||"",ENTR_NO:d||""});F.RESULT_CD&&!F.RESULT_CD.startsWith("N")?(c==null||c(" .","success"),L(!1),K(""),O("")):c==null||c(F.RESULT_MSG||"  .","error")}catch(F){console.error("[PortStatusModal] Port :",F),c==null||c(F.message||"  .","error")}finally{A(!1)}};return y?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"LGU+ L2  "}),s.jsx("button",{onClick:()=>g(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(bi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"flex-1 overflow-auto p-3",children:v?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})}):N.length===0?s.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:" ."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-xs",style:{minWidth:"400px"},children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100",children:[s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:N.map((q,V)=>s.jsxs("tr",{className:`border-b border-gray-50 ${V%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("td",{className:"px-2 py-2 text-gray-900 whitespace-nowrap",children:q.COMMON_CD_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:q.REF_CODE||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:q.REF_CODE2||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:q.REF_CODE3||"-"})]},V))})]})})}),s.jsx("div",{className:"p-3 border-t border-gray-200 flex justify-end",children:s.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700",children:""})})]})}):U?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Port  "}),s.jsx("button",{onClick:()=>L(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(bi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:""}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-800 font-mono",children:d||"-"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:""}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-800",children:(()=>{try{const q=JSON.parse(localStorage.getItem("userInfo")||"{}");return q.name||q.userName||"-"}catch{return"-"}})()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:""}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-800 font-mono",children:(()=>{try{const q=JSON.parse(localStorage.getItem("userInfo")||"{}");return q.phone||q.hpNo||"-"}catch{return"-"}})()})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Zs,{value:G,onChange:q=>K(q),placeholder:"",options:w.map((q,V)=>({value:q.COMMON_CD||q.code||"",label:q.COMMON_CD_NM||q.name||q.COMMON_CD||""}))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:B,onChange:q=>O(q.target.value.slice(0,512)),placeholder:"     ",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg resize-none focus:border-orange-400 focus:outline-none"}),s.jsxs("div",{className:"text-right text-xs text-gray-400 mt-0.5",children:[B.length,"/512"]})]})]}),s.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[s.jsx("button",{onClick:()=>{const q=(()=>{try{return JSON.parse(localStorage.getItem("userInfo")||"{}")}catch{return{}}})(),V={entrRqstNo:u||"",ctrtId:(f==null?void 0:f.CTRT_ID)||(f==null?void 0:f.ctrtId)||"",rcptId:(f==null?void 0:f.RCPT_ID)||(f==null?void 0:f.rcptId)||(f==null?void 0:f.receiptId)||"",wrkId:(f==null?void 0:f.id)||(f==null?void 0:f.WRK_ID)||"",crrNm:(f==null?void 0:f.CRR_NM)||""};J({...V,crrNm:V.crrNm},{...q,crrNm:V.crrNm})},disabled:S,className:`w-full py-3 rounded-lg text-sm font-semibold transition-colors ${S?"bg-gray-300 text-gray-500":"bg-orange-500 text-white hover:bg-orange-600"}`,children:S?" ...":" "}),s.jsx("button",{onClick:()=>L(!1),className:"w-full py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700",children:""})]})]})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-900 whitespace-nowrap",children:["LGU+ ",n?"RN":"L2"," "]}),s.jsx("button",{onClick:l,className:"p-1 rounded-full hover:bg-gray-100",children:s.jsx(bi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length===0?s.jsx("div",{className:"text-center text-gray-500 py-8",children:"  ."}):s.jsxs(s.Fragment,{children:[n&&d&&s.jsxs("div",{className:"bg-purple-50 rounded-lg px-3 py-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-purple-600 font-semibold whitespace-nowrap",children:"LGU+ "}),s.jsx("span",{className:"text-xs font-mono font-bold text-purple-900 whitespace-nowrap",children:d})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 whitespace-nowrap",children:" "}),s.jsx(Zs,{value:i,onValueChange:r,options:_,placeholder:" "})]}),m&&s.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:n?s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-semibold truncate",children:m.MDL_NM||"-"})]}),s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"truncate",children:m.EQIP_ESTB_FLOO_NM||"-"})]})]}):s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-semibold truncate",children:m.ESTB_PLC_NM||"-"})]}),s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-semibold truncate",children:m.MDL_NM||"-"})]}),s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"truncate",children:m.EQIP_ESTB_FLOO_NM||"-"})]})]})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 whitespace-nowrap",children:" "}),s.jsxs("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:[e.length,""]})]}),s.jsxs("div",{className:"border rounded-lg overflow-hidden overflow-x-auto",children:[s.jsxs("div",{className:"grid grid-cols-4 bg-gray-100 text-xs font-semibold text-gray-600 px-2 py-2 border-b min-w-[320px]",children:[s.jsx("div",{className:"whitespace-nowrap",children:""}),s.jsx("div",{className:"whitespace-nowrap",children:"U+"}),s.jsx("div",{className:"whitespace-nowrap",children:""}),s.jsx("div",{className:"text-center whitespace-nowrap",children:""})]}),e.length===0?s.jsx("div",{className:"text-center text-gray-400 text-xs py-4",children:" "}):s.jsx("div",{className:"max-h-64 overflow-y-auto divide-y",children:e.map((q,V)=>s.jsxs("div",{className:`grid grid-cols-4 text-xs px-2 py-2 hover:bg-gray-50 min-w-[320px] ${q.PT_USE==="Y"?"bg-red-50/50":""}`,children:[s.jsx("div",{className:"font-mono whitespace-nowrap",children:q.PORT_NO||"-"}),s.jsx("div",{className:"font-mono text-gray-600 whitespace-nowrap truncate",children:q.ENTR_NO||"-"}),s.jsx("div",{className:"font-mono text-gray-600 whitespace-nowrap truncate",children:q.CTRT_ID||"-"}),s.jsx("div",{className:"text-center whitespace-nowrap",children:s.jsx("span",{className:`px-1.5 py-0.5 rounded text-[0.625rem] font-medium whitespace-nowrap ${q.PT_USE==="Y"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:q.PT_USE==="Y"?"":""})})]},V))})]})]})]})}),s.jsxs("div",{className:"p-4 border-t space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[!n&&s.jsxs("button",{onClick:Y,className:"flex-1 py-2 bg-purple-500 text-white rounded-lg font-semibold text-sm flex items-center justify-center gap-1.5 hover:bg-purple-600 transition-colors whitespace-nowrap",children:[s.jsx(s5,{className:"w-4 h-4 flex-shrink-0"}),"L2 "]}),s.jsx("button",{onClick:te,className:"flex-1 py-2 bg-orange-500 text-white rounded-lg font-semibold text-sm hover:bg-orange-600 transition-colors whitespace-nowrap",children:"Port"})]}),s.jsx("button",{onClick:l,className:"w-full py-2 bg-gray-600 text-white rounded-lg font-semibold",children:""})]})]})})},u9=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c=!1,isCertifyProd:d=!1,certifyOpLnkdCd:u=""})=>{const{setEquipmentData:f}=$i(),{entrNo:m,entrRqstNo:_,setEntrNo:y,lguMarketCd:g,lguOperatorId:N,lguJobType:C,lguJobTypeConf:v,setLguCommonCd:R,cl02PortData:U,setCl02PortData:L,isSubscriptionDone:w,setIsSubscriptionDone:P}=Ba(),G=t.id||t.WRK_ID||"",K=ji(Ee=>{var Ne;return((Ne=Ee.workStates[G])==null?void 0:Ne.installedEquipments)||[]}),{handleLdapConnect:B,ldapLoading:O,ldapResult:S,isLdapDone:A}=o9({ctrtId:t.DTL_CTRT_ID||t.CTRT_ID||"",certifyOpLnkdCd:u,installedEquipments:K,showToast:r}),[Y,te]=x.useState(!1),[J,q]=x.useState(!1),[V,F]=x.useState(!1),[I,ee]=x.useState([]),[ae,T]=x.useState([]),[j,k]=x.useState(""),Q=["F","FG","Z","ZG"].includes(u),[H,$]=x.useState({isOpen:!1,message:"",onConfirm:()=>{}}),ie=t.WRK_CD||"",fe=t.DTL_CTRT_ID||t.CTRT_ID||"",pe=c9.includes(ie),de=pe&&!w,Re=x.useCallback(()=>{if(pe&&!w){r==null||r("  .","warning");return}$({isOpen:!0,title:"LDAP ",message:"LDAP  ?",type:"confirm",onConfirm:()=>B(!0)})},[B,pe,w,U,r]),X=x.useCallback(()=>{try{const Ee=localStorage.getItem("userInfo");if(Ee)return JSON.parse(Ee)}catch{}return{}},[]);x.useEffect(()=>{if(!d||g)return;(async()=>{try{const Ne=await Jl(["LGCT002"]),ye=(Ne==null?void 0:Ne.LGCT002)||(Ne==null?void 0:Ne.output13);if(ye&&Array.isArray(ye)&&ye.length>0){const ne=ye[0];R(ne.REF_CODE||"",ne.REF_CODE2||"",ne.REF_CODE4||"",ne.REF_CODE5||""),console.log("[LGU+]  : MRKT_CD=",ne.REF_CODE,"OPERATOR_ID=",ne.REF_CODE2,"JOB_TYPE=",ne.REF_CODE4,"JOB_TYPE_CONF=",ne.REF_CODE5)}}catch(Ne){console.error("[LGU+]   :",Ne)}})()},[d,g,R]),x.useEffect(()=>{if(!d||!pe||!fe||m||w)return;(async()=>{var Ne;try{const ye=await Ny({CTRT_ID:fe}),ne=((Ne=ye==null?void 0:ye[0])==null?void 0:Ne.ENTR_NO)||"";ne&&(console.log("[LGU+]   :",ne),y(ne,null),P(!0))}catch(ye){console.error("[LGU+]   :",ye)}})()},[d,pe,fe,m,w]);const _e=async Ee=>{var ne,ue,xe;const Ne=X(),ye=Ne.userId||Ne.id||"";te(!0);try{if(Ee){const bt=t.CRR_ID||"",it=t.SO_ID||"",At=t.CUST_ID||((ne=t.customer)==null?void 0:ne.id)||"";(!bt||!it)&&console.warn("[LGU+]    - CRR_ID:",bt,"SO_ID:",it),await o5({CTRT_ID:fe,CUST_ID:At,WRK_ID:G,CRR_ID:bt,SO_ID:it,REG_UID:ye,CANCEL_TYPE:"SUBSCRIPTION",MRKT_CD:g,OPERATOR_ID:N}),console.log("[LGU+]    ")}const et=await t4({WRK_ID:G,CTRT_ID:fe,MRKT_CD:g,OPERATOR_ID:N,REG_UID:ye});if(et.RESULT_CD==="Y"){if(r==null||r("  .","success"),y(et.ENTR_NO||null,et.ENTR_RQST_NO||null),P(!0),S&&!S._empty){const bt=t.SO_ID||"";bt||console.warn("[LGU+] LDAP   - SO_ID ");try{(S.AP_MAC_ADDR||S.AP_EQT_NO)&&(await Sv({MSG_ID:"SMR05",EVNT_CD:"",CUST_ID:t.CUST_ID||((ue=t.customer)==null?void 0:ue.id)||"",CTRT_ID:fe,SO_ID:bt,AP_MAC:S.AP_MAC_ADDR||"",AP_EQT_NO:S.AP_EQT_NO||"",ONT_MAC:"",ONT_EQT_NO:"",REG_UID:ye,JOB_TYPE:C,JOB_TYPE_CONF:v,ENTR_NO:et.ENTR_NO||""}),console.log("[LGU+] AP   ")),(S.ONT_MAC_ADDR||S.ONT_EQT_NO)&&(await Sv({MSG_ID:"SMR05",EVNT_CD:"FM",CUST_ID:t.CUST_ID||((xe=t.customer)==null?void 0:xe.id)||"",CTRT_ID:fe,SO_ID:bt,AP_MAC:"000000000000",AP_EQT_NO:"",ONT_MAC:"",ONT_EQT_NO:"",REG_UID:ye,JOB_TYPE:C,JOB_TYPE_CONF:v,ENTR_NO:et.ENTR_NO||""}),console.log("[LGU+] ONT   "))}catch(it){console.warn("[LGU+] LDAP    ():",it)}}}else r==null||r(et.RESULT_MSG||"  .","error")}catch(et){console.error("[LGU+]  :",et),r==null||r(et.message||" .","error")}finally{te(!1)}},me=async()=>{var Ee;if(!fe){r==null||r(" ID .","error");return}if(!g||!N){r==null||r("LGU+    .    .","error"),console.error("[LGU+]   - lguMarketCd:",g,"lguOperatorId:",N);return}te(!0);try{const Ne=await Ny({CTRT_ID:fe}),ye=((Ee=Ne==null?void 0:Ne[0])==null?void 0:Ee.ENTR_NO)||"";te(!1),$(ye?{isOpen:!0,title:"U+  ",message:`  .
 ?`,type:"warning",onConfirm:()=>_e(ye)}:{isOpen:!0,title:"U+  ",message:"U+  ?",type:"confirm",onConfirm:()=>_e("")})}catch(Ne){te(!1),console.error("[LGU+]  :",Ne),r==null||r(Ne.message||" .","error")}},Z=async()=>{var ne;if(I.length>0){q(!0);return}if(!m){r==null||r("(ENTR_NO) .   .","error");return}const Ee=_?"01":"02",Ne=_||"null",ye=Q?"ftthEqipList":"opticEqipList";F(!0);try{const ue=await l5({COMMAND:ye,ENTR_NO:m,ENTR_RQST_NO:Ne,BIZ_TYPE:Ee,CTRT_ID:fe});if(!ue||ue.length===0){r==null||r("  .","info"),F(!1);return}if((ne=ue[0])!=null&&ne.RESULT_CD&&ue[0].RESULT_CD.startsWith("N")){r==null||r(` : ${ue[0].RESULT_MSG||""}`,"error"),F(!1);return}ee(ue);const xe=ue[0].EQIP_ID;k(xe);const bt=await Sy({COMMAND:Q?"ftthEqipPortList":"opticEqipPortList",EQIP_ID:xe,CTRT_ID:fe});T(bt||[]),q(!0)}catch(ue){console.error("[LGU+]  :",ue),r==null||r(ue.message||" .","error")}finally{F(!1)}},le=async Ee=>{k(Ee);const Ne=Q?"ftthEqipPortList":"opticEqipPortList";try{const ye=await Sy({COMMAND:Ne,EQIP_ID:Ee,CTRT_ID:fe});T(ye||[])}catch(ye){console.error("[LGU+]   :",ye),T([])}},se=Ee=>{console.log("[WorkEquipmentManagement]  :",Ee),f(Ee),e(Ee)};return s.jsxs("div",{className:"work-equipment-management",children:[d&&!c&&pe&&s.jsx("div",{className:"mx-3 mt-2 mb-1",children:s.jsx("div",{className:`rounded-lg border p-3 ${w?"bg-green-50 border-green-200":"bg-orange-50 border-orange-200"}`,children:s.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx(xh,{className:`w-5 h-5 flex-shrink-0 ${w?"text-green-600":"text-orange-600"}`}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:`text-sm font-semibold whitespace-nowrap ${w?"text-green-800":"text-orange-800"}`,children:"U+ "}),m&&s.jsxs("div",{className:"text-xs text-gray-600 truncate",children:[": ",s.jsx("span",{className:"font-mono font-semibold",children:m})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.jsx("button",{onClick:me,disabled:Y,className:`px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition-colors bg-orange-500 text-white hover:bg-orange-600 ${Y?"opacity-50":""}`,children:Y?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(jn,{className:"w-4 h-4 animate-spin"}),"..."]}):""}),s.jsx("button",{onClick:Z,disabled:V,className:"px-3 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200",children:V?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(jn,{className:"w-3 h-3 animate-spin"}),""]}):s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(yu,{className:"w-3 h-3"}),""]})})]})]})})}),d&&c&&m&&s.jsx("div",{className:"mx-3 mt-2 mb-1",children:s.jsx("div",{className:"rounded-lg border p-3 bg-green-50 border-green-200",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Vi,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-semibold text-green-800",children:""}),s.jsx("span",{className:"text-xs text-gray-600 font-mono",children:m})]})})}),s.jsx(l9,{workItem:t,onSave:se,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:l,readOnly:c,isCertifyProd:d,certifyOpLnkdCd:u,onLdapConnect:Re,isLdapDone:A,ldapLoading:O,ldapBlocked:de}),J&&s.jsx(d9,{equipList:I,portList:ae,isFtth:Q,onEquipChange:le,selectedEqipId:j,onClose:()=>q(!1),showToast:r,entrNo:m||"",entrRqstNo:_||"",workItem:t}),s.jsx(ul,{isOpen:H.isOpen,onClose:()=>$(Ee=>({...Ee,isOpen:!1})),onConfirm:H.onConfirm,title:H.title,message:H.message,type:H.type})]})},h9=[],f9=({workItem:t,showToast:e,readOnly:n=!1})=>{const[r,i]=x.useState(!1),[l,c]=x.useState(null),[d,u]=x.useState(null),[f,m]=x.useState(!1),[_,y]=x.useState(0),[g,N]=x.useState(null),[C,v]=x.useState(!1),[R,U]=x.useState(!1),[L,w]=x.useState(null),[P,G]=x.useState(null),[K,B]=x.useState([]),[O,S]=x.useState(""),[A,Y]=x.useState([]),[te,J]=x.useState(-1),[q,V]=x.useState(!1),[F,I]=x.useState(!1),[ee,ae]=x.useState(""),[T,j]=x.useState(""),[k,Q]=x.useState(!1),[H,$]=x.useState(!1),[ie,fe]=x.useState([]),[pe,de]=x.useState(!1),[Re,X]=x.useState(!1),{certifyRegconfInfo:_e,setCertifyRegconfInfo:me,certifyOpLnkdCd:Z,isLineRegistrationDone:le,setIsLineRegistrationDone:se,entrNo:Ee,lguMarketCd:Ne}=Ba(),ye=["F","FG","Z","ZG"].includes(Z),ne=()=>["F","FG","Z","ZG"].includes(Z)?"ftthEqipList":["V","VG"].includes(Z)?"vdslEqipList":"opticEqipList",ue=()=>["F","FG","Z","ZG"].includes(Z)?"ftthEqipPortList":["V","VG"].includes(Z)?"vdslEqipPortList":"opticEqipPortList",xe=t.id,et=ji(De=>{var Ye;return((Ye=De.workStates[xe])==null?void 0:Ye.installedEquipments)??h9}),bt=x.useMemo(()=>et.map(De=>{var Ye;return((Ye=De.actualEquipment)==null?void 0:Ye.id)||""}).sort().join(","),[et]),it=x.useRef(bt);x.useEffect(()=>{if(_e){const De=_e._equipmentFingerprint;if(De&&De!==bt){me(null);return}c(_e),m(!0)}},[]),x.useEffect(()=>{(async()=>{const Ye=t.CTRT_ID||"";if(Ye){Q(!0);try{const Ce=await Ny({CTRT_ID:Ye});if(Ce&&Ce.length>0){const ge=Ce[0];ae(ge.ENTR_NO||""),j(ge.ENTR_RQST_NO||"")}}catch(Ce){console.error("[] ENTR_NO  :",Ce)}finally{Q(!1)}}})()},[t.CTRT_ID]),x.useEffect(()=>{it.current!==bt&&(it.current=bt,f&&(c(null),me(null),m(!1),y(0),se(!1)))},[bt]),x.useEffect(()=>{it.current===bt&&f&&(c(null),me(null),m(!1),se(!1))},[_]);const{ontMac:At,apMac:at,ontSerial:We,apList:Dt}=x.useMemo(()=>{var Be;let De="",Ye="";const Ce=[];for(const ce of et){const Le=ce.actualEquipment||{},Xe=ce.contractEquipment||{},Pe=Le.itemMidCd||Le.ITEM_MID_CD||Xe.itemMidCd||Xe.ITEM_MID_CD||"",Ct=Le.macAddress||Le.MAC_ADDRESS||ce.macAddress||"",Me=Le.serialNumber||Le.EQT_SERNO||"";(Pe==="02"||Pe==="31")&&(De=Ct||Me,Ye=Me),(Pe==="10"||Pe==="32")&&Ce.push({mac:Ct||Me,serialNumber:Me,model:Le.model||Le.EQT_CL_NM||"",type:Xe.type||Le.type||"AP"})}const ge=Ce.length>0?((Be=Ce[_])==null?void 0:Be.mac)||Ce[0].mac:"";return{ontMac:De,apMac:ge,ontSerial:Ye,apList:Ce}},[et,_]),Tt=x.useCallback(async()=>{if(!n){if(!ee){w("ENTR_NO . LGU+  ."),e==null||e("ENTR_NO .","error");return}v(!0),w(null);try{const De=t.CTRT_ID||"",Ye=await bv({ENTR_NO:ee,CTRT_ID:De});if(!Ye||(Ye.RESULT_CD||"").startsWith("N")){const ut=(Ye==null?void 0:Ye.RESULT_MSG)||"L2  ";w(`LGU    (${De})
${ut}`),e==null||e(`L2  : ${ut}`,"error");return}const Ce=Ye.MDL_NM||"",ge=Ye.EQIP_ID||"",Be=Ye.PRT_INDX_NM||"",ce=Ye.ESTB_PLC_NM||"";try{await Nv({ENTR_NO:ee,ENTR_RQST_NO:T||"null",BIZ_TYPE:"01",CTRT_ID:De})}catch(ut){console.warn("[L2] getUplsEntrEqipDtl error (non-critical):",ut)}let Le="",Xe="",Pe="",Ct="";if(Ce)try{const ut=await Zm({COMMON_GRP:"LGCT015"});if(ut){const jt=ut.find(Ve=>Ve.COMMON_CD===Ce);jt&&(Le=jt.COMMON_CD_NM||"",Xe=jt.REF_CODE||"",Pe=jt.REF_CODE2||"",Ct=jt.REF_CODE3||"")}}catch(ut){console.warn("[L2] LGCT015 lookup error:",ut)}N({autoYn:"Y",buildingName:ce,portNo:Be,equipId:ge,modelNm:Le,maxSpeed:Xe,manufacturer:Pe,remarks:Ct,mdlNmRaw:Ce}),U(!0),me({..._e||{},EQIP_ID:ge,EQIP_PORT_NO:Be,EQIP_DIVS:"L2",DEL_YN:"N"}),e==null||e("L2  .","success")}catch{w("L2    ."),e==null||e("L2    .","error")}finally{v(!1)}}},[ee,T,t.CTRT_ID,n,_e,me,e]),St=x.useCallback(async()=>{var De;if(!(n||!ee)){V(!0),w(null);try{const Ye=t.CTRT_ID||"",Ce=await bv({ENTR_NO:ee,CTRT_ID:Ye});if(!Ce||(Ce.RESULT_CD||"").startsWith("N")){const Xe=(Ce==null?void 0:Ce.RESULT_MSG)||"OLT  ";w(`LGU OLT    (${Ye})
${Xe}`),e==null||e(`OLT  : ${Xe}`,"error");return}const ge={OLT_ID:Ce.EQIP_ID||"",OLT_MDL_NM:Ce.MDL_NM||"",OLT_PORT_NO:Ce.PRT_INDX_NM||"",ESTB_PLC_NM:Ce.ESTB_PLC_NM||""};G(ge);try{await Nv({ENTR_NO:ee,ENTR_RQST_NO:T||"null",BIZ_TYPE:"01",CTRT_ID:Ye})}catch(Xe){console.warn("[FTTH] getUplsEntrEqipDtl error:",Xe)}const Be=await l5({COMMAND:ne(),ENTR_NO:ee,ENTR_RQST_NO:T||"null",BIZ_TYPE:"01",CTRT_ID:Ye});if(!Be||Be.length===0){w("RN   ."),e==null||e("RN   .","warning");return}const ce=Be.map(Xe=>{const Pe={};for(const Ct of Object.keys(Xe))Pe[Ct.toUpperCase()]=Xe[Ct];return Pe});B(ce);const Le=((De=ce[0])==null?void 0:De.EQIP_ID)||"";S(Le),Le&&await dt(Le,Ye),e==null||e("FTTH  ","success")}catch(Ye){console.error("[FTTH]  :",Ye),w("FTTH    ."),e==null||e("FTTH  ","error")}finally{V(!1)}}},[ee,T,t.CTRT_ID,n,Z,e]),ze=x.useRef(!1);x.useEffect(()=>{ze.current||n||!ee||k||(ze.current=!0,ye?St():Tt())},[ee,k,n,ye,Tt,St]);const dt=async(De,Ye)=>{I(!0),J(-1);try{const ge=(await Sy({COMMAND:ue(),EQIP_ID:De,CTRT_ID:Ye})||[]).map(Be=>{const ce={};for(const Le of Object.keys(Be))ce[Le.toUpperCase()]=Be[Le];return ce});Y(ge)}catch(Ce){console.error("[FTTH]   :",Ce),Y([])}finally{I(!1)}},Ke=async De=>{S(De),J(-1);const Ye=t.CTRT_ID||"";De&&await dt(De,Ye)},rt=De=>{J(De);const Ye=A[De];if(!Ye||!P)return;me({..._e||{},OLT_ID:P.OLT_ID,OLT_PORT:P.OLT_PORT_NO,EQIP_ID:O,EQIP_PORT_NO:Ye.PORT_NO,EQIP_PORT_USE:Ye.PT_USE,PORT_ENTR_NO:Ye.ENTR_NO,EQIP_DIVS:"OLT",DEL_YN:"N"})},ft=x.useCallback(async()=>{if($(!0),!(ie.length>0)){de(!0);try{const De=await Zm({COMMON_GRP:"LGCT015"});fe(De||[])}catch(De){console.error("[L2] LGCT015  :",De)}finally{de(!1)}}},[ie.length]),Ot=async()=>{if(n)return;const De=_e;if(!(De!=null&&De.EQIP_PORT_NO)){e==null||e(" .    .","warning");return}X(!0),u(null);try{if(ye&&De.EQIP_PORT_USE==="Y"&&De.PORT_ENTR_NO!==(Ee||ee)){e==null||e("  .    .","error"),X(!1);return}if(!ye&&(Z==="N"||Z==="NG")){const Ye=(De.EQIP_PORT_NO||"").replace(/\//g,"__"),Ce=await s4({ENTR_NO:Ee||ee,EQIP_ID:De.EQIP_ID||"",PORT_NM:Ye,CTRT_ID:t.CTRT_ID||""});if(!Ce.success){e==null||e(`LGU+   
${Ce.RESULT_MSG}`,"error"),X(!1);return}if(Ce.ENTR_EXIST==="Y"){e==null||e("LGU+  .   .","error"),me(null),X(!1);return}}se(!0),e==null||e("LGU+  .","success")}catch(Ye){console.error("[]  :",Ye),u("    ."),e==null||e("  ","error")}finally{X(!1)}},mt=({label:De,value:Ye})=>s.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-gray-100 last:border-b-0",children:[s.jsx("span",{className:"text-xs text-gray-500",children:De}),s.jsx("span",{className:"text-xs font-medium text-gray-900 text-right max-w-[60%] truncate",children:Ye||"-"})]}),Ze=K.find(De=>De.EQIP_ID===O);return s.jsxs("div",{className:"px-3 sm:px-4 py-4 sm:py-6 pb-3 sm:pb-4 space-y-3 sm:space-y-4",children:[Dt.length>1&&!n&&s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 sm:p-4",children:[s.jsxs("h5",{className:"text-xs sm:text-sm font-semibold text-amber-800 mb-2 flex items-center gap-1.5",children:[s.jsx(v_,{className:"w-4 h-4"}),"AP  (",Dt.length," )"]}),s.jsx("div",{className:"space-y-2",children:Dt.map((De,Ye)=>s.jsxs("label",{className:`flex items-center gap-3 p-2.5 rounded-lg border cursor-pointer transition-colors ${_===Ye?"border-amber-400 bg-amber-100":"border-gray-200 bg-white hover:border-amber-300"}`,onClick:()=>y(Ye),children:[s.jsx("input",{type:"radio",name:"apSelect",checked:_===Ye,onChange:()=>y(Ye),className:"w-4 h-4 text-amber-600"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:[De.type," ",De.model&&`(${De.model})`]}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono truncate",children:["MAC: ",De.mac||"-"]})]})]},Ye))})]}),!ye&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("h5",{className:"text-xs sm:text-sm font-bold text-gray-900 flex items-center gap-1.5",children:[s.jsx(_v,{className:"w-4 h-4 text-purple-500"}),"()",R&&s.jsx(Vi,{className:"w-3.5 h-3.5 text-green-500 ml-1"}),C&&s.jsx("div",{className:"w-3.5 h-3.5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin ml-1"})]})}),L&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mb-2 flex items-start gap-1.5",children:[s.jsx(Wr,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-red-700",children:L})]}),s.jsxs("div",{className:"space-y-0",children:[s.jsx(mt,{label:"",value:"L2"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.autoYn)||"-"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.buildingName)||"-"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.portNo)||"-"}),s.jsx(mt,{label:"ID",value:(g==null?void 0:g.equipId)||"-"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.modelNm)||"-"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.maxSpeed)||"-"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.manufacturer)||"-"}),s.jsx(mt,{label:"",value:(g==null?void 0:g.remarks)||"-"})]}),s.jsx("div",{className:"mt-2 flex justify-end",children:s.jsxs("button",{onClick:ft,className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-1 transition-colors",children:[s.jsx(s5,{className:"w-3 h-3"})," L2 "]})})]}),ye&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("h5",{className:"text-xs sm:text-sm font-bold text-gray-900 flex items-center gap-1.5",children:[s.jsx(_v,{className:"w-4 h-4 text-orange-500"}),"(OLT)",P&&s.jsx(Vi,{className:"w-3.5 h-3.5 text-green-500 ml-1"}),q&&s.jsx("div",{className:"w-3.5 h-3.5 border-2 border-orange-500 border-t-transparent rounded-full animate-spin ml-1"})]})}),L&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mb-2 flex items-start gap-1.5",children:[s.jsx(Wr,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-red-700",children:L})]}),s.jsxs("div",{className:"space-y-0",children:[s.jsx(mt,{label:"",value:"OLT"}),s.jsx(mt,{label:"",value:(P==null?void 0:P.OLT_MDL_NM)||"-"}),s.jsx(mt,{label:"",value:(P==null?void 0:P.OLT_PORT_NO)||"-"}),s.jsx(mt,{label:"",value:(P==null?void 0:P.ESTB_PLC_NM)||"-"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-4",children:[s.jsxs("h5",{className:"text-xs sm:text-sm font-bold text-gray-900 mb-2 flex items-center gap-1.5",children:[s.jsx(gv,{className:"w-4 h-4 text-orange-500"}),"RN  "]}),K.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-1.5",children:"RN  "}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:O,onChange:De=>Ke(De.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg bg-white appearance-none pr-8 focus:border-orange-400 focus:outline-none",children:K.map(De=>s.jsxs("option",{value:De.EQIP_ID,children:[De.EQIP_ID," - ",De.MDL_NM||De.EQIP_NM||""]},De.EQIP_ID))}),s.jsx(sr,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),Ze&&s.jsxs("div",{className:"mt-1.5 grid grid-cols-2 gap-x-4 gap-y-1",children:[s.jsx(mt,{label:"",value:Ze.MDL_NM||"-"}),s.jsx(mt,{label:"",value:Ze.EQIP_ESTB_FLOO_NM||"-"})]})]}),A.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-xs font-semibold text-gray-700 mb-1.5",children:["  (",A.length,")"]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsx("div",{className:"max-h-48 overflow-y-auto",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600 border-b",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-center font-semibold text-gray-600 border-b",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600 border-b",children:"ID"})]})}),s.jsx("tbody",{children:A.map((De,Ye)=>s.jsxs("tr",{onClick:()=>!n&&rt(Ye),className:`cursor-pointer transition-colors ${te===Ye?"bg-orange-100 border-l-2 border-l-orange-500":De.PT_USE==="Y"?"bg-red-50/50":Ye%2===0?"bg-white":"bg-gray-50/50"} hover:bg-orange-50`,children:[s.jsx("td",{className:"px-2 py-1.5 font-mono border-b",children:De.PORT_NO||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-center border-b",children:s.jsx("span",{className:`px-1.5 py-0.5 rounded text-[0.625rem] font-medium ${De.PT_USE==="Y"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:De.PT_USE==="Y"?"":""})}),s.jsx("td",{className:"px-2 py-1.5 font-mono text-gray-600 border-b",children:De.ENTR_NO||"-"})]},`${De.EQIP_ID}-${De.PORT_NO}-${Ye}`))})]})})})]}),F&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"inline-block w-5 h-5 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"   ..."})]})]})]}),!n&&s.jsx("button",{onClick:Ot,disabled:Re||le,className:`w-full py-3 sm:py-4 rounded-xl font-semibold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${le?"bg-green-500 text-white cursor-default":Re?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600 text-white"}`,children:le?s.jsxs(s.Fragment,{children:[s.jsx(Vi,{className:"w-4 h-4 sm:w-5 sm:h-5"})," "]}):Re?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(gv,{className:"w-4 h-4 sm:w-5 sm:h-5"}),""]})}),d&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 sm:p-4 flex items-start gap-2",children:[s.jsx(Wr,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs sm:text-sm text-red-700",children:d})]}),le&&!n&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 sm:p-4",children:s.jsx("p",{className:"text-xs sm:text-sm text-green-700",children:" .       ."})}),H&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"LGU+ L2  "}),s.jsx("button",{onClick:()=>$(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(bi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"flex-1 overflow-auto p-3",children:pe?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})}):ie.length===0?s.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:" ."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-xs",style:{minWidth:"400px"},children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100",children:[s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:ie.map((De,Ye)=>s.jsxs("tr",{className:`border-b border-gray-50 ${Ye%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("td",{className:"px-2 py-2 text-gray-900 whitespace-nowrap",children:De.COMMON_CD_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:De.REF_CODE||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:De.REF_CODE2||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:De.REF_CODE3||"-"})]},Ye))})]})})}),s.jsx("div",{className:"p-3 border-t border-gray-200 flex justify-end",children:s.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700",children:""})})]})})]})},tR=({order:t,onBack:e,onComplete:n,showToast:r})=>{var P,G;const[i,l]=x.useState(!1),[c,d]=x.useState(!0),[u,f]=x.useState(!0),[m,_]=x.useState(!0),[y,g]=x.useState(""),N=t.WRK_CD||"",C=["01","03","05","07"].includes(N);x.useEffect(()=>{const K=t.PYM_MTHD||"",B=t.ATMT_YN||"";["01","05","07"].includes(N)&&K==="01"&&B==="Y"?(_(!1),g("/Email")):(_(!0),g(""))},[N,t]),x.useEffect(()=>{(async()=>{var O,S;const B=t.WRK_DRCTN_ID;if(!B){console.log("[PostProcess] WRK_DRCTN_ID ,    ");const A=t.SIGN_TYP||"",Y=t.CUST_CL||((O=t.customer)==null?void 0:O.CUST_CL)||"",te=t.PDA_CLICK_YN||"";d(A==="NN"||Y==="H"||te==="Y");return}try{console.log("[PostProcess] getAfterProcInfo :",B);const A=await p5(B);if(A)console.log("[PostProcess] getAfterProcInfo :",A),d(A.WRK_DRCTN_PRNT_YN!=="Y"),f(A.CLOSE_DANGER!=="Y"),A.AUTO_PAYMENTS_YN==="Y"&&(_(!1),g("/Email"));else{const Y=t.SIGN_TYP||"",te=t.CUST_CL||((S=t.customer)==null?void 0:S.CUST_CL)||"",J=t.PDA_CLICK_YN||"";d(Y==="NN"||te==="H"||J==="Y")}}catch(A){console.error("[PostProcess] getAfterProcInfo :",A)}})()},[t]);const v=()=>{r==null||r("     .","info")},R=()=>{r==null||r("AS     .","info")},U=()=>{if(c){r==null||r("  .","warning");return}r==null||r("()   ","info")},L=()=>{if(u){r==null||r("  .","warning");return}r==null||r("()   ","info")},w=()=>{if(m){r==null||r("  .","warning");return}r==null||r("   ","info")};return s.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-slate-600 to-slate-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:" "})}),s.jsxs("div",{className:"p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:((P=t.customer)==null?void 0:P.name)||t.CUST_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-sm font-medium text-gray-800",children:t.typeDisplay||t.WRK_CD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-sm font-medium text-gray-800 text-right max-w-[60%] truncate",children:t.PROD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-start py-1.5",children:[s.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs text-gray-700 text-right ml-2",children:((G=t.customer)==null?void 0:G.address)||t.ST_ADDR||"-"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:" "})}),s.jsx("div",{className:"p-4 space-y-3",children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("button",{type:"button",onClick:v,className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-50 hover:bg-blue-100 active:bg-blue-200 text-blue-700 rounded-lg font-semibold transition-all text-sm border border-blue-200",children:[s.jsx("span",{children:""}),s.jsx(Nm,{className:"w-3.5 h-3.5"})]}),s.jsxs("button",{type:"button",onClick:R,className:"flex items-center justify-center gap-2 px-4 py-3 bg-orange-50 hover:bg-orange-100 active:bg-orange-200 text-orange-700 rounded-lg font-semibold transition-all text-sm border border-orange-200",children:[s.jsx("span",{children:"AS"}),s.jsx(Nm,{className:"w-3.5 h-3.5"})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:""})}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("button",{type:"button",onClick:U,disabled:c,className:`w-full flex items-center justify-center gap-2 px-4 py-3.5 rounded-lg font-semibold transition-all text-sm ${c?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white shadow-sm"}`,children:[s.jsx("span",{children:" ()"}),!c&&s.jsx(Nm,{className:"w-3.5 h-3.5"})]}),s.jsxs("button",{type:"button",onClick:L,disabled:u,className:`w-full flex items-center justify-center gap-2 px-4 py-3.5 rounded-lg font-semibold transition-all text-sm ${u?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-500 hover:bg-green-600 active:bg-green-700 text-white shadow-sm"}`,children:[s.jsx("span",{children:" ()"}),!u&&s.jsx(Nm,{className:"w-3.5 h-3.5"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-cyan-600 to-cyan-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:"/"})}),s.jsx("div",{className:"p-4",children:s.jsxs("button",{type:"button",onClick:w,disabled:m,className:`w-full flex items-center justify-center gap-2 px-4 py-3.5 rounded-lg font-semibold transition-all text-sm ${m?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-cyan-500 hover:bg-cyan-600 active:bg-cyan-700 text-white shadow-sm"}`,children:[s.jsx("span",{children:y}),!m&&s.jsx(Nm,{className:"w-3.5 h-3.5"})]})})]}),C&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>l(!i),className:"w-full flex items-center justify-between px-4 py-3.5 bg-amber-50 hover:bg-amber-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-amber-800",children:" "}),i?s.jsx(Mr,{className:"w-5 h-5 text-amber-600"}):s.jsx(sr,{className:"w-5 h-5 text-amber-600"})]}),i&&s.jsx("div",{className:"p-4 bg-white border-t border-amber-100",children:s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"  ."})})]}),s.jsx("div",{className:"pt-2 pb-4",children:s.jsx("button",{type:"button",onClick:n,className:"w-full px-4 py-4 bg-gradient-to-r from-slate-700 to-slate-800 hover:from-slate-800 hover:to-slate-900 active:from-slate-900 active:to-black text-white rounded-xl font-bold text-base shadow-lg transition-all",children:""})})]})},m9=({prodCd:t,soId:e,isCertifyProdField:n})=>{const[r,i]=x.useState([]),[l,c]=x.useState(!1),[d,u]=x.useState([]),[f,m]=x.useState(!1),[_,y]=x.useState([]),[g,N]=x.useState(!1),C=l&&f&&g;x.useEffect(()=>{(async()=>{try{const w=(await ka("CMIF006")).map(P=>P.code||P.COMMON_CD);i(w),console.log("[useCertifyDetection] CMIF006 SO :",w.length,"")}catch(L){console.error("[useCertifyDetection] CMIF006  :",L)}c(!0)})()},[]),x.useEffect(()=>{(async()=>{try{const L=await ex();u(L),console.log("[useCertifyDetection] CertifyProdMap:",L.length,"")}catch(L){console.error("[useCertifyDetection] CertifyProdMap  :",L)}m(!0)})()},[]),x.useEffect(()=>{(async()=>{try{const w=(await ka("LGCT001")).map(P=>({code:P.code||P.COMMON_CD,opLnkdCd:P.ref_code8||""}));y(w),console.log("[useCertifyDetection] LGCT001 UPLS :",w.length,"")}catch(L){console.error("[useCertifyDetection] LGCT001  :",L)}N(!0)})()},[]);const v=x.useMemo(()=>{const U=_.find(w=>w.code===t),L=!!U;return console.log("[useCertifyDetection] PROD_CD:",t,"| SO_ID:",e,"| LGCT001:",U?U.opLnkdCd:"N/A","| result:",L),L},[t,e,_]),R=x.useMemo(()=>{const U=_.find(L=>L.code===t);return(U==null?void 0:U.opLnkdCd)||""},[t,_]);return{isCertifyProd:v,certifyOpLnkdCd:R,isLoaded:C,certifyProdList:d,certifySoList:r,uplsProdList:_}},g9=({workItem:t,onComplete:e,onBack:n,showToast:r})=>{var V;const i=t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status==="";t.WRK_STAT_CD==="1"||t.WRK_STAT_CD;const{currentStep:l,setCurrentStep:c,setCurrentWorkId:d,equipmentData:u,setEquipmentData:f,filteringData:m,setFilteringData:_}=$i(),[y,g]=x.useState(null),{isCertifyProd:N,certifyOpLnkdCd:C,isLoaded:v}=m9({prodCd:t.PROD_CD||"",soId:t.SO_ID||"",isCertifyProdField:t.IS_CERTIFY_PROD});x.useEffect(()=>{d(t.id);const F=()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),document.documentElement.scrollTop=0,document.body.scrollTop=0};F(),requestAnimationFrame(()=>{F()}),setTimeout(()=>{F()},50)},[t.id,d]),x.useEffect(()=>{(async()=>{var I;if(!(t.WRK_CD!=="01"&&t.WRK_CD!=="02")&&!i)try{const ee=await tx({WRK_ID:t.id,RCPT_ID:t.RCPT_ID,CUST_ID:((I=t.customer)==null?void 0:I.id)||t.CUST_ID});if(ee){const ae=ee.OST_WORKABLE_STAT||"";if(ae==="0"||ae==="1"||ae==="4"){const T=t.WRK_CD==="01"?"    .":"    .";r==null||r(T,"warning",!0)}}}catch(ee){console.error("[WorkProcessFlow] OST   :",ee)}})()},[t.id,t.WRK_CD,t.RCPT_ID,(V=t.customer)==null?void 0:V.id,t.CUST_ID,i,r]),x.useEffect(()=>{(async()=>{var ee;const I=t.WRK_CD==="05"&&t.DTL_CTRT_ID||t.CTRT_ID;try{const ae=localStorage.getItem("userInfo"),T=ae?JSON.parse(ae):{};console.log("[WorkProcessFlow]   - WRK_CD:",t.WRK_CD,"CTRT_ID:",I||"()");const j=await to({WRKR_ID:T.workerId||"A20130708",SO_ID:t.SO_ID||T.soId,WRK_ID:t.id,CUST_ID:((ee=t.customer)==null?void 0:ee.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:I||"",OLD_CTRT_ID:t.WRK_CD==="05"?t.CTRT_ID:null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null}),k={kpiProdGrpCd:j.kpiProdGrpCd,prodChgGb:j.prodChgGb,chgKpiProdGrpCd:j.chgKpiProdGrpCd,prodGrp:j.prodGrp,upCtrlCl:j.upCtrlCl,prodPromoInfo:j.prodPromoInfo||[]};if(g(j),_(k),["02","08","09"].includes(t.WRK_CD||"")||(f({installedEquipments:[],removedEquipments:[],prodPromoInfo:j.prodPromoInfo||[],...k}),console.log("[WorkProcessFlow]   - prodPromoInfo :",(j.prodPromoInfo||[]).length,"")),["02","08","09"].includes(t.WRK_CD||"")){const $=localStorage.getItem("userInfo"),ie=$?JSON.parse($):{},fe=(j.removedEquipments||[]).map(pe=>{var de;return{id:pe.EQT_NO,type:pe.ITEM_MID_NM,model:pe.EQT_CL_NM,serialNumber:pe.EQT_SERNO,itemMidCd:pe.ITEM_MID_CD,eqtClCd:pe.EQT_CL_CD||pe.EQT_CL,macAddress:pe.MAC_ADDRESS||pe.MAC_ADDR,CUST_ID:((de=t.customer)==null?void 0:de.id)||t.CUST_ID,CTRT_ID:t.CTRT_ID,EQT_NO:pe.EQT_NO,ITEM_CD:pe.ITEM_CD||"",EQT_SERNO:pe.EQT_SERNO,WRK_ID:t.id,WRK_CD:t.WRK_CD,EQT_CL:pe.EQT_CL||pe.EQT_CL_CD||"",EQT_CL_CD:pe.EQT_CL_CD||pe.EQT_CL||"",ITEM_MID_CD:pe.ITEM_MID_CD||"",SVC_CMPS_ID:pe.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:pe.BASIC_PROD_CMPS_ID||"",MST_SO_ID:pe.MST_SO_ID||t.SO_ID||ie.soId,SO_ID:pe.SO_ID||t.SO_ID||ie.soId,REG_UID:ie.userId||ie.workerId||"A20230019",EQT_LOSS_YN:"0",PART_LOSS_BRK_YN:"0",EQT_BRK_YN:"0",EQT_CABL_LOSS_YN:"0",EQT_CRDL_LOSS_YN:"0"}});f({installedEquipments:[],removedEquipments:fe,prodPromoInfo:j.prodPromoInfo||[],...k}),console.log("[WorkProcessFlow]    :",fe.length,", prodPromoInfo:",(j.prodPromoInfo||[]).length,"")}}catch(ae){console.error(" API Pre-loading :",ae)}})()},[t.id]);const R=()=>{var ee,ae,T,j,k,Q;if(((ee=u==null?void 0:u.installedEquipments)==null?void 0:ee.length)>0||((ae=u==null?void 0:u.removedEquipments)==null?void 0:ae.length)>0)return console.log("[WorkProcessFlow] Store     - "),u;const F=`equipment_draft_${t.id}`,I=localStorage.getItem(F);if(I)try{const H=JSON.parse(I),$=H.installedEquipments&&H.installedEquipments.length>0,ie=H.markedForRemoval&&H.markedForRemoval.length>0;if($||ie){const fe=localStorage.getItem("userInfo"),pe=fe?JSON.parse(fe):{},de=t.DTL_CTRT_ID||t.CTRT_ID,Re=(H.markedForRemoval||[]).map(me=>{var le,se;const Z=((le=H.removalStatus)==null?void 0:le[me.id])||{};return{...me,id:me.id,type:me.type,model:me.model,serialNumber:me.serialNumber,itemMidCd:me.itemMidCd,EQT_NO:me.id,EQT_SERNO:me.serialNumber,ITEM_MID_CD:me.itemMidCd,EQT_CL_CD:me.eqtClCd,MAC_ADDRESS:me.macAddress,WRK_ID:t.id,CUST_ID:((se=t.customer)==null?void 0:se.id)||t.CUST_ID,CTRT_ID:de,WRK_CD:t.WRK_CD,CHG_YN:t.WRK_CD==="05"?"Y":void 0,SVC_CMPS_ID:me.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:me.BASIC_PROD_CMPS_ID||"",MST_SO_ID:me.MST_SO_ID||t.SO_ID||pe.soId,SO_ID:me.SO_ID||t.SO_ID||pe.soId,REG_UID:pe.userId||pe.workerId||"A20230019",EQT_LOSS_YN:Z.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:Z.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:Z.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:Z.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:Z.EQT_CRDL_LOSS_YN||"0"}}),X=(H.installedEquipments||[]).map(me=>{const Z=me.actualEquipment||{},le=me.contractEquipment||{};return{actualEquipment:{...Z,id:Z.id,type:Z.type,model:Z.model,serialNumber:Z.serialNumber,itemMidCd:Z.itemMidCd,eqtClCd:Z.eqtClCd,macAddress:me.macAddress||Z.macAddress,BASIC_PROD_CMPS_ID:Z.BASIC_PROD_CMPS_ID||le.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:Z.EQT_PROD_CMPS_ID||le.SVC_CMPS_ID||le.id,PROD_CD:Z.PROD_CD||le.PROD_CD||t.PROD_CD,SVC_CD:Z.SVC_CD||le.SVC_CD||"",SVC_CMPS_ID:Z.SVC_CMPS_ID||le.SVC_CMPS_ID||le.id,EQT_SALE_AMT:Z.EQT_SALE_AMT||"0",MST_SO_ID:Z.MST_SO_ID||t.SO_ID||pe.soId,SO_ID:Z.SO_ID||t.SO_ID||pe.soId,OLD_LENT_YN:Z.OLD_LENT_YN||"N",LENT:Z.LENT||"10",ITLLMT_PRD:Z.ITLLMT_PRD||"00",EQT_USE_STAT_CD:Z.EQT_USE_STAT_CD||"1",EQT_CHG_GB:Z.EQT_CHG_GB||"1",IF_DTL_ID:Z.IF_DTL_ID||""},contractEquipment:{...le,id:le.id,SVC_CMPS_ID:le.SVC_CMPS_ID||le.id,BASIC_PROD_CMPS_ID:le.BASIC_PROD_CMPS_ID||"",PROD_CD:le.PROD_CD||"",SVC_CD:le.SVC_CD||""},macAddress:me.macAddress||Z.macAddress}}),_e={installedEquipments:X,removedEquipments:Re,kpiProdGrpCd:(m==null?void 0:m.kpiProdGrpCd)||H.kpiProdGrpCd,prodChgGb:(m==null?void 0:m.prodChgGb)||H.prodChgGb,chgKpiProdGrpCd:(m==null?void 0:m.chgKpiProdGrpCd)||H.chgKpiProdGrpCd,prodGrp:(m==null?void 0:m.prodGrp)||H.prodGrp,upCtrlCl:(m==null?void 0:m.upCtrlCl)||H.upCtrlCl};return console.log("[WorkProcessFlow] localStorage   :",{installed:_e.installedEquipments.length,removed:_e.removedEquipments.length,_PROD_CD:(j=(T=X[0])==null?void 0:T.actualEquipment)==null?void 0:j.PROD_CD,_SVC_CMPS_ID:(Q=(k=X[0])==null?void 0:k.actualEquipment)==null?void 0:Q.SVC_CMPS_ID}),_e}}catch(H){console.error("   :",H)}return null};F3(t.WRK_CD||"");const U=t.WRK_CD||"",L=N&&!i&&U!=="08"&&U!=="02",w=L?6:5,P=x.useMemo(()=>L?[{id:1,title:" ",completed:i||l>1},{id:2,title:" ",completed:i||l>2},{id:3,title:" ",completed:i||l>3},{id:4,title:" ",completed:i||l>4},{id:5,title:" ",completed:i||l>5},{id:6,title:"",completed:l>6}]:[{id:1,title:" ",completed:i||l>1},{id:2,title:" ",completed:i||l>2},{id:3,title:" ",completed:i||l>3},{id:4,title:" ",completed:i||l>4},{id:5,title:"",completed:l>5}],[L,i,l]);x.useEffect(()=>{l>w&&c(w)},[l,w]);const G=()=>{window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0},K=()=>{if(!N)return!0;const F=ji.getState().getWorkState(t.id),I=(F==null?void 0:F.installedEquipments)||[],ee=(F==null?void 0:F.contractEquipments)||[];if(console.log("[FTTH ] :",ee.length," | :",I.length,""),I.length===0)return r==null||r("  .","error"),!1;for(const ae of ee)if(!I.some(j=>{var k;return((k=j.contractEquipment)==null?void 0:k.id)===ae.id})){const j=ae.type||ae.EQT_CL_NM||"ONT-PON";return r==null||r(` ${j}  .`,"error"),!1}return console.log("[FTTH ]  -   "),!0},B=F=>{if(!L)return!0;const I=Ba.getState(),ee=["N","NG"].includes(C);return F>=4&&ee&&!I.ldapResult?(r==null||r("LDAP   .","warning"),!1):F>=5&&!I.certifyRegconfInfo?(r==null||r("  .","warning"),!1):!0},O=(F=!1)=>{var I,ee,ae,T,j;if(l<w){const k=l+1;if(L&&k>=4&&(!K()||!B(k)))return;if(l===3&&!F){const Q=R();Q&&f(Q)}if(l===3){const Q=ji.getState().getWorkState(t.id),H=fe=>fe?fe.EQT_LOSS_YN==="Y"||fe.EQT_LOSS_YN==="1"||fe.PART_LOSS_BRK_YN==="Y"||fe.PART_LOSS_BRK_YN==="1"||fe.EQT_BRK_YN==="Y"||fe.EQT_BRK_YN==="1"||fe.EQT_CABL_LOSS_YN==="Y"||fe.EQT_CABL_LOSS_YN==="1"||fe.EQT_CRDL_LOSS_YN==="Y"||fe.EQT_CRDL_LOSS_YN==="1":!1,$=fe=>{if(!fe)return"";const pe=[];return(fe.EQT_LOSS_YN==="Y"||fe.EQT_LOSS_YN==="1")&&pe.push(""),(fe.PART_LOSS_BRK_YN==="Y"||fe.PART_LOSS_BRK_YN==="1")&&pe.push(""),(fe.EQT_BRK_YN==="Y"||fe.EQT_BRK_YN==="1")&&pe.push(""),(fe.EQT_CABL_LOSS_YN==="Y"||fe.EQT_CABL_LOSS_YN==="1")&&pe.push(""),(fe.EQT_CRDL_LOSS_YN==="Y"||fe.EQT_CRDL_LOSS_YN==="1")&&pe.push(""),pe.length>0?pe.join(", "):""};console.log(""),console.log(" [Step 34]    (workEquipmentStore)"),console.log(""),console.log("  (installedEquipments):",((I=Q==null?void 0:Q.installedEquipments)==null?void 0:I.length)||0,""),(ee=Q==null?void 0:Q.installedEquipments)==null||ee.forEach((fe,pe)=>{const de=fe.actualEquipment||{},Re=fe.contractEquipment||{};console.log(`  [${pe}] ${Re.type||de.type||""} | : ${de.model||"-"} | S/N: ${de.serialNumber||"-"}`)}),console.log(""),console.log("  (markedForRemoval):",((ae=Q==null?void 0:Q.markedForRemoval)==null?void 0:ae.length)||0,""),(T=Q==null?void 0:Q.markedForRemoval)==null||T.forEach((fe,pe)=>{var Z;const de=fe.id||fe.EQT_NO,Re=((Z=Q==null?void 0:Q.removalStatus)==null?void 0:Z[de])||{},X=H(Re),_e=$(Re),me=X?`  (${_e})`:" ";console.log(`  [${pe}] ${fe.type||fe.ITEM_MID_NM||""} | : ${fe.model||"-"} | S/N: ${fe.serialNumber||"-"}  ${me}`)}),console.log(""),console.log("  (removeEquipments - API):",((j=Q==null?void 0:Q.removeEquipments)==null?void 0:j.length)||0,""),console.log(""),console.log(" removalStatus  :");const ie=Object.keys((Q==null?void 0:Q.removalStatus)||{});ie.length>0?ie.forEach(fe=>{var Re;const pe=(Re=Q==null?void 0:Q.removalStatus)==null?void 0:Re[fe],de=H(pe);console.log(`  "${fe}"  ${de?"":""}`,pe)}):console.log("  ( -  )"),console.log("")}c(Q=>Q+1),requestAnimationFrame(()=>G())}},S=()=>{l>1&&(c(F=>F-1),requestAnimationFrame(()=>G()))},A=F=>{var I,ee,ae,T,j;if(!(L&&F>=4&&(!K()||!B(F)))){if(l===3&&F!==3){const k=R();if(k&&f(k),F>3){const Q=ji.getState().getWorkState(t.id),H=fe=>fe?fe.EQT_LOSS_YN==="Y"||fe.EQT_LOSS_YN==="1"||fe.PART_LOSS_BRK_YN==="Y"||fe.PART_LOSS_BRK_YN==="1"||fe.EQT_BRK_YN==="Y"||fe.EQT_BRK_YN==="1"||fe.EQT_CABL_LOSS_YN==="Y"||fe.EQT_CABL_LOSS_YN==="1"||fe.EQT_CRDL_LOSS_YN==="Y"||fe.EQT_CRDL_LOSS_YN==="1":!1,$=fe=>{if(!fe)return"";const pe=[];return(fe.EQT_LOSS_YN==="Y"||fe.EQT_LOSS_YN==="1")&&pe.push(""),(fe.PART_LOSS_BRK_YN==="Y"||fe.PART_LOSS_BRK_YN==="1")&&pe.push(""),(fe.EQT_BRK_YN==="Y"||fe.EQT_BRK_YN==="1")&&pe.push(""),(fe.EQT_CABL_LOSS_YN==="Y"||fe.EQT_CABL_LOSS_YN==="1")&&pe.push(""),(fe.EQT_CRDL_LOSS_YN==="Y"||fe.EQT_CRDL_LOSS_YN==="1")&&pe.push(""),pe.length>0?pe.join(", "):""};console.log(""),console.log(` [Step 3${F}]    (workEquipmentStore)`),console.log(""),console.log("  (installedEquipments):",((I=Q==null?void 0:Q.installedEquipments)==null?void 0:I.length)||0,""),(ee=Q==null?void 0:Q.installedEquipments)==null||ee.forEach((fe,pe)=>{const de=fe.actualEquipment||{},Re=fe.contractEquipment||{};console.log(`  [${pe}] ${Re.type||de.type||""} | : ${de.model||"-"} | S/N: ${de.serialNumber||"-"}`)}),console.log(""),console.log("  (markedForRemoval):",((ae=Q==null?void 0:Q.markedForRemoval)==null?void 0:ae.length)||0,""),(T=Q==null?void 0:Q.markedForRemoval)==null||T.forEach((fe,pe)=>{var Z;const de=fe.id||fe.EQT_NO,Re=((Z=Q==null?void 0:Q.removalStatus)==null?void 0:Z[de])||{},X=H(Re),_e=$(Re),me=X?`  (${_e})`:" ";console.log(`  [${pe}] ${fe.type||fe.ITEM_MID_NM||""} | : ${fe.model||"-"} | S/N: ${fe.serialNumber||"-"}  ${me}`)}),console.log(""),console.log("  (removeEquipments - API):",((j=Q==null?void 0:Q.removeEquipments)==null?void 0:j.length)||0,""),console.log(""),console.log(" removalStatus  :");const ie=Object.keys((Q==null?void 0:Q.removalStatus)||{});ie.length>0?ie.forEach(fe=>{var Re;const pe=(Re=Q==null?void 0:Q.removalStatus)==null?void 0:Re[fe],de=H(pe);console.log(`  "${fe}"  ${de?"":""}`,pe)}):console.log("  ( -  )"),console.log("")}}c(F),requestAnimationFrame(()=>G())}},Y=F=>{f({...F,prodPromoInfo:F.prodPromoInfo||(u==null?void 0:u.prodPromoInfo)||[],kpiProdGrpCd:F.kpiProdGrpCd||(u==null?void 0:u.kpiProdGrpCd),prodChgGb:F.prodChgGb||(u==null?void 0:u.prodChgGb),chgKpiProdGrpCd:F.chgKpiProdGrpCd||(u==null?void 0:u.chgKpiProdGrpCd),prodGrp:F.prodGrp||(u==null?void 0:u.prodGrp),upCtrlCl:F.upCtrlCl||(u==null?void 0:u.upCtrlCl)}),O(!0)},te=()=>{O()},J=()=>s.jsxs("div",{className:"flex items-center px-2 pt-3 sm:pt-4 pb-2 sm:pb-3 bg-white w-full",children:[s.jsx("button",{onClick:S,disabled:l<=1,className:`
          w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center rounded-full transition-all flex-shrink-0
          ${l<=1?"text-gray-300 cursor-not-allowed":"text-blue-600 hover:bg-blue-50 active:bg-blue-100"}
        `,style:{marginBottom:"18px"},children:s.jsx(mb,{className:"w-6 h-6 sm:w-7 sm:h-7",strokeWidth:2.5})}),s.jsx("div",{className:"flex items-center justify-between flex-1 mx-1",children:P.map((F,I)=>s.jsxs(Gi.Fragment,{children:[s.jsxs("div",{className:"flex flex-col items-center gap-0.5 sm:gap-1 cursor-pointer transition-all",onClick:()=>A(F.id),children:[s.jsx("div",{className:`
                  w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center font-bold text-xs sm:text-sm transition-all
                  ${l===F.id?"bg-blue-500 text-white shadow-lg scale-110":F.completed?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}
                `,children:F.completed?s.jsx(dc,{className:"w-4 h-4 sm:w-5 sm:h-5"}):F.id}),s.jsx("div",{className:`
                  text-[0.5625rem] sm:text-[0.625rem] font-medium text-center transition-all whitespace-nowrap
                  ${l===F.id?"text-blue-600 font-bold":F.completed?"text-green-600":"text-gray-500"}
                `,children:F.title})]}),I<P.length-1&&s.jsx("div",{className:`flex-1 h-0.5 mx-1 rounded-full ${F.completed?"bg-green-400":"bg-gray-200"}`,style:{marginBottom:"18px",maxWidth:"24px"}})]},F.id))}),s.jsx("button",{onClick:O,disabled:l>=w,className:`
          w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center rounded-full transition-all flex-shrink-0
          ${l>=w?"text-gray-300 cursor-not-allowed":"text-blue-600 hover:bg-blue-50 active:bg-blue-100"}
        `,style:{marginBottom:"18px"},children:s.jsx(rL,{className:"w-6 h-6 sm:w-7 sm:h-7",strokeWidth:2.5})})]}),q=()=>{switch(l){case 1:return s.jsx(QU,{workItem:t,onNext:O,onBack:S});case 2:return s.jsx(VU,{workItem:t,onNext:O,onBack:S,showToast:r});case 3:return s.jsx(u9,{workItem:t,onSave:Y,onBack:S,showToast:r,preloadedApiData:y,onPreloadedDataUpdate:g,readOnly:i,isCertifyProd:N,certifyOpLnkdCd:C});case 4:return L?s.jsx(f9,{workItem:t,onNext:O,onBack:S,showToast:r,readOnly:i}):s.jsx(j_,{order:t,onBack:S,onSuccess:te,showToast:r,equipmentData:u||m,readOnly:i,isCertifyProd:N,onEquipmentRefreshNeeded:()=>{console.log("[WorkProcessFlow]   -   "),g(null)}});case 5:return L?s.jsx(j_,{order:t,onBack:S,onSuccess:te,showToast:r,equipmentData:u||m,readOnly:i,isCertifyProd:N,onEquipmentRefreshNeeded:()=>{console.log("[WorkProcessFlow]   -   "),g(null)}}):s.jsx(tR,{order:t,onBack:S,onComplete:e,showToast:r});case 6:return s.jsx(tR,{order:t,onBack:S,onComplete:e,showToast:r});default:return null}};return v?s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden",children:[s.jsxs("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 shadow-sm",children:[i&&s.jsx("div",{className:"bg-green-50 border-b border-green-200 px-3 sm:px-4 py-1.5 sm:py-2",children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 sm:gap-2",children:[s.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-green-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-[0.625rem] sm:text-xs font-medium text-green-800 whitespace-nowrap",children:"  ( )"})]})}),J()]}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:q()})]}):s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-gray-50",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"   ..."})]})},p9=({message:t,type:e="info",onClose:n})=>{const r=()=>{switch(e){case"success":return s.jsx(Vi,{className:"w-8 h-8 text-green-500"});case"error":return s.jsx(Lo,{className:"w-8 h-8 text-red-500"});case"warning":return s.jsx(Wr,{className:"w-8 h-8 text-yellow-500"});default:return s.jsx(i5,{className:"w-8 h-8 text-blue-500"})}},i=()=>{switch(e){case"success":return"bg-green-500 hover:bg-green-600 active:bg-green-700";case"error":return"bg-red-500 hover:bg-red-600 active:bg-red-700";case"warning":return"bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700";default:return"bg-blue-500 hover:bg-blue-600 active:bg-blue-700"}},l=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";default:return""}};return s.jsxs("div",{className:"fixed inset-0 flex items-center justify-center",style:{zIndex:9999},children:[s.jsx("div",{className:"fixed inset-0 bg-black/40",onClick:n}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-[85vw] max-w-[320px] overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col items-center px-6 pt-6 pb-4",children:[r(),s.jsx("h3",{className:"mt-3 text-base font-bold text-gray-900",children:l()}),s.jsx("p",{className:"mt-2 text-sm text-gray-600 text-center leading-relaxed whitespace-pre-line",children:t})]}),s.jsx("div",{className:"px-6 pb-6",children:s.jsx("button",{onClick:n,className:`w-full py-3 text-sm font-semibold text-white rounded-xl transition-colors ${i()}`,children:""})})]})]})},_9=({isOpen:t,onClose:e,userName:n="",userId:r="",stats:i={todayInProgress:0,todayCompleted:0,weekTotal:0,monthTotal:0},onLogout:l,onNavigate:c})=>{const{fontScale:d,setFontScale:u,preferredNavApp:f,setPreferredNavApp:m}=Yl(),_=[{key:"small",label:"",size:"14px"},{key:"medium",label:"",size:"16px"},{key:"large",label:"",size:"18px"},{key:"xlarge",label:" ",size:"20px"}],y=[{key:"kakao",label:"",letter:"K",color:"bg-yellow-400 text-yellow-900"},{key:"tmap",label:"T",letter:"T",color:"bg-blue-500 text-white"},{key:"naver",label:"",letter:"N",color:"bg-green-500 text-white"}],g=()=>{l&&(l(),e())},N=C=>{c&&c(C),e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:e,"aria-hidden":"true",style:{zIndex:9998}}),s.jsx("div",{className:`fixed top-0 left-0 h-full w-80 bg-white shadow-2xl transform transition-transform duration-300 ease-out ${t?"translate-x-0":"-translate-x-full"}`,style:{touchAction:"pan-y",zIndex:9999},children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"bg-blue-600 p-6 relative",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white hover:bg-white/20 rounded-full p-2 transition-colors","aria-label":"",children:s.jsx(bi,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[s.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(Ih,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"text-white",children:[s.jsx("p",{className:"text-xl font-bold",children:n}),s.jsx("p",{className:"text-sm text-white/90",children:r})]})]})]}),s.jsxs("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:" "}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-600",children:" "}),s.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.todayInProgress})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.todayCompleted})]})]})]})}),s.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-600",children:" "}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.weekTotal})]})}),s.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-600",children:" "}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.monthTotal})]})})]})]}),s.jsxs("nav",{className:"flex-1 p-4 overflow-y-auto",children:[s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>N("today-work"),children:[s.jsx(Cf,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:" "})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>N("work-management"),children:[s.jsx(Z_,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>N("customer-management"),children:[s.jsx(a5,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>N("equipment-management"),children:[s.jsx(yf,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>N("other-management"),children:[s.jsx(n5,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})})]}),s.jsxs("div",{className:"mt-4 px-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:_.map(C=>s.jsxs("button",{onClick:()=>u(C.key),className:`flex flex-col items-center py-2 rounded-lg border-2 transition-all ${d===C.key?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("span",{className:`font-bold ${d===C.key?"text-blue-600":"text-gray-700"}`,style:{fontSize:C.size},children:""}),s.jsx("span",{className:`text-[0.625rem] mt-0.5 ${d===C.key?"text-blue-600 font-semibold":"text-gray-500"}`,children:C.label})]},C.key))})]}),s.jsxs("div",{className:"mt-4 px-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:y.map(C=>s.jsxs("button",{onClick:()=>m(C.key),className:`flex flex-col items-center py-2 rounded-lg border-2 transition-all ${f===C.key?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold ${C.color}`,children:C.letter}),s.jsx("span",{className:`text-[0.625rem] mt-1 ${f===C.key?"text-blue-600 font-semibold":"text-gray-500"}`,children:C.label})]},C.key))})]})]}),s.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200",children:s.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors font-medium text-sm sm:text-base",children:[s.jsx(YL,{className:"w-5 h-5"}),s.jsx("span",{children:""})]})})]})})]})};class x9 extends x.Component{constructor(e){super(e),this.handleReload=()=>{window.location.reload()},this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n),this.setState({error:e,errorInfo:n}),console.error("Production Error:",{error:e.toString(),componentStack:n.componentStack})}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg p-8",children:[s.jsx("div",{className:"flex items-center justify-center mb-6",children:s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"  .      ."})]}),!1,s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("button",{onClick:this.handleReload,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})," "]}),!1]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center text-sm text-gray-500",children:"   ."})]})}):this.props.children}}const C9="/api",y9=(t,e)=>{const n=t.replace(/[-\s]/g,"");if(!n)return" .";if(n.length<9)return"  .";let r="",i="";if(n.slice(-4),n.startsWith("02")?(r=n.substring(0,2),i=n.substring(2,n.length-4)):n.startsWith("0130")?(r=n.substring(0,4),i=n.substring(4,n.length-4)):(r=n.substring(0,3),i=n.substring(3,n.length-4)),i.length<3||i==="111"||i==="1111")return"  .";if(r==="010"&&i.length<4)return"  .";if(e==="hp"&&!["010","011","016","017","018","019"].includes(r))return"  .";if(r!=="0130"&&i.startsWith("0"))return"  .";let l=0;for(let c=0;c<n.length-1;c++)if(n[c]===n[c+1]){if(l++,l>=6)return"  ."}else l=0;return null},b9=t=>{const e=t.replace(/[^0-9]/g,"");let n="",r="";const i=e.slice(-4);return e.startsWith("02")?(n=e.substring(0,2),r=e.substring(2,e.length-4)):e.startsWith("0130")?(n=e.substring(0,4),r=e.substring(4,e.length-4)):(n=e.substring(0,3),r=e.substring(3,e.length-4)),{ddd:n,fix:r,dtl:i}},_n=async(t,e={},n="POST")=>{try{const r=`${C9}${t}`,i=await fetch(r,{method:n,headers:{"Content-Type":"application/json"},credentials:"include",body:n==="POST"?JSON.stringify(e):void 0});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const l=await i.json();return Array.isArray(l)?{success:!0,data:l}:l.code==="SUCCESS"||l.resultCode==="0000"||l.success?{success:!0,data:l.data||l.resultData||l,totalCount:l.totalCount||l.resultCount}:{success:!1,message:l.message||l.resultMsg||"  .",errorCode:l.code||l.resultCode||l.errorCode}}catch(r){return console.error("[CustomerAPI] Error:",r),{success:!1,message:r instanceof Error?r.message:"  ."}}},Tx=()=>{try{const t=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(t){const e=JSON.parse(t);return e.userId||e.USR_ID||e.LOGIN_ID||"SYSTEM"}}catch{console.log("[CustomerAPI] Failed to get LOGIN_ID from session")}return"SYSTEM"},zu=t=>{const e=()=>{if(t.ADDR_DTL)return t.ADDR_DTL;if(t.ADDR_FULL){const d=t.ADDR_FULL,u=t.ADDRESS||t.ADDR||"";return u&&d.startsWith(u+" "+u)?d.substring(u.length+1):d}const l=[],c=t.ADDRESS||t.ADDR||"";return c&&l.push(c),t.BUN_NO&&l.push(`${t.BUN_NO}`),t.HO_NM&&l.push(`${t.HO_NM}`),t.BLD_NM&&l.push(t.BLD_NM),l.join(" ")||""},n=()=>{const l=[],c=t.TEL_NO||t.TEL_NO1||"";c&&l.push({type:"tel",typeNm:"",number:c,fieldName:"TEL_NO"});const d=t.HP_NO||t.TEL_NO2||"";d&&l.push({type:"hp",typeNm:"",number:d,fieldName:"HP_NO"});for(let u=3;u<=9;u++){const f=`TEL_NO${u}`,m=t[f];if(m){const _=m.startsWith("010")||m.startsWith("011")||m.startsWith("016")||m.startsWith("017")||m.startsWith("018")||m.startsWith("019");l.push({type:_?"hp":"tel",typeNm:_?`${u-1}`:`${u-1}`,number:m,fieldName:f})}}return l},r=e(),i=n();return{CUST_ID:t.CUST_ID||"",CUST_NM:t.CUST_NM||"",TEL_NO:t.TEL_NO||t.TEL_NO1||"",HP_NO:t.HP_NO||t.TEL_NO2||"",PHONE_LIST:i.length>0?i:void 0,CUST_ADDR:r||t.CUST_ADDR||t.ADDR||t.ADDRESS||"",ROAD_ADDR:t.ROAD_ADDR||r||"",INST_ADDR:t.INST_ADDR||r||"",BILL_ADDR:t.BILL_ADDR||"",UNPAY_AMT:t.UNPAY_AMT||0,CUST_TP_CD:t.CUST_TP_CD||t.CUST_TP||"",CUST_TP_NM:t.CUST_TP_NM||t.CUST_CL_NM||"",GRP_NO:t.GRP_NO||t.GRP_ID||"",GRP_NM:t.GRP_NM||"",REG_DT:t.REG_DT||"",CTRT_ID:t.CTRT_ID||""}},N9=t=>{const e=r=>r==null||r==="None"||r==="null"?"":r,n=r=>r==null||r==="None"||r==="null"?0:r;return{CTRT_ID:e(t.CTRT_ID),CTRT_STAT_CD:e(t.CTRT_STAT_CD)||e(t.CTRT_STAT),CTRT_STAT_NM:e(t.CTRT_STAT_NM),PROD_NM:e(t.PROD_NM)||e(t.BASIC_PROD_CD_NM),PROD_GRP_NM:e(t.PROD_GRP_NM),INST_ADDR:e(t.INST_ADDR)||e(t.ADDR_FULL)||e(t.ADDR),INSTL_LOC:e(t.INSTL_LOC),POST_ID:e(t.POST_ID),OPNG_DT:e(t.OPNG_DT)||e(t.OPEN_DD),TERM_DT:e(t.TERM_DT),AGMT_MON:e(t.AGMT_MON)||(t.PROM_CNT!=null&&t.PROM_CNT!=="None"?String(t.PROM_CNT):""),AGMT_ST_DT:e(t.AGMT_ST_DT)||e(t.RATE_STRT_DT),AGMT_END_DT:e(t.AGMT_END_DT)||e(t.RATE_END_DT),GRP_NO:e(t.GRP_NO)||e(t.GRP_ID),GRP_NM:e(t.GRP_NM),PYM_ACNT_ID:e(t.PYM_ACNT_ID),DPST_AMT:n(t.DPST_AMT)||n(t.ASSR_BAL),PREPAY_AMT:n(t.PREPAY_AMT)||n(t.PREPD_BAL),EQT_NM:e(t.EQT_NM),EQT_MDL_NM:e(t.EQT_MDL_NM)||e(t.VIEW_MOD_NM),EQT_SERNO:e(t.EQT_SERNO)||e(t.SERNO_DTOA),PREV_MON_AMT:n(t.PREV_MON_AMT)||n(t.BILL_AMT_BEFORE),CUR_MON_AMT:n(t.CUR_MON_AMT)||n(t.BILL_AMT_NOW),SO_NM:e(t.SO_NM),SO_ID:e(t.SO_ID),PROD_GRP:e(t.PROD_GRP),STREET_ADDR_FULL:e(t.STREET_ADDR_FULL)||e(t.ROAD_ADDR),ADDR_FULL:e(t.ADDR_FULL)||e(t.JIBUN_ADDR),CTRT_APLY_STRT_DT:e(t.CTRT_APLY_STRT_DT),CTRT_APLY_END_DT:e(t.CTRT_APLY_END_DT),NOTRECEV:e(t.NOTRECEV)||e(t.NOT_RECV),CLOSE_DANGER:e(t.CLOSE_DANGER),ADDR_DTL:e(t.ADDR_DTL),BLD_CL:e(t.BLD_CL)||"0",BLD_NM:e(t.BLD_NM),BLD_ID:e(t.BLD_ID),BUN_CL:e(t.BUN_CL),BUN_NO:e(t.BUN_NO),HO_NM:e(t.HO_NM),APT_DONG_NO:e(t.APT_DONG_NO),APT_HO_CNT:e(t.APT_HO_CNT),STREET_ID:e(t.STREET_ID)}},S9=async t=>{let e="SYSTEM";try{const n=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(n){const r=JSON.parse(n);e=r.userId||r.USR_ID||r.LOGIN_ID||"SYSTEM"}}catch{console.log("[CustomerAPI] Failed to get LOGIN_ID from session")}if(t.searchType==="CUSTOMER_ID"&&t.customerId){const n={CUST_ID:t.customerId,SERCH_GB:"3",LOGIN_ID:e},r=await _n("/customer/common/customercommon/getConditionalCustList2",n);if(r.success&&r.data){const l=(Array.isArray(r.data)?r.data:[r.data]).map(zu);return{...r,data:l}}return{...r,data:[]}}if(t.searchType==="CONTRACT_ID"&&t.contractId){let n="";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const l=JSON.parse(i),c=l.authSoList||l.AUTH_SO_List||[];c.length>0&&(n=c[0].SO_ID||c[0].soId||""),n||(n=l.soId||l.SO_ID||"")}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session")}if(n)try{console.log("[CustomerAPI] Trying getCtrtIDforSmartPhone for CONTRACT_ID: "+t.contractId);const i=await _n("/customer/phoneNumber/getCtrtIDforSmartPhone",{SO_ID:n,CTRT_ID:t.contractId});if(i.success&&i.data){const l=Array.isArray(i.data)?i.data:[i.data];if(l.length>0){console.log("[CustomerAPI] getCtrtIDforSmartPhone success for CONTRACT_ID");const c=l.map(zu);return{...i,data:c}}}console.log("[CustomerAPI] getCtrtIDforSmartPhone returned no data for CONTRACT_ID, trying fallback...")}catch(i){console.log("[CustomerAPI] getCtrtIDforSmartPhone failed for CONTRACT_ID, trying fallback...",i)}const r=await _n("/customer/negociation/getCustomerCtrtInfo",{CTRT_ID:t.contractId});if(r.success&&r.data){const i=Array.isArray(r.data)?r.data[0]:r.data,l=i==null?void 0:i.CUST_ID;if(l){const c=await _n("/customer/common/customercommon/getConditionalCustList2",{CUST_ID:l,SERCH_GB:"3",LOGIN_ID:e});if(c.success&&c.data){const u=(Array.isArray(c.data)?c.data:[c.data]).map(zu);return{...c,data:u}}}}return{success:!1,message:"ID    .",data:[]}}if(t.searchType==="PHONE_NAME"){if(!t.phoneNumber&&!t.customerName)return{success:!1,message:"   .",data:[]};let n="";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const l=JSON.parse(i),c=l.authSoList||l.AUTH_SO_List||[];c.length>0&&(n=c[0].SO_ID||c[0].soId||""),n||(n=l.soId||l.SO_ID||"")}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session")}if(n)try{const i={SO_ID:n};t.phoneNumber&&(i.TEL_NO=t.phoneNumber),t.customerName&&(i.CUST_NM=t.customerName);const l=await _n("/customer/phoneNumber/getCtrtIDforSmartPhone",i);if(l.success&&l.data){const c=Array.isArray(l.data)?l.data:[l.data];if(c.length>0){console.log("[CustomerAPI] getCtrtIDforSmartPhone success:",c.length,"results");const d=c.map(zu);return{...l,data:d}}}console.log("[CustomerAPI] getCtrtIDforSmartPhone returned no data, trying fallback...")}catch(i){console.log("[CustomerAPI] getCtrtIDforSmartPhone failed, trying fallback...",i)}const r={SERCH_GB:"3",LOGIN_ID:e};t.phoneNumber&&(r.TEL_NO=t.phoneNumber),t.customerName&&(r.CUST_NM=t.customerName);try{const i=await _n("/customer/common/customercommon/getConditionalCustList2",r);if(i.success&&i.data){const c=(Array.isArray(i.data)?i.data:[i.data]).map(zu);return{...i,data:c}}return{...i,data:[]}}catch{return{success:!1,message:"   . ID .",data:[]}}}if(t.searchType==="EQUIPMENT_NO"&&t.equipmentNo){const n={SERCH_GB:"3",LOGIN_ID:e,EQT_SERNO:t.equipmentNo,MAC_ADDR:""};try{const r=await _n("/customer/common/customercommon/getConditionalCustList2",n);if(r.success&&r.data){const l=(Array.isArray(r.data)?r.data:[r.data]).map(zu);return{...r,data:l}}return{...r,data:[]}}catch{return{success:!1,message:"   . ID .",data:[]}}}return{success:!1,message:"  .",data:[]}},v9=async t=>{let e="SYSTEM";try{const r=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(r){const i=JSON.parse(r);e=i.userId||i.USR_ID||i.LOGIN_ID||"SYSTEM"}}catch{console.log("[CustomerAPI] Failed to get session info")}const n={SERCH_GB:"3",LOGIN_ID:e};t.custId&&(n.CUST_ID=t.custId),t.contractId&&(n.CTRT_ID=t.contractId),t.phoneNumber&&(n.TEL_NO=t.phoneNumber),t.equipmentNo&&(n.EQT_SERNO=t.equipmentNo),t.customerName&&!t.custId&&!t.contractId&&!t.phoneNumber&&!t.equipmentNo&&(n.CUST_NM=t.customerName);try{const r=await _n("/customer/common/customercommon/getConditionalCustList2",n);if(r.success&&r.data){const l=(Array.isArray(r.data)?r.data:[r.data]).map(zu);return{...r,data:l}}return{...r,data:[]}}catch(r){return console.error("[CustomerAPI] searchCustomerAll :",r),{success:!1,message:"   .",data:[]}}},Ex=async t=>{const e=await _n("/customer/negociation/getCustCtrtAll",{CUST_ID:t});if(e.success&&e.data){const r=(Array.isArray(e.data)?e.data:[e.data]).map(N9);return{...e,data:r}}return e},bN=async t=>{const e=Tx(),n=await _n("/customer/negociation/getCustAccountInfo_m",{CUST_ID:t,LOGIN_ID:e});return n.success&&n.data?{success:!0,data:n.data.filter(i=>i.PYM_ACNT_ID&&/^\d{10}$/.test(i.PYM_ACNT_ID)).map(i=>({PYM_ACNT_ID:i.PYM_ACNT_ID,PYM_MTHD_NM:i.PYM_MTHD_NM||"",BANK_CARD_NM:i.BANK_CARD_NM||null,BANK_CARD_NO:i.BANK_CARD_NO||null,BILL_MTHD:i.BILL_MTHD||"",UPYM_AMT_ACNT:i.UPYM_AMT??i.UPYM_AMT_ACNT??0,SO_ID:i.SO_ID||void 0})),code:"SUCCESS",message:"OK"}:n},sR=async(t,e)=>{const n=Tx(),r={CUST_ID:t,LOGIN_ID:n};return e&&(r.PYM_ACNT_ID=e),_n("/customer/negociation/getCustBillInfo_m",r)},D9=async t=>_n("/customer/negociation/getHPPayList",{CUST_ID:t}),R9=async t=>_n("/customer/negociation/saveHPPayInfo",t),V_=async(t,e,n=10)=>{const r=Tx(),i={CUST_ID:t,PAGE_SIZE:n,LOGIN_ID:r};return e&&(i.CTRT_ID=e),_n("/customer/negociation/getTgtCtrtRcptHist_m",i)},$_=async(t,e,n=10)=>{const r=Tx(),i={CUST_ID:t,PAGE_SIZE:n,LOGIN_ID:r};return e&&(i.CTRT_ID=e),_n("/customer/negociation/getTgtCtrtWorkList_m",i)},T9=async t=>{let e=t.CHG_UID||"SYSTEM";try{const n=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(n){const r=JSON.parse(n);e=r.userId||r.USR_ID||e}}catch{console.log("[CustomerAPI] Failed to get CHG_UID from session")}return _n("/customer/negociation/updateCustTelDetailInfo",{...t,CHG_UID:e,TEL_NO_TP:t.TEL_NO_TP||"2",USE_YN:t.USE_YN||"Y",MAIN_TEL_YN:t.MAIN_TEL_YN||"N",CUST_REL:t.CUST_REL||""})},nR=async t=>{let e=t.CHG_UID||"SYSTEM";try{const n=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(n){const r=JSON.parse(n);e=r.userId||r.USR_ID||e}}catch{console.log("[CustomerAPI] Failed to get CHG_UID from session")}return _n("/customer/etc/saveMargeAddrOrdInfo",{CTRT_ID:t.CTRT_ID,POST_ID:t.POST_ID,BLD_ID:t.BLD_ID||"",BUN_NO:t.BUN_NO||"",HO_NM:t.HO_NM||"",BLD_CL:t.BLD_CL||"0",BLD_NM:t.BLD_NM||"",APT_DONG_NO:t.APT_DONG_NO||"",APT_HO_CNT:t.APT_HO_CNT||"",ADDR_DTL:t.ADDR_DTL||"",STREET_ID:(t.STREET_ID||"").substring(0,10),INSTL_LOC:t.INSTL_LOC||"",CUST_FLAG:t.CUST_FLAG||"0",PYM_FLAG:t.PYM_FLAG||"0",CHG_UID:e})},Qj=async t=>{let e=t.USR_ID||"MOBILE_USER",n=t.SO_ID||"",r=t.MST_SO_ID||"";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const l=JSON.parse(i);if(e=l.userId||l.USR_ID||e,!n){const c=l.authSoList||l.AUTH_SO_List||[];c.length>0&&(n=c[0].SO_ID||c[0].soId||""),n||(n=l.soId||l.SO_ID||"")}r||(r=l.mstSoId||l.MST_SO_ID||n)}}catch{console.log("[CustomerAPI] Failed to get session info for payment change")}return _n("/customer/customer/general/customerPymChgAddManager",{...t,USR_ID:e,SO_ID:n,MST_SO_ID:r})},E9=async t=>new Promise(e=>{setTimeout(()=>{t.ACNT_NO&&t.ACNT_NO.length>=10?e({success:!0,data:{verified:!0,ownerName:t.ACNT_OWNER_NM},message:"  ."}):e({success:!1,message:"  ."})},1e3)}),j9=async t=>{try{const e=await _n("/customer/payment/verifyCreditCard",{SO_ID:t.SO_ID||"",PYM_ACNT_ID:t.PYM_ACNT_ID||"",CUST_ID:t.CUST_ID||"",CUST_NM:t.CUST_NM||t.CARD_OWNER_NM||"",CARD_NO:t.CARD_NO,CARD_EXPYEAR:t.CARD_EXPYEAR||(t.CARD_VALID_YM?t.CARD_VALID_YM.substring(0,2):""),CARD_EXPMON:t.CARD_EXPMON||(t.CARD_VALID_YM?t.CARD_VALID_YM.substring(2,4):""),KOR_ID:t.KOR_ID||""});if(e.success&&e.data){const n=e.data;return n.success==="true"||n.RESP_CD==="0000"?{success:!0,data:{verified:!0,RESP_CD:n.RESP_CD},message:"  ."}:{success:!1,data:n,message:n.RESP_MSG||"  ."}}return{success:!1,message:e.message||"  ."}}catch(e){return console.error("[CardVerify] Error:",e),{success:!1,message:(e==null?void 0:e.message)||"    ."}}},I9=async t=>{var e;return console.warn("[CustomerAPI] savePaymentSignature stub called:",{CUST_ID:t.CUST_ID,PYM_ACNT_ID:t.PYM_ACNT_ID,SIGN_TYPE:t.SIGN_TYPE,DATA_SIZE:((e=t.SIGNATURE_DATA)==null?void 0:e.length)||0}),Promise.resolve({success:!0,data:{saved:!1,stub:!0},message:"  API  (stub)"})},Gj=async t=>{let e=t.SO_ID||"",n=t.MST_SO_ID||"",r="",i="";try{const u=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(u){const f=JSON.parse(u);if(r=f.userId||f.USR_ID||f.usrId||"",i=f.crrId||f.CRR_ID||"",!e){const m=f.authSoList||f.AUTH_SO_List||[];m.length>0&&(e=m[0].SO_ID||m[0].soId||""),e||(e=f.soId||f.SO_ID||"")}n||(n=f.mstSoId||f.MST_SO_ID||e)}}catch{console.log("[CustomerAPI] Failed to get user info from session/localStorage")}const l=t.CNSL_MST_CL||"";let c=t.CNSL_MID_CL||"",d=t.CNSL_SLV_CL||"";if(c.startsWith(l)&&c.length>l.length&&(c=c.substring(l.length)),d.startsWith(c.length>0?l+c:"")&&d.length>4)d=d.substring((l+c).length);else if(d.length>4){const u=t.CNSL_MID_CL||"";d.startsWith(u)&&d.length>u.length?d=d.substring(u.length):d=d.substring(d.length-3)}return _n("/customer/negociation/saveCnslRcptInfo",{...t,CNSL_MST_CL:l,CNSL_MID_CL:c,CNSL_SLV_CL:d,SO_ID:e,MST_SO_ID:n,USR_ID:r,CRR_ID:i,CALLER_UID:r,CNSL_RSLT:t.CNSL_RSLT||"5",RCPT_TP:"G1",CUST_REL:"A",PRESS_RCPT_YN:"N",SUBS_TP:"1",CTI_CID:"0"})},O9=async t=>{let e="MOBILE_USER",n="",r="",i="";try{const u=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(u){const f=JSON.parse(u);e=f.userId||f.USR_ID||e,n=f.crrId||f.CRR_ID||"";const m=f.authSoList||f.AUTH_SO_List||[];m.length>0&&(r=m[0].SO_ID||m[0].soId||""),r||(r=f.soId||f.SO_ID||""),i=f.mstSoId||f.MST_SO_ID||r}}catch{console.log("[CustomerAPI] Failed to get user info from session")}const l=t,c="AS_CL_CD"in t,d={PG_GUBUN:c&&l.PG_GUBUN||"1",POST_ID:t.POST_ID||"",CUST_ID:t.CUST_ID,CTRT_ID:t.CTRT_ID||"",WRK_HOPE_DTTM:c?l.SCHD_DT+l.SCHD_TM:t.WRK_HOPE_DTTM,HOPE_DTTM:c?l.SCHD_DT+l.SCHD_TM:t.HOPE_DTTM||t.WRK_HOPE_DTTM,WRK_DTL_TCD:c?l.AS_CL_CD:t.WRK_DTL_TCD,WRK_RCPT_CL:c?l.AS_RESN_L_CD:t.WRK_RCPT_CL,WRK_RCPT_CL_DTL:c?l.AS_RESN_M_CD||"":t.WRK_RCPT_CL_DTL,MEMO:c?l.AS_CNTN:t.MEMO,EMRG_YN:"N",HOLY_YN:"N",TRANS_PROC_YN:"Y",CRR_ID:n,WRKR_ID:e,REG_UID:e,SO_ID:c&&l.SO_ID||r,MST_SO_ID:c&&l.MST_SO_ID||i,BLD_CL:c?l.BLD_CL||"":t.BLD_CL||"",BLD_NM:c?l.BLD_NM||"":t.BLD_NM||"",BLD_ID:c?l.BLD_ID||"":t.BLD_ID||"",BUN_CL:c?l.BUN_CL||"":t.BUN_CL||"",BUN_NO:c?l.BUN_NO||"":t.BUN_NO||"",HO_NM:c?l.HO_NM||"":t.HO_NM||"",APT_DONG_NO:c?l.APT_DONG_NO||"":t.APT_DONG_NO||"",APT_HO_CNT:c?l.APT_HO_CNT||"":t.APT_HO_CNT||"",ADDR_DTL:c?l.ADDR_DTL||"":t.ADDR_DTL||"",ADDR:c?l.ADDR||"":t.ADDR||"",ADDR_ORD:c?l.ADDR_ORD||"1":t.ADDR_ORD||"1",CNSL_RSLT:"3"};return c&&l.AS_CL_DTL_CD&&(d.AS_BIZ_CL=l.AS_CL_DTL_CD),c&&l.TRIP_FEE_CD&&(d.BIZ_EXPNS_GUIDE=l.TRIP_FEE_CD),_n("/customer/work/modAsPdaReceipt",d)},M9=async t=>_n("/customer/customer/general/customerManager",{...t,ACTION:"INSERT"}),L9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCS010"}),w9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCS020"}),P9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCS030"}),A9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMWT001"}),k9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMAS000"}),U9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMAS001"}),B9=async t=>_n("/customer/work/getProd_Grp",{CTRT_ID:t}),W9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CUST_TP"}),F9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCU052"}),K9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"BLPY015"}),Q9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"BLPY016"}),G9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCU005"}),Y9=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCU002"}),V9=async t=>{if(t.SO_ID){const c={SO_ID:t.SO_ID,MST_SO_ID:"200",USE_FLAG:t.USE_FLAG||"Y"};return t.DONGMYONG&&(c.DONGMYONG=t.DONGMYONG),_n("/statistics/customer/getPostList",c)}let e=[];try{const c=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(c){const d=JSON.parse(c),u=d.authSoList||d.AUTH_SO_List||[];if(u.length>0&&(e=u.map(f=>({soId:f.SO_ID||f.soId||"",mstSoId:f.MST_SO_ID||f.mstSoId||""})).filter(f=>f.soId)),e.length===0){const f=d.soId||d.SO_ID||"",m=d.mstSoId||d.MST_SO_ID||"";f&&(e=[{soId:f,mstSoId:m}])}}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session for address search")}if(e.length===0)return console.log("[CustomerAPI] searchPostAddress: SO_ID   "),{success:!1,data:[],message:"SO_ID   ."};const n=e.map(c=>{const d={SO_ID:c.soId,MST_SO_ID:c.mstSoId||"200",USE_FLAG:t.USE_FLAG||"Y"};return t.DONGMYONG&&(d.DONGMYONG=t.DONGMYONG),_n("/statistics/customer/getPostList",d).catch(u=>(console.log(`[CustomerAPI] searchPostAddress SO_ID=${c.soId} :`,u),{success:!1,data:[],message:""}))}),r=await Promise.all(n),i=new Set,l=[];for(const c of r)if(c.success&&c.data)for(const d of c.data){const u=d.POST_ID||`${d.SO_ID}_${d.DONGMYON_NM}_${d.ADDR}`;i.has(u)||(i.add(u),l.push(d))}return{success:!0,data:l,message:""}},$9=async t=>{const e={};t.STREET_NM&&(e.STREET_NM=t.STREET_NM),t.STREET_BUN_M&&(e.STREET_BUN_M=t.STREET_BUN_M),t.STREET_BUN_S&&(e.STREET_BUN_S=t.STREET_BUN_S),t.SO_ID&&(e.SO_ID=t.SO_ID);const n=await _n("/customer/common/customercommon/getStreetAddrList",e);return n.success&&n.data?{success:!0,data:n.data,message:""}:{success:!1,data:[],message:n.message||"  "}},wC=t=>{if(!t)return"";const e=t.replace(/\D/g,"");if(e.startsWith("02")){if(e.length===10)return`${e.slice(0,2)}-${e.slice(2,6)}-${e.slice(6)}`;if(e.length===9)return`${e.slice(0,2)}-${e.slice(2,5)}-${e.slice(5)}`}return e.length===11?`${e.slice(0,3)}-${e.slice(3,7)}-${e.slice(7)}`:e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6)}`:t},Hy=t=>{if(!t)return"";const e=t.replace(/\D/g,"");if(e.startsWith("02")){if(e.length===10)return`${e.slice(0,2)}-****-${e.slice(6)}`;if(e.length===9)return`${e.slice(0,2)}-***-${e.slice(5)}`}return e.length===11?`${e.slice(0,3)}-****-${e.slice(7)}`:e.length===10?`${e.slice(0,3)}-***-${e.slice(6)}`:e.length>7?`${e.slice(0,3)}-${"*".repeat(e.length-7)}-${e.slice(-4)}`:t},jo=t=>isNaN(t)?"0":t.toLocaleString("ko-KR"),PC=t=>!t||t.length!==8?t||"":`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6)}`,H9=(t,e=4,n=4)=>{if(!t||t.length<=e+n)return t;const r="*".repeat(t.length-e-n);return t.slice(0,e)+r+t.slice(-n)},z9=()=>{try{const t=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(t){const e=JSON.parse(t),n=e.authSoList||e.AUTH_SO_List||[];return n.length>0?n[0].SO_ID||n[0].soId||"":e.soId||e.SO_ID||""}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session")}return""},q9=async t=>{const e=t||z9();return _n("/billing/payment/anony/getCardVendorBySoId",{SO_ID:e})},X9=async t=>{const e={MID:t.master_store_id,OID:t.order_no,ORDER_DT:t.order_dt,SO_ID:t.ctrt_so_id,CUST_ID:t.cust_id,CUST_NM:t.reqr_nm,AMT:t.encrypted_amt,PYM_ACNT_ID:t.pym_acnt_id,USER_ID:t.user_id,RCPT_BILL_EMP_ID:t.rcpt_bill_emp_id,SMRY:t.smry,PYR_REL:t.pyr_rel,PROD_INFO_CD:t.prod_info_cd,CUST_EMAIL:t.cust_email,STAGE:t.stage||""};return t.dtlList&&(e.DTL_LIST=t.dtlList.map(n=>({MID:n.master_store_id,OID:n.order_no,ORDER_DT:n.order_dt,BILL_SEQ_NO:n.BILL_SEQ_NO,SO_ID:n.SO_ID,BILL_AMT:n.BILL_AMT,PRE_RCPT_AMT:n.PRE_RCPT_AMT,RCPT_AMT:n.RCPT_AMT}))),_n("/billing/payment/anony/insertDpstAndDTL",e)},J9=async t=>{const e={MID:t.mid,OID:t.oid,ORDER_DT:t.order_dt,AMT:t.amount,CUST_NM:t.buyer,GOODNAME:t.productinfo,CARD_NO:t.card_no,CARD_EXPIRY:t.card_expyear+t.card_expmon,CARD_EXPYEAR:t.card_expyear,CARD_EXPMON:t.card_expmon,KOR_ID:t.kor_id,INSTALL_PERIOD:t.install,PYM_ACNT_ID:t.pym_acnt_id,ENCRYPTED_AMT:t.encrypted_amt,SO_ID:t.so_id||"",CUST_ID:t.cust_id||"",CTRT_ID:t.ctrt_id||"",STAGE:t.stage||"",CARD_VENDOR:t.card_vendor||""};return _n("/billing/payment/anony/processCardPayment",e)},Z9=()=>{const t=new Date,e=(i,l=2)=>String(i).padStart(l,"0"),n=e(t.getHours())+e(t.getMinutes())+e(t.getSeconds()),r=String(Math.floor(Math.random()*1e4)).padStart(4,"0");return n+r},eB=()=>{const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}${n}${r}`},tB=async t=>_n("/customer/etc/getPromOfContract",{CTRT_ID:t}),sB=async t=>{const e=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");let n="SYSTEM";if(e)try{const r=JSON.parse(e);n=r.USR_ID||r.userId||"SYSTEM"}catch{}return _n("/customer/etc/saveCtrtAgreeInfo",{...t,AGREE_YN:t.AGREE_YN||"Y",WRKR_ID:t.WRKR_ID||n})},nB=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCU064"}),rB=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCU072"}),iB=async()=>_n("/common/getCommonCodes",{CODE_GROUP:"CMCU252"}),aB=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},lB=t=>{switch(t){case"10":case"Y":return"bg-green-100 text-green-700";case"20":return"bg-yellow-100 text-yellow-700";case"30":case"90":case"N":return"bg-gray-100 text-gray-600";case"82":return"bg-sky-100 text-sky-700";default:return"bg-blue-100 text-blue-700"}},oB=({contracts:t,isLoading:e,expanded:n,onToggle:r,onContractSelect:i,showToast:l,onNavigateToConsultation:c,onNavigateToAS:d,onNavigateToAddressChange:u,onNavigateToReContract:f,initialSearchKeyword:m})=>{const[_,y]=x.useState("active"),[g,N]=x.useState(m||"");x.useEffect(()=>{N(m||"")},[m]);const[C,v]=x.useState(null),[R,U]=x.useState(null),L=O=>{const S=O.CTRT_STAT_CD||"";return!["10","50","90"].includes(S)},w=O=>{const S=O.CTRT_STAT_CD||"",A=O.CTRT_STAT_NM||"",Y=["20","30","82"].includes(S),te=O.CLOSE_DANGER==="Y"&&A.includes("");return Y?{consultation:!0,as:!0,addressChange:!0,reContract:te}:{consultation:!1,as:!1,addressChange:!1,reContract:!1}},P=t.filter(O=>{var S,A,Y,te;if(_==="active"&&!L(O)||_==="recommit"&&(!L(O)||O.CLOSE_DANGER!=="Y"||!(O.CTRT_STAT_NM||"").includes("")))return!1;if(g){const J=g.toLowerCase(),q=(S=O.CTRT_ID)==null?void 0:S.toLowerCase().includes(J),V=(A=O.PROD_NM)==null?void 0:A.toLowerCase().includes(J),F=(Y=O.EQT_SERNO)==null?void 0:Y.toLowerCase().includes(J),I=(te=O.NOTRECEV)==null?void 0:te.toLowerCase().includes(J);return q||V||F||I}return!0}),G={all:t.length,active:t.filter(O=>L(O)).length,recommit:t.filter(O=>L(O)&&O.CLOSE_DANGER==="Y"&&(O.CTRT_STAT_NM||"").includes("")).length},K=O=>{v(O.CTRT_ID),i(O)},B=O=>{const S=O.CTRT_ID;U(R===S?null:S),K(O)};return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:r,className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xh,{className:"w-5 h-5 text-purple-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:" "}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",t.length,")"]})]}),n?s.jsx(Mr,{className:"w-5 h-5 text-gray-400"}):s.jsx(sr,{className:"w-5 h-5 text-gray-400"})]}),n&&s.jsx("div",{className:"px-4 pb-4",children:e?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(jn,{className:"w-6 h-6 animate-spin text-gray-400"})}):t.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"  ."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4 space-y-3",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>y("all"),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${_==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",G.all,")"]}),s.jsxs("button",{onClick:()=>y("active"),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${_==="active"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",G.active,")"]}),s.jsxs("button",{onClick:()=>y("recommit"),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${_==="recommit"?"bg-purple-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",G.recommit,")"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(r5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:g,onChange:O=>N(O.target.value),placeholder:"ID, ,  ",className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g&&s.jsx("button",{onClick:()=>N(""),className:"flex-shrink-0 px-3 py-2 text-xs font-medium text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors",children:""})]})]}),s.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[P.map((O,S)=>s.jsxs("div",{className:`p-3 rounded-lg border transition-colors ${C===O.CTRT_ID?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"cursor-pointer",onClick:()=>B(O),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsx("div",{className:"flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full bg-blue-500 text-white text-sm font-bold",children:S+1}),s.jsx("span",{className:"text-sm text-gray-600 truncate",children:O.PROD_NM})]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded whitespace-nowrap ${O.CLOSE_DANGER==="Y"&&(O.CTRT_STAT_NM||"").includes("")?"bg-orange-100 text-orange-700":lB(O.CTRT_STAT_CD)}`,children:(()=>{const A=O.CTRT_STAT_NM||(O.CTRT_STAT_CD==="90"?"":O.CTRT_STAT_CD==="20"?"":"");return O.CLOSE_DANGER==="Y"&&A.includes("")?"()":A})()}),s.jsx(sr,{className:`w-4 h-4 text-gray-400 transition-transform flex-shrink-0 ${R===O.CTRT_ID?"rotate-180":""}`})]})]}),s.jsxs("div",{className:"flex items-center justify-between mb-1 ml-9 gap-2 flex-nowrap overflow-hidden",children:[s.jsxs("span",{className:"text-sm text-gray-600 flex-shrink-0 whitespace-nowrap",children:[" ID: ",aB(O.CTRT_ID)]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-indigo-50 text-indigo-600 rounded whitespace-nowrap",children:O.INSTL_LOC||"N/A"}),O.SO_NM&&s.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-purple-50 text-purple-600 rounded whitespace-nowrap",children:O.SO_NM})]})]}),(O.STREET_ADDR_FULL||O.ADDR_FULL||O.INST_ADDR)&&s.jsxs("div",{className:"flex items-start gap-1 text-sm text-gray-600 mt-1",children:[s.jsx(rd,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),s.jsx("div",{className:"min-w-0",children:O.STREET_ADDR_FULL?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-blue-600 mr-1",children:"[]"}),s.jsx("span",{children:O.STREET_ADDR_FULL})]}):s.jsx("span",{children:O.ADDR_FULL||O.INST_ADDR})})]})]}),R===O.CTRT_ID&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-2",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",O.AGMT_MON?`${O.AGMT_MON} (${PC(O.CTRT_APLY_STRT_DT)||"-"} ~ ${PC(O.CTRT_APLY_END_DT)||"-"})`:"-"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",O.OPNG_DT?PC(O.OPNG_DT):"-"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",O.NOTRECEV||"-"]}),O.GRP_NM&&s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",O.GRP_NM]}),(()=>{const A=w(O);return s.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t border-gray-200",children:[s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.consultation&&(K(O),c&&c(O))},disabled:!A.consultation,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.consultation?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:""}),s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.as&&(K(O),d&&d(O))},disabled:!A.as,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.as?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:"AS"}),s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.addressChange&&(K(O),u&&u(O))},disabled:!A.addressChange,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.addressChange?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:""}),s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.reContract&&(K(O),f&&f(O))},disabled:!A.reContract,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.reContract?"bg-purple-500 hover:bg-purple-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:""})]})})()]})]},O.CTRT_ID)),P.length===0&&s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"   ."})]})]})})]})},H_="pendingPayment_";function cB(t,e){sessionStorage.setItem(H_+t,JSON.stringify(e))}function rR(t){try{const e=sessionStorage.getItem(H_+t);if(!e)return null;const n=JSON.parse(e);return Date.now()-n.timestamp>1440*60*1e3?(sessionStorage.removeItem(H_+t),null):n}catch{return null}}function iR(t){sessionStorage.removeItem(H_+t)}const aR=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},dB=t=>!t||t.length<2?t||"-":t.length===2?t[0]+"*":t[0]+"*".repeat(t.length-2)+t[t.length-1],uB=t=>(t==null?void 0:t.replace(/\d*/g,"").trim())||"",hB=t=>!t||t.length<6?t||"-":`${t.slice(0,4)}-${t.slice(4,6)}`,Yj=t=>{const e=t.replace(/\D/g,"").slice(0,16),n=[];for(let r=0;r<e.length;r+=4)n.push(e.slice(r,r+4));return n.join("-")},fB=t=>{const e=t.replace(/\D/g,"");if(e.length<10)return Yj(t);const n=e.slice(0,4),r=e.slice(-4),i=e.length-8,l=n+"*".repeat(i>0?i:4)+r,c=[];for(let d=0;d<l.length;d+=4)c.push(l.slice(d,d+4));return c.join("-")},mB=({isOpen:t,onClose:e,custId:n,custNm:r,pymAcntId:i,soId:l,unpaymentList:c,showToast:d,onSuccess:u,pendingPayment:f})=>{const m=!!f,[_,y]=x.useState(new Set),[g,N]=x.useState(!1),[C,v]=x.useState(!1),[R,U]=x.useState(""),[L,w]=x.useState(""),[P,G]=x.useState(""),[K,B]=x.useState("00"),[O,S]=x.useState(""),[A,Y]=x.useState(null);if(x.useEffect(()=>{t&&(y(new Set(c.map((k,Q)=>Q))),v(!1),f?(U(f.cardNo),w(f.expMonth),G(f.expYear),B(f.installment),S(f.korId),Y({mid:f.mid,orderNo:f.orderNo,orderDt:f.orderDt})):(U(""),w(""),G(""),B("00"),S(""),Y(null)))},[t,c,f]),x.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t)return null;const te=k=>{const Q=new Set(_);Q.has(k)?Q.delete(k):Q.add(k),y(Q)},J=()=>{_.size===c.length?y(new Set):y(new Set(c.map((k,Q)=>Q)))},q=c.filter((k,Q)=>_.has(Q)).reduce((k,Q)=>k+(Q.UNPAY_AMT||0),0),V=c.reduce((k,Q)=>k+(Q.UNPAY_AMT||0),0),F=k=>{const Q=k.target.value.replace(/\D/g,"").slice(0,16);U(Q)},I=k=>{const Q=k.target.value.replace(/\D/g,"").slice(0,10);S(Q)},ee=()=>_.size===0?"  .":R.length<15?"  .":!L||!P?" .":O.length<6?"(6)  (10) .":null,ae=new Date().getFullYear(),T=Array.from({length:11},(k,Q)=>{const H=ae+Q;return{value:String(H).slice(2),label:String(H)}}),j=async()=>{var Q,H,$;const k=ee();if(k){d==null||d(k,"warning");return}N(!0);try{const ie=String(q),fe=sessionStorage.getItem("userInfo")&&JSON.parse(sessionStorage.getItem("userInfo")||"{}").userId||"SYSTEM";console.log("[Payment] Step 1: getCardVendorBySoId");let pe="dlivecon";const de=await q9(l);if(de.success&&de.data){const ue=Array.isArray(de.data)?de.data[0]:de.data;ue!=null&&ue.CARD_VENDOR&&(pe=ue.CARD_VENDOR)}const Re=eB(),X=Z9();console.log("[Payment] Fallback MID:",pe,"OrderNo:",X);const _e=c.filter((ue,xe)=>_.has(xe)),me=[];_e.forEach(ue=>{const xe=(ue.BILL_SEQ_NO||"").split(",").map(et=>et.trim()).filter(Boolean);xe.length>0?xe.forEach(et=>{me.push({master_store_id:pe,order_dt:Re,order_no:X,BILL_SEQ_NO:et,SO_ID:ue.SO_ID||l||"",BILL_AMT:ue.BILL_AMT||ue.UNPAY_AMT,PRE_RCPT_AMT:(ue.BILL_AMT||0)-(ue.UNPAY_AMT||0),RCPT_AMT:ue.UNPAY_AMT})}):me.push({master_store_id:pe,order_dt:Re,order_no:X,BILL_SEQ_NO:"",SO_ID:ue.SO_ID||l||"",BILL_AMT:ue.BILL_AMT||ue.UNPAY_AMT,PRE_RCPT_AMT:(ue.BILL_AMT||0)-(ue.UNPAY_AMT||0),RCPT_AMT:ue.UNPAY_AMT})}),console.log("[Payment] Step 2: insertDpstAndDTL");const le=await X9({master_store_id:pe,order_dt:Re,order_no:X,ctrt_so_id:l||"",pym_acnt_id:i||"",cust_id:n,prod_info_cd:"01",encrypted_amt:ie,reqr_nm:r||"",pyr_rel:"A",user_id:fe,rcpt_bill_emp_id:fe,smry:"  ",cust_email:"",stage:"01",dtlList:me});if(console.log("[Payment] insertDpstAndDTL result:",le),!le.success){d==null||d(le.message||"  .","error");return}const se=((Q=le.data)==null?void 0:Q.ORDER_NO)||X,Ee=((H=le.data)==null?void 0:H.ORDER_DT)||Re,Ne=(($=le.data)==null?void 0:$.MID)||pe,ye=Ne+Ee+se;console.log("[Payment] Final values - ORDER_NO:",se,"ORDER_DT:",Ee,"MID:",Ne),i&&cB(i,{cardNo:R,expMonth:L,expYear:P,installment:K,korId:O,mid:Ne,orderNo:se,orderDt:Ee,selectedTotal:q,timestamp:Date.now()}),console.log("[Payment] Step 3: processCardPayment");const ne=await J9({mid:Ne,order_dt:Ee,oid:se,amount:ie,buyer:r||"",productinfo:"01",card_no:R,card_expyear:P,card_expmon:L,kor_id:O,install:K,pym_acnt_id:i||"",encrypted_amt:ie,so_id:l||"",cust_id:n,stage:"02",card_vendor:Ne});ne.success?(i&&iR(i),v(!0),Y({mid:Ne,orderNo:ye,orderDt:Ee}),u==null||u()):d==null||d(ne.message||"  .","error")}catch(ie){console.error("[Payment] Error:",ie),d==null||d((ie==null?void 0:ie.message)||"    .","error")}finally{N(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4 max-h-[85vh] flex flex-col",onClick:k=>k.stopPropagation(),children:[s.jsxs("div",{className:`flex items-center justify-between p-4 border-b border-gray-200 rounded-t-xl ${m?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-red-500 to-red-600"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 text-white",children:[m?s.jsx(y_,{className:"w-5 h-5"}):s.jsx(b_,{className:"w-5 h-5"}),s.jsx("h3",{className:"font-semibold",children:m?"  ()":" "})]}),s.jsx("button",{onClick:e,className:"text-white/80 hover:text-white transition-colors",disabled:g,children:s.jsx(bi,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-medium text-gray-900",children:dB(r)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"ID: "}),s.jsx("span",{className:"font-mono text-blue-600",children:aR(n)})]}),i&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-mono text-purple-600",children:aR(i)})]})]})}),C?s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8",children:[s.jsx(Vi,{className:"w-16 h-16 text-green-500 mb-4"}),s.jsxs("p",{className:"text-gray-700 text-center mb-6 text-sm leading-relaxed",children:[jo(q),"",s.jsx("br",{}),"   ."]}),s.jsx("button",{onClick:e,className:"w-full max-w-xs py-3 text-sm font-medium text-white bg-green-500 rounded-lg hover:bg-green-600 transition-colors",children:""})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-0",children:c.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-400",children:[s.jsx(Wr,{className:"w-12 h-12 mb-2"}),s.jsx("span",{children:"  ."})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg cursor-pointer border border-blue-200",children:[s.jsx("input",{type:"checkbox",checked:_.size===c.length,onChange:J,className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:g}),s.jsxs("span",{className:"flex-1 font-medium text-blue-700",children:["  (",c.length,")"]}),s.jsxs("span",{className:"font-bold text-blue-700",children:[jo(V),""]})]}),c.map((k,Q)=>s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer border transition-colors ${_.has(Q)?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[s.jsx("input",{type:"checkbox",checked:_.has(Q),onChange:()=>te(Q),className:"w-5 h-5 rounded border-gray-300 text-red-600 focus:ring-red-500",disabled:g}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:hB(k.BILL_YM)}),s.jsxs("span",{className:`text-sm font-bold ${_.has(Q)?"text-red-600":"text-gray-700"}`,children:[jo(k.UNPAY_AMT),""]})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-0.5 truncate",children:[uB(k.PROD_NM),k.UNPAY_DAYS?` |  ${k.UNPAY_DAYS}`:""]})]})]},Q))]})}),s.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 p-3 bg-white rounded-lg border border-gray-200",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["  (",_.size,")"]}),s.jsxs("span",{className:"text-xl font-bold text-red-600",children:[jo(q),""]})]}),s.jsxs("div",{className:`mb-3 p-3 rounded-lg border ${m?"bg-amber-50 border-amber-200":"bg-white border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[s.jsx(b_,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:" "}),m&&s.jsxs("span",{className:"ml-auto px-2 py-0.5 text-xs bg-amber-500 text-white rounded-full flex items-center gap-1",children:[s.jsx(y_,{className:"w-3 h-3"})," "]})]}),m&&s.jsxs("div",{className:"mb-3 p-2 bg-amber-100 rounded-lg text-xs text-amber-800 flex items-start gap-2",children:[s.jsx(Wr,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),s.jsxs("span",{children:[" .     .",s.jsx("br",{}),"   ."]})]}),s.jsxs("div",{className:"mb-2.5",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("input",{type:"text",inputMode:"numeric",value:m?fB(R):Yj(R),onChange:F,placeholder:"0000-0000-0000-0000",disabled:g||m,readOnly:m,className:`w-full px-3 py-2 text-sm border rounded-lg outline-none font-mono tracking-wider ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100"}`,maxLength:19})]}),s.jsxs("div",{className:"flex gap-2 mb-2.5",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsxs("div",{className:"flex gap-1",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsxs("select",{value:L,onChange:k=>w(k.target.value),disabled:g||m,className:`w-full px-2 py-2 text-sm border rounded-lg outline-none appearance-none pr-7 ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white disabled:bg-gray-100"}`,children:[s.jsx("option",{value:"",children:""}),Array.from({length:12},(k,Q)=>{const H=String(Q+1).padStart(2,"0");return s.jsx("option",{value:H,children:H},H)})]}),s.jsx(sr,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),s.jsx("span",{className:"self-center text-gray-400 text-sm",children:"/"}),s.jsxs("div",{className:"relative flex-1",children:[s.jsxs("select",{value:P,onChange:k=>G(k.target.value),disabled:g||m,className:`w-full px-2 py-2 text-sm border rounded-lg outline-none appearance-none pr-7 ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white disabled:bg-gray-100"}`,children:[s.jsx("option",{value:"",children:""}),T.map(k=>s.jsx("option",{value:k.value,children:k.label},k.value))]}),s.jsx(sr,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]})]})]}),s.jsxs("div",{className:"w-24",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:K,onChange:k=>B(k.target.value),disabled:g||m,className:`w-full px-2 py-2 text-sm border rounded-lg outline-none appearance-none pr-7 ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white disabled:bg-gray-100"}`,children:[s.jsx("option",{value:"00",children:""}),[2,3,4,5,6,7,8,9,10,11,12].map(k=>s.jsxs("option",{value:String(k).padStart(2,"0"),children:[k,""]},k))]}),s.jsx(sr,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"(6) / (10)"}),s.jsx("input",{type:"text",inputMode:"numeric",value:m?O.replace(/./g,"*"):O,onChange:I,placeholder:") 900101",disabled:g||m,readOnly:m,className:`w-full px-3 py-2 text-sm border rounded-lg outline-none ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100"}`,maxLength:10})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{m&&i&&iR(i),e()},disabled:g,className:`py-3 text-sm font-medium rounded-lg transition-colors ${m?"flex-1 text-white bg-amber-500 hover:bg-amber-600":"flex-1 text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 disabled:opacity-50"}`,children:m?" ( )":""}),!m&&s.jsx("button",{onClick:j,disabled:g||_.size===0,className:"flex-1 py-3 text-sm font-medium text-white bg-red-500 rounded-lg hover:bg-red-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:g?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-4 h-4 animate-spin"}),"  ..."]}):s.jsxs(s.Fragment,{children:[" ",q>0?jo(q)+"":""]})})]}),s.jsx("p",{className:"mt-3 text-xs text-gray-400 text-center",children:m?"*   .   .":"*     ."})]})]})]})})},Vj=({onSave:t,onCancel:e,width:n=340,height:r=200,penColor:i="#000000",backgroundColor:l="#ffffff",title:c=""})=>{const d=x.useRef(null),[u,f]=x.useState(!1),[m,_]=x.useState(!1),y=x.useRef(null),[g,N]=x.useState({isOpen:!1,type:"warning",message:"",onConfirm:()=>{}});x.useEffect(()=>{const G=d.current;if(!G)return;const K=G.getContext("2d");K&&(K.fillStyle=l,K.fillRect(0,0,G.width,G.height),K.strokeStyle=i,K.lineWidth=2,K.lineCap="round",K.lineJoin="round")},[l,i]);const C=x.useCallback(G=>{const K=d.current;if(!K)return null;const B=K.getBoundingClientRect(),O=K.width/B.width,S=K.height/B.height;if("touches"in G){const A=G.touches[0];return{x:(A.clientX-B.left)*O,y:(A.clientY-B.top)*S}}else return{x:(G.clientX-B.left)*O,y:(G.clientY-B.top)*S}},[]),v=x.useCallback(G=>{G.preventDefault();const K=C(G);if(!K)return;f(!0),y.current=K;const B=d.current,O=B==null?void 0:B.getContext("2d");O&&(O.beginPath(),O.moveTo(K.x,K.y))},[C]),R=x.useCallback(G=>{if(!u)return;G.preventDefault();const K=C(G);if(!K||!y.current)return;const B=d.current,O=B==null?void 0:B.getContext("2d");O&&(O.beginPath(),O.moveTo(y.current.x,y.current.y),O.lineTo(K.x,K.y),O.stroke(),y.current=K,_(!0))},[u,C]),U=x.useCallback(()=>{f(!1),y.current=null},[]),L=x.useCallback(()=>{const G=d.current,K=G==null?void 0:G.getContext("2d");!K||!G||(K.fillStyle=l,K.fillRect(0,0,G.width,G.height),_(!1))},[l]),w=x.useCallback(()=>{const G=d.current;if(!G||!m)return;let K=G.toDataURL("image/png");if(K=K.replace(/\+/g,"%2B"),K.length<5e3){N({isOpen:!0,type:"error",message:`    .
  .`,onConfirm:()=>L()});return}if(K.length<1e4){N({isOpen:!0,type:"warning",message:`      .
  .`,onConfirm:()=>L()});return}t(K)},[m,t,L]),P=x.useCallback(()=>{N(G=>({...G,isOpen:!1}))},[]);return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[s.jsx(ul,{isOpen:g.isOpen,onClose:P,onConfirm:g.onConfirm,title:" ",message:g.message,type:g.type,showCancel:!1,confirmText:""}),s.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[s.jsx("h3",{className:"font-medium",children:c}),s.jsx("p",{className:"text-xs text-blue-100 mt-0.5",children:"  "})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg overflow-hidden bg-gray-50",children:s.jsx("canvas",{ref:d,width:n,height:r,className:"touch-none w-full",style:{maxWidth:"100%",height:"auto",aspectRatio:`${n}/${r}`},onMouseDown:v,onMouseMove:R,onMouseUp:U,onMouseLeave:U,onTouchStart:v,onTouchMove:R,onTouchEnd:U})}),!m&&s.jsx("div",{className:"text-center mt-2 text-sm text-gray-400",children:"   "})]}),s.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[s.jsxs("button",{onClick:L,className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(Ei,{className:"w-4 h-4"})," "]}),e&&s.jsxs("button",{onClick:e,className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(Iw,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:w,disabled:!m,className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[s.jsx(dc,{className:"w-4 h-4"}),""]})]})]})};function pr(t){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pr(t)}var Mo=Uint8Array,Dl=Uint16Array,NN=Int32Array,SN=new Mo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vN=new Mo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),lR=new Mo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$j=function(t,e){for(var n=new Dl(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new NN(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)i[l]=l-n[r]<<5|r;return{b:n,r:i}},Hj=$j(SN,2),gB=Hj.b,zy=Hj.r;gB[28]=258,zy[258]=28;var pB=$j(vN,0),oR=pB.r,qy=new Dl(32768);for(var Br=0;Br<32768;++Br){var zd=(Br&43690)>>1|(Br&21845)<<1;zd=(zd&52428)>>2|(zd&13107)<<2,zd=(zd&61680)>>4|(zd&3855)<<4,qy[Br]=((zd&65280)>>8|(zd&255)<<8)>>1}var zm=(function(t,e,n){for(var r=t.length,i=0,l=new Dl(e);i<r;++i)t[i]&&++l[t[i]-1];var c=new Dl(e);for(i=1;i<e;++i)c[i]=c[i-1]+l[i-1]<<1;var d;if(n){d=new Dl(1<<e);var u=15-e;for(i=0;i<r;++i)if(t[i])for(var f=i<<4|t[i],m=e-t[i],_=c[t[i]-1]++<<m,y=_|(1<<m)-1;_<=y;++_)d[qy[_]>>u]=f}else for(d=new Dl(r),i=0;i<r;++i)t[i]&&(d[i]=qy[c[t[i]-1]++]>>15-t[i]);return d}),Sh=new Mo(288);for(var Br=0;Br<144;++Br)Sh[Br]=8;for(var Br=144;Br<256;++Br)Sh[Br]=9;for(var Br=256;Br<280;++Br)Sh[Br]=7;for(var Br=280;Br<288;++Br)Sh[Br]=8;var z_=new Mo(32);for(var Br=0;Br<32;++Br)z_[Br]=5;var _B=zm(Sh,9,0),xB=zm(z_,5,0),zj=function(t){return(t+7)/8|0},CB=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Mo(t.subarray(e,n))},Fc=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},Im=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},AC=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,l=n.slice();if(!i)return{t:Xj,l:0};if(i==1){var c=new Mo(n[0].s+1);return c[n[0].s]=1,{t:c,l:1}}n.sort(function(P,G){return P.f-G.f}),n.push({s:-1,f:25001});var d=n[0],u=n[1],f=0,m=1,_=2;for(n[0]={s:-1,f:d.f+u.f,l:d,r:u};m!=i-1;)d=n[n[f].f<n[_].f?f++:_++],u=n[f!=m&&n[f].f<n[_].f?f++:_++],n[m++]={s:-1,f:d.f+u.f,l:d,r:u};for(var y=l[0].s,r=1;r<i;++r)l[r].s>y&&(y=l[r].s);var g=new Dl(y+1),N=Xy(n[m-1],g,0);if(N>e){var r=0,C=0,v=N-e,R=1<<v;for(l.sort(function(G,K){return g[K.s]-g[G.s]||G.f-K.f});r<i;++r){var U=l[r].s;if(g[U]>e)C+=R-(1<<N-g[U]),g[U]=e;else break}for(C>>=v;C>0;){var L=l[r].s;g[L]<e?C-=1<<e-g[L]++-1:++r}for(;r>=0&&C;--r){var w=l[r].s;g[w]==e&&(--g[w],++C)}N=e}return{t:new Mo(g),l:N}},Xy=function(t,e,n){return t.s==-1?Math.max(Xy(t.l,e,n+1),Xy(t.r,e,n+1)):e[t.s]=n},cR=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Dl(++e),r=0,i=t[0],l=1,c=function(u){n[r++]=u},d=1;d<=e;++d)if(t[d]==i&&d!=e)++l;else{if(!i&&l>2){for(;l>138;l-=138)c(32754);l>2&&(c(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(c(i),--l;l>6;l-=6)c(8304);l>2&&(c(l-3<<5|8208),l=0)}for(;l--;)c(i);l=1,i=t[d]}return{c:n.subarray(0,r),n:e}},Om=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},qj=function(t,e,n){var r=n.length,i=zj(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var l=0;l<r;++l)t[i+l+4]=n[l];return(i+4+r)*8},dR=function(t,e,n,r,i,l,c,d,u,f,m){Fc(e,m++,n),++i[256];for(var _=AC(i,15),y=_.t,g=_.l,N=AC(l,15),C=N.t,v=N.l,R=cR(y),U=R.c,L=R.n,w=cR(C),P=w.c,G=w.n,K=new Dl(19),B=0;B<U.length;++B)++K[U[B]&31];for(var B=0;B<P.length;++B)++K[P[B]&31];for(var O=AC(K,7),S=O.t,A=O.l,Y=19;Y>4&&!S[lR[Y-1]];--Y);var te=f+5<<3,J=Om(i,Sh)+Om(l,z_)+c,q=Om(i,y)+Om(l,C)+c+14+3*Y+Om(K,S)+2*K[16]+3*K[17]+7*K[18];if(u>=0&&te<=J&&te<=q)return qj(e,m,t.subarray(u,u+f));var V,F,I,ee;if(Fc(e,m,1+(q<J)),m+=2,q<J){V=zm(y,g,0),F=y,I=zm(C,v,0),ee=C;var ae=zm(S,A,0);Fc(e,m,L-257),Fc(e,m+5,G-1),Fc(e,m+10,Y-4),m+=14;for(var B=0;B<Y;++B)Fc(e,m+3*B,S[lR[B]]);m+=3*Y;for(var T=[U,P],j=0;j<2;++j)for(var k=T[j],B=0;B<k.length;++B){var Q=k[B]&31;Fc(e,m,ae[Q]),m+=S[Q],Q>15&&(Fc(e,m,k[B]>>5&127),m+=k[B]>>12)}}else V=_B,F=Sh,I=xB,ee=z_;for(var B=0;B<d;++B){var H=r[B];if(H>255){var Q=H>>18&31;Im(e,m,V[Q+257]),m+=F[Q+257],Q>7&&(Fc(e,m,H>>23&31),m+=SN[Q]);var $=H&31;Im(e,m,I[$]),m+=ee[$],$>3&&(Im(e,m,H>>5&8191),m+=vN[$])}else Im(e,m,V[H]),m+=F[H]}return Im(e,m,V[256]),m+F[256]},yB=new NN([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Xj=new Mo(0),bB=function(t,e,n,r,i,l){var c=l.z||t.length,d=new Mo(r+c+5*(1+Math.ceil(c/7e3))+i),u=d.subarray(r,d.length-i),f=l.l,m=(l.r||0)&7;if(e){m&&(u[0]=l.r>>3);for(var _=yB[e-1],y=_>>13,g=_&8191,N=(1<<n)-1,C=l.p||new Dl(32768),v=l.h||new Dl(N+1),R=Math.ceil(n/3),U=2*R,L=function(me){return(t[me]^t[me+1]<<R^t[me+2]<<U)&N},w=new NN(25e3),P=new Dl(288),G=new Dl(32),K=0,B=0,O=l.i||0,S=0,A=l.w||0,Y=0;O+2<c;++O){var te=L(O),J=O&32767,q=v[te];if(C[J]=q,v[te]=J,A<=O){var V=c-O;if((K>7e3||S>24576)&&(V>423||!f)){m=dR(t,u,0,w,P,G,B,S,Y,O-Y,m),S=K=B=0,Y=O;for(var F=0;F<286;++F)P[F]=0;for(var F=0;F<30;++F)G[F]=0}var I=2,ee=0,ae=g,T=J-q&32767;if(V>2&&te==L(O-T))for(var j=Math.min(y,V)-1,k=Math.min(32767,O),Q=Math.min(258,V);T<=k&&--ae&&J!=q;){if(t[O+I]==t[O+I-T]){for(var H=0;H<Q&&t[O+H]==t[O+H-T];++H);if(H>I){if(I=H,ee=T,H>j)break;for(var $=Math.min(T,H-2),ie=0,F=0;F<$;++F){var fe=O-T+F&32767,pe=C[fe],de=fe-pe&32767;de>ie&&(ie=de,q=fe)}}}J=q,q=C[J],T+=J-q&32767}if(ee){w[S++]=268435456|zy[I]<<18|oR[ee];var Re=zy[I]&31,X=oR[ee]&31;B+=SN[Re]+vN[X],++P[257+Re],++G[X],A=O+I,++K}else w[S++]=t[O],++P[t[O]]}}for(O=Math.max(O,A);O<c;++O)w[S++]=t[O],++P[t[O]];m=dR(t,u,f,w,P,G,B,S,Y,O-Y,m),f||(l.r=m&7|u[m/8|0]<<3,m-=7,l.h=v,l.p=C,l.i=O,l.w=A)}else{for(var O=l.w||0;O<c+f;O+=65535){var _e=O+65535;_e>=c&&(u[m/8|0]=f,_e=c),m=qj(u,m+1,t.subarray(O,_e))}l.i=c}return CB(d,0,r+zj(m)+i)},Jj=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,l=n.length|0,c=0;c!=l;){for(var d=Math.min(c+2655,l);c<d;++c)i+=r+=n[c];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},NB=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var l=e.dictionary.subarray(-32768),c=new Mo(l.length+t.length);c.set(l),c.set(t,l.length),t=c,i.w=l.length}return bB(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},Zj=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},SB=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=Jj();i.p(e.dictionary),Zj(t,2,i.d())}};function Jy(t,e){e||(e={});var n=Jj();n.p(t);var r=NB(t,e,e.dictionary?6:2,4);return SB(r,e),Zj(r,r.length-4,n.d()),r}var vB=typeof TextDecoder<"u"&&new TextDecoder,DB=0;try{vB.decode(Xj,{stream:!0}),DB=1}catch{}function RB(t){if(Array.isArray(t))return t}function TB(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,l,c,d=[],u=!0,f=!1;try{if(l=(n=n.call(t)).next,e!==0)for(;!(u=(r=l.call(n)).done)&&(d.push(r.value),d.length!==e);u=!0);}catch(m){f=!0,i=m}finally{try{if(!u&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(f)throw i}}return d}}function uR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function EB(t,e){if(t){if(typeof t=="string")return uR(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uR(t,e):void 0}}function jB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hR(t,e){return RB(t)||TB(t,e)||EB(t,e)||jB()}function fR(t,e="utf8"){return new TextDecoder(e).decode(t)}const IB=new TextEncoder;function OB(t){return IB.encode(t)}const MB=1024*8,LB=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),kC={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class DN{constructor(e=MB,n={}){lr(this,"buffer");lr(this,"byteLength");lr(this,"byteOffset");lr(this,"length");lr(this,"offset");lr(this,"lastWrittenByte");lr(this,"littleEndian");lr(this,"_data");lr(this,"_mark");lr(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=n.offset?n.offset>>>0:0,l=e.byteLength-i;let c=i;(ArrayBuffer.isView(e)||e instanceof DN)&&(e.byteLength!==e.buffer.byteLength&&(c=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=l:this.lastWrittenByte=0,this.buffer=e,this.length=l,this.byteLength=l,this.byteOffset=c,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,c,l),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=kC[n].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,l=this.buffer.slice(i,i+r);if(this.littleEndian===LB&&n!=="uint8"&&n!=="int8"){const d=new Uint8Array(this.buffer.slice(i,i+r));d.reverse();const u=new kC[n](d.buffer);return this.offset+=r,u.reverse(),u}const c=new kC[n](l);return this.offset+=r,c}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return fR(this.readBytes(e))}decodeText(e=1,n="utf8"){return fR(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(OB(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function kf(t){let e=t.length;for(;--e>=0;)t[e]=0}const wB=3,PB=258,eI=29,AB=256,kB=AB+1+eI,tI=30,UB=512,BB=new Array((kB+2)*2);kf(BB);const WB=new Array(tI*2);kf(WB);const FB=new Array(UB);kf(FB);const KB=new Array(PB-wB+1);kf(KB);const QB=new Array(eI);kf(QB);const GB=new Array(tI);kf(GB);const YB=(t,e,n,r)=>{let i=t&65535|0,l=t>>>16&65535|0,c=0;for(;n!==0;){c=n>2e3?2e3:n,n-=c;do i=i+e[r++]|0,l=l+i|0;while(--c);i%=65521,l%=65521}return i|l<<16|0};var Zy=YB;const VB=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},$B=new Uint32Array(VB()),HB=(t,e,n,r)=>{const i=$B,l=r+n;t^=-1;for(let c=r;c<l;c++)t=t>>>8^i[(t^e[c])&255];return t^-1};var ec=HB,eb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},sI={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const zB=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var qB=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)zB(n,r)&&(t[r]=n[r])}}return t},XB=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,l=t.length;r<l;r++){let c=t[r];n.set(c,i),i+=c.length}return n},nI={assign:qB,flattenChunks:XB};let rI=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rI=!1}const hg=new Uint8Array(256);for(let t=0;t<256;t++)hg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;hg[254]=hg[254]=1;var JB=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,l,c=t.length,d=0;for(i=0;i<c;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<c&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),d+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(d),l=0,i=0;l<d;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<c&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[l++]=n:n<2048?(e[l++]=192|n>>>6,e[l++]=128|n&63):n<65536?(e[l++]=224|n>>>12,e[l++]=128|n>>>6&63,e[l++]=128|n&63):(e[l++]=240|n>>>18,e[l++]=128|n>>>12&63,e[l++]=128|n>>>6&63,e[l++]=128|n&63);return e};const ZB=(t,e)=>{if(e<65534&&t.subarray&&rI)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var eW=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const l=new Array(n*2);for(i=0,r=0;r<n;){let c=t[r++];if(c<128){l[i++]=c;continue}let d=hg[c];if(d>4){l[i++]=65533,r+=d-1;continue}for(c&=d===2?31:d===3?15:7;d>1&&r<n;)c=c<<6|t[r++]&63,d--;if(d>1){l[i++]=65533;continue}c<65536?l[i++]=c:(c-=65536,l[i++]=55296|c>>10&1023,l[i++]=56320|c&1023)}return ZB(l,i)},tW=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+hg[t[n]]>e?n:e},tb={string2buf:JB,buf2string:eW,utf8border:tW};function sW(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var nW=sW;const $p=16209,rW=16191;var iW=function(e,n){let r,i,l,c,d,u,f,m,_,y,g,N,C,v,R,U,L,w,P,G,K,B,O,S;const A=e.state;r=e.next_in,O=e.input,i=r+(e.avail_in-5),l=e.next_out,S=e.output,c=l-(n-e.avail_out),d=l+(e.avail_out-257),u=A.dmax,f=A.wsize,m=A.whave,_=A.wnext,y=A.window,g=A.hold,N=A.bits,C=A.lencode,v=A.distcode,R=(1<<A.lenbits)-1,U=(1<<A.distbits)-1;e:do{N<15&&(g+=O[r++]<<N,N+=8,g+=O[r++]<<N,N+=8),L=C[g&R];t:for(;;){if(w=L>>>24,g>>>=w,N-=w,w=L>>>16&255,w===0)S[l++]=L&65535;else if(w&16){P=L&65535,w&=15,w&&(N<w&&(g+=O[r++]<<N,N+=8),P+=g&(1<<w)-1,g>>>=w,N-=w),N<15&&(g+=O[r++]<<N,N+=8,g+=O[r++]<<N,N+=8),L=v[g&U];s:for(;;){if(w=L>>>24,g>>>=w,N-=w,w=L>>>16&255,w&16){if(G=L&65535,w&=15,N<w&&(g+=O[r++]<<N,N+=8,N<w&&(g+=O[r++]<<N,N+=8)),G+=g&(1<<w)-1,G>u){e.msg="invalid distance too far back",A.mode=$p;break e}if(g>>>=w,N-=w,w=l-c,G>w){if(w=G-w,w>m&&A.sane){e.msg="invalid distance too far back",A.mode=$p;break e}if(K=0,B=y,_===0){if(K+=f-w,w<P){P-=w;do S[l++]=y[K++];while(--w);K=l-G,B=S}}else if(_<w){if(K+=f+_-w,w-=_,w<P){P-=w;do S[l++]=y[K++];while(--w);if(K=0,_<P){w=_,P-=w;do S[l++]=y[K++];while(--w);K=l-G,B=S}}}else if(K+=_-w,w<P){P-=w;do S[l++]=y[K++];while(--w);K=l-G,B=S}for(;P>2;)S[l++]=B[K++],S[l++]=B[K++],S[l++]=B[K++],P-=3;P&&(S[l++]=B[K++],P>1&&(S[l++]=B[K++]))}else{K=l-G;do S[l++]=S[K++],S[l++]=S[K++],S[l++]=S[K++],P-=3;while(P>2);P&&(S[l++]=S[K++],P>1&&(S[l++]=S[K++]))}}else if((w&64)===0){L=v[(L&65535)+(g&(1<<w)-1)];continue s}else{e.msg="invalid distance code",A.mode=$p;break e}break}}else if((w&64)===0){L=C[(L&65535)+(g&(1<<w)-1)];continue t}else if(w&32){A.mode=rW;break e}else{e.msg="invalid literal/length code",A.mode=$p;break e}break}}while(r<i&&l<d);P=N>>3,r-=P,N-=P<<3,g&=(1<<N)-1,e.next_in=r,e.next_out=l,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=l<d?257+(d-l):257-(l-d),A.hold=g,A.bits=N};const M0=15,mR=852,gR=592,pR=0,UC=1,_R=2,aW=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lW=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),oW=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cW=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),dW=(t,e,n,r,i,l,c,d)=>{const u=d.bits;let f=0,m=0,_=0,y=0,g=0,N=0,C=0,v=0,R=0,U=0,L,w,P,G,K,B=null,O;const S=new Uint16Array(M0+1),A=new Uint16Array(M0+1);let Y=null,te,J,q;for(f=0;f<=M0;f++)S[f]=0;for(m=0;m<r;m++)S[e[n+m]]++;for(g=u,y=M0;y>=1&&S[y]===0;y--);if(g>y&&(g=y),y===0)return i[l++]=1<<24|64<<16|0,i[l++]=1<<24|64<<16|0,d.bits=1,0;for(_=1;_<y&&S[_]===0;_++);for(g<_&&(g=_),v=1,f=1;f<=M0;f++)if(v<<=1,v-=S[f],v<0)return-1;if(v>0&&(t===pR||y!==1))return-1;for(A[1]=0,f=1;f<M0;f++)A[f+1]=A[f]+S[f];for(m=0;m<r;m++)e[n+m]!==0&&(c[A[e[n+m]]++]=m);if(t===pR?(B=Y=c,O=20):t===UC?(B=aW,Y=lW,O=257):(B=oW,Y=cW,O=0),U=0,m=0,f=_,K=l,N=g,C=0,P=-1,R=1<<g,G=R-1,t===UC&&R>mR||t===_R&&R>gR)return 1;for(;;){te=f-C,c[m]+1<O?(J=0,q=c[m]):c[m]>=O?(J=Y[c[m]-O],q=B[c[m]-O]):(J=96,q=0),L=1<<f-C,w=1<<N,_=w;do w-=L,i[K+(U>>C)+w]=te<<24|J<<16|q|0;while(w!==0);for(L=1<<f-1;U&L;)L>>=1;if(L!==0?(U&=L-1,U+=L):U=0,m++,--S[f]===0){if(f===y)break;f=e[n+c[m]]}if(f>g&&(U&G)!==P){for(C===0&&(C=g),K+=_,N=f-C,v=1<<N;N+C<y&&(v-=S[N+C],!(v<=0));)N++,v<<=1;if(R+=1<<N,t===UC&&R>mR||t===_R&&R>gR)return 1;P=U&G,i[P]=g<<24|N<<16|K-l|0}}return U!==0&&(i[K+U]=f-C<<24|64<<16|0),d.bits=g,0};var qm=dW;const uW=0,iI=1,aI=2,{Z_FINISH:xR,Z_BLOCK:hW,Z_TREES:Hp,Z_OK:vh,Z_STREAM_END:fW,Z_NEED_DICT:mW,Z_STREAM_ERROR:eo,Z_DATA_ERROR:lI,Z_MEM_ERROR:oI,Z_BUF_ERROR:gW,Z_DEFLATED:CR}=sI,jx=16180,yR=16181,bR=16182,NR=16183,SR=16184,vR=16185,DR=16186,RR=16187,TR=16188,ER=16189,q_=16190,Kc=16191,BC=16192,jR=16193,WC=16194,IR=16195,OR=16196,MR=16197,LR=16198,zp=16199,qp=16200,wR=16201,PR=16202,AR=16203,kR=16204,UR=16205,FC=16206,BR=16207,WR=16208,$r=16209,cI=16210,dI=16211,pW=852,_W=592,xW=15,CW=xW,FR=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function yW(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Uh=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<jx||e.mode>dI?1:0},uI=t=>{if(Uh(t))return eo;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=jx,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(pW),e.distcode=e.distdyn=new Int32Array(_W),e.sane=1,e.back=-1,vh},hI=t=>{if(Uh(t))return eo;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,uI(t)},fI=(t,e)=>{let n;if(Uh(t))return eo;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?eo:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,hI(t))},mI=(t,e)=>{if(!t)return eo;const n=new yW;t.state=n,n.strm=t,n.window=null,n.mode=jx;const r=fI(t,e);return r!==vh&&(t.state=null),r},bW=t=>mI(t,CW);let KR=!0,KC,QC;const NW=t=>{if(KR){KC=new Int32Array(512),QC=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(qm(iI,t.lens,0,288,KC,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;qm(aI,t.lens,0,32,QC,0,t.work,{bits:5}),KR=!1}t.lencode=KC,t.lenbits=9,t.distcode=QC,t.distbits=5},gI=(t,e,n,r)=>{let i;const l=t.state;return l.window===null&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new Uint8Array(l.wsize)),r>=l.wsize?(l.window.set(e.subarray(n-l.wsize,n),0),l.wnext=0,l.whave=l.wsize):(i=l.wsize-l.wnext,i>r&&(i=r),l.window.set(e.subarray(n-r,n-r+i),l.wnext),r-=i,r?(l.window.set(e.subarray(n-r,n),0),l.wnext=r,l.whave=l.wsize):(l.wnext+=i,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=i))),0},SW=(t,e)=>{let n,r,i,l,c,d,u,f,m,_,y,g,N,C,v=0,R,U,L,w,P,G,K,B;const O=new Uint8Array(4);let S,A;const Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Uh(t)||!t.output||!t.input&&t.avail_in!==0)return eo;n=t.state,n.mode===Kc&&(n.mode=BC),c=t.next_out,i=t.output,u=t.avail_out,l=t.next_in,r=t.input,d=t.avail_in,f=n.hold,m=n.bits,_=d,y=u,B=vh;e:for(;;)switch(n.mode){case jx:if(n.wrap===0){n.mode=BC;break}for(;m<16;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(n.wrap&2&&f===35615){n.wbits===0&&(n.wbits=15),n.check=0,O[0]=f&255,O[1]=f>>>8&255,n.check=ec(n.check,O,2,0),f=0,m=0,n.mode=yR;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check",n.mode=$r;break}if((f&15)!==CR){t.msg="unknown compression method",n.mode=$r;break}if(f>>>=4,m-=4,K=(f&15)+8,n.wbits===0&&(n.wbits=K),K>15||K>n.wbits){t.msg="invalid window size",n.mode=$r;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=f&512?ER:Kc,f=0,m=0;break;case yR:for(;m<16;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(n.flags=f,(n.flags&255)!==CR){t.msg="unknown compression method",n.mode=$r;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=$r;break}n.head&&(n.head.text=f>>8&1),n.flags&512&&n.wrap&4&&(O[0]=f&255,O[1]=f>>>8&255,n.check=ec(n.check,O,2,0)),f=0,m=0,n.mode=bR;case bR:for(;m<32;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}n.head&&(n.head.time=f),n.flags&512&&n.wrap&4&&(O[0]=f&255,O[1]=f>>>8&255,O[2]=f>>>16&255,O[3]=f>>>24&255,n.check=ec(n.check,O,4,0)),f=0,m=0,n.mode=NR;case NR:for(;m<16;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}n.head&&(n.head.xflags=f&255,n.head.os=f>>8),n.flags&512&&n.wrap&4&&(O[0]=f&255,O[1]=f>>>8&255,n.check=ec(n.check,O,2,0)),f=0,m=0,n.mode=SR;case SR:if(n.flags&1024){for(;m<16;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}n.length=f,n.head&&(n.head.extra_len=f),n.flags&512&&n.wrap&4&&(O[0]=f&255,O[1]=f>>>8&255,n.check=ec(n.check,O,2,0)),f=0,m=0}else n.head&&(n.head.extra=null);n.mode=vR;case vR:if(n.flags&1024&&(g=n.length,g>d&&(g=d),g&&(n.head&&(K=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(l,l+g),K)),n.flags&512&&n.wrap&4&&(n.check=ec(n.check,r,g,l)),d-=g,l+=g,n.length-=g),n.length))break e;n.length=0,n.mode=DR;case DR:if(n.flags&2048){if(d===0)break e;g=0;do K=r[l+g++],n.head&&K&&n.length<65536&&(n.head.name+=String.fromCharCode(K));while(K&&g<d);if(n.flags&512&&n.wrap&4&&(n.check=ec(n.check,r,g,l)),d-=g,l+=g,K)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=RR;case RR:if(n.flags&4096){if(d===0)break e;g=0;do K=r[l+g++],n.head&&K&&n.length<65536&&(n.head.comment+=String.fromCharCode(K));while(K&&g<d);if(n.flags&512&&n.wrap&4&&(n.check=ec(n.check,r,g,l)),d-=g,l+=g,K)break e}else n.head&&(n.head.comment=null);n.mode=TR;case TR:if(n.flags&512){for(;m<16;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(n.wrap&4&&f!==(n.check&65535)){t.msg="header crc mismatch",n.mode=$r;break}f=0,m=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Kc;break;case ER:for(;m<32;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}t.adler=n.check=FR(f),f=0,m=0,n.mode=q_;case q_:if(n.havedict===0)return t.next_out=c,t.avail_out=u,t.next_in=l,t.avail_in=d,n.hold=f,n.bits=m,mW;t.adler=n.check=1,n.mode=Kc;case Kc:if(e===hW||e===Hp)break e;case BC:if(n.last){f>>>=m&7,m-=m&7,n.mode=FC;break}for(;m<3;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}switch(n.last=f&1,f>>>=1,m-=1,f&3){case 0:n.mode=jR;break;case 1:if(NW(n),n.mode=zp,e===Hp){f>>>=2,m-=2;break e}break;case 2:n.mode=OR;break;case 3:t.msg="invalid block type",n.mode=$r}f>>>=2,m-=2;break;case jR:for(f>>>=m&7,m-=m&7;m<32;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths",n.mode=$r;break}if(n.length=f&65535,f=0,m=0,n.mode=WC,e===Hp)break e;case WC:n.mode=IR;case IR:if(g=n.length,g){if(g>d&&(g=d),g>u&&(g=u),g===0)break e;i.set(r.subarray(l,l+g),c),d-=g,l+=g,u-=g,c+=g,n.length-=g;break}n.mode=Kc;break;case OR:for(;m<14;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(n.nlen=(f&31)+257,f>>>=5,m-=5,n.ndist=(f&31)+1,f>>>=5,m-=5,n.ncode=(f&15)+4,f>>>=4,m-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=$r;break}n.have=0,n.mode=MR;case MR:for(;n.have<n.ncode;){for(;m<3;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}n.lens[Y[n.have++]]=f&7,f>>>=3,m-=3}for(;n.have<19;)n.lens[Y[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},B=qm(uW,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,B){t.msg="invalid code lengths set",n.mode=$r;break}n.have=0,n.mode=LR;case LR:for(;n.have<n.nlen+n.ndist;){for(;v=n.lencode[f&(1<<n.lenbits)-1],R=v>>>24,U=v>>>16&255,L=v&65535,!(R<=m);){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(L<16)f>>>=R,m-=R,n.lens[n.have++]=L;else{if(L===16){for(A=R+2;m<A;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(f>>>=R,m-=R,n.have===0){t.msg="invalid bit length repeat",n.mode=$r;break}K=n.lens[n.have-1],g=3+(f&3),f>>>=2,m-=2}else if(L===17){for(A=R+3;m<A;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}f>>>=R,m-=R,K=0,g=3+(f&7),f>>>=3,m-=3}else{for(A=R+7;m<A;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}f>>>=R,m-=R,K=0,g=11+(f&127),f>>>=7,m-=7}if(n.have+g>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=$r;break}for(;g--;)n.lens[n.have++]=K}}if(n.mode===$r)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=$r;break}if(n.lenbits=9,S={bits:n.lenbits},B=qm(iI,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,B){t.msg="invalid literal/lengths set",n.mode=$r;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},B=qm(aI,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,B){t.msg="invalid distances set",n.mode=$r;break}if(n.mode=zp,e===Hp)break e;case zp:n.mode=qp;case qp:if(d>=6&&u>=258){t.next_out=c,t.avail_out=u,t.next_in=l,t.avail_in=d,n.hold=f,n.bits=m,iW(t,y),c=t.next_out,i=t.output,u=t.avail_out,l=t.next_in,r=t.input,d=t.avail_in,f=n.hold,m=n.bits,n.mode===Kc&&(n.back=-1);break}for(n.back=0;v=n.lencode[f&(1<<n.lenbits)-1],R=v>>>24,U=v>>>16&255,L=v&65535,!(R<=m);){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(U&&(U&240)===0){for(w=R,P=U,G=L;v=n.lencode[G+((f&(1<<w+P)-1)>>w)],R=v>>>24,U=v>>>16&255,L=v&65535,!(w+R<=m);){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}f>>>=w,m-=w,n.back+=w}if(f>>>=R,m-=R,n.back+=R,n.length=L,U===0){n.mode=UR;break}if(U&32){n.back=-1,n.mode=Kc;break}if(U&64){t.msg="invalid literal/length code",n.mode=$r;break}n.extra=U&15,n.mode=wR;case wR:if(n.extra){for(A=n.extra;m<A;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}n.length+=f&(1<<n.extra)-1,f>>>=n.extra,m-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=PR;case PR:for(;v=n.distcode[f&(1<<n.distbits)-1],R=v>>>24,U=v>>>16&255,L=v&65535,!(R<=m);){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if((U&240)===0){for(w=R,P=U,G=L;v=n.distcode[G+((f&(1<<w+P)-1)>>w)],R=v>>>24,U=v>>>16&255,L=v&65535,!(w+R<=m);){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}f>>>=w,m-=w,n.back+=w}if(f>>>=R,m-=R,n.back+=R,U&64){t.msg="invalid distance code",n.mode=$r;break}n.offset=L,n.extra=U&15,n.mode=AR;case AR:if(n.extra){for(A=n.extra;m<A;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}n.offset+=f&(1<<n.extra)-1,f>>>=n.extra,m-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=$r;break}n.mode=kR;case kR:if(u===0)break e;if(g=y-u,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=$r;break}g>n.wnext?(g-=n.wnext,N=n.wsize-g):N=n.wnext-g,g>n.length&&(g=n.length),C=n.window}else C=i,N=c-n.offset,g=n.length;g>u&&(g=u),u-=g,n.length-=g;do i[c++]=C[N++];while(--g);n.length===0&&(n.mode=qp);break;case UR:if(u===0)break e;i[c++]=n.length,u--,n.mode=qp;break;case FC:if(n.wrap){for(;m<32;){if(d===0)break e;d--,f|=r[l++]<<m,m+=8}if(y-=u,t.total_out+=y,n.total+=y,n.wrap&4&&y&&(t.adler=n.check=n.flags?ec(n.check,i,y,c-y):Zy(n.check,i,y,c-y)),y=u,n.wrap&4&&(n.flags?f:FR(f))!==n.check){t.msg="incorrect data check",n.mode=$r;break}f=0,m=0}n.mode=BR;case BR:if(n.wrap&&n.flags){for(;m<32;){if(d===0)break e;d--,f+=r[l++]<<m,m+=8}if(n.wrap&4&&f!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=$r;break}f=0,m=0}n.mode=WR;case WR:B=fW;break e;case $r:B=lI;break e;case cI:return oI;case dI:default:return eo}return t.next_out=c,t.avail_out=u,t.next_in=l,t.avail_in=d,n.hold=f,n.bits=m,(n.wsize||y!==t.avail_out&&n.mode<$r&&(n.mode<FC||e!==xR))&&gI(t,t.output,t.next_out,y-t.avail_out),_-=t.avail_in,y-=t.avail_out,t.total_in+=_,t.total_out+=y,n.total+=y,n.wrap&4&&y&&(t.adler=n.check=n.flags?ec(n.check,i,y,t.next_out-y):Zy(n.check,i,y,t.next_out-y)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Kc?128:0)+(n.mode===zp||n.mode===WC?256:0),(_===0&&y===0||e===xR)&&B===vh&&(B=gW),B},vW=t=>{if(Uh(t))return eo;let e=t.state;return e.window&&(e.window=null),t.state=null,vh},DW=(t,e)=>{if(Uh(t))return eo;const n=t.state;return(n.wrap&2)===0?eo:(n.head=e,e.done=!1,vh)},RW=(t,e)=>{const n=e.length;let r,i,l;return Uh(t)||(r=t.state,r.wrap!==0&&r.mode!==q_)?eo:r.mode===q_&&(i=1,i=Zy(i,e,n,0),i!==r.check)?lI:(l=gI(t,e,n,n),l?(r.mode=cI,oI):(r.havedict=1,vh))};var TW=hI,EW=fI,jW=uI,IW=bW,OW=mI,MW=SW,LW=vW,wW=DW,PW=RW,AW="pako inflate (from Nodeca project)",$c={inflateReset:TW,inflateReset2:EW,inflateResetKeep:jW,inflateInit:IW,inflateInit2:OW,inflate:MW,inflateEnd:LW,inflateGetHeader:wW,inflateSetDictionary:PW,inflateInfo:AW};function kW(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var UW=kW;const pI=Object.prototype.toString,{Z_NO_FLUSH:BW,Z_FINISH:WW,Z_OK:fg,Z_STREAM_END:GC,Z_NEED_DICT:YC,Z_STREAM_ERROR:FW,Z_DATA_ERROR:QR,Z_MEM_ERROR:KW}=sI;function Lg(t){this.options=nI.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nW,this.strm.avail_out=0;let n=$c.inflateInit2(this.strm,e.windowBits);if(n!==fg)throw new Error(eb[n]);if(this.header=new UW,$c.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=tb.string2buf(e.dictionary):pI.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=$c.inflateSetDictionary(this.strm,e.dictionary),n!==fg)))throw new Error(eb[n])}Lg.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let l,c,d;if(this.ended)return!1;for(e===~~e?c=e:c=e===!0?WW:BW,pI.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),l=$c.inflate(n,c),l===YC&&i&&(l=$c.inflateSetDictionary(n,i),l===fg?l=$c.inflate(n,c):l===QR&&(l=YC));n.avail_in>0&&l===GC&&n.state.wrap>0&&t[n.next_in]!==0;)$c.inflateReset(n),l=$c.inflate(n,c);switch(l){case FW:case QR:case YC:case KW:return this.onEnd(l),this.ended=!0,!1}if(d=n.avail_out,n.next_out&&(n.avail_out===0||l===GC))if(this.options.to==="string"){let u=tb.utf8border(n.output,n.next_out),f=n.next_out-u,m=tb.buf2string(n.output,u);n.next_out=f,n.avail_out=r-f,f&&n.output.set(n.output.subarray(u,u+f),0),this.onData(m)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(l===fg&&d===0)){if(l===GC)return l=$c.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Lg.prototype.onData=function(t){this.chunks.push(t)};Lg.prototype.onEnd=function(t){t===fg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=nI.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function QW(t,e){const n=new Lg(e);if(n.push(t),n.err)throw n.msg||eb[n.err];return n.result}var GW=Lg,YW=QW,VW={Inflate:GW,inflate:YW};const{Inflate:$W,inflate:HW}=VW;var GR=$W,zW=HW;const _I=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;_I[t]=e}const YR=4294967295;function qW(t,e,n){let r=t;for(let i=0;i<n;i++)r=_I[(r^e[i])&255]^r>>>8;return r}function XW(t,e){return(qW(YR,t,e)^YR)>>>0}function VR(t,e,n){const r=t.readUint32(),i=XW(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${i}`)}function xI(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function CI(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function yI(t,e,n,r){let i=0;if(n.length===0)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function bI(t,e,n,r,i){let l=0;if(n.length===0){for(;l<i;l++)e[l]=t[l];for(;l<r;l++)e[l]=t[l]+(e[l-i]>>1)&255}else{for(;l<i;l++)e[l]=t[l]+(n[l]>>1)&255;for(;l<r;l++)e[l]=t[l]+(e[l-i]+n[l]>>1)&255}}function NI(t,e,n,r,i){let l=0;if(n.length===0){for(;l<i;l++)e[l]=t[l];for(;l<r;l++)e[l]=t[l]+e[l-i]&255}else{for(;l<i;l++)e[l]=t[l]+n[l]&255;for(;l<r;l++)e[l]=t[l]+JW(e[l-i],n[l],n[l-i])&255}}function JW(t,e,n){const r=t+e-n,i=Math.abs(r-t),l=Math.abs(r-e),c=Math.abs(r-n);return i<=l&&i<=c?t:l<=c?e:n}function ZW(t,e,n,r,i,l){switch(t){case 0:xI(e,n,i);break;case 1:CI(e,n,i,l);break;case 2:yI(e,n,r,i);break;case 3:bI(e,n,r,i,l);break;case 4:NI(e,n,r,i,l);break;default:throw new Error(`Unsupported filter: ${t}`)}}const eF=new Uint16Array([255]),tF=new Uint8Array(eF.buffer),sF=tF[0]===255;function nF(t){const{data:e,width:n,height:r,channels:i,depth:l}=t,c=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],d=Math.ceil(l/8)*i,u=new Uint8Array(r*n*d);let f=0;for(let m=0;m<7;m++){const _=c[m],y=Math.ceil((n-_.x)/_.xStep),g=Math.ceil((r-_.y)/_.yStep);if(y<=0||g<=0)continue;const N=y*d,C=new Uint8Array(N);for(let v=0;v<g;v++){const R=e[f++],U=e.subarray(f,f+N);f+=N;const L=new Uint8Array(N);ZW(R,U,L,C,N,d),C.set(L);for(let w=0;w<y;w++){const P=_.x+w*_.xStep,G=_.y+v*_.yStep;if(!(P>=n||G>=r))for(let K=0;K<d;K++)u[(G*n+P)*d+K]=L[w*d+K]}}}if(l===16){const m=new Uint16Array(u.buffer);if(sF)for(let _=0;_<m.length;_++)m[_]=rF(m[_]);return m}else return u}function rF(t){return(t&255)<<8|t>>8&255}const iF=new Uint16Array([255]),aF=new Uint8Array(iF.buffer),lF=aF[0]===255,oF=new Uint8Array(0);function $R(t){const{data:e,width:n,height:r,channels:i,depth:l}=t,c=Math.ceil(l/8)*i,d=Math.ceil(l/8*i*n),u=new Uint8Array(r*d);let f=oF,m=0,_,y;for(let g=0;g<r;g++){switch(_=e.subarray(m+1,m+1+d),y=u.subarray(g*d,(g+1)*d),e[m]){case 0:xI(_,y,d);break;case 1:CI(_,y,d,c);break;case 2:yI(_,y,f,d);break;case 3:bI(_,y,f,d,c);break;case 4:NI(_,y,f,d,c);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}f=y,m+=d+1}if(l===16){const g=new Uint16Array(u.buffer);if(lF)for(let N=0;N<g.length;N++)g[N]=cF(g[N]);return g}else return u}function cF(t){return(t&255)<<8|t>>8&255}const h_=Uint8Array.of(137,80,78,71,13,10,26,10);function HR(t){if(!dF(t.readBytes(h_.length)))throw new Error("wrong PNG signature")}function dF(t){if(t.length<h_.length)return!1;for(let e=0;e<h_.length;e++)if(t[e]!==h_[e])return!1;return!0}const uF="tEXt",hF=0,SI=new TextDecoder("latin1");function fF(t){if(gF(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const mF=/^[\u0000-\u00FF]*$/;function gF(t){if(!mF.test(t))throw new Error("invalid latin1 text")}function pF(t,e,n){const r=vI(e);t[r]=_F(e,n-r.length-1)}function vI(t){for(t.mark();t.readByte()!==hF;);const e=t.offset;t.reset();const n=SI.decode(t.readBytes(e-t.offset-1));return t.skip(1),fF(n),n}function _F(t,e){return SI.decode(t.readBytes(e))}const vl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},VC={UNKNOWN:-1,DEFLATE:0},zR={UNKNOWN:-1,ADAPTIVE:0},$C={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Xp={NONE:0,BACKGROUND:1,PREVIOUS:2},HC={SOURCE:0,OVER:1};class xF extends DN{constructor(n,r={}){super(n);lr(this,"_checkCrc");lr(this,"_inflator");lr(this,"_png");lr(this,"_apng");lr(this,"_end");lr(this,"_hasPalette");lr(this,"_palette");lr(this,"_hasTransparency");lr(this,"_transparency");lr(this,"_compressionMethod");lr(this,"_filterMethod");lr(this,"_interlaceMethod");lr(this,"_colorType");lr(this,"_isAnimated");lr(this,"_numberOfFrames");lr(this,"_numberOfPlays");lr(this,"_frames");lr(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new GR,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=VC.UNKNOWN,this._filterMethod=zR.UNKNOWN,this._interlaceMethod=$C.UNKNOWN,this._colorType=vl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(HR(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(HR(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case uF:pF(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?VR(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=i+n;break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?VR(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=CF(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case vl.GREYSCALE:i=1;break;case vl.TRUECOLOUR:i=3;break;case vl.INDEXED_COLOUR:i=1;break;case vl.GREYSCALE_ALPHA:i=2;break;case vl.TRUECOLOUR_ALPHA:i=4;break;case vl.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==VC.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const i=[];this._palette=i;for(let l=0;l<r;l++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case vl.GREYSCALE:case vl.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case vl.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case vl.UNKNOWN:case vl.GREYSCALE_ALPHA:case vl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=vI(this),i=this.readUint8();if(i!==VC.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const l=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:zW(l)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:n,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(n);if(i){if(i.data=$R({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const l=this._apng.frames.at(n-1);this.disposeFrame(i,l,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,i){switch(n.disposeOp){case Xp.NONE:break;case Xp.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let c=0;c<this._png.width;c++){const d=(l*n.width+c)*this._png.channels;for(let u=0;u<this._png.channels;u++)i.data[d+u]=0}break;case Xp.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const i=1<<this._png.depth,l=(c,d)=>{const u=((c+r.yOffset)*this._png.width+r.xOffset+d)*this._png.channels,f=(c*r.width+d)*this._png.channels;return{index:u,frameIndex:f}};switch(r.blendOp){case HC.SOURCE:for(let c=0;c<r.height;c++)for(let d=0;d<r.width;d++){const{index:u,frameIndex:f}=l(c,d);for(let m=0;m<this._png.channels;m++)n.data[u+m]=r.data[f+m]}break;case HC.OVER:for(let c=0;c<r.height;c++)for(let d=0;d<r.width;d++){const{index:u,frameIndex:f}=l(c,d);for(let m=0;m<this._png.channels;m++){const _=r.data[f+this._png.channels-1]/i,y=m%(this._png.channels-1)===0?1:r.data[f+m],g=Math.floor(_*y+(1-_)*n.data[u+m]);n.data[u+m]+=g}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==zR.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===$C.NO_INTERLACE)this._png.data=$R({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===$C.ADAM7)this._png.data=nF({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Xp.NONE,blendOp:HC.SOURCE,data:n}),this._inflator=new GR,this._writingDataChunks=!1}}function CF(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var qR;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(qR||(qR={}));function yF(t,e){return new xF(t,e).decode()}var pn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function zC(){pn.console&&typeof pn.console.log=="function"&&pn.console.log.apply(pn.console,arguments)}var jr={log:zC,warn:function(t){pn.console&&(typeof pn.console.warn=="function"?pn.console.warn.apply(pn.console,arguments):zC.call(null,arguments))},error:function(t){pn.console&&(typeof pn.console.error=="function"?pn.console.error.apply(pn.console,arguments):zC(t))}};function qC(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){qu(r.response,e,n)},r.onerror=function(){jr.error("could not download file")},r.send()}function XR(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Jp(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var qu=pn.saveAs||((typeof window>"u"?"undefined":pr(window))!=="object"||window!==pn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=pn.URL||pn.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?XR(i.href)?qC(t,e,n):Jp(i,i.target="_blank"):Jp(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Jp(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(XR(t))qC(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Jp(r)})}else navigator.msSaveOrOpenBlob((function(i,l){return l===void 0?l={autoBom:!1}:pr(l)!=="object"&&(jr.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return qC(t,e,n);var i=t.type==="application/octet-stream",l=/constructor/i.test(pn.HTMLElement)||pn.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&l)&&(typeof FileReader>"u"?"undefined":pr(FileReader))==="object"){var d=new FileReader;d.onloadend=function(){var m=d.result;m=c?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=m:location=m,r=null},d.readAsDataURL(t)}else{var u=pn.URL||pn.webkitURL,f=u.createObjectURL(t);r?r.location=f:location.href=f,r=null,setTimeout(function(){u.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function DI(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,l=n[r].process,c=i.exec(t);c&&(e=l(c),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var d=this.r.toString(16),u=this.g.toString(16),f=this.b.toString(16);return d.length==1&&(d="0"+d),u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),"#"+d+u+f}}var f_=pn.atob.bind(pn),JR=pn.btoa.bind(pn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function XC(t,e){var n=t[0],r=t[1],i=t[2],l=t[3];n=ba(n,r,i,l,e[0],7,-680876936),l=ba(l,n,r,i,e[1],12,-389564586),i=ba(i,l,n,r,e[2],17,606105819),r=ba(r,i,l,n,e[3],22,-1044525330),n=ba(n,r,i,l,e[4],7,-176418897),l=ba(l,n,r,i,e[5],12,1200080426),i=ba(i,l,n,r,e[6],17,-1473231341),r=ba(r,i,l,n,e[7],22,-45705983),n=ba(n,r,i,l,e[8],7,1770035416),l=ba(l,n,r,i,e[9],12,-1958414417),i=ba(i,l,n,r,e[10],17,-42063),r=ba(r,i,l,n,e[11],22,-1990404162),n=ba(n,r,i,l,e[12],7,1804603682),l=ba(l,n,r,i,e[13],12,-40341101),i=ba(i,l,n,r,e[14],17,-1502002290),n=Na(n,r=ba(r,i,l,n,e[15],22,1236535329),i,l,e[1],5,-165796510),l=Na(l,n,r,i,e[6],9,-1069501632),i=Na(i,l,n,r,e[11],14,643717713),r=Na(r,i,l,n,e[0],20,-373897302),n=Na(n,r,i,l,e[5],5,-701558691),l=Na(l,n,r,i,e[10],9,38016083),i=Na(i,l,n,r,e[15],14,-660478335),r=Na(r,i,l,n,e[4],20,-405537848),n=Na(n,r,i,l,e[9],5,568446438),l=Na(l,n,r,i,e[14],9,-1019803690),i=Na(i,l,n,r,e[3],14,-187363961),r=Na(r,i,l,n,e[8],20,1163531501),n=Na(n,r,i,l,e[13],5,-1444681467),l=Na(l,n,r,i,e[2],9,-51403784),i=Na(i,l,n,r,e[7],14,1735328473),n=Sa(n,r=Na(r,i,l,n,e[12],20,-1926607734),i,l,e[5],4,-378558),l=Sa(l,n,r,i,e[8],11,-2022574463),i=Sa(i,l,n,r,e[11],16,1839030562),r=Sa(r,i,l,n,e[14],23,-35309556),n=Sa(n,r,i,l,e[1],4,-1530992060),l=Sa(l,n,r,i,e[4],11,1272893353),i=Sa(i,l,n,r,e[7],16,-155497632),r=Sa(r,i,l,n,e[10],23,-1094730640),n=Sa(n,r,i,l,e[13],4,681279174),l=Sa(l,n,r,i,e[0],11,-358537222),i=Sa(i,l,n,r,e[3],16,-722521979),r=Sa(r,i,l,n,e[6],23,76029189),n=Sa(n,r,i,l,e[9],4,-640364487),l=Sa(l,n,r,i,e[12],11,-421815835),i=Sa(i,l,n,r,e[15],16,530742520),n=va(n,r=Sa(r,i,l,n,e[2],23,-995338651),i,l,e[0],6,-198630844),l=va(l,n,r,i,e[7],10,1126891415),i=va(i,l,n,r,e[14],15,-1416354905),r=va(r,i,l,n,e[5],21,-57434055),n=va(n,r,i,l,e[12],6,1700485571),l=va(l,n,r,i,e[3],10,-1894986606),i=va(i,l,n,r,e[10],15,-1051523),r=va(r,i,l,n,e[1],21,-2054922799),n=va(n,r,i,l,e[8],6,1873313359),l=va(l,n,r,i,e[15],10,-30611744),i=va(i,l,n,r,e[6],15,-1560198380),r=va(r,i,l,n,e[13],21,1309151649),n=va(n,r,i,l,e[4],6,-145523070),l=va(l,n,r,i,e[11],10,-1120210379),i=va(i,l,n,r,e[2],15,718787259),r=va(r,i,l,n,e[9],21,-343485551),t[0]=mu(n,t[0]),t[1]=mu(r,t[1]),t[2]=mu(i,t[2]),t[3]=mu(l,t[3])}function Ix(t,e,n,r,i,l){return e=mu(mu(e,t),mu(r,l)),mu(e<<i|e>>>32-i,n)}function ba(t,e,n,r,i,l,c){return Ix(e&n|~e&r,t,e,i,l,c)}function Na(t,e,n,r,i,l,c){return Ix(e&r|n&~r,t,e,i,l,c)}function Sa(t,e,n,r,i,l,c){return Ix(e^n^r,t,e,i,l,c)}function va(t,e,n,r,i,l,c){return Ix(n^(e|~r),t,e,i,l,c)}function RI(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)XC(r,bF(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(XC(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,XC(r,i),r}function bF(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var ZR="0123456789abcdef".split("");function NF(t){for(var e="",n=0;n<4;n++)e+=ZR[t>>8*n+4&15]+ZR[t>>8*n&15];return e}function SF(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function sb(t){return RI(t).map(SF).join("")}var vF=(function(t){for(var e=0;e<t.length;e++)t[e]=NF(t[e]);return t.join("")})(RI("hello"))!="5d41402abc4b2a76b9719d911017c592";function mu(t,e){if(vF){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function nb(t,e){var n,r,i,l;if(t!==n){for(var c=(i=t,l=1+(256/t.length|0),new Array(l+1).join(i)),d=[],u=0;u<256;u++)d[u]=u;var f=0;for(u=0;u<256;u++){var m=d[u];f=(f+m+c.charCodeAt(u))%256,d[u]=d[f],d[f]=m}n=t,r=d}else d=r;var _=e.length,y=0,g=0,N="";for(u=0;u<_;u++)g=(g+(m=d[y=(y+1)%256]))%256,d[y]=d[g],d[g]=m,c=d[(d[y]+d[g])%256],N+=String.fromCharCode(e.charCodeAt(u)^c);return N}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var eT={print:4,modify:8,copy:16,"annot-forms":32};function K0(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(d){if(eT.perm!==void 0)throw new Error("Invalid permission: "+d);i+=eT[d]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var l=(e+this.padding).substr(0,32),c=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(l,c),this.P=-(1+(255^i)),this.encryptionKey=sb(l+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=nb(this.encryptionKey,this.padding)}function Q0(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function tT(t){if(pr(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var l=Math.random().toString(35);return e[n][l]=[r,!!i],l},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var l in e[n]){var c=e[n][l];try{c[0].apply(t,r)}catch(d){pn.console&&jr.error("jsPDF PubSub Error",d.message,d)}c[1]&&i.push(l)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function X_(t){if(!(this instanceof X_))return new X_(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function TI(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Ju(t,e,n,r,i){if(!(this instanceof Ju))return new Ju(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,TI.call(this,r,i)}function V0(t,e,n,r,i){if(!(this instanceof V0))return new V0(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,TI.call(this,r,i)}function en(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],l=arguments[3],c=[],d=1,u=16,f="S",m=null;pr(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,l=t.compress||t.compressPdf||l,(m=t.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),d=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),f=t.defaultPathOperation||"S"),c=t.filters||(l===!0?["FlateEncode"]:c),r=r||"mm",n=(""+(n||"P")).toLowerCase();var _=t.putOnlyUsedFonts||!1,y={},g={internal:{},__private__:{}};g.__private__.PubSub=tT;var N="1.3",C=g.__private__.getPdfVersion=function(){return N};g.__private__.setPdfVersion=function(W){N=W};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return v};var R=g.__private__.getPageFormat=function(W){return v[W]};i=i||"a4";var U="compat",L="advanced",w=U;function P(){this.saveGraphicsState(),Z(new Pe(Dt,0,0,-Dt,0,no()*Dt).toString()+" cm"),this.setFontSize(this.getFontSize()/Dt),f="n",w=L}function G(){this.restoreGraphicsState(),f="S",w=U}var K=g.__private__.combineFontStyleAndFontWeight=function(W,Se){if(W=="bold"&&Se=="normal"||W=="bold"&&Se==400||W=="normal"&&Se=="italic"||W=="bold"&&Se=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Se&&(W=Se==400||Se==="normal"?W==="italic"?"italic":"normal":Se!=700&&Se!=="bold"||W!=="normal"?(Se==700?"bold":Se)+""+W:"bold"),W};g.advancedAPI=function(W){var Se=w===U;return Se&&P.call(this),typeof W!="function"||(W(this),Se&&G.call(this)),this},g.compatAPI=function(W){var Se=w===L;return Se&&G.call(this),typeof W!="function"||(W(this),Se&&P.call(this)),this},g.isAdvancedAPI=function(){return w===L};var B,O=function(W){if(w!==L)throw new Error(W+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},S=g.roundToPrecision=g.__private__.roundToPrecision=function(W,Se){var Je=e||Se;if(isNaN(W)||isNaN(Je))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return W.toFixed(Je).replace(/0+$/,"")};B=g.hpf=g.__private__.hpf=typeof u=="number"?function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return S(W,u)}:u==="smart"?function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return S(W,W>-1&&W<1?16:5)}:function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return S(W,16)};var A=g.f2=g.__private__.f2=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.f2");return S(W,2)},Y=g.__private__.f3=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.f3");return S(W,3)},te=g.scale=g.__private__.scale=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.scale");return w===U?W*Dt:w===L?W:void 0},J=function(W){return te((function(Se){return w===U?no()-Se:w===L?Se:void 0})(W))};g.__private__.setPrecision=g.setPrecision=function(W){typeof parseInt(W,10)=="number"&&(e=parseInt(W,10))};var q,V="00000000000000000000000000000000",F=g.__private__.getFileId=function(){return V},I=g.__private__.setFileId=function(W){return V=W!==void 0&&/^[a-fA-F0-9]{32}$/.test(W)?W.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Ps=new K0(m.userPermissions,m.userPassword,m.ownerPassword,V)),V};g.setFileId=function(W){return I(W),this},g.getFileId=function(){return F()};var ee=g.__private__.convertDateToPDFDate=function(W){var Se=W.getTimezoneOffset(),Je=Se<0?"+":"-",xt=Math.floor(Math.abs(Se/60)),Mt=Math.abs(Se%60),rs=[Je,Q(xt),"'",Q(Mt),"'"].join("");return["D:",W.getFullYear(),Q(W.getMonth()+1),Q(W.getDate()),Q(W.getHours()),Q(W.getMinutes()),Q(W.getSeconds()),rs].join("")},ae=g.__private__.convertPDFDateToDate=function(W){var Se=parseInt(W.substr(2,4),10),Je=parseInt(W.substr(6,2),10)-1,xt=parseInt(W.substr(8,2),10),Mt=parseInt(W.substr(10,2),10),rs=parseInt(W.substr(12,2),10),gs=parseInt(W.substr(14,2),10);return new Date(Se,Je,xt,Mt,rs,gs,0)},T=g.__private__.setCreationDate=function(W){var Se;if(W===void 0&&(W=new Date),W instanceof Date)Se=ee(W);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(W))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Se=W}return q=Se},j=g.__private__.getCreationDate=function(W){var Se=q;return W==="jsDate"&&(Se=ae(q)),Se};g.setCreationDate=function(W){return T(W),this},g.getCreationDate=function(W){return j(W)};var k,Q=g.__private__.padd2=function(W){return("0"+parseInt(W)).slice(-2)},H=g.__private__.padd2Hex=function(W){return("00"+(W=W.toString())).substr(W.length)},$=0,ie=[],fe=[],pe=0,de=[],Re=[],X=!1,_e=fe;g.__private__.setCustomOutputDestination=function(W){X=!0,_e=W};var me=function(W){X||(_e=W)};g.__private__.resetCustomOutputDestination=function(){X=!1,_e=fe};var Z=g.__private__.out=function(W){return W=W.toString(),pe+=W.length+1,_e.push(W),_e},le=g.__private__.write=function(W){return Z(arguments.length===1?W.toString():Array.prototype.join.call(arguments," "))},se=g.__private__.getArrayBuffer=function(W){for(var Se=W.length,Je=new ArrayBuffer(Se),xt=new Uint8Array(Je);Se--;)xt[Se]=W.charCodeAt(Se);return Je},Ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return Ee};var Ne=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(W){return Ne=w===L?W/Dt:W,this};var ye,ne=g.__private__.getFontSize=g.getFontSize=function(){return w===U?Ne:Ne*Dt},ue=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(W){return ue=W,this},g.__private__.getR2L=g.getR2L=function(){return ue};var xe,et=g.__private__.setZoomMode=function(W){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(W))ye=W;else if(isNaN(W)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(W)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+W+'" is not recognized.');ye=W}else ye=parseInt(W,10)};g.__private__.getZoomMode=function(){return ye};var bt,it=g.__private__.setPageMode=function(W){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(W)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+W+'" is not recognized.');xe=W};g.__private__.getPageMode=function(){return xe};var At=g.__private__.setLayoutMode=function(W){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(W)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+W+'" is not recognized.');bt=W};g.__private__.getLayoutMode=function(){return bt},g.__private__.setDisplayMode=g.setDisplayMode=function(W,Se,Je){return et(W),At(Se),it(Je),this};var at={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(W){if(Object.keys(at).indexOf(W)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return at[W]},g.__private__.getDocumentProperties=function(){return at},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(W){for(var Se in at)at.hasOwnProperty(Se)&&W[Se]&&(at[Se]=W[Se]);return this},g.__private__.setDocumentProperty=function(W,Se){if(Object.keys(at).indexOf(W)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return at[W]=Se};var We,Dt,Tt,St,ze,dt={},Ke={},rt=[],ft={},Ot={},mt={},Ze={},De=null,Ye=0,Ce=[],ge=new tT(g),Be=t.hotfixes||[],ce={},Le={},Xe=[],Pe=function W(Se,Je,xt,Mt,rs,gs){if(!(this instanceof W))return new W(Se,Je,xt,Mt,rs,gs);isNaN(Se)&&(Se=1),isNaN(Je)&&(Je=0),isNaN(xt)&&(xt=0),isNaN(Mt)&&(Mt=1),isNaN(rs)&&(rs=0),isNaN(gs)&&(gs=0),this._matrix=[Se,Je,xt,Mt,rs,gs]};Object.defineProperty(Pe.prototype,"sx",{get:function(){return this._matrix[0]},set:function(W){this._matrix[0]=W}}),Object.defineProperty(Pe.prototype,"shy",{get:function(){return this._matrix[1]},set:function(W){this._matrix[1]=W}}),Object.defineProperty(Pe.prototype,"shx",{get:function(){return this._matrix[2]},set:function(W){this._matrix[2]=W}}),Object.defineProperty(Pe.prototype,"sy",{get:function(){return this._matrix[3]},set:function(W){this._matrix[3]=W}}),Object.defineProperty(Pe.prototype,"tx",{get:function(){return this._matrix[4]},set:function(W){this._matrix[4]=W}}),Object.defineProperty(Pe.prototype,"ty",{get:function(){return this._matrix[5]},set:function(W){this._matrix[5]=W}}),Object.defineProperty(Pe.prototype,"a",{get:function(){return this._matrix[0]},set:function(W){this._matrix[0]=W}}),Object.defineProperty(Pe.prototype,"b",{get:function(){return this._matrix[1]},set:function(W){this._matrix[1]=W}}),Object.defineProperty(Pe.prototype,"c",{get:function(){return this._matrix[2]},set:function(W){this._matrix[2]=W}}),Object.defineProperty(Pe.prototype,"d",{get:function(){return this._matrix[3]},set:function(W){this._matrix[3]=W}}),Object.defineProperty(Pe.prototype,"e",{get:function(){return this._matrix[4]},set:function(W){this._matrix[4]=W}}),Object.defineProperty(Pe.prototype,"f",{get:function(){return this._matrix[5]},set:function(W){this._matrix[5]=W}}),Object.defineProperty(Pe.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Pe.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Pe.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Pe.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Pe.prototype.join=function(W){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(W)},Pe.prototype.multiply=function(W){var Se=W.sx*this.sx+W.shy*this.shx,Je=W.sx*this.shy+W.shy*this.sy,xt=W.shx*this.sx+W.sy*this.shx,Mt=W.shx*this.shy+W.sy*this.sy,rs=W.tx*this.sx+W.ty*this.shx+this.tx,gs=W.tx*this.shy+W.ty*this.sy+this.ty;return new Pe(Se,Je,xt,Mt,rs,gs)},Pe.prototype.decompose=function(){var W=this.sx,Se=this.shy,Je=this.shx,xt=this.sy,Mt=this.tx,rs=this.ty,gs=Math.sqrt(W*W+Se*Se),Ys=(W/=gs)*Je+(Se/=gs)*xt;Je-=W*Ys,xt-=Se*Ys;var Xs=Math.sqrt(Je*Je+xt*xt);return Ys/=Xs,W*(xt/=Xs)<Se*(Je/=Xs)&&(W=-W,Se=-Se,Ys=-Ys,gs=-gs),{scale:new Pe(gs,0,0,Xs,0,0),translate:new Pe(1,0,0,1,Mt,rs),rotate:new Pe(W,Se,-Se,W,0,0),skew:new Pe(1,0,Ys,1,0,0)}},Pe.prototype.toString=function(W){return this.join(" ")},Pe.prototype.inversed=function(){var W=this.sx,Se=this.shy,Je=this.shx,xt=this.sy,Mt=this.tx,rs=this.ty,gs=1/(W*xt-Se*Je),Ys=xt*gs,Xs=-Se*gs,un=-Je*gs,xn=W*gs;return new Pe(Ys,Xs,un,xn,-Ys*Mt-un*rs,-Xs*Mt-xn*rs)},Pe.prototype.applyToPoint=function(W){var Se=W.x*this.sx+W.y*this.shx+this.tx,Je=W.x*this.shy+W.y*this.sy+this.ty;return new Qn(Se,Je)},Pe.prototype.applyToRectangle=function(W){var Se=this.applyToPoint(W),Je=this.applyToPoint(new Qn(W.x+W.w,W.y+W.h));return new Xr(Se.x,Se.y,Je.x-Se.x,Je.y-Se.y)},Pe.prototype.clone=function(){var W=this.sx,Se=this.shy,Je=this.shx,xt=this.sy,Mt=this.tx,rs=this.ty;return new Pe(W,Se,Je,xt,Mt,rs)},g.Matrix=Pe;var Ct=g.matrixMult=function(W,Se){return Se.multiply(W)},Me=new Pe(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Me;var lt=function(W,Se){if(!Ot[W]){var Je=(Se instanceof Ju?"Sh":"P")+(Object.keys(ft).length+1).toString(10);Se.id=Je,Ot[W]=Je,ft[Je]=Se,ge.publish("addPattern",Se)}};g.ShadingPattern=Ju,g.TilingPattern=V0,g.addShadingPattern=function(W,Se){return O("addShadingPattern()"),lt(W,Se),this},g.beginTilingPattern=function(W){O("beginTilingPattern()"),so(W.boundingBox[0],W.boundingBox[1],W.boundingBox[2]-W.boundingBox[0],W.boundingBox[3]-W.boundingBox[1],W.matrix)},g.endTilingPattern=function(W,Se){O("endTilingPattern()"),Se.stream=Re[k].join(`
`),lt(W,Se),ge.publish("endTilingPattern",Se),Xe.pop().restore()};var ut,jt=g.__private__.newObject=function(){var W=Ve();return $t(W,!0),W},Ve=g.__private__.newObjectDeferred=function(){return $++,ie[$]=function(){return pe},$},$t=function(W,Se){return Se=typeof Se=="boolean"&&Se,ie[W]=pe,Se&&Z(W+" 0 obj"),W},Ue=g.__private__.newAdditionalObject=function(){var W={objId:Ve(),content:""};return de.push(W),W},ss=Ve(),ls=Ve(),ds=g.__private__.decodeColorString=function(W){var Se=W.split(" ");if(Se.length!==2||Se[1]!=="g"&&Se[1]!=="G")Se.length!==5||Se[4]!=="k"&&Se[4]!=="K"||(Se=[(1-Se[0])*(1-Se[3]),(1-Se[1])*(1-Se[3]),(1-Se[2])*(1-Se[3]),"r"]);else{var Je=parseFloat(Se[0]);Se=[Je,Je,Je,"r"]}for(var xt="#",Mt=0;Mt<3;Mt++)xt+=("0"+Math.floor(255*parseFloat(Se[Mt])).toString(16)).slice(-2);return xt},Ss=g.__private__.encodeColorString=function(W){var Se;typeof W=="string"&&(W={ch1:W});var Je=W.ch1,xt=W.ch2,Mt=W.ch3,rs=W.ch4,gs=W.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Je=="string"&&Je.charAt(0)!=="#"){var Ys=new DI(Je);if(Ys.ok)Je=Ys.toHex();else if(!/^\d*\.?\d*$/.test(Je))throw new Error('Invalid color "'+Je+'" passed to jsPDF.encodeColorString.')}if(typeof Je=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Je)&&(Je="#"+Je[1]+Je[1]+Je[2]+Je[2]+Je[3]+Je[3]),typeof Je=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Je)){var Xs=parseInt(Je.substr(1),16);Je=Xs>>16&255,xt=Xs>>8&255,Mt=255&Xs}if(xt===void 0||rs===void 0&&Je===xt&&xt===Mt)Se=typeof Je=="string"?Je+" "+gs[0]:W.precision===2?A(Je/255)+" "+gs[0]:Y(Je/255)+" "+gs[0];else if(rs===void 0||pr(rs)==="object"){if(rs&&!isNaN(rs.a)&&rs.a===0)return["1.","1.","1.",gs[1]].join(" ");Se=typeof Je=="string"?[Je,xt,Mt,gs[1]].join(" "):W.precision===2?[A(Je/255),A(xt/255),A(Mt/255),gs[1]].join(" "):[Y(Je/255),Y(xt/255),Y(Mt/255),gs[1]].join(" ")}else Se=typeof Je=="string"?[Je,xt,Mt,rs,gs[2]].join(" "):W.precision===2?[A(Je),A(xt),A(Mt),A(rs),gs[2]].join(" "):[Y(Je),Y(xt),Y(Mt),Y(rs),gs[2]].join(" ");return Se},Ns=g.__private__.getFilters=function(){return c},ke=g.__private__.putStream=function(W){var Se=(W=W||{}).data||"",Je=W.filters||Ns(),xt=W.alreadyAppliedFilters||[],Mt=W.addLength1||!1,rs=Se.length,gs=W.objectId,Ys=function(mi){return mi};if(m!==null&&gs===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Ys=Ps.encryptor(gs,0));var Xs={};Je===!0&&(Je=["FlateEncode"]);var un=W.additionalKeyValues||[],xn=(Xs=en.API.processDataByFilters!==void 0?en.API.processDataByFilters(Se,Je):{data:Se,reverseChain:[]}).reverseChain+(Array.isArray(xt)?xt.join(" "):xt.toString());if(Xs.data.length!==0&&(un.push({key:"Length",value:Xs.data.length}),Mt===!0&&un.push({key:"Length1",value:rs})),xn.length!=0)if(xn.split("/").length-1==1)un.push({key:"Filter",value:xn});else{un.push({key:"Filter",value:"["+xn+"]"});for(var Bn=0;Bn<un.length;Bn+=1)if(un[Bn].key==="DecodeParms"){for(var wr=[],Jr=0;Jr<Xs.reverseChain.split("/").length-1;Jr+=1)wr.push("null");wr.push(un[Bn].value),un[Bn].value="["+wr.join(" ")+"]"}}Z("<<");for(var xr=0;xr<un.length;xr++)Z("/"+un[xr].key+" "+un[xr].value);Z(">>"),Xs.data.length!==0&&(Z("stream"),Z(Ys(Xs.data)),Z("endstream"))},ct=g.__private__.putPage=function(W){var Se=W.number,Je=W.data,xt=W.objId,Mt=W.contentsObjId;$t(xt,!0),Z("<</Type /Page"),Z("/Parent "+W.rootDictionaryObjId+" 0 R"),Z("/Resources "+W.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(B(W.mediaBox.bottomLeftX))+" "+parseFloat(B(W.mediaBox.bottomLeftY))+" "+B(W.mediaBox.topRightX)+" "+B(W.mediaBox.topRightY)+"]"),W.cropBox!==null&&Z("/CropBox ["+B(W.cropBox.bottomLeftX)+" "+B(W.cropBox.bottomLeftY)+" "+B(W.cropBox.topRightX)+" "+B(W.cropBox.topRightY)+"]"),W.bleedBox!==null&&Z("/BleedBox ["+B(W.bleedBox.bottomLeftX)+" "+B(W.bleedBox.bottomLeftY)+" "+B(W.bleedBox.topRightX)+" "+B(W.bleedBox.topRightY)+"]"),W.trimBox!==null&&Z("/TrimBox ["+B(W.trimBox.bottomLeftX)+" "+B(W.trimBox.bottomLeftY)+" "+B(W.trimBox.topRightX)+" "+B(W.trimBox.topRightY)+"]"),W.artBox!==null&&Z("/ArtBox ["+B(W.artBox.bottomLeftX)+" "+B(W.artBox.bottomLeftY)+" "+B(W.artBox.topRightX)+" "+B(W.artBox.topRightY)+"]"),typeof W.userUnit=="number"&&W.userUnit!==1&&Z("/UserUnit "+W.userUnit),ge.publish("putPage",{objId:xt,pageContext:Ce[Se],pageNumber:Se,page:Je}),Z("/Contents "+Mt+" 0 R"),Z(">>"),Z("endobj");var rs=Je.join(`
`);return w===L&&(rs+=`
Q`),$t(Mt,!0),ke({data:rs,filters:Ns(),objectId:Mt}),Z("endobj"),xt},st=g.__private__.putPages=function(){var W,Se,Je=[];for(W=1;W<=Ye;W++)Ce[W].objId=Ve(),Ce[W].contentsObjId=Ve();for(W=1;W<=Ye;W++)Je.push(ct({number:W,data:Re[W],objId:Ce[W].objId,contentsObjId:Ce[W].contentsObjId,mediaBox:Ce[W].mediaBox,cropBox:Ce[W].cropBox,bleedBox:Ce[W].bleedBox,trimBox:Ce[W].trimBox,artBox:Ce[W].artBox,userUnit:Ce[W].userUnit,rootDictionaryObjId:ss,resourceDictionaryObjId:ls}));$t(ss,!0),Z("<</Type /Pages");var xt="/Kids [";for(Se=0;Se<Ye;Se++)xt+=Je[Se]+" 0 R ";Z(xt+"]"),Z("/Count "+Ye),Z(">>"),Z("endobj"),ge.publish("postPutPages")},Kt=function(W){ge.publish("putFont",{font:W,out:Z,newObject:jt,putStream:ke}),W.isAlreadyPutted!==!0&&(W.objectNumber=jt(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Q0(W.postScriptName)),Z("/Subtype /Type1"),typeof W.encoding=="string"&&Z("/Encoding /"+W.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},ht=function(W){W.objectNumber=jt();var Se=[];Se.push({key:"Type",value:"/XObject"}),Se.push({key:"Subtype",value:"/Form"}),Se.push({key:"BBox",value:"["+[B(W.x),B(W.y),B(W.x+W.width),B(W.y+W.height)].join(" ")+"]"}),Se.push({key:"Matrix",value:"["+W.matrix.toString()+"]"});var Je=W.pages[1].join(`
`);ke({data:Je,additionalKeyValues:Se,objectId:W.objectNumber}),Z("endobj")},qt=function(W,Se){Se||(Se=21);var Je=jt(),xt=(function(gs,Ys){var Xs,un=[],xn=1/(Ys-1);for(Xs=0;Xs<1;Xs+=xn)un.push(Xs);if(un.push(1),gs[0].offset!=0){var Bn={offset:0,color:gs[0].color};gs.unshift(Bn)}if(gs[gs.length-1].offset!=1){var wr={offset:1,color:gs[gs.length-1].color};gs.push(wr)}for(var Jr="",xr=0,mi=0;mi<un.length;mi++){for(Xs=un[mi];Xs>gs[xr+1].offset;)xr++;var ri=gs[xr].offset,Mi=(Xs-ri)/(gs[xr+1].offset-ri),ro=gs[xr].color,gl=gs[xr+1].color;Jr+=H(Math.round((1-Mi)*ro[0]+Mi*gl[0]).toString(16))+H(Math.round((1-Mi)*ro[1]+Mi*gl[1]).toString(16))+H(Math.round((1-Mi)*ro[2]+Mi*gl[2]).toString(16))}return Jr.trim()})(W.colors,Se),Mt=[];Mt.push({key:"FunctionType",value:"0"}),Mt.push({key:"Domain",value:"[0.0 1.0]"}),Mt.push({key:"Size",value:"["+Se+"]"}),Mt.push({key:"BitsPerSample",value:"8"}),Mt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Mt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ke({data:xt,additionalKeyValues:Mt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Je}),Z("endobj"),W.objectNumber=jt(),Z("<< /ShadingType "+W.type),Z("/ColorSpace /DeviceRGB");var rs="/Coords ["+B(parseFloat(W.coords[0]))+" "+B(parseFloat(W.coords[1]))+" ";W.type===2?rs+=B(parseFloat(W.coords[2]))+" "+B(parseFloat(W.coords[3])):rs+=B(parseFloat(W.coords[2]))+" "+B(parseFloat(W.coords[3]))+" "+B(parseFloat(W.coords[4]))+" "+B(parseFloat(W.coords[5])),Z(rs+="]"),W.matrix&&Z("/Matrix ["+W.matrix.toString()+"]"),Z("/Function "+Je+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},It=function(W,Se){var Je=Ve(),xt=jt();Se.push({resourcesOid:Je,objectOid:xt}),W.objectNumber=xt;var Mt=[];Mt.push({key:"Type",value:"/Pattern"}),Mt.push({key:"PatternType",value:"1"}),Mt.push({key:"PaintType",value:"1"}),Mt.push({key:"TilingType",value:"1"}),Mt.push({key:"BBox",value:"["+W.boundingBox.map(B).join(" ")+"]"}),Mt.push({key:"XStep",value:B(W.xStep)}),Mt.push({key:"YStep",value:B(W.yStep)}),Mt.push({key:"Resources",value:Je+" 0 R"}),W.matrix&&Mt.push({key:"Matrix",value:"["+W.matrix.toString()+"]"}),ke({data:W.stream,additionalKeyValues:Mt,objectId:W.objectNumber}),Z("endobj")},he=function(W){for(var Se in W.objectNumber=jt(),Z("<<"),W)switch(Se){case"opacity":Z("/ca "+A(W[Se]));break;case"stroke-opacity":Z("/CA "+A(W[Se]))}Z(">>"),Z("endobj")},be=function(W){$t(W.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Se in Z("/Font <<"),dt)dt.hasOwnProperty(Se)&&(_===!1||_===!0&&y.hasOwnProperty(Se))&&Z("/"+Se+" "+dt[Se].objectNumber+" 0 R");Z(">>")})(),(function(){if(Object.keys(ft).length>0){for(var Se in Z("/Shading <<"),ft)ft.hasOwnProperty(Se)&&ft[Se]instanceof Ju&&ft[Se].objectNumber>=0&&Z("/"+Se+" "+ft[Se].objectNumber+" 0 R");ge.publish("putShadingPatternDict"),Z(">>")}})(),(function(Se){if(Object.keys(ft).length>0){for(var Je in Z("/Pattern <<"),ft)ft.hasOwnProperty(Je)&&ft[Je]instanceof g.TilingPattern&&ft[Je].objectNumber>=0&&ft[Je].objectNumber<Se&&Z("/"+Je+" "+ft[Je].objectNumber+" 0 R");ge.publish("putTilingPatternDict"),Z(">>")}})(W.objectOid),(function(){if(Object.keys(mt).length>0){var Se;for(Se in Z("/ExtGState <<"),mt)mt.hasOwnProperty(Se)&&mt[Se].objectNumber>=0&&Z("/"+Se+" "+mt[Se].objectNumber+" 0 R");ge.publish("putGStateDict"),Z(">>")}})(),(function(){for(var Se in Z("/XObject <<"),ce)ce.hasOwnProperty(Se)&&ce[Se].objectNumber>=0&&Z("/"+Se+" "+ce[Se].objectNumber+" 0 R");ge.publish("putXobjectDict"),Z(">>")})(),Z(">>"),Z("endobj")},Oe=function(W){Ke[W.fontName]=Ke[W.fontName]||{},Ke[W.fontName][W.fontStyle]=W.id},je=function(W,Se,Je,xt,Mt){var rs={id:"F"+(Object.keys(dt).length+1).toString(10),postScriptName:W,fontName:Se,fontStyle:Je,encoding:xt,isStandardFont:Mt||!1,metadata:{}};return ge.publish("addFont",{font:rs,instance:this}),dt[rs.id]=rs,Oe(rs),rs.id},tt=g.__private__.pdfEscape=g.pdfEscape=function(W,Se){return(function(Je,xt){var Mt,rs,gs,Ys,Xs,un,xn,Bn,wr;if(gs=(xt=xt||{}).sourceEncoding||"Unicode",Xs=xt.outputEncoding,(xt.autoencode||Xs)&&dt[We].metadata&&dt[We].metadata[gs]&&dt[We].metadata[gs].encoding&&(Ys=dt[We].metadata[gs].encoding,!Xs&&dt[We].encoding&&(Xs=dt[We].encoding),!Xs&&Ys.codePages&&(Xs=Ys.codePages[0]),typeof Xs=="string"&&(Xs=Ys[Xs]),Xs)){for(xn=!1,un=[],Mt=0,rs=Je.length;Mt<rs;Mt++)(Bn=Xs[Je.charCodeAt(Mt)])?un.push(String.fromCharCode(Bn)):un.push(Je[Mt]),un[Mt].charCodeAt(0)>>8&&(xn=!0);Je=un.join("")}for(Mt=Je.length;xn===void 0&&Mt!==0;)Je.charCodeAt(Mt-1)>>8&&(xn=!0),Mt--;if(!xn)return Je;for(un=xt.noBOM?[]:[254,255],Mt=0,rs=Je.length;Mt<rs;Mt++){if((wr=(Bn=Je.charCodeAt(Mt))>>8)>>8)throw new Error("Character at position "+Mt+" of string '"+Je+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");un.push(wr),un.push(Bn-(wr<<8))}return String.fromCharCode.apply(void 0,un)})(W,Se).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Te=g.__private__.beginPage=function(W){Re[++Ye]=[],Ce[Ye]={objId:0,contentsObjId:0,userUnit:Number(d),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(W[0]),topRightY:Number(W[1])}},yt(Ye),me(Re[k])},_t=function(W,Se){var Je,xt,Mt;switch(n=Se||n,typeof W=="string"&&(Je=R(W.toLowerCase()),Array.isArray(Je)&&(xt=Je[0],Mt=Je[1])),Array.isArray(W)&&(xt=W[0]*Dt,Mt=W[1]*Dt),isNaN(xt)&&(xt=i[0],Mt=i[1]),(xt>14400||Mt>14400)&&(jr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),xt=Math.min(14400,xt),Mt=Math.min(14400,Mt)),i=[xt,Mt],n.substr(0,1)){case"l":Mt>xt&&(i=[Mt,xt]);break;case"p":xt>Mt&&(i=[Mt,xt])}Te(i),_s(Qs),Z(Fr),Fa!==0&&Z(Fa+" J"),Rs!==0&&Z(Rs+" j"),ge.publish("addPage",{pageNumber:Ye})},Qe=function(W){W>0&&W<=Ye&&(Re.splice(W,1),Ce.splice(W,1),Ye--,k>Ye&&(k=Ye),this.setPage(k))},yt=function(W){W>0&&W<=Ye&&(k=W)},vt=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Re.length-1},$e=function(W,Se,Je){var xt,Mt=void 0;return Je=Je||{},W=W!==void 0?W:dt[We].fontName,Se=Se!==void 0?Se:dt[We].fontStyle,xt=W.toLowerCase(),Ke[xt]!==void 0&&Ke[xt][Se]!==void 0?Mt=Ke[xt][Se]:Ke[W]!==void 0&&Ke[W][Se]!==void 0?Mt=Ke[W][Se]:Je.disableWarning===!1&&jr.warn("Unable to look up font label for font '"+W+"', '"+Se+"'. Refer to getFontList() for available fonts."),Mt||Je.noFallback||(Mt=Ke.times[Se])==null&&(Mt=Ke.times.normal),Mt},ot=g.__private__.putInfo=function(){var W=jt(),Se=function(xt){return xt};for(var Je in m!==null&&(Se=Ps.encryptor(W,0)),Z("<<"),Z("/Producer ("+tt(Se("jsPDF "+en.version))+")"),at)at.hasOwnProperty(Je)&&at[Je]&&Z("/"+Je.substr(0,1).toUpperCase()+Je.substr(1)+" ("+tt(Se(at[Je]))+")");Z("/CreationDate ("+tt(Se(q))+")"),Z(">>"),Z("endobj")},wt=g.__private__.putCatalog=function(W){var Se=(W=W||{}).rootDictionaryObjId||ss;switch(jt(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+Se+" 0 R"),ye||(ye="fullwidth"),ye){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Je=""+ye;Je.substr(Je.length-1)==="%"&&(ye=parseInt(ye)/100),typeof ye=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+A(ye)+"]")}switch(bt||(bt="continuous"),bt){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}xe&&Z("/PageMode /"+xe),ge.publish("putCatalog"),Z(">>"),Z("endobj")},Bt=g.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+($+1)),Z("/Root "+$+" 0 R"),Z("/Info "+($-1)+" 0 R"),m!==null&&Z("/Encrypt "+Ps.oid+" 0 R"),Z("/ID [ <"+V+"> <"+V+"> ]"),Z(">>")},Yt=g.__private__.putHeader=function(){Z("%PDF-"+N),Z("%")},Xt=g.__private__.putXRef=function(){var W="0000000000";Z("xref"),Z("0 "+($+1)),Z("0000000000 65535 f ");for(var Se=1;Se<=$;Se++)typeof ie[Se]=="function"?Z((W+ie[Se]()).slice(-10)+" 00000 n "):ie[Se]!==void 0?Z((W+ie[Se]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},ts=g.__private__.buildDocument=function(){var W;$=0,pe=0,fe=[],ie=[],de=[],ss=Ve(),ls=Ve(),me(fe),ge.publish("buildDocument"),Yt(),st(),(function(){ge.publish("putAdditionalObjects");for(var Je=0;Je<de.length;Je++){var xt=de[Je];$t(xt.objId,!0),Z(xt.content),Z("endobj")}ge.publish("postPutAdditionalObjects")})(),W=[],(function(){for(var Je in dt)dt.hasOwnProperty(Je)&&(_===!1||_===!0&&y.hasOwnProperty(Je))&&Kt(dt[Je])})(),(function(){var Je;for(Je in mt)mt.hasOwnProperty(Je)&&he(mt[Je])})(),(function(){for(var Je in ce)ce.hasOwnProperty(Je)&&ht(ce[Je])})(),(function(Je){var xt;for(xt in ft)ft.hasOwnProperty(xt)&&(ft[xt]instanceof Ju?qt(ft[xt]):ft[xt]instanceof V0&&It(ft[xt],Je))})(W),ge.publish("putResources"),W.forEach(be),be({resourcesOid:ls,objectOid:Number.MAX_SAFE_INTEGER}),ge.publish("postPutResources"),m!==null&&(Ps.oid=jt(),Z("<<"),Z("/Filter /Standard"),Z("/V "+Ps.v),Z("/R "+Ps.r),Z("/U <"+Ps.toHexString(Ps.U)+">"),Z("/O <"+Ps.toHexString(Ps.O)+">"),Z("/P "+Ps.P),Z(">>"),Z("endobj")),ot(),wt();var Se=pe;return Xt(),Bt(),Z("startxref"),Z(""+Se),Z("%%EOF"),me(Re[k]),fe.join(`
`)},Ut=g.__private__.getBlob=function(W){return new Blob([se(W)],{type:"application/pdf"})},Es=g.output=g.__private__.output=(ut=function(W,Se){switch(typeof(Se=Se||{})=="string"?Se={filename:Se}:Se.filename=Se.filename||"generated.pdf",W){case void 0:return ts();case"save":g.save(Se.filename);break;case"arraybuffer":return se(ts());case"blob":return Ut(ts());case"bloburi":case"bloburl":if(pn.URL!==void 0&&typeof pn.URL.createObjectURL=="function")return pn.URL&&pn.URL.createObjectURL(Ut(ts()))||void 0;jr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Je="",xt=ts();try{Je=JR(xt)}catch{Je=JR(unescape(encodeURIComponent(xt)))}return"data:application/pdf;filename="+Se.filename+";base64,"+Je;case"pdfobjectnewwindow":if(Object.prototype.toString.call(pn)==="[object Window]"){var Mt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",rs=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Se.pdfObjectUrl&&(Mt=Se.pdfObjectUrl,rs="");var gs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Mt+'"'+rs+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Se)+");<\/script></body></html>",Ys=pn.open();return Ys!==null&&Ys.document.write(gs),Ys}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(pn)==="[object Window]"){var Xs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Se.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Se.filename+'" width="500px" height="400px" /></body></html>',un=pn.open();if(un!==null){un.document.write(Xs);var xn=this;un.document.documentElement.querySelector("#pdfViewer").onload=function(){un.document.title=Se.filename,un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(xn.output("bloburl"))}}return un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(pn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Bn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Se)+'"></iframe></body></html>',wr=pn.open();if(wr!==null&&(wr.document.write(Bn),wr.document.title=Se.filename),wr||typeof safari>"u")return wr;break;case"datauri":case"dataurl":return pn.document.location.href=this.output("datauristring",Se);default:return null}},ut.foo=function(){try{return ut.apply(this,arguments)}catch(Je){var W=Je.stack||"";~W.indexOf(" at ")&&(W=W.split(" at ")[1]);var Se="Error in function "+W.split(`
`)[0].split("<")[0]+": "+Je.message;if(!pn.console)throw new Error(Se);pn.console.error(Se,Je),pn.alert&&alert(Se)}},ut.foo.bar=ut,ut.foo),ys=function(W){return Array.isArray(Be)===!0&&Be.indexOf(W)>-1};switch(r){case"pt":Dt=1;break;case"mm":Dt=72/25.4;break;case"cm":Dt=72/2.54;break;case"in":Dt=72;break;case"px":Dt=ys("px_scaling")==1?.75:96/72;break;case"pc":case"em":Dt=12;break;case"ex":Dt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Dt=r}var Ps=null;T(),I();var ps=g.__private__.getPageInfo=g.getPageInfo=function(W){if(isNaN(W)||W%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ce[W].objId,pageNumber:W,pageContext:Ce[W]}},vs=g.__private__.getPageInfoByObjId=function(W){if(isNaN(W)||W%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Se in Ce)if(Ce[Se].objId===W)break;return ps(Se)},Ms=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Ce[k].objId,pageNumber:k,pageContext:Ce[k]}};g.addPage=function(){return _t.apply(this,arguments),this},g.setPage=function(){return yt.apply(this,arguments),me.call(this,Re[k]),this},g.insertPage=function(W){return this.addPage(),this.movePage(k,W),this},g.movePage=function(W,Se){var Je,xt;if(W>Se){Je=Re[W],xt=Ce[W];for(var Mt=W;Mt>Se;Mt--)Re[Mt]=Re[Mt-1],Ce[Mt]=Ce[Mt-1];Re[Se]=Je,Ce[Se]=xt,this.setPage(Se)}else if(W<Se){Je=Re[W],xt=Ce[W];for(var rs=W;rs<Se;rs++)Re[rs]=Re[rs+1],Ce[rs]=Ce[rs+1];Re[Se]=Je,Ce[Se]=xt,this.setPage(Se)}return this},g.deletePage=function(){return Qe.apply(this,arguments),this},g.__private__.text=g.text=function(W,Se,Je,xt,Mt){var rs,gs,Ys,Xs,un,xn,Bn,wr,Jr,xr=(xt=xt||{}).scope||this;if(typeof W=="number"&&typeof Se=="number"&&(typeof Je=="string"||Array.isArray(Je))){var mi=Je;Je=Se,Se=W,W=mi}if(arguments[3]instanceof Pe==0?(Ys=arguments[4],Xs=arguments[5],pr(Bn=arguments[3])==="object"&&Bn!==null||(typeof Ys=="string"&&(Xs=Ys,Ys=null),typeof Bn=="string"&&(Xs=Bn,Bn=null),typeof Bn=="number"&&(Ys=Bn,Bn=null),xt={flags:Bn,angle:Ys,align:Xs})):(O("The transform parameter of text() with a Matrix value"),Jr=Mt),isNaN(Se)||isNaN(Je)||W==null)throw new Error("Invalid arguments passed to jsPDF.text");if(W.length===0)return xr;var ri,Mi="",ro=typeof xt.lineHeightFactor=="number"?xt.lineHeightFactor:Us,gl=xr.internal.scaleFactor;function io(zn){return zn=zn.split("	").join(Array(xt.TabLen||9).join(" ")),tt(zn,Bn)}function Ru(zn){for(var Wn,Cr=zn.concat(),ei=[],Ll=Cr.length;Ll--;)typeof(Wn=Cr.shift())=="string"?ei.push(Wn):Array.isArray(zn)&&(Wn.length===1||Wn[1]===void 0&&Wn[2]===void 0)?ei.push(Wn[0]):ei.push([Wn[0],Wn[1],Wn[2]]);return ei}function ud(zn,Wn){var Cr;if(typeof zn=="string")Cr=Wn(zn)[0];else if(Array.isArray(zn)){for(var ei,Ll,Cl=zn.concat(),Cc=[],ju=Cl.length;ju--;)typeof(ei=Cl.shift())=="string"?Cc.push(Wn(ei)[0]):Array.isArray(ei)&&typeof ei[0]=="string"&&(Ll=Wn(ei[0],ei[1],ei[2]),Cc.push([Ll[0],Ll[1],Ll[2]]));Cr=Cc}return Cr}var Rl=!1,pl=!0;if(typeof W=="string")Rl=!0;else if(Array.isArray(W)){var _c=W.concat();gs=[];for(var ao,vi=_c.length;vi--;)(typeof(ao=_c.shift())!="string"||Array.isArray(ao)&&typeof ao[0]!="string")&&(pl=!1);Rl=pl}if(Rl===!1)throw new Error('Type of text must be string or Array. "'+W+'" is not recognized.');typeof W=="string"&&(W=W.match(/[\r?\n]/)?W.split(/\r\n|\r|\n/g):[W]);var Ao=Ne/xr.internal.scaleFactor,ko=Ao*(ro-1);switch(xt.baseline){case"bottom":Je-=ko;break;case"top":Je+=Ao-ko;break;case"hanging":Je+=Ao-2*ko;break;case"middle":Je+=Ao/2-ko}if((xn=xt.maxWidth||0)>0&&(typeof W=="string"?W=xr.splitTextToSize(W,xn):Object.prototype.toString.call(W)==="[object Array]"&&(W=W.reduce(function(zn,Wn){return zn.concat(xr.splitTextToSize(Wn,xn))},[]))),rs={text:W,x:Se,y:Je,options:xt,mutex:{pdfEscape:tt,activeFontKey:We,fonts:dt,activeFontSize:Ne}},ge.publish("preProcessText",rs),W=rs.text,Ys=(xt=rs.options).angle,Jr instanceof Pe==0&&Ys&&typeof Ys=="number"){Ys*=Math.PI/180,xt.rotationDirection===0&&(Ys=-Ys),w===L&&(Ys=-Ys);var hd=Math.cos(Ys),Tl=Math.sin(Ys);Jr=new Pe(hd,Tl,-Tl,hd,0,0)}else Ys&&Ys instanceof Pe&&(Jr=Ys);w!==L||Jr||(Jr=Me),(un=xt.charSpace||Dr)!==void 0&&(Mi+=B(te(un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(wr=xt.horizontalScale)!==void 0&&(Mi+=B(100*wr)+` Tz
`),xt.lang;var ca=-1,lo=xt.renderingMode!==void 0?xt.renderingMode:xt.stroke,fd=xr.internal.getCurrentPageInfo().pageContext;switch(lo){case 0:case!1:case"fill":ca=0;break;case 1:case!0:case"stroke":ca=1;break;case 2:case"fillThenStroke":ca=2;break;case 3:case"invisible":ca=3;break;case 4:case"fillAndAddForClipping":ca=4;break;case 5:case"strokeAndAddPathForClipping":ca=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ca=6;break;case 7:case"addToPathForClipping":ca=7}var Tu=fd.usedRenderingMode!==void 0?fd.usedRenderingMode:-1;ca!==-1?Mi+=ca+` Tr
`:Tu!==-1&&(Mi+=`0 Tr
`),ca!==-1&&(fd.usedRenderingMode=ca),Xs=xt.align||"left";var Ea,_l=Ne*ro,oo=xr.internal.pageSize.getWidth(),Eu=dt[We];un=xt.charSpace||Dr,xn=xt.maxWidth||0,Bn=Object.assign({autoencode:!0,noBOM:!0},xt.flags);var xl=[],Uo=function(zn){return xr.getStringUnitWidth(zn,{font:Eu,charSpace:un,fontSize:Ne,doKerning:!1})*Ne/gl};if(Object.prototype.toString.call(W)==="[object Array]"){var xa;gs=Ru(W),Xs!=="left"&&(Ea=gs.map(Uo));var da,El=0;if(Xs==="right"){Se-=Ea[0],W=[],vi=gs.length;for(var jl=0;jl<vi;jl++)jl===0?(da=vr(Se),xa=cn(Je)):(da=te(El-Ea[jl]),xa=-_l),W.push([gs[jl],da,xa]),El=Ea[jl]}else if(Xs==="center"){Se-=Ea[0]/2,W=[],vi=gs.length;for(var co=0;co<vi;co++)co===0?(da=vr(Se),xa=cn(Je)):(da=te((El-Ea[co])/2),xa=-_l),W.push([gs[co],da,xa]),El=Ea[co]}else if(Xs==="left"){W=[],vi=gs.length;for(var md=0;md<vi;md++)W.push(gs[md])}else if(Xs==="justify"&&Eu.encoding==="Identity-H"){W=[],vi=gs.length,xn=xn!==0?xn:oo;for(var gd=0,Zr=0;Zr<vi;Zr++)if(xa=Zr===0?cn(Je):-_l,da=Zr===0?vr(Se):gd,Zr<vi-1){var Kh=te((xn-Ea[Zr])/(gs[Zr].split(" ").length-1)),Il=gs[Zr].split(" ");W.push([Il[0]+" ",da,xa]),gd=0;for(var Ol=1;Ol<Il.length;Ol++){var Li=(Uo(Il[Ol-1]+" "+Il[Ol])-Uo(Il[Ol]))*gl+Kh;Ol==Il.length-1?W.push([Il[Ol],Li,0]):W.push([Il[Ol]+" ",Li,0]),gd-=Li}}else W.push([gs[Zr],da,xa]);W.push(["",gd,0])}else{if(Xs!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(W=[],vi=gs.length,xn=xn!==0?xn:oo,Zr=0;Zr<vi;Zr++){xa=Zr===0?cn(Je):-_l,da=Zr===0?vr(Se):0;var uo=gs[Zr].split(" ").length-1,pd=uo>0?(xn-Ea[Zr])/uo:0;Zr<vi-1?xl.push(B(te(pd))):xl.push(0),W.push([gs[Zr],da,xa])}}}(typeof xt.R2L=="boolean"?xt.R2L:ue)===!0&&(W=ud(W,function(zn,Wn,Cr){return[zn.split("").reverse().join(""),Wn,Cr]})),rs={text:W,x:Se,y:Je,options:xt,mutex:{pdfEscape:tt,activeFontKey:We,fonts:dt,activeFontSize:Ne}},ge.publish("postProcessText",rs),W=rs.text,ri=rs.mutex.isHex||!1;var _d=dt[We].encoding;_d!=="WinAnsiEncoding"&&_d!=="StandardEncoding"||(W=ud(W,function(zn,Wn,Cr){return[io(zn),Wn,Cr]})),gs=Ru(W),W=[];for(var ho,fo,Ml,xc=Array.isArray(gs[0])?1:0,ja="",mo=function(zn,Wn,Cr){var ei="";return Cr instanceof Pe?(Cr=typeof xt.angle=="number"?Ct(Cr,new Pe(1,0,0,1,zn,Wn)):Ct(new Pe(1,0,0,1,zn,Wn),Cr),w===L&&(Cr=Ct(new Pe(1,0,0,-1,0,0),Cr)),ei=Cr.join(" ")+` Tm
`):ei=B(zn)+" "+B(Wn)+` Td
`,ei},qi=0;qi<gs.length;qi++){switch(ja="",xc){case 1:Ml=(ri?"<":"(")+gs[qi][0]+(ri?">":")"),ho=parseFloat(gs[qi][1]),fo=parseFloat(gs[qi][2]);break;case 0:Ml=(ri?"<":"(")+gs[qi]+(ri?">":")"),ho=vr(Se),fo=cn(Je)}xl!==void 0&&xl[qi]!==void 0&&(ja=xl[qi]+` Tw
`),qi===0?W.push(ja+mo(ho,fo,Jr)+Ml):xc===0?W.push(ja+Ml):xc===1&&W.push(ja+mo(ho,fo,Jr)+Ml)}W=xc===0?W.join(` Tj
T* `):W.join(` Tj
`),W+=` Tj
`;var Ka=`BT
/`;return Ka+=We+" "+Ne+` Tf
`,Ka+=B(Ne*ro)+` TL
`,Ka+=Or+`
`,Ka+=Mi,Ka+=W,Z(Ka+="ET"),y[We]=!0,xr};var cs=g.__private__.clip=g.clip=function(W){return Z(W==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return cs("evenodd")},g.__private__.discardPath=g.discardPath=function(){return Z("n"),this};var ms=g.__private__.isValidStyle=function(W){var Se=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(W)!==-1&&(Se=!0),Se};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(W){return ms(W)&&(f=W),this};var Ks=g.__private__.getStyle=g.getStyle=function(W){var Se=f;switch(W){case"D":case"S":Se="S";break;case"F":Se="f";break;case"FD":case"DF":Se="B";break;case"f":case"f*":case"B":case"B*":Se=W}return Se},Ls=g.close=function(){return Z("h"),this};g.stroke=function(){return Z("S"),this},g.fill=function(W){return nt("f",W),this},g.fillEvenOdd=function(W){return nt("f*",W),this},g.fillStroke=function(W){return nt("B",W),this},g.fillStrokeEvenOdd=function(W){return nt("B*",W),this};var nt=function(W,Se){pr(Se)==="object"?Ht(Se,W):Z(W)},Ft=function(W){W===null||w===L&&W===void 0||(W=Ks(W),Z(W))};function Cs(W,Se,Je,xt,Mt){var rs=new V0(Se||this.boundingBox,Je||this.xStep,xt||this.yStep,this.gState,Mt||this.matrix);rs.stream=this.stream;var gs=W+"$$"+this.cloneIndex+++"$$";return lt(gs,rs),rs}var Ht=function(W,Se){var Je=Ot[W.key],xt=ft[Je];if(xt instanceof Ju)Z("q"),Z(Os(Se)),xt.gState&&g.setGState(xt.gState),Z(W.matrix.toString()+" cm"),Z("/"+Je+" sh"),Z("Q");else if(xt instanceof V0){var Mt=new Pe(1,0,0,-1,0,no());W.matrix&&(Mt=Mt.multiply(W.matrix||Me),Je=Cs.call(xt,W.key,W.boundingBox,W.xStep,W.yStep,Mt).id),Z("q"),Z("/Pattern cs"),Z("/"+Je+" scn"),xt.gState&&g.setGState(xt.gState),Z(Se),Z("Q")}},Os=function(W){switch(W){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Zt=g.moveTo=function(W,Se){return Z(B(te(W))+" "+B(J(Se))+" m"),this},Ds=g.lineTo=function(W,Se){return Z(B(te(W))+" "+B(J(Se))+" l"),this},js=g.curveTo=function(W,Se,Je,xt,Mt,rs){return Z([B(te(W)),B(J(Se)),B(te(Je)),B(J(xt)),B(te(Mt)),B(J(rs)),"c"].join(" ")),this};g.__private__.line=g.line=function(W,Se,Je,xt,Mt){if(isNaN(W)||isNaN(Se)||isNaN(Je)||isNaN(xt)||!ms(Mt))throw new Error("Invalid arguments passed to jsPDF.line");return w===U?this.lines([[Je-W,xt-Se]],W,Se,[1,1],Mt||"S"):this.lines([[Je-W,xt-Se]],W,Se,[1,1]).stroke()},g.__private__.lines=g.lines=function(W,Se,Je,xt,Mt,rs){var gs,Ys,Xs,un,xn,Bn,wr,Jr,xr,mi,ri,Mi;if(typeof W=="number"&&(Mi=Je,Je=Se,Se=W,W=Mi),xt=xt||[1,1],rs=rs||!1,isNaN(Se)||isNaN(Je)||!Array.isArray(W)||!Array.isArray(xt)||!ms(Mt)||typeof rs!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Zt(Se,Je),gs=xt[0],Ys=xt[1],un=W.length,mi=Se,ri=Je,Xs=0;Xs<un;Xs++)(xn=W[Xs]).length===2?(mi=xn[0]*gs+mi,ri=xn[1]*Ys+ri,Ds(mi,ri)):(Bn=xn[0]*gs+mi,wr=xn[1]*Ys+ri,Jr=xn[2]*gs+mi,xr=xn[3]*Ys+ri,mi=xn[4]*gs+mi,ri=xn[5]*Ys+ri,js(Bn,wr,Jr,xr,mi,ri));return rs&&Ls(),Ft(Mt),this},g.path=function(W){for(var Se=0;Se<W.length;Se++){var Je=W[Se],xt=Je.c;switch(Je.op){case"m":Zt(xt[0],xt[1]);break;case"l":Ds(xt[0],xt[1]);break;case"c":js.apply(this,xt);break;case"h":Ls()}}return this},g.__private__.rect=g.rect=function(W,Se,Je,xt,Mt){if(isNaN(W)||isNaN(Se)||isNaN(Je)||isNaN(xt)||!ms(Mt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===U&&(xt=-xt),Z([B(te(W)),B(J(Se)),B(te(Je)),B(te(xt)),"re"].join(" ")),Ft(Mt),this},g.__private__.triangle=g.triangle=function(W,Se,Je,xt,Mt,rs,gs){if(isNaN(W)||isNaN(Se)||isNaN(Je)||isNaN(xt)||isNaN(Mt)||isNaN(rs)||!ms(gs))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Je-W,xt-Se],[Mt-Je,rs-xt],[W-Mt,Se-rs]],W,Se,[1,1],gs,!0),this},g.__private__.roundedRect=g.roundedRect=function(W,Se,Je,xt,Mt,rs,gs){if(isNaN(W)||isNaN(Se)||isNaN(Je)||isNaN(xt)||isNaN(Mt)||isNaN(rs)||!ms(gs))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ys=4/3*(Math.SQRT2-1);return Mt=Math.min(Mt,.5*Je),rs=Math.min(rs,.5*xt),this.lines([[Je-2*Mt,0],[Mt*Ys,0,Mt,rs-rs*Ys,Mt,rs],[0,xt-2*rs],[0,rs*Ys,-Mt*Ys,rs,-Mt,rs],[2*Mt-Je,0],[-Mt*Ys,0,-Mt,-rs*Ys,-Mt,-rs],[0,2*rs-xt],[0,-rs*Ys,Mt*Ys,-rs,Mt,-rs]],W+Mt,Se,[1,1],gs,!0),this},g.__private__.ellipse=g.ellipse=function(W,Se,Je,xt,Mt){if(isNaN(W)||isNaN(Se)||isNaN(Je)||isNaN(xt)||!ms(Mt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var rs=4/3*(Math.SQRT2-1)*Je,gs=4/3*(Math.SQRT2-1)*xt;return Zt(W+Je,Se),js(W+Je,Se-gs,W+rs,Se-xt,W,Se-xt),js(W-rs,Se-xt,W-Je,Se-gs,W-Je,Se),js(W-Je,Se+gs,W-rs,Se+xt,W,Se+xt),js(W+rs,Se+xt,W+Je,Se+gs,W+Je,Se),Ft(Mt),this},g.__private__.circle=g.circle=function(W,Se,Je,xt){if(isNaN(W)||isNaN(Se)||isNaN(Je)||!ms(xt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(W,Se,Je,Je,xt)},g.setFont=function(W,Se,Je){return Je&&(Se=K(Se,Je)),We=$e(W,Se,{disableWarning:!1}),this};var hs=g.__private__.getFont=g.getFont=function(){return dt[$e.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var W,Se,Je={};for(W in Ke)if(Ke.hasOwnProperty(W))for(Se in Je[W]=[],Ke[W])Ke[W].hasOwnProperty(Se)&&Je[W].push(Se);return Je},g.addFont=function(W,Se,Je,xt,Mt){var rs=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&rs.indexOf(arguments[3])!==-1?Mt=arguments[3]:arguments[3]&&rs.indexOf(arguments[3])==-1&&(Je=K(Je,xt)),je.call(this,W,Se,Je,Mt=Mt||"Identity-H")};var Us,Qs=t.lineWidth||.200025,Is=g.__private__.getLineWidth=g.getLineWidth=function(){return Qs},_s=g.__private__.setLineWidth=g.setLineWidth=function(W){return Qs=W,Z(B(te(W))+" w"),this};g.__private__.setLineDash=en.API.setLineDash=en.API.setLineDashPattern=function(W,Se){if(W=W||[],Se=Se||0,isNaN(Se)||!Array.isArray(W))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return W=W.map(function(Je){return B(te(Je))}).join(" "),Se=B(te(Se)),Z("["+W+"] "+Se+" d"),this};var Lr=g.__private__.getLineHeight=g.getLineHeight=function(){return Ne*Us};g.__private__.getLineHeight=g.getLineHeight=function(){return Ne*Us};var Ir=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(W){return typeof(W=W||1.15)=="number"&&(Us=W),this},qr=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return Us};Ir(t.lineHeight);var vr=g.__private__.getHorizontalCoordinate=function(W){return te(W)},cn=g.__private__.getVerticalCoordinate=function(W){return w===L?W:Ce[k].mediaBox.topRightY-Ce[k].mediaBox.bottomLeftY-te(W)},cr=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(W){return B(vr(W))},ni=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(W){return B(cn(W))},Fr=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return ds(Fr)},g.__private__.setStrokeColor=g.setDrawColor=function(W,Se,Je,xt){return Fr=Ss({ch1:W,ch2:Se,ch3:Je,ch4:xt,pdfColorType:"draw",precision:2}),Z(Fr),this};var Hi=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return ds(Hi)},g.__private__.setFillColor=g.setFillColor=function(W,Se,Je,xt){return Hi=Ss({ch1:W,ch2:Se,ch3:Je,ch4:xt,pdfColorType:"fill",precision:2}),Z(Hi),this};var Or=t.textColor||"0 g",zi=g.__private__.getTextColor=g.getTextColor=function(){return ds(Or)};g.__private__.setTextColor=g.setTextColor=function(W,Se,Je,xt){return Or=Ss({ch1:W,ch2:Se,ch3:Je,ch4:xt,pdfColorType:"text",precision:3}),this};var Dr=t.charSpace,Ta=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Dr||0)};g.__private__.setCharSpace=g.setCharSpace=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Dr=W,this};var Fa=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(W){var Se=g.CapJoinStyles[W];if(Se===void 0)throw new Error("Line cap style of '"+W+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Fa=Se,Z(Se+" J"),this};var Rs=0;g.__private__.setLineJoin=g.setLineJoin=function(W){var Se=g.CapJoinStyles[W];if(Se===void 0)throw new Error("Line join style of '"+W+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Rs=Se,Z(Se+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(W){if(W=W||0,isNaN(W))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(B(te(W))+" M"),this},g.GState=X_,g.setGState=function(W){(W=typeof W=="string"?mt[Ze[W]]:Pn(null,W)).equals(De)||(Z("/"+W.id+" gs"),De=W)};var Pn=function(W,Se){if(!W||!Ze[W]){var Je=!1;for(var xt in mt)if(mt.hasOwnProperty(xt)&&mt[xt].equals(Se)){Je=!0;break}if(Je)Se=mt[xt];else{var Mt="GS"+(Object.keys(mt).length+1).toString(10);mt[Mt]=Se,Se.id=Mt}return W&&(Ze[W]=Se.id),ge.publish("addGState",Se),Se}};g.addGState=function(W,Se){return Pn(W,Se),this},g.saveGraphicsState=function(){return Z("q"),rt.push({key:We,size:Ne,color:Or}),this},g.restoreGraphicsState=function(){Z("Q");var W=rt.pop();return We=W.key,Ne=W.size,Or=W.color,De=null,this},g.setCurrentTransformationMatrix=function(W){return Z(W.toString()+" cm"),this},g.comment=function(W){return Z("#"+W),this};var Qn=function(W,Se){var Je=W||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Je},set:function(rs){isNaN(rs)||(Je=parseFloat(rs))}});var xt=Se||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return xt},set:function(rs){isNaN(rs)||(xt=parseFloat(rs))}});var Mt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Mt},set:function(rs){Mt=rs.toString()}}),this},Xr=function(W,Se,Je,xt){Qn.call(this,W,Se),this.type="rect";var Mt=Je||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Mt},set:function(gs){isNaN(gs)||(Mt=parseFloat(gs))}});var rs=xt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return rs},set:function(gs){isNaN(gs)||(rs=parseFloat(gs))}}),this},Ni=function(){this.page=Ye,this.currentPage=k,this.pages=Re.slice(0),this.pagesContext=Ce.slice(0),this.x=Tt,this.y=St,this.matrix=ze,this.width=ws(k),this.height=Kr(k),this.outputDestination=_e,this.id="",this.objectNumber=-1};Ni.prototype.restore=function(){Ye=this.page,k=this.currentPage,Ce=this.pagesContext,Re=this.pages,Tt=this.x,St=this.y,ze=this.matrix,Hn(k,this.width),Si(k,this.height),_e=this.outputDestination};var so=function(W,Se,Je,xt,Mt){Xe.push(new Ni),Ye=k=0,Re=[],Tt=W,St=Se,ze=Mt,Te([Je,xt])};for(var ml in g.beginFormObject=function(W,Se,Je,xt,Mt){return so(W,Se,Je,xt,Mt),this},g.endFormObject=function(W){return(function(Se){if(Le[Se])Xe.pop().restore();else{var Je=new Ni,xt="Xo"+(Object.keys(ce).length+1).toString(10);Je.id=xt,Le[Se]=xt,ce[xt]=Je,ge.publish("addFormObject",Je),Xe.pop().restore()}})(W),this},g.doFormObject=function(W,Se){var Je=ce[Le[W]];return Z("q"),Z(Se.toString()+" cm"),Z("/"+Je.id+" Do"),Z("Q"),this},g.getFormObject=function(W){var Se=ce[Le[W]];return{x:Se.x,y:Se.y,width:Se.width,height:Se.height,matrix:Se.matrix}},g.save=function(W,Se){return W=W||"generated.pdf",(Se=Se||{}).returnPromise=Se.returnPromise||!1,Se.returnPromise===!1?(qu(Ut(ts()),W),typeof qu.unload=="function"&&pn.setTimeout&&setTimeout(qu.unload,911),this):new Promise(function(Je,xt){try{var Mt=qu(Ut(ts()),W);typeof qu.unload=="function"&&pn.setTimeout&&setTimeout(qu.unload,911),Je(Mt)}catch(rs){xt(rs.message)}})},en.API)en.API.hasOwnProperty(ml)&&(ml==="events"&&en.API.events.length?(function(W,Se){var Je,xt,Mt;for(Mt=Se.length-1;Mt!==-1;Mt--)Je=Se[Mt][0],xt=Se[Mt][1],W.subscribe.apply(W,[Je].concat(typeof xt=="function"?[xt]:xt))})(ge,en.API.events):g[ml]=en.API[ml]);function ws(W){return Ce[W].mediaBox.topRightX-Ce[W].mediaBox.bottomLeftX}function Hn(W,Se){Ce[W].mediaBox.topRightX=Se+Ce[W].mediaBox.bottomLeftX}function Kr(W){return Ce[W].mediaBox.topRightY-Ce[W].mediaBox.bottomLeftY}function Si(W,Se){Ce[W].mediaBox.topRightY=Se+Ce[W].mediaBox.bottomLeftY}var Oi=g.getPageWidth=function(W){return ws(W=W||k)/Dt},Wh=g.setPageWidth=function(W,Se){Hn(W,Se*Dt)},no=g.getPageHeight=function(W){return Kr(W=W||k)/Dt},Fh=g.setPageHeight=function(W,Se){Si(W,Se*Dt)};return g.internal={pdfEscape:tt,getStyle:Ks,getFont:hs,getFontSize:ne,getCharSpace:Ta,getTextColor:zi,getLineHeight:Lr,getLineHeightFactor:qr,getLineWidth:Is,write:le,getHorizontalCoordinate:vr,getVerticalCoordinate:cn,getCoordinateString:cr,getVerticalCoordinateString:ni,collections:{},newObject:jt,newAdditionalObject:Ue,newObjectDeferred:Ve,newObjectDeferredBegin:$t,getFilters:Ns,putStream:ke,events:ge,scaleFactor:Dt,pageSize:{getWidth:function(){return Oi(k)},setWidth:function(W){Wh(k,W)},getHeight:function(){return no(k)},setHeight:function(W){Fh(k,W)}},encryptionOptions:m,encryption:Ps,getEncryptor:function(W){return m!==null?Ps.encryptor(W,0):function(Se){return Se}},output:Es,getNumberOfPages:vt,get pages(){return Re},out:Z,f2:A,f3:Y,getPageInfo:ps,getPageInfoByObjId:vs,getCurrentPageInfo:Ms,getPDFVersion:C,Point:Qn,Rectangle:Xr,Matrix:Pe,hasHotfix:ys},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return Oi(k)},set:function(W){Wh(k,W)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return no(k)},set:function(W){Fh(k,W)},enumerable:!0,configurable:!0}),(function(W){for(var Se=0,Je=Ee.length;Se<Je;Se++){var xt=je.call(this,W[Se][0],W[Se][1],W[Se][2],Ee[Se][3],!0);_===!1&&(y[xt]=!0);var Mt=W[Se][0].split("-");Oe({id:xt,fontName:Mt[0],fontStyle:Mt[1]||""})}ge.publish("addFonts",{fonts:dt,dictionary:Ke})}).call(g,Ee),We="F1",_t(i,n),ge.publish("initialized"),g}K0.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},K0.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},K0.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},K0.prototype.processOwnerPassword=function(t,e){return nb(sb(e).substr(0,5),t)},K0.prototype.encryptor=function(t,e){var n=sb(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return nb(n,r)}},X_.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||pr(t)!==pr(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},en.API={events:[]},en.version="4.2.0";var fi=en.API,RN=1,Bh=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},L0=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Dh=function(t){return t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},bn=function(t){return t.toFixed(2)},qd=function(t){return t.toFixed(5)};fi.__acroform__={};var fl=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},sT=function(t){return t*RN},tc=function(t){var e=new jI,n=qs.internal.getHeight(t)||0,r=qs.internal.getWidth(t)||0;return e.BBox=[0,0,Number(bn(r)),Number(bn(n))],e},DF=fi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},RF=fi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},TF=fi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},xi=fi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return TF(t,e-1)},Ci=fi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return DF(t,e-1)},yi=fi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return RF(t,e-1)},EF=fi.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],l=t[1],c=t[2],d=t[3],u={};return u.lowerLeft_X=n(i)||0,u.lowerLeft_Y=r(l+d)||0,u.upperRight_X=n(i+c)||0,u.upperRight_Y=r(l)||0,[Number(bn(u.lowerLeft_X)),Number(bn(u.lowerLeft_Y)),Number(bn(u.upperRight_X)),Number(bn(u.upperRight_Y))]},jF=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=rb(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+bn(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var l=tc(t);return l.scope=t.scope,l.stream=e.join(`
`),l}},rb=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(A){return A.split(`
`)}):i.map(function(A){return[A]});var l=n,c=qs.internal.getHeight(t)||0;c=c<0?-c:c;var d=qs.internal.getWidth(t)||0;d=d<0?-d:d;var u=function(A,Y,te){if(A+1<i.length){var J=Y+" "+i[A+1][0];return Zp(J,t,te).width<=d-4}return!1};l++;e:for(;l>0;){e="",l--;var f,m,_=Zp("3",t,l).height,y=t.multiline?c-l:(c-_)/2,g=y+=2,N=0,C=0,v=0;if(l<=0){e=`(...) Tj
`,e+="% Width of Text: "+Zp(e,t,l=12).width+", FieldWidth:"+d+`
`;break}for(var R="",U=0,L=0;L<i.length;L++)if(i.hasOwnProperty(L)){var w=!1;if(i[L].length!==1&&v!==i[L].length-1){if((_+2)*(U+2)+2>c)continue e;R+=i[L][v],w=!0,C=L,L--}else{R=(R+=i[L][v]+" ").substr(R.length-1)==" "?R.substr(0,R.length-1):R;var P=parseInt(L),G=u(P,R,l),K=L>=i.length-1;if(G&&!K){R+=" ",v=0;continue}if(G||K){if(K)C=P;else if(t.multiline&&(_+2)*(U+2)+2>c)continue e}else{if(!t.multiline||(_+2)*(U+2)+2>c)continue e;C=P}}for(var B="",O=N;O<=C;O++){var S=i[O];if(t.multiline){if(O===C){B+=S[v]+" ",v=(v+1)%S.length;continue}if(O===N){B+=S[S.length-1]+" ";continue}}B+=S[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,m=Zp(B,t,l).width,t.textAlign){case"right":f=d-m-2;break;case"center":f=(d-m)/2;break;default:f=2}e+=bn(f)+" "+bn(g)+` Td
`,e+="("+Bh(B)+`) Tj
`,e+=-bn(f)+` 0 Td
`,g=-(l+2),m=0,N=w?C:C+1,U++,R=""}break}return r.text=e,r.fontSize=l,r},Zp=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},IF={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},OF=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},MF=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(wo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(IF)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");RN=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new II,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var l=r[i];l.objId=void 0,l.hasAnnotation&&OF(l,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var l=!r;for(var c in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(c)){var d=r[c],u=[],f=d.Rect;if(d.Rect&&(d.Rect=EF(d.Rect,i)),i.internal.newObjectDeferredBegin(d.objId,!0),d.DA=qs.createDefaultAppearanceStream(d),pr(d)==="object"&&typeof d.getKeyValueListForStream=="function"&&(u=d.getKeyValueListForStream()),d.Rect=f,d.hasAppearanceStream&&!d.appearanceStreamContent){var m=jF(d);u.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(d.appearanceStreamContent){var _="";for(var y in d.appearanceStreamContent)if(d.appearanceStreamContent.hasOwnProperty(y)){var g=d.appearanceStreamContent[y];if(_+="/"+y+" ",_+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var c in g)if(g.hasOwnProperty(c)){var N=g[c];typeof N=="function"&&(N=N.call(i,d)),_+="/"+c+" "+N+" ",i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N)}}else typeof(N=g)=="function"&&(N=N.call(i,d)),_+="/"+c+" "+N,i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N);_+=">>"}u.push({key:"AP",value:`<<
`+_+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:d.objId}),i.internal.out("endobj")}l&&(function(C,v){for(var R in C)if(C.hasOwnProperty(R)){var U=R,L=C[R];v.internal.newObjectDeferredBegin(L.objId,!0),pr(L)==="object"&&typeof L.putStream=="function"&&L.putStream(),delete C[U]}})(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},EI=fi.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(c){return c};if(Array.isArray(t)){for(var i="[",l=0;l<t.length;l++)switch(l!==0&&(i+=" "),pr(t[l])){case"boolean":case"number":case"object":i+=t[l].toString();break;case"string":t[l].substr(0,1)==="/"?i+="/"+Dh(t[l].substr(1)):(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+Bh(r(t[l].toString()))+")")}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},JC=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Bh(r(t))+")"},oc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};oc.prototype.toString=function(){return this.objId+" 0 R"},oc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},oc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(l){return l!="content"&&l!="appearanceStreamContent"&&l!="scope"&&l!="objId"&&l.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:EI(i,this.objId,this.scope)}):i instanceof oc?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var jI=function(){oc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};fl(jI,oc);var II=function(){oc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Bh(n(t))+")"}},set:function(n){t=n}})};fl(II,oc);var wo=function t(){oc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(R){if(isNaN(R))throw new Error('Invalid value "'+R+'" for attribute F supplied.');e=R}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!xi(e,3)},set:function(R){R?this.F=Ci(e,3):this.F=yi(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(R){if(isNaN(R))throw new Error('Invalid value "'+R+'" for attribute Ff supplied.');n=R}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(R){r=R!==void 0?R:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(R){r[0]=R}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(R){r[1]=R}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(R){r[2]=R}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(R){r[3]=R}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(R){switch(R){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=R;break;default:throw new Error('Invalid value "'+R+'" for attribute FT supplied.')}}});var l=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!l||l.length<1){if(this instanceof J_)return;l="FieldObject"+t.FieldNum++}var R=function(U){return U};return this.scope&&(R=this.scope.internal.getEncryptor(this.objId)),"("+Bh(R(l))+")"},set:function(R){l=R.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return l},set:function(R){l=R}});var c="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return c},set:function(R){c=R}});var d="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return d},set:function(R){d=R}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(R){u=R}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/RN:f},set:function(R){f=R}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(R){m=R}});var _="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!_||this instanceof J_||this instanceof gh))return JC(_,this.objId,this.scope)},set:function(R){R=R.toString(),_=R}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof ia==0?JC(y,this.objId,this.scope):y},set:function(R){R=R.toString(),y=this instanceof ia==0?R.substr(0,1)==="("?L0(R.substr(1,R.length-2)):L0(R):R}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ia==1?L0(y.substr(1,y.length-1)):y},set:function(R){R=R.toString(),y=this instanceof ia==1?"/"+Dh(R):R}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(R){this.V=R}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ia==0?JC(g,this.objId,this.scope):g},set:function(R){R=R.toString(),g=this instanceof ia==0?R.substr(0,1)==="("?L0(R.substr(1,R.length-2)):L0(R):R}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ia==1?L0(g.substr(1,g.length-1)):g},set:function(R){R=R.toString(),g=this instanceof ia==1?"/"+Dh(R):R}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var N,C=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return C},set:function(R){R=!!R,C=R}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(N)return N},set:function(R){N=R}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,1)},set:function(R){R?this.Ff=Ci(this.Ff,1):this.Ff=yi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,2)},set:function(R){R?this.Ff=Ci(this.Ff,2):this.Ff=yi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,3)},set:function(R){R?this.Ff=Ci(this.Ff,3):this.Ff=yi(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(R){if([0,1,2].indexOf(R)===-1)throw new Error('Invalid value "'+R+'" for attribute Q supplied.');v=R}}),Object.defineProperty(this,"textAlign",{get:function(){var R;switch(v){case 0:default:R="left";break;case 1:R="center";break;case 2:R="right"}return R},configurable:!0,enumerable:!0,set:function(R){switch(R){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};fl(wo,oc);var sf=function(){wo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return EI(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=(function(l,c,d){d||(d=1);for(var u,f=[];u=c.exec(l);)f.push(u[d]);return f})(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,18)},set:function(n){n?this.Ff=Ci(this.Ff,18):this.Ff=yi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Ci(this.Ff,19):this.Ff=yi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,20)},set:function(n){n?(this.Ff=Ci(this.Ff,20),e.sort()):this.Ff=yi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,22)},set:function(n){n?this.Ff=Ci(this.Ff,22):this.Ff=yi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,23)},set:function(n){n?this.Ff=Ci(this.Ff,23):this.Ff=yi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,27)},set:function(n){n?this.Ff=Ci(this.Ff,27):this.Ff=yi(this.Ff,27)}}),this.hasAppearanceStream=!1};fl(sf,wo);var nf=function(){sf.call(this),this.fontName="helvetica",this.combo=!1};fl(nf,sf);var rf=function(){nf.call(this),this.combo=!0};fl(rf,nf);var m_=function(){rf.call(this),this.edit=!0};fl(m_,rf);var ia=function(){wo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,15)},set:function(n){n?this.Ff=Ci(this.Ff,15):this.Ff=yi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,16)},set:function(n){n?this.Ff=Ci(this.Ff,16):this.Ff=yi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,17)},set:function(n){n?this.Ff=Ci(this.Ff,17):this.Ff=yi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,26)},set:function(n){n?this.Ff=Ci(this.Ff,26):this.Ff=yi(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Bh(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){pr(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){var r=n==null?"":n.toString();r.substr(0,1)==="/"&&(r=r.substr(1)),t="/"+Dh(r)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+Dh(n)}})};fl(ia,wo);var g_=function(){ia.call(this),this.pushButton=!0};fl(g_,ia);var af=function(){ia.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};fl(af,ia);var J_=function(){var t,e;wo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(d){return d};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var l,c=[];for(l in c.push("<<"),r)c.push("/"+l+" ("+Bh(i(r[l]))+")");return c.push(">>"),c.join(`
`)},set:function(i){pr(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){var l=i==null?"":i.toString();l.substr(0,1)==="/"&&(l=l.substr(1)),n="/"+Dh(l)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){var l=i==null?"":i.toString();l.substr(0,1)==="/"&&(l=l.substr(1)),n="/"+Dh(l)}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=qs.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};fl(J_,wo),af.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},af.prototype.createOption=function(t){var e=new J_;return e.Parent=this,e.optionName=t,this.Kids.push(e),LF.call(this.scope,e),e};var p_=function(){ia.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=qs.CheckBox.createAppearanceStream()};fl(p_,ia);var gh=function(){wo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,13)},set:function(e){e?this.Ff=Ci(this.Ff,13):this.Ff=yi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,21)},set:function(e){e?this.Ff=Ci(this.Ff,21):this.Ff=yi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,23)},set:function(e){e?this.Ff=Ci(this.Ff,23):this.Ff=yi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,24)},set:function(e){e?this.Ff=Ci(this.Ff,24):this.Ff=yi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,25)},set:function(e){e?this.Ff=Ci(this.Ff,25):this.Ff=yi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,26)},set:function(e){e?this.Ff=Ci(this.Ff,26):this.Ff=yi(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};fl(gh,wo);var __=function(){gh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!xi(this.Ff,14)},set:function(t){t?this.Ff=Ci(this.Ff,14):this.Ff=yi(this.Ff,14)}}),this.password=!0};fl(__,gh);var qs={CheckBox:{createAppearanceStream:function(){return{N:{On:qs.CheckBox.YesNormal},D:{On:qs.CheckBox.YesPushDown,Off:qs.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=tc(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),l=rb(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+bn(qs.internal.getWidth(t))+" "+bn(qs.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+bn(l.fontSize)+" Tf "+i),n.push("BT"),n.push(l.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=tc(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],l=qs.internal.getHeight(t),c=qs.internal.getWidth(t),d=rb(t,t.caption);return i.push("1 g"),i.push("0 0 "+bn(c)+" "+bn(l)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+bn(c-1)+" "+bn(l-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+bn(d.fontSize)+" Tf "+r),i.push(d.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=tc(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+bn(qs.internal.getWidth(t))+" "+bn(qs.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:qs.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=qs.RadioButton.Circle.YesNormal,e.D[t]=qs.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=tc(t);e.scope=t.scope;var n=[],r=qs.internal.getWidth(t)<=qs.internal.getHeight(t)?qs.internal.getWidth(t)/4:qs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=qs.internal.Bezier_C,l=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+qd(qs.internal.getWidth(t)/2)+" "+qd(qs.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),n.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),n.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),n.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=tc(t);e.scope=t.scope;var n=[],r=qs.internal.getWidth(t)<=qs.internal.getHeight(t)?qs.internal.getWidth(t)/4:qs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),l=Number((i*qs.internal.Bezier_C).toFixed(5)),c=Number((r*qs.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+qd(qs.internal.getWidth(t)/2)+" "+qd(qs.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+qd(qs.internal.getWidth(t)/2)+" "+qd(qs.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+c+" "+c+" "+r+" 0 "+r+" c"),n.push("-"+c+" "+r+" -"+r+" "+c+" -"+r+" 0 c"),n.push("-"+r+" -"+c+" -"+c+" -"+r+" 0 -"+r+" c"),n.push(c+" -"+r+" "+r+" -"+c+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=tc(t);e.scope=t.scope;var n=[],r=qs.internal.getWidth(t)<=qs.internal.getHeight(t)?qs.internal.getWidth(t)/4:qs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),l=Number((i*qs.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+qd(qs.internal.getWidth(t)/2)+" "+qd(qs.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:qs.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=qs.RadioButton.Cross.YesNormal,e.D[t]=qs.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=tc(t);e.scope=t.scope;var n=[],r=qs.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+bn(qs.internal.getWidth(t)-2)+" "+bn(qs.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(bn(r.x1.x)+" "+bn(r.x1.y)+" m"),n.push(bn(r.x2.x)+" "+bn(r.x2.y)+" l"),n.push(bn(r.x4.x)+" "+bn(r.x4.y)+" m"),n.push(bn(r.x3.x)+" "+bn(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=tc(t);e.scope=t.scope;var n=qs.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+bn(qs.internal.getWidth(t))+" "+bn(qs.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+bn(qs.internal.getWidth(t)-2)+" "+bn(qs.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(bn(n.x1.x)+" "+bn(n.x1.y)+" m"),r.push(bn(n.x2.x)+" "+bn(n.x2.y)+" l"),r.push(bn(n.x4.x)+" "+bn(n.x4.y)+" m"),r.push(bn(n.x3.x)+" "+bn(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=tc(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+bn(qs.internal.getWidth(t))+" "+bn(qs.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};qs.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=qs.internal.getWidth(t),n=qs.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},qs.internal.getWidth=function(t){var e=0;return pr(t)==="object"&&(e=sT(t.Rect[2])),e},qs.internal.getHeight=function(t){var e=0;return pr(t)==="object"&&(e=sT(t.Rect[3])),e};var LF=fi.addField=function(t){if(MF(this,t),!(t instanceof wo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};fi.AcroFormChoiceField=sf,fi.AcroFormListBox=nf,fi.AcroFormComboBox=rf,fi.AcroFormEditBox=m_,fi.AcroFormButton=ia,fi.AcroFormPushButton=g_,fi.AcroFormRadioButton=af,fi.AcroFormCheckBox=p_,fi.AcroFormTextField=gh,fi.AcroFormPasswordField=__,fi.AcroFormAppearance=qs,fi.AcroForm={ChoiceField:sf,ListBox:nf,ComboBox:rf,EditBox:m_,Button:ia,PushButton:g_,RadioButton:af,CheckBox:p_,TextField:gh,PasswordField:__,Appearance:qs},en.AcroForm={ChoiceField:sf,ListBox:nf,ComboBox:rf,EditBox:m_,Button:ia,PushButton:g_,RadioButton:af,CheckBox:p_,TextField:gh,PasswordField:__,Appearance:qs};en.AcroForm;function OI(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(A,Y){var te,J,q,V,F,I=n;if((Y=Y||n)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(G(A))for(F in r)for(q=r[F],te=0;te<q.length;te+=1){for(V=!0,J=0;J<q[te].length;J+=1)if(q[te][J]!==void 0&&q[te][J]!==A[J]){V=!1;break}if(V===!0){I=F;break}}else for(F in r)for(q=r[F],te=0;te<q.length;te+=1){for(V=!0,J=0;J<q[te].length;J+=1)if(q[te][J]!==void 0&&q[te][J]!==A.charCodeAt(J)){V=!1;break}if(V===!0){I=F;break}}return I===n&&Y!==n&&(I=Y),I},l=function A(Y){for(var te=this.internal.write,J=this.internal.putStream,q=(0,this.internal.getFilters)();q.indexOf("FlateEncode")!==-1;)q.splice(q.indexOf("FlateEncode"),1);Y.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:Y.width}),V.push({key:"Height",value:Y.height}),Y.colorSpace===R.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(Y.palette.length/3-1)+" "+("sMask"in Y&&Y.sMask!==void 0?Y.objectId+2:Y.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+Y.colorSpace}),Y.colorSpace===R.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:Y.bitsPerComponent}),"decodeParameters"in Y&&Y.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+Y.decodeParameters+">>"}),"transparency"in Y&&Array.isArray(Y.transparency)&&Y.transparency.length>0){for(var F="",I=0,ee=Y.transparency.length;I<ee;I++)F+=Y.transparency[I]+" "+Y.transparency[I]+" ";V.push({key:"Mask",value:"["+F+"]"})}Y.sMask!==void 0&&V.push({key:"SMask",value:Y.objectId+1+" 0 R"});var ae=Y.filter!==void 0?["/"+Y.filter]:void 0;if(J({data:Y.data,additionalKeyValues:V,alreadyAppliedFilters:ae,objectId:Y.objectId}),te("endobj"),"sMask"in Y&&Y.sMask!==void 0){var T,j=(T=Y.sMaskBitsPerComponent)!==null&&T!==void 0?T:Y.bitsPerComponent,k={width:Y.width,height:Y.height,colorSpace:"DeviceGray",bitsPerComponent:j,data:Y.sMask};"filter"in Y&&(k.decodeParameters="/Predictor ".concat(Y.predictor," /Colors 1 /BitsPerComponent ").concat(j," /Columns ").concat(Y.width),k.filter=Y.filter),A.call(this,k)}if(Y.colorSpace===R.INDEXED){var Q=this.internal.newObject();J({data:B(new Uint8Array(Y.palette)),objectId:Q}),te("endobj")}},c=function(){var A=this.internal.collections[e+"images"];for(var Y in A)l.call(this,A[Y])},d=function(){var A,Y=this.internal.collections[e+"images"],te=this.internal.write;for(var J in Y)te("/I"+(A=Y[J]).index,A.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",c),this.internal.events.subscribe("putXobjectDict",d))},f=function(){var A=this.internal.collections[e+"images"];return u.call(this),A},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},_=function(A){return typeof t["process"+A.toUpperCase()]=="function"},y=function(A){return pr(A)==="object"&&A.nodeType===1},g=function(A,Y){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var te=""+A.getAttribute("src");if(te.indexOf("data:image/")===0)return f_(unescape(te).split("base64,").pop());var J=t.loadFile(te,!0);if(J!==void 0)return J}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var q;switch(Y){case"PNG":q="image/png";break;case"WEBP":q="image/webp";break;default:q="image/jpeg"}return f_(A.toDataURL(q,1).split("base64,").pop())}},N=function(A){var Y=this.internal.collections[e+"images"];if(Y){for(var te in Y)if(A===Y[te].alias)return Y[te]}},C=function(A,Y,te){return A||Y||(A=-96,Y=-96),A<0&&(A=-1*te.width*72/A/this.internal.scaleFactor),Y<0&&(Y=-1*te.height*72/Y/this.internal.scaleFactor),A===0&&(A=Y*te.width/te.height),Y===0&&(Y=A*te.height/te.width),[A,Y]},v=function(A,Y,te,J,q,V){var F=C.call(this,te,J,q),I=this.internal.getCoordinateString,ee=this.internal.getVerticalCoordinateString,ae=f.call(this);if(te=F[0],J=F[1],ae[q.index]=q,V){V*=Math.PI/180;var T=Math.cos(V),j=Math.sin(V),k=function(H){return H.toFixed(4)},Q=[k(T),k(j),k(-1*j),k(T),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,I(A),ee(Y+J),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([I(te),"0","0",I(J),"0","0","cm"].join(" "))):this.internal.write([I(te),"0","0",I(J),I(A),ee(Y+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+q.index+" Do"),this.internal.write("Q")},R=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var U=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},L=t.__addimage__.sHashCode=function(A){var Y,te,J=0;if(typeof A=="string")for(te=A.length,Y=0;Y<te;Y++)J=(J<<5)-J+A.charCodeAt(Y),J|=0;else if(G(A))for(te=A.byteLength/2,Y=0;Y<te;Y++)J=(J<<5)-J+A[Y],J|=0;return J},w=t.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var Y=!0;return A.length===0&&(Y=!1),A.length%4!=0&&(Y=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(Y=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(Y=!1),Y},P=t.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var Y=A.indexOf(",");return Y<0?null:A.substring(0,Y).trim().endsWith("base64")?A.substring(Y+1):null};t.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var G=t.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},K=t.__addimage__.binaryStringToUint8Array=function(A){for(var Y=A.length,te=new Uint8Array(Y),J=0;J<Y;J++)te[J]=A.charCodeAt(J);return te},B=t.__addimage__.arrayBufferToBinaryString=function(A){for(var Y="",te=G(A)?A:new Uint8Array(A),J=0;J<te.length;J+=8192)Y+=String.fromCharCode.apply(null,te.subarray(J,J+8192));return Y};t.addImage=function(){var A,Y,te,J,q,V,F,I,ee;if(typeof arguments[1]=="number"?(Y=n,te=arguments[1],J=arguments[2],q=arguments[3],V=arguments[4],F=arguments[5],I=arguments[6],ee=arguments[7]):(Y=arguments[1],te=arguments[2],J=arguments[3],q=arguments[4],V=arguments[5],F=arguments[6],I=arguments[7],ee=arguments[8]),pr(A=arguments[0])==="object"&&!y(A)&&"imageData"in A){var ae=A;A=ae.imageData,Y=ae.format||Y||n,te=ae.x||te||0,J=ae.y||J||0,q=ae.w||ae.width||q,V=ae.h||ae.height||V,F=ae.alias||F,I=ae.compression||I,ee=ae.rotation||ae.angle||ee}var T=this.internal.getFilters();if(I===void 0&&T.indexOf("FlateEncode")!==-1&&(I="SLOW"),isNaN(te)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var j=O.call(this,A,Y,F,I);return v.call(this,te,J,q,V,j,ee),this};var O=function(A,Y,te,J){var q,V,F;if(typeof A=="string"&&i(A)===n){A=unescape(A);var I=S(A,!1);(I!==""||(I=t.loadFile(A,!0))!==void 0)&&(A=I)}if(y(A)&&(A=g(A,Y)),Y=i(A,Y),!_(Y))throw new Error("addImage does not support files of type '"+Y+"', please ensure that a plugin for '"+Y+"' support is added.");if(((F=te)==null||F.length===0)&&(te=(function(ee){return typeof ee=="string"||G(ee)?L(ee):G(ee.data)?L(ee.data):null})(A)),(q=N.call(this,te))||(A instanceof Uint8Array||Y==="RGBA"||(V=A,A=K(A)),q=this["process"+Y.toUpperCase()](A,m.call(this),te,(function(ee){return ee&&typeof ee=="string"&&(ee=ee.toUpperCase()),ee in t.image_compression?ee:U.NONE})(J),V)),!q)throw new Error("An unknown error occurred whilst processing the image.");return q},S=t.__addimage__.convertBase64ToBinaryString=function(A,Y){Y=typeof Y!="boolean"||Y;var te,J="";if(typeof A=="string"){var q;te=(q=P(A))!==null&&q!==void 0?q:A;try{J=f_(te)}catch(V){if(Y)throw w(te)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return J};t.getImageProperties=function(A){var Y,te,J="";if(y(A)&&(A=g(A)),typeof A=="string"&&i(A)===n&&((J=S(A,!1))===""&&(J=t.loadFile(A)||""),A=J),te=i(A),!_(te))throw new Error("addImage does not support files of type '"+te+"', please ensure that a plugin for '"+te+"' support is added.");if(A instanceof Uint8Array||(A=K(A)),!(Y=this["process"+te.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return Y.fileType=te,Y}})(en.API),(function(t){var e=function(n){if(n!==void 0&&n!="")return!0};en.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,l,c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(n.objId),f=n.pageContext.annotations,m=!1,_=0;_<f.length&&!m;_++)switch((r=f[_]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var y=0;y<f.length;y++){r=f[y];var g=this.internal.pdfEscape,N=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var C=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),R=this.internal.getEncryptor(C.objId),U=r.title||"Note";l="<</Type /Annot /Subtype /Text "+(i="/Rect ["+c(r.bounds.x)+" "+d(r.bounds.y+r.bounds.h)+" "+c(r.bounds.x+r.bounds.w)+" "+d(r.bounds.y)+"] ")+"/Contents ("+g(R(r.contents))+")",l+=" /Popup "+v.objId+" 0 R",l+=" /P "+u.objId+" 0 R",l+=" /T ("+g(R(U))+") >>",C.content=l;var L=C.objId+" 0 R";l="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+c(r.bounds.x+30)+" "+d(r.bounds.y+r.bounds.h)+" "+c(r.bounds.x+r.bounds.w+30)+" "+d(r.bounds.y)+"] ")+" /Parent "+L,r.open&&(l+=" /Open true"),l+=" >>",v.content=l,this.internal.write(C.objId,"0 R",v.objId,"0 R");break;case"freetext":i="/Rect ["+c(r.bounds.x)+" "+d(r.bounds.y)+" "+c(r.bounds.x+r.bounds.w)+" "+d(r.bounds.y+r.bounds.h)+"] ";var w=r.color||"#000000";l="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+g(N(r.contents))+")",l+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",l+=" /Border [0 0 0]",l+=" >>",this.internal.write(l);break;case"link":if(r.options.name){var P=this.annotations._nameMap[r.options.name];r.options.pageNumber=P.page,r.options.top=P.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",l="",r.options.url)l="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+g(N(r.options.url))+") >>";else if(r.options.pageNumber)switch(l="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":l+=" /Fit]";break;case"FitH":l+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,l+=" /FitV "+r.options.left+"]";break;default:var G=d(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),l+=" /XYZ "+r.options.left+" "+G+" "+r.options.zoom+"]"}l!=""&&(l+=" >>",this.internal.write(l))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,l,c){var d=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;d.pageContext.annotations.push({finalBounds:{x:u(n),y:f(r),w:u(n+i),h:f(r+l)},options:c,type:"link"})},t.textWithLink=function(n,r,i,l){var c,d,u=this.getTextWidth(n),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(l.maxWidth!==void 0){d=l.maxWidth;var m=this.splitTextToSize(n,d).length;c=Math.ceil(f*m)}else d=u,c=f;return this.text(n,r,i,l),i+=.2*f,l.align==="center"&&(r-=u/2),l.align==="right"&&(r-=u),this.link(r,i-f,d,c,l),u},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}})(en.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var l=t.__arabicParser__.isInArabicSubstitutionA=function(C){return e[C.charCodeAt(0)]!==void 0},c=t.__arabicParser__.isArabicLetter=function(C){return typeof C=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(C)},d=t.__arabicParser__.isArabicEndLetter=function(C){return c(C)&&l(C)&&e[C.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(C){return c(C)&&i.indexOf(C.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(C){return c(C)&&l(C)&&e[C.charCodeAt(0)].length>=1};var f=t.__arabicParser__.arabicLetterHasFinalForm=function(C){return c(C)&&l(C)&&e[C.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(C){return c(C)&&l(C)&&e[C.charCodeAt(0)].length>=3};var m=t.__arabicParser__.arabicLetterHasMedialForm=function(C){return c(C)&&l(C)&&e[C.charCodeAt(0)].length==4},_=t.__arabicParser__.resolveLigatures=function(C){var v=0,R=n,U="",L=0;for(v=0;v<C.length;v+=1)R[C.charCodeAt(v)]!==void 0?(L++,typeof(R=R[C.charCodeAt(v)])=="number"&&(U+=String.fromCharCode(R),R=n,L=0),v===C.length-1&&(R=n,U+=C.charAt(v-(L-1)),v-=L-1,L=0)):(R=n,U+=C.charAt(v-L),v-=L,L=0);return U};t.__arabicParser__.isArabicDiacritic=function(C){return C!==void 0&&r[C.charCodeAt(0)]!==void 0};var y=t.__arabicParser__.getCorrectForm=function(C,v,R){return c(C)?l(C)===!1?-1:!f(C)||!c(v)&&!c(R)||!c(R)&&d(v)||d(C)&&!c(v)||d(C)&&u(v)||d(C)&&d(v)?0:m(C)&&c(v)&&!d(v)&&c(R)&&f(R)?3:d(C)||!c(R)?1:2:-1},g=function(C){var v=0,R=0,U=0,L="",w="",P="",G=(C=C||"").split("\\s+"),K=[];for(v=0;v<G.length;v+=1){for(K.push(""),R=0;R<G[v].length;R+=1)L=G[v][R],w=G[v][R-1],P=G[v][R+1],c(L)?(U=y(L,w,P),K[v]+=U!==-1?String.fromCharCode(e[L.charCodeAt(0)][U]):L):K[v]+=L;K[v]=_(K[v])}return K.join(" ")},N=t.__arabicParser__.processArabic=t.processArabic=function(){var C,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,R=[];if(Array.isArray(v)){var U=0;for(R=[],U=0;U<v.length;U+=1)Array.isArray(v[U])?R.push([g(v[U][0]),v[U][1],v[U][2]]):R.push([g(v[U])]);C=R}else C=g(v);return typeof arguments[0]=="string"?C:(arguments[0].text=C,arguments[0])};t.events.push(["preProcessText",N])})(en.API),en.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(d){n=d}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(d){r=isNaN(d)||Number.isInteger(d)===!1||d<0?150:d,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(d){i=isNaN(d)||Number.isInteger(d)===!1||d<0?300:d,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var l=[];Object.defineProperty(this,"childNodes",{get:function(){return l},set:function(d){l=d}});var c={};Object.defineProperty(this,"style",{get:function(){return c},set:function(d){c=d}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(en.API),(function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new l,this.internal.__cell__.pages=1},l=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(C){u=C}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(C){f=C}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(C){m=C}});var _=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return _},set:function(C){_=C}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(C){y=C}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(C){g=C}});var N=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return N},set:function(C){N=C}}),this};l.prototype.clone=function(){return new l(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},l.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,f){r.call(this);var m=(f=f||{}).fontSize||this.getFontSize(),_=f.font||this.getFont(),y=f.scaleFactor||this.internal.scaleFactor,g=0,N=0,C=0,v=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var R=f.maxWidth;R>0?typeof u=="string"?u=this.splitTextToSize(u,R):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(L,w){return L.concat(v.splitTextToSize(w,R))},[])):u=Array.isArray(u)?u:[u];for(var U=0;U<u.length;U++)g<(C=this.getStringUnitWidth(u[U],{font:_})*m)&&(g=C);return g!==0&&(N=u.length),{w:g/=y,h:Math.max((N*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/y,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new l(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var c=t.cell=function(){var u;u=arguments[0]instanceof l?arguments[0]:new l(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var f=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,_=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===u.lineNumber?(u.x=(f.x||0)+(f.width||0),u.y=f.y||0):f.y+f.height+u.height+_.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=_.top,g&&y&&(this.printHeaderRow(u.lineNumber,!0),u.y+=y[0].height)):u.y=f.y+f.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,n===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-m,u.y+m,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+m,{align:"center",baseline:"top",maxWidth:u.width-m-m}):this.text(u.text,u.x+m,u.y+m,{align:"left",baseline:"top",maxWidth:u.width-m-m})),this.internal.__cell__.lastCell=u,this};t.table=function(u,f,m,_,y){if(r.call(this),!m)throw new Error("No data for PDF table.");var g,N,C,v,R=[],U=[],L=[],w={},P={},G=[],K=[],B=(y=y||{}).autoSize||!1,O=y.printHeaders!==!1,S=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,A=y.margins||Object.assign({width:this.getPageWidth()},e),Y=typeof y.padding=="number"?y.padding:3,te=y.headerBackgroundColor||"#c8c8c8",J=y.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=O,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=S,this.internal.__cell__.padding=Y,this.internal.__cell__.headerBackgroundColor=te,this.internal.__cell__.headerTextColor=J,this.setFontSize(S),_==null)U=R=Object.keys(m[0]),L=R.map(function(){return"left"});else if(Array.isArray(_)&&pr(_[0])==="object")for(R=_.map(function(ae){return ae.name}),U=_.map(function(ae){return ae.prompt||ae.name||""}),L=_.map(function(ae){return ae.align||"left"}),g=0;g<_.length;g+=1)P[_[g].name]=.7499990551181103*_[g].width;else Array.isArray(_)&&typeof _[0]=="string"&&(U=R=_,L=R.map(function(){return"left"}));if(B||Array.isArray(_)&&typeof _[0]=="string")for(g=0;g<R.length;g+=1){for(w[v=R[g]]=m.map(function(ae){return ae[v]}),this.setFont(void 0,"bold"),G.push(this.getTextDimensions(U[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),N=w[v],this.setFont(void 0,"normal"),C=0;C<N.length;C+=1)G.push(this.getTextDimensions(N[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[v]=Math.max.apply(null,G)+Y+Y,G=[]}if(O){var q={};for(g=0;g<R.length;g+=1)q[R[g]]={},q[R[g]].text=U[g],q[R[g]].align=L[g];var V=d.call(this,q,P);K=R.map(function(ae){return new l(u,f,P[ae],V,q[ae].text,void 0,q[ae].align)}),this.setTableHeaderRow(K),this.printHeaderRow(1,!1)}var F=_.reduce(function(ae,T){return ae[T.name]=T.align,ae},{});for(g=0;g<m.length;g+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:g,data:m[g]},this);var I=d.call(this,m[g],P);for(C=0;C<R.length;C+=1){var ee=m[g][R[C]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:g,col:C,data:ee},this),c.call(this,new l(u,f,P[R[C]],I,ee,g+2,F[R[C]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=f,this};var d=function(u,f){var m=this.internal.__cell__.padding,_=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(u).map(function(g){var N=u[g];return this.splitTextToSize(N.hasOwnProperty("text")?N.text:N,f[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*_/y+m+m},this).reduce(function(g,N){return Math.max(g,N)},0)};t.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,f){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var _=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new l(_[0],_[1],_[2],_[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),f&&(m.y=this.internal.__cell__.margins.top||0,y.push(m)),m.lineNumber=u;var N=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),c.call(this,m),this.setTextColor(N)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),n=!1}})(en.API);var MI={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},LI=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],ib=OI(LI),wI=[100,200,300,400,500,600,700,800,900],wF=OI(wI);function ZC(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(l){return MI[l=l||"normal"]?l:"normal"})(t.style),r=(function(l){return l?typeof l=="number"?l>=100&&l<=900&&l%100==0?l:400:/^\d00$/.test(l)?parseInt(l):l==="bold"?700:400:400})(t.weight),i=(function(l){return typeof ib[l=l||"normal"]=="number"?l:"normal"})(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function nT(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var PF={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},rT={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function iT(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function aT(t){return t.trimLeft()}function AF(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function kF(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var w0,e_,lT,oT,cT,ey=["times"];function dT(t,e,n,r,i){var l=4,c=hT;switch(i){case en.API.image_compression.FAST:l=1,c=uT;break;case en.API.image_compression.MEDIUM:l=6,c=fT;break;case en.API.image_compression.SLOW:l=9,c=mT}t=(function(u,f,m,_){for(var y,g=u.length/f,N=new Uint8Array(u.length+g),C=[UF,uT,hT,fT,mT],v=0;v<g;v+=1){var R=v*f,U=u.subarray(R,R+f);if(_)N.set(_(U,m,y),R+v);else{for(var L=C.length,w=[],P=0;P<L;P+=1)w[P]=C[P](U,m,y);var G=WF(w.concat());N.set(w[G],R+v)}y=U}return N})(t,e,Math.ceil(n*r/8),c);var d=Jy(t,{level:l});return en.API.__addimage__.arrayBufferToBinaryString(d)}function UF(t){var e=Array.apply([],t);return e.unshift(0),e}function uT(t,e){var n=t.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var l=t[i-e]||0;r[i+1]=t[i]-l+256&255}return r}function hT(t,e,n){var r=t.length,i=[];i[0]=2;for(var l=0;l<r;l+=1){var c=n&&n[l]||0;i[l+1]=t[l]-c+256&255}return i}function fT(t,e,n){var r=t.length,i=[];i[0]=3;for(var l=0;l<r;l+=1){var c=t[l-e]||0,d=n&&n[l]||0;i[l+1]=t[l]+256-(c+d>>>1)&255}return i}function mT(t,e,n){var r=t.length,i=[];i[0]=4;for(var l=0;l<r;l+=1){var c=BF(t[l-e]||0,n&&n[l]||0,n&&n[l-e]||0);i[l+1]=t[l]-c+256&255}return i}function BF(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),l=Math.abs(t+e-n-n);return r<=i&&r<=l?t:i<=l?e:n}function WF(t){var e=t.map(function(n){return n.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function ty(t,e,n){var r=e*n,i=Math.floor(r/8),l=16-(r-8*i+n),c=(1<<n)-1;return PI(t,i)>>l&c}function gT(t,e,n,r){var i=n*r,l=Math.floor(i/8),c=16-(i-8*l+r),d=(1<<r)-1,u=(e&d)<<c;(function(f,m,_){if(m+1<f.byteLength)f.setUint16(m,_,!1);else{var y=_>>8&255;f.setUint8(m,y)}})(t,l,PI(t,l)&~(d<<c)&65535|u)}function PI(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function FF(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],l=i>>7,c=1<<1+(7&i);t[e++],t[e++];var d=null,u=null;l&&(d=e,u=c,e+=3*c);var f=!0,m=[],_=0,y=null,g=0,N=null;for(this.width=n,this.height=r;f&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,N=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var C=t[e++];_=t[e++]|t[e++]<<8,y=t[e++],1&C||(y=null),g=C>>2&7,e++;break;case 254:for(;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var v=t[e++]|t[e++]<<8,R=t[e++]|t[e++]<<8,U=t[e++]|t[e++]<<8,L=t[e++]|t[e++]<<8,w=t[e++],P=w>>6&1,G=1<<1+(7&w),K=d,B=u,O=!1;w>>7&&(O=!0,K=e,B=G,e+=3*G);var S=e;for(e++;;){var A;if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}m.push({x:v,y:R,width:U,height:L,has_local_palette:O,palette_offset:K,palette_size:B,data_offset:S,data_length:e-S,transparent_index:y,interlaced:!!P,delay:_,disposal:g});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return N},this.frameInfo=function(Y){if(Y<0||Y>=m.length)throw new Error("Frame index out of range.");return m[Y]},this.decodeAndBlitFrameBGRA=function(Y,te){var J=this.frameInfo(Y),q=J.width*J.height;if(q>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var V=new Uint8Array(q);pT(t,J.data_offset,V,q);var F=J.palette_offset,I=J.transparent_index;I===null&&(I=256);var ee=J.width,ae=n-ee,T=ee,j=4*(J.y*n+J.x),k=4*((J.y+J.height)*n+J.x),Q=j,H=4*ae;J.interlaced===!0&&(H+=4*n*7);for(var $=8,ie=0,fe=V.length;ie<fe;++ie){var pe=V[ie];if(T===0&&(T=ee,(Q+=H)>=k&&(H=4*ae+4*n*($-1),Q=j+(ee+ae)*($<<1),$>>=1)),pe===I)Q+=4;else{var de=t[F+3*pe],Re=t[F+3*pe+1],X=t[F+3*pe+2];te[Q++]=X,te[Q++]=Re,te[Q++]=de,te[Q++]=255}--T}},this.decodeAndBlitFrameRGBA=function(Y,te){var J=this.frameInfo(Y),q=J.width*J.height;if(q>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var V=new Uint8Array(q);pT(t,J.data_offset,V,q);var F=J.palette_offset,I=J.transparent_index;I===null&&(I=256);var ee=J.width,ae=n-ee,T=ee,j=4*(J.y*n+J.x),k=4*((J.y+J.height)*n+J.x),Q=j,H=4*ae;J.interlaced===!0&&(H+=4*n*7);for(var $=8,ie=0,fe=V.length;ie<fe;++ie){var pe=V[ie];if(T===0&&(T=ee,(Q+=H)>=k&&(H=4*ae+4*n*($-1),Q=j+(ee+ae)*($<<1),$>>=1)),pe===I)Q+=4;else{var de=t[F+3*pe],Re=t[F+3*pe+1],X=t[F+3*pe+2];te[Q++]=de,te[Q++]=Re,te[Q++]=X,te[Q++]=255}--T}}}function pT(t,e,n,r){for(var i=t[e++],l=1<<i,c=l+1,d=c+1,u=i+1,f=(1<<u)-1,m=0,_=0,y=0,g=t[e++],N=new Int32Array(4096),C=null;;){for(;m<16&&g!==0;)_|=t[e++]<<m,m+=8,g===1?g=t[e++]:--g;if(m<u)break;var v=_&f;if(_>>=u,m-=u,v!==l){if(v===c)break;for(var R=v<d?v:C,U=0,L=R;L>l;)L=N[L]>>8,++U;var w=L;if(y+U+(R!==v?1:0)>r)return void jr.log("Warning, gif stream longer than expected.");n[y++]=w;var P=y+=U;for(R!==v&&(n[y++]=w),L=R;U--;)L=N[L],n[--P]=255&L,L>>=8;C!==null&&d<4096&&(N[d++]=C<<8|w,d>=f+1&&u<12&&(++u,f=f<<1|1)),C=v}else d=c+1,f=(1<<(u=i+1))-1,C=null}return y!==r&&jr.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function sy(t){var e,n,r,i,l,c=Math.floor,d=new Array(64),u=new Array(64),f=new Array(64),m=new Array(64),_=new Array(65535),y=new Array(65535),g=new Array(64),N=new Array(64),C=[],v=0,R=7,U=new Array(64),L=new Array(64),w=new Array(64),P=new Array(256),G=new Array(2048),K=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Y=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],te=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(j,k){for(var Q=0,H=0,$=new Array,ie=1;ie<=16;ie++){for(var fe=1;fe<=j[ie];fe++)$[k[H]]=[],$[k[H]][0]=Q,$[k[H]][1]=ie,H++,Q++;Q*=2}return $}function F(j){for(var k=j[0],Q=j[1]-1;Q>=0;)k&1<<Q&&(v|=1<<R),Q--,--R<0&&(v==255?(I(255),I(0)):I(v),R=7,v=0)}function I(j){C.push(j)}function ee(j){I(j>>8&255),I(255&j)}function ae(j,k,Q,H,$){for(var ie,fe=$[0],pe=$[240],de=(function(Ne,ye){var ne,ue,xe,et,bt,it,At,at,We,Dt,Tt=0;for(We=0;We<8;++We){ne=Ne[Tt],ue=Ne[Tt+1],xe=Ne[Tt+2],et=Ne[Tt+3],bt=Ne[Tt+4],it=Ne[Tt+5],At=Ne[Tt+6];var St=ne+(at=Ne[Tt+7]),ze=ne-at,dt=ue+At,Ke=ue-At,rt=xe+it,ft=xe-it,Ot=et+bt,mt=et-bt,Ze=St+Ot,De=St-Ot,Ye=dt+rt,Ce=dt-rt;Ne[Tt]=Ze+Ye,Ne[Tt+4]=Ze-Ye;var ge=.707106781*(Ce+De);Ne[Tt+2]=De+ge,Ne[Tt+6]=De-ge;var Be=.382683433*((Ze=mt+ft)-(Ce=Ke+ze)),ce=.5411961*Ze+Be,Le=1.306562965*Ce+Be,Xe=.707106781*(Ye=ft+Ke),Pe=ze+Xe,Ct=ze-Xe;Ne[Tt+5]=Ct+ce,Ne[Tt+3]=Ct-ce,Ne[Tt+1]=Pe+Le,Ne[Tt+7]=Pe-Le,Tt+=8}for(Tt=0,We=0;We<8;++We){ne=Ne[Tt],ue=Ne[Tt+8],xe=Ne[Tt+16],et=Ne[Tt+24],bt=Ne[Tt+32],it=Ne[Tt+40],At=Ne[Tt+48];var Me=ne+(at=Ne[Tt+56]),lt=ne-at,ut=ue+At,jt=ue-At,Ve=xe+it,$t=xe-it,Ue=et+bt,ss=et-bt,ls=Me+Ue,ds=Me-Ue,Ss=ut+Ve,Ns=ut-Ve;Ne[Tt]=ls+Ss,Ne[Tt+32]=ls-Ss;var ke=.707106781*(Ns+ds);Ne[Tt+16]=ds+ke,Ne[Tt+48]=ds-ke;var ct=.382683433*((ls=ss+$t)-(Ns=jt+lt)),st=.5411961*ls+ct,Kt=1.306562965*Ns+ct,ht=.707106781*(Ss=$t+jt),qt=lt+ht,It=lt-ht;Ne[Tt+40]=It+st,Ne[Tt+24]=It-st,Ne[Tt+8]=qt+Kt,Ne[Tt+56]=qt-Kt,Tt++}for(We=0;We<64;++We)Dt=Ne[We]*ye[We],g[We]=Dt>0?Dt+.5|0:Dt-.5|0;return g})(j,k),Re=0;Re<64;++Re)N[K[Re]]=de[Re];var X=N[0]-Q;Q=N[0],X==0?F(H[0]):(F(H[y[ie=32767+X]]),F(_[ie]));for(var _e=63;_e>0&&N[_e]==0;)_e--;if(_e==0)return F(fe),Q;for(var me,Z=1;Z<=_e;){for(var le=Z;N[Z]==0&&Z<=_e;)++Z;var se=Z-le;if(se>=16){me=se>>4;for(var Ee=1;Ee<=me;++Ee)F(pe);se&=15}ie=32767+N[Z],F($[(se<<4)+y[ie]]),F(_[ie]),Z++}return _e!=63&&F(fe),Q}function T(j){j=Math.min(Math.max(j,1),100),l!=j&&((function(k){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],H=0;H<64;H++){var $=c((Q[H]*k+50)/100);$=Math.min(Math.max($,1),255),d[K[H]]=$}for(var ie=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var pe=c((ie[fe]*k+50)/100);pe=Math.min(Math.max(pe,1),255),u[K[fe]]=pe}for(var de=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Re=0,X=0;X<8;X++)for(var _e=0;_e<8;_e++)f[Re]=1/(d[K[Re]]*de[X]*de[_e]*8),m[Re]=1/(u[K[Re]]*de[X]*de[_e]*8),Re++})(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),l=j)}this.encode=function(j,k){k&&T(k),C=new Array,v=0,R=7,ee(65496),ee(65504),ee(16),I(74),I(70),I(73),I(70),I(0),I(1),I(1),I(0),ee(1),ee(1),I(0),I(0),(function(){ee(65499),ee(132),I(0);for(var ue=0;ue<64;ue++)I(d[ue]);I(1);for(var xe=0;xe<64;xe++)I(u[xe])})(),(function(ue,xe){ee(65472),ee(17),I(8),ee(xe),ee(ue),I(3),I(1),I(17),I(0),I(2),I(17),I(1),I(3),I(17),I(1)})(j.width,j.height),(function(){ee(65476),ee(418),I(0);for(var ue=0;ue<16;ue++)I(B[ue+1]);for(var xe=0;xe<=11;xe++)I(O[xe]);I(16);for(var et=0;et<16;et++)I(S[et+1]);for(var bt=0;bt<=161;bt++)I(A[bt]);I(1);for(var it=0;it<16;it++)I(Y[it+1]);for(var At=0;At<=11;At++)I(te[At]);I(17);for(var at=0;at<16;at++)I(J[at+1]);for(var We=0;We<=161;We++)I(q[We])})(),ee(65498),ee(12),I(3),I(1),I(0),I(2),I(17),I(3),I(17),I(0),I(63),I(0);var Q=0,H=0,$=0;v=0,R=7,this.encode.displayName="_encode_";for(var ie,fe,pe,de,Re,X,_e,me,Z,le=j.data,se=j.width,Ee=j.height,Ne=4*se,ye=0;ye<Ee;){for(ie=0;ie<Ne;){for(Re=Ne*ye+ie,_e=-1,me=0,Z=0;Z<64;Z++)X=Re+(me=Z>>3)*Ne+(_e=4*(7&Z)),ye+me>=Ee&&(X-=Ne*(ye+1+me-Ee)),ie+_e>=Ne&&(X-=ie+_e-Ne+4),fe=le[X++],pe=le[X++],de=le[X++],U[Z]=(G[fe]+G[pe+256|0]+G[de+512|0]>>16)-128,L[Z]=(G[fe+768|0]+G[pe+1024|0]+G[de+1280|0]>>16)-128,w[Z]=(G[fe+1280|0]+G[pe+1536|0]+G[de+1792|0]>>16)-128;Q=ae(U,f,Q,e,r),H=ae(L,m,H,n,i),$=ae(w,m,$,n,i),ie+=32}ye+=8}if(R>=0){var ne=[];ne[1]=R+1,ne[0]=(1<<R+1)-1,F(ne)}return ee(65497),new Uint8Array(C)},t=t||50,(function(){for(var j=String.fromCharCode,k=0;k<256;k++)P[k]=j(k)})(),e=V(B,O),n=V(Y,te),r=V(S,A),i=V(J,q),(function(){for(var j=1,k=2,Q=1;Q<=15;Q++){for(var H=j;H<k;H++)y[32767+H]=Q,_[32767+H]=[],_[32767+H][1]=Q,_[32767+H][0]=H;for(var $=-(k-1);$<=-j;$++)y[32767+$]=Q,_[32767+$]=[],_[32767+$][1]=Q,_[32767+$][0]=k-1+$;j<<=1,k<<=1}})(),(function(){for(var j=0;j<256;j++)G[j]=19595*j,G[j+256|0]=38470*j,G[j+512|0]=7471*j+32768,G[j+768|0]=-11059*j,G[j+1024|0]=-21709*j,G[j+1280|0]=32768*j+8421375,G[j+1536|0]=-27439*j,G[j+1792|0]=-5329*j})(),T(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function vo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function _T(t){function e(O){if(!O)throw Error("assert :P")}function n(O,S,A){for(var Y=0;4>Y;Y++)if(O[S+Y]!=A.charCodeAt(Y))return!0;return!1}function r(O,S,A,Y,te){for(var J=0;J<te;J++)O[S+J]=A[Y+J]}function i(O,S,A,Y){for(var te=0;te<Y;te++)O[S+te]=A}function l(O){return new Int32Array(O)}function c(O,S){for(var A=[],Y=0;Y<O;Y++)A.push(new S);return A}function d(O,S){var A=[];return(function Y(te,J,q){for(var V=q[J],F=0;F<V&&(te.push(q.length>J+1?[]:new S),!(q.length<J+1));F++)Y(te[F],J+1,q)})(A,0,O),A}var u=function(){var O=this;function S(b,E){for(var z=1<<E-1>>>0;b&z;)z>>>=1;return z?(b&z-1)+z:b}function A(b,E,z,re,ve){e(!(re%z));do b[E+(re-=z)]=ve;while(0<re)}function Y(b,E,z,re,ve){if(e(2328>=ve),512>=ve)var Ie=l(512);else if((Ie=l(ve))==null)return 0;return(function(we,Fe,Ge,qe,Nt,Wt){var He,Et,Pt=Fe,es=1<<Ge,kt=l(16),Jt=l(16);for(e(Nt!=0),e(qe!=null),e(we!=null),e(0<Ge),Et=0;Et<Nt;++Et){if(15<qe[Et])return 0;++kt[qe[Et]]}if(kt[0]==Nt)return 0;for(Jt[1]=0,He=1;15>He;++He){if(kt[He]>1<<He)return 0;Jt[He+1]=Jt[He]+kt[He]}for(Et=0;Et<Nt;++Et)He=qe[Et],0<qe[Et]&&(Wt[Jt[He]++]=Et);if(Jt[15]==1)return(qe=new te).g=0,qe.value=Wt[0],A(we,Pt,1,es,qe),es;var is,xs=-1,fs=es-1,$s=0,Bs=1,mn=1,Gs=1<<Ge;for(Et=0,He=1,Nt=2;He<=Ge;++He,Nt<<=1){if(Bs+=mn<<=1,0>(mn-=kt[He]))return 0;for(;0<kt[He];--kt[He])(qe=new te).g=He,qe.value=Wt[Et++],A(we,Pt+$s,Nt,Gs,qe),$s=S($s,He)}for(He=Ge+1,Nt=2;15>=He;++He,Nt<<=1){if(Bs+=mn<<=1,0>(mn-=kt[He]))return 0;for(;0<kt[He];--kt[He]){if(qe=new te,($s&fs)!=xs){for(Pt+=Gs,is=1<<(xs=He)-Ge;15>xs&&!(0>=(is-=kt[xs]));)++xs,is<<=1;es+=Gs=1<<(is=xs-Ge),we[Fe+(xs=$s&fs)].g=is+Ge,we[Fe+xs].value=Pt-Fe-xs}qe.g=He-Ge,qe.value=Wt[Et++],A(we,Pt+($s>>Ge),Nt,Gs,qe),$s=S($s,He)}}return Bs!=2*Jt[15]-1?0:es})(b,E,z,re,ve,Ie)}function te(){this.value=this.g=0}function J(){this.value=this.g=0}function q(){this.G=c(5,te),this.H=l(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=c(Uo,J)}function V(b,E,z,re){e(b!=null),e(E!=null),e(2147483648>re),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=E,b.pa=z,b.Jd=E,b.Yc=z+re,b.Zc=4<=re?z+re-4+1:z,fe(b)}function F(b,E){for(var z=0;0<E--;)z|=de(b,128)<<E;return z}function I(b,E){var z=F(b,E);return pe(b)?-z:z}function ee(b,E,z,re){var ve,Ie=0;for(e(b!=null),e(E!=null),e(4294967288>re),b.Sb=re,b.Ra=0,b.u=0,b.h=0,4<re&&(re=4),ve=0;ve<re;++ve)Ie+=E[z+ve]<<8*ve;b.Ra=Ie,b.bb=re,b.oa=E,b.pa=z}function ae(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<El-8>>>0,++b.bb,b.u-=8;H(b)&&(b.h=1,b.u=0)}function T(b,E){if(e(0<=E),!b.h&&E<=da){var z=Q(b)&xa[E];return b.u+=E,ae(b),z}return b.h=1,b.u=0}function j(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Q(b){return b.Ra>>>(b.u&El-1)>>>0}function H(b){return e(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>El}function $(b,E){b.u=E,b.h=H(b)}function ie(b){b.u>=jl&&(e(b.u>=jl),ae(b))}function fe(b){e(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(e(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function pe(b){return F(b,1)}function de(b,E){var z=b.Ca;0>b.b&&fe(b);var re=b.b,ve=z*E>>>8,Ie=(b.I>>>re>ve)+0;for(Ie?(z-=ve,b.I-=ve+1<<re>>>0):z=ve+1,re=z,ve=0;256<=re;)ve+=8,re>>=8;return re=7^ve+co[re],b.b-=re,b.Ca=(z<<re)-1,Ie}function Re(b,E,z){b[E+0]=z>>24&255,b[E+1]=z>>16&255,b[E+2]=z>>8&255,b[E+3]=255&z}function X(b,E){return b[E+0]|b[E+1]<<8}function _e(b,E){return X(b,E)|b[E+2]<<16}function me(b,E){return X(b,E)|X(b,E+2)<<16}function Z(b,E){var z=1<<E;return e(b!=null),e(0<E),b.X=l(z),b.X==null?0:(b.Mb=32-E,b.Xa=E,1)}function le(b,E){e(b!=null),e(E!=null),e(b.Xa==E.Xa),r(E.X,0,b.X,0,1<<E.Xa)}function se(){this.X=[],this.Xa=this.Mb=0}function Ee(b,E,z,re){e(z!=null),e(re!=null);var ve=z[0],Ie=re[0];return ve==0&&(ve=(b*Ie+E/2)/E),Ie==0&&(Ie=(E*ve+b/2)/b),0>=ve||0>=Ie?0:(z[0]=ve,re[0]=Ie,1)}function Ne(b,E){return b+(1<<E)-1>>>E}function ye(b,E){return((4278255360&b)+(4278255360&E)>>>0&4278255360)+((16711935&b)+(16711935&E)>>>0&16711935)>>>0}function ne(b,E){O[E]=function(z,re,ve,Ie,we,Fe,Ge){var qe;for(qe=0;qe<we;++qe){var Nt=O[b](Fe[Ge+qe-1],ve,Ie+qe);Fe[Ge+qe]=ye(z[re+qe],Nt)}}}function ue(){this.ud=this.hd=this.jd=0}function xe(b,E){return((4278124286&(b^E))>>>1)+(b&E)>>>0}function et(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function bt(b,E){return et(b+(b-E+.5>>1))}function it(b,E,z){return Math.abs(E-z)-Math.abs(b-z)}function At(b,E,z,re,ve,Ie,we){for(re=Ie[we-1],z=0;z<ve;++z)Ie[we+z]=re=ye(b[E+z],re)}function at(b,E,z,re,ve){var Ie;for(Ie=0;Ie<z;++Ie){var we=b[E+Ie],Fe=we>>8&255,Ge=16711935&(Ge=(Ge=16711935&we)+((Fe<<16)+Fe));re[ve+Ie]=(4278255360&we)+Ge>>>0}}function We(b,E){E.jd=255&b,E.hd=b>>8&255,E.ud=b>>16&255}function Dt(b,E,z,re,ve,Ie){var we;for(we=0;we<re;++we){var Fe=E[z+we],Ge=Fe>>>8,qe=Fe,Nt=255&(Nt=(Nt=Fe>>>16)+((b.jd<<24>>24)*(Ge<<24>>24)>>>5));qe=255&(qe=(qe+=(b.hd<<24>>24)*(Ge<<24>>24)>>>5)+((b.ud<<24>>24)*(Nt<<24>>24)>>>5)),ve[Ie+we]=(4278255360&Fe)+(Nt<<16)+qe}}function Tt(b,E,z,re,ve){O[E]=function(Ie,we,Fe,Ge,qe,Nt,Wt,He,Et){for(Ge=Wt;Ge<He;++Ge)for(Wt=0;Wt<Et;++Wt)qe[Nt++]=ve(Fe[re(Ie[we++])])},O[b]=function(Ie,we,Fe,Ge,qe,Nt,Wt){var He=8>>Ie.b,Et=Ie.Ea,Pt=Ie.K[0],es=Ie.w;if(8>He)for(Ie=(1<<Ie.b)-1,es=(1<<He)-1;we<Fe;++we){var kt,Jt=0;for(kt=0;kt<Et;++kt)kt&Ie||(Jt=re(Ge[qe++])),Nt[Wt++]=ve(Pt[Jt&es]),Jt>>=He}else O["VP8LMapColor"+z](Ge,qe,Pt,es,Nt,Wt,we,Fe,Et)}}function St(b,E,z,re,ve){for(z=E+z;E<z;){var Ie=b[E++];re[ve++]=Ie>>16&255,re[ve++]=Ie>>8&255,re[ve++]=255&Ie}}function ze(b,E,z,re,ve){for(z=E+z;E<z;){var Ie=b[E++];re[ve++]=Ie>>16&255,re[ve++]=Ie>>8&255,re[ve++]=255&Ie,re[ve++]=Ie>>24&255}}function dt(b,E,z,re,ve){for(z=E+z;E<z;){var Ie=(we=b[E++])>>16&240|we>>12&15,we=240&we|we>>28&15;re[ve++]=Ie,re[ve++]=we}}function Ke(b,E,z,re,ve){for(z=E+z;E<z;){var Ie=(we=b[E++])>>16&248|we>>13&7,we=we>>5&224|we>>3&31;re[ve++]=Ie,re[ve++]=we}}function rt(b,E,z,re,ve){for(z=E+z;E<z;){var Ie=b[E++];re[ve++]=255&Ie,re[ve++]=Ie>>8&255,re[ve++]=Ie>>16&255}}function ft(b,E,z,re,ve,Ie){if(Ie==0)for(z=E+z;E<z;)Re(re,((Ie=b[E++])[0]>>24|Ie[1]>>8&65280|Ie[2]<<8&16711680|Ie[3]<<24)>>>0),ve+=32;else r(re,ve,b,E,z)}function Ot(b,E){O[E][0]=O[b+"0"],O[E][1]=O[b+"1"],O[E][2]=O[b+"2"],O[E][3]=O[b+"3"],O[E][4]=O[b+"4"],O[E][5]=O[b+"5"],O[E][6]=O[b+"6"],O[E][7]=O[b+"7"],O[E][8]=O[b+"8"],O[E][9]=O[b+"9"],O[E][10]=O[b+"10"],O[E][11]=O[b+"11"],O[E][12]=O[b+"12"],O[E][13]=O[b+"13"],O[E][14]=O[b+"0"],O[E][15]=O[b+"0"]}function mt(b){return b==Pu||b==$h||b==Cd||b==Hh}function Ze(){this.eb=[],this.size=this.A=this.fb=0}function De(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ye(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ze,this.f.kb=new De,this.sd=null}function Ce(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ge(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Be(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function ce(b,E){var z=b.T,re=E.ba.f.RGBA,ve=re.eb,Ie=re.fb+b.ka*re.A,we=Ai[E.ba.S],Fe=b.y,Ge=b.O,qe=b.f,Nt=b.N,Wt=b.ea,He=b.W,Et=E.cc,Pt=E.dc,es=E.Mc,kt=E.Nc,Jt=b.ka,is=b.ka+b.T,xs=b.U,fs=xs+1>>1;for(Jt==0?we(Fe,Ge,null,null,qe,Nt,Wt,He,qe,Nt,Wt,He,ve,Ie,null,null,xs):(we(E.ec,E.fc,Fe,Ge,Et,Pt,es,kt,qe,Nt,Wt,He,ve,Ie-re.A,ve,Ie,xs),++z);Jt+2<is;Jt+=2)Et=qe,Pt=Nt,es=Wt,kt=He,Nt+=b.Rc,He+=b.Rc,Ie+=2*re.A,we(Fe,(Ge+=2*b.fa)-b.fa,Fe,Ge,Et,Pt,es,kt,qe,Nt,Wt,He,ve,Ie-re.A,ve,Ie,xs);return Ge+=b.fa,b.j+is<b.o?(r(E.ec,E.fc,Fe,Ge,xs),r(E.cc,E.dc,qe,Nt,fs),r(E.Mc,E.Nc,Wt,He,fs),z--):1&is||we(Fe,Ge,null,null,qe,Nt,Wt,He,qe,Nt,Wt,He,ve,Ie+re.A,null,null,xs),z}function Le(b,E,z){var re=b.F,ve=[b.J];if(re!=null){var Ie=b.U,we=E.ba.S,Fe=we==wu||we==Cd;E=E.ba.f.RGBA;var Ge=[0],qe=b.ka;Ge[0]=b.T,b.Kb&&(qe==0?--Ge[0]:(--qe,ve[0]-=b.width),b.j+b.ka+b.T==b.o&&(Ge[0]=b.o-b.j-qe));var Nt=E.eb;qe=E.fb+qe*E.A,b=Iu(re,ve[0],b.width,Ie,Ge,Nt,qe+(Fe?0:3),E.A),e(z==Ge),b&&mt(we)&&yc(Nt,qe,Fe,Ie,Ge,E.A)}return 0}function Xe(b){var E=b.ma,z=E.ba.S,re=11>z,ve=z==Ji||z==Ga||z==wu||z==xd||z==12||mt(z);if(E.memory=null,E.Ib=null,E.Jb=null,E.Nd=null,!oo(E.Oa,b,ve?11:12))return 0;if(ve&&mt(z)&&Ru(),b.da)alert("todo:use_scaling");else{if(re){if(E.Ib=Be,b.Kb){if(z=b.U+1>>1,E.memory=l(b.U+2*z),E.memory==null)return 0;E.ec=E.memory,E.fc=0,E.cc=E.ec,E.dc=E.fc+b.U,E.Mc=E.cc,E.Nc=E.dc+z,E.Ib=ce,Ru()}}else alert("todo:EmitYUV");ve&&(E.Jb=Le,re&&gl())}if(re&&!Yo){for(b=0;256>b;++b)ki[b]=89858*(b-128)+Nd>>qa,Lx[b]=-22014*(b-128)+Nd,Bg[b]=-45773*(b-128),Zh[b]=113618*(b-128)+Nd>>qa;for(b=vc;b<Go;++b)E=76283*(b-16)+Nd>>qa,wx[b-vc]=ot(E,255),Px[b-vc]=ot(E+8>>4,15);Yo=1}return 1}function Pe(b){var E=b.ma,z=b.U,re=b.T;return e(!(1&b.ka)),0>=z||0>=re?0:(z=E.Ib(b,E),E.Jb!=null&&E.Jb(b,E,z),E.Dc+=z,1)}function Ct(b){b.ma.memory=null}function Me(b,E,z,re){return T(b,8)!=47?0:(E[0]=T(b,14)+1,z[0]=T(b,14)+1,re[0]=T(b,1),T(b,3)!=0?0:!b.h)}function lt(b,E){if(4>b)return b+1;var z=b-2>>1;return(2+(1&b)<<z)+T(E,z)+1}function ut(b,E){return 120<E?E-120:1<=(z=((z=Va[E-1])>>4)*b+(8-(15&z)))?z:1;var z}function jt(b,E,z){var re=Q(z),ve=b[E+=255&re].g-8;return 0<ve&&($(z,z.u+8),re=Q(z),E+=b[E].value,E+=re&(1<<ve)-1),$(z,z.u+b[E].g),b[E].value}function Ve(b,E,z){return z.g+=b.g,z.value+=b.value<<E>>>0,e(8>=z.g),b.g}function $t(b,E,z){var re=b.xc;return e((E=re==0?0:b.vc[b.md*(z>>re)+(E>>re)])<b.Wb),b.Ya[E]}function Ue(b,E,z,re){var ve=b.ab,Ie=b.c*E,we=b.C;E=we+E;var Fe=z,Ge=re;for(re=b.Ta,z=b.Ua;0<ve--;){var qe=b.gc[ve],Nt=we,Wt=E,He=Fe,Et=Ge,Pt=(Ge=re,Fe=z,qe.Ea);switch(e(Nt<Wt),e(Wt<=qe.nc),qe.hc){case 2:Zr(He,Et,(Wt-Nt)*Pt,Ge,Fe);break;case 0:var es=Nt,kt=Wt,Jt=Ge,is=Fe,xs=(Gs=qe).Ea;es==0&&(md(He,Et,null,null,1,Jt,is),At(He,Et+1,0,0,xs-1,Jt,is+1),Et+=xs,is+=xs,++es);for(var fs=1<<Gs.b,$s=fs-1,Bs=Ne(xs,Gs.b),mn=Gs.K,Gs=Gs.w+(es>>Gs.b)*Bs;es<kt;){var On=mn,Tr=Gs,Cn=1;for(gd(He,Et,Jt,is-xs,1,Jt,is);Cn<xs;){var Ws=(Cn&~$s)+fs;Ws>xs&&(Ws=xs),(0,uo[On[Tr++]>>8&15])(He,Et+ +Cn,Jt,is+Cn-xs,Ws-Cn,Jt,is+Cn),Cn=Ws}Et+=xs,is+=xs,++es&$s||(Gs+=Bs)}Wt!=qe.nc&&r(Ge,Fe-Pt,Ge,Fe+(Wt-Nt-1)*Pt,Pt);break;case 1:for(Pt=He,kt=Et,xs=(He=qe.Ea)-(is=He&~(Jt=(Et=1<<qe.b)-1)),es=Ne(He,qe.b),fs=qe.K,qe=qe.w+(Nt>>qe.b)*es;Nt<Wt;){for($s=fs,Bs=qe,mn=new ue,Gs=kt+is,On=kt+He;kt<Gs;)We($s[Bs++],mn),pd(mn,Pt,kt,Et,Ge,Fe),kt+=Et,Fe+=Et;kt<On&&(We($s[Bs++],mn),pd(mn,Pt,kt,xs,Ge,Fe),kt+=xs,Fe+=xs),++Nt&Jt||(qe+=es)}break;case 3:if(He==Ge&&Et==Fe&&0<qe.b){for(kt=Ge,He=Pt=Fe+(Wt-Nt)*Pt-(is=(Wt-Nt)*Ne(qe.Ea,qe.b)),Et=Ge,Jt=Fe,es=[],is=(xs=is)-1;0<=is;--is)es[is]=Et[Jt+is];for(is=xs-1;0<=is;--is)kt[He+is]=es[is];Kh(qe,Nt,Wt,Ge,Pt,Ge,Fe)}else Kh(qe,Nt,Wt,He,Et,Ge,Fe)}Fe=re,Ge=z}Ge!=z&&r(re,z,Fe,Ge,Ie)}function ss(b,E){var z=b.V,re=b.Ba+b.c*b.C,ve=E-b.C;if(e(E<=b.l.o),e(16>=ve),0<ve){var Ie=b.l,we=b.Ta,Fe=b.Ua,Ge=Ie.width;if(Ue(b,ve,z,re),ve=Fe=[Fe],e((z=b.C)<(re=E)),e(Ie.v<Ie.va),re>Ie.o&&(re=Ie.o),z<Ie.j){var qe=Ie.j-z;z=Ie.j,ve[0]+=qe*Ge}if(z>=re?z=0:(ve[0]+=4*Ie.v,Ie.ka=z-Ie.j,Ie.U=Ie.va-Ie.v,Ie.T=re-z,z=1),z){if(Fe=Fe[0],11>(z=b.ca).S){var Nt=z.f.RGBA,Wt=(re=z.S,ve=Ie.U,Ie=Ie.T,qe=Nt.eb,Nt.A),He=Ie;for(Nt=Nt.fb+b.Ma*Nt.A;0<He--;){var Et=we,Pt=Fe,es=ve,kt=qe,Jt=Nt;switch(re){case Yh:_d(Et,Pt,es,kt,Jt);break;case Ji:ho(Et,Pt,es,kt,Jt);break;case Pu:ho(Et,Pt,es,kt,Jt),yc(kt,Jt,0,es,1,0);break;case Vh:xc(Et,Pt,es,kt,Jt);break;case Ga:ft(Et,Pt,es,kt,Jt,1);break;case $h:ft(Et,Pt,es,kt,Jt,1),yc(kt,Jt,0,es,1,0);break;case wu:ft(Et,Pt,es,kt,Jt,0);break;case Cd:ft(Et,Pt,es,kt,Jt,0),yc(kt,Jt,1,es,1,0);break;case xd:fo(Et,Pt,es,kt,Jt);break;case Hh:fo(Et,Pt,es,kt,Jt),Qa(kt,Jt,es,1,0);break;case Bo:Ml(Et,Pt,es,kt,Jt);break;default:e(0)}Fe+=Ge,Nt+=Wt}b.Ma+=Ie}else alert("todo:EmitRescaledRowsYUVA");e(b.Ma<=z.height)}}b.C=E,e(b.C<=b.i)}function ls(b){var E;if(0<b.ua)return 0;for(E=0;E<b.Wb;++E){var z=b.Ya[E].G,re=b.Ya[E].H;if(0<z[1][re[1]+0].g||0<z[2][re[2]+0].g||0<z[3][re[3]+0].g)return 0}return 1}function ds(b,E,z,re,ve,Ie){if(b.Z!=0){var we=b.qd,Fe=b.rd;for(e(po[b.Z]!=null);E<z;++E)po[b.Z](we,Fe,re,ve,re,ve,Ie),we=re,Fe=ve,ve+=Ie;b.qd=we,b.rd=Fe}}function Ss(b,E){var z=b.l.ma,re=z.Z==0||z.Z==1?b.l.j:b.C;if(re=b.C<re?re:b.C,e(E<=b.l.o),E>re){var ve=b.l.width,Ie=z.ca,we=z.tb+ve*re,Fe=b.V,Ge=b.Ba+b.c*re,qe=b.gc;e(b.ab==1),e(qe[0].hc==3),Ol(qe[0],re,E,Fe,Ge,Ie,we),ds(z,re,E,Ie,we,ve)}b.C=b.Ma=E}function Ns(b,E,z,re,ve,Ie,we){var Fe=b.$/re,Ge=b.$%re,qe=b.m,Nt=b.s,Wt=z+b.$,He=Wt;ve=z+re*ve;var Et=z+re*Ie,Pt=280+Nt.ua,es=b.Pb?Fe:16777216,kt=0<Nt.ua?Nt.Wa:null,Jt=Nt.wc,is=Wt<Et?$t(Nt,Ge,Fe):null;e(b.C<Ie),e(Et<=ve);var xs=!1;e:for(;;){for(;xs||Wt<Et;){var fs=0;if(Fe>=es){var $s=Wt-z;e((es=b).Pb),es.wd=es.m,es.xd=$s,0<es.s.ua&&le(es.s.Wa,es.s.vb),es=Fe+Wo}if(Ge&Jt||(is=$t(Nt,Ge,Fe)),e(is!=null),is.Qb&&(E[Wt]=is.qb,xs=!0),!xs)if(ie(qe),is.jc){fs=qe,$s=E;var Bs=Wt,mn=is.pd[Q(fs)&Uo-1];e(is.jc),256>mn.g?($(fs,fs.u+mn.g),$s[Bs]=mn.value,fs=0):($(fs,fs.u+mn.g-256),e(256<=mn.value),fs=mn.value),fs==0&&(xs=!0)}else fs=jt(is.G[0],is.H[0],qe);if(qe.h)break;if(xs||256>fs){if(!xs)if(is.nd)E[Wt]=(is.qb|fs<<8)>>>0;else{if(ie(qe),xs=jt(is.G[1],is.H[1],qe),ie(qe),$s=jt(is.G[2],is.H[2],qe),Bs=jt(is.G[3],is.H[3],qe),qe.h)break;E[Wt]=(Bs<<24|xs<<16|fs<<8|$s)>>>0}if(xs=!1,++Wt,++Ge>=re&&(Ge=0,++Fe,we!=null&&Fe<=Ie&&!(Fe%16)&&we(b,Fe),kt!=null))for(;He<Wt;)fs=E[He++],kt.X[(506832829*fs&4294967295)>>>kt.Mb]=fs}else if(280>fs){if(fs=lt(fs-256,qe),$s=jt(is.G[4],is.H[4],qe),ie(qe),$s=ut(re,$s=lt($s,qe)),qe.h)break;if(Wt-z<$s||ve-Wt<fs)break e;for(Bs=0;Bs<fs;++Bs)E[Wt+Bs]=E[Wt+Bs-$s];for(Wt+=fs,Ge+=fs;Ge>=re;)Ge-=re,++Fe,we!=null&&Fe<=Ie&&!(Fe%16)&&we(b,Fe);if(e(Wt<=ve),Ge&Jt&&(is=$t(Nt,Ge,Fe)),kt!=null)for(;He<Wt;)fs=E[He++],kt.X[(506832829*fs&4294967295)>>>kt.Mb]=fs}else{if(!(fs<Pt))break e;for(xs=fs-280,e(kt!=null);He<Wt;)fs=E[He++],kt.X[(506832829*fs&4294967295)>>>kt.Mb]=fs;fs=Wt,e(!(xs>>>($s=kt).Xa)),E[fs]=$s.X[xs],xs=!0}xs||e(qe.h==H(qe))}if(b.Pb&&qe.h&&Wt<ve)e(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&le(b.s.vb,b.s.Wa);else{if(qe.h)break e;we!=null&&we(b,Fe>Ie?Ie:Fe),b.a=0,b.$=Wt-z}return 1}return b.a=3,0}function ke(b){e(b!=null),b.vc=null,b.yc=null,b.Ya=null;var E=b.Wa;E!=null&&(E.X=null),b.vb=null,e(b!=null)}function ct(){var b=new un;return b==null?null:(b.a=0,b.xb=Qf,Ot("Predictor","VP8LPredictors"),Ot("Predictor","VP8LPredictors_C"),Ot("PredictorAdd","VP8LPredictorsAdd"),Ot("PredictorAdd","VP8LPredictorsAdd_C"),Zr=at,pd=Dt,_d=St,ho=ze,fo=dt,Ml=Ke,xc=rt,O.VP8LMapColor32b=Il,O.VP8LMapColor8b=Li,b)}function st(b,E,z,re,ve){var Ie=1,we=[b],Fe=[E],Ge=re.m,qe=re.s,Nt=null,Wt=0;e:for(;;){if(z)for(;Ie&&T(Ge,1);){var He=we,Et=Fe,Pt=re,es=1,kt=Pt.m,Jt=Pt.gc[Pt.ab],is=T(kt,2);if(Pt.Oc&1<<is)Ie=0;else{switch(Pt.Oc|=1<<is,Jt.hc=is,Jt.Ea=He[0],Jt.nc=Et[0],Jt.K=[null],++Pt.ab,e(4>=Pt.ab),is){case 0:case 1:Jt.b=T(kt,3)+2,es=st(Ne(Jt.Ea,Jt.b),Ne(Jt.nc,Jt.b),0,Pt,Jt.K),Jt.K=Jt.K[0];break;case 3:var xs,fs=T(kt,8)+1,$s=16<fs?0:4<fs?1:2<fs?2:3;if(He[0]=Ne(Jt.Ea,$s),Jt.b=$s,xs=es=st(fs,1,0,Pt,Jt.K)){var Bs,mn=fs,Gs=Jt,On=1<<(8>>Gs.b),Tr=l(On);if(Tr==null)xs=0;else{var Cn=Gs.K[0],Ws=Gs.w;for(Tr[0]=Gs.K[0][0],Bs=1;Bs<1*mn;++Bs)Tr[Bs]=ye(Cn[Ws+Bs],Tr[Bs-1]);for(;Bs<4*On;++Bs)Tr[Bs]=0;Gs.K[0]=null,Gs.K[0]=Tr,xs=1}}es=xs;break;case 2:break;default:e(0)}Ie=es}}if(we=we[0],Fe=Fe[0],Ie&&T(Ge,1)&&!(Ie=1<=(Wt=T(Ge,4))&&11>=Wt)){re.a=3;break e}var Ts;if(Ts=Ie)t:{var Pr,on,Nn,rr=re,gi=we,Ui=Fe,yr=Wt,ii=z,Zi=rr.m,ai=rr.s,Tn=[null],Gn=1,Ar=0,qn=$a[yr];s:for(;;){if(ii&&T(Zi,1)){var pi=T(Zi,3)+2,kr=Ne(gi,pi),Yn=Ne(Ui,pi),si=kr*Yn;if(!st(kr,Yn,0,rr,Tn))break s;for(Tn=Tn[0],ai.xc=pi,Pr=0;Pr<si;++Pr){var ir=Tn[Pr]>>8&65535;Tn[Pr]=ir,ir>=Gn&&(Gn=ir+1)}}if(Zi.h)break s;for(on=0;5>on;++on){var li=Nc[on];!on&&0<yr&&(li+=1<<yr),Ar<li&&(Ar=li)}var oi=c(Gn*qn,te),hr=Gn,Fn=c(hr,q);if(Fn==null)var ea=null;else e(65536>=hr),ea=Fn;var Gr=l(Ar);if(ea==null||Gr==null||oi==null){rr.a=1;break s}var tn=oi;for(Pr=Nn=0;Pr<Gn;++Pr){var nn=ea[Pr],Vn=nn.G,Ca=nn.H,Xa=0,ha=1,ci=0;for(on=0;5>on;++on){li=Nc[on],Vn[on]=tn,Ca[on]=Nn,!on&&0<yr&&(li+=1<<yr);r:{var Vo,$o=li,t0=rr,br=Gr,Yf=tn,Vf=Nn,s0=0,_o=t0.m,Ax=T(_o,1);if(i(br,0,0,$o),Ax){var $f=T(_o,1)+1,Hf=T(_o,1),n0=T(_o,Hf==0?1:8);br[n0]=1,$f==2&&(br[n0=T(_o,8)]=1);var Di=1}else{var Yr=l(19),Bu=T(_o,4)+4;if(19<Bu){t0.a=3;var Ho=0;break r}for(Vo=0;Vo<Bu;++Vo)Yr[Au[Vo]]=T(_o,3);var vd=void 0,Dc=void 0,Pl=t0,r0=Yr,Dd=$o,i0=br,a0=0,xo=Pl.m,zf=8,qf=c(128,te);n:for(;Y(qf,0,7,r0,19);){if(T(xo,1)){var Wg=2+2*T(xo,3);if((vd=2+T(xo,Wg))>Dd)break n}else vd=Dd;for(Dc=0;Dc<Dd&&vd--;){ie(xo);var Xf=qf[0+(127&Q(xo))];$(xo,xo.u+Xf.g);var zo=Xf.value;if(16>zo)i0[Dc++]=zo,zo!=0&&(zf=zo);else{var Fg=zo==16,Kg=zo-16,Qg=yd[Kg],Jf=T(xo,Ya[Kg])+Qg;if(Dc+Jf>Dd)break n;for(var Gg=Fg?zf:0;0<Jf--;)i0[Dc++]=Gg}}a0=1;break n}a0||(Pl.a=3),Di=a0}(Di=Di&&!_o.h)&&(s0=Y(Yf,Vf,8,br,$o)),Di&&s0!=0?Ho=s0:(t0.a=3,Ho=0)}if(Ho==0)break s;if(ha&&zh[on]==1&&(ha=tn[Nn].g==0),Xa+=tn[Nn].g,Nn+=Ho,3>=on){var Rc,l0=Gr[0];for(Rc=1;Rc<li;++Rc)Gr[Rc]>l0&&(l0=Gr[Rc]);ci+=l0}}if(nn.nd=ha,nn.Qb=0,ha&&(nn.qb=(Vn[3][Ca[3]+0].value<<24|Vn[1][Ca[1]+0].value<<16|Vn[2][Ca[2]+0].value)>>>0,Xa==0&&256>Vn[0][Ca[0]+0].value&&(nn.Qb=1,nn.qb+=Vn[0][Ca[0]+0].value<<8)),nn.jc=!nn.Qb&&6>ci,nn.jc){var Wu,Al=nn;for(Wu=0;Wu<Uo;++Wu){var Co=Wu,yo=Al.pd[Co],o0=Al.G[0][Al.H[0]+Co];256<=o0.value?(yo.g=o0.g+256,yo.value=o0.value):(yo.g=0,yo.value=0,Co>>=Ve(o0,8,yo),Co>>=Ve(Al.G[1][Al.H[1]+Co],16,yo),Co>>=Ve(Al.G[2][Al.H[2]+Co],0,yo),Ve(Al.G[3][Al.H[3]+Co],24,yo))}}}ai.vc=Tn,ai.Wb=Gn,ai.Ya=ea,ai.yc=oi,Ts=1;break t}Ts=0}if(!(Ie=Ts)){re.a=3;break e}if(0<Wt){if(qe.ua=1<<Wt,!Z(qe.Wa,Wt)){re.a=1,Ie=0;break e}}else qe.ua=0;var c0=re,Tc=we,Yg=Fe,Rd=c0.s,Td=Rd.xc;if(c0.c=Tc,c0.i=Yg,Rd.md=Ne(Tc,Td),Rd.wc=Td==0?-1:(1<<Td)-1,z){re.xb=Fo;break e}if((Nt=l(we*Fe))==null){re.a=1,Ie=0;break e}Ie=(Ie=Ns(re,Nt,0,we,Fe,Fe,null))&&!Ge.h;break e}return Ie?(ve!=null?ve[0]=Nt:(e(Nt==null),e(z)),re.$=0,z||ke(qe)):ke(qe),Ie}function Kt(b,E){var z=b.c*b.i,re=z+E+16*E;return e(b.c<=E),b.V=l(re),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+z+E,1)}function ht(b,E){var z=b.C,re=E-z,ve=b.V,Ie=b.Ba+b.c*z;for(e(E<=b.l.o);0<re;){var we=16<re?16:re,Fe=b.l.ma,Ge=b.l.width,qe=Ge*we,Nt=Fe.ca,Wt=Fe.tb+Ge*z,He=b.Ta,Et=b.Ua;Ue(b,we,ve,Ie),Ia(He,Et,Nt,Wt,qe),ds(Fe,z,z+we,Nt,Wt,Ge),re-=we,ve+=we*b.c,z+=we}e(z==E),b.C=b.Ma=E}function qt(){this.ub=this.yd=this.td=this.Rb=0}function It(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function he(){this.Fb=this.Bb=this.Cb=0,this.Zb=l(4),this.Lb=l(4)}function be(){this.Yb=(function(){var b=[];return(function E(z,re,ve){for(var Ie=ve[re],we=0;we<Ie&&(z.push(ve.length>re+1?[]:0),!(ve.length<re+1));we++)E(z[we],re+1,ve)})(b,0,[3,11]),b})()}function Oe(){this.jb=l(3),this.Wc=d([4,8],be),this.Xc=d([4,17],be)}function je(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new l(4),this.od=new l(4)}function tt(){this.ld=this.La=this.dd=this.tc=0}function Te(){this.Na=this.la=0}function _t(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Qe(){this.ad=l(384),this.Za=0,this.Ob=l(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function yt(){this.uc=this.M=this.Nb=0,this.wa=Array(new tt),this.Y=0,this.ya=Array(new Qe),this.aa=0,this.l=new wt}function vt(){this.y=l(16),this.f=l(8),this.ea=l(8)}function $e(){this.cb=this.a=0,this.sc="",this.m=new j,this.Od=new qt,this.Kc=new It,this.ed=new je,this.Qa=new he,this.Ic=this.$c=this.Aa=0,this.D=new yt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=c(8,j),this.ia=0,this.pb=c(4,_t),this.Pa=new Oe,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new vt),this.Hd=0,this.rb=Array(new Te),this.sb=0,this.wa=Array(new tt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Qe),this.L=this.aa=0,this.gd=d([4,2],tt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ot(b,E){return 0>b?0:b>E?E:b}function wt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bt(){var b=new $e;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Oa||(Oa=Ut)),b}function Yt(b,E,z){return b.a==0&&(b.a=E,b.sc=z,b.cb=0),0}function Xt(b,E,z){return 3<=z&&b[E+0]==157&&b[E+1]==1&&b[E+2]==42}function ts(b,E){if(b==null)return 0;if(b.a=0,b.sc="OK",E==null)return Yt(b,2,"null VP8Io passed to VP8GetHeaders()");var z=E.data,re=E.w,ve=E.ha;if(4>ve)return Yt(b,7,"Truncated header.");var Ie=z[re+0]|z[re+1]<<8|z[re+2]<<16,we=b.Od;if(we.Rb=!(1&Ie),we.td=Ie>>1&7,we.yd=Ie>>4&1,we.ub=Ie>>5,3<we.td)return Yt(b,3,"Incorrect keyframe parameters.");if(!we.yd)return Yt(b,4,"Frame not displayable.");re+=3,ve-=3;var Fe=b.Kc;if(we.Rb){if(7>ve)return Yt(b,7,"cannot parse picture header");if(!Xt(z,re,ve))return Yt(b,3,"Bad code word");Fe.c=16383&(z[re+4]<<8|z[re+3]),Fe.Td=z[re+4]>>6,Fe.i=16383&(z[re+6]<<8|z[re+5]),Fe.Ud=z[re+6]>>6,re+=7,ve-=7,b.za=Fe.c+15>>4,b.Ub=Fe.i+15>>4,E.width=Fe.c,E.height=Fe.i,E.Da=0,E.j=0,E.v=0,E.va=E.width,E.o=E.height,E.da=0,E.ib=E.width,E.hb=E.height,E.U=E.width,E.T=E.height,i((Ie=b.Pa).jb,0,255,Ie.jb.length),e((Ie=b.Qa)!=null),Ie.Cb=0,Ie.Bb=0,Ie.Fb=1,i(Ie.Zb,0,0,Ie.Zb.length),i(Ie.Lb,0,0,Ie.Lb)}if(we.ub>ve)return Yt(b,7,"bad partition length");V(Ie=b.m,z,re,we.ub),re+=we.ub,ve-=we.ub,we.Rb&&(Fe.Ld=pe(Ie),Fe.Kd=pe(Ie)),Fe=b.Qa;var Ge,qe=b.Pa;if(e(Ie!=null),e(Fe!=null),Fe.Cb=pe(Ie),Fe.Cb){if(Fe.Bb=pe(Ie),pe(Ie)){for(Fe.Fb=pe(Ie),Ge=0;4>Ge;++Ge)Fe.Zb[Ge]=pe(Ie)?I(Ie,7):0;for(Ge=0;4>Ge;++Ge)Fe.Lb[Ge]=pe(Ie)?I(Ie,6):0}if(Fe.Bb)for(Ge=0;3>Ge;++Ge)qe.jb[Ge]=pe(Ie)?F(Ie,8):255}else Fe.Bb=0;if(Ie.Ka)return Yt(b,3,"cannot parse segment header");if((Fe=b.ed).zd=pe(Ie),Fe.Tb=F(Ie,6),Fe.wb=F(Ie,3),Fe.Pc=pe(Ie),Fe.Pc&&pe(Ie)){for(qe=0;4>qe;++qe)pe(Ie)&&(Fe.vd[qe]=I(Ie,6));for(qe=0;4>qe;++qe)pe(Ie)&&(Fe.od[qe]=I(Ie,6))}if(b.L=Fe.Tb==0?0:Fe.zd?1:2,Ie.Ka)return Yt(b,3,"cannot parse filter header");var Nt=ve;if(ve=Ge=re,re=Ge+Nt,Fe=Nt,b.Xb=(1<<F(b.m,2))-1,Nt<3*(qe=b.Xb))z=7;else{for(Ge+=3*qe,Fe-=3*qe,Nt=0;Nt<qe;++Nt){var Wt=z[ve+0]|z[ve+1]<<8|z[ve+2]<<16;Wt>Fe&&(Wt=Fe),V(b.Jc[+Nt],z,Ge,Wt),Ge+=Wt,Fe-=Wt,ve+=3}V(b.Jc[+qe],z,Ge,Fe),z=Ge<re?0:5}if(z!=0)return Yt(b,z,"cannot parse partitions");for(z=F(Ge=b.m,7),ve=pe(Ge)?I(Ge,4):0,re=pe(Ge)?I(Ge,4):0,Fe=pe(Ge)?I(Ge,4):0,qe=pe(Ge)?I(Ge,4):0,Ge=pe(Ge)?I(Ge,4):0,Nt=b.Qa,Wt=0;4>Wt;++Wt){if(Nt.Cb){var He=Nt.Zb[Wt];Nt.Fb||(He+=z)}else{if(0<Wt){b.pb[Wt]=b.pb[0];continue}He=z}var Et=b.pb[Wt];Et.Sc[0]=Ha[ot(He+ve,127)],Et.Sc[1]=za[ot(He+0,127)],Et.Eb[0]=2*Ha[ot(He+re,127)],Et.Eb[1]=101581*za[ot(He+Fe,127)]>>16,8>Et.Eb[1]&&(Et.Eb[1]=8),Et.Qc[0]=Ha[ot(He+qe,117)],Et.Qc[1]=za[ot(He+Ge,127)],Et.lc=He+Ge}if(!we.Rb)return Yt(b,4,"Not a key frame.");for(pe(Ie),we=b.Pa,z=0;4>z;++z){for(ve=0;8>ve;++ve)for(re=0;3>re;++re)for(Fe=0;11>Fe;++Fe)qe=de(Ie,Rr[z][ve][re][Fe])?F(Ie,8):Ug[z][ve][re][Fe],we.Wc[z][ve].Yb[re][Fe]=qe;for(ve=0;17>ve;++ve)we.Xc[z][ve]=we.Wc[z][Mn[ve]]}return b.kc=pe(Ie),b.kc&&(b.Bd=F(Ie,8)),b.cb=1}function Ut(b,E,z,re,ve,Ie,we){var Fe=E[ve].Yb[z];for(z=0;16>ve;++ve){if(!de(b,Fe[z+0]))return ve;for(;!de(b,Fe[z+1]);)if(Fe=E[++ve].Yb[0],z=0,ve==16)return 16;var Ge=E[ve+1].Yb;if(de(b,Fe[z+2])){var qe=b,Nt=0;if(de(qe,(He=Fe)[(Wt=z)+3]))if(de(qe,He[Wt+6])){for(Fe=0,Wt=2*(Nt=de(qe,He[Wt+8]))+(He=de(qe,He[Wt+9+Nt])),Nt=0,He=kg[Wt];He[Fe];++Fe)Nt+=Nt+de(qe,He[Fe]);Nt+=3+(8<<Wt)}else de(qe,He[Wt+7])?(Nt=7+2*de(qe,165),Nt+=de(qe,145)):Nt=5+de(qe,159);else Nt=de(qe,He[Wt+4])?3+de(qe,He[Wt+5]):2;Fe=Ge[2]}else Nt=1,Fe=Ge[1];Ge=we+Kf[ve],0>(qe=b).b&&fe(qe);var Wt,He=qe.b,Et=(Wt=qe.Ca>>1)-(qe.I>>He)>>31;--qe.b,qe.Ca+=Et,qe.Ca|=1,qe.I-=(Wt+1&Et)<<He,Ie[Ge]=((Nt^Et)-Et)*re[(0<ve)+0]}return 16}function Es(b){var E=b.rb[b.sb-1];E.la=0,E.Na=0,i(b.zc,0,0,b.zc.length),b.ja=0}function ys(b,E,z,re,ve){ve=b[E+z+32*re]+(ve>>3),b[E+z+32*re]=-256&ve?0>ve?0:255:ve}function Ps(b,E,z,re,ve,Ie){ys(b,E,0,z,re+ve),ys(b,E,1,z,re+Ie),ys(b,E,2,z,re-Ie),ys(b,E,3,z,re-ve)}function ps(b){return(20091*b>>16)+b}function vs(b,E,z,re){var ve,Ie=0,we=l(16);for(ve=0;4>ve;++ve){var Fe=b[E+0]+b[E+8],Ge=b[E+0]-b[E+8],qe=(35468*b[E+4]>>16)-ps(b[E+12]),Nt=ps(b[E+4])+(35468*b[E+12]>>16);we[Ie+0]=Fe+Nt,we[Ie+1]=Ge+qe,we[Ie+2]=Ge-qe,we[Ie+3]=Fe-Nt,Ie+=4,E++}for(ve=Ie=0;4>ve;++ve)Fe=(b=we[Ie+0]+4)+we[Ie+8],Ge=b-we[Ie+8],qe=(35468*we[Ie+4]>>16)-ps(we[Ie+12]),ys(z,re,0,0,Fe+(Nt=ps(we[Ie+4])+(35468*we[Ie+12]>>16))),ys(z,re,1,0,Ge+qe),ys(z,re,2,0,Ge-qe),ys(z,re,3,0,Fe-Nt),Ie++,re+=32}function Ms(b,E,z,re){var ve=b[E+0]+4,Ie=35468*b[E+4]>>16,we=ps(b[E+4]),Fe=35468*b[E+1]>>16;Ps(z,re,0,ve+we,b=ps(b[E+1]),Fe),Ps(z,re,1,ve+Ie,b,Fe),Ps(z,re,2,ve-Ie,b,Fe),Ps(z,re,3,ve-we,b,Fe)}function cs(b,E,z,re,ve){vs(b,E,z,re),ve&&vs(b,E+16,z,re+4)}function ms(b,E,z,re){mo(b,E+0,z,re,1),mo(b,E+32,z,re+128,1)}function Ks(b,E,z,re){var ve;for(b=b[E+0]+4,ve=0;4>ve;++ve)for(E=0;4>E;++E)ys(z,re,E,ve,b)}function Ls(b,E,z,re){b[E+0]&&zn(b,E+0,z,re),b[E+16]&&zn(b,E+16,z,re+4),b[E+32]&&zn(b,E+32,z,re+128),b[E+48]&&zn(b,E+48,z,re+128+4)}function nt(b,E,z,re){var ve,Ie=l(16);for(ve=0;4>ve;++ve){var we=b[E+0+ve]+b[E+12+ve],Fe=b[E+4+ve]+b[E+8+ve],Ge=b[E+4+ve]-b[E+8+ve],qe=b[E+0+ve]-b[E+12+ve];Ie[0+ve]=we+Fe,Ie[8+ve]=we-Fe,Ie[4+ve]=qe+Ge,Ie[12+ve]=qe-Ge}for(ve=0;4>ve;++ve)we=(b=Ie[0+4*ve]+3)+Ie[3+4*ve],Fe=Ie[1+4*ve]+Ie[2+4*ve],Ge=Ie[1+4*ve]-Ie[2+4*ve],qe=b-Ie[3+4*ve],z[re+0]=we+Fe>>3,z[re+16]=qe+Ge>>3,z[re+32]=we-Fe>>3,z[re+48]=qe-Ge>>3,re+=64}function Ft(b,E,z){var re,ve=E-32,Ie=Xi,we=255-b[ve-1];for(re=0;re<z;++re){var Fe,Ge=Ie,qe=we+b[E-1];for(Fe=0;Fe<z;++Fe)b[E+Fe]=Ge[qe+b[ve+Fe]];E+=32}}function Cs(b,E){Ft(b,E,4)}function Ht(b,E){Ft(b,E,8)}function Os(b,E){Ft(b,E,16)}function Zt(b,E){var z;for(z=0;16>z;++z)r(b,E+32*z,b,E-32,16)}function Ds(b,E){var z;for(z=16;0<z;--z)i(b,E,b[E-1],16),E+=32}function js(b,E,z){var re;for(re=0;16>re;++re)i(E,z+32*re,b,16)}function hs(b,E){var z,re=16;for(z=0;16>z;++z)re+=b[E-1+32*z]+b[E+z-32];js(re>>5,b,E)}function Us(b,E){var z,re=8;for(z=0;16>z;++z)re+=b[E-1+32*z];js(re>>4,b,E)}function Qs(b,E){var z,re=8;for(z=0;16>z;++z)re+=b[E+z-32];js(re>>4,b,E)}function Is(b,E){js(128,b,E)}function _s(b,E,z){return b+2*E+z+2>>2}function Lr(b,E){var z,re=E-32;for(re=new Uint8Array([_s(b[re-1],b[re+0],b[re+1]),_s(b[re+0],b[re+1],b[re+2]),_s(b[re+1],b[re+2],b[re+3]),_s(b[re+2],b[re+3],b[re+4])]),z=0;4>z;++z)r(b,E+32*z,re,0,re.length)}function Ir(b,E){var z=b[E-1],re=b[E-1+32],ve=b[E-1+64],Ie=b[E-1+96];Re(b,E+0,16843009*_s(b[E-1-32],z,re)),Re(b,E+32,16843009*_s(z,re,ve)),Re(b,E+64,16843009*_s(re,ve,Ie)),Re(b,E+96,16843009*_s(ve,Ie,Ie))}function qr(b,E){var z,re=4;for(z=0;4>z;++z)re+=b[E+z-32]+b[E-1+32*z];for(re>>=3,z=0;4>z;++z)i(b,E+32*z,re,4)}function vr(b,E){var z=b[E-1+0],re=b[E-1+32],ve=b[E-1+64],Ie=b[E-1-32],we=b[E+0-32],Fe=b[E+1-32],Ge=b[E+2-32],qe=b[E+3-32];b[E+0+96]=_s(re,ve,b[E-1+96]),b[E+1+96]=b[E+0+64]=_s(z,re,ve),b[E+2+96]=b[E+1+64]=b[E+0+32]=_s(Ie,z,re),b[E+3+96]=b[E+2+64]=b[E+1+32]=b[E+0+0]=_s(we,Ie,z),b[E+3+64]=b[E+2+32]=b[E+1+0]=_s(Fe,we,Ie),b[E+3+32]=b[E+2+0]=_s(Ge,Fe,we),b[E+3+0]=_s(qe,Ge,Fe)}function cn(b,E){var z=b[E+1-32],re=b[E+2-32],ve=b[E+3-32],Ie=b[E+4-32],we=b[E+5-32],Fe=b[E+6-32],Ge=b[E+7-32];b[E+0+0]=_s(b[E+0-32],z,re),b[E+1+0]=b[E+0+32]=_s(z,re,ve),b[E+2+0]=b[E+1+32]=b[E+0+64]=_s(re,ve,Ie),b[E+3+0]=b[E+2+32]=b[E+1+64]=b[E+0+96]=_s(ve,Ie,we),b[E+3+32]=b[E+2+64]=b[E+1+96]=_s(Ie,we,Fe),b[E+3+64]=b[E+2+96]=_s(we,Fe,Ge),b[E+3+96]=_s(Fe,Ge,Ge)}function cr(b,E){var z=b[E-1+0],re=b[E-1+32],ve=b[E-1+64],Ie=b[E-1-32],we=b[E+0-32],Fe=b[E+1-32],Ge=b[E+2-32],qe=b[E+3-32];b[E+0+0]=b[E+1+64]=Ie+we+1>>1,b[E+1+0]=b[E+2+64]=we+Fe+1>>1,b[E+2+0]=b[E+3+64]=Fe+Ge+1>>1,b[E+3+0]=Ge+qe+1>>1,b[E+0+96]=_s(ve,re,z),b[E+0+64]=_s(re,z,Ie),b[E+0+32]=b[E+1+96]=_s(z,Ie,we),b[E+1+32]=b[E+2+96]=_s(Ie,we,Fe),b[E+2+32]=b[E+3+96]=_s(we,Fe,Ge),b[E+3+32]=_s(Fe,Ge,qe)}function ni(b,E){var z=b[E+0-32],re=b[E+1-32],ve=b[E+2-32],Ie=b[E+3-32],we=b[E+4-32],Fe=b[E+5-32],Ge=b[E+6-32],qe=b[E+7-32];b[E+0+0]=z+re+1>>1,b[E+1+0]=b[E+0+64]=re+ve+1>>1,b[E+2+0]=b[E+1+64]=ve+Ie+1>>1,b[E+3+0]=b[E+2+64]=Ie+we+1>>1,b[E+0+32]=_s(z,re,ve),b[E+1+32]=b[E+0+96]=_s(re,ve,Ie),b[E+2+32]=b[E+1+96]=_s(ve,Ie,we),b[E+3+32]=b[E+2+96]=_s(Ie,we,Fe),b[E+3+64]=_s(we,Fe,Ge),b[E+3+96]=_s(Fe,Ge,qe)}function Fr(b,E){var z=b[E-1+0],re=b[E-1+32],ve=b[E-1+64],Ie=b[E-1+96];b[E+0+0]=z+re+1>>1,b[E+2+0]=b[E+0+32]=re+ve+1>>1,b[E+2+32]=b[E+0+64]=ve+Ie+1>>1,b[E+1+0]=_s(z,re,ve),b[E+3+0]=b[E+1+32]=_s(re,ve,Ie),b[E+3+32]=b[E+1+64]=_s(ve,Ie,Ie),b[E+3+64]=b[E+2+64]=b[E+0+96]=b[E+1+96]=b[E+2+96]=b[E+3+96]=Ie}function Hi(b,E){var z=b[E-1+0],re=b[E-1+32],ve=b[E-1+64],Ie=b[E-1+96],we=b[E-1-32],Fe=b[E+0-32],Ge=b[E+1-32],qe=b[E+2-32];b[E+0+0]=b[E+2+32]=z+we+1>>1,b[E+0+32]=b[E+2+64]=re+z+1>>1,b[E+0+64]=b[E+2+96]=ve+re+1>>1,b[E+0+96]=Ie+ve+1>>1,b[E+3+0]=_s(Fe,Ge,qe),b[E+2+0]=_s(we,Fe,Ge),b[E+1+0]=b[E+3+32]=_s(z,we,Fe),b[E+1+32]=b[E+3+64]=_s(re,z,we),b[E+1+64]=b[E+3+96]=_s(ve,re,z),b[E+1+96]=_s(Ie,ve,re)}function Or(b,E){var z;for(z=0;8>z;++z)r(b,E+32*z,b,E-32,8)}function zi(b,E){var z;for(z=0;8>z;++z)i(b,E,b[E-1],8),E+=32}function Dr(b,E,z){var re;for(re=0;8>re;++re)i(E,z+32*re,b,8)}function Ta(b,E){var z,re=8;for(z=0;8>z;++z)re+=b[E+z-32]+b[E-1+32*z];Dr(re>>4,b,E)}function Fa(b,E){var z,re=4;for(z=0;8>z;++z)re+=b[E+z-32];Dr(re>>3,b,E)}function Rs(b,E){var z,re=4;for(z=0;8>z;++z)re+=b[E-1+32*z];Dr(re>>3,b,E)}function Pn(b,E){Dr(128,b,E)}function Qn(b,E,z){var re=b[E-z],ve=b[E+0],Ie=3*(ve-re)+go[1020+b[E-2*z]-b[E+z]],we=Lu[112+(Ie+4>>3)];b[E-z]=Xi[255+re+Lu[112+(Ie+3>>3)]],b[E+0]=Xi[255+ve-we]}function Xr(b,E,z,re){var ve=b[E+0],Ie=b[E+z];return wi[255+b[E-2*z]-b[E-z]]>re||wi[255+Ie-ve]>re}function Ni(b,E,z,re){return 4*wi[255+b[E-z]-b[E+0]]+wi[255+b[E-2*z]-b[E+z]]<=re}function so(b,E,z,re,ve){var Ie=b[E-3*z],we=b[E-2*z],Fe=b[E-z],Ge=b[E+0],qe=b[E+z],Nt=b[E+2*z],Wt=b[E+3*z];return 4*wi[255+Fe-Ge]+wi[255+we-qe]>re?0:wi[255+b[E-4*z]-Ie]<=ve&&wi[255+Ie-we]<=ve&&wi[255+we-Fe]<=ve&&wi[255+Wt-Nt]<=ve&&wi[255+Nt-qe]<=ve&&wi[255+qe-Ge]<=ve}function ml(b,E,z,re){var ve=2*re+1;for(re=0;16>re;++re)Ni(b,E+re,z,ve)&&Qn(b,E+re,z)}function ws(b,E,z,re){var ve=2*re+1;for(re=0;16>re;++re)Ni(b,E+re*z,1,ve)&&Qn(b,E+re*z,1)}function Hn(b,E,z,re){var ve;for(ve=3;0<ve;--ve)ml(b,E+=4*z,z,re)}function Kr(b,E,z,re){var ve;for(ve=3;0<ve;--ve)ws(b,E+=4,z,re)}function Si(b,E,z,re,ve,Ie,we,Fe){for(Ie=2*Ie+1;0<ve--;){if(so(b,E,z,Ie,we))if(Xr(b,E,z,Fe))Qn(b,E,z);else{var Ge=b,qe=E,Nt=z,Wt=Ge[qe-2*Nt],He=Ge[qe-Nt],Et=Ge[qe+0],Pt=Ge[qe+Nt],es=Ge[qe+2*Nt],kt=27*(is=go[1020+3*(Et-He)+go[1020+Wt-Pt]])+63>>7,Jt=18*is+63>>7,is=9*is+63>>7;Ge[qe-3*Nt]=Xi[255+Ge[qe-3*Nt]+is],Ge[qe-2*Nt]=Xi[255+Wt+Jt],Ge[qe-Nt]=Xi[255+He+kt],Ge[qe+0]=Xi[255+Et-kt],Ge[qe+Nt]=Xi[255+Pt-Jt],Ge[qe+2*Nt]=Xi[255+es-is]}E+=re}}function Oi(b,E,z,re,ve,Ie,we,Fe){for(Ie=2*Ie+1;0<ve--;){if(so(b,E,z,Ie,we))if(Xr(b,E,z,Fe))Qn(b,E,z);else{var Ge=b,qe=E,Nt=z,Wt=Ge[qe-Nt],He=Ge[qe+0],Et=Ge[qe+Nt],Pt=Lu[112+(4+(es=3*(He-Wt))>>3)],es=Lu[112+(es+3>>3)],kt=Pt+1>>1;Ge[qe-2*Nt]=Xi[255+Ge[qe-2*Nt]+kt],Ge[qe-Nt]=Xi[255+Wt+es],Ge[qe+0]=Xi[255+He-Pt],Ge[qe+Nt]=Xi[255+Et-kt]}E+=re}}function Wh(b,E,z,re,ve,Ie){Si(b,E,z,1,16,re,ve,Ie)}function no(b,E,z,re,ve,Ie){Si(b,E,1,z,16,re,ve,Ie)}function Fh(b,E,z,re,ve,Ie){var we;for(we=3;0<we;--we)Oi(b,E+=4*z,z,1,16,re,ve,Ie)}function W(b,E,z,re,ve,Ie){var we;for(we=3;0<we;--we)Oi(b,E+=4,1,z,16,re,ve,Ie)}function Se(b,E,z,re,ve,Ie,we,Fe){Si(b,E,ve,1,8,Ie,we,Fe),Si(z,re,ve,1,8,Ie,we,Fe)}function Je(b,E,z,re,ve,Ie,we,Fe){Si(b,E,1,ve,8,Ie,we,Fe),Si(z,re,1,ve,8,Ie,we,Fe)}function xt(b,E,z,re,ve,Ie,we,Fe){Oi(b,E+4*ve,ve,1,8,Ie,we,Fe),Oi(z,re+4*ve,ve,1,8,Ie,we,Fe)}function Mt(b,E,z,re,ve,Ie,we,Fe){Oi(b,E+4,1,ve,8,Ie,we,Fe),Oi(z,re+4,1,ve,8,Ie,we,Fe)}function rs(){this.ba=new Ye,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ge,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ys(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Xs(){this.ua=0,this.Wa=new se,this.vb=new se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new te}function un(){this.xb=this.a=0,this.l=new wt,this.ca=new Ye,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Xs,this.ab=0,this.gc=c(4,Ys),this.Oc=0}function xn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new wt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Bn(b,E,z,re,ve,Ie,we){for(b=b==null?0:b[E+0],E=0;E<we;++E)ve[Ie+E]=b+z[re+E]&255,b=ve[Ie+E]}function wr(b,E,z,re,ve,Ie,we){var Fe;if(b==null)Bn(null,null,z,re,ve,Ie,we);else for(Fe=0;Fe<we;++Fe)ve[Ie+Fe]=b[E+Fe]+z[re+Fe]&255}function Jr(b,E,z,re,ve,Ie,we){if(b==null)Bn(null,null,z,re,ve,Ie,we);else{var Fe,Ge=b[E+0],qe=Ge,Nt=Ge;for(Fe=0;Fe<we;++Fe)qe=Nt+(Ge=b[E+Fe])-qe,Nt=z[re+Fe]+(-256&qe?0>qe?0:255:qe)&255,qe=Ge,ve[Ie+Fe]=Nt}}function xr(b,E,z,re){var ve=E.width,Ie=E.o;if(e(b!=null&&E!=null),0>z||0>=re||z+re>Ie)return null;if(!b.Cc){if(b.ga==null){var we;if(b.ga=new xn,(we=b.ga==null)||(we=E.width*E.o,e(b.Gb.length==0),b.Gb=l(we),b.Uc=0,b.Gb==null?we=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,we=1),we=!we),!we){we=b.ga;var Fe=b.Fa,Ge=b.P,qe=b.qc,Nt=b.mb,Wt=b.nb,He=Ge+1,Et=qe-1,Pt=we.l;if(e(Fe!=null&&Nt!=null&&E!=null),po[0]=null,po[1]=Bn,po[2]=wr,po[3]=Jr,we.ca=Nt,we.tb=Wt,we.c=E.width,we.i=E.height,e(0<we.c&&0<we.i),1>=qe)E=0;else if(we.$a=3&Fe[Ge+0],we.Z=Fe[Ge+0]>>2&3,we.Lc=Fe[Ge+0]>>4&3,Ge=Fe[Ge+0]>>6&3,0>we.$a||1<we.$a||4<=we.Z||1<we.Lc||Ge)E=0;else if(Pt.put=Pe,Pt.ac=Xe,Pt.bc=Ct,Pt.ma=we,Pt.width=E.width,Pt.height=E.height,Pt.Da=E.Da,Pt.v=E.v,Pt.va=E.va,Pt.j=E.j,Pt.o=E.o,we.$a)e:{e(we.$a==1),E=ct();t:for(;;){if(E==null){E=0;break e}if(e(we!=null),we.mc=E,E.c=we.c,E.i=we.i,E.l=we.l,E.l.ma=we,E.l.width=we.c,E.l.height=we.i,E.a=0,ee(E.m,Fe,He,Et),!st(we.c,we.i,1,E,null)||(E.ab==1&&E.gc[0].hc==3&&ls(E.s)?(we.ic=1,Fe=E.c*E.i,E.Ta=null,E.Ua=0,E.V=l(Fe),E.Ba=0,E.V==null?(E.a=1,E=0):E=1):(we.ic=0,E=Kt(E,we.c)),!E))break t;E=1;break e}we.mc=null,E=0}else E=Et>=we.c*we.i;we=!E}if(we)return null;b.ga.Lc!=1?b.Ga=0:re=Ie-z}e(b.ga!=null),e(z+re<=Ie);e:{if(E=(Fe=b.ga).c,Ie=Fe.l.o,Fe.$a==0){if(He=b.rc,Et=b.Vc,Pt=b.Fa,Ge=b.P+1+z*E,qe=b.mb,Nt=b.nb+z*E,e(Ge<=b.P+b.qc),Fe.Z!=0)for(e(po[Fe.Z]!=null),we=0;we<re;++we)po[Fe.Z](He,Et,Pt,Ge,qe,Nt,E),He=qe,Et=Nt,Nt+=E,Ge+=E;else for(we=0;we<re;++we)r(qe,Nt,Pt,Ge,E),He=qe,Et=Nt,Nt+=E,Ge+=E;b.rc=He,b.Vc=Et}else{if(e(Fe.mc!=null),E=z+re,e((we=Fe.mc)!=null),e(E<=we.i),we.C>=E)E=1;else if(Fe.ic||gl(),Fe.ic){Fe=we.V,He=we.Ba,Et=we.c;var es=we.i,kt=(Pt=1,Ge=we.$/Et,qe=we.$%Et,Nt=we.m,Wt=we.s,we.$),Jt=Et*es,is=Et*E,xs=Wt.wc,fs=kt<is?$t(Wt,qe,Ge):null;e(kt<=Jt),e(E<=es),e(ls(Wt));t:for(;;){for(;!Nt.h&&kt<is;){if(qe&xs||(fs=$t(Wt,qe,Ge)),e(fs!=null),ie(Nt),256>(es=jt(fs.G[0],fs.H[0],Nt)))Fe[He+kt]=es,++kt,++qe>=Et&&(qe=0,++Ge<=E&&!(Ge%16)&&Ss(we,Ge));else{if(!(280>es)){Pt=0;break t}es=lt(es-256,Nt);var $s,Bs=jt(fs.G[4],fs.H[4],Nt);if(ie(Nt),!(kt>=(Bs=ut(Et,Bs=lt(Bs,Nt)))&&Jt-kt>=es)){Pt=0;break t}for($s=0;$s<es;++$s)Fe[He+kt+$s]=Fe[He+kt+$s-Bs];for(kt+=es,qe+=es;qe>=Et;)qe-=Et,++Ge<=E&&!(Ge%16)&&Ss(we,Ge);kt<is&&qe&xs&&(fs=$t(Wt,qe,Ge))}e(Nt.h==H(Nt))}Ss(we,Ge>E?E:Ge);break t}!Pt||Nt.h&&kt<Jt?(Pt=0,we.a=Nt.h?5:3):we.$=kt,E=Pt}else E=Ns(we,we.V,we.Ba,we.c,we.i,E,ht);if(!E){re=0;break e}}z+re>=Ie&&(b.Cc=1),re=1}if(!re)return null;if(b.Cc&&((re=b.ga)!=null&&(re.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+z*ve}function mi(b,E,z,re,ve,Ie){for(;0<ve--;){var we,Fe=b,Ge=E+(z?1:0),qe=b,Nt=E+(z?0:3);for(we=0;we<re;++we){var Wt=qe[Nt+4*we];Wt!=255&&(Wt*=32897,Fe[Ge+4*we+0]=Fe[Ge+4*we+0]*Wt>>23,Fe[Ge+4*we+1]=Fe[Ge+4*we+1]*Wt>>23,Fe[Ge+4*we+2]=Fe[Ge+4*we+2]*Wt>>23)}E+=Ie}}function ri(b,E,z,re,ve){for(;0<re--;){var Ie;for(Ie=0;Ie<z;++Ie){var we=b[E+2*Ie+0],Fe=15&(qe=b[E+2*Ie+1]),Ge=4369*Fe,qe=(240&qe|qe>>4)*Ge>>16;b[E+2*Ie+0]=(240&we|we>>4)*Ge>>16&240|(15&we|we<<4)*Ge>>16>>4&15,b[E+2*Ie+1]=240&qe|Fe}E+=ve}}function Mi(b,E,z,re,ve,Ie,we,Fe){var Ge,qe,Nt=255;for(qe=0;qe<ve;++qe){for(Ge=0;Ge<re;++Ge){var Wt=b[E+Ge];Ie[we+4*Ge]=Wt,Nt&=Wt}E+=z,we+=Fe}return Nt!=255}function ro(b,E,z,re,ve){var Ie;for(Ie=0;Ie<ve;++Ie)z[re+Ie]=b[E+Ie]>>8}function gl(){yc=mi,Qa=ri,Iu=Mi,Ia=ro}function io(b,E,z){O[b]=function(re,ve,Ie,we,Fe,Ge,qe,Nt,Wt,He,Et,Pt,es,kt,Jt,is,xs){var fs,$s=xs-1>>1,Bs=Fe[Ge+0]|qe[Nt+0]<<16,mn=Wt[He+0]|Et[Pt+0]<<16;e(re!=null);var Gs=3*Bs+mn+131074>>2;for(E(re[ve+0],255&Gs,Gs>>16,es,kt),Ie!=null&&(Gs=3*mn+Bs+131074>>2,E(Ie[we+0],255&Gs,Gs>>16,Jt,is)),fs=1;fs<=$s;++fs){var On=Fe[Ge+fs]|qe[Nt+fs]<<16,Tr=Wt[He+fs]|Et[Pt+fs]<<16,Cn=Bs+On+mn+Tr+524296,Ws=Cn+2*(On+mn)>>3;Gs=Ws+Bs>>1,Bs=(Cn=Cn+2*(Bs+Tr)>>3)+On>>1,E(re[ve+2*fs-1],255&Gs,Gs>>16,es,kt+(2*fs-1)*z),E(re[ve+2*fs-0],255&Bs,Bs>>16,es,kt+(2*fs-0)*z),Ie!=null&&(Gs=Cn+mn>>1,Bs=Ws+Tr>>1,E(Ie[we+2*fs-1],255&Gs,Gs>>16,Jt,is+(2*fs-1)*z),E(Ie[we+2*fs+0],255&Bs,Bs>>16,Jt,is+(2*fs+0)*z)),Bs=On,mn=Tr}1&xs||(Gs=3*Bs+mn+131074>>2,E(re[ve+xs-1],255&Gs,Gs>>16,es,kt+(xs-1)*z),Ie!=null&&(Gs=3*mn+Bs+131074>>2,E(Ie[we+xs-1],255&Gs,Gs>>16,Jt,is+(xs-1)*z)))}}function Ru(){Ai[Yh]=Sc,Ai[Ji]=bd,Ai[Vh]=Gf,Ai[Ga]=Xh,Ai[wu]=Ko,Ai[xd]=wl,Ai[Bo]=Qo,Ai[Pu]=bd,Ai[$h]=Xh,Ai[Cd]=Ko,Ai[Hh]=wl}function ud(b){return b&-16384?0>b?0:255:b>>Jh}function Rl(b,E){return ud((19077*b>>8)+(26149*E>>8)-14234)}function pl(b,E,z){return ud((19077*b>>8)-(6419*E>>8)-(13320*z>>8)+8708)}function _c(b,E){return ud((19077*b>>8)+(33050*E>>8)-17685)}function ao(b,E,z,re,ve){re[ve+0]=Rl(b,z),re[ve+1]=pl(b,E,z),re[ve+2]=_c(b,E)}function vi(b,E,z,re,ve){re[ve+0]=_c(b,E),re[ve+1]=pl(b,E,z),re[ve+2]=Rl(b,z)}function Ao(b,E,z,re,ve){var Ie=pl(b,E,z);E=Ie<<3&224|_c(b,E)>>3,re[ve+0]=248&Rl(b,z)|Ie>>5,re[ve+1]=E}function ko(b,E,z,re,ve){var Ie=240&_c(b,E)|15;re[ve+0]=240&Rl(b,z)|pl(b,E,z)>>4,re[ve+1]=Ie}function hd(b,E,z,re,ve){re[ve+0]=255,ao(b,E,z,re,ve+1)}function Tl(b,E,z,re,ve){vi(b,E,z,re,ve),re[ve+3]=255}function ca(b,E,z,re,ve){ao(b,E,z,re,ve),re[ve+3]=255}function lo(b,E,z){O[b]=function(re,ve,Ie,we,Fe,Ge,qe,Nt,Wt){for(var He=Nt+(-2&Wt)*z;Nt!=He;)E(re[ve+0],Ie[we+0],Fe[Ge+0],qe,Nt),E(re[ve+1],Ie[we+0],Fe[Ge+0],qe,Nt+z),ve+=2,++we,++Ge,Nt+=2*z;1&Wt&&E(re[ve+0],Ie[we+0],Fe[Ge+0],qe,Nt)}}function fd(b,E,z){return z==0?b==0?E==0?6:5:E==0?4:0:z}function Tu(b,E,z,re,ve){switch(b>>>30){case 3:mo(E,z,re,ve,0);break;case 2:qi(E,z,re,ve);break;case 1:zn(E,z,re,ve)}}function Ea(b,E){var z,re,ve=E.M,Ie=E.Nb,we=b.oc,Fe=b.pc+40,Ge=b.oc,qe=b.pc+584,Nt=b.oc,Wt=b.pc+600;for(z=0;16>z;++z)we[Fe+32*z-1]=129;for(z=0;8>z;++z)Ge[qe+32*z-1]=129,Nt[Wt+32*z-1]=129;for(0<ve?we[Fe-1-32]=Ge[qe-1-32]=Nt[Wt-1-32]=129:(i(we,Fe-32-1,127,21),i(Ge,qe-32-1,127,9),i(Nt,Wt-32-1,127,9)),re=0;re<b.za;++re){var He=E.ya[E.aa+re];if(0<re){for(z=-1;16>z;++z)r(we,Fe+32*z-4,we,Fe+32*z+12,4);for(z=-1;8>z;++z)r(Ge,qe+32*z-4,Ge,qe+32*z+4,4),r(Nt,Wt+32*z-4,Nt,Wt+32*z+4,4)}var Et=b.Gd,Pt=b.Hd+re,es=He.ad,kt=He.Hc;if(0<ve&&(r(we,Fe-32,Et[Pt].y,0,16),r(Ge,qe-32,Et[Pt].f,0,8),r(Nt,Wt-32,Et[Pt].ea,0,8)),He.Za){var Jt=we,is=Fe-32+16;for(0<ve&&(re>=b.za-1?i(Jt,is,Et[Pt].y[15],4):r(Jt,is,Et[Pt+1].y,0,4)),z=0;4>z;z++)Jt[is+128+z]=Jt[is+256+z]=Jt[is+384+z]=Jt[is+0+z];for(z=0;16>z;++z,kt<<=2)Jt=we,is=Fe+ti[z],Qr[He.Ob[z]](Jt,is),Tu(kt,es,16*+z,Jt,is)}else if(Jt=fd(re,ve,He.Ob[0]),ua[Jt](we,Fe),kt!=0)for(z=0;16>z;++z,kt<<=2)Tu(kt,es,16*+z,we,Fe+ti[z]);for(z=He.Gc,Jt=fd(re,ve,He.Dd),yl[Jt](Ge,qe),yl[Jt](Nt,Wt),kt=es,Jt=Ge,is=qe,255&(He=0|z)&&(170&He?Ka(kt,256,Jt,is):Wn(kt,256,Jt,is)),He=Nt,kt=Wt,255&(z>>=8)&&(170&z?Ka(es,320,He,kt):Wn(es,320,He,kt)),ve<b.Ub-1&&(r(Et[Pt].y,0,we,Fe+480,16),r(Et[Pt].f,0,Ge,qe+224,8),r(Et[Pt].ea,0,Nt,Wt+224,8)),z=8*Ie*b.B,Et=b.sa,Pt=b.ta+16*re+16*Ie*b.R,es=b.qa,He=b.ra+8*re+z,kt=b.Ha,Jt=b.Ia+8*re+z,z=0;16>z;++z)r(Et,Pt+z*b.R,we,Fe+32*z,16);for(z=0;8>z;++z)r(es,He+z*b.B,Ge,qe+32*z,8),r(kt,Jt+z*b.B,Nt,Wt+32*z,8)}}function _l(b,E,z,re,ve,Ie,we,Fe,Ge){var qe=[0],Nt=[0],Wt=0,He=Ge!=null?Ge.kd:0,Et=Ge??new gs;if(b==null||12>z)return 7;Et.data=b,Et.w=E,Et.ha=z,E=[E],z=[z],Et.gb=[Et.gb];e:{var Pt=E,es=z,kt=Et.gb;if(e(b!=null),e(es!=null),e(kt!=null),kt[0]=0,12<=es[0]&&!n(b,Pt[0],"RIFF")){if(n(b,Pt[0]+8,"WEBP")){kt=3;break e}var Jt=me(b,Pt[0]+4);if(12>Jt||4294967286<Jt){kt=3;break e}if(He&&Jt>es[0]-8){kt=7;break e}kt[0]=Jt,Pt[0]+=12,es[0]-=12}kt=0}if(kt!=0)return kt;for(Jt=0<Et.gb[0],z=z[0];;){e:{var is=b;es=E,kt=z;var xs=qe,fs=Nt,$s=Pt=[0];if((Gs=Wt=[Wt])[0]=0,8>kt[0])kt=7;else{if(!n(is,es[0],"VP8X")){if(me(is,es[0]+4)!=10){kt=3;break e}if(18>kt[0]){kt=7;break e}var Bs=me(is,es[0]+8),mn=1+_e(is,es[0]+12);if(2147483648<=mn*(is=1+_e(is,es[0]+15))){kt=3;break e}$s!=null&&($s[0]=Bs),xs!=null&&(xs[0]=mn),fs!=null&&(fs[0]=is),es[0]+=18,kt[0]-=18,Gs[0]=1}kt=0}}if(Wt=Wt[0],Pt=Pt[0],kt!=0)return kt;if(es=!!(2&Pt),!Jt&&Wt)return 3;if(Ie!=null&&(Ie[0]=!!(16&Pt)),we!=null&&(we[0]=es),Fe!=null&&(Fe[0]=0),we=qe[0],Pt=Nt[0],Wt&&es&&Ge==null){kt=0;break}if(4>z){kt=7;break}if(Jt&&Wt||!Jt&&!Wt&&!n(b,E[0],"ALPH")){z=[z],Et.na=[Et.na],Et.P=[Et.P],Et.Sa=[Et.Sa];e:{Bs=b,kt=E,Jt=z;var Gs=Et.gb;xs=Et.na,fs=Et.P,$s=Et.Sa,mn=22,e(Bs!=null),e(Jt!=null),is=kt[0];var On=Jt[0];for(e(xs!=null),e($s!=null),xs[0]=null,fs[0]=null,$s[0]=0;;){if(kt[0]=is,Jt[0]=On,8>On){kt=7;break e}var Tr=me(Bs,is+4);if(4294967286<Tr){kt=3;break e}var Cn=8+Tr+1&-2;if(mn+=Cn,0<Gs&&mn>Gs){kt=3;break e}if(!n(Bs,is,"VP8 ")||!n(Bs,is,"VP8L")){kt=0;break e}if(On[0]<Cn){kt=7;break e}n(Bs,is,"ALPH")||(xs[0]=Bs,fs[0]=is+8,$s[0]=Tr),is+=Cn,On-=Cn}}if(z=z[0],Et.na=Et.na[0],Et.P=Et.P[0],Et.Sa=Et.Sa[0],kt!=0)break}z=[z],Et.Ja=[Et.Ja],Et.xa=[Et.xa];e:if(Gs=b,kt=E,Jt=z,xs=Et.gb[0],fs=Et.Ja,$s=Et.xa,Bs=kt[0],is=!n(Gs,Bs,"VP8 "),mn=!n(Gs,Bs,"VP8L"),e(Gs!=null),e(Jt!=null),e(fs!=null),e($s!=null),8>Jt[0])kt=7;else{if(is||mn){if(Gs=me(Gs,Bs+4),12<=xs&&Gs>xs-12){kt=3;break e}if(He&&Gs>Jt[0]-8){kt=7;break e}fs[0]=Gs,kt[0]+=8,Jt[0]-=8,$s[0]=mn}else $s[0]=5<=Jt[0]&&Gs[Bs+0]==47&&!(Gs[Bs+4]>>5),fs[0]=Jt[0];kt=0}if(z=z[0],Et.Ja=Et.Ja[0],Et.xa=Et.xa[0],E=E[0],kt!=0)break;if(4294967286<Et.Ja)return 3;if(Fe==null||es||(Fe[0]=Et.xa?2:1),we=[we],Pt=[Pt],Et.xa){if(5>z){kt=7;break}Fe=we,He=Pt,es=Ie,b==null||5>z?b=0:5<=z&&b[E+0]==47&&!(b[E+4]>>5)?(Jt=[0],Gs=[0],xs=[0],ee(fs=new k,b,E,z),Me(fs,Jt,Gs,xs)?(Fe!=null&&(Fe[0]=Jt[0]),He!=null&&(He[0]=Gs[0]),es!=null&&(es[0]=xs[0]),b=1):b=0):b=0}else{if(10>z){kt=7;break}Fe=Pt,b==null||10>z||!Xt(b,E+3,z-3)?b=0:(He=b[E+0]|b[E+1]<<8|b[E+2]<<16,es=16383&(b[E+7]<<8|b[E+6]),b=16383&(b[E+9]<<8|b[E+8]),1&He||3<(He>>1&7)||!(He>>4&1)||He>>5>=Et.Ja||!es||!b?b=0:(we&&(we[0]=es),Fe&&(Fe[0]=b),b=1))}if(!b||(we=we[0],Pt=Pt[0],Wt&&(qe[0]!=we||Nt[0]!=Pt)))return 3;Ge!=null&&(Ge[0]=Et,Ge.offset=E-Ge.w,e(4294967286>E-Ge.w),e(Ge.offset==Ge.ha-z));break}return kt==0||kt==7&&Wt&&Ge==null?(Ie!=null&&(Ie[0]|=Et.na!=null&&0<Et.na.length),re!=null&&(re[0]=we),ve!=null&&(ve[0]=Pt),0):kt}function oo(b,E,z){var re=E.width,ve=E.height,Ie=0,we=0,Fe=re,Ge=ve;if(E.Da=b!=null&&0<b.Da,E.Da&&(Fe=b.cd,Ge=b.bd,Ie=b.v,we=b.j,11>z||(Ie&=-2,we&=-2),0>Ie||0>we||0>=Fe||0>=Ge||Ie+Fe>re||we+Ge>ve))return 0;if(E.v=Ie,E.j=we,E.va=Ie+Fe,E.o=we+Ge,E.U=Fe,E.T=Ge,E.da=b!=null&&0<b.da,E.da){if(!Ee(Fe,Ge,z=[b.ib],Ie=[b.hb]))return 0;E.ib=z[0],E.hb=Ie[0]}return E.ob=b!=null&&b.ob,E.Kb=b==null||!b.Sd,E.da&&(E.ob=E.ib<3*re/4&&E.hb<3*ve/4,E.Kb=0),1}function Eu(b){if(b==null)return 2;if(11>b.S){var E=b.f.RGBA;E.fb+=(b.height-1)*E.A,E.A=-E.A}else E=b.f.kb,b=b.height,E.O+=(b-1)*E.fa,E.fa=-E.fa,E.N+=(b-1>>1)*E.Ab,E.Ab=-E.Ab,E.W+=(b-1>>1)*E.Db,E.Db=-E.Db,E.F!=null&&(E.J+=(b-1)*E.lb,E.lb=-E.lb);return 0}function xl(b,E,z,re){if(re==null||0>=b||0>=E)return 2;if(z!=null){if(z.Da){var ve=z.cd,Ie=z.bd,we=-2&z.v,Fe=-2&z.j;if(0>we||0>Fe||0>=ve||0>=Ie||we+ve>b||Fe+Ie>E)return 2;b=ve,E=Ie}if(z.da){if(!Ee(b,E,ve=[z.ib],Ie=[z.hb]))return 2;b=ve[0],E=Ie[0]}}re.width=b,re.height=E;e:{var Ge=re.width,qe=re.height;if(b=re.S,0>=Ge||0>=qe||!(b>=Yh&&13>b))b=2;else{if(0>=re.Rd&&re.sd==null){we=Ie=ve=E=0;var Nt=(Fe=Ge*e0[b])*qe;if(11>b||(Ie=(qe+1)/2*(E=(Ge+1)/2),b==12&&(we=(ve=Ge)*qe)),(qe=l(Nt+2*Ie+we))==null){b=1;break e}re.sd=qe,11>b?((Ge=re.f.RGBA).eb=qe,Ge.fb=0,Ge.A=Fe,Ge.size=Nt):((Ge=re.f.kb).y=qe,Ge.O=0,Ge.fa=Fe,Ge.Fd=Nt,Ge.f=qe,Ge.N=0+Nt,Ge.Ab=E,Ge.Cd=Ie,Ge.ea=qe,Ge.W=0+Nt+Ie,Ge.Db=E,Ge.Ed=Ie,b==12&&(Ge.F=qe,Ge.J=0+Nt+2*Ie),Ge.Tc=we,Ge.lb=ve)}if(E=1,ve=re.S,Ie=re.width,we=re.height,ve>=Yh&&13>ve)if(11>ve)b=re.f.RGBA,E&=(Fe=Math.abs(b.A))*(we-1)+Ie<=b.size,E&=Fe>=Ie*e0[ve],E&=b.eb!=null;else{b=re.f.kb,Fe=(Ie+1)/2,Nt=(we+1)/2,Ge=Math.abs(b.fa),qe=Math.abs(b.Ab);var Wt=Math.abs(b.Db),He=Math.abs(b.lb),Et=He*(we-1)+Ie;E&=Ge*(we-1)+Ie<=b.Fd,E&=qe*(Nt-1)+Fe<=b.Cd,E=(E&=Wt*(Nt-1)+Fe<=b.Ed)&Ge>=Ie&qe>=Fe&Wt>=Fe,E&=b.y!=null,E&=b.f!=null,E&=b.ea!=null,ve==12&&(E&=He>=Ie,E&=Et<=b.Tc,E&=b.F!=null)}else E=0;b=E?0:2}}return b!=0||z!=null&&z.fd&&(b=Eu(re)),b}var Uo=64,xa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],da=24,El=32,jl=8,co=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ne("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(b){return b},O.Predictor2=function(b,E,z){return E[z+0]},O.Predictor3=function(b,E,z){return E[z+1]},O.Predictor4=function(b,E,z){return E[z-1]},O.Predictor5=function(b,E,z){return xe(xe(b,E[z+1]),E[z+0])},O.Predictor6=function(b,E,z){return xe(b,E[z-1])},O.Predictor7=function(b,E,z){return xe(b,E[z+0])},O.Predictor8=function(b,E,z){return xe(E[z-1],E[z+0])},O.Predictor9=function(b,E,z){return xe(E[z+0],E[z+1])},O.Predictor10=function(b,E,z){return xe(xe(b,E[z-1]),xe(E[z+0],E[z+1]))},O.Predictor11=function(b,E,z){var re=E[z+0];return 0>=it(re>>24&255,b>>24&255,(E=E[z-1])>>24&255)+it(re>>16&255,b>>16&255,E>>16&255)+it(re>>8&255,b>>8&255,E>>8&255)+it(255&re,255&b,255&E)?re:b},O.Predictor12=function(b,E,z){var re=E[z+0];return(et((b>>24&255)+(re>>24&255)-((E=E[z-1])>>24&255))<<24|et((b>>16&255)+(re>>16&255)-(E>>16&255))<<16|et((b>>8&255)+(re>>8&255)-(E>>8&255))<<8|et((255&b)+(255&re)-(255&E)))>>>0},O.Predictor13=function(b,E,z){var re=E[z-1];return(bt((b=xe(b,E[z+0]))>>24&255,re>>24&255)<<24|bt(b>>16&255,re>>16&255)<<16|bt(b>>8&255,re>>8&255)<<8|bt(255&b,255&re))>>>0};var md=O.PredictorAdd0;O.PredictorAdd1=At,ne("Predictor2","PredictorAdd2"),ne("Predictor3","PredictorAdd3"),ne("Predictor4","PredictorAdd4"),ne("Predictor5","PredictorAdd5"),ne("Predictor6","PredictorAdd6"),ne("Predictor7","PredictorAdd7"),ne("Predictor8","PredictorAdd8"),ne("Predictor9","PredictorAdd9"),ne("Predictor10","PredictorAdd10"),ne("Predictor11","PredictorAdd11"),ne("Predictor12","PredictorAdd12"),ne("Predictor13","PredictorAdd13");var gd=O.PredictorAdd2;Tt("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),Tt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var Zr,Kh=O.ColorIndexInverseTransform,Il=O.MapARGB,Ol=O.VP8LColorIndexInverseTransformAlpha,Li=O.MapAlpha,uo=O.VP8LPredictorsAdd=[];uo.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var pd,_d,ho,fo,Ml,xc,ja,mo,qi,Ka,zn,Wn,Cr,ei,Ll,Cl,Cc,ju,Bf,wg,Pg,Ag,Wf,Ff,yc,Qa,Iu,Ia,bc=l(511),Qh=l(2041),Ou=l(225),Mu=l(767),Gh=0,go=Qh,Lu=Ou,Xi=Mu,wi=bc,Yh=0,Ji=1,Vh=2,Ga=3,wu=4,xd=5,Bo=6,Pu=7,$h=8,Cd=9,Hh=10,Ya=[2,3,7],yd=[3,3,11],Nc=[280,256,256,256,40],zh=[0,1,1,1,0],Au=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Va=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$a=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wo=8,Ha=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],za=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Oa=null,kg=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Kf=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],qh=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ug=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Pi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Rr=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Mn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ua=[],Qr=[],yl=[],Fo=1,Qf=2,po=[],Ai=[];io("UpsampleRgbLinePair",ao,3),io("UpsampleBgrLinePair",vi,3),io("UpsampleRgbaLinePair",ca,4),io("UpsampleBgraLinePair",Tl,4),io("UpsampleArgbLinePair",hd,4),io("UpsampleRgba4444LinePair",ko,2),io("UpsampleRgb565LinePair",Ao,2);var Sc=O.UpsampleRgbLinePair,Gf=O.UpsampleBgrLinePair,bd=O.UpsampleRgbaLinePair,Xh=O.UpsampleBgraLinePair,Ko=O.UpsampleArgbLinePair,wl=O.UpsampleRgba4444LinePair,Qo=O.UpsampleRgb565LinePair,qa=16,Nd=1<<qa-1,vc=-227,Go=482,Jh=6,Yo=0,ki=l(256),Zh=l(256),Bg=l(256),Lx=l(256),wx=l(Go-vc),Px=l(Go-vc);lo("YuvToRgbRow",ao,3),lo("YuvToBgrRow",vi,3),lo("YuvToRgbaRow",ca,4),lo("YuvToBgraRow",Tl,4),lo("YuvToArgbRow",hd,4),lo("YuvToRgba4444Row",ko,2),lo("YuvToRgb565Row",Ao,2);var ti=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Sd=[0,2,8],ku=[8,7,6,4,4,2,2,2,1,1,1,1],Uu=1;this.WebPDecodeRGBA=function(b,E,z,re,ve){var Ie=Ji,we=new rs,Fe=new Ye;we.ba=Fe,Fe.S=Ie,Fe.width=[Fe.width],Fe.height=[Fe.height];var Ge=Fe.width,qe=Fe.height,Nt=new Ce;if(Nt==null||b==null)var Wt=2;else e(Nt!=null),Wt=_l(b,E,z,Nt.width,Nt.height,Nt.Pd,Nt.Qd,Nt.format,null);if(Wt!=0?Ge=0:(Ge!=null&&(Ge[0]=Nt.width[0]),qe!=null&&(qe[0]=Nt.height[0]),Ge=1),Ge){Fe.width=Fe.width[0],Fe.height=Fe.height[0],re!=null&&(re[0]=Fe.width),ve!=null&&(ve[0]=Fe.height);e:{if(re=new wt,(ve=new gs).data=b,ve.w=E,ve.ha=z,ve.kd=1,E=[0],e(ve!=null),((b=_l(ve.data,ve.w,ve.ha,null,null,null,E,null,ve))==0||b==7)&&E[0]&&(b=4),(E=b)==0){if(e(we!=null),re.data=ve.data,re.w=ve.w+ve.offset,re.ha=ve.ha-ve.offset,re.put=Pe,re.ac=Xe,re.bc=Ct,re.ma=we,ve.xa){if((b=ct())==null){we=1;break e}if((function(He,Et){var Pt=[0],es=[0],kt=[0];t:for(;;){if(He==null)return 0;if(Et==null)return He.a=2,0;if(He.l=Et,He.a=0,ee(He.m,Et.data,Et.w,Et.ha),!Me(He.m,Pt,es,kt)){He.a=3;break t}if(He.xb=Qf,Et.width=Pt[0],Et.height=es[0],!st(Pt[0],es[0],1,He,null))break t;return 1}return e(He.a!=0),0})(b,re)){if(re=(E=xl(re.width,re.height,we.Oa,we.ba))==0){t:{re=b;s:for(;;){if(re==null){re=0;break t}if(e(re.s.yc!=null),e(re.s.Ya!=null),e(0<re.s.Wb),e((z=re.l)!=null),e((ve=z.ma)!=null),re.xb!=0){if(re.ca=ve.ba,re.tb=ve.tb,e(re.ca!=null),!oo(ve.Oa,z,Ga)){re.a=2;break s}if(!Kt(re,z.width)||z.da)break s;if((z.da||mt(re.ca.S))&&gl(),11>re.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),re.ca.f.kb.F!=null&&gl()),re.Pb&&0<re.s.ua&&re.s.vb.X==null&&!Z(re.s.vb,re.s.Wa.Xa)){re.a=1;break s}re.xb=0}if(!Ns(re,re.V,re.Ba,re.c,re.i,z.o,ss))break s;ve.Dc=re.Ma,re=1;break t}e(re.a!=0),re=0}re=!re}re&&(E=b.a)}else E=b.a}else{if((b=new Bt)==null){we=1;break e}if(b.Fa=ve.na,b.P=ve.P,b.qc=ve.Sa,ts(b,re)){if((E=xl(re.width,re.height,we.Oa,we.ba))==0){if(b.Aa=0,z=we.Oa,e((ve=b)!=null),z!=null){if(0<(Ge=0>(Ge=z.Md)?0:100<Ge?255:255*Ge/100)){for(qe=Nt=0;4>qe;++qe)12>(Wt=ve.pb[qe]).lc&&(Wt.ia=Ge*ku[0>Wt.lc?0:Wt.lc]>>3),Nt|=Wt.ia;Nt&&(alert("todo:VP8InitRandom"),ve.ia=1)}ve.Ga=z.Id,100<ve.Ga?ve.Ga=100:0>ve.Ga&&(ve.Ga=0)}(function(He,Et){if(He==null)return 0;if(Et==null)return Yt(He,2,"NULL VP8Io parameter in VP8Decode().");if(!He.cb&&!ts(He,Et))return 0;if(e(He.cb),Et.ac==null||Et.ac(Et)){Et.ob&&(He.L=0);var Pt=Sd[He.L];if(He.L==2?(He.yb=0,He.zb=0):(He.yb=Et.v-Pt>>4,He.zb=Et.j-Pt>>4,0>He.yb&&(He.yb=0),0>He.zb&&(He.zb=0)),He.Va=Et.o+15+Pt>>4,He.Hb=Et.va+15+Pt>>4,He.Hb>He.za&&(He.Hb=He.za),He.Va>He.Ub&&(He.Va=He.Ub),0<He.L){var es=He.ed;for(Pt=0;4>Pt;++Pt){var kt;if(He.Qa.Cb){var Jt=He.Qa.Lb[Pt];He.Qa.Fb||(Jt+=es.Tb)}else Jt=es.Tb;for(kt=0;1>=kt;++kt){var is=He.gd[Pt][kt],xs=Jt;if(es.Pc&&(xs+=es.vd[0],kt&&(xs+=es.od[0])),0<(xs=0>xs?0:63<xs?63:xs)){var fs=xs;0<es.wb&&(fs=4<es.wb?fs>>2:fs>>1)>9-es.wb&&(fs=9-es.wb),1>fs&&(fs=1),is.dd=fs,is.tc=2*xs+fs,is.ld=40<=xs?2:15<=xs?1:0}else is.tc=0;is.La=kt}}}Pt=0}else Yt(He,6,"Frame setup failed"),Pt=He.a;if(Pt=Pt==0){if(Pt){He.$c=0,0<He.Aa||(He.Ic=Uu);t:{Pt=He.Ic,es=4*(fs=He.za);var $s=32*fs,Bs=fs+1,mn=0<He.L?fs*(0<He.Aa?2:1):0,Gs=(He.Aa==2?2:1)*fs;if((is=es+832+(kt=3*(16*Pt+Sd[He.L])/2*$s)+(Jt=He.Fa!=null&&0<He.Fa.length?He.Kc.c*He.Kc.i:0))!=is)Pt=0;else{if(is>He.Vb){if(He.Vb=0,He.Ec=l(is),He.Fc=0,He.Ec==null){Pt=Yt(He,1,"no memory during frame initialization.");break t}He.Vb=is}is=He.Ec,xs=He.Fc,He.Ac=is,He.Bc=xs,xs+=es,He.Gd=c($s,vt),He.Hd=0,He.rb=c(Bs+1,Te),He.sb=1,He.wa=mn?c(mn,tt):null,He.Y=0,He.D.Nb=0,He.D.wa=He.wa,He.D.Y=He.Y,0<He.Aa&&(He.D.Y+=fs),e(!0),He.oc=is,He.pc=xs,xs+=832,He.ya=c(Gs,Qe),He.aa=0,He.D.ya=He.ya,He.D.aa=He.aa,He.Aa==2&&(He.D.aa+=fs),He.R=16*fs,He.B=8*fs,fs=($s=Sd[He.L])*He.R,$s=$s/2*He.B,He.sa=is,He.ta=xs+fs,He.qa=He.sa,He.ra=He.ta+16*Pt*He.R+$s,He.Ha=He.qa,He.Ia=He.ra+8*Pt*He.B+$s,He.$c=0,xs+=kt,He.mb=Jt?is:null,He.nb=Jt?xs:null,e(xs+Jt<=He.Fc+He.Vb),Es(He),i(He.Ac,He.Bc,0,es),Pt=1}}if(Pt){if(Et.ka=0,Et.y=He.sa,Et.O=He.ta,Et.f=He.qa,Et.N=He.ra,Et.ea=He.Ha,Et.Vd=He.Ia,Et.fa=He.R,Et.Rc=He.B,Et.F=null,Et.J=0,!Gh){for(Pt=-255;255>=Pt;++Pt)bc[255+Pt]=0>Pt?-Pt:Pt;for(Pt=-1020;1020>=Pt;++Pt)Qh[1020+Pt]=-128>Pt?-128:127<Pt?127:Pt;for(Pt=-112;112>=Pt;++Pt)Ou[112+Pt]=-16>Pt?-16:15<Pt?15:Pt;for(Pt=-255;510>=Pt;++Pt)Mu[255+Pt]=0>Pt?0:255<Pt?255:Pt;Gh=1}ja=nt,mo=cs,Ka=ms,zn=Ks,Wn=Ls,qi=Ms,Cr=Wh,ei=no,Ll=Se,Cl=Je,Cc=Fh,ju=W,Bf=xt,wg=Mt,Pg=ml,Ag=ws,Wf=Hn,Ff=Kr,Qr[0]=qr,Qr[1]=Cs,Qr[2]=Lr,Qr[3]=Ir,Qr[4]=vr,Qr[5]=cr,Qr[6]=cn,Qr[7]=ni,Qr[8]=Hi,Qr[9]=Fr,ua[0]=hs,ua[1]=Os,ua[2]=Zt,ua[3]=Ds,ua[4]=Us,ua[5]=Qs,ua[6]=Is,yl[0]=Ta,yl[1]=Ht,yl[2]=Or,yl[3]=zi,yl[4]=Rs,yl[5]=Fa,yl[6]=Pn,Pt=1}else Pt=0}Pt&&(Pt=(function(On,Tr){for(On.M=0;On.M<On.Va;++On.M){var Cn,Ws=On.Jc[On.M&On.Xb],Ts=On.m,Pr=On;for(Cn=0;Cn<Pr.za;++Cn){var on=Ts,Nn=Pr,rr=Nn.Ac,gi=Nn.Bc+4*Cn,Ui=Nn.zc,yr=Nn.ya[Nn.aa+Cn];if(Nn.Qa.Bb?yr.$b=de(on,Nn.Pa.jb[0])?2+de(on,Nn.Pa.jb[2]):de(on,Nn.Pa.jb[1]):yr.$b=0,Nn.kc&&(yr.Ad=de(on,Nn.Bd)),yr.Za=!de(on,145)+0,yr.Za){var ii=yr.Ob,Zi=0;for(Nn=0;4>Nn;++Nn){var ai,Tn=Ui[0+Nn];for(ai=0;4>ai;++ai){Tn=Pi[rr[gi+ai]][Tn];for(var Gn=qh[de(on,Tn[0])];0<Gn;)Gn=qh[2*Gn+de(on,Tn[Gn])];Tn=-Gn,rr[gi+ai]=Tn}r(ii,Zi,rr,gi,4),Zi+=4,Ui[0+Nn]=Tn}}else Tn=de(on,156)?de(on,128)?1:3:de(on,163)?2:0,yr.Ob[0]=Tn,i(rr,gi,Tn,4),i(Ui,0,Tn,4);yr.Dd=de(on,142)?de(on,114)?de(on,183)?1:3:2:0}if(Pr.m.Ka)return Yt(On,7,"Premature end-of-partition0 encountered.");for(;On.ja<On.za;++On.ja){if(Pr=Ws,on=(Ts=On).rb[Ts.sb-1],rr=Ts.rb[Ts.sb+Ts.ja],Cn=Ts.ya[Ts.aa+Ts.ja],gi=Ts.kc?Cn.Ad:0)on.la=rr.la=0,Cn.Za||(on.Na=rr.Na=0),Cn.Hc=0,Cn.Gc=0,Cn.ia=0;else{var Ar,qn;if(on=rr,rr=Pr,gi=Ts.Pa.Xc,Ui=Ts.ya[Ts.aa+Ts.ja],yr=Ts.pb[Ui.$b],Nn=Ui.ad,ii=0,Zi=Ts.rb[Ts.sb-1],Tn=ai=0,i(Nn,ii,0,384),Ui.Za)var pi=0,kr=gi[3];else{Gn=l(16);var Yn=on.Na+Zi.Na;if(Yn=Oa(rr,gi[1],Yn,yr.Eb,0,Gn,0),on.Na=Zi.Na=(0<Yn)+0,1<Yn)ja(Gn,0,Nn,ii);else{var si=Gn[0]+3>>3;for(Gn=0;256>Gn;Gn+=16)Nn[ii+Gn]=si}pi=1,kr=gi[0]}var ir=15&on.la,li=15&Zi.la;for(Gn=0;4>Gn;++Gn){var oi=1&li;for(si=qn=0;4>si;++si)ir=ir>>1|(oi=(Yn=Oa(rr,kr,Yn=oi+(1&ir),yr.Sc,pi,Nn,ii))>pi)<<7,qn=qn<<2|(3<Yn?3:1<Yn?2:Nn[ii+0]!=0),ii+=16;ir>>=4,li=li>>1|oi<<7,ai=(ai<<8|qn)>>>0}for(kr=ir,pi=li>>4,Ar=0;4>Ar;Ar+=2){for(qn=0,ir=on.la>>4+Ar,li=Zi.la>>4+Ar,Gn=0;2>Gn;++Gn){for(oi=1&li,si=0;2>si;++si)Yn=oi+(1&ir),ir=ir>>1|(oi=0<(Yn=Oa(rr,gi[2],Yn,yr.Qc,0,Nn,ii)))<<3,qn=qn<<2|(3<Yn?3:1<Yn?2:Nn[ii+0]!=0),ii+=16;ir>>=2,li=li>>1|oi<<5}Tn|=qn<<4*Ar,kr|=ir<<4<<Ar,pi|=(240&li)<<Ar}on.la=kr,Zi.la=pi,Ui.Hc=ai,Ui.Gc=Tn,Ui.ia=43690&Tn?0:yr.ia,gi=!(ai|Tn)}if(0<Ts.L&&(Ts.wa[Ts.Y+Ts.ja]=Ts.gd[Cn.$b][Cn.Za],Ts.wa[Ts.Y+Ts.ja].La|=!gi),Pr.Ka)return Yt(On,7,"Premature end-of-file encountered.")}if(Es(On),Ts=Tr,Pr=1,Cn=(Ws=On).D,on=0<Ws.L&&Ws.M>=Ws.zb&&Ws.M<=Ws.Va,Ws.Aa==0)t:{if(Cn.M=Ws.M,Cn.uc=on,Ea(Ws,Cn),Pr=1,Cn=(qn=Ws.D).Nb,on=(Tn=Sd[Ws.L])*Ws.R,rr=Tn/2*Ws.B,Gn=16*Cn*Ws.R,si=8*Cn*Ws.B,gi=Ws.sa,Ui=Ws.ta-on+Gn,yr=Ws.qa,Nn=Ws.ra-rr+si,ii=Ws.Ha,Zi=Ws.Ia-rr+si,li=(ir=qn.M)==0,ai=ir>=Ws.Va-1,Ws.Aa==2&&Ea(Ws,qn),qn.uc)for(oi=(Yn=Ws).D.M,e(Yn.D.uc),qn=Yn.yb;qn<Yn.Hb;++qn){pi=qn,kr=oi;var hr=(Fn=(ci=Yn).D).Nb;Ar=ci.R;var Fn=Fn.wa[Fn.Y+pi],ea=ci.sa,Gr=ci.ta+16*hr*Ar+16*pi,tn=Fn.dd,nn=Fn.tc;if(nn!=0)if(e(3<=nn),ci.L==1)0<pi&&Ag(ea,Gr,Ar,nn+4),Fn.La&&Ff(ea,Gr,Ar,nn),0<kr&&Pg(ea,Gr,Ar,nn+4),Fn.La&&Wf(ea,Gr,Ar,nn);else{var Vn=ci.B,Ca=ci.qa,Xa=ci.ra+8*hr*Vn+8*pi,ha=ci.Ha,ci=ci.Ia+8*hr*Vn+8*pi;hr=Fn.ld,0<pi&&(ei(ea,Gr,Ar,nn+4,tn,hr),Cl(Ca,Xa,ha,ci,Vn,nn+4,tn,hr)),Fn.La&&(ju(ea,Gr,Ar,nn,tn,hr),wg(Ca,Xa,ha,ci,Vn,nn,tn,hr)),0<kr&&(Cr(ea,Gr,Ar,nn+4,tn,hr),Ll(Ca,Xa,ha,ci,Vn,nn+4,tn,hr)),Fn.La&&(Cc(ea,Gr,Ar,nn,tn,hr),Bf(Ca,Xa,ha,ci,Vn,nn,tn,hr))}}if(Ws.ia&&alert("todo:DitherRow"),Ts.put!=null){if(qn=16*ir,ir=16*(ir+1),li?(Ts.y=Ws.sa,Ts.O=Ws.ta+Gn,Ts.f=Ws.qa,Ts.N=Ws.ra+si,Ts.ea=Ws.Ha,Ts.W=Ws.Ia+si):(qn-=Tn,Ts.y=gi,Ts.O=Ui,Ts.f=yr,Ts.N=Nn,Ts.ea=ii,Ts.W=Zi),ai||(ir-=Tn),ir>Ts.o&&(ir=Ts.o),Ts.F=null,Ts.J=null,Ws.Fa!=null&&0<Ws.Fa.length&&qn<ir&&(Ts.J=xr(Ws,Ts,qn,ir-qn),Ts.F=Ws.mb,Ts.F==null&&Ts.F.length==0)){Pr=Yt(Ws,3,"Could not decode alpha data.");break t}qn<Ts.j&&(Tn=Ts.j-qn,qn=Ts.j,e(!(1&Tn)),Ts.O+=Ws.R*Tn,Ts.N+=Ws.B*(Tn>>1),Ts.W+=Ws.B*(Tn>>1),Ts.F!=null&&(Ts.J+=Ts.width*Tn)),qn<ir&&(Ts.O+=Ts.v,Ts.N+=Ts.v>>1,Ts.W+=Ts.v>>1,Ts.F!=null&&(Ts.J+=Ts.v),Ts.ka=qn-Ts.j,Ts.U=Ts.va-Ts.v,Ts.T=ir-qn,Pr=Ts.put(Ts))}Cn+1!=Ws.Ic||ai||(r(Ws.sa,Ws.ta-on,gi,Ui+16*Ws.R,on),r(Ws.qa,Ws.ra-rr,yr,Nn+8*Ws.B,rr),r(Ws.Ha,Ws.Ia-rr,ii,Zi+8*Ws.B,rr))}if(!Pr)return Yt(On,6,"Output aborted.")}return 1})(He,Et)),Et.bc!=null&&Et.bc(Et),Pt&=1}return Pt?(He.cb=0,Pt):0})(b,re)||(E=b.a)}}else E=b.a}E==0&&we.Oa!=null&&we.Oa.fd&&(E=Eu(we.ba))}we=E}Ie=we!=0?null:11>Ie?Fe.f.RGBA.eb:Fe.f.kb.y}else Ie=null;return Ie};var e0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(O,S){for(var A="",Y=0;Y<4;Y++)A+=String.fromCharCode(O[S++]);return A}function m(O,S){return O[S+0]|O[S+1]<<8}function _(O,S){return(O[S+0]|O[S+1]<<8|O[S+2]<<16)>>>0}function y(O,S){return(O[S+0]|O[S+1]<<8|O[S+2]<<16|O[S+3]<<24)>>>0}new u;var g=[0],N=[0],C=[],v=new u,R=t,U=(function(O,S){var A={},Y=0,te=!1,J=0,q=0;if(A.frames=[],!(function(j,k){for(var Q=0;Q<4;Q++)if(j[k+Q]!="RIFF".charCodeAt(Q))return!0;return!1})(O,S)){for(y(O,S+=4),S+=8;S<O.length;){var V=f(O,S),F=y(O,S+=4);S+=4;var I=F+(1&F);switch(V){case"VP8 ":case"VP8L":A.frames[Y]===void 0&&(A.frames[Y]={}),(T=A.frames[Y]).src_off=te?q:S-8,T.src_size=J+F+8,Y++,te&&(te=!1,J=0,q=0);break;case"VP8X":(T=A.header={}).feature_flags=O[S];var ee=S+4;T.canvas_width=1+_(O,ee),ee+=3,T.canvas_height=1+_(O,ee),ee+=3;break;case"ALPH":te=!0,J=I+8,q=S-8;break;case"ANIM":(T=A.header).bgcolor=y(O,S),ee=S+4,T.loop_count=m(O,ee),ee+=2;break;case"ANMF":var ae,T;(T=A.frames[Y]={}).offset_x=2*_(O,S),S+=3,T.offset_y=2*_(O,S),S+=3,T.width=1+_(O,S),S+=3,T.height=1+_(O,S),S+=3,T.duration=_(O,S),S+=3,ae=O[S++],T.dispose=1&ae,T.blend=ae>>1&1}V!="ANMF"&&(S+=I)}return A}})(R,0);U.response=R,U.rgbaoutput=!0,U.dataurl=!1;var L=U.header?U.header:null,w=U.frames?U.frames:null;if(L){L.loop_counter=L.loop_count,g=[L.canvas_height],N=[L.canvas_width];for(var P=0;P<w.length&&w[P].blend!=0;P++);}var G=w[0],K=v.WebPDecodeRGBA(R,G.src_off,G.src_size,N,g);G.rgba=K,G.imgwidth=N[0],G.imgheight=g[0];for(var B=0;B<N[0]*g[0]*4;B++)C[B]=K[B];return this.width=N,this.height=g,this.data=C,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function KF(){var t,e=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(e));t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t.length+" >>"),this.internal.write("stream"),this.internal.write(t),this.internal.write("endstream"),this.internal.write("endobj")}function QF(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(t){var e,n,r,i,l,c,d,u,f,m=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new u,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new c,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new c,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new _(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,l=this.internal.getVerticalCoordinate,c=this.internal.Point,d=this.internal.Rectangle,u=this.internal.Matrix,f=new m}]);var _=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var k=j;Object.defineProperty(this,"pdf",{get:function(){return k}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(Z){Q=!!Z}});var H=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return H},set:function(Z){H=!!Z}});var $=0;Object.defineProperty(this,"posX",{get:function(){return $},set:function(Z){isNaN(Z)||($=Z)}});var ie=0;Object.defineProperty(this,"posY",{get:function(){return ie},set:function(Z){isNaN(Z)||(ie=Z)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(Z){var le;typeof Z=="number"?le=[Z,Z,Z,Z]:((le=new Array(4))[0]=Z[0],le[1]=Z.length>=2?Z[1]:le[0],le[2]=Z.length>=3?Z[2]:le[0],le[3]=Z.length>=4?Z[3]:le[1]),f.margin=le}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(Z){fe=Z}});var pe=0;Object.defineProperty(this,"lastBreak",{get:function(){return pe},set:function(Z){pe=Z}});var de=[];Object.defineProperty(this,"pageBreaks",{get:function(){return de},set:function(Z){de=Z}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(Z){Z instanceof m&&(f=Z)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(Z){f.path=Z}});var Re=[];Object.defineProperty(this,"ctxStack",{get:function(){return Re},set:function(Z){Re=Z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Z){var le;le=y(Z),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Z){var le=y(Z);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Z){["butt","round","square"].indexOf(Z)!==-1&&(this.ctx.lineCap=Z,this.pdf.setLineCap(Z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Z){isNaN(Z)||(this.ctx.lineWidth=Z,this.pdf.setLineWidth(Z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Z){["bevel","round","miter"].indexOf(Z)!==-1&&(this.ctx.lineJoin=Z,this.pdf.setLineJoin(Z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Z){isNaN(Z)||(this.ctx.miterLimit=Z,this.pdf.setMiterLimit(Z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Z){this.ctx.textBaseline=Z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Z){["right","end","center","left","start"].indexOf(Z)!==-1&&(this.ctx.textAlign=Z)}});var X=null,_e=null,me=null;Object.defineProperty(this,"fontFaces",{get:function(){return me},set:function(Z){X=null,_e=null,me=Z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Z){var le;if(this.ctx.font=Z,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Z))!==null){var se=le[1];le[2];var Ee=le[3],Ne=le[4];le[5];var ye=le[6],ne=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ne)[2];Ne=Math.floor(ne==="px"?parseFloat(Ne)*this.pdf.internal.scaleFactor:ne==="em"?parseFloat(Ne)*this.pdf.getFontSize():parseFloat(Ne)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ne);var ue=(function(Tt){var St,ze,dt=[],Ke=Tt.trim();if(Ke==="")return ey;if(Ke in rT)return[rT[Ke]];for(;Ke!=="";){switch(ze=null,St=(Ke=aT(Ke)).charAt(0)){case'"':case"'":ze=AF(Ke.substring(1),St);break;default:ze=kF(Ke)}if(ze===null||(dt.push(ze[0]),(Ke=aT(ze[1]))!==""&&Ke.charAt(0)!==","))return ey;Ke=Ke.replace(/^,/,"")}return dt})(ye);if(this.fontFaces){var xe=(function(Tt,St){var ze=Tt.getFontList(),dt=JSON.stringify(ze);if(X===null||_e!==dt){var Ke=(function(rt){var ft=[];return Object.keys(rt).forEach(function(Ot){rt[Ot].forEach(function(mt){var Ze=null;switch(mt){case"bold":Ze={family:Ot,weight:"bold"};break;case"italic":Ze={family:Ot,style:"italic"};break;case"bolditalic":Ze={family:Ot,weight:"bold",style:"italic"};break;case"":case"normal":Ze={family:Ot}}Ze!==null&&(Ze.ref={name:Ot,style:mt},ft.push(Ze))})}),ft})(ze);X=(function(rt){for(var ft={},Ot=0;Ot<rt.length;++Ot){var mt=ZC(rt[Ot]),Ze=mt.family,De=mt.stretch,Ye=mt.style,Ce=mt.weight;ft[Ze]=ft[Ze]||{},ft[Ze][De]=ft[Ze][De]||{},ft[Ze][De][Ye]=ft[Ze][De][Ye]||{},ft[Ze][De][Ye][Ce]=mt}return ft})(Ke.concat(St)),_e=dt}return X})(this.pdf,this.fontFaces),et=ue.map(function(Tt){return{family:Tt,stretch:"normal",weight:Ee,style:se}}),bt=(function(Tt,St,ze){for(var dt=(ze=ze||{}).defaultFontFamily||"times",Ke=Object.assign({},PF,ze.genericFontFamilies||{}),rt=null,ft=null,Ot=0;Ot<St.length;++Ot)if(Ke[(rt=ZC(St[Ot])).family]&&(rt.family=Ke[rt.family]),Tt.hasOwnProperty(rt.family)){ft=Tt[rt.family];break}if(!(ft=ft||Tt[dt]))throw new Error("Could not find a font-family for the rule '"+iT(rt)+"' and default family '"+dt+"'.");if(ft=(function(mt,Ze){if(Ze[mt])return Ze[mt];var De=ib[mt],Ye=De<=ib.normal?-1:1,Ce=nT(Ze,LI,De,Ye);if(!Ce)throw new Error("Could not find a matching font-stretch value for "+mt);return Ce})(rt.stretch,ft),ft=(function(mt,Ze){if(Ze[mt])return Ze[mt];for(var De=MI[mt],Ye=0;Ye<De.length;++Ye)if(Ze[De[Ye]])return Ze[De[Ye]];throw new Error("Could not find a matching font-style for "+mt)})(rt.style,ft),!(ft=(function(mt,Ze){if(Ze[mt])return Ze[mt];if(mt===400&&Ze[500])return Ze[500];if(mt===500&&Ze[400])return Ze[400];var De=wF[mt],Ye=nT(Ze,wI,De,mt<400?-1:1);if(!Ye)throw new Error("Could not find a matching font-weight for value "+mt);return Ye})(rt.weight,ft)))throw new Error("Failed to resolve a font for the rule '"+iT(rt)+"'.");return ft})(xe,et);this.pdf.setFont(bt.ref.name,bt.ref.style)}else{var it="";(Ee==="bold"||parseInt(Ee,10)>=700||se==="bold")&&(it="bold"),se==="italic"&&(it+="italic"),it.length===0&&(it="normal");for(var At="",at={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},We=0;We<ue.length;We++){if(this.pdf.internal.getFont(ue[We],it,{noFallback:!0,disableWarning:!0})!==void 0){At=ue[We];break}if(it==="bolditalic"&&this.pdf.internal.getFont(ue[We],"bold",{noFallback:!0,disableWarning:!0})!==void 0)At=ue[We],it="bold";else if(this.pdf.internal.getFont(ue[We],"normal",{noFallback:!0,disableWarning:!0})!==void 0){At=ue[We],it="normal";break}}if(At===""){for(var Dt=0;Dt<ue.length;Dt++)if(at[ue[Dt]]){At=at[ue[Dt]];break}}At=At===""?"Times":At,this.pdf.setFont(At,it)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Z){this.ctx.globalCompositeOperation=Z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Z){this.ctx.globalAlpha=Z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Z){this.ctx.lineDashOffset=Z,T.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Z){this.ctx.lineDash=Z,T.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Z){this.ctx.ignoreClearRect=!!Z}})};_.prototype.setLineDash=function(j){this.lineDash=j},_.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},_.prototype.fill=function(){w.call(this,"fill",!1)},_.prototype.stroke=function(){w.call(this,"stroke",!1)},_.prototype.beginPath=function(){this.path=[{type:"begin"}]},_.prototype.moveTo=function(j,k){if(isNaN(j)||isNaN(k))throw jr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new c(j,k));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new c(j,k)},_.prototype.closePath=function(){var j=new c(0,0),k=0;for(k=this.path.length-1;k!==-1;k--)if(this.path[k].type==="begin"&&pr(this.path[k+1])==="object"&&typeof this.path[k+1].x=="number"){j=new c(this.path[k+1].x,this.path[k+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new c(j.x,j.y)},_.prototype.lineTo=function(j,k){if(isNaN(j)||isNaN(k))throw jr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new c(j,k));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new c(Q.x,Q.y)},_.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},_.prototype.quadraticCurveTo=function(j,k,Q,H){if(isNaN(Q)||isNaN(H)||isNaN(j)||isNaN(k))throw jr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var $=this.ctx.transform.applyToPoint(new c(Q,H)),ie=this.ctx.transform.applyToPoint(new c(j,k));this.path.push({type:"qct",x1:ie.x,y1:ie.y,x:$.x,y:$.y}),this.ctx.lastPoint=new c($.x,$.y)},_.prototype.bezierCurveTo=function(j,k,Q,H,$,ie){if(isNaN($)||isNaN(ie)||isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H))throw jr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new c($,ie)),pe=this.ctx.transform.applyToPoint(new c(j,k)),de=this.ctx.transform.applyToPoint(new c(Q,H));this.path.push({type:"bct",x1:pe.x,y1:pe.y,x2:de.x,y2:de.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new c(fe.x,fe.y)},_.prototype.arc=function(j,k,Q,H,$,ie){if(isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H)||isNaN($))throw jr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ie=!!ie,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new c(j,k));j=fe.x,k=fe.y;var pe=this.ctx.transform.applyToPoint(new c(0,Q)),de=this.ctx.transform.applyToPoint(new c(0,0));Q=Math.sqrt(Math.pow(pe.x-de.x,2)+Math.pow(pe.y-de.y,2))}Math.abs($-H)>=2*Math.PI&&(H=0,$=2*Math.PI),this.path.push({type:"arc",x:j,y:k,radius:Q,startAngle:H,endAngle:$,counterclockwise:ie})},_.prototype.arcTo=function(j,k,Q,H,$){throw new Error("arcTo not implemented.")},_.prototype.rect=function(j,k,Q,H){if(isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H))throw jr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,k),this.lineTo(j+Q,k),this.lineTo(j+Q,k+H),this.lineTo(j,k+H),this.lineTo(j,k),this.lineTo(j+Q,k),this.lineTo(j,k)},_.prototype.fillRect=function(j,k,Q,H){if(isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H))throw jr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var $={};this.lineCap!=="butt"&&($.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&($.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,k,Q,H),this.fill(),$.hasOwnProperty("lineCap")&&(this.lineCap=$.lineCap),$.hasOwnProperty("lineJoin")&&(this.lineJoin=$.lineJoin)}},_.prototype.strokeRect=function(j,k,Q,H){if(isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H))throw jr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");N.call(this)||(this.beginPath(),this.rect(j,k,Q,H),this.stroke())},_.prototype.clearRect=function(j,k,Q,H){if(isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H))throw jr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,k,Q,H))},_.prototype.save=function(j){j=typeof j!="boolean"||j;for(var k=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(k),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var H=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=H}},_.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var k=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(k),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},_.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(j){var k,Q,H,$;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))k=0,Q=0,H=0,$=0;else{var ie=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(ie!==null)k=parseInt(ie[1]),Q=parseInt(ie[2]),H=parseInt(ie[3]),$=1;else if((ie=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)k=parseInt(ie[1]),Q=parseInt(ie[2]),H=parseInt(ie[3]),$=parseFloat(ie[4]);else{if($=1,typeof j=="string"&&j.charAt(0)!=="#"){var fe=new DI(j);j=fe.ok?fe.toHex():"#000000"}j.length===4?(k=j.substring(1,2),k+=k,Q=j.substring(2,3),Q+=Q,H=j.substring(3,4),H+=H):(k=j.substring(1,3),Q=j.substring(3,5),H=j.substring(5,7)),k=parseInt(k,16),Q=parseInt(Q,16),H=parseInt(H,16)}}return{r:k,g:Q,b:H,a:$,style:j}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},N=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};_.prototype.fillText=function(j,k,Q,H){if(isNaN(k)||isNaN(Q)||typeof j!="string")throw jr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(H=isNaN(H)?void 0:H,!g.call(this)){var $=I(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;Y.call(this,{text:j,x:k,y:Q,scale:ie,angle:$,align:this.textAlign,maxWidth:H})}},_.prototype.strokeText=function(j,k,Q,H){if(isNaN(k)||isNaN(Q)||typeof j!="string")throw jr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!N.call(this)){H=isNaN(H)?void 0:H;var $=I(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;Y.call(this,{text:j,x:k,y:Q,scale:ie,renderingMode:"stroke",angle:$,align:this.textAlign,maxWidth:H})}},_.prototype.measureText=function(j){if(typeof j!="string")throw jr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var k=this.pdf,Q=this.pdf.internal.scaleFactor,H=k.internal.getFontSize(),$=k.getStringUnitWidth(j)*H/k.internal.scaleFactor;return new function(ie){var fe=(ie=ie||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return fe}}),this}({width:$*=Math.round(96*Q/72*1e4)/1e4})},_.prototype.scale=function(j,k){if(isNaN(j)||isNaN(k))throw jr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new u(j,0,0,k,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},_.prototype.rotate=function(j){if(isNaN(j))throw jr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var k=new u(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(k)},_.prototype.translate=function(j,k){if(isNaN(j)||isNaN(k))throw jr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new u(1,0,0,1,j,k);this.ctx.transform=this.ctx.transform.multiply(Q)},_.prototype.transform=function(j,k,Q,H,$,ie){if(isNaN(j)||isNaN(k)||isNaN(Q)||isNaN(H)||isNaN($)||isNaN(ie))throw jr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new u(j,k,Q,H,$,ie);this.ctx.transform=this.ctx.transform.multiply(fe)},_.prototype.setTransform=function(j,k,Q,H,$,ie){j=isNaN(j)?1:j,k=isNaN(k)?0:k,Q=isNaN(Q)?0:Q,H=isNaN(H)?1:H,$=isNaN($)?0:$,ie=isNaN(ie)?0:ie,this.ctx.transform=new u(j,k,Q,H,$,ie)};var C=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};_.prototype.drawImage=function(j,k,Q,H,$,ie,fe,pe,de){var Re=this.pdf.getImageProperties(j),X=1,_e=1,me=1,Z=1;H!==void 0&&pe!==void 0&&(me=pe/H,Z=de/$,X=Re.width/H*pe/H,_e=Re.height/$*de/$),ie===void 0&&(ie=k,fe=Q,k=0,Q=0),H!==void 0&&pe===void 0&&(pe=H,de=$),H===void 0&&pe===void 0&&(pe=Re.width,de=Re.height);var le=this.ctx.transform.decompose(),se=I(le.rotate.shx),Ee=new u,Ne=(Ee=(Ee=(Ee=Ee.multiply(le.translate)).multiply(le.skew)).multiply(le.scale)).applyToRectangle(new d(ie-k*me,fe-Q*Z,H*X,$*_e));if(this.autoPaging){for(var ye,ne=v.call(this,Ne),ue=[],xe=0;xe<ne.length;xe+=1)ue.indexOf(ne[xe])===-1&&ue.push(ne[xe]);L(ue);for(var et=ue[0],bt=ue[ue.length-1],it=et;it<bt+1;it++){this.pdf.setPage(it);var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],at=it===1?this.posY+this.margin[0]:this.margin[0],We=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=it===1?0:We+(it-2)*Dt;if(this.ctx.clip_path.length!==0){var St=this.path;ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=U(ye,this.posX+this.margin[3],-Tt+at+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=St}var ze=JSON.parse(JSON.stringify(Ne));ze=U([ze],this.posX+this.margin[3],-Tt+at+this.ctx.prevPageLastElemOffset)[0];var dt=(it>et||it<bt)&&C.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,Dt,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",ze.x,ze.y,ze.w,ze.h,null,null,se),dt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(j,"JPEG",Ne.x,Ne.y,Ne.w,Ne.h,null,null,se)};var v=function(j,k,Q){var H=[];k=k||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var $=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":H.push(Math.floor((j.y+$)/Q)+1);break;case"arc":H.push(Math.floor((j.y+$-j.radius)/Q)+1),H.push(Math.floor((j.y+$+j.radius)/Q)+1);break;case"qct":var ie=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);H.push(Math.floor((ie.y+$)/Q)+1),H.push(Math.floor((ie.y+ie.h+$)/Q)+1);break;case"bct":var fe=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);H.push(Math.floor((fe.y+$)/Q)+1),H.push(Math.floor((fe.y+fe.h+$)/Q)+1);break;case"rect":H.push(Math.floor((j.y+$)/Q)+1),H.push(Math.floor((j.y+j.h+$)/Q)+1)}for(var pe=0;pe<H.length;pe+=1)for(;this.pdf.internal.getNumberOfPages()<H[pe];)R.call(this);return H},R=function(){var j=this.fillStyle,k=this.strokeStyle,Q=this.font,H=this.lineCap,$=this.lineWidth,ie=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=k,this.font=Q,this.lineCap=H,this.lineWidth=$,this.lineJoin=ie},U=function(j,k,Q){for(var H=0;H<j.length;H++)switch(j[H].type){case"bct":j[H].x2+=k,j[H].y2+=Q;case"qct":j[H].x1+=k,j[H].y1+=Q;default:j[H].x+=k,j[H].y+=Q}return j},L=function(j){return j.sort(function(k,Q){return k-Q})},w=function(j,k){var Q=this.fillStyle,H=this.strokeStyle,$=this.lineCap,ie=this.lineWidth,fe=Math.abs(ie*this.ctx.transform.scaleX),pe=this.lineJoin;if(this.autoPaging){for(var de,Re,X=JSON.parse(JSON.stringify(this.path)),_e=JSON.parse(JSON.stringify(this.path)),me=[],Z=0;Z<_e.length;Z++)if(_e[Z].x!==void 0)for(var le=v.call(this,_e[Z]),se=0;se<le.length;se+=1)me.indexOf(le[se])===-1&&me.push(le[se]);for(var Ee=0;Ee<me.length;Ee++)for(;this.pdf.internal.getNumberOfPages()<me[Ee];)R.call(this);L(me);for(var Ne=me[0],ye=me[me.length-1],ne=Ne;ne<ye+1;ne++){this.pdf.setPage(ne),this.fillStyle=Q,this.strokeStyle=H,this.lineCap=$,this.lineWidth=fe,this.lineJoin=pe;var ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xe=ne===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],it=ne===1?0:et+(ne-2)*bt;if(this.ctx.clip_path.length!==0){var At=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=U(de,this.posX+this.margin[3],-it+xe+this.ctx.prevPageLastElemOffset),P.call(this,j,!0),this.path=At}if(Re=JSON.parse(JSON.stringify(X)),this.path=U(Re,this.posX+this.margin[3],-it+xe+this.ctx.prevPageLastElemOffset),k===!1||ne===0){var at=(ne>Ne||ne<ye)&&C.call(this);at&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ue,bt,null).clip().discardPath()),P.call(this,j,k),at&&this.pdf.restoreGraphicsState()}this.lineWidth=ie}this.path=X}else this.lineWidth=fe,P.call(this,j,k),this.lineWidth=ie},P=function(j,k){if((j!=="stroke"||k||!N.call(this))&&(j==="stroke"||k||!g.call(this))){for(var Q,H,$=[],ie=this.path,fe=0;fe<ie.length;fe++){var pe=ie[fe];switch(pe.type){case"begin":$.push({begin:!0});break;case"close":$.push({close:!0});break;case"mt":$.push({start:pe,deltas:[],abs:[]});break;case"lt":var de=$.length;if(ie[fe-1]&&!isNaN(ie[fe-1].x)&&(Q=[pe.x-ie[fe-1].x,pe.y-ie[fe-1].y],de>0)){for(;de>=0;de--)if($[de-1].close!==!0&&$[de-1].begin!==!0){$[de-1].deltas.push(Q),$[de-1].abs.push(pe);break}}break;case"bct":Q=[pe.x1-ie[fe-1].x,pe.y1-ie[fe-1].y,pe.x2-ie[fe-1].x,pe.y2-ie[fe-1].y,pe.x-ie[fe-1].x,pe.y-ie[fe-1].y],$[$.length-1].deltas.push(Q);break;case"qct":var Re=ie[fe-1].x+2/3*(pe.x1-ie[fe-1].x),X=ie[fe-1].y+2/3*(pe.y1-ie[fe-1].y),_e=pe.x+2/3*(pe.x1-pe.x),me=pe.y+2/3*(pe.y1-pe.y),Z=pe.x,le=pe.y;Q=[Re-ie[fe-1].x,X-ie[fe-1].y,_e-ie[fe-1].x,me-ie[fe-1].y,Z-ie[fe-1].x,le-ie[fe-1].y],$[$.length-1].deltas.push(Q);break;case"arc":$.push({deltas:[],abs:[],arc:!0}),Array.isArray($[$.length-1].abs)&&$[$.length-1].abs.push(pe)}}H=k?null:j==="stroke"?"stroke":"fill";for(var se=!1,Ee=0;Ee<$.length;Ee++)if($[Ee].arc)for(var Ne=$[Ee].abs,ye=0;ye<Ne.length;ye++){var ne=Ne[ye];ne.type==="arc"?B.call(this,ne.x,ne.y,ne.radius,ne.startAngle,ne.endAngle,ne.counterclockwise,void 0,k,!se):te.call(this,ne.x,ne.y),se=!0}else if($[Ee].close===!0)this.pdf.internal.out("h"),se=!1;else if($[Ee].begin!==!0){var ue=$[Ee].start.x,xe=$[Ee].start.y;J.call(this,$[Ee].deltas,ue,xe),se=!0}H&&O.call(this,H),k&&S.call(this)}},G=function(j){var k=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=k*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-Q;case"top":return j+k-Q;case"hanging":return j+k-2*Q;case"middle":return j+k/2-Q;default:return j}},K=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};_.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(k,Q){this.colorStops.push([k,Q])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},_.prototype.createPattern=function(){return this.createLinearGradient()},_.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function(j,k,Q,H,$,ie,fe,pe,de){for(var Re=V.call(this,Q,H,$,ie),X=0;X<Re.length;X++){var _e=Re[X];X===0&&(de?A.call(this,_e.x1+j,_e.y1+k):te.call(this,_e.x1+j,_e.y1+k)),q.call(this,j,k,_e.x2,_e.y2,_e.x3,_e.y3,_e.x4,_e.y4)}pe?S.call(this):O.call(this,fe)},O=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},S=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(j,k){this.pdf.internal.out(n(j)+" "+r(k)+" m")},Y=function(j){var k;switch(j.align){case"right":case"end":k="right";break;case"center":k="center";break;default:k="left"}var Q,H,$,ie=this.pdf.getTextDimensions(j.text),fe=G.call(this,j.y),pe=K.call(this,fe)-ie.h,de=this.ctx.transform.applyToPoint(new c(j.x,fe));if(this.autoPaging){var Re=this.ctx.transform.decompose(),X=new u;X=(X=(X=X.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale);for(var _e=this.ctx.transform.applyToRectangle(new d(j.x,fe,ie.w,ie.h)),me=X.applyToRectangle(new d(j.x,pe,ie.w,ie.h)),Z=v.call(this,me),le=[],se=0;se<Z.length;se+=1)le.indexOf(Z[se])===-1&&le.push(Z[se]);L(le);for(var Ee=le[0],Ne=le[le.length-1],ye=Ee;ye<Ne+1;ye++){this.pdf.setPage(ye);var ne=ye===1?this.posY+this.margin[0]:this.margin[0],ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xe=this.pdf.internal.pageSize.height-this.margin[2],et=xe-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],it=bt-this.margin[3],At=ye===1?0:ue+(ye-2)*et;if(this.ctx.clip_path.length!==0){var at=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=U(Q,this.posX+this.margin[3],-1*At+ne),P.call(this,"fill",!0),this.path=at}var We=U([JSON.parse(JSON.stringify(me))],this.posX+this.margin[3],-At+ne+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(H=this.pdf.internal.getFontSize(),this.pdf.setFontSize(H*j.scale),$=this.lineWidth,this.lineWidth=$*j.scale);var Dt=this.autoPaging!=="text";if(Dt||We.y+We.h<=xe){if(Dt||We.y>=ne&&We.x<=bt){var Tt=Dt?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||bt-We.x)[0],St=U([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-At+ne+this.ctx.prevPageLastElemOffset)[0],ze=Dt&&(ye>Ee||ye<Ne)&&C.call(this);ze&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],it,et,null).clip().discardPath()),this.pdf.text(Tt,St.x,St.y,{angle:j.angle,align:k,renderingMode:j.renderingMode}),ze&&this.pdf.restoreGraphicsState()}}else We.y<xe&&(this.ctx.prevPageLastElemOffset+=xe-We.y);j.scale>=.01&&(this.pdf.setFontSize(H),this.lineWidth=$)}}else j.scale>=.01&&(H=this.pdf.internal.getFontSize(),this.pdf.setFontSize(H*j.scale),$=this.lineWidth,this.lineWidth=$*j.scale),this.pdf.text(j.text,de.x+this.posX,de.y+this.posY,{angle:j.angle,align:k,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(H),this.lineWidth=$)},te=function(j,k,Q,H){Q=Q||0,H=H||0,this.pdf.internal.out(n(j+Q)+" "+r(k+H)+" l")},J=function(j,k,Q){return this.pdf.lines(j,k,Q,null,null)},q=function(j,k,Q,H,$,ie,fe,pe){this.pdf.internal.out([e(i(Q+j)),e(l(H+k)),e(i($+j)),e(l(ie+k)),e(i(fe+j)),e(l(pe+k)),"c"].join(" "))},V=function(j,k,Q,H){for(var $=2*Math.PI,ie=Math.PI/2;k>Q;)k-=$;var fe=Math.abs(Q-k);fe<$&&H&&(fe=$-fe);for(var pe=[],de=H?-1:1,Re=k;fe>1e-5;){var X=Re+de*Math.min(fe,ie);pe.push(F.call(this,j,Re,X)),fe-=Math.abs(X-Re),Re=X}return pe},F=function(j,k,Q){var H=(Q-k)/2,$=j*Math.cos(H),ie=j*Math.sin(H),fe=$,pe=-ie,de=fe*fe+pe*pe,Re=de+fe*$+pe*ie,X=4/3*(Math.sqrt(2*de*Re)-Re)/(fe*ie-pe*$),_e=fe-X*pe,me=pe+X*fe,Z=_e,le=-me,se=H+k,Ee=Math.cos(se),Ne=Math.sin(se);return{x1:j*Math.cos(k),y1:j*Math.sin(k),x2:_e*Ee-me*Ne,y2:_e*Ne+me*Ee,x3:Z*Ee-le*Ne,y3:Z*Ne+le*Ee,x4:j*Math.cos(Q),y4:j*Math.sin(Q)}},I=function(j){return 180*j/Math.PI},ee=function(j,k,Q,H,$,ie){var fe=j+.5*(Q-j),pe=k+.5*(H-k),de=$+.5*(Q-$),Re=ie+.5*(H-ie),X=Math.min(j,$,fe,de),_e=Math.max(j,$,fe,de),me=Math.min(k,ie,pe,Re),Z=Math.max(k,ie,pe,Re);return new d(X,me,_e-X,Z-me)},ae=function(j,k,Q,H,$,ie,fe,pe){var de,Re,X,_e,me,Z,le,se,Ee,Ne,ye,ne,ue,xe,et=Q-j,bt=H-k,it=$-Q,At=ie-H,at=fe-$,We=pe-ie;for(Re=0;Re<41;Re++)Ee=(le=(X=j+(de=Re/40)*et)+de*((me=Q+de*it)-X))+de*(me+de*($+de*at-me)-le),Ne=(se=(_e=k+de*bt)+de*((Z=H+de*At)-_e))+de*(Z+de*(ie+de*We-Z)-se),Re==0?(ye=Ee,ne=Ne,ue=Ee,xe=Ne):(ye=Math.min(ye,Ee),ne=Math.min(ne,Ne),ue=Math.max(ue,Ee),xe=Math.max(xe,Ne));return new d(Math.round(ye),Math.round(ne),Math.round(ue-ye),Math.round(xe-ne))},T=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,k,Q=(j=this.ctx.lineDash,k=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:k}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(en.API),(function(t){var e=function(c){var d,u,f,m,_,y,g,N,C,v;for(u=[],f=0,m=(c+=d="\0\0\0\0".slice(c.length%4||4)).length;m>f;f+=4)(_=(c.charCodeAt(f)<<24)+(c.charCodeAt(f+1)<<16)+(c.charCodeAt(f+2)<<8)+c.charCodeAt(f+3))!==0?(y=(_=((_=((_=((_=(_-(v=_%85))/85)-(C=_%85))/85)-(N=_%85))/85)-(g=_%85))/85)%85,u.push(y+33,g+33,N+33,C+33,v+33)):u.push(122);return(function(R,U){for(var L=U;L>0;L--)R.pop()})(u,d.length),String.fromCharCode.apply(String,u)+"~>"},n=function(c){var d,u,f,m,_,y=String,g="length",N=255,C="charCodeAt",v="slice",R="replace";for(c[v](-2),c=c[v](0,-2)[R](/\s/g,"")[R]("z","!!!!!"),f=[],m=0,_=(c+=d="uuuuu"[v](c[g]%5||5))[g];_>m;m+=5)u=52200625*(c[C](m)-33)+614125*(c[C](m+1)-33)+7225*(c[C](m+2)-33)+85*(c[C](m+3)-33)+(c[C](m+4)-33),f.push(N&u>>24,N&u>>16,N&u>>8,N&u);return(function(U,L){for(var w=L;w>0;w--)U.pop()})(f,d[g]),y.fromCharCode.apply(y,f)},r=function(c){return c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(c){var d=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((c=c.replace(/\s/g,"")).indexOf(">")!==-1&&(c=c.substr(0,c.indexOf(">"))),c.length%2&&(c+="0"),d.test(c)===!1)return"";for(var u="",f=0;f<c.length;f+=2)u+=String.fromCharCode("0x"+(c[f]+c[f+1]));return u},l=function(c){for(var d=new Uint8Array(c.length),u=c.length;u--;)d[u]=c.charCodeAt(u);return(d=Jy(d)).reduce(function(f,m){return f+String.fromCharCode(m)},"")};t.processDataByFilters=function(c,d){var u=0,f=c||"",m=[];for(typeof(d=d||[])=="string"&&(d=[d]),u=0;u<d.length;u+=1)switch(d[u]){case"ASCII85Decode":case"/ASCII85Decode":f=n(f),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=i(f),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=r(f),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=l(f),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+d[u]+'" is not implemented')}return{data:f,reverseChain:m.reverse().join(" ")}}})(en.API),(function(t){t.loadFile=function(e,n,r){return(function(i,l,c){l=l!==!1,c=typeof c=="function"?c:function(){};var d=void 0;try{d=(function(u,f,m){var _=new XMLHttpRequest,y=0,g=function(N){var C=N.length,v=[],R=String.fromCharCode;for(y=0;y<C;y+=1)v.push(R(255&N.charCodeAt(y)));return v.join("")};if(_.open("GET",u,!f),_.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(_.onload=function(){_.status===200?m(g(this.responseText)):m(void 0)}),_.send(null),f&&_.status===200)return g(_.responseText)})(i,l,c)}catch{}return d})(e,n,r)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(en.API),(function(t){function e(){return(pn.html2canvas?Promise.resolve(pn.html2canvas):X1(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(d){return Promise.reject(new Error("Could not load html2canvas: "+d))}).then(function(d){return d.default?d.default:d})}function n(){return(pn.DOMPurify?Promise.resolve(pn.DOMPurify):X1(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(d){return Promise.reject(new Error("Could not load dompurify: "+d))}).then(function(d){return d.default?d.default:d})}var r=function(d){var u=pr(d);return u==="undefined"?"undefined":u==="string"||d instanceof String?"string":u==="number"||d instanceof Number?"number":u==="function"||d instanceof Function?"function":d&&d.constructor===Array?"array":d&&d.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(d,u){var f=document.createElement(d);for(var m in u.className&&(f.className=u.className),u.innerHTML&&u.dompurify&&(f.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)f.style[m]=u.style[m];return f},l=function d(u,f){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),_=u.firstChild;_;_=_.nextSibling)f!==!0&&_.nodeType===1&&_.nodeName==="SCRIPT"||m.appendChild(d(_,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m},c=function d(u){var f=Object.assign(d.convert(Promise.resolve()),JSON.parse(JSON.stringify(d.template))),m=d.convert(Promise.resolve(),f);return(m=m.setProgress(1,d,1,[d])).set(u)};(c.prototype=Object.create(Promise.prototype)).constructor=c,c.convert=function(d,u){return d.__proto__=u||c.prototype,d},c.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},c.prototype.from=function(d,u){return this.then(function(){switch(u=u||(function(f){switch(r(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(d),u){case"string":return this.then(n).then(function(f){return this.set({src:i("div",{innerHTML:d,dompurify:f})})});case"element":return this.set({src:d});case"canvas":return this.set({canvas:d});case"img":return this.set({img:d});default:return this.error("Unknown source type.")}})},c.prototype.to=function(d){switch(d){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},c.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var d={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=l(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(d.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:d}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},c.prototype.toCanvas=function(){var d=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(d).then(e).then(function(u){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,u(this.prop.container,f)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},c.prototype.toContext2d=function(){var d=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(d).then(e).then(function(u){var f=this.opt.jsPDF,m=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=m,m)for(var g=0;g<m.length;++g){var N=m[g],C=N.src.find(function(v){return v.format==="truetype"});C&&f.addFont(C.url,N.ref.name,N.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,f.context2d.save(!0),u(this.prop.container,y)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},c.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var d=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=d})},c.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},c.prototype.output=function(d,u,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(d,u):this.outputPdf(d,u)},c.prototype.outputPdf=function(d,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(d,u)})},c.prototype.outputImg=function(d){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(d){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+d+'" is not supported.'}})},c.prototype.save=function(d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(d?{filename:d}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},c.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},c.prototype.set=function(d){if(r(d)!=="object")return this;var u=Object.keys(d||{}).map(function(f){if(f in c.template.prop)return function(){this.prop[f]=d[f]};switch(f){case"margin":return this.setMargin.bind(this,d.margin);case"jsPDF":return function(){return this.opt.jsPDF=d.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,d.pageSize);default:return function(){this.opt[f]=d[f]}}},this);return this.then(function(){return this.thenList(u)})},c.prototype.get=function(d,u){return this.then(function(){var f=d in c.template.prop?this.prop[d]:this.opt[d];return u?u(f):f})},c.prototype.setMargin=function(d){return this.then(function(){switch(r(d)){case"number":d=[d,d,d,d];case"array":if(d.length===2&&(d=[d[0],d[1],d[0],d[1]]),d.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=d}).then(this.setPageSize)},c.prototype.setPageSize=function(d){function u(f,m){return Math.floor(f*m/72*96)}return this.then(function(){(d=d||en.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(d.inner={width:d.width-this.opt.margin[1]-this.opt.margin[3],height:d.height-this.opt.margin[0]-this.opt.margin[2]},d.inner.px={width:u(d.inner.width,d.k),height:u(d.inner.height,d.k)},d.inner.ratio=d.inner.height/d.inner.width),this.prop.pageSize=d})},c.prototype.setProgress=function(d,u,f,m){return d!=null&&(this.progress.val=d),u!=null&&(this.progress.state=u),f!=null&&(this.progress.n=f),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},c.prototype.updateProgress=function(d,u,f,m){return this.setProgress(d?this.progress.val+d:null,u||null,f?this.progress.n+f:null,m?this.progress.stack.concat(m):null)},c.prototype.then=function(d,u){var f=this;return this.thenCore(d,u,function(m,_){return f.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(y){return f.updateProgress(null,m),y}).then(m,_).then(function(y){return f.updateProgress(1),y})})},c.prototype.thenCore=function(d,u,f){f=f||Promise.prototype.then;var m=this;d&&(d=d.bind(m)),u&&(u=u.bind(m));var _=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:c.convert(Object.assign({},m),Promise.prototype),y=f.call(_,d,u);return c.convert(y,m.__proto__)},c.prototype.thenExternal=function(d,u){return Promise.prototype.then.call(this,d,u)},c.prototype.thenList=function(d){var u=this;return d.forEach(function(f){u=u.thenCore(f)}),u},c.prototype.catch=function(d){d&&(d=d.bind(this));var u=Promise.prototype.catch.call(this,d);return c.convert(u,this)},c.prototype.catchExternal=function(d){return Promise.prototype.catch.call(this,d)},c.prototype.error=function(d){return this.then(function(){throw new Error(d)})},c.prototype.using=c.prototype.set,c.prototype.saveAs=c.prototype.save,c.prototype.export=c.prototype.output,c.prototype.run=c.prototype.then,en.getPageSize=function(d,u,f){if(pr(d)==="object"){var m=d;d=m.orientation,u=m.unit||u,f=m.format||f}u=u||"mm",f=f||"a4",d=(""+(d||"P")).toLowerCase();var _,y=(""+f).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+u}var N,C=0,v=0;if(g.hasOwnProperty(y))C=g[y][1]/_,v=g[y][0]/_;else try{C=f[1],v=f[0]}catch{throw new Error("Invalid format: "+f)}if(d==="p"||d==="portrait")d="p",v>C&&(N=v,v=C,C=N);else{if(d!=="l"&&d!=="landscape")throw"Invalid orientation: "+d;d="l",C>v&&(N=v,v=C,C=N)}return{width:v,height:C,unit:u,k:_,orientation:d}},t.html=function(d,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(ZC):null;var f=new c(u);return u.worker?f:f.from(d).doCallback()}})(en.API),en.API.addJS=function(t){var e,n,r=(function(i){for(var l="",c=0;c<i.length;c++){var d=i[c];if(d==="("||d===")"){for(var u=0,f=c-1;f>=0&&i[f]==="\\";f--)u++;l+=u%2==0?"\\"+d:d}else l+=d}return l})(t);return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+r+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),l=0;l<i.length;l++){var c=i[l],d=r.exec(c);if(d!=null){var u=d[1];n.internal.newObjectDeferredBegin(u,!1)}n.internal.write(c)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,m=[];for(l=0;l<f;l++){var _=n.internal.newObject();m.push(_);var y=n.internal.getPageInfo(l+1);n.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var g=n.internal.newObject();for(n.internal.write("<< /Names [ "),l=0;l<m.length;l++)n.internal.write("(page_"+(l+1)+")"+m[l]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+g+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,l){var c={title:i,options:l,children:[]};return r==null&&(r=this.root),r.children.push(c),c},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,l=0;l<r.children.length;l++){var c=r.children[l];this.objStart(c),this.line("/Title "+this.makeString(c.title)),this.line("/Parent "+this.makeRef(r)),l>0&&this.line("/Prev "+this.makeRef(r.children[l-1])),l<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[l+1])),c.children.length>0&&(this.line("/First "+this.makeRef(c.children[0])),this.line("/Last "+this.makeRef(c.children[c.children.length-1])));var d=this.count=this.count_r({count:0},c);if(d>0&&this.line("/Count "+d),c.options&&c.options.pageNumber){var u=n.internal.getPageInfo(c.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var f=0;f<r.children.length;f++)this.renderItems(r.children[f])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var l=0;l<i.children.length;l++)r.count++,this.count_r(r,i.children[l]);return r.count}}])})(en.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,l,c,d){var u,f=this.decode.DCT_DECODE,m=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=c||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,u=(function(_){for(var y,g=256*_.charCodeAt(4)+_.charCodeAt(5),N=_.length,C={width:0,height:0,numcomponents:1},v=4;v<N;v+=2){if(v+=g,e.indexOf(_.charCodeAt(v+1))!==-1){y=256*_.charCodeAt(v+5)+_.charCodeAt(v+6),C={width:256*_.charCodeAt(v+7)+_.charCodeAt(v+8),height:y,numcomponents:_.charCodeAt(v+9)};break}g=256*_.charCodeAt(v+2)+_.charCodeAt(v+3)}return C})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),u.numcomponents){case 1:d=this.color_spaces.DEVICE_GRAY;break;case 4:d=this.color_spaces.DEVICE_CMYK;break;case 3:d=this.color_spaces.DEVICE_RGB}m={data:n,width:u.width,height:u.height,colorSpace:d,bitsPerComponent:8,filter:f,index:r,alias:i}}return m}})(en.API),en.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,l=yF(t,{checkCrc:!0}),c=l.width,d=l.height,u=l.channels,f=l.palette,m=l.depth;i=f&&u===1?(function(B){for(var O=B.width,S=B.height,A=B.data,Y=B.palette,te=B.depth,J=!1,q=[],V=[],F=void 0,I=!1,ee=0,ae=0;ae<Y.length;ae++){var T=hR(Y[ae],4),j=T[0],k=T[1],Q=T[2],H=T[3];q.push(j,k,Q),H!=null&&(H===0?(ee++,V.length<1&&V.push(ae)):H<255&&(I=!0))}if(I||ee>1){J=!0,V=void 0;var $=O*S;F=new Uint8Array($);for(var ie=new DataView(A.buffer),fe=0;fe<$;fe++){var pe=ty(ie,fe,te),de=hR(Y[pe],4)[3];F[fe]=de}}else ee===0&&(V=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:J?8:void 0,colorBytes:A,alphaBytes:F,needSMask:J,palette:q,mask:V}})(l):u===2||u===4?(function(B){for(var O=B.data,S=B.width,A=B.height,Y=B.channels,te=B.depth,J=Y===2?"DeviceGray":"DeviceRGB",q=Y-1,V=S*A,F=q,I=V*F,ee=1*V,ae=Math.ceil(I*te/8),T=Math.ceil(ee*te/8),j=new Uint8Array(ae),k=new Uint8Array(T),Q=new DataView(O.buffer),H=new DataView(j.buffer),$=new DataView(k.buffer),ie=!1,fe=0;fe<V;fe++){for(var pe=fe*Y,de=0;de<F;de++)gT(H,ty(Q,pe+de,te),fe*F+de,te);var Re=ty(Q,pe+F,te);Re<(1<<te)-1&&(ie=!0),gT($,Re,1*fe,te)}return{colorSpace:J,colorsPerPixel:q,sMaskBitsPerComponent:ie?te:void 0,colorBytes:j,alphaBytes:k,needSMask:ie}})(l):(function(B){var O=B.data,S=B.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:S,colorsPerPixel:S==="DeviceGray"?1:3,colorBytes:O instanceof Uint16Array?(function(A){for(var Y=A.length,te=new Uint8Array(2*Y),J=new DataView(te.buffer,te.byteOffset,te.byteLength),q=0;q<Y;q++)J.setUint16(2*q,A[q],!1);return te})(O):O,needSMask:!1}})(l);var _,y,g,N=i,C=N.colorSpace,v=N.colorsPerPixel,R=N.sMaskBitsPerComponent,U=N.colorBytes,L=N.alphaBytes,w=N.needSMask,P=N.palette,G=N.mask,K=null;return r!==en.API.image_compression.NONE&&typeof Jy=="function"?(K=(function(B){var O;switch(B){case en.API.image_compression.FAST:O=11;break;case en.API.image_compression.MEDIUM:O=13;break;case en.API.image_compression.SLOW:O=14;break;default:O=12}return O})(r),_=this.decode.FLATE_DECODE,y="/Predictor ".concat(K," /Colors ").concat(v," /BitsPerComponent ").concat(m," /Columns ").concat(c),t=dT(U,Math.ceil(c*v*m/8),v,m,r),w&&(g=dT(L,Math.ceil(c*R/8),1,R,r))):(_=void 0,y=void 0,t=U,w&&(g=L)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:n,data:t,index:e,filter:_,decodeParameters:y,transparency:G,palette:P,sMask:g,predictor:K,width:c,height:d,bitsPerComponent:m,sMaskBitsPerComponent:R,colorSpace:C}}},(function(t){t.processGIF89A=function(e,n,r,i){var l=new FF(e),c=l.width,d=l.height,u=[];l.decodeAndBlitFrameRGBA(0,u);var f={data:u,width:c,height:d},m=new sy(100).encode(f,100);return t.processJPEG.call(this,m,n,r,i)},t.processGIF87A=t.processGIF89A})(en.API),vo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:l}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},vo.prototype.parseBGR=function(){this.pos=this.offset;var t="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[t]()}catch(n){jr.log("bit decode error:"+n)}},vo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var l=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+8*i*4,d=0;d<8&&8*i+d<this.width;d++){var u=this.palette[l>>7-d&1];this.data[c+4*d]=u.blue,this.data[c+4*d+1]=u.green,this.data[c+4*d+2]=u.red,this.data[c+4*d+3]=255}n!==0&&(this.pos+=4-n)}},vo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var l=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+2*i*4,d=l>>4,u=15&l,f=this.palette[d];if(this.data[c]=f.blue,this.data[c+1]=f.green,this.data[c+2]=f.red,this.data[c+3]=255,2*i+1>=this.width)break;f=this.palette[u],this.data[c+4]=f.blue,this.data[c+4+1]=f.green,this.data[c+4+2]=f.red,this.data[c+4+3]=255}e!==0&&(this.pos+=4-e)}},vo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*r;if(i<this.palette.length){var c=this.palette[i];this.data[l]=c.red,this.data[l+1]=c.green,this.data[l+2]=c.blue,this.data[l+3]=255}else this.data[l]=255,this.data[l+1]=255,this.data[l+2]=255,this.data[l+3]=255}t!==0&&(this.pos+=4-t)}},vo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&e)/e*255|0,d=(l>>5&e)/e*255|0,u=(l>>10&e)/e*255|0,f=l>>15?255:0,m=r*this.width*4+4*i;this.data[m]=u,this.data[m+1]=d,this.data[m+2]=c,this.data[m+3]=f}this.pos+=t}},vo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,l=0;l<this.width;l++){var c=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(c&e)/e*255|0,u=(c>>5&n)/n*255|0,f=(c>>11)/e*255|0,m=i*this.width*4+4*l;this.data[m]=f,this.data[m+1]=u,this.data[m+2]=d,this.data[m+3]=255}this.pos+=t}},vo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*n;this.data[c]=l,this.data[c+1]=i,this.data[c+2]=r,this.data[c+3]=255}this.pos+=this.width%4}},vo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=e*this.width*4+4*n;this.data[d]=l,this.data[d+1]=i,this.data[d+2]=r,this.data[d+3]=c}},vo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,n,r,i){var l=new vo(e,!1),c=l.width,d=l.height,u={data:l.getData(),width:c,height:d},f=new sy(100).encode(u,100);return t.processJPEG.call(this,f,n,r,i)}})(en.API),_T.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,n,r,i){var l=new _T(e),c=l.width,d=l.height,u={data:l.getData(),width:c,height:d},f=new sy(100).encode(u,100);return t.processJPEG.call(this,f,n,r,i)}})(en.API),en.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,l=new Uint8Array(i/4*3),c=new Uint8Array(i/4),d=0,u=0,f=0;f<i;f+=4){var m=r[f],_=r[f+1],y=r[f+2],g=r[f+3];l[d++]=m,l[d++]=_,l[d++]=y,c[u++]=g}var N=this.__addimage__.arrayBufferToBinaryString(l);return{alpha:this.__addimage__.arrayBufferToBinaryString(c),data:N,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},en.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},w0=en.API,e_=w0.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),l=e.fontSize||this.internal.getFontSize(),c=e.charSpace||this.internal.getCharSpace(),d=e.widths?e.widths:i.metadata.Unicode.widths,u=d.fof?d.fof:1,f=e.kerning?e.kerning:i.metadata.Unicode.kerning,m=f.fof?f.fof:1,_=e.doKerning!==!1,y=0,g=t.length,N=0,C=d[0]||u,v=[];for(n=0;n<g;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?v.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+c*(1e3/l)||0)/1e3):(y=_&&pr(f[r])==="object"&&!isNaN(parseInt(f[r][N],10))?f[r][N]/m:0,v.push((d[r]||C)/u+y)),N=r;return v},lT=w0.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return w0.processArabic&&(t=w0.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:e_.apply(this,arguments).reduce(function(l,c){return l+c},0)},oT=function(t,e,n,r){for(var i=[],l=0,c=t.length,d=0;l!==c&&d+e[l]<n;)d+=e[l],l++;i.push(t.slice(0,l));var u=l;for(d=0;l!==c;)d+e[l]>r&&(i.push(t.slice(u,l)),d=0,u=l),d+=e[l],l++;return u!==l&&i.push(t.slice(u,l)),i},cT=function(t,e,n){n||(n={});var r,i,l,c,d,u,f,m=[],_=[m],y=n.textIndent||0,g=0,N=0,C=t.split(" "),v=e_.apply(this,[" ",n])[0];if(u=n.lineIndent===-1?C[0].length+2:n.lineIndent||0){var R=Array(u).join(" "),U=[];C.map(function(w){(w=w.split(/\s*\n/)).length>1?U=U.concat(w.map(function(P,G){return(G&&P.length?`
`:"")+P})):U.push(w[0])}),C=U,u=lT.apply(this,[R,n])}for(l=0,c=C.length;l<c;l++){var L=0;if(r=C[l],u&&r[0]==`
`&&(r=r.substr(1),L=1),y+g+(N=(i=e_.apply(this,[r,n])).reduce(function(w,P){return w+P},0))>e||L){if(N>e){for(d=oT.apply(this,[r,i,e-(y+g),e]),m.push(d.shift()),m=[d.pop()];d.length;)_.push([d.shift()]);N=i.slice(r.length-(m[0]?m[0].length:0)).reduce(function(w,P){return w+P},0)}else m=[r];_.push(m),y=N+u,g=v}else m.push(r),y+=g+N,g=v}return f=u?function(w,P){return(P?R:"")+w.join(" ")}:function(w){return w.join(" ")},_.map(f)},w0.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),l=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var _=this.internal.getFont(m.fontName,m.fontStyle),y="Unicode";return _.metadata[y]?{widths:_.metadata[y].widths||{0:1},kerning:_.metadata[y].kerning||{}}:{font:_.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var c=1*this.internal.scaleFactor*e/i;l.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,l.lineIndent=n.lineIndent;var d,u,f=[];for(d=0,u=r.length;d<u;d++)f=f.concat(cT.apply(this,[r[d],c,l]));return f},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},l=0;l<16;l++)r[n[l]]=e[l],i[e[l]]=n[l];var c=function(y){return"0x"+parseInt(y,10).toString(16)},d=t.__fontmetrics__.compress=function(y){var g,N,C,v,R=["{"];for(var U in y){if(g=y[U],isNaN(parseInt(U,10))?N="'"+U+"'":(U=parseInt(U,10),N=(N=c(U).slice(2)).slice(0,-1)+i[N.slice(-1)]),typeof g=="number")g<0?(C=c(g).slice(3),v="-"):(C=c(g).slice(2),v=""),C=v+C.slice(0,-1)+i[C.slice(-1)];else{if(pr(g)!=="object")throw new Error("Don't know what to do with value type "+pr(g)+".");C=d(g)}R.push(N+C)}return R.push("}"),R.join("")},u=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,N,C,v,R={},U=1,L=R,w=[],P="",G="",K=y.length-1,B=1;B<K;B+=1)(v=y[B])=="'"?g?(C=g.join(""),g=void 0):g=[]:g?g.push(v):v=="{"?(w.push([L,C]),L={},C=void 0):v=="}"?((N=w.pop())[0][N[1]]=L,C=void 0,L=N[0]):v=="-"?U=-1:C===void 0?r.hasOwnProperty(v)?(P+=r[v],C=parseInt(P,16)*U,U=1,P=""):P+=v:r.hasOwnProperty(v)?(G+=r[v],L[C]=parseInt(G,16)*U,U=1,C=void 0,G=""):G+=v;return R},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},_={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,N=_.Unicode[g.postScriptName];N&&(g.metadata.Unicode={},g.metadata.Unicode.widths=N.widths,g.metadata.Unicode.kerning=N.kerning);var C=m.Unicode[g.postScriptName];C&&(g.metadata.Unicode.encoding=C,g.encoding=C.codePages[0])}])})(en.API),(function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),l=0;l<r;l++)i[l]=n.charCodeAt(l);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,l=n.instance;if(!i.isStandardFont){if(l===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=l.existsFileInVFS(i.postScriptName)===!1?l.loadFile(i.postScriptName):l.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(c,d){d=/^\x00\x01\x00\x00/.test(d)?e(d):e(f_(d)),c.metadata=t.API.TTFFont.open(d),c.metadata.Unicode=c.metadata.Unicode||{encoding:{},kerning:{},widths:[]},c.metadata.glyIdsUsed=[0]})(i,r)}}])})(en),en.API.addSvgAsImage=function(t,e,n,r,i,l,c,d){if(isNaN(e)||isNaN(n))throw jr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw jr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=r,u.height=i;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},_=this;return(pn.canvg?Promise.resolve(pn.canvg):X1(()=>import("./index.es-0v8IYx4a.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(f,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(m)}).then(function(){_.addImage(u.toDataURL("image/jpeg",1),e,n,r,i,c,d)})},en.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},en.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,l,c={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},d=Object.keys(c),u=[],f=0,m=0,_=0;function y(N,C){var v,R=!1;for(v=0;v<N.length;v+=1)N[v]===C&&(R=!0);return R}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(c)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=d.length;for(_=0;_<g;_+=1)n[d[_]].value=n[d[_]].defaultValue,n[d[_]].explicitSet=!1}if(pr(t)==="object"){for(i in t)if(l=t[i],y(d,i)&&l!==void 0){if(n[i].type==="boolean"&&typeof l=="boolean")n[i].value=l;else if(n[i].type==="name"&&y(n[i].valueSet,l))n[i].value=l;else if(n[i].type==="integer"&&Number.isInteger(l))n[i].value=l;else if(n[i].type==="array"){for(f=0;f<l.length;f+=1)if(r=!0,l[f].length===1&&typeof l[f][0]=="number")u.push(String(l[f]-1));else if(l[f].length>1){for(m=0;m<l[f].length;m+=1)typeof l[f][m]!="number"&&(r=!1);r===!0&&u.push([l[f][0]-1,l[f][1]-1].join(" "))}n[i].value="["+u.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var N,C=[];for(N in n)n[N].explicitSet===!0&&(n[N].type==="name"?C.push("/"+N+" /"+n[N].value):C.push("/"+N+" "+n[N].value));C.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+C.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},en.API.addMetadata=function(t,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",QF),this.internal.events.subscribe("postPutResources",KF)),this},(function(t){var e=t.API,n=e.pdfEscape16=function(l,c){for(var d,u=c.metadata.Unicode.widths,f=["","0","00","000","0000"],m=[""],_=0,y=l.length;_<y;++_){if(d=c.metadata.characterToGlyph(l.charCodeAt(_)),c.metadata.glyIdsUsed.push(d),c.metadata.toUnicode[d]=l.charCodeAt(_),u.indexOf(d)==-1&&(u.push(d),u.push([parseInt(c.metadata.widthOfGlyph(d),10)])),d=="0")return m.join("");d=d.toString(16),m.push(f[4-d.length],d)}return m.join("")},r=function(l){var c,d,u,f,m,_,y;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],_=0,y=(d=Object.keys(l).sort(function(g,N){return g-N})).length;_<y;_++)c=d[_],u.length>=100&&(m+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),l[c]!==void 0&&l[c]!==null&&typeof l[c].toString=="function"&&(f=("0000"+l[c].toString(16)).slice(-4),c=("0000"+(+c).toString(16)).slice(-4),u.push("<"+c+"><"+f+">"));return u.length&&(m+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(l){(function(c){var d=c.font,u=c.out,f=c.newObject,m=c.putStream;if(d.metadata instanceof t.API.TTFFont&&d.encoding==="Identity-H"){for(var _=d.metadata.Unicode.widths,y=d.metadata.subset.encode(d.metadata.glyIdsUsed,1),g="",N=0;N<y.length;N++)g+=String.fromCharCode(y[N]);var C=f();m({data:g,addLength1:!0,objectId:C}),u("endobj");var v=f();m({data:r(d.metadata.toUnicode),addLength1:!0,objectId:v}),u("endobj");var R=f();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Q0(d.fontName)),u("/FontFile2 "+C+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(d.metadata.bbox)),u("/Flags "+d.metadata.flags),u("/StemV "+d.metadata.stemV),u("/ItalicAngle "+d.metadata.italicAngle),u("/Ascent "+d.metadata.ascender),u("/Descent "+d.metadata.decender),u("/CapHeight "+d.metadata.capHeight),u(">>"),u("endobj");var U=f();u("<<"),u("/Type /Font"),u("/BaseFont /"+Q0(d.fontName)),u("/FontDescriptor "+R+" 0 R"),u("/W "+t.API.PDFObject.convert(_)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+d.encoding+")"),u(">>"),u(">>"),u("endobj"),d.objectNumber=f(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+v+" 0 R"),u("/BaseFont /"+Q0(d.fontName)),u("/Encoding /"+d.encoding),u("/DescendantFonts ["+U+" 0 R]"),u(">>"),u("endobj"),d.isAlreadyPutted=!0}})(l)}]),e.events.push(["putFont",function(l){(function(c){var d=c.font,u=c.out,f=c.newObject,m=c.putStream;if(d.metadata instanceof t.API.TTFFont&&d.encoding==="WinAnsiEncoding"){for(var _=d.metadata.rawData,y="",g=0;g<_.length;g++)y+=String.fromCharCode(_[g]);var N=f();m({data:y,addLength1:!0,objectId:N}),u("endobj");var C=f();m({data:r(d.metadata.toUnicode),addLength1:!0,objectId:C}),u("endobj");var v=f();u("<<"),u("/Descent "+d.metadata.decender),u("/CapHeight "+d.metadata.capHeight),u("/StemV "+d.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+N+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(d.metadata.bbox)),u("/FontName /"+Q0(d.fontName)),u("/ItalicAngle "+d.metadata.italicAngle),u("/Ascent "+d.metadata.ascender),u(">>"),u("endobj"),d.objectNumber=f();for(var R=0;R<d.metadata.hmtx.widths.length;R++)d.metadata.hmtx.widths[R]=parseInt(d.metadata.hmtx.widths[R]*(1e3/d.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+C+" 0 R/BaseFont/"+Q0(d.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+d.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(d.metadata.hmtx.widths)+">>"),u("endobj"),d.isAlreadyPutted=!0}})(l)}]);var i=function(l){var c,d=l.text||"",u=l.x,f=l.y,m=l.options||{},_=l.mutex||{},y=_.pdfEscape,g=_.activeFontKey,N=_.fonts,C=g,v="",R=0,U="",L=N[C].encoding;if(N[C].encoding!=="Identity-H")return{text:d,x:u,y:f,options:m,mutex:_};for(U=d,C=g,Array.isArray(d)&&(U=d[0]),R=0;R<U.length;R+=1)N[C].metadata.hasOwnProperty("cmap")&&(c=N[C].metadata.cmap.unicode.codeMap[U[R].charCodeAt(0)]),c||U[R].charCodeAt(0)<256&&N[C].metadata.hasOwnProperty("Unicode")?v+=U[R]:v+="";var w="";return parseInt(C.slice(1))<14||L==="WinAnsiEncoding"?w=y(v,C).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):L==="Identity-H"&&(w=n(v,N[C])),_.isHex=!0,{text:w,x:u,y:f,options:m,mutex:_}};e.events.push(["postProcessText",function(l){var c=l.text||"",d=[],u={text:c,x:l.x,y:l.y,options:l.options,mutex:l.mutex};if(Array.isArray(c)){var f=0;for(f=0;f<c.length;f+=1)Array.isArray(c[f])&&c[f].length===3?d.push([i(Object.assign({},u,{text:c[f][0]})).text,c[f][1],c[f][2]]):d.push(i(Object.assign({},u,{text:c[f]})).text);l.text=d}else l.text=i(Object.assign({},u,{text:c})).text}])})(en),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(en.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,l,c,d,u,f,m,_=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},C={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],R=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),U=!1,L=0;this.__bidiEngine__={};var w=function(A){var Y=A.charCodeAt(),te=Y>>8,J=C[te];return J!==void 0?_[256*J+(255&Y)]:te===252||te===253?"AL":R.test(te)?"L":te===8?"R":"N"},P=function(A){for(var Y,te=0;te<A.length;te++){if((Y=w(A.charAt(te)))==="L")return!1;if(Y==="R")return!0}return!1},G=function(A,Y,te,J){var q,V,F,I,ee=Y[J];switch(ee){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":U=!1;break;case"N":case"AN":break;case"EN":U&&(ee="AN");break;case"AL":U=!0,ee="R";break;case"WS":case"BN":ee="N";break;case"CS":J<1||J+1>=Y.length||(q=te[J-1])!=="EN"&&q!=="AN"||(V=Y[J+1])!=="EN"&&V!=="AN"?ee="N":U&&(V="AN"),ee=V===q?V:"N";break;case"ES":ee=(q=J>0?te[J-1]:"B")==="EN"&&J+1<Y.length&&Y[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&te[J-1]==="EN"){ee="EN";break}if(U){ee="N";break}for(F=J+1,I=Y.length;F<I&&Y[F]==="ET";)F++;ee=F<I&&Y[F]==="EN"?"EN":"N";break;case"NSM":if(c&&!d){for(I=Y.length,F=J+1;F<I&&Y[F]==="NSM";)F++;if(F<I){var ae=A[J],T=ae>=1425&&ae<=2303||ae===64286;if(q=Y[F],T&&(q==="R"||q==="AL")){ee="R";break}}}ee=J<1||(q=Y[J-1])==="B"?"N":te[J-1];break;case"B":U=!1,i=!0,ee=L;break;case"S":l=!0,ee="N"}return ee},K=function(A,Y,te){var J=A.split("");return te&&B(J,te,{hiLevel:L}),J.reverse(),Y&&Y.reverse(),J.join("")},B=function(A,Y,te){var J,q,V,F,I,ee=-1,ae=A.length,T=0,j=[],k=L?g:y,Q=[];for(U=!1,i=!1,l=!1,q=0;q<ae;q++)Q[q]=w(A[q]);for(V=0;V<ae;V++){if(I=T,j[V]=G(A,Q,j,V),J=240&(T=k[I][N[j[V]]]),T&=15,Y[V]=F=k[T][5],J>0)if(J===16){for(q=ee;q<V;q++)Y[q]=1;ee=-1}else ee=-1;if(k[T][6])ee===-1&&(ee=V);else if(ee>-1){for(q=ee;q<V;q++)Y[q]=F;ee=-1}Q[V]==="B"&&(Y[V]=0),te.hiLevel|=F}l&&(function(H,$,ie){for(var fe=0;fe<ie;fe++)if(H[fe]==="S"){$[fe]=L;for(var pe=fe-1;pe>=0&&H[pe]==="WS";pe--)$[pe]=L}})(Q,Y,ae)},O=function(A,Y,te,J,q){if(!(q.hiLevel<A)){if(A===1&&L===1&&!i)return Y.reverse(),void(te&&te.reverse());for(var V,F,I,ee,ae=Y.length,T=0;T<ae;){if(J[T]>=A){for(I=T+1;I<ae&&J[I]>=A;)I++;for(ee=T,F=I-1;ee<F;ee++,F--)V=Y[ee],Y[ee]=Y[F],Y[F]=V,te&&(V=te[ee],te[ee]=te[F],te[F]=V);T=I}T++}}},S=function(A,Y,te){var J=A.split(""),q={hiLevel:L};return te||(te=[]),B(J,te,q),(function(V,F,I){if(I.hiLevel!==0&&m)for(var ee,ae=0;ae<V.length;ae++)F[ae]===1&&(ee=v.indexOf(V[ae]))>=0&&(V[ae]=v[ee+1])})(J,te,q),O(2,J,Y,te,q),O(1,J,Y,te,q),J.join("")};return this.__bidiEngine__.doBidiReorder=function(A,Y,te){if((function(q,V){if(V)for(var F=0;F<q.length;F++)V[F]=F;d===void 0&&(d=P(q)),f===void 0&&(f=P(q))})(A,Y),c||!u||f)if(c&&u&&d^f)L=d?1:0,A=K(A,Y,te);else if(!c&&u&&f)L=d?1:0,A=S(A,Y,te),A=K(A,Y);else if(!c||d||u||f){if(c&&!u&&d^f)A=K(A,Y),d?(L=0,A=S(A,Y,te)):(L=1,A=S(A,Y,te),A=K(A,Y));else if(c&&d&&!u&&f)L=1,A=S(A,Y,te),A=K(A,Y);else if(!c&&!u&&d^f){var J=m;d?(L=1,A=S(A,Y,te),L=0,m=!1,A=S(A,Y,te),m=J):(L=0,A=S(A,Y,te),A=K(A,Y),L=1,m=!1,A=S(A,Y,te),m=J,A=K(A,Y))}}else L=0,A=S(A,Y,te);else L=d?1:0,A=S(A,Y,te);return A},this.__bidiEngine__.setOptions=function(A){A&&(c=A.isInputVisual,u=A.isOutputVisual,d=A.isInputRtl,f=A.isOutputRtl,m=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var l=r.options||{};r.mutex,l.lang;var c=[];if(l.isInputVisual=typeof l.isInputVisual!="boolean"||l.isInputVisual,n.setOptions(l),Object.prototype.toString.call(i)==="[object Array]"){var d=0;for(c=[],d=0;d<i.length;d+=1)Object.prototype.toString.call(i[d])==="[object Array]"?c.push([n.doBidiReorder(i[d][0]),i[d][1],i[d][2]]):c.push([n.doBidiReorder(i[d])]);r.text=c}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])})(en),en.API.TTFFont=(function(){function t(e){var n;if(this.rawData=e,n=this.contents=new Nu(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new rK(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new GF(this.contents),this.head=new VF(this),this.name=new XF(this),this.cmap=new AI(this),this.toUnicode={},this.hhea=new $F(this),this.maxp=new JF(this),this.hmtx=new ZF(this),this.post=new zF(this),this.os2=new HF(this),this.loca=new nK(this),this.glyf=new eK(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,l;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var c,d,u,f;for(f=[],c=0,d=(u=this.bbox).length;c<d;c++)e=u[c],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(l=this.familyClass)===1||l===2||l===3||l===4||l===5||l===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,l,c,d;for(c=0,l=0,d=(e=""+e).length;0<=d?l<d:l>d;l=0<=d?++l:--l)i=e.charCodeAt(l),c+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return c*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t})();var Po,Nu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,l,c,d,u;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),l=this.readByte(),c=this.readByte(),d=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^l)+65536*(255^c)+256*(255^d)+(255^u)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*l+65536*c+256*d+u},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,l;for(l=[],r=0,i=e.length;r<i;r++)n=e[r],l.push(this.writeByte(n));return l},t})(),GF=(function(){var t;function e(n){var r,i,l;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,l=this.tableCount;0<=l?i<l:i>l;i=0<=l?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,l,c,d,u,f,m,_,y,g,N,C;for(C in g=Object.keys(n).length,u=Math.log(2),_=16*Math.floor(Math.log(g)/u),c=Math.floor(_/u),m=16*g-_,(i=new Nu).writeInt(this.scalarType),i.writeShort(g),i.writeShort(_),i.writeShort(c),i.writeShort(m),l=16*g,f=i.pos+l,d=null,N=[],n)for(y=n[C],i.writeString(C),i.writeInt(t(y)),i.writeInt(f),i.writeInt(y.length),N=N.concat(y),C==="head"&&(d=f),f+=y.length;f%4;)N.push(0),f++;return i.write(N),r=2981146554-t(i.data),i.pos=d+8,i.writeUInt32(r),i.data},t=function(n){var r,i,l,c;for(n=kI.call(n);n.length%4;)n.push(0);for(l=new Nu(n),i=0,r=0,c=n.length;r<c;r=r+=4)i+=l.readUInt32();return 4294967295&i},e})(),YF={}.hasOwnProperty,pc=function(t,e){for(var n in e)YF.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Po=(function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var VF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new Nu).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t})(),xT=(function(){function t(e,n){var r,i,l,c,d,u,f,m,_,y,g,N,C,v,R,U,L;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),_=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(g=e.readUInt16(),y=g/2,e.pos+=6,l=(function(){var w,P;for(P=[],u=w=0;0<=y?w<y:w>y;u=0<=y?++w:--w)P.push(e.readUInt16());return P})(),e.pos+=2,C=(function(){var w,P;for(P=[],u=w=0;0<=y?w<y:w>y;u=0<=y?++w:--w)P.push(e.readUInt16());return P})(),f=(function(){var w,P;for(P=[],u=w=0;0<=y?w<y:w>y;u=0<=y?++w:--w)P.push(e.readUInt16());return P})(),m=(function(){var w,P;for(P=[],u=w=0;0<=y?w<y:w>y;u=0<=y?++w:--w)P.push(e.readUInt16());return P})(),i=(this.length-e.pos+this.offset)/2,d=(function(){var w,P;for(P=[],u=w=0;0<=i?w<i:w>i;u=0<=i?++w:--w)P.push(e.readUInt16());return P})(),u=R=0,L=l.length;R<L;u=++R)for(v=l[u],r=U=N=C[u];N<=v?U<=v:U>=v;r=N<=v?++U:--U)m[u]===0?c=r+f[u]:(c=d[m[u]/2+(r-N)-(y-u)]||0)!==0&&(c+=f[u]),this.codeMap[r]=65535&c}e.pos=_}return t.encode=function(e,n){var r,i,l,c,d,u,f,m,_,y,g,N,C,v,R,U,L,w,P,G,K,B,O,S,A,Y,te,J,q,V,F,I,ee,ae,T,j,k,Q,H,$,ie,fe,pe,de,Re,X;switch(J=new Nu,c=Object.keys(e).sort(function(_e,me){return _e-me}),n){case"macroman":for(C=0,v=(function(){var _e=[];for(N=0;N<256;++N)_e.push(0);return _e})(),U={0:0},l={},q=0,ee=c.length;q<ee;q++)U[pe=e[i=c[q]]]==null&&(U[pe]=++C),l[i]={old:e[i],new:U[e[i]]},v[i]=U[e[i]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(v),{charMap:l,subtable:J.data,maxGlyphID:C+1};case"unicode":for(Y=[],_=[],L=0,U={},r={},R=f=null,V=0,ae=c.length;V<ae;V++)U[P=e[i=c[V]]]==null&&(U[P]=++L),r[i]={old:P,new:U[P]},d=U[P]-i,R!=null&&d===f||(R&&_.push(R),Y.push(i),f=d),R=i;for(R&&_.push(R),_.push(65535),Y.push(65535),S=2*(O=Y.length),B=2*Math.pow(Math.log(O)/Math.LN2,2),y=Math.log(B/2)/Math.LN2,K=2*O-B,u=[],G=[],g=[],N=F=0,T=Y.length;F<T;N=++F){if(A=Y[N],m=_[N],A===65535){u.push(0),G.push(0);break}if(A-(te=r[A].new)>=32768)for(u.push(0),G.push(2*(g.length+O-N)),i=I=A;A<=m?I<=m:I>=m;i=A<=m?++I:--I)g.push(r[i].new);else u.push(te-A),G.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*O+2*g.length),J.writeUInt16(0),J.writeUInt16(S),J.writeUInt16(B),J.writeUInt16(y),J.writeUInt16(K),ie=0,j=_.length;ie<j;ie++)i=_[ie],J.writeUInt16(i);for(J.writeUInt16(0),fe=0,k=Y.length;fe<k;fe++)i=Y[fe],J.writeUInt16(i);for(de=0,Q=u.length;de<Q;de++)d=u[de],J.writeUInt16(d);for(Re=0,H=G.length;Re<H;Re++)w=G[Re],J.writeUInt16(w);for(X=0,$=g.length;X<$;X++)C=g[X],J.writeUInt16(C);return{charMap:r,subtable:J.data,maxGlyphID:L+1}}},t})(),AI=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new xT(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,i;return n==null&&(n="macroman"),r=xT.encode(e,n),(i=new Nu).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t})(),$F=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),HF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r})(),this.charRange=(function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),zF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var l;for(r=e.readUInt16(),this.glyphNameIndex=[],l=0;0<=r?l<r:l>r;l=0<=r?++l:--l)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var c,d,u;for(u=[],l=c=0,d=this.file.maxp.numGlyphs;0<=d?c<d:c>d;l=0<=d?++c:--c)u.push(e.readUInt32());return u}).call(this)}},t})(),qF=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},XF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,i,l,c,d,u,f,m,_,y;for(e.pos=this.offset,e.readShort(),n=e.readShort(),d=e.readShort(),r=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+d+e.readShort()});for(u={},l=m=0,_=r.length;m<_;l=++m)i=r[l],e.pos=i.offset,f=e.readString(i.length),c=new qF(f,i),u[y=i.nameID]==null&&(u[y]=[]),u[i.nameID].push(c);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),JF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),ZF=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,i,l,c,d,u;for(e.pos=this.offset,this.metrics=[],n=0,d=this.file.hhea.numberOfMetrics;0<=d?n<d:n>d;n=0<=d?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,m;for(m=[],n=f=0;0<=i?f<i:f>i;n=0<=i?++f:--f)m.push(e.readInt16());return m})(),this.widths=(function(){var f,m,_,y;for(y=[],f=0,m=(_=this.metrics).length;f<m;f++)l=_[f],y.push(l.advance);return y}).call(this),r=this.widths[this.widths.length-1],u=[],n=c=0;0<=i?c<i:c>i;n=0<=i?++c:--c)u.push(this.widths.push(r));return u},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),kI=[].slice,eK=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,i,l,c,d,u,f,m,_;return e in this.cache?this.cache[e]:(l=this.file.loca,n=this.file.contents,r=l.indexOf(e),(i=l.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,c=(d=new Nu(n.read(i))).readShort(),f=d.readShort(),_=d.readShort(),u=d.readShort(),m=d.readShort(),this.cache[e]=c===-1?new sK(d,f,_,u,m):new tK(d,c,f,_,u,m),this.cache[e]))},t.prototype.encode=function(e,n,r){var i,l,c,d,u;for(c=[],l=[],d=0,u=n.length;d<u;d++)i=e[n[d]],l.push(c.length),i&&(c=c.concat(i.encode(r)));return l.push(c.length),{table:c,offsets:l}},t})(),tK=(function(){function t(e,n,r,i,l,c){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=l,this.yMax=c,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),sK=(function(){function t(e,n,r,i,l){var c,d;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],c=this.raw;d=c.readShort(),this.glyphOffsets.push(c.pos),this.glyphIDs.push(c.readUInt16()),32&d;)c.pos+=1&d?4:2,128&d?c.pos+=8:64&d?c.pos+=4:8&d&&(c.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new Nu(kI.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t})(),nK=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,Po),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,l;for(l=[],r=0,i=this.length;r<i;r+=2)l.push(2*e.readUInt16());return l}).call(this):(function(){var i,l;for(l=[],r=0,i=this.length;r<i;r+=4)l.push(e.readUInt32());return l}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),i=0,l=0,c=0;c<r.length;++c)if(r[c]=i,l<n.length&&n[l]==c){++l,r[c]=i;var d=this.offsets[c],u=this.offsets[c+1]-d;u>0&&(i+=u)}for(var f=new Array(4*r.length),m=0;m<r.length;++m)f[4*m+3]=255&r[m],f[4*m+2]=(65280&r[m])>>8,f[4*m+1]=(16711680&r[m])>>16,f[4*m]=(4278190080&r[m])>>24;return f},t})(),rK=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,l;for(n in i=this.font.cmap.tables[0].codeMap,e={},l=this.subset)r=l[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,l,c,d,u;for(i={},c=0,d=e.length;c<d;c++)i[l=e[c]]=this.font.glyf.glyphFor(l);for(l in n=[],i)(r=i[l])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(l in u=this.glyphsFor(n))r=u[l],i[l]=r;return i},t.prototype.encode=function(e,n){var r,i,l,c,d,u,f,m,_,y,g,N,C,v,R;for(i in r=AI.encode(this.generateCmap(),"unicode"),c=this.glyphsFor(e),g={0:0},R=r.charMap)g[(u=R[i]).old]=u.new;for(N in y=r.maxGlyphID,c)N in g||(g[N]=y++);return m=(function(U){var L,w;for(L in w={},U)w[U[L]]=L;return w})(g),_=Object.keys(m).sort(function(U,L){return U-L}),C=(function(){var U,L,w;for(w=[],U=0,L=_.length;U<L;U++)d=_[U],w.push(m[d]);return w})(),l=this.font.glyf.encode(c,C,g),f=this.font.loca.encode(l.offsets,C),v={cmap:this.font.cmap.raw(),glyf:l.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},t})();en.API.PDFObject=(function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,l,c;if(Array.isArray(n))return"["+(function(){var d,u,f;for(f=[],d=0,u=n.length;d<u;d++)r=n[d],f.push(e.convert(r));return f})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in l=["<<"],n)c=n[i],l.push("/"+i+" "+e.convert(c));return l.push(">>"),l.join(`
`)}return""+n},e})();async function iK(t){const e=new en("p","mm","a4"),n=210,r=20,i=n-r*2,l=(C,v=12,R="normal",U="#000000",L=i*3)=>{const w=document.createElement("canvas"),P=w.getContext("2d"),G=3,K=`${R} ${v*G}px "Malgun Gothic", " ", sans-serif`;P.font=K;const B=P.measureText(C);return w.width=Math.min(Math.ceil(B.width)+10,L*G),w.height=Math.ceil(v*G*1.5),P.fillStyle="#ffffff",P.fillRect(0,0,w.width,w.height),P.font=K,P.fillStyle=U,P.textBaseline="middle",P.fillText(C,2,w.height/2),w.toDataURL("image/png")},c=(C,v,R)=>{const U=l(C,10,"bold","#555555"),L=l(v||"-",10,"normal","#000000"),w=6;return e.addImage(U,"PNG",r,R,35,w-1),e.addImage(L,"PNG",r+38,R,i-40,w-1),e.setDrawColor(220,220,220),e.line(r,R+w,r+i,R+w),R+w+1};let d=r;const u=l("   ",16,"bold","#1a1a1a");e.addImage(u,"PNG",r,d,i,8),d+=12,e.setDrawColor(0,0,0),e.setLineWidth(.5),e.line(r,d,r+i,d),d+=6;const f=l(" ",12,"bold","#2563eb");e.addImage(f,"PNG",r,d,40,5),d+=8,d=c("ID",t.custId,d),d=c("",t.custNm,d),d=c("ID",t.pymAcntId,d),d+=4;const m=l(" ",12,"bold","#2563eb");e.addImage(m,"PNG",r,d,40,5),d+=8,d=c("",t.pymMthNm,d),d=c("",t.changeReasonNm,d),d=c("",t.acntHolderNm,d),d=c("",t.idTypeNm,d),d=c("",t.birthDt,d),d=c("",t.bankNm,d),d=c("",aK(t.acntNo),d),d=c("",t.pyrRelNm,d),d+=4;const _=l(" ",12,"bold","#2563eb");if(e.addImage(_,"PNG",r,d,40,5),d+=8,t.signatureData){e.setDrawColor(180,180,180),e.setLineWidth(.3),e.rect(r,d,60,25);try{e.addImage(t.signatureData,"PNG",r+2,d+2,56,21)}catch(C){console.warn("Signature image insert failed:",C)}d+=28}else d=c("","( )",d);d+=6,e.setDrawColor(0,0,0),e.setLineWidth(.3),e.line(r,d,r+i,d),d+=4;const y=t.createdAt||new Date().toLocaleString("ko-KR"),g=l(`: ${y}`,8,"normal","#999999");e.addImage(g,"PNG",r,d,i,3),d+=5;const N=l("  D'Live     .",8,"normal","#999999");return e.addImage(N,"PNG",r,d,i,3),e.output("blob")}function aK(t){if(!t||t.length<6)return t;const e=t.slice(0,3),n=t.slice(-3),r="*".repeat(t.length-6);return e+r+n}function lK(t,e){const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(n)},100)}const oK=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},CT={pymMthCd:"01",changeReasonL:"",changeReasonM:"",acntHolderNm:"",idType:"01",birthDt:"",bankCd:"",acntNo:"",cardExpMm:"",cardExpYy:"",joinCardYn:"N",pyrRel:"01",pymDay:""},cK=({isOpen:t,onClose:e,custId:n,custNm:r,soId:i,initialPymAcntId:l,showToast:c,onSuccess:d})=>{const[u,f]=x.useState([]),[m,_]=x.useState(l||""),[y,g]=x.useState(!1),[N,C]=x.useState({...CT}),[v,R]=x.useState(!1),[U,L]=x.useState(!1),[w,P]=x.useState(""),[G,K]=x.useState(!1),[B,O]=x.useState(!1),[S,A]=x.useState(""),[Y,te]=x.useState({show:!1,title:"",message:"",type:"info"}),J=[{CODE:"003",CODE_NM:"IBK"},{CODE:"004",CODE_NM:"KB"},{CODE:"011",CODE_NM:"NH"},{CODE:"020",CODE_NM:""},{CODE:"023",CODE_NM:"SC"},{CODE:"031",CODE_NM:""},{CODE:"032",CODE_NM:""},{CODE:"039",CODE_NM:""},{CODE:"045",CODE_NM:""},{CODE:"048",CODE_NM:""},{CODE:"071",CODE_NM:""},{CODE:"081",CODE_NM:""},{CODE:"088",CODE_NM:""},{CODE:"089",CODE_NM:"K"},{CODE:"090",CODE_NM:""},{CODE:"092",CODE_NM:""}],q=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:"KB"},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""},{CODE:"06",CODE_NM:""},{CODE:"07",CODE_NM:""},{CODE:"08",CODE_NM:"BC"},{CODE:"09",CODE_NM:"NH"}],V=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""}],F={"01":[{CODE:"0101",CODE_NM:"/ "},{CODE:"0102",CODE_NM:" "},{CODE:"0103",CODE_NM:" "}],"02":[{CODE:"0201",CODE_NM:" "},{CODE:"0202",CODE_NM:" "},{CODE:"0203",CODE_NM:" "}],"03":[{CODE:"0301",CODE_NM:" "},{CODE:"0302",CODE_NM:" "}],"04":[{CODE:"0401",CODE_NM:" "}]},I=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""}],ee=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""}];x.useEffect(()=>{t&&n&&ae()},[t,n]),x.useEffect(()=>{t&&(C({...CT}),R(!1),A(""),l&&_(l))},[t,l]),x.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]);const ae=async()=>{g(!0);try{const Re=await bN(n);Re.success&&Re.data&&(f(Re.data),Re.data.length>0&&!m&&_(Re.data[0].PYM_ACNT_ID))}catch(Re){console.error("Load payment accounts error:",Re)}finally{g(!1)}},T=(Re,X="info")=>{te({show:!0,title:X==="success"?"":X==="error"?"":X==="warning"?"":"",message:Re,type:X})},j=async()=>{if(!N.acntHolderNm){T("/  .","warning");return}if(!N.bankCd){T("/ .","warning");return}if(!N.acntNo){T("/ .","warning");return}if(N.pymMthCd==="02"&&(!N.cardExpMm||!N.cardExpYy)){T("  .","warning");return}L(!0),P("  ...");const Re=async()=>{if(N.pymMthCd==="01"){const X=await E9({BANK_CD:N.bankCd,ACNT_NO:N.acntNo,ACNT_OWNER_NM:N.acntHolderNm});return{success:X.success,message:X.message||""}}else{const X=await j9({CARD_NO:N.acntNo,CARD_EXPYEAR:N.cardExpYy,CARD_EXPMON:N.cardExpMm,CARD_OWNER_NM:N.acntHolderNm,KOR_ID:N.birthDt,SO_ID:i||"",PYM_ACNT_ID:l||"",CUST_ID:n,CUST_NM:r||""});return{success:X.success,message:X.message||""}}};try{if(P("  ..."),(await Re()).success)R(!0),P(""),T(N.pymMthCd==="01"?"  .":"  .","success");else{P(" ...  ."),await new Promise(me=>setTimeout(me,5e3));const _e=await Re();_e.success?(R(!0),P(""),T(N.pymMthCd==="01"?"  .":"  .","success")):(P(""),T(` .
   .

`+(_e.message||""),"error"))}}catch(X){console.error("Verify error:",X),P(""),T(`   .
   .`,"error")}finally{L(!1),P("")}},k=()=>{if(!m){T(" .","warning");return}if(!v){T("   .","warning");return}if(!N.changeReasonL||!N.changeReasonM){T(" .","warning");return}O(!0)},Q=Re=>{O(!1),A(Re)},H=()=>{A("")},$=(Re,X)=>{var _e;return((_e=Re.find(me=>me.CODE===X))==null?void 0:_e.CODE_NM)||X},ie=()=>{const Re=$(V,N.changeReasonL),X=F[N.changeReasonL]||[],_e=$(X,N.changeReasonM);return`${Re} > ${_e}`},fe=async()=>{try{const Re=await iK({custId:n,custNm:r||"",pymAcntId:m,pymMthNm:"()",changeReasonNm:ie(),acntHolderNm:N.acntHolderNm,idTypeNm:$(I,N.idType),birthDt:N.birthDt,bankNm:$(J,N.bankCd),acntNo:N.acntNo,pyrRelNm:$(ee,N.pyrRel),signatureData:S}),X=new Date().toISOString().slice(0,10).replace(/-/g,""),_e=`__${n}_${X}.pdf`;lK(Re,_e),c==null||c("PDF  ","success")}catch(Re){console.error("PDF generation error:",Re),T("PDF  .","error")}},pe=async()=>{if(N.pymMthCd==="01"&&!S){T("  .","warning");return}K(!0);try{const Re=await Qj({CUST_ID:n,PYM_ACNT_ID:m,PYM_MTH_CD:N.pymMthCd,BANK_CD:N.bankCd,ACNT_NO:N.acntNo,ACNT_OWNER_NM:N.acntHolderNm,ID_TYPE_CD:N.idType,BIRTH_DT:N.birthDt,PAYER_REL_CD:N.pyrRel,PAY_DAY_CD:N.pymDay,CARD_VALID_YM:N.pymMthCd==="02"?N.cardExpYy+N.cardExpMm:void 0,JOIN_CARD_YN:N.pymMthCd==="02"?N.joinCardYn:void 0,CHG_RESN_L_CD:N.changeReasonL,CHG_RESN_M_CD:N.changeReasonM});if(Re.success){try{await I9({CUST_ID:n,PYM_ACNT_ID:m,SIGN_TYPE:"PYM_CHG",SIGNATURE_DATA:S})}catch(X){console.log("[PaymentChange] Signature save stub (API not connected yet):",X)}if(N.pymMthCd==="01"&&S)try{await fe()}catch(X){console.warn("[PaymentChange] PDF auto-download failed:",X)}c==null||c(" .","success"),d==null||d(),e()}else T(Re.message||"  .","error")}catch(Re){console.error("Save payment error:",Re),T("    .","error")}finally{K(!1)}},de=u.find(Re=>Re.PYM_ACNT_ID===m);return t?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:[U&&w&&s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[85vw] max-w-[280px] p-6 flex flex-col items-center",children:[s.jsx(jn,{className:"w-10 h-10 text-blue-500 animate-spin mb-4"}),s.jsx("p",{className:"text-sm text-gray-700 text-center font-medium",children:w})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4 max-h-[90vh] flex flex-col",onClick:Re=>Re.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-orange-500 to-orange-600 rounded-t-xl",children:[s.jsxs("div",{className:"flex items-center gap-2 text-white",children:[s.jsx(b_,{className:"w-5 h-5"}),s.jsx("h3",{className:"font-semibold",children:" "})]}),s.jsx("button",{onClick:e,className:"text-white/80 hover:text-white transition-colors",disabled:G,children:s.jsx(bi,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-0",children:y?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(jn,{className:"w-6 h-6 text-orange-500 animate-spin"})}):de?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 border border-orange-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-mono text-sm text-blue-600",children:oK(de.PYM_ACNT_ID)}),s.jsx("span",{className:"text-xs text-gray-500",children:de.PYM_MTHD_NM||"-"})]}),s.jsxs("div",{className:"text-sm text-gray-700",children:[de.BANK_CARD_NM||"-"," ",de.BANK_CARD_NO||""]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("select",{value:N.pymMthCd,onChange:Re=>{C(X=>({...X,pymMthCd:Re.target.value,bankCd:"",acntNo:""})),R(!1)},className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"01",children:"()"}),s.jsx("option",{value:"02",children:""})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("div",{className:"flex-1 flex gap-1",children:[s.jsxs("select",{value:N.changeReasonL,onChange:Re=>C(X=>({...X,changeReasonL:Re.target.value,changeReasonM:""})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"",children:""}),V.map(Re=>s.jsx("option",{value:Re.CODE,children:Re.CODE_NM},Re.CODE))]}),s.jsxs("select",{value:N.changeReasonM,onChange:Re=>C(X=>({...X,changeReasonM:Re.target.value})),disabled:!N.changeReasonL,className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500 disabled:bg-gray-100",children:[s.jsx("option",{value:"",children:""}),(F[N.changeReasonL]||[]).map(Re=>s.jsx("option",{value:Re.CODE,children:Re.CODE_NM},Re.CODE))]})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:N.pymMthCd==="01"?"":""}),s.jsx("input",{type:"text",value:N.acntHolderNm,onChange:Re=>{C(X=>({...X,acntHolderNm:Re.target.value})),R(!1)},placeholder:" ",className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsx("select",{value:N.idType,onChange:Re=>C(X=>({...X,idType:Re.target.value})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:I.map(Re=>s.jsx("option",{value:Re.CODE,children:Re.CODE_NM},Re.CODE))})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsx("input",{type:"text",value:N.birthDt,onChange:Re=>C(X=>({...X,birthDt:Re.target.value.replace(/[^0-9]/g,"").slice(0,8)})),placeholder:"YYYYMMDD",maxLength:8,className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:N.pymMthCd==="01"?"":""}),s.jsxs("select",{value:N.bankCd,onChange:Re=>{C(X=>({...X,bankCd:Re.target.value})),R(!1)},className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"",children:""}),(N.pymMthCd==="01"?J:q).map(Re=>s.jsx("option",{value:Re.CODE,children:Re.CODE_NM},Re.CODE))]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:N.pymMthCd==="01"?"":""}),s.jsxs("div",{className:"flex-1 flex gap-2",children:[s.jsx("input",{type:"text",value:N.acntNo,onChange:Re=>{C(X=>({...X,acntNo:Re.target.value.replace(/[^0-9]/g,"")})),R(!1)},placeholder:N.pymMthCd==="01"?" (- )":" (- )",className:"flex-1 min-w-0 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"}),s.jsx("button",{onClick:j,disabled:U||v,className:`flex-shrink-0 px-3 py-1.5 text-sm rounded font-medium transition-colors whitespace-nowrap ${v?"bg-green-100 text-green-700 border border-green-300":"bg-blue-500 text-white hover:bg-blue-600"}`,children:U?"":v?"":""})]})]}),N.pymMthCd==="02"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"text",value:N.cardExpMm,onChange:Re=>{C(X=>({...X,cardExpMm:Re.target.value.replace(/[^0-9]/g,"").slice(0,2)})),R(!1)},placeholder:"MM",maxLength:2,className:"w-14 px-2 py-1.5 text-sm border border-gray-300 rounded text-center focus:ring-1 focus:ring-orange-500"}),s.jsx("span",{className:"text-gray-400",children:"/"}),s.jsx("input",{type:"text",value:N.cardExpYy,onChange:Re=>{C(X=>({...X,cardExpYy:Re.target.value.replace(/[^0-9]/g,"").slice(0,2)})),R(!1)},placeholder:"YY",maxLength:2,className:"w-14 px-2 py-1.5 text-sm border border-gray-300 rounded text-center focus:ring-1 focus:ring-orange-500"})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("select",{value:N.joinCardYn,onChange:Re=>C(X=>({...X,joinCardYn:Re.target.value})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"N",children:""}),s.jsx("option",{value:"Y",children:""})]})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsx("select",{value:N.pyrRel,onChange:Re=>C(X=>({...X,pyrRel:Re.target.value})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:ee.map(Re=>s.jsx("option",{value:Re.CODE,children:Re.CODE_NM},Re.CODE))})]})]}),N.pymMthCd==="01"&&s.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700",children:" "}),s.jsx("div",{className:"flex items-center gap-2",children:S&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:fe,className:"text-xs text-blue-500 hover:text-blue-600 flex items-center gap-0.5",children:[s.jsx(LL,{className:"w-3 h-3"}),"PDF"]}),s.jsx("button",{onClick:H,className:"text-xs text-red-500 hover:text-red-600",children:" "})]})})]}),S?s.jsxs("div",{className:"border border-green-300 rounded-lg bg-green-50 p-2 flex flex-col items-center",children:[s.jsx("img",{src:S,alt:"",className:"max-h-24 rounded border border-gray-200 bg-white"}),s.jsxs("div",{className:"flex items-center gap-1 mt-1.5",children:[s.jsx(dc,{className:"w-3.5 h-3.5 text-green-600"}),s.jsx("span",{className:"text-xs text-green-600 font-medium",children:" "})]})]}):s.jsxs("button",{onClick:k,disabled:!v,className:`w-full py-4 border-2 border-dashed rounded-lg flex flex-col items-center gap-1.5 transition-colors ${v?"border-blue-300 bg-blue-50 hover:bg-blue-100 text-blue-600 cursor-pointer":"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[s.jsx(aw,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:v?"  ":"    "})]})]}),s.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Wr,{className:"w-4 h-4 text-orange-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-orange-700",children:[s.jsx("p",{children:"     ."}),s.jsx("p",{className:"text-xs mt-1",children:"      ."})]})]})})]}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(b_,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{children:"  ."})]})}),de&&s.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:pe,disabled:G||!v||N.pymMthCd==="01"&&!S,className:`flex-1 py-2.5 rounded-lg transition-colors text-sm font-medium flex items-center justify-center gap-2 ${v&&(N.pymMthCd==="02"||S)?"bg-orange-500 text-white hover:bg-orange-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:G?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-4 h-4 animate-spin"})," ..."]}):""}),s.jsx("button",{onClick:e,disabled:G,className:"flex-1 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:""})]})})]}),B&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsx(Vj,{title:"  ",onSave:Q,onCancel:()=>O(!1)})})}),Y.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70]",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${Y.type==="success"?"bg-green-100":Y.type==="error"?"bg-red-100":Y.type==="warning"?"bg-orange-100":"bg-blue-100"}`,children:Y.type==="success"?s.jsx(dc,{className:"w-5 h-5 text-green-500"}):s.jsx(Wr,{className:`w-5 h-5 ${Y.type==="error"?"text-red-500":Y.type==="warning"?"text-orange-500":"text-blue-500"}`})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:Y.title})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-5 whitespace-pre-line",children:Y.message}),s.jsx("button",{onClick:()=>te({show:!1,title:"",message:"",type:"info"}),className:`w-full px-4 py-2 text-sm text-white rounded-lg transition-colors ${Y.type==="success"?"bg-green-500 hover:bg-green-600":Y.type==="error"?"bg-red-500 hover:bg-red-600":Y.type==="warning"?"bg-orange-500 hover:bg-orange-600":"bg-blue-500 hover:bg-blue-600"}`,children:""})]})})]}):null},t_=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},dK=t=>!t||t.length<6?t||"-":`${t.slice(0,4)}-${t.slice(4,6)}`,uK=({custId:t,custNm:e,expanded:n,onToggle:r,showToast:i,onNavigateToPaymentChange:l,paymentChangeInProgress:c,onCancelPaymentChange:d,currentWorkingPymAcntId:u,selectedPymAcntIdFromContract:f,contracts:m=[]})=>{const[_,y]=x.useState([]),[g,N]=x.useState([]),[C,v]=x.useState(!1),[R,U]=x.useState(!1),[L,w]=x.useState(null),[P,G]=x.useState(!0),[K,B]=x.useState(!1),[O,S]=x.useState([]),[A,Y]=x.useState(!1),[te,J]=x.useState(!1),[q,V]=x.useState(""),[F,I]=x.useState(!1),[ee,ae]=x.useState(null);x.useEffect(()=>{n&&t&&T()},[n,t]),x.useEffect(()=>{f&&f!==L&&w(f)},[f]),x.useEffect(()=>{L&&t&&(j(L),ae(rR(L)))},[L,t]);const T=async()=>{v(!0);try{const ie=await bN(t);ie.success&&ie.data&&(y(ie.data),ie.data.length>0&&(f&&ie.data.some(fe=>fe.PYM_ACNT_ID===f)?w(f):w(ie.data[0].PYM_ACNT_ID)))}catch(ie){console.error("Load payment accounts error:",ie)}finally{v(!1)}},j=async ie=>{U(!0);try{const fe=await sR(t,ie);fe.success&&fe.data?N(fe.data):N([])}catch(fe){console.error("Load billing details error:",fe),N([])}finally{U(!1)}},k=ie=>{w(ie)},Q=()=>{d&&d(),l&&q&&l(q),J(!1),V("")},H=_.find(ie=>ie.PYM_ACNT_ID===L),$=async()=>{if(!L){i==null||i(" .","warning");return}Y(!0);try{const ie=await sR(t,L);if(ie.success&&ie.data){const fe=ie.data.filter(pe=>pe.UPYM_AMT>0).map(pe=>({BILL_YM:pe.BILL_YYMM,CTRT_ID:"",PROD_NM:pe.BILL_CYCL||"",BILL_AMT:pe.BILL_AMT,UNPAY_AMT:pe.UPYM_AMT,UNPAY_DAYS:0,UNPAY_STAT_NM:"",BILL_SEQ_NO:pe.BILL_SEQ_NO||"",SO_ID:pe.SO_ID||""}));fe.length>0?(S(fe),B(!0)):i==null||i("  .","info")}else i==null||i("   .","error")}catch(ie){console.error("Load unpayment list error:",ie),i==null||i("     .","error")}finally{Y(!1)}};return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:r,className:"w-full px-3 py-2.5 flex items-center justify-between text-left",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"font-medium text-gray-800",children:" / "})}),n?s.jsx(Mr,{className:"w-4 h-4 text-gray-400"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400"})]}),n&&s.jsx("div",{className:"px-3 pb-3",children:C?s.jsx("div",{className:"flex items-center justify-center py-6",children:s.jsx(jn,{className:"w-5 h-5 animate-spin text-gray-400"})}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:" "}),s.jsxs("span",{className:"text-xs text-gray-500",children:[_.length,""]})]}),_.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-1 mb-3",children:_.map((ie,fe)=>{const pe=u===ie.PYM_ACNT_ID,de=L===ie.PYM_ACNT_ID;return s.jsx("div",{onClick:()=>k(ie.PYM_ACNT_ID),className:`p-2 rounded-lg border cursor-pointer transition-all ${pe?"bg-orange-50 border-orange-300":de?"bg-blue-50 border-blue-400":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-medium text-gray-700",children:[fe+1,"."]}),s.jsx("span",{className:"text-gray-800",children:t_(ie.PYM_ACNT_ID)}),s.jsx("span",{className:"text-gray-400",children:"|"}),s.jsx("span",{className:"text-gray-600",children:ie.PYM_MTHD_NM||"-"}),pe&&s.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-orange-500 text-white rounded-full animate-pulse",children:""})]}),s.jsxs("span",{className:`font-medium ${ie.UPYM_AMT_ACNT>0?"text-red-600":"text-gray-600"}`,children:[jo(ie.UPYM_AMT_ACNT||0),""]})]})},ie.PYM_ACNT_ID)})}),H&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsx("span",{className:"text-gray-800",children:H.PYM_MTHD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:"/"}),s.jsx("span",{className:"text-gray-800",children:H.BANK_CARD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:"/"}),s.jsx("span",{className:"text-gray-800",children:H9(H.BANK_CARD_NO||"",4,4)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsx("span",{className:"text-gray-800",children:H.BILL_MTHD||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-blue-200",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:`font-bold ${H.UPYM_AMT_ACNT>0?"text-red-600":"text-gray-800"}`,children:[jo(H.UPYM_AMT_ACNT||0),""]})]})]})})]}),_.some(ie=>ie.UPYM_AMT_ACNT>0)&&s.jsx("button",{onClick:$,disabled:A||!L,className:`w-full mt-3 py-2.5 text-sm text-white rounded-lg disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2 ${ee?"bg-amber-500 hover:bg-amber-600 animate-pulse":"bg-red-500 hover:bg-red-600"}`,children:A?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-4 h-4 animate-spin"})," ..."]}):ee?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-white rounded-full"}),"   (",t_(L||""),")"]}):`  (${t_(L||"")})`}),L&&s.jsx("button",{onClick:()=>I(!0),className:"w-full mt-2 py-2 text-sm text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors font-medium",children:" "})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[s.jsxs("button",{onClick:()=>G(!P),className:"w-full flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:""}),H&&s.jsx("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded",children:t_(H.PYM_ACNT_ID)})]}),s.jsx(sr,{className:`w-4 h-4 text-gray-400 transition-transform ${P?"rotate-180":""}`})]}),P&&s.jsx(s.Fragment,{children:L?R?s.jsx("div",{className:"flex items-center justify-center py-4",children:s.jsx(jn,{className:"w-4 h-4 animate-spin text-gray-400"})}):g.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:" 3      ."}):s.jsxs("div",{className:"space-y-2",children:[g.slice(0,10).map((ie,fe)=>s.jsxs("div",{className:`p-3 rounded-lg border ${ie.UPYM_AMT>0?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-200",children:[s.jsx("span",{className:"font-medium text-gray-800",children:dK(ie.BILL_YYMM)}),s.jsx("span",{className:"text-xs text-gray-500",children:ie.BILL_CYCL||""})]}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:"text-gray-800",children:[jo(ie.BILL_AMT),""]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:"text-green-600",children:[jo(ie.RCPT_AMT),""]})]}),ie.UPYM_AMT>0&&s.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:"text-red-600 font-bold",children:[jo(ie.UPYM_AMT),""]})]})]})]},fe)),g.length>10&&s.jsxs("div",{className:"text-center text-sm text-gray-500 py-2",children:["+",g.length-10,"  "]})]}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:" ."})})]})]})}),s.jsx(mB,{isOpen:K,onClose:()=>{B(!1),T(),L&&(j(L),ae(rR(L)))},pendingPayment:ee,custId:t,custNm:e,pymAcntId:L||"",unpaymentList:O,showToast:i,onSuccess:()=>{T(),L&&j(L)},soId:(()=>{var ie,fe;if(L){const pe=_.find(de=>de.PYM_ACNT_ID===L);if(pe!=null&&pe.SO_ID)return pe.SO_ID}if(L&&m.length>0){const pe=m.filter(de=>de.PYM_ACNT_ID===L&&de.SO_ID);if(pe.length>0)return(pe.find(Re=>Re.CTRT_STAT_CD==="10")||pe[0]).SO_ID}try{const pe=JSON.parse(sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo")||"{}"),de=pe.authSoList||pe.AUTH_SO_List||[];return((ie=de[0])==null?void 0:ie.SO_ID)||((fe=de[0])==null?void 0:fe.soId)||pe.soId||pe.SO_ID||""}catch{return""}})()}),s.jsx(cK,{isOpen:F,onClose:()=>{I(!1),T(),L&&j(L)},custId:t,custNm:e,soId:(()=>{var ie,fe;if(L){const pe=_.find(de=>de.PYM_ACNT_ID===L);if(pe!=null&&pe.SO_ID)return pe.SO_ID}if(L&&m.length>0){const pe=m.filter(de=>de.PYM_ACNT_ID===L&&de.SO_ID);if(pe.length>0)return(pe.find(de=>de.CTRT_STAT_CD==="10")||pe[0]).SO_ID}try{const pe=JSON.parse(sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo")||"{}"),de=pe.authSoList||pe.AUTH_SO_List||[];return((ie=de[0])==null?void 0:ie.SO_ID)||((fe=de[0])==null?void 0:fe.soId)||pe.soId||pe.SO_ID||""}catch{return""}})(),initialPymAcntId:L||"",showToast:i,onSuccess:()=>{T()}}),te&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:s.jsx(Wr,{className:"w-5 h-5 text-orange-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:"  "})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-5",children:["     .",s.jsx("br",{}),"     ?"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{J(!1),V("")},className:"flex-1 px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:""}),s.jsx("button",{onClick:Q,className:"flex-1 px-4 py-2 text-sm text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-colors",children:" "})]})]})})]})},ny=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},hK=({onBack:t,showToast:e,onContractSelect:n,onNavigateToPaymentChange:r,onNavigateToConsultationAS:i,onNavigateToAddressChange:l,onNavigateToReContract:c,selectedCustomer:d,savedContract:u,cachedContracts:f=[],cachedConsultationHistory:m=[],cachedWorkHistory:_=[],cachedDataCustId:y="",onDataLoaded:g,paymentChangeInProgress:N,onCancelPaymentChange:C,currentWorkingPymAcntId:v})=>{const[R,U]=x.useState([]),[L,w]=x.useState([]),[P,G]=x.useState([]),[K,B]=x.useState("byDate"),[O,S]=x.useState([]),[A,Y]=x.useState([]),[te,J]=x.useState(""),[q,V]=x.useState(!1),[F,I]=x.useState(!1),[ee,ae]=x.useState({customerInfo:!0,contracts:!0,payment:!1,consultation:!1,work:!1}),[T,j]=x.useState(new Set),[k,Q]=x.useState(new Set),H=ne=>{j(ue=>{const xe=new Set(ue);return xe.has(ne)?xe.delete(ne):xe.add(ne),xe})},$=ne=>{Q(ue=>{const xe=new Set(ue);return xe.has(ne)?xe.delete(ne):xe.add(ne),xe})},[ie,fe]=x.useState(null);x.useEffect(()=>{d&&d.CUST_ID!==ie?(fe(d.CUST_ID),J(""),y===d.CUST_ID&&(f.length>0||m.length>0||_.length>0)?(U(f),w(m),G(_),O.length===0&&A.length===0&&Z(d.CUST_ID)):le(d.CUST_ID)):!d&&ie&&(fe(null),U([]),w([]),G([]))},[d,y]),x.useEffect(()=>{d&&u&&u.ctrtId&&u.ctrtId!==de&&(Re(u.ctrtId),me(d.CUST_ID,u.ctrtId))},[d,u]),x.useEffect(()=>{if(d!=null&&d.EQT_SERNO&&R.length>0){const ne=d.EQT_SERNO.toLowerCase(),ue=R.find(xe=>{var et,bt;return((et=xe.NOTRECEV)==null?void 0:et.toLowerCase().includes(ne))||((bt=xe.EQT_SERNO)==null?void 0:bt.toLowerCase().includes(ne))});J(ue?ue.CTRT_ID:"")}else J("")},[d==null?void 0:d.EQT_SERNO,R]);const pe=async ne=>{V(!0);try{const ue=await Ex(ne);return ue.success&&ue.data?(U(ue.data),ue.data):(U([]),[])}catch(ue){return console.error("Load contracts error:",ue),U([]),[]}finally{V(!1)}},[de,Re]=x.useState(""),[X,_e]=x.useState(""),me=async(ne,ue)=>{I(!0);try{const[xe,et]=await Promise.all([V_(ne,ue,10),$_(ne,ue,10)]),bt=xe.success&&xe.data?xe.data:[],it=et.success&&et.data?et.data:[];return w(bt),G(it),{consultation:bt,work:it}}catch(xe){return console.error("Load history error:",xe),{consultation:[],work:[]}}finally{I(!1)}},Z=async ne=>{I(!0);try{const[ue,xe]=await Promise.all([V_(ne,void 0,10),$_(ne,void 0,10)]),et=ue.success&&ue.data?ue.data:[],bt=xe.success&&xe.data?xe.data:[];S(et),Y(bt)}catch(ue){console.error("Load all history error:",ue)}finally{I(!1)}},le=async ne=>{w([]),G([]),Re("");const ue=await pe(ne);B("byDate"),await Z(ne),g&&g(ne,ue,[],[])},se=ne=>{ae(ue=>({...ue,[ne]:!ue[ne]}))},Ee=ne=>{n({ctrtId:ne.CTRT_ID,prodNm:ne.PROD_NM,instAddr:ne.INST_ADDR,streetAddr:ne.STREET_ADDR_FULL,instlLoc:ne.INSTL_LOC,postId:ne.POST_ID,notrecev:ne.NOTRECEV,soId:ne.SO_ID,prodGrp:ne.PROD_GRP}),Re(ne.CTRT_ID),B("byContract"),d&&me(d.CUST_ID,ne.CTRT_ID),ne.PYM_ACNT_ID&&_e(ne.PYM_ACNT_ID)},Ne=K==="byContract"?de?L:[]:O,ye=K==="byContract"?de?P:[]:A;return s.jsx("div",{className:"h-full overflow-y-auto bg-gray-50",children:s.jsx("div",{className:"p-4 space-y-4",children:d?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>se("customerInfo"),className:"w-full px-3 py-2.5 flex items-center justify-between text-left",children:[s.jsx("span",{className:"font-medium text-gray-800",children:" "}),ee.customerInfo?s.jsx(Mr,{className:"w-4 h-4 text-gray-400"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400"})]}),ee.customerInfo&&s.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"font-medium text-gray-800 text-right flex-1 break-all",children:ny(d.CUST_ID)})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"font-medium text-gray-800 text-right flex-1 break-all",children:d.CUST_NM})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1",children:Hy(d.TEL_NO)||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1",children:Hy(d.HP_NO)||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1",children:d.CUST_TP_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1 break-all",children:d.GRP_NM||"-"})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100 text-sm space-y-1",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("span",{className:"text-gray-500",children:""})}),s.jsx("div",{className:"text-gray-700 break-words",children:d.ROAD_ADDR||d.INST_ADDR||d.CUST_ADDR||"-"})]}),d.UNPAY_AMT>0&&s.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded border border-red-200",children:[s.jsx("span",{className:"text-red-700 text-sm",children:""}),s.jsxs("span",{className:"text-red-600 font-bold",children:[jo(d.UNPAY_AMT),""]})]})]})]}),s.jsx(oB,{contracts:R,isLoading:q,expanded:ee.contracts,onToggle:()=>se("contracts"),onContractSelect:Ee,showToast:e,initialSearchKeyword:te||(d==null?void 0:d.CTRT_ID)||"",onNavigateToConsultation:ne=>{Ee(ne),i&&i("consultation")},onNavigateToAS:ne=>{Ee(ne),i&&i("as")},onNavigateToAddressChange:ne=>{Ee(ne),l&&l()},onNavigateToReContract:ne=>{Ee(ne),c&&c()}}),s.jsx(uK,{custId:d.CUST_ID,custNm:d.CUST_NM,expanded:ee.payment,onToggle:()=>se("payment"),showToast:e,onNavigateToPaymentChange:r,paymentChangeInProgress:N,onCancelPaymentChange:C,currentWorkingPymAcntId:v,selectedPymAcntIdFromContract:X,contracts:R}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[s.jsxs("button",{onClick:()=>se("consultation"),className:"flex items-center gap-2 flex-1 text-left",children:[s.jsx("span",{className:"font-medium text-gray-800",children:""}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",Ne.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[s.jsx("button",{onClick:ne=>{ne.stopPropagation(),B("byDate"),d&&O.length===0&&A.length===0&&Z(d.CUST_ID)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${K==="byDate"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:ne=>{ne.stopPropagation(),B("byContract"),d&&de&&me(d.CUST_ID,de)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${K==="byContract"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]}),s.jsx("button",{onClick:()=>se("consultation"),children:ee.consultation?s.jsx(Mr,{className:"w-4 h-4 text-gray-400"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400"})})]}),ee.consultation&&s.jsx("div",{className:"px-3 pb-3",children:F?s.jsx("div",{className:"flex items-center justify-center py-3",children:s.jsx(jn,{className:"w-4 h-4 animate-spin text-gray-400"})}):K==="byContract"&&!de?s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:"   "}):Ne.length>0?s.jsx("div",{className:"space-y-3",children:Ne.map((ne,ue)=>{var xe;return s.jsxs("div",{className:"bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"p-3 cursor-pointer flex items-center justify-between",onClick:()=>H(ue),children:[s.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs flex-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:ne.CTRT_ID?ny(ne.CTRT_ID):"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.START_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:ne.CNSL_SLV_CL_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(xe=ne.CNSL_RSLT)!=null&&xe.includes("")?"text-green-600":"text-yellow-600"}`,children:ne.CNSL_RSLT||""})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.RCPT_NM||"-"})]})]}),T.has(ue)?s.jsx(Mr,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"})]}),T.has(ue)&&s.jsxs("div",{className:"px-3 pb-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ne.REQ_CTX||"-"})]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ne.PROC_CT||"-"})]})]})]},ue)})}):s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:" "})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[s.jsxs("button",{onClick:()=>se("work"),className:"flex items-center gap-2 flex-1 text-left",children:[s.jsx("span",{className:"font-medium text-gray-800",children:""}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",ye.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[s.jsx("button",{onClick:ne=>{ne.stopPropagation(),B("byDate"),d&&O.length===0&&A.length===0&&Z(d.CUST_ID)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${K==="byDate"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:ne=>{ne.stopPropagation(),B("byContract"),d&&de&&me(d.CUST_ID,de)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${K==="byContract"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]}),s.jsx("button",{onClick:()=>se("work"),children:ee.work?s.jsx(Mr,{className:"w-4 h-4 text-gray-400"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400"})})]}),ee.work&&s.jsx("div",{className:"px-3 pb-3",children:F?s.jsx("div",{className:"flex items-center justify-center py-3",children:s.jsx(jn,{className:"w-4 h-4 animate-spin text-gray-400"})}):K==="byContract"&&!de?s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:"   "}):ye.length>0?s.jsx("div",{className:"space-y-3",children:ye.map((ne,ue)=>{var xe,et;return s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:ne.CTRT_ID?ny(ne.CTRT_ID):"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.HOPE_DT||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.WRK_CD_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(xe=ne.WRK_STAT_CD_NM)!=null&&xe.includes("")?"text-green-600":(et=ne.WRK_STAT_CD_NM)!=null&&et.includes("")?"text-blue-600":"text-gray-800"}`,children:ne.WRK_STAT_CD_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-center",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:ne.PROD_NM||"-"})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.CMPL_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.WRK_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ne.WRK_CRR_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-start",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800",children:ne.CTRT_ADDR||"-"})]}),s.jsxs("div",{className:"mt-3 cursor-pointer",onClick:()=>$(ue),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"text-xs text-gray-500",children:""}),k.has(ue)?s.jsx(Mr,{className:"w-3.5 h-3.5 text-gray-400"}):s.jsx(sr,{className:"w-3.5 h-3.5 text-gray-400"})]}),k.has(ue)&&s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ne.MEMO||"-"})]})]},ue)})}):s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:" "})})]})]}):s.jsx("div",{className:"flex items-center justify-center h-48 text-gray-400 text-sm",children:"   ."})})})},fK=({onBack:t,showToast:e,selectedCustomer:n,selectedContract:r,initialSection:i="phone",initialPymAcntId:l="",onPaymentChangeStart:c,onPaymentChangeEnd:d,savedPaymentForm:u,savedPymAcntId:f="",savedIsVerified:m=!1,onPaymentFormChange:_,onAddressChanged:y})=>{var Ls;const[g,N]=x.useState({phone:!1,address:i==="address",payment:i==="payment",hpPay:i==="hpPay"}),[C,v]=x.useState({telNoType:"hp",telNo:"",telTpCd:"",disconnYn:"N"}),[R,U]=x.useState([]),[L,w]=x.useState("address"),[P,G]=x.useState({addr:"",instlLoc:""}),[K,B]=x.useState(!1),[O,S]=x.useState({zipCd:"",addr1:"",addr2:"",instlLoc:"",changeBillAddr:!1,postId:"",streetId:"",dongmyonNm:"",bldCl:"0",bldNm:"",bunNo:"",hoNm:""}),[A,Y]=x.useState(!1),[te,J]=x.useState(!1),[q,V]=x.useState(!1),[F,I]=x.useState([]),[ee,ae]=x.useState(!1),[T,j]=x.useState(!1),[k,Q]=x.useState([]),[H,$]=x.useState(f),[ie,fe]=x.useState(!1),[pe,de]=x.useState(!1),Re={pymMthCd:"01",changeReasonL:"",changeReasonM:"",acntHolderNm:"",idType:"01",birthDt:"",bankCd:"",acntNo:"",cardExpMm:"",cardExpYy:"",joinCardYn:"N",pyrRel:"01",pymDay:""},[X,_e]=x.useState(u||Re),[me,Z]=x.useState(!1),[le,se]=x.useState(m),[Ee,Ne]=x.useState(!1),[ye,ne]=x.useState(!1),[ue,xe]=x.useState(null),[et,bt]=x.useState(!1),[it,At]=x.useState(""),[at,We]=x.useState(kv),[Dt,Tt]=x.useState({isOpen:!1,message:"",type:"info"}),St=(nt,Ft="info")=>{Tt({isOpen:!0,message:nt,type:Ft})},ze=nt=>{console.log("[ ] :",nt),console.log("[ ]   :",X.acntHolderNm);const Ft={...Re};_e(Ft),se(!1),$(nt),c==null||c(),bt(!1),At(""),console.log("[ ]   ")},[dt,Ke]=x.useState(!1),[rt,ft]=x.useState("post"),[Ot,mt]=x.useState(""),[Ze,De]=x.useState({streetNm:"",streetBunM:"",streetBunS:""}),[Ye,Ce]=x.useState([]),[ge,Be]=x.useState([]),[ce,Le]=x.useState(!1),[Xe,Pe]=x.useState(""),[Ct,Me]=x.useState([]),[lt,ut]=x.useState([]),[jt,Ve]=x.useState([]),[$t,Ue]=x.useState({}),[ss,ls]=x.useState([]),[ds,Ss]=x.useState([]),[Ns,ke]=x.useState([]);x.useEffect(()=>{st(),Kt()},[]),x.useEffect(()=>{n&&!pe&&qt()},[n]),x.useEffect(()=>{r&&(G({addr:r.streetAddr||r.instAddr||"",instlLoc:r.instlLoc||""}),B(k.length===1))},[r,k.length]),x.useEffect(()=>{_&&_(X,H,le)},[X,H,le]);const ct=nt=>nt.filter(Ft=>Ft.code&&Ft.code!=="[]"&&Ft.name!=="").map(Ft=>({CODE:Ft.code||Ft.CODE,CODE_NM:Ft.name||Ft.CODE_NM,ref_code:Ft.ref_code||""})),st=async()=>{Y(!0);try{const nt=await F9();nt.success&&nt.data&&U(ct(nt.data))}catch(nt){console.error("Load telecom codes error:",nt)}finally{Y(!1)}},Kt=async()=>{try{const[nt,Ft,Cs,Ht]=await Promise.all([K9(),Q9(),G9(),Y9()]);nt.success&&nt.data&&Me(ct(nt.data)),Ft.success&&Ft.data&&ut(ct(Ft.data)),Cs.success&&Cs.data&&Ss(ct(Cs.data)),Ht.success&&Ht.data&&ls(ct(Ht.data)),Ve([{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""}]),Ue({"01":[{CODE:"0101",CODE_NM:"/ "},{CODE:"0102",CODE_NM:" "},{CODE:"0103",CODE_NM:" "}],"02":[{CODE:"0201",CODE_NM:" "},{CODE:"0202",CODE_NM:" "},{CODE:"0203",CODE_NM:" "}],"03":[{CODE:"0301",CODE_NM:" "},{CODE:"0302",CODE_NM:" "}],"04":[{CODE:"0401",CODE_NM:" "}]}),ke([{CODE:"05",CODE_NM:"5"},{CODE:"10",CODE_NM:"10"},{CODE:"15",CODE_NM:"15"},{CODE:"20",CODE_NM:"20"},{CODE:"25",CODE_NM:"25"},{CODE:"27",CODE_NM:"27"}])}catch(nt){console.error("Load payment codes error:",nt)}},ht=async()=>{if(n){ae(!0);try{const nt=await D9(n.custId);nt.success&&nt.data?I(nt.data):I([]),j(!0)}catch(nt){console.error("Load HP pay list error:",nt),I([])}finally{ae(!1)}}},qt=async()=>{if(n){fe(!0);try{const nt=await bN(n.custId);if(nt.success&&nt.data){if(Q(nt.data),nt.data.length>0){const Ft=l&&nt.data.find(Cs=>Cs.PYM_ACNT_ID===l)?l:nt.data[0].PYM_ACNT_ID;$(Ft)}}else Q([]);de(!0)}catch(nt){console.error("Load payment info error:",nt),Q([])}finally{fe(!1)}}};x.useEffect(()=>{i==="payment"&&n&&!pe&&qt()},[i,n]);const It=async nt=>{ne(!1),xe(nt),Ne(!0);try{const Ft={PYM_ACNT_ID:H,CUST_ID:n.custId,ACNT_NM:X.acntHolderNm,PYM_MTHD:X.pymMthCd==="01"?"02":"04",BANK_CARD:X.bankCd,ACNT_CARD_NO:X.acntNo,CHG_RESN_L:X.changeReasonL,CHG_RESN_M:X.changeReasonM,ID_TP:X.idType,BIRTH_DT:X.birthDt,PYR_REL:X.pyrRel,PYM_DAY:X.pymDay,SIGNATURE:nt};X.pymMthCd==="02"&&X.cardExpYy&&X.cardExpMm&&(Ft.CDTCD_EXP_DT=X.cardExpYy+X.cardExpMm,Ft.REQR_NM=X.acntHolderNm,Ft.JOIN_CARD_YN=X.joinCardYn),X.pymMthCd==="01"&&(Ft.PYM_CUST_NM=X.acntHolderNm);const Cs=await Qj(Ft);Cs.success?(St(" .","success"),_e({pymMthCd:"01",changeReasonL:"",changeReasonM:"",acntHolderNm:"",idType:"01",birthDt:"",bankCd:"",acntNo:"",cardExpMm:"",cardExpYy:"",joinCardYn:"N",pyrRel:"01",pymDay:""}),se(!1),xe(null),d==null||d(),qt()):St(Cs.message||"  .","error")}catch(Ft){console.error("Save payment error:",Ft),St("    .","error")}finally{Ne(!1)}},he=nt=>{const Ft=!g[nt];N(Cs=>({...Cs,[nt]:Ft})),nt==="hpPay"&&Ft&&!T&&ht(),nt==="payment"&&Ft&&!pe&&qt()},be=async(nt,Ft)=>{if(!n)return;const Cs=Ft==="",Ht=JSON.parse(sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo")||"{}");try{const Os={CUST_ID:n.custId,CTRT_ID:nt.CTRT_ID,HP_PAY_STAT:Cs?"Y":"N",SO_ID:(r==null?void 0:r.soId)||Ht.soId||"",MST_SO_ID:Ht.mstSoId||"200",USR_ID:Ht.userId||Ht.USR_ID||""},Zt=await R9(Os);if(Zt.success){St(` ${Ft} .`,"success"),ht();return}console.warn("HP Pay direct save failed, falling back to consultation:",Zt.message);const Ds={CUST_ID:n.custId,CTRT_ID:nt.CTRT_ID,CNSL_MST_CL:"04",CNSL_MID_CL:"0401",CNSL_SLV_CL:"040101",REQ_CTX:`[ ${Ft} ]
: ${nt.PROD_NM}
ID: ${nt.CTRT_ID}
: ${nt.HP_STAT||""}
: ${Ft}`},js=await Gj(Ds);js.success?(St(` ${Ft}  .    .`,"info"),ht()):St(js.message||`${Ft}  .`,"error")}catch(Os){console.error("HP Pay change error:",Os),St(`${Ft}    .`,"error")}},Oe=F.filter(nt=>nt.CTRT_STAT_NM===""),je=Oe.filter(nt=>nt.HP_STAT!==""),tt=Oe.filter(nt=>nt.HP_STAT===""),[Te,_t]=x.useState(new Set),[Qe,yt]=x.useState(new Set),vt=(nt,Ft)=>{nt==="apply"?_t(Ft?new Set(je.map(Cs=>Cs.CTRT_ID)):new Set):yt(Ft?new Set(tt.map(Cs=>Cs.CTRT_ID)):new Set)},$e=(nt,Ft,Cs)=>{(nt==="apply"?_t:yt)(Os=>{const Zt=new Set(Os);return Cs?Zt.add(Ft):Zt.delete(Ft),Zt})},ot=async()=>{if(Te.size===0){St("  .","warning");return}const nt=je.filter(Ft=>Te.has(Ft.CTRT_ID));We({isOpen:!0,title:"  ",message:`${nt.length} ?`,type:"confirm",onConfirm:async()=>{for(const Ft of nt)await be(Ft,"");_t(new Set)}})},wt=async()=>{if(Qe.size===0){St("  .","warning");return}const nt=tt.filter(Ft=>Qe.has(Ft.CTRT_ID));We({isOpen:!0,title:"  ",message:`${nt.length} ?`,type:"confirm",onConfirm:async()=>{for(const Ft of nt)await be(Ft,"");yt(new Set)}})},Bt=async()=>{var Ft,Cs;if(!n){St("  .","warning");return}const nt=C.telNo.replace(/[^0-9]/g,"");if(C.disconnYn!=="Y"){const Ht=y9(nt,C.telNoType);if(Ht){St(Ht,"warning");return}}else if(!nt){St(" .","warning");return}J(!0);try{const{ddd:Ht,fix:Os,dtl:Zt}=b9(nt),Ds=C.telNoType==="tel"?"1":"2",js=C.telNoType==="tel"?"":"",hs=C.telNoType==="tel"?((Ft=n.telNo)==null?void 0:Ft.replace(/[^0-9]/g,""))||"":((Cs=n.hpNo)==null?void 0:Cs.replace(/[^0-9]/g,""))||"",Us={CUST_ID:n.custId,TEL_NO:hs,TEL_DDD:Ht,TEL_FIX:Os,TEL_DTL:Zt,MB_CORP_TP:C.telTpCd,NO_SVC_YN:C.disconnYn,TEL_NO_TP:Ds,USE_YN:"Y",CTRT_ID:(r==null?void 0:r.ctrtId)||"",MAIN_TEL_YN:"N",CHG_UID:""},Qs=await T9(Us);Qs.success?(St(`${js} .`,"success"),v({telNoType:"hp",telNo:"",telTpCd:"",disconnYn:"N"})):St(Qs.message||"  .","error")}catch(Ht){console.error("Update phone error:",Ht),St("    .","error")}finally{J(!1)}},Yt=async()=>{if(!(r!=null&&r.ctrtId)){St("     .","warning");return}if(!O.zipCd||!O.addr1){St("  .","warning");return}if(!O.postId){St("    .","warning");return}V(!0);try{const nt={CTRT_ID:r.ctrtId,POST_ID:O.postId,BLD_CL:O.bldCl||"0",BLD_NM:O.bldNm||"",BUN_NO:O.bunNo||"",HO_NM:O.hoNm||"",ADDR_DTL:O.addr2||"",STREET_ID:O.streetId||void 0,INSTL_LOC:P.instlLoc||void 0,CUST_FLAG:"0",PYM_FLAG:O.changeBillAddr?"1":"0"},Ft=await nR(nt);if(Ft.success){St(" .","success");const Cs=`${O.addr1}${O.addr2?" "+O.addr2:""}`;G(Ht=>({...Ht,addr:Cs})),S({zipCd:"",addr1:"",addr2:"",instlLoc:"",changeBillAddr:!1,postId:"",streetId:"",dongmyonNm:"",bldCl:"0",bldNm:"",bunNo:"",hoNm:""}),Pe(""),y==null||y()}else St(Ft.message||"  .","error")}catch(nt){console.error("Update address error:",nt),St("    .","error")}finally{V(!1)}},[Xt,ts]=x.useState(!1),[Ut,Es]=x.useState(""),ys=async()=>{if(!(r!=null&&r.ctrtId)){St("     .","warning");return}if(!Ut){St("  .","warning");return}ts(!0);try{let nt="",Ft="0",Cs="",Ht="";try{const Ds=await Ex(n.custId);if(Ds.success&&Ds.data){const js=Ds.data.find(hs=>hs.CTRT_ID===r.ctrtId);js&&(nt=js.ADDR_DTL||"",Ft=js.BLD_CL||"0",Cs=js.BLD_NM||"",Ht=js.STREET_ID||"")}}catch(Ds){console.log("[]    ,  :",Ds)}const Os={CTRT_ID:r.ctrtId,POST_ID:r.postId||"",ADDR_DTL:nt,BLD_CL:Ft,BLD_NM:Cs,STREET_ID:Ht,INSTL_LOC:Ut,CUST_FLAG:"0",PYM_FLAG:"0"},Zt=await nR(Os);Zt.success?(St(" .","success"),G(Ds=>({...Ds,instlLoc:Ut})),Es(""),y==null||y()):St(Zt.message||"  .","error")}catch(nt){console.error("Update location error:",nt),St("    .","error")}finally{ts(!1)}},Ps=()=>{Ke(!0),mt(""),De({streetNm:"",streetBunM:"",streetBunS:""}),Ce([]),Be([])},ps=()=>{Ke(!1),Ce([]),Be([])},vs=(nt,Ft)=>{const Cs=Ft.toLowerCase();return nt.filter(Ht=>{const Os=(Ht.DONGMYON_NM||"").toLowerCase(),Zt=(Ht.ADDR||"").toLowerCase(),Ds=(Ht.GUGUN_NM||"").toLowerCase(),js=(Ht.BLD_NM||"").toLowerCase();return Os.includes(Cs)||Zt.includes(Cs)||Ds.includes(Cs)||js.includes(Cs)})},Ms=async()=>{if(!Ot||Ot.length<2){St("/  2  .","warning");return}Le(!0);try{const nt=(r==null?void 0:r.soId)||"",Ft=await V9({DONGMYONG:Ot,...nt?{SO_ID:nt}:{}});if(Ft.success&&Ft.data){let Cs=Ft.data;if(Cs.length>0){const Ht=vs(Cs,Ot);console.log(`[AddressSearch] : ${Cs.length}  ${Ht.length} (: ${Ot})`),Cs=Ht}Ce(Cs),Cs.length===0&&St("   .","info")}else St(Ft.message||"  .","error"),Ce([])}catch(nt){console.error("Search post address error:",nt),St("    .","error"),Ce([])}finally{Le(!1)}},cs=async()=>{if(!Ze.streetNm||Ze.streetNm.length<2){St(" 2  .","warning");return}Le(!0);try{const nt=await $9({STREET_NM:Ze.streetNm,STREET_BUN_M:Ze.streetBunM||"",STREET_BUN_S:Ze.streetBunS||"",SO_ID:(r==null?void 0:r.soId)||""});nt.success&&nt.data?(Be(nt.data),nt.data.length===0&&St("   .","info")):(St(nt.message||"  .","warning"),Be([]))}catch(nt){console.error("Search street address error:",nt),St("    .","error"),Be([])}finally{Le(!1)}},ms=nt=>{const Ft=nt.BLD_NM?nt.BLD_NM.includes("")||nt.BLD_NM.includes("APT")?"2":"1":"0";S(Cs=>({...Cs,zipCd:nt.ZIP_CD,addr1:nt.ADDR_FULL||nt.ADDR,addr2:"",postId:nt.POST_ID,streetId:"",dongmyonNm:nt.DONGMYON_NM||"",bldCl:Ft,bldNm:nt.BLD_NM||"",bunNo:nt.STRT_BUNGIHO||"",hoNm:""})),Pe(nt.POST_ID),ps(),St(" .  .","info")},Ks=nt=>{const Ft=nt.BLD_NM?nt.BLD_NM.includes("")||nt.BLD_NM.includes("APT")?"2":"1":"0";S(Cs=>({...Cs,zipCd:nt.ZIP_CD,addr1:nt.STREET_ADDR||nt.ADDR_FULL,addr2:"",postId:nt.POST_ID,streetId:nt.STREET_ID,dongmyonNm:nt.DONGMYON_NM||nt.NM_SMALL||"",bldCl:Ft,bldNm:nt.BLD_NM||"",bunNo:nt.BUN_NO||"",hoNm:nt.HO_NM||""})),Pe(nt.POST_ID),ps(),St(" .  .","info")};return n?s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>he("phone"),className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yy,{className:"w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:" "})]}),g.phone?s.jsx(Mr,{className:"w-5 h-5 text-gray-400"}):s.jsx(sr,{className:"w-5 h-5 text-gray-400"})]}),g.phone&&s.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-2 font-medium",children:"   ()"}),n.phoneList&&n.phoneList.length>2?s.jsx("div",{className:"space-y-2",children:n.phoneList.map((nt,Ft)=>s.jsxs("button",{type:"button",onClick:()=>v(Cs=>({...Cs,telNoType:nt.type})),className:`w-full p-2 rounded border flex justify-between items-center transition-colors ${C.telNoType===nt.type?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white border-gray-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`text-xs ${C.telNoType===nt.type?"text-blue-600 font-medium":"text-gray-500"}`,children:nt.typeNm}),s.jsx("div",{className:`font-medium text-sm ${C.telNoType===nt.type?"text-blue-700":"text-gray-800"}`,children:wC(nt.number)||"-"})]},Ft))}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>v(nt=>({...nt,telNoType:"tel"})),className:`p-2 rounded border text-left transition-colors ${C.telNoType==="tel"?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white border-gray-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`text-xs ${C.telNoType==="tel"?"text-blue-600 font-medium":"text-gray-500"}`,children:""}),s.jsx("div",{className:`font-medium text-sm ${C.telNoType==="tel"?"text-blue-700":"text-gray-800"}`,children:wC(n.telNo)||"-"})]}),s.jsxs("button",{type:"button",onClick:()=>v(nt=>({...nt,telNoType:"hp"})),className:`p-2 rounded border text-left transition-colors ${C.telNoType==="hp"?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white border-gray-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`text-xs ${C.telNoType==="hp"?"text-blue-600 font-medium":"text-gray-500"}`,children:""}),s.jsx("div",{className:`font-medium text-sm ${C.telNoType==="hp"?"text-blue-700":"text-gray-800"}`,children:wC(n.hpNo)||"-"})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:[" ",C.telNoType==="tel"?"":""]}),s.jsx("input",{type:"tel",value:C.telNo,onChange:nt=>v(Ft=>({...Ft,telNo:nt.target.value.replace(/[^0-9]/g,"")})),placeholder:C.telNoType==="tel"?"0212345678":"01012345678",maxLength:12,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsxs("select",{value:C.telTpCd,onChange:nt=>v(Ft=>({...Ft,telTpCd:nt.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:""}),R.map(nt=>s.jsx("option",{value:nt.CODE,children:nt.CODE_NM},nt.CODE)),R.length===0&&A&&s.jsx("option",{value:"",disabled:!0,children:"..."})]})]}),s.jsx("button",{onClick:Bt,disabled:te,className:"w-full flex items-center justify-center gap-2 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 transition-colors",children:te?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[C.telNoType==="tel"?"":""," "]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>he("address"),className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rd,{className:"w-5 h-5 text-green-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:" / "})]}),g.address?s.jsx(Mr,{className:"w-5 h-5 text-gray-400"}):s.jsx(sr,{className:"w-5 h-5 text-gray-400"})]}),g.address&&s.jsx("div",{className:"px-4 pb-4 space-y-4",children:r!=null&&r.ctrtId?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-3 bg-gray-100 border border-gray-300 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(cL,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"  "})]}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",r.prodNm]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",P.addr||"-"]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",P.instlLoc||"-"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:O.zipCd,readOnly:!0,placeholder:"  ",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 cursor-pointer",onClick:Ps}),s.jsxs("button",{onClick:Ps,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-1",children:[s.jsx(yu,{className:"w-4 h-4"}),""]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:O.addr1,onChange:nt=>S(Ft=>({...Ft,addr1:nt.target.value})),placeholder:" ",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:O.addr2,onChange:nt=>S(Ft=>({...Ft,addr2:nt.target.value})),placeholder:"  ()",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[s.jsxs("label",{className:`flex items-center gap-2 ${K?"cursor-pointer":"cursor-not-allowed opacity-50"}`,children:[s.jsx("input",{type:"checkbox",checked:O.changeBillAddr,onChange:nt=>S(Ft=>({...Ft,changeBillAddr:nt.target.checked})),disabled:!K,className:"w-4 h-4 text-green-600 rounded"}),s.jsx("span",{className:"text-sm text-gray-700",children:"  "}),!K&&s.jsxs("span",{className:"text-xs text-orange-500",children:["( ",k.length," -   )"]})]}),O.changeBillAddr&&K&&s.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded text-xs",children:[s.jsxs("p",{className:"text-blue-700",children:[s.jsx("strong",{children:" :"})," ",((Ls=k[0])==null?void 0:Ls.BILL_ADDR)||"  "]}),s.jsx("p",{className:"text-blue-600 mt-1",children:"     "})]})]}),s.jsx("button",{onClick:Yt,disabled:q,className:"w-full flex items-center justify-center gap-2 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:q?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-5 h-5 animate-spin"})," ..."]}):" "}),s.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:" "}),s.jsx("div",{children:s.jsx("input",{type:"text",value:Ut,onChange:nt=>Es(nt.target.value),placeholder:P.instlLoc?`: ${P.instlLoc}`:": , ,  ",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),s.jsx("button",{onClick:ys,disabled:Xt,className:"w-full flex items-center justify-center gap-2 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:Xt?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-5 h-5 animate-spin"})," ..."]}):" "})]})]}):s.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Wr,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"  "}),s.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"     /  ."})]})]})})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>he("hpPay"),className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(by,{className:"w-5 h-5 text-purple-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:"() "})]}),g.hpPay?s.jsx(Mr,{className:"w-5 h-5 text-gray-400"}):s.jsx(sr,{className:"w-5 h-5 text-gray-400"})]}),g.hpPay&&s.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:ht,disabled:ee,className:"flex items-center gap-1 px-3 py-1 text-sm text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:s.jsx(uc,{className:`w-4 h-4 ${ee?"animate-spin":""}`})})}),ee&&s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(jn,{className:"w-6 h-6 text-purple-500 animate-spin"}),s.jsx("span",{className:"ml-2 text-gray-500",children:" ..."})]}),!ee&&T&&Oe.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(by,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{children:"   ."})]}),!ee&&je.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-purple-700",children:[s.jsx("input",{type:"checkbox",checked:je.length>0&&Te.size===je.length,onChange:nt=>vt("apply",nt.target.checked),className:"w-4 h-4 text-purple-600 rounded"}),"  (",je.length,")"]}),s.jsxs("button",{onClick:ot,disabled:Te.size===0,className:"px-3 py-1 text-xs font-medium bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:bg-gray-300 transition-colors",children:["  (",Te.size,")"]})]}),je.map((nt,Ft)=>s.jsxs("div",{className:`p-3 rounded-lg border ${Te.has(nt.CTRT_ID)?"bg-purple-50 border-purple-300":"bg-gray-50 border-gray-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",checked:Te.has(nt.CTRT_ID),onChange:Cs=>$e("apply",nt.CTRT_ID,Cs.target.checked),className:"w-4 h-4 text-purple-600 rounded flex-shrink-0"}),s.jsx("span",{className:"font-medium text-gray-800 text-sm flex-1",children:nt.PROD_NM||" "}),s.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full flex-shrink-0 bg-orange-100 text-orange-700",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-1 ml-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"ID:"}),s.jsx("span",{className:"text-gray-700",children:nt.CTRT_ID})]}),nt.ADDR&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:": "}),s.jsx("span",{className:"text-gray-700 break-all",children:nt.ADDR})]})]})]},nt.CTRT_ID||`apply-${Ft}`))]}),!ee&&tt.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-green-700",children:[s.jsx("input",{type:"checkbox",checked:tt.length>0&&Qe.size===tt.length,onChange:nt=>vt("cancel",nt.target.checked),className:"w-4 h-4 text-green-600 rounded"}),"  (",tt.length,")"]}),s.jsxs("button",{onClick:wt,disabled:Qe.size===0,className:"px-3 py-1 text-xs font-medium bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:bg-gray-300 transition-colors",children:["  (",Qe.size,")"]})]}),tt.map((nt,Ft)=>s.jsxs("div",{className:`p-3 rounded-lg border ${Qe.has(nt.CTRT_ID)?"bg-green-50 border-green-300":"bg-gray-50 border-gray-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",checked:Qe.has(nt.CTRT_ID),onChange:Cs=>$e("cancel",nt.CTRT_ID,Cs.target.checked),className:"w-4 h-4 text-green-600 rounded flex-shrink-0"}),s.jsx("span",{className:"font-medium text-gray-800 text-sm flex-1",children:nt.PROD_NM||" "}),s.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full flex-shrink-0 bg-green-100 text-green-700",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-1 ml-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"ID:"}),s.jsx("span",{className:"text-gray-700",children:nt.CTRT_ID})]}),nt.ADDR&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:": "}),s.jsx("span",{className:"text-gray-700 break-all",children:nt.ADDR})]})]})]},nt.CTRT_ID||`cancel-${Ft}`))]}),s.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Wr,{className:"w-4 h-4 text-purple-600 mt-0.5"}),s.jsx("div",{className:"text-sm text-purple-700",children:s.jsx("p",{children:"/     ,    ."})})]})})]})]})]}),dt&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden max-h-[85vh] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-100 bg-gradient-to-r from-green-500 to-green-600 flex-shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(rd,{className:"w-4 h-4"})," "]}),s.jsx("button",{onClick:ps,className:"text-white/80 hover:text-white",children:s.jsx(bi,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"p-3 border-b border-gray-200 flex-shrink-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{ft("post"),Ce([]),Be([])},className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${rt==="post"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:()=>{ft("street"),Ce([]),Be([])},className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${rt==="street"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]})}),s.jsxs("div",{className:"p-3 border-b border-gray-200 flex-shrink-0",children:[rt==="post"?s.jsx("div",{className:"space-y-2",children:s.jsx("input",{type:"text",value:Ot,onChange:nt=>mt(nt.target.value),onKeyPress:nt=>nt.key==="Enter"&&Ms(),placeholder:"//   (: )",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:" *"}),s.jsx("input",{type:"text",value:Ze.streetNm,onChange:nt=>De(Ft=>({...Ft,streetNm:nt.target.value})),onKeyPress:nt=>nt.key==="Enter"&&cs(),placeholder:": ",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("input",{type:"text",value:Ze.streetBunM,onChange:nt=>De(Ft=>({...Ft,streetBunM:nt.target.value.replace(/[^0-9]/g,"")})),placeholder:": 123",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("input",{type:"text",value:Ze.streetBunS,onChange:nt=>De(Ft=>({...Ft,streetBunS:nt.target.value.replace(/[^0-9]/g,"")})),placeholder:": 0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]})]}),s.jsx("button",{onClick:rt==="post"?Ms:cs,disabled:ce,className:"w-full mt-3 flex items-center justify-center gap-2 py-2.5 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:ce?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-4 h-4 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(yu,{className:"w-4 h-4"}),""]})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-3 min-h-0",children:rt==="post"?Ye.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",Ye.length,""]}),Ye.map((nt,Ft)=>s.jsxs("button",{onClick:()=>ms(nt),className:"w-full p-3 bg-gray-50 hover:bg-green-50 rounded-lg border border-gray-200 hover:border-green-300 text-left transition-colors",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:nt.ADDR_FULL||nt.ADDR}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[": ",nt.ZIP_CD," | ",nt.SIDO_NAME," ",nt.GUGUN_NM," ",nt.DONGMYON_NM]})]},nt.POST_ID||Ft))]}):s.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"//   ."}):ge.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",ge.length,""]}),ge.map((nt,Ft)=>s.jsxs("button",{onClick:()=>Ks(nt),className:"w-full p-3 bg-gray-50 hover:bg-green-50 rounded-lg border border-gray-200 hover:border-green-300 text-left transition-colors",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:nt.STREET_ADDR}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[": ",nt.ZIP_CD," | ",nt.ADDR_FULL]}),nt.BLD_NM&&s.jsxs("div",{className:"mt-0.5 text-xs text-green-600",children:[": ",nt.BLD_NM]})]},nt.STREET_ID||Ft))]}):s.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  ."})}),s.jsx("div",{className:"p-3 border-t border-gray-200 flex-shrink-0",children:s.jsx("button",{onClick:ps,className:"w-full py-2.5 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",children:""})})]})}),ye&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsx(Vj,{title:"  ",onSave:It,onCancel:()=>ne(!1)})})}),et&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-yellow-500 to-orange-500",children:s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(Wr,{className:"w-5 h-5"}),"  "]})}),s.jsxs("div",{className:"p-4",children:[s.jsxs("p",{className:"text-gray-700 text-sm",children:["      .",s.jsx("br",{}),"     ."]}),s.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"?"})]}),s.jsxs("div",{className:"p-4 bg-gray-50 flex gap-2",children:[s.jsx("button",{onClick:()=>{bt(!1),At("")},className:"flex-1 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""}),s.jsx("button",{onClick:()=>ze(it),className:"flex-1 py-2.5 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium",children:""})]})]})}),s.jsx(ul,{isOpen:at.isOpen,onClose:()=>We(kv),onConfirm:at.onConfirm,title:at.title,message:at.message,type:at.type,confirmText:"",cancelText:""}),s.jsx(ul,{isOpen:Dt.isOpen,onClose:()=>Tt({isOpen:!1,message:"",type:"info"}),onConfirm:()=>{},message:Dt.message,type:Dt.type==="success"?"confirm":Dt.type==="warning"?"warning":Dt.type==="error"?"error":"info",confirmText:"",showCancel:!1})]}):s.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"  "}),s.jsxs("p",{className:"text-gray-500",children:["     ",s.jsx("br",{}),"   ."]})]})})},Uf=({isOpen:t,onClose:e,onScan:n,isMultiScanMode:r=!1,scanCount:i=0})=>{const l=x.useRef(null),[c,d]=x.useState(!1),[u,f]=x.useState(null),[m,_]=x.useState(!1);x.useEffect(()=>t?((async()=>{try{screen.orientation&&screen.orientation.lock&&await screen.orientation.lock("portrait")}catch{console.log("Screen orientation lock not supported")}})(),()=>{try{screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock()}catch{}}):void 0,[t]),x.useEffect(()=>t?(f(null),d(!1),(async()=>{if(window.Html5Qrcode){await y();return}const U=document.createElement("script");U.src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js",U.async=!0,U.onload=()=>{y()},U.onerror=()=>{f("    .")},document.body.appendChild(U)})(),()=>{N()}):void 0,[t]);const y=async()=>{var R,U,L;try{if(f(null),!window.Html5Qrcode){f("Html5Qrcode not loaded");return}await g()}catch(w){console.error("Camera init error:",w),w.name==="NotAllowedError"||(R=w.message)!=null&&R.includes("Permission")?f(`   .
   .`):(U=w.message)!=null&&U.includes("secure context")||(L=w.message)!=null&&L.includes("https")?f(` HTTPS  localhost  .

 S/N .`):f(`   :
`+(w.message||w))}},g=async()=>{try{const R=window.Html5Qrcode;if(!R)return;if(l.current){try{await l.current.stop(),l.current.clear()}catch{}l.current=null}await new Promise(L=>setTimeout(L,100)),l.current=new R("barcode-reader");const U={fps:15,qrbox:{width:300,height:180},aspectRatio:1.777778,disableFlip:!1};await l.current.start({facingMode:"environment"},U,L=>{console.log("Barcode scanned:",L),navigator.vibrate&&navigator.vibrate(100),n(L),r||C()},L=>{});try{const L=document.querySelector("#barcode-reader video");if(L&&L.srcObject){const w=L.srcObject.getVideoTracks()[0];if(w){await w.applyConstraints({width:{ideal:4096},height:{ideal:2160}});try{await w.applyConstraints({advanced:[{focusMode:"continuous"}]})}catch{}}}}catch(L){console.log("Camera enhancement not supported:",L)}d(!0),f(null)}catch(R){console.error("Scanner start error:",R),f(`   .
`+(R.message||" ."))}},N=async()=>{if(l.current){try{await l.current.stop(),l.current.clear()}catch{}l.current=null}d(!1)},C=async()=>{await N(),e()},v=async()=>{_(!0),f(null),await N(),await new Promise(R=>setTimeout(R,300)),await y(),_(!1)};return t?s.jsxs("div",{className:"fixed inset-0 bg-black barcode-scanner-container z-[999999]",children:[s.jsxs("button",{onClick:C,className:"absolute top-4 right-4 z-30 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 transition-colors active:scale-95 flex items-center gap-2",style:{marginTop:"env(safe-area-inset-top, 0px)"},children:[s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("span",{className:"text-white font-medium text-sm",children:""})]}),r&&s.jsxs("div",{className:"absolute top-4 left-4 z-30 px-3 py-2 bg-blue-500 text-white text-sm font-bold rounded-full",style:{marginTop:"env(safe-area-inset-top, 0px)"},children:[i,""]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{top:"60px",bottom:"180px"},children:s.jsx("div",{id:"barcode-reader",className:"w-full max-w-md mx-4"})}),c&&s.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:s.jsxs("div",{className:"w-[300px] h-[180px] relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-green-400 rounded-tl-lg"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-green-400 rounded-tr-lg"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-green-400 rounded-bl-lg"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-green-400 rounded-br-lg"}),s.jsx("div",{className:"absolute left-2 right-2 h-0.5 bg-gradient-to-r from-transparent via-green-400 to-transparent animate-scan"})]})}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/80 px-4 pt-3 z-20",style:{paddingBottom:"max(20px, env(safe-area-inset-bottom, 20px))"},children:[u?s.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 mb-3",children:[s.jsx("p",{className:"text-red-200 text-sm text-center whitespace-pre-line",children:u}),s.jsx("button",{onClick:v,disabled:m,className:"w-full mt-3 py-2.5 bg-red-500 hover:bg-red-600 disabled:bg-red-400 text-white rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:m?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"  ..."]}):" "})]}):s.jsxs("div",{className:"text-center mb-3",children:[s.jsx("p",{className:"text-white/80 text-sm mb-1",children:"    "}),s.jsx("p",{className:"text-white/50 text-xs",children:r?"   -    ":"S/N   "})]}),s.jsx("button",{onClick:C,className:"w-full py-3 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-semibold transition-colors active:scale-[0.98] border border-gray-500",children:"  "})]}),s.jsx("style",{children:`
        @keyframes scan {
          0% { top: 10%; }
          50% { top: 85%; }
          100% { top: 10%; }
        }
        .animate-scan {
          animation: scan 2s ease-in-out infinite;
        }
        #barcode-reader {
          border: none !important;
          background: transparent !important;
          width: 100% !important;
        }
        #barcode-reader video {
          width: 100% !important;
          height: auto !important;
          object-fit: cover !important;
        }
        #barcode-reader__scan_region {
          background: transparent !important;
          min-height: 300px !important;
        }
        #barcode-reader__scan_region img {
          display: none !important;
        }
        #barcode-reader__scan_region br {
          display: none !important;
        }
        /* Hide the qrbox border */
        #barcode-reader__scan_region > div {
          border: none !important;
          box-shadow: none !important;
        }
        #qr-shaded-region {
          border: none !important;
        }
        /* Hide all library UI elements */
        #barcode-reader__dashboard,
        #barcode-reader__dashboard_section,
        #barcode-reader__dashboard_section_swaplink,
        #barcode-reader__dashboard_section_csr,
        #barcode-reader__status_span,
        #barcode-reader__header_message,
        #barcode-reader img[alt="Info icon"],
        #barcode-reader a {
          display: none !important;
        }
        #barcode-reader > div:last-child {
          display: none !important;
        }
        /*       */
        @media screen and (orientation: landscape) {
          .barcode-scanner-container {
            transform: rotate(-90deg);
            transform-origin: left top;
            width: 100vh !important;
            height: 100vw !important;
            position: fixed !important;
            top: 100% !important;
            left: 0 !important;
          }
        }
      `})]}):null},mK=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},$u=t=>t.replace(/[^0-9]/g,""),gK=({onCustomerSelect:t,onCustomerClear:e,showToast:n,selectedCustomer:r})=>{const[i,l]=x.useState(!1),[c,d]=x.useState(""),[u,f]=x.useState(""),[m,_]=x.useState(""),[y,g]=x.useState(""),[N,C]=x.useState(""),[v,R]=x.useState(!1),[U,L]=x.useState([]),[w,P]=x.useState(!1),[G,K]=x.useState(!1),B=x.useRef({customerId:"",contractId:"",phoneNumber:"",customerName:"",equipmentNo:""}),[O,S]=x.useState({show:!1,title:"",message:""}),A=()=>{d(B.current.customerId),f(B.current.contractId),_(B.current.phoneNumber),g(B.current.customerName),C(B.current.equipmentNo),l(!0)},Y=()=>{l(!1)},te=()=>{d(""),f(""),_(""),g(""),C(""),L([])},J=async()=>{let I=$u(c),ee=$u(u);const ae=$u(m);I.length>0&&I.length<10&&(I=I.padStart(10,"0"),d(I)),ee.length>0&&ee.length<10&&(ee=ee.padStart(10,"0"),f(ee));const T=I.length>=4,j=ee.length>=4,k=ae.length>=4,Q=y.length>=2,H=N.length>=4;if(y.length===1){S({show:!0,title:" ",message:" 2  ."});return}if(!T&&!j&&!k&&!Q&&!H){S({show:!0,title:" ",message:`  .
(ID/ID/S/N 4,  4,  2)`});return}B.current={customerId:I,contractId:ee,phoneNumber:m,customerName:y,equipmentNo:N},R(!0),P(!0);try{const $=await v9({custId:T?I:void 0,contractId:j?ee:void 0,phoneNumber:k?ae:void 0,customerName:Q?y:void 0,equipmentNo:H?N:void 0});if($.success&&$.data&&$.data.length>0){let ie=$.data;if(j&&ie.length>0&&(ie=ie.map(fe=>({...fe,CTRT_ID:ee}))),H&&ie.length>0)try{const fe=ie[0].CUST_ID,pe=await Ex(fe);if(pe.success&&pe.data){const de=N.toLowerCase(),Re=pe.data.find(X=>{var _e,me;return((_e=X.NOTRECEV)==null?void 0:_e.toLowerCase().includes(de))||((me=X.EQT_SERNO)==null?void 0:me.toLowerCase().includes(de))});Re&&(ie=ie.map(X=>({...X,CTRT_ID:Re.CTRT_ID})))}}catch(fe){console.log("[CustomerSearch] S/N  CTRT_ID lookup failed:",fe)}T&&(ie=ie.filter(fe=>(fe.CUST_ID||"").includes(I))),j&&(ie=ie.filter(fe=>(fe.CTRT_ID||"").includes(ee))),Q&&(ie=ie.filter(fe=>(fe.CUST_NM||"").includes(y))),k&&(ie=ie.filter(fe=>[fe.TEL_NO,fe.HP_NO,...(fe.PHONE_LIST||[]).map(de=>de.TEL_NO||de.HP_NO)].filter(Boolean).map(de=>de.replace(/[^0-9]/g,"")).some(de=>de.includes(ae)||ae.includes(de)))),H&&(ie=ie.filter(fe=>(fe.EQT_SERNO||"").toLowerCase().includes(N.toLowerCase())||(fe.NOTRECEV||"").toLowerCase().includes(N.toLowerCase()))),ie.length>0?L(ie):(L([]),S({show:!0,title:" ",message:` .
  .`}))}else L([]),S({show:!0,title:" ",message:` .
  .`})}catch($){console.error("Customer search error:",$),S({show:!0,title:"",message:"   ."}),L([])}finally{R(!1)}},q=I=>{I.key==="Enter"&&J()},V=I=>{C(I.toUpperCase()),K(!1)},F=I=>{const ee=I.CUST_ID||"",ae=$u(I.TEL_NO||I.HP_NO||""),T=I.CUST_NM||"",j=I.CTRT_ID||u;d(ee),_(ae),g(T),I.CTRT_ID&&f(I.CTRT_ID),B.current={customerId:ee,contractId:j,phoneNumber:ae,customerName:T,equipmentNo:N};const k={...I,EQT_SERNO:N||I.EQT_SERNO||void 0};t(k),Y()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-white rounded-lg border border-gray-100 shadow-sm p-3",children:s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex gap-2 cursor-pointer min-w-0 overflow-hidden",onClick:A,children:[s.jsx("input",{readOnly:!0,className:"flex-1 min-w-0 px-2 py-2 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer truncate",placeholder:"",type:"text",value:(r==null?void 0:r.CUST_NM)||""}),s.jsx("input",{readOnly:!0,className:"flex-1 min-w-0 px-2 py-2 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer",placeholder:"ID",type:"text",value:r?mK(r.CUST_ID):""})]})]})})}),i&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden max-h-[80vh] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-100 bg-gradient-to-r from-blue-500 to-blue-600 flex-shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(Ih,{className:"w-4 h-4"})," "]}),s.jsx("button",{onClick:te,className:"px-3 py-1 text-xs font-medium text-blue-600 bg-white rounded-lg hover:bg-gray-100 transition-colors",children:""})]})}),s.jsxs("div",{className:"p-4 space-y-3 flex-1 overflow-y-auto min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:c,onChange:I=>d($u(I.target.value)),onKeyPress:q,placeholder:"0000000000",maxLength:10,className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:u,onChange:I=>f($u(I.target.value)),onKeyPress:q,placeholder:"0000000000",maxLength:10,className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex gap-2 min-w-0",children:[s.jsx("input",{type:"tel",value:m,onChange:I=>_($u(I.target.value)),onKeyPress:q,placeholder:"01000000000",maxLength:11,className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",value:y,onChange:I=>g(I.target.value),onKeyPress:q,placeholder:"",className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:N,onChange:I=>C(I.target.value.toUpperCase()),onKeyPress:q,placeholder:"S/N  MAC  ",className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono"}),s.jsxs("button",{onClick:()=>K(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-white flex-shrink-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:J,disabled:v,className:"flex-1 py-2.5 text-sm text-white bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 rounded-lg font-medium flex items-center justify-center",children:v?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-4 h-4 animate-spin mr-2"})," ..."]}):""}),s.jsx("button",{onClick:Y,className:"flex-1 py-2.5 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium",children:""})]})}),s.jsx("div",{className:"px-4 pb-4 flex-shrink-0",children:w?U.length>0?s.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3 bg-gray-50",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",U.length,""]}),U.map((I,ee)=>s.jsxs("button",{onClick:()=>F(I),className:"w-full p-3 bg-white hover:bg-blue-50 rounded-lg border border-gray-200 hover:border-blue-300 text-left transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-blue-600 font-mono text-sm",children:I.CUST_ID}),s.jsx("span",{className:"font-semibold text-gray-900",children:I.CUST_NM})]}),I.CTRT_ID&&s.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:[s.jsx("span",{className:"text-gray-400",children:"ID:"})," ",s.jsx("span",{className:"font-mono",children:I.CTRT_ID})]}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500 truncate",children:[Hy(I.TEL_NO||I.HP_NO),I.CUST_ADDR&&` | ${I.CUST_ADDR}`]}),I.UNPAY_AMT>0&&s.jsxs("div",{className:"mt-1 text-xs text-red-500 font-medium",children:[": ",I.UNPAY_AMT.toLocaleString(),""]})]},I.CUST_ID||ee))]}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm border border-gray-200 rounded-lg bg-gray-50",children:"  ."}):s.jsx("div",{className:"text-center py-4 text-gray-400 text-sm border border-dashed border-gray-200 rounded-lg",children:"     ."})})]})}),s.jsx(Uf,{isOpen:G,onClose:()=>K(!1),onScan:V}),O.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:s.jsx(Wr,{className:"w-5 h-5 text-orange-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:O.title})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-5 whitespace-pre-line",children:O.message}),s.jsx("div",{className:"flex gap-3",children:s.jsx("button",{onClick:()=>S({show:!1,title:"",message:""}),className:"flex-1 px-4 py-2 text-sm text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-colors",children:""})})]})})]})},s_=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},pK=({onBack:t,showToast:e,selectedCustomer:n,selectedContract:r,contracts:i=[],onNavigateToBasicInfo:l,initialTab:c="consultation"})=>{var ge,Be;const[d,u]=x.useState(c);x.useEffect(()=>{(c==="consultation"||c==="as")&&u(c)},[c]);const[f,m]=x.useState([]),[_,y]=x.useState([]),[g,N]=x.useState(r?"byContract":"byDate"),[C,v]=x.useState([]),[R,U]=x.useState([]),[L,w]=x.useState([]),[P,G]=x.useState("customer"),[K,B]=x.useState("subscriber"),[O,S]=x.useState(!1),A=ce=>{ce==="contract"?r?G("contract"):S(!0):G("customer")};x.useEffect(()=>{r&&G("contract")},[r]);const[Y,te]=x.useState({cnslLClCd:"",cnslMClCd:"",cnslSClCd:"",reqCntn:"",transYn:"N",transDeptCd:""}),[J,q]=x.useState(new Set),[V,F]=x.useState(new Set),I=ce=>{q(Le=>{const Xe=new Set(Le);return Xe.has(ce)?Xe.delete(ce):Xe.add(ce),Xe})},ee=ce=>{F(Le=>{const Xe=new Set(Le);return Xe.has(ce)?Xe.delete(ce):Xe.add(ce),Xe})},[ae,T]=x.useState([]),[j,k]=x.useState([]),[Q,H]=x.useState([]),[$,ie]=x.useState([]),fe=ce=>{if(!ce){te(Me=>({...Me,cnslLClCd:"",cnslMClCd:"",cnslSClCd:""}));return}const Le=$.find(Me=>Me.code===ce),Xe=(Le==null?void 0:Le.ref_code)||"",Pe=j.find(Me=>Me.code===Xe),Ct=(Pe==null?void 0:Pe.ref_code)||"";te(Me=>({...Me,cnslLClCd:Ct,cnslMClCd:Xe,cnslSClCd:ce}))},pe=()=>{const ce=new Date().getHours()+1;return ce>=9&&ce<=21?ce.toString().padStart(2,"0"):"09"},[de,Re]=x.useState({asClCd:"",asClDtlCd:"",asResnLCd:"",asResnMCd:"",asCntn:"",schdDt:new Date().toISOString().split("T")[0],schdHour:pe(),schdMin:"00"}),[X,_e]=x.useState([]),[me,Z]=x.useState([]),[le,se]=x.useState([]),[Ee,Ne]=x.useState([]),[ye,ne]=x.useState([]),ue=r!=null&&r.prodGrp?le.filter(ce=>!ce.ref_code||ce.ref_code.includes(r.prodGrp)):le,xe=ce=>{Re(Xe=>({...Xe,asResnLCd:ce,asResnMCd:""}));const Le=Ee.filter(Xe=>Xe.ref_code===ce);ne(Le)},et=Array.from({length:13},(ce,Le)=>{const Xe=(9+Le).toString().padStart(2,"0");return{value:Xe,label:`${Xe}`}}),bt=Array.from({length:6},(ce,Le)=>{const Xe=(Le*10).toString().padStart(2,"0");return{value:Xe,label:`${Xe}`}}),[it,At]=x.useState(!1),[at,We]=x.useState(!1),[Dt,Tt]=x.useState(!1),[St,ze]=x.useState({show:!1,type:"success",title:"",message:""}),dt=(ce,Le,Xe)=>{ze({show:!0,type:ce,title:Le,message:Xe})},[Ke,rt]=x.useState(!0),ft=g==="byContract"?r!=null&&r.ctrtId?f:[]:C,Ot=g==="byContract"?r!=null&&r.ctrtId?_:[]:R;x.useEffect(()=>{mt(),n&&r?(N("byContract"),De()):n&&(N("byDate"),Ze())},[n,r]),x.useEffect(()=>{n&&C.length===0&&R.length===0&&Ze()},[i]),x.useEffect(()=>{r!=null&&r.ctrtId&&(r==null?void 0:r.prodGrp)==="C"?B9(r.ctrtId).then(ce=>{if(ce.success&&ce.data){const Le=(Array.isArray(ce.data)?ce.data:[ce.data]).filter(Xe=>Xe.biz_cl||Xe.BIZ_CL||Xe.code).map(Xe=>({CODE:Xe.biz_cl||Xe.BIZ_CL||Xe.code||"",CODE_NM:Xe.SVC_NM||Xe.svc_nm||Xe.name||Xe.biz_cl||""}));Z(Le)}}).catch(()=>Z([])):Z([])},[r]);const mt=async()=>{We(!0);try{const[ce,Le,Xe,Pe,Ct,Me]=await Promise.all([L9(),w9(),P9(),A9(),k9(),U9()]),lt=ut=>ut.filter(jt=>jt.code&&jt.code!=="[]"&&jt.name!=="").map(jt=>({code:jt.code,name:jt.name,ref_code:jt.ref_code,ref_code2:jt.ref_code2,ref_code12:jt.ref_code12}));if(ce.success&&ce.data&&T(lt(ce.data)),Le.success&&Le.data&&k(lt(Le.data)),Xe.success&&Xe.data){const ut=lt(Xe.data);H(ut),ie(ut.filter(jt=>jt.ref_code12==="Y"))}if(Pe.success&&Pe.data){const ut=["0350","0360","0370"],jt=Pe.data.filter(Ve=>Ve.code&&Ve.code!=="[]"&&Ve.ref_code==="03"&&!ut.includes(Ve.code)).map(Ve=>({CODE:Ve.code,CODE_NM:Ve.name}));_e(jt)}if(Ct.success&&Ct.data){const ut=Ct.data.filter(jt=>jt.code&&jt.code!=="[]"&&jt.name!=="").map(jt=>({CODE:jt.code,CODE_NM:jt.name,ref_code:jt.ref_code2||""}));se(ut)}if(Me.success&&Me.data){const ut=Me.data.filter(jt=>jt.code&&jt.code!=="[]"&&jt.name!=="").map(jt=>({CODE:jt.code,CODE_NM:jt.name,ref_code:jt.ref_code}));Ne(ut)}}catch(ce){console.error("Load codes error:",ce)}finally{We(!1)}},Ze=async()=>{if(!n){v([]),U([]);return}At(!0);try{const[ce,Le]=await Promise.all([V_(n.custId,void 0,10),$_(n.custId,void 0,10)]),Xe=ce.success&&ce.data?ce.data:[],Pe=Le.success&&Le.data?Le.data:[];v(Xe),U(Pe)}catch(ce){console.error("Load all history error:",ce)}finally{At(!1)}},De=async()=>{if(!n||!r){m([]),y([]);return}At(!0);try{const[ce,Le]=await Promise.all([V_(n.custId,r.ctrtId,10),$_(n.custId,r.ctrtId,10)]);ce.success&&ce.data&&m(ce.data),Le.success&&Le.data&&y(Le.data)}catch(ce){console.error("Load history error:",ce)}finally{At(!1)}},Ye=async()=>{if(!n){dt("warning","","  .");return}if(!r){dt("warning","",`   .
     .`);return}if(!Y.cnslSClCd){dt("warning",""," .");return}if(!Y.reqCntn.trim()){dt("warning",""," .");return}Tt(!0);try{const ce={CUST_ID:n.custId,CTRT_ID:(r==null?void 0:r.ctrtId)||"",CNSL_MST_CL:Y.cnslLClCd,CNSL_MID_CL:Y.cnslMClCd,CNSL_SLV_CL:Y.cnslSClCd,REQ_CTX:Y.reqCntn,POST_ID:(r==null?void 0:r.postId)||"",SAVE_TP:"2",CNSL_RSLT:"5",RCPT_TP:"G1",CUST_REL:"A",PRESS_RCPT_YN:"N",SUBS_TP:"1",CTI_CID:"0",SO_ID:"",MST_SO_ID:""},Le=await Gj(ce);Le.success?(dt("success","  ","  ."),te({cnslLClCd:"",cnslMClCd:"",cnslSClCd:"",reqCntn:"",transYn:"N",transDeptCd:""}),setCnslMCodes([]),setCnslSCodes([]),De(),Ze()):dt("error","  ",Le.message||"  .")}catch(ce){console.error("Register consultation error:",ce),dt("error","","    .")}finally{Tt(!1)}},Ce=async()=>{var ce,Le,Xe,Pe;if(!n){dt("warning","","  .");return}if(K==="subscriber"&&!r){dt("warning",""," AS    .");return}if(!de.asClCd){dt("warning","","AS .");return}if(!de.asResnLCd){dt("warning","","AS() .");return}if(ye.length>0&&!de.asResnMCd){dt("warning","","AS() .");return}if(!de.asCntn.trim()){dt("warning","","AS  .");return}Tt(!0);try{const Ct=JSON.parse(localStorage.getItem("userInfo")||"{}"),Me=K==="subscriber",lt=Me?null:i.find($t=>$t.CTRT_STAT_CD==="82"||$t.CTRT_STAT_CD==="80")||i[0],ut=Me?i.find($t=>$t.CTRT_ID===(r==null?void 0:r.ctrtId)):lt,jt={CUST_ID:n.custId,CTRT_ID:Me&&(r==null?void 0:r.ctrtId)||"",POST_ID:Me?(r==null?void 0:r.postId)||"":(lt==null?void 0:lt.POST_ID)||"",INST_ADDR:Me&&(r==null?void 0:r.instAddr)||"",AS_CL_CD:de.asClCd,AS_RESN_L_CD:de.asResnLCd,AS_RESN_M_CD:de.asResnMCd,AS_CNTN:de.asCntn,SCHD_DT:de.schdDt.replace(/-/g,""),SCHD_TM:de.schdHour+de.schdMin,WRKR_ID:Ct.userId||"",PG_GUBUN:"1",SO_ID:Me?(r==null?void 0:r.soId)||"":(lt==null?void 0:lt.SO_ID)||((Le=(ce=Ct.authSoList)==null?void 0:ce[0])==null?void 0:Le.SO_ID)||((Pe=(Xe=Ct.authSoList)==null?void 0:Xe[0])==null?void 0:Pe.soId)||Ct.soId||Ct.SO_ID||"",MST_SO_ID:"",BLD_CL:(ut==null?void 0:ut.BLD_CL)||"",BLD_NM:(ut==null?void 0:ut.BLD_NM)||"",BLD_ID:(ut==null?void 0:ut.BLD_ID)||"",BUN_CL:(ut==null?void 0:ut.BUN_CL)||"",BUN_NO:(ut==null?void 0:ut.BUN_NO)||"",HO_NM:(ut==null?void 0:ut.HO_NM)||"",APT_DONG_NO:(ut==null?void 0:ut.APT_DONG_NO)||"",APT_HO_CNT:(ut==null?void 0:ut.APT_HO_CNT)||"",ADDR_DTL:(ut==null?void 0:ut.ADDR_DTL)||"",ADDR:(ut==null?void 0:ut.INST_ADDR)||(ut==null?void 0:ut.ADDR_FULL)||"",ADDR_ORD:"1"},Ve=await O9(jt);Ve.success?(dt("success","AS  ","AS  ."),Re({asClCd:"",asClDtlCd:"",asResnLCd:"",asResnMCd:"",asCntn:"",schdDt:new Date().toISOString().split("T")[0],schdHour:pe(),schdMin:"00"}),ne([]),De(),Ze()):dt("error","AS  ",Ve.message||"AS  .")}catch(Ct){console.error("Register AS error:",Ct),dt("error","","AS    .")}finally{Tt(!1)}};return n?s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-1 flex gap-1",children:[s.jsxs("button",{onClick:()=>u("consultation"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg transition-colors text-sm ${d==="consultation"?"bg-blue-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(mv,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:()=>u("as"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg transition-colors text-sm ${d==="as"?"bg-orange-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(pu,{className:"w-4 h-4"}),"AS"]})]}),d==="consultation"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[s.jsx(mv,{className:"w-5 h-5 text-blue-500"})," "]}),s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("span",{className:"font-medium",children:n.custNm}),s.jsxs("span",{className:"ml-1 text-blue-600 text-xs",children:["(ID: ",s_(n.custId),")"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"targetUnit",value:"customer",checked:P==="customer",onChange:()=>A("customer"),className:"w-3.5 h-3.5 text-blue-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"targetUnit",value:"contract",checked:P==="contract",onChange:()=>A("contract"),className:"w-3.5 h-3.5 text-blue-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]})]})]}),P==="contract"&&r&&s.jsxs("div",{className:"text-xs text-blue-700 pt-1 border-t border-blue-200 space-y-0.5",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{className:"font-medium",children:r.prodNm})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:"ID"}),s.jsx("span",{children:s_(r.ctrtId)})]}),r.instAddr&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.instAddr})]}),r.notrecev&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.notrecev})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:Y.cnslSClCd,onChange:ce=>fe(ce.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:""}),$.map(ce=>s.jsx("option",{value:ce.code,children:ce.name},ce.code))]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",readOnly:!0,value:((ge=ae.find(ce=>ce.code===Y.cnslLClCd))==null?void 0:ge.name)||"",placeholder:" ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-600"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",readOnly:!0,value:((Be=j.find(ce=>ce.code===Y.cnslMClCd))==null?void 0:Be.name)||"",placeholder:" ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-600"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" *"}),s.jsx("textarea",{value:Y.reqCntn,onChange:ce=>te(Le=>({...Le,reqCntn:ce.target.value})),placeholder:" .",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"transYn",checked:Y.transYn==="Y",onChange:ce=>te(Le=>({...Le,transYn:ce.target.checked?"Y":"N"})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"transYn",className:"text-sm text-gray-600",children:"  (/ )"})]}),s.jsx("button",{onClick:Ye,disabled:Dt,className:"w-full flex items-center justify-center gap-2 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 transition-colors",children:Dt?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(pb,{className:"w-5 h-5"})," "]})})]}),d==="as"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[s.jsx(pu,{className:"w-5 h-5 text-orange-500"}),"AS "]}),s.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"text-sm text-orange-800",children:[s.jsx("span",{className:"font-medium",children:n.custNm}),s.jsxs("span",{className:"ml-1 text-orange-600 text-xs",children:["(ID: ",s_(n.custId),")"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"asSubscriberType",value:"subscriber",checked:K==="subscriber",onChange:()=>B("subscriber"),className:"w-3.5 h-3.5 text-orange-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"asSubscriberType",value:"nonSubscriber",checked:K==="nonSubscriber",onChange:()=>B("nonSubscriber"),className:"w-3.5 h-3.5 text-orange-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]})]})]}),K==="subscriber"&&r&&s.jsxs("div",{className:"text-xs text-orange-700 pt-1 border-t border-orange-200 space-y-0.5",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{className:"font-medium",children:r.prodNm})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:"ID"}),s.jsx("span",{children:s_(r.ctrtId)})]}),r.instAddr&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.instAddr})]}),r.notrecev&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.notrecev})]})]}),K==="nonSubscriber"&&s.jsx("div",{className:"text-xs text-orange-600 pt-1 border-t border-orange-200",children:" AS -   ."})]}),K==="subscriber"&&!r?s.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Wr,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"AS    "}),s.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"      AS  ."}),s.jsx("button",{onClick:l,className:"mt-2 text-sm text-yellow-700 underline hover:text-yellow-800",children:"   "})]})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"AS *"}),s.jsxs("select",{value:de.asClCd,onChange:ce=>Re(Le=>({...Le,asClCd:ce.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[s.jsx("option",{value:"",children:""}),X.map(ce=>s.jsx("option",{value:ce.CODE,children:ce.CODE_NM},ce.CODE))]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"AS() *"}),s.jsxs("select",{value:de.asResnLCd,onChange:ce=>xe(ce.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[s.jsx("option",{value:"",children:""}),ue.map(ce=>s.jsx("option",{value:ce.CODE,children:ce.CODE_NM},ce.CODE))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["AS() ",ye.length>0?"*":""]}),s.jsxs("select",{value:de.asResnMCd,onChange:ce=>Re(Le=>({...Le,asResnMCd:ce.target.value})),disabled:!de.asResnLCd||ye.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 disabled:bg-gray-100",children:[s.jsx("option",{value:"",children:ye.length===0?"":""}),ye.map(ce=>s.jsx("option",{value:ce.CODE,children:ce.CODE_NM},ce.CODE))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"AS  *"}),s.jsx("textarea",{value:de.asCntn,onChange:ce=>Re(Le=>({...Le,asCntn:ce.target.value})),placeholder:"AS  .",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",value:de.schdDt,onChange:ce=>Re(Le=>({...Le,schdDt:ce.target.value})),min:new Date().toISOString().split("T")[0],className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),s.jsx("select",{value:de.schdHour,onChange:ce=>Re(Le=>({...Le,schdHour:ce.target.value})),className:"w-20 px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:et.map(ce=>s.jsx("option",{value:ce.value,children:ce.label},ce.value))}),s.jsx("select",{value:de.schdMin,onChange:ce=>Re(Le=>({...Le,schdMin:ce.target.value})),className:"w-20 px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:bt.map(ce=>s.jsx("option",{value:ce.value,children:ce.label},ce.value))})]})]}),s.jsx("button",{onClick:Ce,disabled:Dt,className:"w-full flex items-center justify-center gap-2 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:bg-gray-400 transition-colors",children:Dt?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(pu,{className:"w-5 h-5"}),"AS "]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between p-4",children:[s.jsxs("button",{onClick:()=>rt(!Ke),className:"flex items-center gap-2 flex-1 text-left",children:[s.jsx(xh,{className:"w-5 h-5 text-gray-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:d==="consultation"?" ":" "}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",d==="consultation"?ft.length:Ot.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1 mr-1",children:[s.jsx("button",{onClick:ce=>{ce.stopPropagation(),N("byDate"),C.length===0&&R.length===0&&Ze()},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${g==="byDate"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:ce=>{ce.stopPropagation(),N("byContract"),r!=null&&r.ctrtId&&De()},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${g==="byContract"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]}),s.jsx("button",{onClick:ce=>{ce.stopPropagation(),Ze()},className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(uc,{className:`w-4 h-4 ${it?"animate-spin":""}`})}),s.jsx("button",{onClick:()=>rt(!Ke),children:Ke?s.jsx(Mr,{className:"w-5 h-5 text-gray-400"}):s.jsx(sr,{className:"w-5 h-5 text-gray-400"})})]})]}),Ke&&s.jsx("div",{className:"px-4 pb-4",children:it?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(jn,{className:"w-6 h-6 animate-spin text-gray-400"})}):g==="byContract"&&!r?s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."}):d==="consultation"?ft.length>0?s.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:ft.map((ce,Le)=>{var Xe;return s.jsxs("div",{className:"bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"p-3 cursor-pointer flex items-center justify-between",onClick:()=>I(Le),children:[s.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs flex-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:ce.CTRT_ID||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.START_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:ce.CNSL_SLV_CL_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(Xe=ce.CNSL_RSLT)!=null&&Xe.includes("")?"text-green-600":"text-yellow-600"}`,children:ce.CNSL_RSLT||""})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.RCPT_NM||"-"})]})]}),J.has(Le)?s.jsx(Mr,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"})]}),J.has(Le)&&s.jsxs("div",{className:"px-3 pb-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ce.REQ_CTX||"-"})]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ce.PROC_CT||"-"})]})]})]},Le)})}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."}):Ot.length>0?s.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:Ot.map((ce,Le)=>{var Xe,Pe;return s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:ce.CTRT_ID||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.HOPE_DT||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.WRK_CD_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(Xe=ce.WRK_STAT_CD_NM)!=null&&Xe.includes("")?"text-green-600":(Pe=ce.WRK_STAT_CD_NM)!=null&&Pe.includes("")?"text-blue-600":"text-gray-800"}`,children:ce.WRK_STAT_CD_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-center",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:ce.PROD_NM||"-"})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.CMPL_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.WRK_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ce.WRK_CRR_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-start",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800",children:ce.CTRT_ADDR||"-"})]}),s.jsxs("div",{className:"mt-3 cursor-pointer",onClick:()=>ee(Le),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"text-xs text-gray-500",children:""}),V.has(Le)?s.jsx(Mr,{className:"w-3.5 h-3.5 text-gray-400"}):s.jsx(sr,{className:"w-3.5 h-3.5 text-gray-400"})]}),V.has(Le)&&s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ce.MEMO||"-"})]})]},Le)})}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."})})]})]}),St.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${St.type==="success"?"bg-green-100":St.type==="error"?"bg-red-100":"bg-yellow-100"}`,children:St.type==="success"?s.jsx(Vi,{className:"w-5 h-5 text-green-500"}):St.type==="error"?s.jsx(Lo,{className:"w-5 h-5 text-red-500"}):s.jsx(Wr,{className:"w-5 h-5 text-yellow-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:St.title})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-5",children:St.message}),s.jsx("button",{onClick:()=>ze(ce=>({...ce,show:!1})),className:`w-full px-4 py-2 text-sm text-white rounded-lg transition-colors ${St.type==="success"?"bg-green-500 hover:bg-green-600":St.type==="error"?"bg-red-500 hover:bg-red-600":"bg-yellow-500 hover:bg-yellow-600"}`,children:""})]})}),O&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx(xh,{className:"w-5 h-5 text-blue-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:"  "})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-5",children:["       .",s.jsx("br",{}),"    ?"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>S(!1),className:"flex-1 px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:""}),s.jsx("button",{onClick:()=>{S(!1),l()},className:"flex-1 px-4 py-2 text-sm text-white bg-blue-500 rounded-lg hover:bg-blue-600 transition-colors",children:" "})]})]})})]}):s.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"  "}),s.jsxs("p",{className:"text-gray-500 mb-4",children:["     ",s.jsx("br",{}),"/AS   ."]}),s.jsxs("button",{onClick:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[s.jsx(mb,{className:"w-4 h-4 inline mr-2"})," "]})]})})},n_=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},Mm=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===8?`${e.substring(0,4)}-${e.substring(4,6)}-${e.substring(6,8)}`:t},_K=({onBack:t,showToast:e,selectedCustomer:n,selectedContract:r,contracts:i,onNavigateToBasicInfo:l})=>{const c=i.filter(I=>{const ee=!["",""].some(j=>(I.CTRT_STAT_NM||"").includes(j)),ae=I.CLOSE_DANGER==="Y",T=(I.CTRT_STAT_NM||"").includes("");return ee&&ae&&T}),[d,u]=x.useState(new Set),[f,m]=x.useState({}),[_,y]=x.useState(new Set),[g,N]=x.useState([]),[C,v]=x.useState([]),[R,U]=x.useState([]),[L,w]=x.useState(!1),[P,G]=x.useState({promChgCd:"05",promChgrsnCd:"",promCnt:"",startDate:"",endDate:""}),[K,B]=x.useState(!1),[O,S]=x.useState(null),[A,Y]=x.useState({show:!1,success:!1,message:""}),te=x.useCallback(async()=>{if(!L)try{const[I,ee,ae]=await Promise.all([nB(),rB(),iB()]),T=(j,k)=>{if(j.success&&j.data){const Q=j.data.map(H=>({CODE:H.code||H.CODE||"",CODE_NM:H.name||H.CODE_NM||""})).filter(H=>H.CODE);return Q.length>0?Q:k}return k};N(T(I,[{CODE:"0",CODE_NM:""},{CODE:"12",CODE_NM:"12"},{CODE:"24",CODE_NM:"24"},{CODE:"36",CODE_NM:"36"},{CODE:"48",CODE_NM:"48"},{CODE:"60",CODE_NM:"60"}])),v(T(ee,[{CODE:"A",CODE_NM:""},{CODE:"B",CODE_NM:""},{CODE:"C",CODE_NM:""},{CODE:"D",CODE_NM:""}])),U(T(ae,[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""}])),w(!0)}catch(I){console.error("Code loading failed:",I),N([{CODE:"0",CODE_NM:""},{CODE:"12",CODE_NM:"12"},{CODE:"24",CODE_NM:"24"},{CODE:"36",CODE_NM:"36"},{CODE:"48",CODE_NM:"48"},{CODE:"60",CODE_NM:"60"}]),v([{CODE:"A",CODE_NM:""},{CODE:"B",CODE_NM:""},{CODE:"C",CODE_NM:""},{CODE:"D",CODE_NM:""}]),U([{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""}]),w(!0)}},[L]);x.useEffect(()=>{te()},[te]),x.useEffect(()=>{r&&c.some(ee=>ee.CTRT_ID===r.ctrtId)&&(u(new Set([r.ctrtId])),S(r.ctrtId),J(r.ctrtId))},[r==null?void 0:r.ctrtId]);const J=async I=>{if(!(f[I]!==void 0||_.has(I))){y(ee=>new Set(ee).add(I));try{const ee=await tB(I);ee.success&&ee.data&&ee.data.length>0?m(ae=>({...ae,[I]:ee.data[0]})):m(ae=>({...ae,[I]:null}))}catch{m(ae=>({...ae,[I]:null}))}finally{y(ee=>{const ae=new Set(ee);return ae.delete(I),ae})}}},q=()=>{d.size===c.length?u(new Set):u(new Set(c.map(I=>I.CTRT_ID)))},V=I=>{const ee=new Set(d);ee.has(I)?ee.delete(I):(ee.add(I),J(I)),u(ee)};x.useEffect(()=>{if(P.startDate&&P.promCnt&&P.promCnt!=="0"){const I=parseInt(P.promCnt,10);if(!isNaN(I)&&I>0){const ee=P.startDate.replace(/[^0-9]/g,"");if(ee.length===8){const ae=parseInt(ee.substring(0,4),10),T=parseInt(ee.substring(4,6),10)-1,j=parseInt(ee.substring(6,8),10),k=new Date(ae,T+I,j-1),Q=`${k.getFullYear()}${String(k.getMonth()+1).padStart(2,"0")}${String(k.getDate()).padStart(2,"0")}`;G(H=>({...H,endDate:Q}))}}}else P.promCnt==="0"&&G(I=>({...I,endDate:""}))},[P.startDate,P.promCnt]);const F=async()=>{if(!n)return;if(d.size===0){e==null||e("  .","warning");return}if(!P.promChgCd||!P.promCnt||!P.promChgrsnCd||!P.startDate){e==null||e("   .","warning");return}B(!0);let I=0,ee=0;const ae=[];for(const T of d)try{const j=f[T],k={CUST_ID:n.custId,CTRT_ID:T,RCPT_ID:(j==null?void 0:j.RCPT_ID)||"",WRK_ID:"",AGREE_YN:"Y",AGREE_GB:P.promChgrsnCd,AGREE_SIGN:"",WRK_CD:P.promChgCd},Q=await sB(k);Q.success?I++:(ee++,ae.push(`${n_(T)}: ${Q.message||""}`))}catch{ee++,ae.push(`${n_(T)}:  `)}B(!1),Y(ee===0?{show:!0,success:!0,message:`${I}  .`}:{show:!0,success:!1,message:` ${I},  ${ee}

${ae.join(`
`)}`}),u(new Set),G(T=>({...T,promChgrsnCd:"",promCnt:"",endDate:""})),m({})};return n?s.jsxs("div",{className:"h-full overflow-y-auto p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[s.jsx(uc,{className:"w-5 h-5 text-purple-500"})," "]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[" ",c.length,""]})]}),s.jsx("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:s.jsxs("div",{className:"text-sm text-purple-800",children:[s.jsx("span",{className:"font-medium",children:n.custNm}),s.jsxs("span",{className:"ml-1 text-purple-600 text-xs",children:["(ID: ",n_(n.custId),")"]})]})}),c.length===0?s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 text-center",children:[s.jsx(Wr,{className:"w-10 h-10 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"   ."}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"()     ."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer border border-purple-200",children:[s.jsx("input",{type:"checkbox",checked:d.size===c.length,onChange:q,className:"w-5 h-5 rounded border-gray-300 text-purple-600 focus:ring-purple-500",disabled:K}),s.jsxs("span",{className:"flex-1 font-medium text-purple-700",children:["  (",c.length,")"]}),s.jsxs("span",{className:"text-xs text-purple-500",children:[d.size," "]})]}),s.jsx("div",{className:"space-y-2",children:c.map(I=>{const ee=d.has(I.CTRT_ID),ae=O===I.CTRT_ID,T=f[I.CTRT_ID],j=_.has(I.CTRT_ID);return s.jsxs("div",{className:`rounded-lg border transition-all ${ee?"bg-purple-50 border-purple-300":"bg-white border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-3 p-3",children:[s.jsx("input",{type:"checkbox",checked:ee,onChange:()=>V(I.CTRT_ID),className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500",disabled:K}),s.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>{S(ae?null:I.CTRT_ID),ae||J(I.CTRT_ID)},children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:I.PROD_NM||" "}),s.jsx("span",{className:"text-xs text-orange-600 bg-orange-100 px-1.5 py-0.5 rounded-full flex-shrink-0 ml-1",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[n_(I.CTRT_ID),I.AGMT_END_DT&&` | : ${Mm(I.AGMT_END_DT)}`]})]}),s.jsx("button",{onClick:()=>{S(ae?null:I.CTRT_ID),ae||J(I.CTRT_ID)},className:"flex-shrink-0",children:ae?s.jsx(Mr,{className:"w-4 h-4 text-gray-400"}):s.jsx(sr,{className:"w-4 h-4 text-gray-400"})})]}),ae&&s.jsx("div",{className:"px-3 pb-3 pt-1 border-t border-gray-100",children:j?s.jsxs("div",{className:"flex items-center justify-center py-3",children:[s.jsx(jn,{className:"w-4 h-4 animate-spin text-purple-500"}),s.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"  ..."})]}):T?s.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{className:T.PROM_YN==="Y"?"text-green-600 font-medium":"text-gray-600",children:T.PROM_YN==="Y"?"":""})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{className:"font-medium",children:T.PROM_CNT_NM||T.PROM_CNT||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:Mm(T.CTRT_APLY_STRT_DT)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:Mm(T.CTRT_APLY_END_DT)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:T.PROM_CHG_CD_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:T.PROM_CHGRSN_CD_NM||"-"})]})]}):s.jsx("div",{className:"text-xs text-gray-400 text-center py-2",children:" "})})]},I.CTRT_ID)})}),d.size>0&&s.jsxs("div",{className:"bg-white rounded-lg border border-purple-300 p-4 space-y-3 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-purple-700",children:[s.jsx(xh,{className:"w-4 h-4"}),"  (",d.size,")"]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:P.promChgCd,onChange:I=>G(ee=>({...ee,promChgCd:I.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:""}),R.map(I=>s.jsx("option",{value:I.CODE,children:I.CODE_NM},I.CODE))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:P.promChgrsnCd,onChange:I=>G(ee=>({...ee,promChgrsnCd:I.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:""}),C.map(I=>s.jsx("option",{value:I.CODE,children:I.CODE_NM},I.CODE))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:P.promCnt,onChange:I=>G(ee=>({...ee,promCnt:I.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:""}),g.map(I=>s.jsx("option",{value:I.CODE,children:I.CODE_NM},I.CODE))]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsx("input",{type:"date",value:P.startDate?Mm(P.startDate):"",onChange:I=>{const ee=I.target.value.replace(/-/g,"");G(ae=>({...ae,startDate:ee}))},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:P.endDate?Mm(P.endDate):"-",readOnly:!0,className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg bg-gray-50 text-gray-600"})]})]}),s.jsx("button",{onClick:F,disabled:K||!P.promChgCd||!P.promCnt||!P.promChgrsnCd||!P.startDate,className:`w-full flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-bold transition-colors ${K||!P.promChgCd||!P.promCnt||!P.promChgrsnCd||!P.startDate?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:K?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-4 h-4 animate-spin"}),"  ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(pb,{className:"w-4 h-4"}),"   (",d.size,")"]})})]})]}),A.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-sm w-full p-6",children:s.jsxs("div",{className:"flex flex-col items-center text-center",children:[A.success?s.jsx(Vi,{className:"w-12 h-12 text-green-500 mb-3"}):s.jsx(Lo,{className:"w-12 h-12 text-red-500 mb-3"}),s.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:A.success?" ":" "}),s.jsx("p",{className:"text-sm text-gray-600 mb-4 whitespace-pre-line",children:A.message}),s.jsx("button",{onClick:()=>Y({show:!1,success:!1,message:""}),className:`w-full py-2.5 rounded-lg text-sm font-bold text-white ${A.success?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600"}`,children:""})]})})})]}):s.jsx("div",{className:"h-full overflow-y-auto p-4",children:s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Wr,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"  ."}),s.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"       ."}),s.jsx("button",{onClick:l,className:"mt-2 text-xs text-blue-600 hover:text-blue-800 underline",children:" "})]})]})})})},xK=({onBack:t,showToast:e})=>{const[n,r]=x.useState({custNm:"",juminNo1:"",juminNo2:"",custTpCd:"01",telNo:"",hpNo:"",addr:""}),[i,l]=x.useState([]),[c,d]=x.useState(!1),[u,f]=x.useState(!1),[m,_]=x.useState(!1),[y,g]=x.useState(!1),[N,C]=x.useState({});x.useEffect(()=>{v()},[]);const v=async()=>{d(!0);try{const G=await W9();G.success&&G.data&&l(G.data)}catch(G){console.error("Load customer type codes error:",G)}finally{d(!1)}},R=(G,K)=>{r(B=>({...B,[G]:K})),N[G]&&C(B=>({...B,[G]:""})),(G==="juminNo1"||G==="juminNo2")&&g(!1)},U=()=>{const G={};return n.custNm.trim()?n.custNm.length<2&&(G.custNm=" 2  ."):G.custNm=" .",n.custTpCd!=="04"&&((!n.juminNo1||n.juminNo1.length!==6)&&(G.juminNo1="  6 ."),(!n.juminNo2||n.juminNo2.length!==7)&&(G.juminNo2="  7 .")),n.hpNo&&n.hpNo.length<10&&(G.hpNo="   ."),C(G),Object.keys(G).length===0},L=async()=>{if(n.custTpCd==="04"){g(!0),e==null||e("    .","info");return}if(!n.custNm||!n.juminNo1||!n.juminNo2){e==null||e("  .","warning");return}_(!0);try{await new Promise(G=>setTimeout(G,1500)),g(!0),e==null||e(" .","success")}catch(G){console.error("Verify error:",G),e==null||e(" .","error"),g(!1)}finally{_(!1)}},w=async()=>{if(!U()){e==null||e("  .","warning");return}if(n.custTpCd!=="04"&&!y){e==null||e("  .","warning");return}f(!0);try{const G={CUST_NM:n.custNm,JUMIN_NO:n.juminNo1+n.juminNo2,CUST_TP_CD:n.custTpCd,TEL_NO:n.telNo||void 0,HP_NO:n.hpNo||void 0,ADDR:n.addr||void 0},K=await M9(G);K.success?(e==null||e(" .","success"),r({custNm:"",juminNo1:"",juminNo2:"",custTpCd:"01",telNo:"",hpNo:"",addr:""}),g(!1)):e==null||e(K.message||"  .","error")}catch(G){console.error("Create customer error:",G),e==null||e("    .","error")}finally{f(!1)}},P=()=>{r({custNm:"",juminNo1:"",juminNo2:"",custTpCd:"01",telNo:"",hpNo:"",addr:""}),C({}),g(!1)};return s.jsx("div",{className:"h-full overflow-y-auto bg-gray-50",children:s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(kw,{className:"w-6 h-6 text-teal-500"}),s.jsx("h2",{className:"text-lg font-medium text-gray-800",children:" "})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"  .     ."})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:(i.length>0?i:[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""}]).map(G=>s.jsx("button",{onClick:()=>{R("custTpCd",G.CODE),g(!1)},className:`py-2 px-3 text-sm rounded-lg border transition-colors ${n.custTpCd===G.CODE?"bg-teal-500 text-white border-teal-500":"bg-white text-gray-600 border-gray-300 hover:border-gray-400"}`,children:G.CODE_NM},G.CODE))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ih,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:n.custNm,onChange:G=>R("custNm",G.target.value),placeholder:" ",className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${N.custNm?"border-red-300":"border-gray-300"}`})]}),N.custNm&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:N.custNm})]}),n.custTpCd!=="04"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:n.juminNo1,onChange:G=>R("juminNo1",G.target.value.replace(/[^0-9]/g,"")),placeholder:" 6",maxLength:6,className:`flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${N.juminNo1?"border-red-300":"border-gray-300"}`}),s.jsx("span",{className:"text-gray-400",children:"-"}),s.jsx("input",{type:"password",value:n.juminNo2,onChange:G=>R("juminNo2",G.target.value.replace(/[^0-9]/g,"")),placeholder:" 7",maxLength:7,className:`flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${N.juminNo2?"border-red-300":"border-gray-300"}`}),s.jsx("button",{onClick:L,disabled:m||y,className:`px-4 py-2 rounded-lg transition-colors whitespace-nowrap ${y?"bg-green-100 text-green-700":"bg-teal-500 text-white hover:bg-teal-600 disabled:bg-gray-400"}`,children:m?s.jsx(jn,{className:"w-5 h-5 animate-spin"}):y?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(dc,{className:"w-4 h-4"}),""]}):""})]}),(N.juminNo1||N.juminNo2)&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:N.juminNo1||N.juminNo2})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(yy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"tel",value:n.hpNo,onChange:G=>R("hpNo",G.target.value.replace(/[^0-9]/g,"")),placeholder:"01012345678",maxLength:11,className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${N.hpNo?"border-red-300":"border-gray-300"}`})]}),N.hpNo&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:N.hpNo})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(yy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"tel",value:n.telNo,onChange:G=>R("telNo",G.target.value.replace(/[^0-9]/g,"")),placeholder:"0212345678",maxLength:11,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(rd,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),s.jsx("textarea",{value:n.addr,onChange:G=>R("addr",G.target.value),placeholder:" ",rows:2,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none"})]})]}),n.custTpCd!=="04"&&!y&&s.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Wr,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-700",children:["    .",s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:"   ."})]})]})}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsxs("button",{onClick:P,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(bi,{className:"w-5 h-5"}),""]}),s.jsx("button",{onClick:w,disabled:u||n.custTpCd!=="04"&&!y,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-teal-500 text-white rounded-lg hover:bg-teal-600 disabled:bg-gray-400 transition-colors",children:u?s.jsxs(s.Fragment,{children:[s.jsx(jn,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(_w,{className:"w-5 h-5"})," "]})})]})]})]})})},CK=({onNavigateToMenu:t,showToast:e})=>{const[n,r]=x.useState("basic-info"),[i,l]=x.useState(null),[c,d]=x.useState(null),[u,f]=x.useState("phone"),[m,_]=x.useState(""),[y,g]=x.useState(!1),[N,C]=x.useState(null),[v,R]=x.useState(""),[U,L]=x.useState(!1),[w,P]=x.useState([]),[G,K]=x.useState([]),[B,O]=x.useState([]),[S,A]=x.useState(""),[Y,te]=x.useState("consultation"),J=[{id:"basic-info",title:"",description:"    "},{id:"info-change",title:"",description:"/ "},{id:"consultation-as",title:"/AS",description:", AS"},{id:"re-contract",title:"",description:" /"}],q=Q=>{r(Q)},V=Q=>{P([]),K([]),O([]),A(""),l(null),setTimeout(()=>{l(Q),d(null)},0)},F=()=>{l(null),d(null),P([]),K([]),O([]),A("")},I=(Q,H,$,ie)=>{A(Q),P(H),K($),O(ie)},ee=Q=>{d(Q)},ae=async()=>{if(i)try{const Q=await Ex(i.CUST_ID);if(Q.success&&Q.data&&(P(Q.data),A(i.CUST_ID),c)){const H=Q.data.find($=>$.CTRT_ID===c.ctrtId);H&&d({ctrtId:H.CTRT_ID,prodNm:H.PROD_NM,instAddr:H.INST_ADDR,streetAddr:H.STREET_ADDR_FULL,instlLoc:H.INSTL_LOC,postId:H.POST_ID,notrecev:H.NOTRECEV,soId:H.SO_ID,prodGrp:H.PROD_GRP})}}catch(Q){console.error("Failed to refresh contracts after address change:",Q)}},T=Q=>{r(Q)},j=Q=>{f("payment"),_(Q),r("info-change")},k=()=>{switch(n){case"info-change":return s.jsx(fK,{onBack:t,showToast:e,selectedCustomer:i?{custId:i.CUST_ID,custNm:i.CUST_NM,telNo:i.TEL_NO||"",hpNo:i.HP_NO||"",phoneList:i.PHONE_LIST}:null,selectedContract:c,initialSection:u,initialPymAcntId:m,onPaymentChangeStart:()=>g(!0),onPaymentChangeEnd:()=>{g(!1),C(null),R(""),L(!1)},savedPaymentForm:N,savedPymAcntId:v,savedIsVerified:U,onPaymentFormChange:(Q,H,$)=>{C(Q),R(H),L($)},onAddressChanged:ae});case"consultation-as":return s.jsx(pK,{onBack:t,showToast:e,selectedCustomer:i?{custId:i.CUST_ID,custNm:i.CUST_NM,telNo:i.TEL_NO||i.HP_NO||""}:null,selectedContract:c,contracts:w,onNavigateToBasicInfo:()=>T("basic-info"),initialTab:Y});case"re-contract":return s.jsx(_K,{onBack:t,showToast:e,selectedCustomer:i?{custId:i.CUST_ID,custNm:i.CUST_NM,telNo:i.TEL_NO||i.HP_NO||""}:null,selectedContract:c,contracts:w,onNavigateToBasicInfo:()=>T("basic-info")});case"customer-create":return s.jsx(xK,{onBack:t,showToast:e});default:return null}};return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 z-40",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-1",children:s.jsx(CN,{tabs:J,activeTab:n,onTabChange:q})}),y&&n!=="info-change"&&s.jsx("button",{onClick:()=>{f("payment"),r("info-change")},className:"flex-shrink-0 mr-2 px-3 py-1.5 text-sm bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-1",children:""})]})}),s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 p-3",children:s.jsx(gK,{onCustomerSelect:V,onCustomerClear:F,showToast:e,selectedCustomer:i})}),s.jsxs("div",{className:"flex-1 overflow-hidden",children:[s.jsx("div",{className:`h-full ${n==="basic-info"?"":"hidden"}`,children:s.jsx(hK,{onBack:t,showToast:e,onContractSelect:ee,onNavigateToPaymentChange:j,onNavigateToConsultationAS:Q=>{te(Q),r("consultation-as")},onNavigateToAddressChange:()=>{f("address"),r("info-change")},onNavigateToReContract:()=>{r("re-contract")},selectedCustomer:i,savedContract:c,cachedContracts:w,cachedConsultationHistory:G,cachedWorkHistory:B,cachedDataCustId:S,onDataLoaded:I,paymentChangeInProgress:y,onCancelPaymentChange:()=>{g(!1),C(null),R(""),L(!1)},currentWorkingPymAcntId:v})}),n!=="basic-info"&&k()]})]})},yK=!0,Ox="[EQUIPMENT-MGT-DEBUG]",Mx=[],bK=()=>{const t=new Date;return t.toLocaleTimeString("ko-KR",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+String(t.getMilliseconds()).padStart(3,"0")},ry=(t,e,n)=>{var l;const r={timestamp:bK(),component:t,action:e,...n};Mx.push(r);const i=n!=null&&n.error?"color: #ff4444; font-weight: bold;":n!=null&&n.response?"color: #44aa44; font-weight: bold;":"color: #4488ff; font-weight: bold;";if(console.log(`%c${Ox} [${r.timestamp}] ${t} - ${e}`,i),n!=null&&n.api&&console.log(`  API: ${n.api}`),n!=null&&n.params&&console.log("  Params:",n.params),(n==null?void 0:n.response)!==void 0){const c=JSON.stringify(n.response);c.length>500?(console.log("  Response (preview):",c.slice(0,500)+"..."),console.log("  Response (full):",n.response)):console.log("  Response:",n.response),Array.isArray(n.response)&&n.response.length===0&&console.warn("  WARNING: Empty array returned!"),(l=n.response)!=null&&l.data&&Array.isArray(n.response.data)&&n.response.data.length===0&&console.warn("  WARNING: response.data is empty array!")}n!=null&&n.error&&console.error("  Error:",n.error),n!=null&&n.duration&&console.log(`  Duration: ${n.duration}ms`)},_i=async(t,e,n,r)=>{const i=Date.now();ry(t,`API_CALL_START: ${e}`,{api:e,params:r});try{const l=await n(),c=Date.now()-i;return ry(t,`API_CALL_SUCCESS: ${e}`,{api:e,response:l,duration:c}),l}catch(l){const c=Date.now()-i;throw ry(t,`API_CALL_FAILED: ${e}`,{api:e,error:l,duration:c}),l}},NK=()=>[...Mx],SK=()=>{Mx.length=0,console.log(`${Ox} Logs cleared`)},vK=()=>{console.log(`
`+"=".repeat(70)),console.log(`${Ox} API CALL SUMMARY`),console.log("=".repeat(70));const t=Mx.filter(i=>i.api),e=t.filter(i=>i.response&&!i.error),n=t.filter(i=>i.error),r=t.filter(i=>{var l;return!!(Array.isArray(i.response)&&i.response.length===0||(l=i.response)!=null&&l.data&&Array.isArray(i.response.data)&&i.response.data.length===0)});console.log(`Total API calls: ${t.length}`),console.log(`Success: ${e.length}`),console.log(`Failed: ${n.length}`),console.log(`Empty responses: ${r.length}`),r.length>0&&(console.log(`
APIs returning empty:`),r.forEach(i=>{console.log(`  - ${i.api} (${i.component})`)})),n.length>0&&(console.log(`
Failed APIs:`),n.forEach(i=>{var l;console.log(`  - ${i.api}: ${((l=i.error)==null?void 0:l.message)||i.error}`)})),console.log("=".repeat(70)+`
`)};typeof window<"u"&&(window.eqtDebug={getLogs:NK,clear:SK,summary:vK,enabled:yK},console.log(`${Ox} Debug utility loaded. Use window.eqtDebug.summary() to see summary.`));const yT=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}.${t.slice(4,6)}.${t.slice(6,8)}`:t.includes("-")?t.replace(/-/g,"."):t:"",DK=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",RK=typeof window<"u"&&window.location.hostname!=="localhost"?`${window.location.protocol}//${window.location.hostname}:8080/api`:"http://52.63.232.141:8080/api",TK=async()=>{try{const t=localStorage.getItem("branchList");if(t){const r=JSON.parse(t);if(Array.isArray(r)&&r.length>0)return console.log(" [] branchList   :",r.length,""),r}const e=localStorage.getItem("userInfo");if(e){const r=JSON.parse(e);if(r.authSoList&&Array.isArray(r.authSoList)&&r.authSoList.length>0)return console.log(" [] authSoList   :",r.authSoList.length,""),r.authSoList}console.log(" [] API    ...");const n=await fetch(`${RK}/statistics/equipment/getAuthSoList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({USR_ID:e?JSON.parse(e).userId:""})});if(n.ok){const r=await n.json();if(Array.isArray(r)&&r.length>0)return console.log(" [] API   :",r.length,""),localStorage.setItem("branchList",JSON.stringify(r)),r}return console.log(" []    -   "),[]}catch(t){return console.error(" []    :",t),[]}},EK=({onBack:t,showToast:e})=>{const r=(()=>{try{const de=localStorage.getItem("userInfo");return de?JSON.parse(de):null}catch{return null}})(),i=()=>{const de=new Date;return de.setDate(de.getDate()-7),de.toISOString().slice(0,10).replace(/-/g,"")},[l,c]=x.useState(i()),[d,u]=x.useState(new Date().toISOString().slice(0,10).replace(/-/g,"")),[f,m]=x.useState((r==null?void 0:r.soId)||""),[_,y]=x.useState([]),[g,N]=x.useState(null),[C,v]=x.useState([]),[R,U]=x.useState([]);x.useEffect(()=>{(async()=>{const Re=await TK();U(Re)})()},[]),x.useEffect(()=>{y([]),N(null),v([])},[f]);const[L,w]=x.useState(!1),[P,G]=x.useState(!1),[K,B]=x.useState(!1),[O,S]=x.useState(null),[A,Y]=x.useState("simple"),[te,J]=x.useState(new Set),q=x.useRef(null),V=de=>de.length===8?`${de.slice(0,4)}-${de.slice(4,6)}-${de.slice(6,8)}`:de,F=de=>de.replace(/-/g,""),I=async()=>{w(!0);try{let de=[];if(!f&&R.length>0){console.log("[]     - ",R.length," ");const Re=R.map(_e=>{const me={FROM_OUT_REQ_DT:l,TO_OUT_REQ_DT:d,SO_ID:_e.SO_ID,PROC_STAT:"%"};return Rv(me).catch(()=>[])});de=(await Promise.all(Re)).flat(),console.log("[]     - ",de.length,"")}else{const Re={FROM_OUT_REQ_DT:l,TO_OUT_REQ_DT:d,SO_ID:f||(r==null?void 0:r.soId)||"209",PROC_STAT:"%"};de=await _i("EquipmentAssignment","getEquipmentOutList",()=>Rv(Re),Re)||[]}if(de.sort((Re,X)=>(Re.SO_NM||"").localeCompare(X.SO_NM||"")),de.length===0)y([]),N(null),v([]),e==null||e("   .","info");else{const Re=await Promise.all(de.map(async X=>{try{const _e=await Iv({OUT_REQ_NO:X.OUT_REQ_NO}),me=Array.isArray(_e)?_e:_e.output1||[];if(me.length===0)return{...X,_receiveStatus:"none",_receivedCount:0,_totalCount:0};const Z=me.filter(Ee=>Ee.PROC_YN==="Y").length,le=me.length;let se="none";return Z===le?se="received":Z>0&&(se="partial"),{...X,_receiveStatus:se,_receivedCount:Z,_totalCount:le}}catch{return{...X,_receiveStatus:"none",_receivedCount:0,_totalCount:0}}}));y(Re),N(null),v([]),e==null||e(`${Re.length}   .`,"success")}}catch(de){console.error(" []  :",de),e==null||e(de.message||"  .","error")}finally{w(!1)}},ee=de=>{J(Re=>{const X=new Set(Array.from(Re));return X.has(de)?X.delete(de):X.add(de),X})},ae=C.reduce((de,Re,X)=>{const _e=Re.ITEM_MID_CD_NM||"";return de[_e]||(de[_e]=[]),de[_e].push({...Re,_idx:X}),de},{});Object.keys(ae).forEach(de=>{ae[de].sort((Re,X)=>{const _e=Re.EQT_CL_NM||"",me=X.EQT_CL_NM||"";return _e.localeCompare(me)})});const T=Object.keys(ae).sort(),j=async de=>{N(de),G(!0);try{const Re={OUT_REQ_NO:de.OUT_REQ_NO},X=await _i("EquipmentAssignment","getOutEquipmentTargetList",()=>Iv(Re),Re),_e=Array.isArray(X)?X:X.output1||[];v(_e.map(me=>({...me,CHK:!1}))),_e.length===0&&(e==null||e("   .","info")),setTimeout(()=>{var me;(me=q.current)==null||me.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(Re){console.error(" []    :",Re),e==null||e(Re.message||"   .","error"),v([])}finally{G(!1)}},k=async()=>{if(console.log("[]  "),console.log("[] selectedEqtOut:",g),!g){e==null||e("  .","warning");return}const de=C.filter(X=>X.CHK&&X.PROC_YN!=="Y");if(console.log("[]  :",de.length,""),console.log("[]   :",de),de.length===0){e==null||e("   .","warning");return}const Re=de;console.log("[]  :",Re.length,"");try{const X={OUT_REQ_NO:g.OUT_REQ_NO,SO_ID:g.SO_ID||(r==null?void 0:r.soId)||"",WRKR_ID:(r==null?void 0:r.userId)||"",CARRIER_ID:g.CRR_ID||(r==null?void 0:r.crrId)||"",CRR_ID:g.CRR_ID||(r==null?void 0:r.crrId)||"",equipmentList:Re.map(_e=>({EQT_NO:_e.EQT_NO||"",EQT_SERNO:_e.EQT_SERNO||"",OUT_REQ_NO:_e.OUT_REQ_NO||"",PROC_YN:"Y",CHG_UID:(r==null?void 0:r.userId)||""}))};console.log("[] API  :",X),await _i("EquipmentAssignment","addEquipmentQuota",()=>v4(X),X),e==null||e(`${Re.length}   .`,"success"),await I()}catch(X){console.error(" []  :",X),e==null||e(X.message||" .","error")}},Q=de=>{v(C.map(Re=>{const X=Re.PROC_YN==="Y",_e=Re.EQT_SERNO&&Re.EQT_SERNO.trim()!=="";return!X&&_e?{...Re,CHK:de}:Re}))},H=(de,Re)=>{const X=[...C];X[de].CHK=Re,v(X)},$=(de,Re)=>{v(C.map(X=>{if((X.ITEM_MID_CD_NM||"")!==de)return X;const me=X.PROC_YN==="Y",Z=X.EQT_SERNO&&X.EQT_SERNO.trim()!=="";return!me&&Z?{...X,CHK:Re}:X}))},ie=de=>de&&de.length>=8?`${de.slice(0,4)}-${de.slice(4,6)}-${de.slice(6,8)}`:de||"-",fe=de=>{if(!de._receiveStatus)return{label:"-",color:"bg-gray-400 text-white"};switch(de._receiveStatus){case"received":return{label:"",color:"bg-green-500 text-white"};case"partial":return{label:`(${de._receivedCount}/${de._totalCount})`,color:"bg-yellow-500 text-white"};case"none":return{label:"",color:"bg-red-500 text-white"};default:return{label:"-",color:"bg-gray-400 text-white"}}},pe=de=>{var Re;return de?de.includes(":")||de.includes("-")?de:((Re=de.match(/.{1,2}/g))==null?void 0:Re.join(":"))||de:"-"};return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex items-center gap-2 min-w-0",children:[s.jsxs("div",{className:"relative flex-1 min-w-0",children:[s.jsx("input",{type:"date",value:V(l),onChange:de=>c(F(de.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),s.jsxs("div",{className:"flex items-center px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white pointer-events-none",children:[s.jsx("span",{className:"flex-1",children:yT(l)}),s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]}),s.jsx("span",{className:"text-gray-400 flex-shrink-0",children:"~"}),s.jsxs("div",{className:"relative flex-1 min-w-0",children:[s.jsx("input",{type:"date",value:V(d),onChange:de=>u(F(de.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),s.jsxs("div",{className:"flex items-center px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white pointer-events-none",children:[s.jsx("span",{className:"flex-1",children:yT(d)}),s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("select",{value:f,onChange:de=>m(de.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[s.jsx("option",{value:"",children:""}),R.map(de=>s.jsx("option",{value:de.SO_ID,children:de.SO_NM},de.SO_ID))]})]}),s.jsx("button",{onClick:I,disabled:L,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2.5 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation flex items-center justify-center gap-2",style:{WebkitTapHighlightColor:"transparent"},children:L?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," ..."]}):""})]})}),_.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-2",children:s.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:" (  )"})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"bg-gray-50 px-3 py-2 border-b border-gray-200 flex items-center text-[11px] font-semibold text-gray-600",children:[s.jsx("span",{className:"w-16 text-center",children:""}),s.jsx("span",{className:"w-20 text-center",children:""}),s.jsx("span",{className:"flex-1 text-center",children:""}),s.jsx("span",{className:"w-20 text-center flex-shrink-0",children:""})]}),s.jsx("div",{children:(()=>{const de=_.reduce((X,_e)=>{const me=_e.SO_NM||"";return X[me]||(X[me]=[]),X[me].push(_e),X},{});return Object.keys(de).sort().map(X=>s.jsxs("div",{children:[s.jsxs("div",{className:"bg-gray-100 px-3 py-2 border-b border-gray-200 flex items-center justify-between cursor-pointer hover:bg-gray-200 transition-colors",onClick:()=>ee(X),children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:X}),s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",de[X].length,")"]})]}),te.has(X)?s.jsx(sr,{className:"w-4 h-4 text-gray-500"}):s.jsx(Mr,{className:"w-4 h-4 text-gray-500"})]}),!te.has(X)&&de[X].map((_e,me)=>s.jsx("div",{onClick:()=>j(_e),className:`px-3 py-2 border-b border-gray-50 cursor-pointer transition-colors ${(g==null?void 0:g.OUT_REQ_NO)===_e.OUT_REQ_NO?"bg-blue-50 border-l-4 border-l-blue-500":"hover:bg-blue-50/50"}`,children:s.jsxs("div",{className:"flex items-center text-[11px]",children:[s.jsx("span",{className:"w-16 text-center text-gray-900",children:ie(_e.OUT_DTTM||_e.OUT_REQ_DT)}),s.jsx("span",{className:"w-20 text-center text-gray-600 truncate",children:_e.CRR_NM||"-"}),s.jsx("span",{className:"flex-1 text-center text-gray-700 font-mono",children:_e.OUT_REQ_NO}),s.jsx("span",{className:`w-20 text-center px-1.5 py-0.5 rounded text-[10px] font-bold whitespace-nowrap flex-shrink-0 ${fe(_e).color}`,children:fe(_e).label})]})},me))]},X))})()})]})]}),g&&s.jsxs("div",{ref:q,children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"  "})}),P?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6 flex items-center justify-center",children:[s.jsxs("svg",{className:"animate-spin h-6 w-6 text-blue-500 mr-2",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-sm text-gray-600",children:"   ..."})]}):C.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:de=>Q(de.target.checked),checked:C.filter(de=>de.PROC_YN!=="Y").length>0&&C.filter(de=>de.PROC_YN!=="Y").every(de=>de.CHK),disabled:C.filter(de=>de.PROC_YN!=="Y").length===0,className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[C.length," (: ",C.filter(de=>de.CHK&&de.PROC_YN!=="Y").length,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>Y("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${A==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>Y("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${A==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:T.map(de=>{const Re=ae[de],X=te.has(de),_e=Re.length,me=Re.filter(se=>se.PROC_YN!=="Y"&&se.EQT_SERNO&&se.EQT_SERNO.trim()!==""),Z=me.filter(se=>se.CHK).length,le=me.length>0&&Z===me.length;return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>ee(de),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:le,onClick:se=>se.stopPropagation(),onChange:se=>$(de,se.target.checked),className:"rounded w-4 h-4",disabled:me.length===0}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:de}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[_e," ",Z>0&&`(${Z})`]})]}),X?s.jsx(sr,{className:"w-3 h-3 text-gray-500"}):s.jsx(Mr,{className:"w-3 h-3 text-gray-500"})]}),!X&&s.jsx("div",{className:"space-y-2",children:Re.map(se=>{const Ee=se._idx,Ne=se.PROC_YN==="Y",ye=se.EQT_SERNO&&se.EQT_SERNO.trim()!=="",ne=!Ne&&ye;return s.jsxs("div",{onClick:()=>ne&&H(Ee,!se.CHK),className:`p-3 rounded-lg border-2 transition-all ${ne?"cursor-pointer":"cursor-not-allowed opacity-70"} ${se.CHK?"bg-blue-50 border-blue-400":Ne?"bg-green-50/50 border-green-200":ye?"bg-gray-50 border-gray-200 hover:border-gray-300":"bg-gray-100/50 border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:Ne?!0:se.CHK||!1,onChange:ue=>{ue.stopPropagation(),ne&&H(Ee,ue.target.checked)},disabled:!ne,className:`w-5 h-5 rounded focus:ring-blue-500 mt-0.5 ${ne?"text-blue-500":"text-gray-300 cursor-not-allowed"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-base font-bold text-gray-900 truncate",children:se.EQT_CL_NM||se.ITEM_MID_CD_NM||"()"}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${Ne?"bg-green-100 text-green-700":ye?"bg-blue-100 text-blue-700":"bg-red-100 text-red-600"}`,children:Ne?"":ye?"":""})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:`text-sm ${ye?"text-gray-600":"text-gray-400 italic"}`,children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),se.EQT_SERNO||"( )"]}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${se.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":se.EQT_USE_ARR_YN==="A"?"bg-purple-100 text-purple-700":se.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:se.EQT_USE_ARR_YN==="Y"?"":se.EQT_USE_ARR_YN==="A"?"":se.EQT_USE_ARR_YN==="N"?"":"N/A"})]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),pe(se.MAC_ADDRESS||"")]}),s.jsx("span",{className:"text-sm text-gray-600",children:DK(se.EQT_USE_END_DT||"")})]})]})]}),A==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:se.ITEM_MODEL||se.MODEL_NM||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:(g==null?void 0:g.SO_NM)||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.EQT_STAT_CD_NM||(ye?"-":"")})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:se.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.EQT_LOC_NM||se.EQT_LOC_TP_NM||(ye?"-":"()")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.OLD_EQT_LOC_NM||"-"})]})]})]},Ee)})})]},de)})}),!1]}),s.jsx("div",{className:"h-20"}),s.jsx("div",{className:"fixed bottom-[56px] left-0 right-0 p-3 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsxs("button",{onClick:k,disabled:!C.some(de=>de.CHK&&de.PROC_YN!=="Y"),className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-3 px-6 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation disabled:cursor-not-allowed",style:{WebkitTapHighlightColor:"transparent"},children:["   (",C.filter(de=>de.CHK&&de.PROC_YN!=="Y").length,")"]})})]}):s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"  "})]})})]}),_.length===0&&!L&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     "})]})}),s.jsx(_a,{isOpen:K,onClose:()=>B(!1),title:"  ",size:"md",children:O&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:O.ITEM_MAX_CD_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:O.EQT_CL_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:O.ITEM_MID_CD||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:O.ITEM_MID_CD_NM||"-"})]})]})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-700 mb-2",children:"  "}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"font-mono font-medium",children:O.EQT_NO||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"font-mono font-medium",children:O.EQT_SERNO||"-"})]}),O.MAC_ADDRESS&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"MAC :"}),s.jsx("span",{className:"font-mono font-medium",children:O.MAC_ADDRESS})]})]})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:" "}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-500",children:""}),s.jsx("div",{className:"text-lg font-bold text-gray-800",children:O.OUT_REQ_QTY||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-500",children:""}),s.jsx("div",{className:"text-lg font-bold text-green-600",children:O.OUT_QTY||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-500",children:""}),s.jsx("div",{className:"text-lg font-bold text-blue-600",children:O.IBGO_QTY||0})]})]})]}),s.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-yellow-700 mb-2",children:" "}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:`px-2 py-1 rounded font-medium ${O.PROC_YN==="Y"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:O.PROC_YN==="Y"?"":""})]}),O.REMARK&&s.jsxs("div",{className:"mt-2",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("p",{className:"mt-1 text-gray-700 bg-white p-2 rounded",children:O.REMARK})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded font-medium text-sm transition-colors",children:""})})]})})]})},jK={10:"",11:"()",20:"",35:"",50:"",60:"",70:"",71:"",72:"",73:"AS",74:"",75:"",80:"",81:"",82:"",83:"",84:"",90:""},IK={1:"SO()",2:"",3:"",4:""},bT=t=>jK[t]||t,NT=t=>IK[t]||t,OK=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",MK=typeof window<"u"?(()=>{const t=window.location.hostname;return t==="localhost"||t==="127.0.0.1"?"http://52.63.232.141:8080/api":"/api"})():"/api",LK=async()=>{try{const t=localStorage.getItem("branchList");if(t){const r=JSON.parse(t);if(Array.isArray(r)&&r.length>0)return console.log(" [] branchList   :",r.length,""),r}const e=localStorage.getItem("userInfo");if(e){const r=JSON.parse(e);if(r.authSoList&&Array.isArray(r.authSoList)&&r.authSoList.length>0)return console.log(" [] authSoList   :",r.authSoList.length,""),r.authSoList}console.log(" [] API    ...");const n=await fetch(`${MK}/statistics/equipment/getAuthSoList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({USR_ID:e?JSON.parse(e).userId:""})});if(n.ok){const r=await n.json();if(Array.isArray(r)&&r.length>0)return console.log(" [] API   :",r.length,""),localStorage.setItem("branchList",JSON.stringify(r)),r}return console.log(" []    -   "),[]}catch(t){return console.error(" []    :",t),[]}},wK=[{COMMON_CD:"",COMMON_CD_NM:""},{COMMON_CD:"02",COMMON_CD_NM:""},{COMMON_CD:"03",COMMON_CD_NM:"CVT"},{COMMON_CD:"04",COMMON_CD_NM:"STB"},{COMMON_CD:"05",COMMON_CD_NM:"Smart card"},{COMMON_CD:"06",COMMON_CD_NM:""},{COMMON_CD:"07",COMMON_CD_NM:"Cable Card"},{COMMON_CD:"08",COMMON_CD_NM:"IP"},{COMMON_CD:"10",COMMON_CD_NM:"(AP)"},{COMMON_CD:"23",COMMON_CD_NM:"OTT_STB()"}],PK=({onBack:t,showToast:e})=>{var st,Kt,ht,qt,It;const r=(()=>{try{const he=localStorage.getItem("userInfo");return he?JSON.parse(he):null}catch{return null}})(),[i,l]=x.useState(""),[c,d]=x.useState(""),[u,f]=x.useState(""),[m,_]=x.useState([]),[y,g]=x.useState(!1),[N,C]=x.useState(""),[v,R]=x.useState(!1),[U,L]=x.useState("OWNED"),[w,P]=x.useState(!1),G=()=>{let he=0;return i&&he++,c&&he++,u&&he++,N&&he++,he},[K,B]=x.useState(!1),[O,S]=x.useState([]),[A,Y]=x.useState([]),[te,J]=x.useState([]),[q]=x.useState(wK);x.useEffect(()=>{(async()=>{let be=await LK();if(r!=null&&r.soId&&!be.find(Oe=>Oe.SO_ID===r.soId)){const Oe=r.soNm||(r.soId==="100"?"":`(${r.soId})`);be=[{SO_ID:r.soId,SO_NM:Oe},...be],console.log("[]  soId :",r.soId,Oe)}J(be)})()},[r==null?void 0:r.soId]),x.useEffect(()=>{if(!c){_([]),f("");return}(async()=>{g(!0);try{console.log("[]  API :",c);const be=await C5({ITEM_MID_CD:c});console.log("[]  API :",be);const Oe=Array.isArray(be)?be:(be==null?void 0:be.data)||[];if(Array.isArray(Oe)&&Oe.length>0){const je=Oe.map(tt=>({code:tt.COMMON_CD||tt.EQT_CL_CD||"",name:tt.COMMON_CD_NM||tt.EQT_CL_NM||""})).filter(tt=>tt.code&&tt.name).sort((tt,Te)=>tt.name.localeCompare(Te.name));console.log("[]  :",je.length,""),_(je)}else _([])}catch(be){console.error("[]   :",be),_([])}finally{g(!1)}})(),f("")},[c]);const[V,F]=x.useState(!1),[I,ee]=x.useState(!1),[ae,T]=x.useState(!1),[j,k]=x.useState({current:0,total:0,item:"",action:""}),[Q,H]=x.useState(!1),[$,ie]=x.useState(null),[fe,pe]=x.useState(""),[de,Re]=x.useState(""),[X,_e]=x.useState(""),[me,Z]=x.useState(!1);x.useEffect(()=>{Y([]),ie(null)},[U]);const[le,se]=x.useState("simple"),[Ee,Ne]=x.useState(new Set),[ye,ne]=x.useState(!0),[ue,xe]=x.useState(!0),[et,bt]=x.useState(!0),At=U!=="OWNED"?A:A.filter(he=>{const be=he._category==="RETURN_REQUESTED"||he._hasReturnRequest,Oe=he._category==="INSPECTION_WAITING"||he.EQT_USE_ARR_YN==="A",je=!be&&!Oe;return!(be&&!et||Oe&&!ue||je&&!ye)}),[at,We]=x.useState(null),[Dt,Tt]=x.useState(!1),[St,ze]=x.useState(!1),[dt,Ke]=x.useState([]),[rt,ft]=x.useState(!1),[Ot,mt]=x.useState([]);x.useEffect(()=>{Ze()},[]),x.useEffect(()=>{if(N==="705KVQS022868"&&(r!=null&&r.userId)){console.log(" [] S/N    ...");const he=setTimeout(()=>{De()},500);return()=>clearTimeout(he)}},[r==null?void 0:r.userId]);const Ze=async()=>{console.log(" []  ")},De=async()=>{if(console.log("=====   ====="),console.log("[DEBUG] userInfo:",r),console.log("[DEBUG] userInfo.soId:",r==null?void 0:r.soId),console.log("[DEBUG] selectedSoId (state):",i),console.log("[DEBUG] localStorage userInfo:",localStorage.getItem("userInfo")),!(r!=null&&r.userId)){e==null||e("  .  .","error");return}F(!0),Y([]);try{console.log(" [] :",{selectedCategory:U,SO_ID:i,userInfo_soId:r.soId,WRKR_ID:r.userId,CRR_ID:r.crrId,ITEM_MID_CD:c,EQT_SERNO:N});let he=[];{const je={WRKR_ID:r.userId,CRR_ID:r.crrId,SO_ID:i||r.soId||void 0,ITEM_MID_CD:c||void 0},tt=[];if(U==="OWNED")try{const Te={WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||""};console.log("[DEBUG]  API  :",Te);const _t=await _i("EquipmentInquiry","getWrkrHaveEqtListAll ()",()=>Km(Te),Te);console.log("[DEBUG]  API :",{isArray:Array.isArray(_t),length:Array.isArray(_t)?_t.length:"N/A",raw:_t});let Qe=new Set;try{const yt=await Ov({WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||r.soId||void 0});console.log("[]   :",yt),Array.isArray(yt)&&(yt.forEach(vt=>{vt.EQT_NO&&(Qe.add(vt.EQT_NO),console.log("[] EQT_NO :",vt.EQT_NO))}),console.log("[]    :",Qe.size,"/ EQT_NO Set:",Array.from(Qe)))}catch(yt){console.log("[]     ():",yt)}if(Array.isArray(_t)){let yt=_t;c&&(yt=yt.filter(ot=>ot.ITEM_MID_CD===c)),u&&(console.log("[1 ]  EQT_CL_CD  :",yt.length,""),console.log("[1 ] selectedEqtClCd:",u),console.log("[1 ]  EQT_CL_CD :",yt.map(ot=>({serno:ot.EQT_SERNO,eqtClCd:ot.EQT_CL_CD}))),yt=yt.filter(ot=>ot.EQT_CL_CD===u),console.log("[1 ]  EQT_CL_CD  :",yt.length,"")),console.log("[]  ( ):",yt.length,""),tt.push(...yt.map(ot=>{const wt=Qe.has(ot.EQT_NO);return wt&&console.log("[]   :",ot.EQT_NO,ot.EQT_SERNO),{...ot,_category:"OWNED",_hasReturnRequest:wt}}));const{merged:vt,transferredCount:$e}=H4(tt,r.userId);$e>0&&(console.log("[]   :",$e,""),tt.length=0,tt.push(...vt.map(ot=>({...ot,_category:ot._category||"OWNED",_hasReturnRequest:Qe.has(ot.EQT_NO)}))));try{const ot=await Mv({WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||""});if(Array.isArray(ot)){const wt=new Set(tt.map(Yt=>Yt.EQT_NO)),Bt=ot.filter(Yt=>Yt.EQT_NO&&!wt.has(Yt.EQT_NO));Bt.length>0?(console.log("[]  API   :",Bt.length,""),tt.push(...Bt.map(Yt=>({...Yt,_category:"OWNED",_hasReturnRequest:Qe.has(Yt.EQT_NO),EQT_USE_ARR_YN:Yt.EQT_USE_ARR_YN||"A"})))):console.log("[]  API -    (  )")}}catch(ot){console.log("[]  API   ():",ot)}}}catch(Te){console.log("   (getCustProdInfo):",Te)}if(U==="RETURN_REQUESTED"){const Te={WRKR_ID:r.userId,SO_ID:i||r.soId||void 0,CRR_ID:r.crrId};try{const _t=await _i("EquipmentInquiry","getEquipmentReturnRequestListAll ()",()=>Ov(Te),Te);if(Array.isArray(_t)){let Qe=_t;c&&(Qe=Qe.filter($e=>$e.ITEM_MID_CD===c)),u&&(Qe=Qe.filter($e=>$e.EQT_CL_CD===u));const yt=new Map;Qe.forEach($e=>{$e.EQT_NO&&(yt.has($e.EQT_NO)||yt.set($e.EQT_NO,[]),yt.get($e.EQT_NO).push($e))});const vt=[];yt.forEach(($e,ot)=>{const wt=$e[0],Bt=$e.map(Yt=>({REQ_DT:Yt.REQ_DT,RETURN_TP:Yt.RETURN_TP||"2",EQT_USE_ARR_YN:Yt.EQT_USE_ARR_YN||"Y"}));vt.push({...wt,_allReqDts:Bt})}),Qe.length!==vt.length&&console.log("[]  :",Qe.length,"->",vt.length,"(_allReqDts )"),tt.push(...vt.map($e=>({...$e,_category:"RETURN_REQUESTED"})))}}catch(_t){console.log("  :",_t)}}if(U==="INSPECTION_WAITING"){const Te={WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||""};try{const _t=await _i("EquipmentInquiry","getEquipmentChkStndByAAll ()",()=>Mv(Te),Te);if(Array.isArray(_t)){let Qe=_t.filter(yt=>yt.ITEM_MID_CD==="04");console.log("[] API :",_t.length,", STB:",Qe.length,""),tt.push(...Qe.map(yt=>({...yt,_category:"INSPECTION_WAITING"})))}}catch(_t){console.log("  :",_t)}}if(he=tt,N&&N.trim().length>0){const Te=N.trim().toUpperCase();he=he.filter(_t=>{const Qe=(_t.EQT_SERNO||"").toUpperCase(),yt=(_t.MAC_ADDRESS||"").toUpperCase();return Qe.includes(Te)||yt.includes(Te)}),console.log(" [] S/N  :",he.length," (:",Te,")")}}let Oe=(Array.isArray(he)?he:[]).map(je=>({CHK:!1,EQT_NO:je.EQT_NO||"",EQT_SERNO:je.EQT_SERNO||je.SERIAL_NO||"",MAC_ADDRESS:je.MAC_ADDRESS||je.MAC||je.TA_MAC_ADDRESS||"",EQT_CL_CD:je.EQT_CL_CD||"",EQT_CL_NM:je.EQT_CL_NM||je.EQT_TYPE||"",ITEM_MID_CD:je.ITEM_MID_CD||"",ITEM_MID_NM:je.ITEM_MID_NM||"",ITEM_NM:je.ITEM_NM||je.ITEM_MODEL||"",ITEM_MODEL:je.ITEM_MODEL||je.MODEL_NM||"",SO_ID:je.SO_ID||i,SO_NM:je.SO_NM||"",EQT_STAT_CD:je.EQT_STAT_CD||je.STATUS||"",EQT_STAT_NM:je.EQT_STAT_NM||je.EQT_STAT_CD_NM||bT(je.EQT_STAT_CD||je.STATUS||"")||"",EQT_LOC_TP_CD:je.EQT_LOC_TP_CD||"",EQT_LOC_TP_NM:je.EQT_LOC_TP_NM||je.EQT_LOC_TP_CD_NM||NT(je.EQT_LOC_TP_CD||""),EQT_LOC_NM:je.EQT_LOC_NM||"",OLD_EQT_LOC_NM:je.OLD_EQT_LOC_NM||je.BEF_EQT_LOC_NM||je.BEF_LOC_NM||"",CHG_KND_NM:je.CHG_KND_NM||je.CHG_TP_NM||je.EQT_CHG_TP_NM||"",PROC_STAT:je.PROC_STAT||"",PROC_STAT_NM:je.PROC_STAT_NM||"",WRKR_ID:je.WRKR_ID||r.userId,WRKR_NM:je.WRKR_NM||r.userName,CUST_ID:je.CUST_ID||"",CTRT_ID:je.CTRT_ID||"",CTRT_STAT:je.CTRT_STAT||"",WRK_ID:je.WRK_ID||"",EQT_USE_END_DT:je.EQT_USE_END_DT||je.USE_END_DT||je.EXPIRE_DT||"",RETN_RESN_CD:je.RETN_RESN_CD||"",RETN_RESN_NM:je.RETN_RESN_NM||je.RETN_RESN_CD_NM||"",REQ_DT:je.REQ_DT||"",RETURN_TP:je.RETURN_TP||"2",EQT_USE_ARR_YN:je.EQT_USE_ARR_YN||"",_category:je._category||void 0,_hasReturnRequest:je._hasReturnRequest||!1}));c&&(Oe=Oe.filter(je=>je.ITEM_MID_CD===c)),u&&(Oe=Oe.filter(je=>je.EQT_CL_CD===u)),Oe.sort((je,tt)=>{const Te=$e=>$e._category==="RETURN_REQUESTED"||$e._hasReturnRequest?3:$e._category==="INSPECTION_WAITING"||$e.EQT_USE_ARR_YN==="A"?2:1,_t=Te(je),Qe=Te(tt);if(_t!==Qe)return _t-Qe;const yt=je.ITEM_MID_CD||"",vt=tt.ITEM_MID_CD||"";return yt.localeCompare(vt)}),Y(Oe),Oe.length===0?e==null||e("  .","info"):e==null||e(`${Oe.length}  .`,"success")}catch(he){console.error(" [] :",he),e==null||e(he.message||"  .","error")}finally{F(!1)}},Ye=he=>{he.CHK=!0,Y([he]),B(!1),S([]),e==null||e(" .","success")},Ce=he=>{Y(A.map(be=>({...be,CHK:be._category==="OWNED"&&be._hasReturnRequest?!1:he})))},ge=(he,be)=>{Y(A.map(Oe=>Oe.EQT_NO===he?{...Oe,CHK:be}:Oe))},Be=he=>{var be;return he?he.includes(":")||he.includes("-")?he:((be=he.match(/.{1,2}/g))==null?void 0:be.join(":"))||he:"-"},ce=()=>{const he=A.filter(Oe=>Oe.CHK);if(he.length===0){e==null||e("  .","warning");return}const be=he.filter(Oe=>Oe._hasReturnRequest);if(be.length>0){mt(be),ft(!0);return}ee(!0)},Le=async he=>{var Oe,je;const be=A.filter(tt=>tt.CHK);if(be.length===0){e==null||e("  .","warning");return}if(he==="RETURN"){if(!fe){Z(!0);return}if(fe==="03"&&!de.trim()){Z(!0);return}}try{const tt=he==="RETURN"||be.length>=3;tt&&(k({current:0,total:be.length,item:"",action:he==="CANCEL"?"":""}),T(!0));const Te=(_t,Qe,yt)=>{tt&&k({current:_t,total:Qe,item:yt,action:he==="CANCEL"?"":""})};if(he==="CANCEL"){const _t=[];be.forEach(vt=>{vt._allReqDts&&Array.isArray(vt._allReqDts)&&vt._allReqDts.length>0?vt._allReqDts.forEach($e=>{_t.push({EQT_NO:vt.EQT_NO,EQT_SERNO:vt.EQT_SERNO,REQ_DT:$e.REQ_DT,RETURN_TP:$e.RETURN_TP||"2",EQT_USE_ARR_YN:$e.EQT_USE_ARR_YN||"Y"})}):_t.push({EQT_NO:vt.EQT_NO,EQT_SERNO:vt.EQT_SERNO,REQ_DT:vt.REQ_DT,RETURN_TP:vt.RETURN_TP||"2",EQT_USE_ARR_YN:vt.EQT_USE_ARR_YN||""})}),console.log("[]    :",_t.length,"(",be.length,")");const Qe={WRKR_ID:(r==null?void 0:r.userId)||"",CRR_ID:(r==null?void 0:r.crrId)||"",SO_ID:((Oe=be[0])==null?void 0:Oe.SO_ID)||i||(r==null?void 0:r.soId)||"",equipmentList:_t},yt=await _i("EquipmentInquiry","delEquipmentReturnRequest",()=>K4(Qe,Te),Qe)}else{if(!fe){e==null||e(" .","warning"),T(!1);return}if(fe==="03"&&!de.trim()){e==null||e("  .","warning"),T(!1);return}const _t={WRKR_ID:(r==null?void 0:r.userId)||"",CRR_ID:(r==null?void 0:r.crrId)||"",SO_ID:((je=be[0])==null?void 0:je.SO_ID)||i||(r==null?void 0:r.soId)||"",MST_SO_ID:(r==null?void 0:r.mstSoId)||(r==null?void 0:r.soId)||"",RETURN_TP:"2",RETN_RESN_TEXT:fe==="03"?de:void 0,equipmentList:be.map(yt=>({EQT_NO:yt.EQT_NO,EQT_SERNO:yt.EQT_SERNO,ACTION:he,RETN_RESN_CD:fe,EQT_USE_ARR_YN:yt.EQT_USE_ARR_YN}))},Qe=await _i("EquipmentInquiry","addEquipmentReturnRequest",()=>D4(_t,Te),_t)}T(!1),e==null||e(he==="RETURN"?`${be.length}    .`:`${be.length}   .`,"success"),ee(!1),pe(""),Re(""),await De()}catch(tt){console.error("   :",tt),e==null||e(tt.message||"  .","error"),T(!1)}},Xe=async()=>{if($)try{const he={EQT_NO:$.EQT_NO,EQT_SERNO:$.EQT_SERNO||"",WRKR_ID:(r==null?void 0:r.userId)||"",CRR_ID:(r==null?void 0:r.crrId)||"",SO_ID:$.SO_ID||i||(r==null?void 0:r.soId)||"",EQT_CL_CD:$.EQT_CL_CD||"",LOSS_REASON:X||void 0},be=await _i("EquipmentInquiry","processEquipmentLoss",()=>R4(he),he);e==null||e("   .","success"),H(!1),ie(null),_e(""),await De()}catch(he){console.error("   :",he),e==null||e(he.message||"  .","error")}},Pe=()=>{const he=A.filter(be=>be.CHK);if(he.length===0){e==null||e("   .","warning");return}Ke(he),ze(!0)},[Ct,Me]=x.useState(!1),lt=x.useRef(!1),ut=async()=>{var Te,_t;if(lt.current){console.log("[]   . (ref check)");return}if(lt.current=!0,Ct){console.log("[]   . (state check)"),lt.current=!1;return}ze(!1);const he=dt;if(he.length===0)return;const be=he.filter(Qe=>Qe.EQT_USE_ARR_YN!=="Y");if(be.length===0){e==null||e("    .","info"),Ke([]);return}Me(!0),k({current:0,total:be.length,item:"",action:""}),T(!0);const Oe={success:[],failed:[]},je=new Set;let tt=0;try{for(const Qe of be){if(je.has(Qe.EQT_NO)){console.log("[]   :",Qe.EQT_SERNO);continue}je.add(Qe.EQT_NO),tt++,k({current:tt,total:be.length,item:Qe.EQT_SERNO||"",action:""});const yt={EQT_NO:Qe.EQT_NO,SO_ID:Qe.SO_ID||(r==null?void 0:r.soId)||"",EQT_SERNO:Qe.EQT_SERNO||"",USER_ID:(r==null?void 0:r.userId)||"",CRR_ID:Qe.CRR_ID||(r==null?void 0:r.crrId)||"",WRKR_ID:(r==null?void 0:r.userId)||"",CUST_ID:Qe.CUST_ID||"",WRK_ID:Qe.WRK_ID||"",CTRT_ID:Qe.CTRT_ID||"",CTRT_STAT:Qe.CTRT_STAT||"",PROG_GB:"M"};let vt=0;const $e=0;let ot=null,wt=!1;for(;vt<=$e;)try{await _i("EquipmentInquiry","setEquipmentCheckStandby",()=>T4(yt),yt),Oe.success.push({EQT_SERNO:Qe.EQT_SERNO,EQT_NO:Qe.EQT_NO,ITEM_NM:Qe.ITEM_NM||Qe.ITEM_MID_NM||""}),wt=!0;break}catch(Bt){ot=Bt;const Yt=(Bt==null?void 0:Bt.message)||"";if(Yt.includes("ORA-00001")&&vt<$e){vt++,console.log(`[] ORA-00001 , ${vt}/${$e}  (1 ):`,Qe.EQT_SERNO),await new Promise(Xt=>setTimeout(Xt,1e3));continue}if(Yt.includes("ORA-00001")){console.log("[] ORA-00001 ,    :",Qe.EQT_SERNO);try{const Xt=await bf({EQT_SERNO:Qe.EQT_SERNO});console.log("[]   :",Xt);let ts;(Te=Xt==null?void 0:Xt.data)!=null&&Te[0]?ts=Xt.data[0]:(_t=Xt==null?void 0:Xt.resultList)!=null&&_t[0]?ts=Xt.resultList[0]:Array.isArray(Xt)&&Xt.length>0?ts=Xt[0]:ts=Xt,console.log("[]  :",ts);const Ut=ts==null?void 0:ts.EQT_USE_ARR_YN;if(console.log("[]   EQT_USE_ARR_YN:",Ut),Ut==="Y"||Ut&&Ut!=="A"){console.log(`[]     (${Ut}),  :`,Qe.EQT_SERNO),Oe.success.push({EQT_SERNO:Qe.EQT_SERNO,EQT_NO:Qe.EQT_NO,ITEM_NM:Qe.ITEM_NM||Qe.ITEM_MID_NM||"",note:Ut==="Y"?"  ":`: ${Ut}`}),wt=!0;break}else console.log("[]    A (),  ")}catch(Xt){console.error("[]    :",Xt)}}console.error("  :",Qe.EQT_SERNO,Bt),Oe.failed.push({EQT_SERNO:Qe.EQT_SERNO,EQT_NO:Qe.EQT_NO,ITEM_NM:Qe.ITEM_NM||Qe.ITEM_MID_NM||"",error:vt>0?`${Yt} (${vt}   )`:Yt||"    "});break}await new Promise(Bt=>setTimeout(Bt,200))}We(Oe),Tt(!0),Ke([]),Oe.success.length>0&&await De()}catch(Qe){console.error("  :",Qe),e==null||e(Qe.message||"  .","error")}finally{T(!1),Me(!1),lt.current=!1}},jt=he=>{console.log("Barcode scanned:",he),C(he.toUpperCase()),R(!1),e==null||e(`  : ${he}`,"success"),setTimeout(()=>{De()},300)};A.filter(he=>he.CHK).length;const Ve=A.filter(he=>he.CHK&&he._category==="OWNED").length,$t=A.filter(he=>he.CHK&&he._category==="RETURN_REQUESTED").length,Ue=A.filter(he=>he.CHK&&he._category==="INSPECTION_WAITING").length,ss=A.filter(he=>he._category==="OWNED").length,ls=A.filter(he=>he._category==="RETURN_REQUESTED").length,ds=A.filter(he=>he._category==="INSPECTION_WAITING").length,Ss=(he,be,Oe)=>{Y(A.map(je=>{const tt=je.SO_NM||je.SO_ID||"",Te=je.ITEM_MID_NM||"";return tt!==he||Te!==be||je._category==="OWNED"&&je._hasReturnRequest?je:{...je,CHK:Oe}}))},Ns=he=>{Ne(be=>{const Oe=new Set(Array.from(be));return Oe.has(he)?Oe.delete(he):Oe.add(he),Oe})},ke=At.reduce((he,be,Oe)=>{var vt,$e,ot,wt;let je="";const tt=(vt=be.SO_NM)==null?void 0:vt.trim(),Te=($e=be.MST_SO_NM)==null?void 0:$e.trim(),_t=(ot=be.SO_ID)==null?void 0:ot.trim(),Qe=(wt=be.MST_SO_ID)==null?void 0:wt.trim();tt&&tt!=="100"?je=tt:Te&&Te!=="100"?je=Te:_t==="100"||Qe==="100"||tt==="100"||Te==="100"?je="":_t&&(je=_t);const yt=be.ITEM_MID_NM||"";return he[je]||(he[je]={}),he[je][yt]||(he[je][yt]=[]),he[je][yt].push({...be,_globalIdx:Oe}),he},{});Object.keys(ke).forEach(he=>{Object.keys(ke[he]).forEach(be=>{ke[he][be].sort((Oe,je)=>{const tt=Oe.EQT_CL_NM||Oe.ITEM_NM||"",Te=je.EQT_CL_NM||je.ITEM_NM||"";return tt.localeCompare(Te)})})});const ct=Object.keys(ke).sort();return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-1",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx("button",{type:"button",onClick:()=>L("OWNED"),className:`p-2 rounded-lg border-2 transition-all text-center active:scale-[0.98] touch-manipulation ${U==="OWNED"?"bg-green-50 border-green-500 text-green-700 shadow-sm":"border-gray-200 hover:bg-gray-50 text-gray-400"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${U==="OWNED"?"bg-green-500 border-green-500":"border-gray-300"}`,children:U==="OWNED"&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-sm font-bold",children:""})]})}),s.jsx("button",{type:"button",onClick:()=>L("RETURN_REQUESTED"),className:`p-2 rounded-lg border-2 transition-all text-center active:scale-[0.98] touch-manipulation ${U==="RETURN_REQUESTED"?"bg-amber-50 border-amber-500 text-amber-700 shadow-sm":"border-gray-200 hover:bg-gray-50 text-gray-400"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${U==="RETURN_REQUESTED"?"bg-orange-500 border-amber-500":"border-gray-300"}`,children:U==="RETURN_REQUESTED"&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-sm font-bold",children:""})]})}),s.jsx("button",{type:"button",onClick:()=>L("INSPECTION_WAITING"),className:`p-2 rounded-lg border-2 transition-all text-center active:scale-[0.98] touch-manipulation ${U==="INSPECTION_WAITING"?"bg-purple-50 border-purple-500 text-purple-700 shadow-sm":"border-gray-200 hover:bg-gray-50 text-gray-400"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${U==="INSPECTION_WAITING"?"bg-purple-500 border-purple-500":"border-gray-300"}`,children:U==="INSPECTION_WAITING"&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-sm font-bold",children:""})]})})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("button",{onClick:()=>P(!w),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:" "}),(i||c||N)&&s.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500 text-white text-[10px] rounded-full font-medium",children:G()})]}),s.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${w?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w&&s.jsxs("div",{className:"p-4 border-t border-gray-100 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("select",{value:i,onChange:he=>l(he.target.value),className:"flex-1 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[s.jsx("option",{value:"",children:""}),te.map(he=>s.jsx("option",{value:he.SO_ID,children:he.SO_NM},he.SO_ID))]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsx("select",{value:c,onChange:he=>d(he.target.value),className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent truncate",children:q.map(he=>s.jsx("option",{value:he.COMMON_CD,children:he.COMMON_CD_NM},he.COMMON_CD))}),s.jsxs("select",{value:u,onChange:he=>f(he.target.value),disabled:!c||y||m.length===0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed truncate",children:[s.jsx("option",{value:"",children:c?y?"...":m.length===0?"-":"":"-"}),m.map(he=>s.jsx("option",{value:he.code,children:he.name},he.code))]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:N,onChange:he=>C(he.target.value.toUpperCase()),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg uppercase focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all font-mono",placeholder:"S/N  MAC  "}),s.jsxs("button",{onClick:()=>R(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]})]})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-1",children:s.jsx("button",{onClick:De,disabled:V,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2 rounded-xl font-bold text-base shadow-md transition-all flex items-center justify-center gap-2 active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:V?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),""]})})}),A.length>0&&s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:he=>Ce(he.target.checked),checked:At.length>0&&At.filter(he=>!(he._category==="OWNED"&&he._hasReturnRequest)).length>0&&At.filter(he=>!(he._category==="OWNED"&&he._hasReturnRequest)).every(he=>he.CHK),className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[At.length," (: ",At.filter(he=>he.CHK).length,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>se("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${le==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>se("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${le==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:ct.map(he=>{const be=ke[he],Oe=Object.keys(be).sort(),je=Oe.reduce((Te,_t)=>Te+be[_t].length,0),tt=Ee.has(`so_${he}`);return s.jsxs("div",{className:"border-b border-gray-100 last:border-0",children:[s.jsxs("div",{className:"px-4 py-2 bg-blue-50 flex items-center justify-between cursor-pointer hover:bg-blue-100",onClick:()=>Ns(`so_${he}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-bold text-blue-800",children:he}),s.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[je,""]})]}),tt?s.jsx(sr,{className:"w-4 h-4 text-blue-600"}):s.jsx(Mr,{className:"w-4 h-4 text-blue-600"})]}),!tt&&Oe.map(Te=>{const _t=be[Te],Qe=Ee.has(`so_${he}_mid_${Te}`),yt=_t.filter(ot=>!(ot._category==="OWNED"&&ot._hasReturnRequest)),vt=yt.filter(ot=>ot.CHK).length,$e=yt.length>0&&vt===yt.length;return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>Ns(`so_${he}_mid_${Te}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:$e,onClick:ot=>ot.stopPropagation(),onChange:ot=>Ss(he,Te,ot.target.checked),className:"rounded w-4 h-4",disabled:yt.length===0}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:Te}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[_t.length," ",vt>0&&`(${vt})`]})]}),Qe?s.jsx(sr,{className:"w-3 h-3 text-gray-500"}):s.jsx(Mr,{className:"w-3 h-3 text-gray-500"})]}),!Qe&&s.jsx("div",{className:"space-y-2",children:_t.map((ot,wt)=>s.jsxs("div",{onClick:()=>{ot._category==="OWNED"&&ot._hasReturnRequest||ge(ot.EQT_NO,!ot.CHK)},className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${ot.CHK?"bg-blue-50 border-blue-400":ot._category==="OWNED"?"bg-green-50/50 border-green-200 hover:border-green-300":ot._category==="RETURN_REQUESTED"?"bg-amber-50/50 border-amber-200 hover:border-amber-300":ot._category==="INSPECTION_WAITING"?"bg-purple-50/50 border-purple-200 hover:border-purple-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:ot.CHK||!1,disabled:ot._category==="OWNED"&&ot._hasReturnRequest,onChange:Bt=>{Bt.stopPropagation(),ge(ot.EQT_NO,Bt.target.checked)},className:`w-5 h-5 rounded focus:ring-blue-500 mt-0.5 ${ot._category==="OWNED"&&ot._hasReturnRequest?"text-gray-300 cursor-not-allowed":"text-blue-500"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-base font-bold text-gray-900 truncate",children:ot.EQT_CL_NM||ot.ITEM_NM||"-"}),s.jsx("div",{className:"flex-shrink-0 ml-2",children:ot._hasReturnRequest||ot._category==="RETURN_REQUESTED"?s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:""}):s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:""})})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),ot.EQT_SERNO||"-"]}),s.jsxs("div",{className:"flex-shrink-0 ml-2",children:[ot.EQT_USE_ARR_YN==="Y"&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:""}),ot.EQT_USE_ARR_YN==="A"&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""}),ot.EQT_USE_ARR_YN==="N"&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",children:""}),!ot.EQT_USE_ARR_YN&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:"N/A"})]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),Be(ot.MAC_ADDRESS)]}),s.jsx("span",{className:"text-sm text-gray-600",children:OK(ot.EQT_USE_END_DT||ot.USE_END_DT||"")})]})]})]}),le==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:ot.ITEM_MODEL||ot.MODEL_NM||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:ot.SO_NM||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ot.EQT_STAT_NM||ot.EQT_STAT_CD_NM||bT(ot.EQT_STAT_CD||"")||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:ot.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ot.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ot.EQT_LOC_NM||ot.EQT_LOC_TP_NM||NT(ot.EQT_LOC_TP_CD||"")||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ot.OLD_EQT_LOC_NM||"-"})]})]})]},ot.EQT_NO||wt))})]},Te)})]},he)})}),!1]}),A.length===0&&!V&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     "})]})}),s.jsx("div",{className:"h-20"}),s.jsx("div",{className:"fixed bottom-[56px] left-0 right-0 p-3 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsxs("div",{className:"flex gap-2",children:[ss>0&&s.jsxs("button",{onClick:ce,disabled:Ve===0,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation ${Ve>0?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:[" ",Ve>0&&`(${Ve})`]}),ls>0&&s.jsxs("button",{onClick:()=>Le("CANCEL"),disabled:$t===0,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation ${$t>0?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:[" ",$t>0&&`(${$t})`]}),ds>0&&s.jsx("button",{onClick:Pe,disabled:Ue===0||Ct,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation ${Ue>0&&!Ct?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:Ct?"...":` ${Ue>0?`(${Ue})`:""}`})]})}),s.jsx(_a,{isOpen:K,onClose:()=>{B(!1),S([])},title:" ",size:"md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[O.length,"  .   ."]}),s.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg divide-y divide-gray-100",children:O.map((he,be)=>s.jsx("button",{onClick:()=>Ye(he),className:"w-full p-3 text-left hover:bg-blue-50 transition-colors active:bg-blue-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-gray-900",children:he.EQT_CL_NM||he.ITEM_NM||""}),s.jsx("div",{className:"text-sm text-gray-600 font-mono",children:he.EQT_SERNO}),s.jsxs("div",{className:"text-xs text-gray-500",children:[he.SO_NM," | ",Be(he.MAC_ADDRESS)]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${he.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":he.EQT_USE_ARR_YN==="A"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:he.EQT_USE_ARR_YN==="Y"?"":he.EQT_USE_ARR_YN==="A"?"":"N/A"}),s.jsx("span",{className:"text-xs text-gray-400",children:he.ITEM_MID_NM})]})]})},be))}),s.jsx("button",{onClick:()=>{B(!1),S([])},className:"w-full py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold text-sm transition-all",children:""})]})}),s.jsx(_a,{isOpen:I,onClose:()=>ee(!1),title:"-",size:"md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:((st=A.filter(he=>he.CHK)[0])==null?void 0:st.SO_NM)||((Kt=te.find(he=>he.SO_ID===i))==null?void 0:Kt.SO_NM)||((ht=te.find(he=>he.SO_ID===(r==null?void 0:r.soId)))==null?void 0:ht.SO_NM)||(r==null?void 0:r.soId)||"-",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:fe,onChange:he=>{pe(he.target.value),he.target.value!=="03"&&Re("")},className:`w-full px-2 py-1.5 text-sm border rounded ${fe?"border-gray-300":"border-red-300"}`,children:[s.jsx("option",{value:"",children:""}),s.jsx("option",{value:"01",children:"  "}),s.jsx("option",{value:"02",children:"  (  )"}),s.jsx("option",{value:"03",children:""})]})]}),fe==="03"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"}),s.jsxs("span",{className:"text-gray-400 ml-1",children:["(",de.length,"/100 bytes)"]})]}),s.jsx("textarea",{value:de,onChange:he=>{const be=he.target.value;new Blob([be]).size<=100&&Re(be)},className:`w-full px-2 py-1.5 text-sm border rounded h-20 resize-none ${de.trim()?"border-gray-300":"border-red-300"}`,placeholder:"   ( 100)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-left",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:"S/N"}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:""})]})}),s.jsx("tbody",{children:A.filter(he=>he.CHK).map((he,be)=>s.jsxs("tr",{className:"border-t border-gray-100",children:[s.jsx("td",{className:"px-2 py-1.5",children:he.ITEM_NM||he.EQT_CL_NM}),s.jsx("td",{className:"px-2 py-1.5 font-mono text-[10px]",children:he.EQT_SERNO}),s.jsx("td",{className:"px-2 py-1.5",children:s.jsx("span",{className:`px-1 py-0.5 rounded text-[10px] ${he.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":he.EQT_USE_ARR_YN==="A"?"bg-amber-100 text-amber-700":he.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:he.EQT_STAT_NM||(he.EQT_USE_ARR_YN==="Y"?"":he.EQT_USE_ARR_YN==="A"?"":he.EQT_USE_ARR_YN==="N"?"":"N/A")})})]},be))})]})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{ee(!1),pe(""),Re("")},className:"flex-1 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""}),s.jsx("button",{onClick:()=>Le("RETURN"),className:"flex-1 py-2.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""})]})]})}),me&&s.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[250]",onClick:()=>Z(!1),children:s.jsxs("div",{className:"bg-white rounded-xl p-5 mx-4 shadow-2xl max-w-sm animate-pulse",onClick:he=>he.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:" "}),s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:fe==="03"?"  .":"   ."})]})]}),s.jsx("button",{onClick:()=>Z(!1),className:"w-full py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all",children:""})]})}),ae&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[200]",children:s.jsx("div",{className:"bg-white rounded-xl p-6 w-80 shadow-2xl",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-semibold text-gray-800 mb-4",children:[j.action,"  ..."]}),s.jsx("div",{className:"mb-3",children:s.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:j.total>0?`${j.current/j.total*100}%`:"0%"}})})}),s.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[j.current," / ",j.total]}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:j.item&&` : ${j.item}`})]})})}),s.jsx(_a,{isOpen:Q,onClose:()=>{H(!1),ie(null)},title:"-",size:"md",children:$&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:$.SO_NM||((qt=te.find(he=>he.SO_ID===$.SO_ID))==null?void 0:qt.SO_NM)||((It=te.find(he=>he.SO_ID===(r==null?void 0:r.soId)))==null?void 0:It.SO_NM)||"-",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("textarea",{value:X,onChange:he=>_e(he.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded h-20 resize-none",placeholder:"  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-left",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:"S/N"}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:""})]})}),s.jsx("tbody",{children:s.jsxs("tr",{className:"border-t border-gray-100",children:[s.jsx("td",{className:"px-2 py-1.5",children:$.ITEM_NM||$.EQT_CL_NM}),s.jsx("td",{className:"px-2 py-1.5 font-mono text-[10px]",children:$.EQT_SERNO}),s.jsx("td",{className:"px-2 py-1.5",children:s.jsx("span",{className:`px-1 py-0.5 rounded text-[10px] ${$.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":$.EQT_USE_ARR_YN==="A"?"bg-amber-100 text-amber-700":$.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:$.EQT_STAT_NM||($.EQT_USE_ARR_YN==="Y"?"":$.EQT_USE_ARR_YN==="A"?"":$.EQT_USE_ARR_YN==="N"?"":"N/A")})})]})})]})})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-red-600",children:"       ."})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{H(!1),ie(null)},className:"flex-1 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""}),s.jsx("button",{onClick:Xe,className:"flex-1 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""})]})]})}),St&&dt.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-blue-600",children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:" "}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[" : ",dt.length,""]})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm text-amber-800 font-medium mb-1",children:"  "}),s.jsx("p",{className:"text-xs text-amber-600",children:"         ."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"  "}),s.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:dt.map((he,be)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg text-xs",children:[s.jsx("span",{className:"font-mono text-gray-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-gray-600",children:he.ITEM_NM||he.ITEM_MID_NM})]},be))})]})]}),s.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex gap-2",children:[s.jsx("button",{onClick:()=>{ze(!1),Ke([])},className:"flex-1 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors",children:""}),s.jsx("button",{onClick:ut,disabled:Ct,className:`flex-1 py-2.5 rounded-lg font-medium transition-colors ${Ct?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:Ct?"...":""})]})]})}),Dt&&at&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:`p-4 ${at.failed.length===0?"bg-gradient-to-r from-green-500 to-green-600":at.success.length===0?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-amber-500 to-amber-600"}`,children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:at.failed.length===0?"  ":at.success.length===0?" ":"  ( )"}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[": ",at.success.length," / : ",at.failed.length,""]})]}),s.jsxs("div",{className:"p-4 max-h-96 overflow-y-auto space-y-4",children:[at.success.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:[" (",at.success.length,")"]}),s.jsx("div",{className:"space-y-1",children:at.success.map((he,be)=>s.jsxs("div",{className:"p-2 bg-green-50 rounded-lg text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-mono text-green-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-green-600",children:he.ITEM_NM})]}),he.note&&s.jsxs("div",{className:"text-amber-600 mt-1 text-[10px]",children:[" ",he.note]})]},be))})]}),at.failed.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-red-700 mb-2",children:[" (",at.failed.length,")"]}),s.jsx("div",{className:"space-y-1",children:at.failed.map((he,be)=>s.jsxs("div",{className:"p-2 bg-red-50 rounded-lg text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-mono text-red-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-red-600",children:he.ITEM_NM})]}),s.jsx("div",{className:"text-red-500 mt-1",children:he.error})]},be))})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{Tt(!1),We(null)},className:"w-full py-2.5 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-medium transition-colors",children:""})})]})}),rt&&Ot.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-r from-amber-500 to-amber-600",children:[s.jsxs("h3",{className:"font-semibold text-white text-lg flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"  "]}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[Ot.length,"     "]})]}),s.jsxs("div",{className:"p-4 max-h-60 overflow-y-auto",children:[s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"     .    ."}),s.jsx("div",{className:"space-y-2",children:Ot.map((he,be)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-amber-50 rounded-lg text-xs",children:[s.jsx("span",{className:"font-mono text-amber-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-amber-600",children:he.ITEM_NM||he.ITEM_MID_NM||""})]},be))})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{ft(!1),mt([])},className:"w-full py-2.5 bg-orange-500 hover:bg-amber-600 text-white rounded-lg font-medium transition-colors",children:""})})]})}),s.jsx(Uf,{isOpen:v,onClose:()=>R(!1),onScan:jt})]})},r_=[{code:"",name:""},{code:"02",name:""},{code:"03",name:"CVT"},{code:"04",name:"STB"},{code:"05",name:"Smart card"},{code:"06",name:""},{code:"07",name:"Cable Card"},{code:"08",name:"IP"},{code:"10",name:"(AP)"},{code:"23",name:"OTT_STB()"}],ST=t=>{var n;if(!t)return"-";const e=t.replace(/[^A-Fa-f0-9]/g,"");return e.length!==12?t:((n=e.match(/.{2}/g))==null?void 0:n.join(":"))||t},AK=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",kK=({onBack:t,showToast:e})=>{const[n,r]=x.useState({userId:"",userName:"",soId:"",crrId:""}),[i,l]=x.useState({WRKR_ID:"",WRKR_NM:"",SO_ID:"",CRR_ID:""}),[c,d]=x.useState([]),[u,f]=x.useState([]),[m,_]=x.useState([]),[y,g]=x.useState(!1),[N,C]=x.useState(!1),v=x.useRef(!1),R=x.useRef(0),[U,L]=x.useState(null),[w,P]=x.useState([]),[G,K]=x.useState(!1),[B,O]=x.useState(!1),[S,A]=x.useState(!1),[Y,te]=x.useState([]),[J,q]=x.useState(""),[V,F]=x.useState(null),[I,ee]=x.useState(!1),[ae,T]=x.useState(new Set),[j,k]=x.useState("simple"),[Q,H]=x.useState(!1),[$,ie]=x.useState(""),[fe,pe]=x.useState(!1),[de,Re]=x.useState(null),[X,_e]=x.useState([]),[me,Z]=x.useState(!1),[le,se]=x.useState(""),[Ee,Ne]=x.useState(""),[ye,ne]=x.useState([]),[ue,xe]=x.useState(""),[et,bt]=x.useState(!1),[it,At]=x.useState(""),[at,We]=x.useState(""),[Dt,Tt]=x.useState([]),[St,ze]=x.useState(!1),[dt,Ke]=x.useState(!1),[rt,ft]=x.useState(null),[Ot,mt]=x.useState("");x.useEffect(()=>{Ze()},[]),x.useEffect(()=>{if(!it){Tt([]),We("");return}(async()=>{try{console.log("[]  API :",it);const ct=await C5({ITEM_MID_CD:it});console.log("[]  API :",ct);const Kt=(Array.isArray(ct)?ct:(ct==null?void 0:ct.data)||[]).map(ht=>({code:ht.COMMON_CD||ht.EQT_CL_CD||"",name:ht.COMMON_CD_NM||ht.EQT_CL_NM||""})).filter(ht=>ht.code&&ht.name).sort((ht,qt)=>ht.name.localeCompare(qt.name));Tt(Kt),console.log("[]   :",Kt.length,"",Kt)}catch(ct){console.error("[]  API :",ct);const st=new Map;c.forEach(ht=>{ht.ITEM_MID_CD===it&&ht.EQT_CL_CD&&ht.EQT_CL_NM&&st.set(ht.EQT_CL_CD,ht.EQT_CL_NM)});const Kt=Array.from(st.entries()).map(([ht,qt])=>({code:ht,name:qt})).sort((ht,qt)=>ht.name.localeCompare(qt.name));Tt(Kt),console.log("[]  fallback:",Kt.length,"")}})(),We("")},[it]);const Ze=async()=>{try{const ke=localStorage.getItem("userInfo");if(ke){const ct=JSON.parse(ke),st=ct.authSoList&&Array.isArray(ct.authSoList)?ct.authSoList:[];ne(st);let Kt=ct.soId||"";!Kt&&st.length>0&&(Kt=st[0].SO_ID||""),r({userId:ct.userId||"",userName:ct.userName||"",soId:Kt,crrId:ct.crrId||""}),st.length>0&&xe(st[0].SO_ID||"")}}catch(ke){console.warn("   :",ke)}await De()},De=async()=>{const ke=localStorage.getItem("userInfo"),ct=localStorage.getItem("branchList");if(ke)try{const st=JSON.parse(ke);let Kt=[];if(st.authSoList&&Array.isArray(st.authSoList)&&st.authSoList.length>0)Kt=st.authSoList;else if(ct)try{const ht=JSON.parse(ct);Array.isArray(ht)&&ht.length>0&&(Kt=ht)}catch{}Kt.length===0&&st.soId&&(Kt=[{SO_ID:st.soId,SO_NM:st.soNm||`(${st.soId})`}]),Kt.length>0&&(f(Kt),l(ht=>({...ht,SO_ID:Kt[0].SO_ID}))),st.crrId&&(_([{CRR_ID:st.crrId,CORP_NM:st.crrNm||st.corpNm||`(${st.crrId})`}]),l(ht=>({...ht,CRR_ID:st.crrId})))}catch(st){console.warn("   :",st)}},Ye=async ke=>{const ct=ke.toUpperCase().replace(/[:-]/g,"");if(w.includes(ct)){e==null||e("  .","warning");return}P(st=>[...new Set([ct,...st])]),K(!0),A(!1)},Ce=async()=>{if(w.length===0){e==null||e("  .","warning");return}L(null),g(!0);try{const ke=w[0],ct=await _i("EquipmentMovement","getEquipmentHistoryInfo",()=>bf({EQT_SERNO:ke}),{EQT_SERNO:ke});if(ct&&ct.length>0){const st=ct[0];let Kt=st.WRKR_ID||st.OWNER_WRKR_ID;if(!Kt&&st.EQT_LOC_NM){const It=st.EQT_LOC_NM.match(/\(([A-Z]?\d+)\)$/);It&&(Kt=It[1])}const ht=st.WRKR_NM||st.OWNER_WRKR_NM||"",qt=st.CRR_ID||"";Kt?(l(It=>({...It,WRKR_ID:Kt,WRKR_NM:ht,CRR_ID:qt})),await Be(Kt,ht,qt,ke),H(!0)):L(`(${ke})   .`)}else L(`(${ke})   .`)}catch(ke){console.error("  :",ke),L("  .")}finally{g(!1)}},ge=async()=>{const ke=J.trim().toUpperCase().replace(/[:-]/g,"");if(!ke){e==null||e("(S/N) .","warning");return}L(null),g(!0),K(!1),console.log("========================================"),console.log("[ ] S/N  :",ke),console.log("[ ]  :",n.userId),console.log("[ ]   - 1:",it||"",", 2:",at||"");try{const ct=await _i("EquipmentMovement","getEquipmentHistoryInfo",()=>bf({EQT_SERNO:ke}),{EQT_SERNO:ke});console.log("[ ] getEquipmentHistoryInfo :",JSON.stringify(ct).substring(0,500));const st=Array.isArray(ct)?ct[0]:ct;if(console.log("[ ]   :",st?"OK":"NULL"),st&&st.EQT_SERNO){const Kt=st.EQT_LOC_TP_CD||"",ht=st.EQT_LOC_TP_CD_NM||st.EQT_LOC_TP_NM||"";if(console.log("[ ] EQT_LOC_TP_CD:",Kt||""),console.log("[ ] EQT_LOC_TP_CD_NM:",ht||""),console.log("[ ] EQT_LOC_NM:",st.EQT_LOC_NM||""),console.log("[ ] WRKR_ID  :",st.WRKR_ID||""),console.log("[ ] OWNER_WRKR_ID  :",st.OWNER_WRKR_ID||""),Kt==="4"){ft({EQT_SERNO:st.EQT_SERNO,EQT_NO:st.EQT_NO||"",ITEM_NM:st.ITEM_NM||st.EQT_CL_NM||"",ITEM_MID_NM:st.ITEM_MID_NM||"",SO_NM:st.SO_NM||"",EQT_LOC_NM:st.EQT_LOC_NM||"",EQT_LOC_TP_NM:"",MAC_ADDRESS:st.MAC_ADDRESS||"",WRKR_NM:st.WRKR_NM||st.OWNER_WRKR_NM||"-"}),Ke(!0),g(!1),q("");return}let qt=st.WRKR_ID||st.OWNER_WRKR_ID;if(!qt&&st.EQT_LOC_NM){const be=st.EQT_LOC_NM.match(/\(([A-Z]?\d+)\)$/);be&&(qt=be[1]),console.log("[ ]   :",be?be[1]:" ")}const It=st.WRKR_NM||st.OWNER_WRKR_NM||"",he=st.CRR_ID||"";if(console.log("[ ]  ownerWrkrId:",qt||""),console.log("[ ] ownerWrkrNm:",It),qt)console.log("[ ]  WRKR_ID    searchEquipmentByWorker "),P([ke]),K(!1),l(be=>({...be,WRKR_ID:qt,WRKR_NM:It,CRR_ID:he})),await Be(qt,It,he,ke),H(!0);else{console.log("[ ]  WRKR_ID     "),console.log("[]   :",ke,":",ht);try{const be=await F4({EQT_SERNO:ke}),Oe=Array.isArray(be)?be[0]:be,je=(Oe==null?void 0:Oe.EQT_LOC_TP_NM)||ht||"",tt=je===""?"":je;ft({EQT_SERNO:ke,EQT_NO:(Oe==null?void 0:Oe.EQT_NO)||st.EQT_NO||"",ITEM_NM:(Oe==null?void 0:Oe.ITEM_NM)||st.ITEM_NM||st.EQT_CL_NM||"",ITEM_MID_NM:(Oe==null?void 0:Oe.ITEM_MID_NM)||st.ITEM_MID_NM||"",SO_NM:(Oe==null?void 0:Oe.SO_NM)||st.SO_NM||"",EQT_LOC_NM:(Oe==null?void 0:Oe.EQT_LOC_NM)||st.EQT_LOC_NM||"",EQT_LOC_TP_NM:tt,MAC_ADDRESS:(Oe==null?void 0:Oe.MAC_ADDRESS)||st.MAC_ADDRESS||"",WRKR_NM:It}),Ke(!0)}catch{const Oe=ht===""?"":ht||" ";ft({EQT_SERNO:ke,EQT_NO:st.EQT_NO||"",ITEM_NM:st.ITEM_NM||st.EQT_CL_NM||"",ITEM_MID_NM:st.ITEM_MID_NM||"",SO_NM:st.SO_NM||"",EQT_LOC_NM:st.EQT_LOC_NM||"",EQT_LOC_TP_NM:Oe,MAC_ADDRESS:st.MAC_ADDRESS||"",WRKR_NM:It}),Ke(!0)}}}else mt(`S/N: ${ke}`),H(!0),L(`(${ke})   .`)}catch(ct){console.error("  :",ct),L("  .")}finally{g(!1),q("")}},Be=async(ke,ct,st,Kt)=>{var ht,qt,It,he;g(!0);try{const be={WRKR_ID:ke,CRR_ID:"",SO_ID:""};if(Kt){const je=w.length>0?[...new Set([Kt,...w])]:[Kt];be.EQT_SERNO=je.map(tt=>`'${tt}'`).join(",")}else w.length>0&&(be.EQT_SERNO=w.map(je=>`'${je}'`).join(","));Kt||(it&&(be.ITEM_MID_CD=it),at&&(be.EQT_CL_CD=at));const Oe=await _i("EquipmentMovement","getWrkrHaveEqtList",()=>Km(be),be);if(console.log("[ ] getWrkrHaveEqtList  :",Array.isArray(Oe)?Oe.length:"NOT_ARRAY"),Array.isArray(Oe)&&Oe.length>0){let je=Oe;Kt?console.log("[ ] S/N   -   "):(it&&(je=Oe.filter(Te=>Te.ITEM_MID_CD===it),console.log("[ ] 1   :",je.length," (:",it,")")),at&&(je=je.filter(Te=>Te.EQT_CL_CD===at),console.log("[ ] 2   :",je.length," (:",at,")")));let tt=je.map(Te=>({CHK:!1,EQT_NO:Te.EQT_NO||"",ITEM_MAX_NM:Te.ITEM_MAX_NM||"",ITEM_MID_CD:Te.ITEM_MID_CD||"",ITEM_MID_NM:Te.ITEM_MID_NM||"",EQT_CL_CD:Te.EQT_CL_CD||"",EQT_CL_NM:Te.EQT_CL_NM||"",ITEM_NM:Te.ITEM_NM||"",ITEM_SPEC:Te.ITEM_SPEC||"",MST_SO_ID:Te.MST_SO_ID||"",MST_SO_NM:Te.MST_SO_NM||"",SO_ID:Te.SO_ID||"",SO_NM:Te.SO_NM||"",EQT_SERNO:Te.EQT_SERNO||"",MAC_ADDRESS:Te.MAC_ADDRESS||"",TA_MAC_ADDRESS:Te.TA_MAC_ADDRESS||"",WRKR_NM:Te.WRKR_NM||ct,CRR_NM:Te.CRR_NM||"",EQT_STAT_CD_NM:Te.EQT_STAT_CD_NM||"",CHG_KND_NM:Te.CHG_KND_NM||"",EQT_LOC_NM:Te.EQT_LOC_NM||"",EQT_LOC_TP_NM:Te.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:Te.OLD_EQT_LOC_NM||"",OLD_EQT_LOC_TP_NM:Te.OLD_EQT_LOC_TP_NM||"",ITEM_MODEL:Te.ITEM_MODEL||"",MODEL_NM:Te.MODEL_NM||"",EQT_USE_ARR_YN:Te.EQT_USE_ARR_YN||"",EQT_USE_END_DT:Te.EQT_USE_END_DT||"",isScanned:Kt&&Te.EQT_SERNO===Kt||w.includes(Te.EQT_SERNO),isTransferable:!0}));if(tt.sort((Te,_t)=>Te.isScanned&&!_t.isScanned?-1:!Te.isScanned&&_t.isScanned?1:0),tt=tt.map(Te=>({...Te,CHK:Te.isScanned||!1})),tt.length>0)console.log("[ ]   :",tt.length," "),d(tt);else{console.log("[ ]     0 -    "),d([]);const Te=it?(ht=r_.find(yt=>yt.code===it))==null?void 0:ht.name:"",_t=at?(qt=Dt.find(yt=>yt.code===at))==null?void 0:qt.name:"";let Qe="";Te&&(Qe+=`, 1: ${Te}`),_t&&(Qe+=`, 2: ${_t}`),mt(`: ${ct}${Qe}`)}}else{console.log("[ ]  API      "),d([]);const je=it?(It=r_.find(_t=>_t.code===it))==null?void 0:It.name:"",tt=at?(he=Dt.find(_t=>_t.code===at))==null?void 0:he.name:"";let Te="";je&&(Te+=`, 1: ${je}`),tt&&(Te+=`, 2: ${tt}`),mt(`: ${ct}${Te}`)}}catch(be){console.error("  :",be),L("  ."),d([])}finally{g(!1)}},ce=async()=>{if(L(null),!i.WRKR_ID){e==null||e(" .","warning");return}await Be(i.WRKR_ID,i.WRKR_NM,i.CRR_ID),H(!0)},Le=()=>{ie(""),te([]),O(!0)},Xe=async()=>{const ke=$.trim();if(!ke){e==null||e("  ID .","warning");return}const st=/[-]/.test(ke);if(st&&ke.length<2){e==null||e(" 2  .","warning");return}pe(!0);try{if(st){console.log("[]  :",ke);let Kt=await l_({USR_NM:ke});if(console.log("[]   :",Kt.length,""),Kt.length===0){const ht=localStorage.getItem("user")||localStorage.getItem("userInfo");if(ht)try{const qt=JSON.parse(ht),It=qt.AUTH_SO_List||qt.authSoList||[];if(It.length>0){console.log("[]     -  SO_ID  :",It.map(Te=>Te.SO_ID).join(", "));const he=It.map(Te=>l_({SO_ID:Te.SO_ID}).catch(()=>[])),be=await Promise.all(he),Oe=new Map;be.forEach(Te=>{Te.forEach(_t=>{_t.USR_ID&&!Oe.has(_t.USR_ID)&&Oe.set(_t.USR_ID,_t)})});const je=Array.from(Oe.values());console.log("[]  :",je.length," ()");const tt=ke.toLowerCase();Kt=je.filter(Te=>(Te.USR_NM||Te.USR_NAME_EN||"").toLowerCase().includes(tt)),console.log("[]   :",Kt.length,"")}}catch(qt){console.error("[] user  :",qt)}}if(Kt.length>0){const ht=Kt.slice(0,30).map(qt=>({USR_ID:qt.USR_ID||qt.WRKR_ID||"",USR_NM:qt.USR_NM||qt.USR_NAME_EN||qt.WRKR_NM||"-",CRR_ID:qt.CRR_ID||"",SO_ID:qt.SO_ID||"",SO_NM:qt.SO_NM||"",CORP_NM:qt.CORP_NM||""}));te(ht)}else te([])}else{console.log("[] ID :",ke.toUpperCase());const Kt=await l_({USR_ID:ke.toUpperCase()});if(Kt&&Kt.length>0){const ht=Kt[0];te([{USR_ID:ht.USR_ID||ke.toUpperCase(),USR_NM:ht.USR_NM||ht.WRKR_NM||ke.toUpperCase(),CRR_ID:ht.CRR_ID||"",SO_ID:ht.SO_ID||"",SO_NM:ht.SO_NM||"",CORP_NM:ht.CORP_NM||""}])}else te([])}}catch(Kt){console.error("  :",Kt),e==null||e("  .","error"),te([])}finally{pe(!1)}},Pe=(ke,ct)=>{const st=[...X];st[ke].CHK=ct,_e(st)},Ct=ke=>{_e(X.map(ct=>!le||(ct.ITEM_MID_NM||ct.EQT_CL_NM||"")===le?{...ct,CHK:ke}:ct))},Me=()=>{const ke=X.filter(ct=>ct.CHK);if(ke.length===0){e==null||e("  .","warning");return}de&&l(ct=>({...ct,WRKR_ID:de.USR_ID,WRKR_NM:de.USR_NM,CRR_ID:de.CRR_ID||""})),d(ke),H(!0),Re(null),_e([]),te([]),ie(""),O(!1)},lt=()=>{Re(null),_e([])},ut=ke=>{l(ct=>({...ct,WRKR_ID:ke.USR_ID,WRKR_NM:ke.USR_NM,CRR_ID:ke.CRR_ID||""})),O(!1),d([]),P([]),H(!1)},jt=()=>{H(!1),d([]),P([]),l(ke=>({...ke,WRKR_ID:"",WRKR_NM:""})),q(""),setSelectionMode("none")},Ve=async()=>{if(v.current){console.log("[] transferLockRef  -   ");return}const ke=Date.now();if(ke-R.current<3e3){console.log("[]   - 3   ");return}if(y||N){console.log("[] isLoading/isTransferring  -   ");return}v.current=!0,R.current=ke;const ct=c.filter(qt=>qt.CHK);if(ct.length===0){v.current=!1,e==null||e("  .","warning");return}if(!n.userId){v.current=!1,e==null||e("  .","error");return}if(i.WRKR_ID===n.userId){v.current=!1,e==null||e("    .","warning");return}g(!0),C(!0);const st={success:[],failed:[]},ht=`TRANSFER_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log(""),console.log(""),console.log("                                                "),console.log(""),console.log(` DEBUG_ID: ${ht}`),console.log(` : ${new Date().toISOString()}`),console.log(` : ${ct.length}`),console.log(` : ${i.WRKR_ID} (${i.WRKR_NM})`),console.log(` : ${n.userId} (${n.userName})`),console.log(`  CRR_ID: ${n.crrId}`),console.log(` SO_ID: ${ue||"( SO_ID )"}`),console.log(` AUTH_SO_LIST: [${ye.map(qt=>qt.SO_ID).join(", ")}]`),console.log(""),console.log(""),console.log("[DEBUG]   :"),ct.forEach((qt,It)=>{console.log(`  [${It+1}] EQT_NO=${qt.EQT_NO}, EQT_SERNO=${qt.EQT_SERNO}, SO_ID=${qt.SO_ID}, SO_NM=${qt.SO_NM||"-"}`)}),console.log("");try{for(let qt=0;qt<ct.length;qt++){const It=ct[qt],he=Date.now();console.log(""),console.log(""),console.log(`  [${qt+1}/${ct.length}]    `),console.log(` EQT_SERNO: ${It.EQT_SERNO}`),console.log(` EQT_NO: ${It.EQT_NO}`),console.log(`  SO_ID: ${It.SO_ID}`),console.log("");try{const be={SO_ID:It.SO_ID,EQT_NO:It.EQT_NO,EQT_SERNO:It.EQT_SERNO,CHG_UID:n.userId,MV_SO_ID:ue||It.SO_ID,MV_CRR_ID:n.crrId,MV_WRKR_ID:n.userId};console.log("[DEBUG] API  :",JSON.stringify(be,null,2)),console.log(`[DEBUG] API  : ${new Date().toISOString()}`);const Oe=await E4(be),je=Date.now()-he;console.log(`[DEBUG] API  : ${new Date().toISOString()} (: ${je}ms)`),console.log("[DEBUG] API :",JSON.stringify(Oe,null,2)),st.success.push({EQT_SERNO:It.EQT_SERNO,EQT_NO:It.EQT_NO,ITEM_NM:It.ITEM_NM||It.EQT_CL_NM}),G4({EQT_NO:It.EQT_NO,EQT_SERNO:It.EQT_SERNO,ITEM_NM:It.ITEM_NM||It.EQT_CL_NM,ITEM_MID_NM:It.ITEM_MID_NM,ITEM_MAX_NM:It.ITEM_MAX_NM,EQT_CL_NM:It.EQT_CL_NM,SO_ID:It.SO_ID||"",SO_NM:It.SO_NM||It.MST_SO_NM||"",FROM_WRKR_ID:i.WRKR_ID,FROM_WRKR_NM:i.WRKR_NM,TO_WRKR_ID:n.userId})}catch(be){console.error("  :",It.EQT_SERNO,be),st.failed.push({EQT_SERNO:It.EQT_SERNO,EQT_NO:It.EQT_NO,ITEM_NM:It.ITEM_NM||It.EQT_CL_NM,error:(be==null?void 0:be.message)||"   "})}}if(F(st),ee(!0),st.success.length>0){const qt=new Set(st.success.map(It=>It.EQT_NO));d(It=>It.filter(he=>!qt.has(he.EQT_NO))),P(It=>It.filter(he=>!st.success.some(be=>be.EQT_SERNO===he)))}}catch(qt){console.error("  :",qt),e==null||e("  .","error")}finally{g(!1),C(!1),setTimeout(()=>{v.current=!1},1e3)}},$t=ke=>{d(c.map(ct=>({...ct,CHK:ke})))},Ue=(ke,ct)=>{const st=[...c];st[ke].CHK=ct,d(st)},ss=(ke,ct)=>{d(c.map(st=>(st.SO_NM||st.SO_ID||"")===ke?{...st,CHK:ct}:st))},ls=(ke,ct,st)=>{d(c.map(Kt=>{const ht=Kt.SO_NM||Kt.SO_ID||"",qt=Kt.ITEM_MID_NM||"";return ht===ke&&qt===ct?{...Kt,CHK:st}:Kt}))},ds=ke=>{T(ct=>{const st=new Set(Array.from(ct));return st.has(ke)?st.delete(ke):st.add(ke),st})},Ss=c.reduce((ke,ct,st)=>{var Oe,je,tt,Te;let Kt="";const ht=(Oe=ct.SO_NM)==null?void 0:Oe.trim(),qt=(je=ct.MST_SO_NM)==null?void 0:je.trim(),It=(tt=ct.SO_ID)==null?void 0:tt.trim(),he=(Te=ct.MST_SO_ID)==null?void 0:Te.trim();ht&&ht!=="100"?Kt=ht:qt&&qt!=="100"?Kt=qt:It==="100"||he==="100"||ht==="100"||qt==="100"?Kt="":It&&(Kt=It);const be=ct.ITEM_MID_NM||"";return ke[Kt]||(ke[Kt]={}),ke[Kt][be]||(ke[Kt][be]=[]),ke[Kt][be].push({...ct,_globalIdx:st}),ke},{});Object.keys(Ss).forEach(ke=>{Object.keys(Ss[ke]).forEach(ct=>{Ss[ke][ct].sort((st,Kt)=>{const ht=st.EQT_CL_NM||st.ITEM_NM||"",qt=Kt.EQT_CL_NM||Kt.ITEM_NM||"";return ht.localeCompare(qt)})})});const Ns=Object.keys(Ss).sort();return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-1 cursor-pointer",onClick:Le,children:[s.jsx("input",{type:"text",value:i.WRKR_NM||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer truncate text-center",placeholder:""}),s.jsx("input",{type:"text",value:i.WRKR_ID||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer font-mono text-center",placeholder:"ID"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("select",{value:it,onChange:ke=>At(ke.target.value),className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent truncate",children:[s.jsx("option",{value:"",children:""}),r_.filter(ke=>ke.code!=="").map(ke=>s.jsx("option",{value:ke.code,children:ke.name},ke.code))]}),s.jsxs("select",{value:at,onChange:ke=>We(ke.target.value),disabled:!it||St||Dt.length===0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed truncate",children:[s.jsx("option",{value:"",children:it?St?"...":Dt.length===0?"-":"":"-"}),Dt.map(ke=>s.jsx("option",{value:ke.code,children:ke.name},ke.code))]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:J,onChange:ke=>q(ke.target.value.toUpperCase()),onKeyDown:ke=>ke.key==="Enter"&&J.trim()&&ge(),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono",placeholder:"S/N  MAC  "}),s.jsxs("button",{onClick:()=>A(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),w.length>0&&s.jsxs("div",{className:`p-3 border rounded-lg ${G?"bg-purple-50 border-purple-200":"bg-blue-50 border-blue-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:`text-xs font-medium ${G?"text-purple-700":"text-blue-700"}`,children:[G?" ":" "," (",w.length,")"]}),s.jsx("button",{onClick:()=>{P([]),d([])},className:"text-xs text-gray-500 hover:text-gray-700",children:""})]}),s.jsx("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:w.map((ke,ct)=>s.jsxs("div",{className:"flex items-center justify-between text-xs bg-white px-2 py-1 rounded",children:[s.jsx("span",{className:"font-mono text-gray-800",children:ke}),s.jsx("button",{onClick:()=>{const st=w.filter(Kt=>Kt!==ke);P(st),st.length===0&&d([])},className:"text-red-400 hover:text-red-600",children:s.jsx(bi,{className:"w-3 h-3"})})]},ct))})]}),s.jsx("button",{onClick:()=>{var ct,st;const ke=[];if(i.WRKR_NM&&ke.push(`: ${i.WRKR_NM}`),it){const Kt=(ct=r_.find(ht=>ht.code===it))==null?void 0:ct.name;Kt&&ke.push(`1: ${Kt}`)}if(at){const Kt=(st=Dt.find(ht=>ht.code===at))==null?void 0:st.name;Kt&&ke.push(`2: ${Kt}`)}J.trim()&&ke.push(`S/N: ${J.trim()}`),mt(ke.join(", ")||""),J.trim()?ge():w.length>0?Ce():i.WRKR_ID?ce():e==null||e("   .","warning")},disabled:y||!i.WRKR_ID&&!J.trim()&&w.length===0,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-2.5 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation",children:y?" ...":""})]})}),c.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:jt,className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0",title:"",children:s.jsx(Ei,{className:"w-4 h-4"})}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:ke=>$t(ke.target.checked),checked:c.length>0&&c.every(ke=>ke.CHK),className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[c.length," (: ",c.filter(ke=>ke.CHK).length,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>k("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${j==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>k("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${j==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:Ns.map(ke=>{const ct=Ss[ke],st=Object.keys(ct).sort(),Kt=ae.has(ke),ht=st.reduce((be,Oe)=>be+ct[Oe].length,0),qt=st.flatMap(be=>ct[be]),It=qt.every(be=>be.CHK),he=qt.some(be=>be.CHK);return s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 py-2 bg-blue-50 flex items-center justify-between cursor-pointer hover:bg-blue-100",onClick:()=>ds(ke),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:It,onClick:be=>be.stopPropagation(),onChange:be=>ss(ke,be.target.checked),className:"rounded"}),s.jsx("span",{className:"text-sm font-bold text-blue-800",children:ke}),s.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[ht," ",he&&!It&&`(${qt.filter(be=>be.CHK).length})`]})]}),Kt?s.jsx(sr,{className:"w-4 h-4 text-blue-600"}):s.jsx(Mr,{className:"w-4 h-4 text-blue-600"})]}),!Kt&&st.map(be=>{const Oe=ct[be],je=`${ke}-${be}`,tt=ae.has(je),Te=Oe.every(Qe=>Qe.CHK),_t=Oe.some(Qe=>Qe.CHK);return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>ds(je),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:Te,onClick:Qe=>Qe.stopPropagation(),onChange:Qe=>ls(ke,be,Qe.target.checked),className:"rounded w-4 h-4"}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:be}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[Oe.length," ",_t&&!Te&&`(${Oe.filter(Qe=>Qe.CHK).length})`]})]}),tt?s.jsx(sr,{className:"w-3 h-3 text-gray-500"}):s.jsx(Mr,{className:"w-3 h-3 text-gray-500"})]}),!tt&&s.jsx("div",{className:"space-y-2",children:Oe.map((Qe,yt)=>{const vt=Qe._globalIdx;return s.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${Qe.isScanned?"bg-purple-50 border-purple-200":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:Qe.CHK||!1,onChange:$e=>Ue(vt,$e.target.checked),className:"w-5 h-5 rounded focus:ring-blue-500 mt-0.5 text-blue-500"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-base font-bold truncate text-gray-900",children:Qe.EQT_CL_NM||Qe.ITEM_NM||"-"}),s.jsx("div",{className:"flex items-center gap-1 flex-shrink-0 ml-2",children:Qe.isScanned&&G&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""})})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),Qe.EQT_SERNO||"-"]}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${Qe.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":Qe.EQT_USE_ARR_YN==="A"?"bg-purple-100 text-purple-700":Qe.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:Qe.EQT_USE_ARR_YN==="Y"?"":Qe.EQT_USE_ARR_YN==="A"?"":Qe.EQT_USE_ARR_YN==="N"?"":"N/A"})]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),ST(Qe.MAC_ADDRESS)]}),s.jsx("span",{className:"text-sm text-gray-600",children:AK(Qe.EQT_USE_END_DT||"")})]})]})]}),j==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:Qe.ITEM_MODEL||Qe.MODEL_NM||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:Qe.SO_NM||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Qe.EQT_STAT_CD_NM||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:Qe.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Qe.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Qe.EQT_LOC_NM||Qe.EQT_LOC_TP_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Qe.OLD_EQT_LOC_NM||"-"})]})]})]},Qe.EQT_NO||yt)})})]},je)})]},ke)})})]}),s.jsx("div",{className:"h-24"})]}),c.length===0&&!y&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:U?s.jsx(s.Fragment,{children:"   "}):s.jsx(s.Fragment,{children:"  "})}),s.jsx("p",{className:"text-gray-400 text-xs",children:U?s.jsx(s.Fragment,{children:"S/N  MAC  "}):s.jsx(s.Fragment,{children:"     "})})]})}),y&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsx("p",{className:"text-center text-gray-500 text-sm",children:" ..."})}),c.length>0&&s.jsx("div",{className:"fixed bottom-16 left-0 right-0 px-4 pb-2 z-[45]",children:s.jsx("button",{onClick:()=>!N&&bt(!0),disabled:c.filter(ke=>ke.CHK).length===0||N,className:`w-full py-4 rounded-xl font-bold text-base shadow-lg flex items-center justify-center gap-2 transition-all touch-manipulation ${N?"bg-gray-400 text-gray-200 cursor-not-allowed":c.filter(ke=>ke.CHK).length>0?"bg-gradient-to-r from-blue-500 to-blue-600 text-white active:scale-[0.98]":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:N?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(dc,{className:"w-5 h-5"}),"  (",c.filter(ke=>ke.CHK).length,")"]})})}),s.jsx(_a,{isOpen:et,onClose:()=>bt(!1),title:"  ",size:"large",footer:s.jsxs("div",{className:"w-full grid grid-cols-2 gap-4",children:[s.jsx("button",{onClick:()=>bt(!1),className:"py-4 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-semibold text-base transition-colors touch-manipulation",children:""}),s.jsx("button",{onClick:()=>{N||(bt(!1),Ve())},disabled:N,className:`py-4 rounded-xl font-semibold text-base shadow-lg transition-all touch-manipulation ${N?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-blue-600 text-white active:scale-[0.98]"}`,children:N?"...":""})]}),children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl p-4 bg-blue-50 border border-blue-200",children:[s.jsx("label",{className:"block text-sm font-semibold mb-2 text-blue-800",children:" "}),ye.length>1?s.jsxs(s.Fragment,{children:[s.jsx("select",{value:ue,onChange:ke=>xe(ke.target.value),className:"w-full px-4 py-3 border border-blue-300 rounded-xl text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:ye.map(ke=>s.jsxs("option",{value:ke.SO_ID,children:[ke.SO_NM," (",ke.SO_ID,")"]},ke.SO_ID))}),s.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"   "})]}):ye.length===1?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"w-full px-4 py-3 border border-blue-300 rounded-xl text-sm bg-blue-100 text-blue-900 font-semibold",children:[ye[0].SO_NM," (",ye[0].SO_ID,")"]}),s.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"    "})]}):null]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:" "})}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsxs("span",{className:"font-medium text-gray-900",children:[i.WRKR_NM," (",i.WRKR_ID,")"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsxs("span",{className:"font-medium text-gray-900",children:[n.userName," (",n.userId,")"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsxs("span",{className:"font-bold text-blue-600",children:[c.filter(ke=>ke.CHK).length,""]})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[s.jsx("div",{className:"bg-gray-100 px-4 py-2 border-b border-gray-200",children:s.jsx("span",{className:"text-xs font-semibold text-gray-600",children:" "})}),s.jsx("div",{className:"max-h-48 overflow-y-auto divide-y divide-gray-100",children:c.filter(ke=>ke.CHK).map((ke,ct)=>s.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] rounded font-medium",children:ke.ITEM_MID_NM||ke.EQT_CL_NM||""}),s.jsx("span",{className:"text-xs font-mono text-gray-800",children:ke.EQT_SERNO})]}),s.jsx("span",{className:"text-[10px] text-gray-500",children:ke.SO_NM||ke.SO_ID})]},ke.EQT_NO||ct))})]})]})}),s.jsx(_a,{isOpen:B,onClose:()=>{O(!1),Re(null),_e([]),te([]),ie("")},title:de?`${de.USR_NM} `:" ",size:"large",subHeader:de?s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("button",{onClick:lt,className:"flex items-center gap-1 text-sm text-gray-600 hover:text-gray-900",children:[s.jsx(Mr,{className:"w-4 h-4 rotate-[-90deg]"}),""]}),s.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[s.jsx("input",{type:"checkbox",onChange:ke=>Ct(ke.target.checked),checked:(()=>{const ke=X.filter(ct=>!le||(ct.ITEM_MID_NM||ct.EQT_CL_NM||"")===le);return ke.length>0&&ke.every(ct=>ct.CHK)})(),className:"rounded"}),le?`${le} `:""]})]}):s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:$,onChange:ke=>ie(ke.target.value),onKeyDown:ke=>ke.key==="Enter"&&Xe(),className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500",placeholder:"  ID ",autoFocus:!0}),s.jsx("button",{onClick:Xe,disabled:fe,className:"px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg font-medium text-sm touch-manipulation",children:fe?"...":""})]})}),footer:de?s.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:lt,className:"py-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-semibold text-sm transition-colors touch-manipulation",children:""}),s.jsxs("button",{onClick:Me,disabled:X.filter(ke=>ke.CHK).length===0,className:"py-3 bg-gradient-to-r from-blue-500 to-blue-600 disabled:from-gray-300 disabled:to-gray-400 text-white rounded-xl font-semibold text-sm shadow-lg active:scale-[0.98] transition-all touch-manipulation",children:["  (",X.filter(ke=>ke.CHK).length,")"]})]}):s.jsx("button",{onClick:()=>O(!1),className:"w-full py-2.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg font-medium transition-colors touch-manipulation",children:""}),children:de?me?s.jsx("div",{className:"py-8 text-center text-gray-500 text-sm",children:"  ..."}):X.length===0?s.jsx("div",{className:"p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"    "})]})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-4 py-2 border-b border-gray-100 bg-gray-50",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-600 font-medium",children:":"}),s.jsxs("select",{value:le,onChange:ke=>se(ke.target.value),className:"flex-1 text-xs border border-gray-200 rounded-lg px-2 py-1.5 bg-white focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsxs("option",{value:"",children:[" (",X.length,")"]}),Array.from(new Set(X.map(ke=>ke.ITEM_MID_NM||ke.EQT_CL_NM||""))).sort().map(ke=>{const ct=X.filter(st=>(st.ITEM_MID_NM||st.EQT_CL_NM||"")===ke).length;return s.jsxs("option",{value:ke,children:[ke," (",ct,")"]},ke)})]})]})}),s.jsx("div",{className:"divide-y divide-gray-100 max-h-72 overflow-y-auto",children:X.map((ke,ct)=>({item:ke,idx:ct})).filter(({item:ke})=>!le||(ke.ITEM_MID_NM||ke.EQT_CL_NM||"")===le).map(({item:ke,idx:ct})=>s.jsxs("div",{className:`px-4 py-3 flex items-center gap-3 ${ke.CHK?"bg-blue-50":"hover:bg-gray-50"}`,children:[s.jsx("input",{type:"checkbox",checked:ke.CHK||!1,onChange:st=>Pe(ct,st.target.checked),className:"rounded flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"px-1.5 py-0.5 text-[10px] rounded font-medium bg-blue-100 text-blue-700",children:ke.ITEM_MID_NM||ke.EQT_CL_NM||""}),s.jsx("span",{className:"font-mono text-xs truncate text-gray-800",children:ke.EQT_SERNO||"-"})]}),s.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:ke.SO_NM||ke.SO_ID||""})]})]},ke.EQT_NO||ct))})]}):Y.length===0?s.jsx("div",{className:"py-8 text-center text-gray-500 text-sm",children:fe?" ...":"  ID "}):s.jsx("div",{className:"divide-y divide-gray-100",children:Y.map((ke,ct)=>s.jsxs("button",{onClick:()=>ut(ke),className:"w-full px-4 py-3 text-left hover:bg-green-50 flex justify-between items-center transition-colors active:bg-green-100 touch-manipulation",children:[s.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-gray-900",children:ke.USR_NM}),s.jsxs("span",{className:"text-xs text-gray-500 font-mono",children:["(",ke.USR_ID,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[ke.SO_NM&&s.jsx("span",{className:"text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:ke.SO_NM}),ke.CORP_NM&&s.jsx("span",{className:"text-purple-600 bg-purple-50 px-1.5 py-0.5 rounded",children:ke.CORP_NM}),!ke.SO_NM&&!ke.CORP_NM&&s.jsx("span",{className:"text-gray-400",children:"-"})]})]}),s.jsx("span",{className:"text-xs px-2 py-1 rounded text-blue-600 bg-blue-50 font-medium",children:ke.EQT_COUNT!==void 0?`${ke.EQT_COUNT}`:""})]},ct))})}),s.jsx(Uf,{isOpen:S,onClose:()=>A(!1),onScan:Ye,isMultiScanMode:!1,scanCount:w.length}),I&&V&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:`p-4 ${V.failed.length===0?"bg-gradient-to-r from-green-500 to-green-600":V.success.length===0?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-amber-500 to-amber-600"}`,children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:V.failed.length===0?" ":V.success.length===0?" ":" "}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[": ",V.success.length," / : ",V.failed.length,""]})]}),s.jsxs("div",{className:"p-4 max-h-96 overflow-y-auto space-y-4",children:[V.success.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-green-700 mb-2 flex items-center gap-2",children:[s.jsx(dc,{className:"w-4 h-4"})," (",V.success.length,")"]}),s.jsx("div",{className:"space-y-1",children:V.success.map((ke,ct)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded-lg text-xs",children:[s.jsx("span",{className:"font-mono text-green-800",children:ke.EQT_SERNO}),s.jsx("span",{className:"text-green-600",children:ke.ITEM_NM})]},ct))})]}),V.failed.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-red-700 mb-2 flex items-center gap-2",children:[s.jsx(bi,{className:"w-4 h-4"})," (",V.failed.length,")"]}),s.jsx("div",{className:"space-y-1",children:V.failed.map((ke,ct)=>s.jsxs("div",{className:"p-2 bg-red-50 rounded-lg text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-mono text-red-800",children:ke.EQT_SERNO}),s.jsx("span",{className:"text-red-600",children:ke.ITEM_NM})]}),s.jsx("div",{className:"text-red-500 mt-1",children:ke.error})]},ct))})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{ee(!1),F(null)},className:"w-full py-2.5 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-medium transition-colors",children:""})})]})}),dt&&rt&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[s.jsxs("div",{className:`p-4 ${rt.EQT_LOC_TP_NM===""?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-purple-500 to-purple-600"}`,children:[s.jsxs("h3",{className:"font-semibold text-white text-lg flex items-center gap-2",children:[s.jsx(ql,{className:"w-5 h-5"}),rt.EQT_LOC_TP_NM===""?" ":" "]}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:["  ",rt.EQT_LOC_TP_NM===""?"  ":rt.EQT_LOC_TP_NM===""?" ":" "]})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"S/N"}),s.jsx("span",{className:"font-mono font-medium text-gray-900",children:rt.EQT_SERNO})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:rt.ITEM_NM||"-"})]}),rt.ITEM_MID_NM&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700",children:rt.ITEM_MID_NM})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700",children:rt.SO_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:`font-medium ${rt.EQT_LOC_TP_NM===""?"text-amber-600":rt.EQT_LOC_TP_NM===""?"text-purple-600":"text-gray-600"}`,children:rt.EQT_LOC_TP_NM})]}),rt.EQT_LOC_NM&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700 text-right max-w-[200px] truncate",children:rt.EQT_LOC_NM})]}),rt.WRKR_NM&&rt.WRKR_NM!=="-"&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700",children:rt.WRKR_NM})]}),rt.MAC_ADDRESS&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"MAC"}),s.jsx("span",{className:"font-mono text-xs text-gray-600",children:ST(rt.MAC_ADDRESS)})]})]}),rt.EQT_LOC_TP_NM===""&&s.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded-lg",children:"    . /   ."})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{Ke(!1),ft(null)},className:"w-full py-2.5 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-medium transition-colors",children:""})})]})})]})},UK=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",BK=t=>{var n;if(!t)return"-";const e=t.replace(/[^A-Fa-f0-9]/g,"");return e.length!==12?t:((n=e.match(/.{2}/g))==null?void 0:n.join(":"))||t},WK=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},FK=({isOpen:t,onClose:e,selectedItems:n,onProcess:r,isProcessing:i,soList:l,userSoId:c,showToast:d})=>{const[u,f]=x.useState("");if(x.useEffect(()=>{t&&f("")},[t]),!t)return null;const m=()=>{if(!u){d==null||d("      .","warning");return}r("1",u)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-green-500 to-green-600",children:[s.jsx("h3",{className:"font-semibold text-white",children:"  "}),s.jsxs("p",{className:"text-xs text-white/80 mt-1",children:[n.length,"  "]})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 max-h-32 overflow-y-auto",children:n.map((_,y)=>s.jsxs("div",{className:"text-xs text-gray-600 py-1 border-b border-gray-100 last:border-0",children:[s.jsx("span",{className:"font-mono font-medium",children:_.EQT_SERNO}),s.jsx("span",{className:"text-gray-400 ml-2",children:_.CUST_NM})]},y))}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700",children:"  "}),s.jsxs("select",{value:u,onChange:_=>f(_.target.value),className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:i,children:[s.jsx("option",{value:"",children:" "}),l.map(_=>s.jsxs("option",{value:_.SO_ID,children:[_.SO_NM," (",_.SO_ID,")"]},_.SO_ID))]})]}),s.jsxs("button",{onClick:m,disabled:i,className:"w-full py-3 text-sm text-white bg-green-500 hover:bg-green-600 disabled:bg-gray-300 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[s.jsx(dc,{className:"w-4 h-4"}),i?" ...":" "]}),s.jsx("button",{onClick:e,disabled:i,className:"w-full py-2.5 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:""})]})]})})},KK=({isOpen:t,onClose:e,onSelect:n,onSerialSearch:r})=>{const[i,l]=x.useState(""),[c,d]=x.useState(""),[u,f]=x.useState(""),[m,_]=x.useState(""),[y,g]=x.useState(""),[N,C]=x.useState(!1),[v,R]=x.useState([]),[U,L]=x.useState(!1),[w,P]=x.useState(!1),[G,K]=x.useState(null),B=A=>{g(A.toUpperCase()),P(!1)};if(!t)return null;const O=async()=>{K(null);const A=i.length>=4,Y=c.length>=4,te=u.length>=4,J=m.length>=2,q=te&&J,V=y.length>=4;if(te&&!J||!te&&J){K(`   .
( 4 ,  2 )`);return}if(!A&&!Y&&!q&&!V){K(`    .
 ID (4 )
 ID (4 )
  +  (  )
 S/N (4 )`);return}let F="PHONE_NAME";A?F="CUSTOMER_ID":Y?F="CONTRACT_ID":V&&(F="EQUIPMENT_NO"),C(!0),L(!0);try{const I=await S9({searchType:F,customerId:A?i:void 0,contractId:Y?c:void 0,phoneNumber:q?u:void 0,customerName:q?m:void 0,equipmentNo:V?y:void 0});if(I.success&&I.data&&I.data.length>0)R(I.data);else if(V&&r){r(y),e();return}else R([])}catch(I){if(console.error("Customer search error:",I),V&&r){r(y),e();return}R([])}finally{C(!1)}},S=A=>{A.key==="Enter"&&O()};return s.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden max-h-[80vh] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-100 bg-gradient-to-r from-blue-500 to-blue-600 flex-shrink-0",children:s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(Ih,{className:"w-4 h-4"})," "]})}),s.jsxs("div",{className:"p-4 space-y-3 flex-1 overflow-y-auto min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:i,onChange:A=>{l(A.target.value),K(null)},onKeyPress:S,placeholder:"ID",className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:c,onChange:A=>{d(A.target.value),K(null)},onKeyPress:S,placeholder:"ID",className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex gap-2 min-w-0",children:[s.jsx("input",{type:"tel",value:u,onChange:A=>{f(A.target.value.replace(/[^0-9]/g,"")),K(null)},onKeyPress:S,placeholder:"",className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",value:m,onChange:A=>{_(A.target.value),K(null)},onKeyPress:S,placeholder:"",className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:y,onChange:A=>{g(A.target.value.toUpperCase()),K(null)},onKeyPress:S,placeholder:"S/N  MAC  ",className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono"}),s.jsxs("button",{onClick:()=>P(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),G&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:s.jsx("p",{className:"text-red-600 text-sm whitespace-pre-line",children:G})}),U&&s.jsx("div",{className:"border-t border-gray-100 pt-3",children:v.length>0?s.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",v.length,""]}),v.map((A,Y)=>s.jsxs("button",{onClick:()=>{_(A.CUST_NM),n({CUST_ID:A.CUST_ID,CUST_NM:A.CUST_NM}),e()},className:"w-full p-3 bg-gray-50 hover:bg-blue-50 rounded-lg border border-gray-200 hover:border-blue-300 text-left transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-blue-600 font-mono text-sm",children:A.CUST_ID}),s.jsx("span",{className:"font-semibold text-gray-900",children:A.CUST_NM})]}),(A.INST_ADDR||A.ADDR||A.ADDRESS)&&s.jsx("div",{className:"mt-1 text-xs text-gray-500 truncate",children:A.INST_ADDR||A.ADDR||A.ADDRESS})]},A.CUST_ID||Y))]}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."})})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-white flex-shrink-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:O,disabled:N,className:"flex-1 py-2.5 text-sm text-white bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 rounded-lg font-medium flex items-center justify-center",children:N?" ...":""}),s.jsx("button",{onClick:e,className:"flex-1 py-2.5 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium",children:""})]})})]}),s.jsx(Uf,{isOpen:w,onClose:()=>P(!1),onScan:B})]})},QK=({onBack:t,showToast:e})=>{const[n,r]=x.useState({CUST_ID:"",CUST_NM:"",PHONE_NO:"",EQT_CL_CD:"",EQT_SERNO:""}),[i,l]=x.useState(!1),[c,d]=x.useState(null),[u,f]=x.useState([]),[m,_]=x.useState(!1),[y,g]=x.useState(!1),[N,C]=x.useState(!1),[v,R]=x.useState(!1),[U,L]=x.useState([]),[w,P]=x.useState([]),[G,K]=x.useState(""),[B,O]=x.useState("simple"),[S,A]=x.useState("all"),[Y,te]=x.useState(new Set),J=X=>{if(!X)return"";if(X==="100")return"";const _e=/^\d+$/.test(X);if(!_e&&w.find(le=>le.SO_NM===X))return X;const me=w.find(Z=>Z.SO_ID===X);return me&&me.SO_NM?me.SO_NM:_e?`(${X})`:X},q=X=>{te(_e=>{const me=new Set(Array.from(_e));return me.has(X)?me.delete(X):me.add(X),me})},V=X=>X.EQT_STAT_CD_NM===""?!0:X.LOSS_AMT!==""&&X.LOSS_AMT!=="0"&&Number(X.LOSS_AMT)>0,I=S==="all"?u:S==="lost"?u.filter(X=>V(X)):u.filter(X=>!V(X)),ee=u.filter(X=>V(X)).length;u.length-ee;const ae=I.reduce((X,_e,me)=>{var ne,ue,xe,et;let Z="";const le=(ne=_e.SO_NM)==null?void 0:ne.trim(),se=(ue=_e.MST_SO_NM)==null?void 0:ue.trim(),Ee=(xe=_e.SO_ID)==null?void 0:xe.trim(),Ne=(et=_e.MST_SO_ID)==null?void 0:et.trim();le&&le!=="100"?Z=le:se&&se!=="100"?Z=se:Ee==="100"||Ne==="100"||le==="100"||se==="100"?Z="":Ee&&(Z=Ee);const ye=_e.BIZ_CL_NM||_e.ITEM_MID_NM||_e.EQT_CL_NM||"";return X[Z]||(X[Z]={}),X[Z][ye]||(X[Z][ye]=[]),X[Z][ye].push({..._e,_globalIdx:me}),X},{});Object.keys(ae).forEach(X=>{Object.keys(ae[X]).forEach(_e=>{ae[X][_e].sort((me,Z)=>{const le=me.EQT_CL_NM||me.ITEM_NM||"",se=Z.EQT_CL_NM||Z.ITEM_NM||"";return le.localeCompare(se)})})});const T=Object.keys(ae).sort(),j=(X,_e)=>{f(u.map(me=>{const Z=me.SO_NM||me.SO_ID||"",le=V(me);return Z===X&&le?{...me,CHK:_e}:me}))},k=(X,_e,me)=>{f(u.map(Z=>{const le=Z.SO_NM||Z.SO_ID||"",se=Z.BIZ_CL_NM||Z.ITEM_MID_NM||Z.EQT_CL_NM||"",Ee=V(Z);return le===X&&se===_e&&Ee?{...Z,CHK:me}:Z}))};x.useEffect(()=>{(()=>{try{const _e=sessionStorage.getItem("userInfo");if(_e){const le=JSON.parse(_e),se=le.soId||le.SO_ID||"";se&&(K(se),console.log("[]   :",se))}const me=localStorage.getItem("branchList");if(me){const le=JSON.parse(me);if(Array.isArray(le)&&le.length>0){console.log("[] branchList   :",le.length,"");const se=le.map(Ne=>({SO_ID:Ne.SO_ID||Ne.soId||"",SO_NM:Ne.SO_NM||Ne.soNm||Ne.SO_ID||""})).filter(Ne=>Ne.SO_ID),Ee=new Set;le.forEach(Ne=>{const ye=Ne.MST_SO_ID||Ne.mstSoId;ye&&!se.some(ne=>ne.SO_ID===ye)&&Ee.add(ye)}),Ee.forEach(Ne=>{se.push({SO_ID:Ne,SO_NM:""})}),P(se);return}}const Z=localStorage.getItem("userInfo");if(Z){const le=JSON.parse(Z),se=le.authSoList||le.AUTH_SO_List||[];if(Array.isArray(se)&&se.length>0){console.log("[] authSoList   :",se.length,"");const Ee=se.map(ye=>({SO_ID:ye.SO_ID||ye.soId||"",SO_NM:ye.SO_NM||ye.soNm||ye.SO_ID||""})).filter(ye=>ye.SO_ID),Ne=new Set;se.forEach(ye=>{const ne=ye.MST_SO_ID||ye.mstSoId;ne&&!Ee.some(ue=>ue.SO_ID===ne)&&Ne.add(ne)}),Ne.forEach(ye=>{Ee.push({SO_ID:ye,SO_NM:""})}),P(Ee);return}}if(_e){const le=JSON.parse(_e),se=le.authSoList||le.AUTH_SO_List||[];if(Array.isArray(se)&&se.length>0){console.log("[] sessionStorage authSoList   :",se.length,"");const ne=se.map(xe=>({SO_ID:xe.SO_ID||xe.soId||"",SO_NM:xe.SO_NM||xe.soNm||xe.SO_ID||""})).filter(xe=>xe.SO_ID),ue=new Set;se.forEach(xe=>{const et=xe.MST_SO_ID||xe.mstSoId;et&&!ne.some(bt=>bt.SO_ID===et)&&ue.add(et)}),ue.forEach(xe=>{ne.push({SO_ID:xe,SO_NM:""})}),P(ne);return}const Ee=JSON.parse(_e),Ne=Ee.soId||Ee.SO_ID,ye=Ee.soNm||Ee.SO_NM||Ne;if(Ne){console.log("[]  SO  :",Ne,ye),P([{SO_ID:Ne,SO_NM:ye}]);return}}console.log("[]   ")}catch(_e){console.error("[] SO list load failed:",_e)}})()},[]);const Q=async X=>{_(!0);try{L(Z=>[...new Set([X,...Z])]);const _e={EQT_SERNO:X},me=await _i("EquipmentRecovery","getUnreturnedEquipmentList (barcode)",()=>sC(_e),_e);if(me&&me.length>0){const Z=me.map(le=>{var se,Ee;return{CHK:le.EQT_SERNO===X,CUST_ID:le.CUST_ID||"",CUST_NM:le.CUST_NM||"",CTRT_ID:le.CTRT_ID||"",EQT_NO:le.EQT_NO||"",EQT_SERNO:le.EQT_SERNO||"",EQT_CL_CD:le.EQT_CL_CD||le.EQT_CL||"",EQT_CL_NM:le.EQT_CL_NM||le.EQT_NM||"",ITEM_NM:le.ITEM_NM||le.EQT_NM||"",TRML_DT:le.TRML_DT||((Ee=(se=le.CMPL_DATE)==null?void 0:se.split(" ")[0])==null?void 0:Ee.replace(/-/g,""))||"",WRK_ID:le.WRK_ID||"",WRKR_ID:le.WRKR_ID||"",WRKR_NM:le.WRKR_NM||"",SO_ID:le.SO_ID||"",SO_NM:le.SO_NM||J(le.SO_ID)||"",PHONE_NO:le.PHONE_NO||le.TEL_NO||le.TEL_NO_1||"",ADDRESS:le.ADDRESS||le.WORK_ADDR||le.CTRT_ADDR||"",RETN_REQ_YN:le.RETN_REQ_YN||"",LOSS_AMT:le.LOSS_AMT||"",CRR_ID:le.CRR_ID||"",CMPL_DATE:le.CMPL_DATE||"",EQT_STAT_CD_NM:le.EQT_STAT_NM||le.EQT_STAT_CD_NM||"",isScanned:le.EQT_SERNO===X,MAC_ADDRESS:le.MAC_ADDRESS||le.MAC_ADDR||"",EQT_USE_END_DT:le.EQT_USE_END_DT||"",CHG_KND_NM:le.CHG_KND_NM||"",EQT_LOC_NM:le.EQT_LOC_NM||"",EQT_LOC_TP_NM:le.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:le.OLD_EQT_LOC_NM||"",ITEM_MODEL:le.ITEM_MODEL||le.MODEL_NM||"",EQT_USE_ARR_YN:le.EQT_USE_ARR_YN||"",BIZ_CL_NM:le.BIZ_CL_NM||"",MST_SO_ID:le.MST_SO_ID||"",MST_SO_NM:le.MST_SO_NM||""}});f(Z)}else{const Z=await _i("EquipmentRecovery","getEquipmentHistoryInfo",()=>bf({EQT_SERNO:X}),{EQT_SERNO:X});if(Z&&Z.length>0){const le=Z[0];e==null||e(` (${X})   . : ${le.EQT_STAT_NM||le.EQT_STAT_CD_NM||"  "}`,"warning")}else e==null||e(` (${X})   .`,"error");f([])}}catch(_e){console.error("Barcode scan failed:",_e),e==null||e("  .","error")}finally{_(!1)}},H=X=>{f([]),L([]),d(X),r({...n,CUST_ID:X.CUST_ID,CUST_NM:X.CUST_NM})},$=async()=>{if(!n.EQT_SERNO&&!c){e==null||e("  S/N .","warning");return}_(!0);try{const X={};n.EQT_SERNO&&(X.EQT_SERNO=n.EQT_SERNO),c&&(X.CUST_ID=c.CUST_ID);const _e=await _i("EquipmentRecovery","getUnreturnedEquipmentList",()=>sC(X),X);if(!c&&n.EQT_SERNO&&_e&&_e.length>0){const Z=_e[0];Z.CUST_ID&&Z.CUST_NM&&d({CUST_ID:Z.CUST_ID,CUST_NM:Z.CUST_NM})}const me=(_e||[]).map(Z=>{var le,se;return{CHK:U.includes(Z.EQT_SERNO),CUST_ID:Z.CUST_ID||"",CUST_NM:Z.CUST_NM||"",CTRT_ID:Z.CTRT_ID||"",EQT_NO:Z.EQT_NO||"",EQT_SERNO:Z.EQT_SERNO||"",EQT_CL_CD:Z.EQT_CL_CD||Z.EQT_CL||"",EQT_CL_NM:Z.EQT_CL_NM||Z.EQT_NM||"",ITEM_NM:Z.ITEM_NM||Z.EQT_NM||"",TRML_DT:Z.TRML_DT||((se=(le=Z.CMPL_DATE)==null?void 0:le.split(" ")[0])==null?void 0:se.replace(/-/g,""))||"",WRK_ID:Z.WRK_ID||"",WRKR_ID:Z.WRKR_ID||"",WRKR_NM:Z.WRKR_NM||"",SO_ID:Z.SO_ID||"",SO_NM:Z.SO_NM||J(Z.SO_ID)||"",PHONE_NO:Z.PHONE_NO||Z.TEL_NO||Z.TEL_NO_1||"",ADDRESS:Z.ADDRESS||Z.WORK_ADDR||Z.CTRT_ADDR||"",RETN_REQ_YN:Z.RETN_REQ_YN||"",LOSS_AMT:Z.LOSS_AMT||"",CRR_ID:Z.CRR_ID||"",CMPL_DATE:Z.CMPL_DATE||"",EQT_STAT_CD_NM:Z.EQT_STAT_NM||Z.EQT_STAT_CD_NM||"",isScanned:U.includes(Z.EQT_SERNO),MAC_ADDRESS:Z.MAC_ADDRESS||Z.MAC_ADDR||"",EQT_USE_END_DT:Z.EQT_USE_END_DT||"",CHG_KND_NM:Z.CHG_KND_NM||"",EQT_LOC_NM:Z.EQT_LOC_NM||"",EQT_LOC_TP_NM:Z.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:Z.OLD_EQT_LOC_NM||"",ITEM_MODEL:Z.ITEM_MODEL||Z.MODEL_NM||"",EQT_USE_ARR_YN:Z.EQT_USE_ARR_YN||"",BIZ_CL_NM:Z.BIZ_CL_NM||"",MST_SO_ID:Z.MST_SO_ID||"",MST_SO_NM:Z.MST_SO_NM||""}});me.sort((Z,le)=>Z.isScanned&&!le.isScanned?-1:!Z.isScanned&&le.isScanned?1:0),f(me)}catch(X){console.error("Unreturned equipment lookup failed:",X),e==null||e("  .","error"),f([])}finally{_(!1)}},ie=async(X,_e)=>{const me=u.filter(Z=>Z.CHK);if(me.length!==0){R(!0);try{let Z=0,le=0;for(const se of me)try{if(!se.EQT_NO||se.EQT_NO.length!==20||!/^\d+$/.test(se.EQT_NO)){console.warn("Invalid EQT_NO format:",se.EQT_SERNO,se.EQT_NO),le++;continue}const Ee=typeof window<"u"?sessionStorage.getItem("userInfo"):null,Ne=Ee?JSON.parse(Ee):{},ye=new Date().toISOString().slice(0,10).replace(/-/g,""),ne={EQT_NO:se.EQT_NO,EQT_SERNO:se.EQT_SERNO,PROC_CL:X,CUST_ID:se.CUST_ID,CTRT_ID:se.CTRT_ID,WRK_ID:se.WRK_ID,CRR_ID:se.CRR_ID||Ne.crrId||"",WRKR_ID:se.WRKR_ID||Ne.userId||"",SO_ID:_e||se.SO_ID||Ne.soId||"",CHG_UID:Ne.userId||"",PROC_UID_SO_ID:_e||Ne.soId||se.SO_ID||"",RTN_DD:ye,RTN_TP:"3",STTL_YN:"N",BILL_YN:se.BILL_YN||"N",RCPT_YN:se.RCPT_YN||"0",EQT_PROD_CMPS_ID:se.EQT_PROD_CMPS_ID||"",BASIC_PROD_CMPS_ID:se.BASIC_PROD_CMPS_ID||"",EQT_CL_CD:se.EQT_CL_CD||se.EQT_CL||"",EQT_USE_STAT_CD:se.EQT_USE_STAT_CD||"1",SVC_CD:se.SVC_CD||"",IF_DTL_ID:se.IF_DTL_ID||"0000000000"};await _i("EquipmentRecovery","processEquipmentRecovery",()=>M4(ne),ne),Z++}catch(Ee){console.error("Recovery process failed:",se.EQT_SERNO,Ee);const Ne=(Ee==null?void 0:Ee.message)||(Ee==null?void 0:Ee.toString())||"";if(Ne.includes("    ")||Ne.includes("ORA-30926")){console.log("[Workaround] Oracle    ,     ...");try{await new Promise(xe=>setTimeout(xe,500));const ye=await bf({EQT_SERNO:se.EQT_SERNO}),ne=Array.isArray(ye)?ye[0]:ye,ue=(ne==null?void 0:ne.CHG_KND_CD_NM)||(ne==null?void 0:ne.CHG_KND_NM)||"";console.log("[Workaround]   :",se.EQT_SERNO,"- CHG_KND_NM:",ue),ue.includes("")||ue.includes("")||ue==="SO"?(console.log("[Workaround]     :",se.EQT_SERNO),Z++):console.log("[Workaround]    ,  :",ue)}catch(ye){console.error("[Workaround]  :",ye)}}}if(Z>0){let se=Z+"  ";le>0&&(se+=` (${le} )`),e==null||e(se,"success"),C(!1),L([]),$()}else throw new Error(" ")}catch(Z){console.error("Recovery process failed:",Z),e==null||e(" .","error")}finally{R(!1)}}},fe=X=>{f(u.map(_e=>{const me=V(_e);return{..._e,CHK:me?X:!1}}))},pe=(X,_e)=>{const me=[...u],Z=me[X];V(Z)&&(me[X].CHK=_e,f(me))},de=u.filter(X=>X.CHK).length,Re=X=>{const _e=V(X),me=_e,Z=u.findIndex(le=>le.EQT_SERNO===X.EQT_SERNO);return s.jsxs("div",{onClick:()=>me&&pe(Z,!X.CHK),className:`p-3 rounded-lg border-2 transition-all ${me?"cursor-pointer":"cursor-not-allowed opacity-70"} ${X.CHK?"bg-blue-50 border-blue-400":X.isScanned?"bg-orange-50 border-orange-200":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:X.CHK||!1,onChange:le=>{le.stopPropagation(),pe(Z,le.target.checked)},disabled:!me,className:`w-5 h-5 rounded focus:ring-blue-500 mt-0.5 ${me?"text-blue-500":"text-gray-300 cursor-not-allowed"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("span",{className:"text-base font-bold text-gray-900 truncate",children:X.EQT_CL_NM||X.ITEM_NM||"-"}),X.isScanned&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700 flex-shrink-0",children:""})]}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${_e?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:_e?"":X.EQT_STAT_CD_NM||""})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),X.EQT_SERNO||"-"]}),(()=>{const le=X.EQT_USE_ARR_YN;if(!le)return null;let se="bg-gray-100 text-gray-700",Ee=le;return le==="Y"?(se="bg-green-100 text-green-700",Ee=""):le==="A"?(se="bg-purple-100 text-purple-700",Ee=""):le==="N"?(se="bg-red-100 text-red-700",Ee=""):le==="W"?(se="bg-blue-100 text-blue-700",Ee=""):le==="R"?(se="bg-yellow-100 text-yellow-700",Ee=""):le==="D"&&(se="bg-orange-100 text-orange-700",Ee=""),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${se}`,children:Ee})})()]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),BK(X.MAC_ADDRESS)||"-"]}),s.jsx("span",{className:"text-sm text-gray-600",children:UK(X.EQT_USE_END_DT||"")})]})]})]}),B==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:X.ITEM_MODEL||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:J(X.SO_NM||X.SO_ID)||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.EQT_STAT_CD_NM||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:X.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.EQT_LOC_NM||X.EQT_LOC_TP_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.OLD_EQT_LOC_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"ID    : "}),s.jsx("span",{className:"text-gray-800 font-mono",children:WK(X.CTRT_ID)})]})]})]},X._globalIdx)};return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[U.length>0&&s.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-xs font-medium text-orange-700",children:["  (",U.length,")"]}),s.jsx("button",{onClick:()=>L([]),className:"text-xs text-orange-600 hover:text-orange-800",children:""})]}),s.jsx("div",{className:"flex flex-wrap gap-1",children:U.map((X,_e)=>s.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-md font-mono",children:X},_e))})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{onClick:()=>l(!0),className:"flex-1 flex gap-2 cursor-pointer min-w-0 overflow-hidden",children:[s.jsx("input",{type:"text",value:(c==null?void 0:c.CUST_NM)||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer truncate",placeholder:""}),s.jsx("input",{type:"text",value:(c==null?void 0:c.CUST_ID)||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer",placeholder:"ID"})]}),c&&s.jsx("button",{onClick:X=>{X.stopPropagation(),d(null),r({...n,CUST_ID:"",CUST_NM:""}),f([])},className:"w-9 h-9 flex items-center justify-center text-red-500 bg-red-50 hover:bg-red-100 rounded-lg transition-all flex-shrink-0",title:" ",children:s.jsx(bi,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:n.EQT_SERNO,onChange:X=>r({...n,EQT_SERNO:X.target.value.toUpperCase()}),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono",placeholder:"S/N  MAC  "}),s.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),s.jsx("button",{onClick:$,disabled:m||!c&&!n.EQT_SERNO,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-3 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:m?" ...":""})]})}),u.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:X=>fe(X.target.checked),checked:I.length>0&&I.filter(X=>V(X)).every(X=>X.CHK),className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[I.length," (: ",de,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>O("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${B==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>O("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${B==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"px-4 py-2 border-b border-gray-100",children:s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsxs("button",{onClick:()=>A("all"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${S==="all"?"bg-white text-orange-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[" (",u.length,")"]}),s.jsxs("button",{onClick:()=>A("lost"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${S==="lost"?"bg-white text-red-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[" (",ee,")"]})]})}),s.jsx("div",{className:"divide-y divide-gray-100",children:T.map(X=>{const _e=ae[X],me=Object.keys(_e).sort(),Z=me.reduce((Ne,ye)=>Ne+_e[ye].length,0),le=me.reduce((Ne,ye)=>Ne+_e[ye].filter(ne=>ne.CHK).length,0),se=me.reduce((Ne,ye)=>Ne+_e[ye].filter(ne=>V(ne)).length,0),Ee=Y.has(`so_${X}`);return s.jsxs("div",{className:"border-b border-gray-100 last:border-0",children:[s.jsxs("div",{className:"px-4 py-2 bg-blue-50 flex items-center justify-between cursor-pointer hover:bg-blue-100",onClick:()=>q(`so_${X}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:se>0&&le===se,onChange:Ne=>{Ne.stopPropagation(),j(X,Ne.target.checked)},onClick:Ne=>Ne.stopPropagation(),className:"rounded",disabled:se===0}),s.jsx("span",{className:"text-sm font-bold text-blue-800",children:J(X)}),s.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[Z,""]})]}),Ee?s.jsx(sr,{className:"w-4 h-4 text-blue-600"}):s.jsx(Mr,{className:"w-4 h-4 text-blue-600"})]}),!Ee&&me.map(Ne=>{const ye=_e[Ne],ne=ye.filter(et=>V(et)).length,ue=ye.filter(et=>et.CHK).length,xe=Y.has(`so_${X}_type_${Ne}`);return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>q(`so_${X}_type_${Ne}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:ne>0&&ue===ne,onChange:et=>{et.stopPropagation(),k(X,Ne,et.target.checked)},onClick:et=>et.stopPropagation(),className:"rounded",disabled:ne===0}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:Ne}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[ye.length,""]})]}),xe?s.jsx(sr,{className:"w-3 h-3 text-gray-500"}):s.jsx(Mr,{className:"w-3 h-3 text-gray-500"})]}),!xe&&s.jsx("div",{className:"space-y-2",children:ye.map(et=>Re(et))})]},Ne)})]},X)})})]}),s.jsx("div",{className:"h-20"})]}):s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:m?" ...":"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     "})]})}),u.length>0&&s.jsx("div",{className:"fixed bottom-[56px] left-0 right-0 p-3 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsxs("button",{onClick:()=>C(!0),disabled:de===0,className:`w-full py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation flex items-center justify-center gap-2 ${de>0?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx(dc,{className:"w-4 h-4"}),"  ",de>0&&`(${de})`]})}),s.jsx(Uf,{isOpen:y,onClose:()=>g(!1),onScan:Q}),s.jsx(FK,{isOpen:N,onClose:()=>C(!1),selectedItems:u.filter(X=>X.CHK),onProcess:ie,isProcessing:v,soList:w,userSoId:G,showToast:e}),s.jsx(KK,{isOpen:i,onClose:()=>l(!1),onSelect:H,onSerialSearch:X=>{r({...n,EQT_SERNO:X}),l(!1),setTimeout(()=>{const _e={EQT_SERNO:X};_(!0),sC(_e).then(me=>{if(me&&me.length>0){const Z=me[0];Z.CUST_ID&&Z.CUST_NM&&d({CUST_ID:Z.CUST_ID,CUST_NM:Z.CUST_NM}),f(me.map(le=>{var se,Ee;return{CHK:!1,CUST_ID:le.CUST_ID||"",CUST_NM:le.CUST_NM||"",CTRT_ID:le.CTRT_ID||"",EQT_NO:le.EQT_NO||"",EQT_SERNO:le.EQT_SERNO||"",EQT_CL_CD:le.EQT_CL_CD||le.EQT_CL||"",EQT_CL_NM:le.EQT_CL_NM||le.EQT_NM||"",ITEM_NM:le.ITEM_NM||le.EQT_NM||"",TRML_DT:le.TRML_DT||((Ee=(se=le.CMPL_DATE)==null?void 0:se.split(" ")[0])==null?void 0:Ee.replace(/-/g,""))||"",WRK_ID:le.WRK_ID||"",WRKR_ID:le.WRKR_ID||"",WRKR_NM:le.WRKR_NM||"",SO_ID:le.SO_ID||"",SO_NM:le.SO_NM||J(le.SO_ID)||"",PHONE_NO:le.PHONE_NO||le.TEL_NO||le.TEL_NO_1||"",ADDRESS:le.ADDRESS||le.WORK_ADDR||le.CTRT_ADDR||"",RETN_REQ_YN:le.RETN_REQ_YN||"",LOSS_AMT:le.LOSS_AMT||"",CRR_ID:le.CRR_ID||"",CMPL_DATE:le.CMPL_DATE||"",EQT_STAT_CD_NM:le.EQT_STAT_NM||le.EQT_STAT_CD_NM||"",isScanned:!1,MAC_ADDRESS:le.MAC_ADDRESS||le.MAC_ADDR||"",EQT_USE_END_DT:le.EQT_USE_END_DT||"",CHG_KND_NM:le.CHG_KND_NM||"",EQT_LOC_NM:le.EQT_LOC_NM||"",EQT_LOC_TP_NM:le.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:le.OLD_EQT_LOC_NM||"",ITEM_MODEL:le.ITEM_MODEL||le.MODEL_NM||"",EQT_USE_ARR_YN:le.EQT_USE_ARR_YN||"",BIZ_CL_NM:le.BIZ_CL_NM||"",MST_SO_ID:le.MST_SO_ID||"",MST_SO_NM:le.MST_SO_NM||""}})),e==null||e(`${me.length}   .`,"success")}else e==null||e(` (${X})   .`,"error"),f([])}).catch(()=>{e==null||e("  .","error")}).finally(()=>_(!1))},100)}})]})},GK={10:"",11:"()",20:"",35:"",50:"",60:"",70:"",71:"",72:"",73:"AS",74:"",75:"",80:"",81:"",82:"",83:"",84:"",90:""},YK={1:"SO()",2:"",3:"",4:""},VK=t=>GK[t]||t,vT=t=>YK[t]||t,P0=t=>{const e={...t};return e.EQT_STAT_CD&&!e.EQT_STAT_CD_NM&&(e.EQT_STAT_CD_NM=VK(e.EQT_STAT_CD)),e.EQT_LOC_TP_CD&&!e.EQT_LOC_TP_CD_NM&&(e.EQT_LOC_TP_CD_NM=vT(e.EQT_LOC_TP_CD)),e.OLD_EQT_LOC_TP_CD&&!e.OLD_EQT_LOC_TP_CD_NM&&(e.OLD_EQT_LOC_TP_CD_NM=vT(e.OLD_EQT_LOC_TP_CD)),e},iy=t=>{if(!t)return{name:"-",id:""};const e=t.match(/^(.+?)\(([A-Za-z0-9]+)\)$/);return e?{name:e[1],id:e[2]}:{name:t,id:""}},$K=({onBack:t,showToast:e})=>{const[n,r]=x.useState(""),[i,l]=x.useState(!1),[c,d]=x.useState(null),[u,f]=x.useState(null),[m,_]=x.useState(null),[y,g]=x.useState([]),[N,C]=x.useState(!1),[v,R]=x.useState("manual"),[U,L]=x.useState(!1),[w,P]=x.useState([]),[G,K]=x.useState([]),B=v==="multi",O=Gi.useRef(new Set),[S,A]=x.useState(0),[Y,te]=x.useState([]),J="1644-1100",[q,V]=x.useState(!1),[F,I]=x.useState(!1),ee=Gi.useRef(null),ae=()=>{try{const X=localStorage.getItem("user");if(X){const _e=JSON.parse(X),me=_e.USR_ID||_e.WRKR_ID||_e.userId||null,Z=_e.soId||_e.SO_ID||null,le=_e.AUTH_SO_List||null;return console.log("[]  :",{userId:me,soId:Z||"()",authSoListCount:(le==null?void 0:le.length)||0}),me?{userId:me,soId:Z,authSoList:le}:null}}catch(X){console.warn("   :",X)}return null};x.useEffect(()=>{(async()=>{const _e=ae();if(_e){C(!0);try{let me=[];if(_e.soId){const Z={WRKR_ID:_e.userId,SO_ID:_e.soId};console.log("[]  - SO_ID :",Z);const le=await _i("EquipmentList","getWrkrHaveEqtList",()=>Km(Z),Z);me=Array.isArray(le)?le:(le==null?void 0:le.data)||[]}else if(_e.authSoList&&_e.authSoList.length>0){console.log("[]  - AUTH_SO_List :",_e.authSoList);for(const le of _e.authSoList)try{const se={WRKR_ID:_e.userId,SO_ID:le.SO_ID},Ee=await _i("EquipmentList",`getWrkrHaveEqtList(SO_ID=${le.SO_ID})`,()=>Km(se),se),ye=(Array.isArray(Ee)?Ee:(Ee==null?void 0:Ee.data)||[]).filter(ne=>ne.WRKR_ID===_e.userId||ne.ID===_e.userId);me=[...me,...ye]}catch(se){console.warn(`SO_ID ${le.SO_ID}  :`,se)}const Z=new Map;me.forEach(le=>{le.EQT_SERNO&&!Z.has(le.EQT_SERNO)&&Z.set(le.EQT_SERNO,le)}),me=Array.from(Z.values()),console.log("[]   :",me.length,"")}else{const Z={WRKR_ID:_e.userId};console.log("[]   (SO_ID ):",Z);const le=await _i("EquipmentList","getWrkrHaveEqtList",()=>Km(Z),Z);me=Array.isArray(le)?le:(le==null?void 0:le.data)||[]}g(me)}catch(me){console.warn("    :",me)}finally{C(!1)}}})()},[]);const T=X=>{const _e=X.toUpperCase().replace(/[:-]/g,"");for(const me of y){const Z=(me.EQT_SERNO||me.SERIAL_NO||me.SN||"").toUpperCase().replace(/[:-]/g,"");if(Z&&Z.includes(_e))return me;const le=(me.MAC_ADDRESS||me.MAC||me.MAC_ADDR||"").toUpperCase().replace(/[:-]/g,"");if(le&&le.includes(_e))return me;const se=(me.EQT_NO||"").toUpperCase();if(se&&se.includes(_e))return me}return null},j=async X=>{console.log("Barcode scanned:",X);const _e=X.toUpperCase().replace(/[:-]/g,"");if(B){if(O.current.has(_e)){e==null||e("  .","warning");return}O.current.add(_e),A(O.current.size)}r(X.toUpperCase()),B||I(!1),e==null||e(` : ${X}`,"success");const me=X.toUpperCase();setTimeout(()=>{k(me)},100)},k=async X=>{const _e=X||n.trim();if(!_e){e==null||e(" .","warning");return}l(!0),_(null),B||d(null),f(null);const me=String(_e||""),Z=typeof me=="string"&&me.includes(",")?[...new Set(me.split(",").map(Ne=>Ne.trim().toUpperCase().replace(/[\s:-]/g,"")).filter(Ne=>Ne.length>0))]:[me.toUpperCase().replace(/[\s:-]/g,"")].filter(Ne=>Ne.length>0);if(Z.length===0){e==null||e(" S/N .","warning"),l(!1);return}const le=async Ne=>{if(y.length>0){const ye=T(Ne);if(ye)return{found:!0,equipment:ye,source:"myEquipments"}}try{const ye=ae(),ne={EQT_SERNO:Ne,SO_ID:(ye==null?void 0:ye.soId)||void 0,WRKR_ID:ye==null?void 0:ye.userId},ue=await _i("EquipmentList","getEquipmentHistoryInfo",()=>bf(ne),ne);if(ue){const xe=Array.isArray(ue)?ue:[ue];if(xe.length>1)return{found:!0,equipments:xe,source:"getEquipmentHistoryInfo",isMultiple:!0};if(xe.length===1)return{found:!0,equipment:xe[0],source:"getEquipmentHistoryInfo"}}}catch(ye){console.error("[]  :",Ne,ye)}return{found:!1}};if(console.log("[]  :",{searchValues:Z,count:Z.length,isMultiScanMode:B}),Z.length>1){const Ne=await Promise.all(Z.map(async ue=>({searchVal:ue,...await le(ue)}))),ye=[],ne=[];if(Ne.forEach(({searchVal:ue,found:xe,equipment:et})=>{xe&&et?ye.push(et):ne.push(ue)}),console.log("[]   :",{found:ye.length,notFound:ne.length}),ye.length>0){const ue=[];ye.forEach(xe=>{G.some(bt=>bt.EQT_SERNO===xe.EQT_SERNO||bt.EQT_NO===xe.EQT_NO||bt.MAC_ADDRESS&&xe.MAC_ADDRESS&&bt.MAC_ADDRESS===xe.MAC_ADDRESS)||ue.push(xe)}),ue.length>0&&(K(xe=>[...xe,...ue]),ue.forEach(xe=>{const et=(xe.EQT_SERNO||"").toUpperCase().replace(/[:-]/g,"");et&&O.current.add(et)}),A(O.current.size)),ne.length>0&&te(xe=>{const et=Array.isArray(xe)?xe:[];return[...et,...ne.filter(bt=>!et.includes(bt))]}),V(!0),d(null),r(""),e==null||e(`${ue.length}  ${ne.length>0?`, ${ne.length} `:""}`,"success")}else te(ue=>{const xe=Array.isArray(ue)?ue:[];return[...xe,...ne.filter(et=>!xe.includes(et))]}),_("     ."),e==null||e("   .","error");l(!1);return}const se=Z[0],Ee=await le(se);if(Ee.found){if(Ee.isMultiple&&Ee.equipments&&Ee.equipments.length>1){P(Ee.equipments),L(!0),r(""),e==null||e(`${Ee.equipments.length}  . .`,"info"),l(!1);return}const Ne=Ee.equipment;if(Ne)if(B)if(pe(Ne)){const ne=Array.from(O.current).join(", ");r(ne),e==null||e(` . (${G.length+1})`,"success")}else{const ne=se.toUpperCase().replace(/[\s:-]/g,"");O.current.delete(ne),A(O.current.size);const ue=Array.from(O.current).join(", ");r(ue||"")}else d(P0(Ne)),f({successApi:Ee.source,data:Ne,source:Ee.source}),e==null||e("  .","success")}else if(B){O.current.delete(se),A(O.current.size),te(ye=>{const ne=Array.isArray(ye)?ye:[];return ne.includes(se)?ne:[...ne,se]});const Ne=Array.from(O.current).join(", ");r(Ne),e==null||e("   .","error")}else _("   . S/N  MAC  ."),e==null||e("   .","error");l(!1)},Q=({label:X,value:_e})=>s.jsxs("div",{className:"flex border-b border-gray-100 py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-gray-500",children:X}),s.jsx("span",{className:"flex-1 text-xs text-gray-900 font-medium break-all",children:_e||"-"})]}),H=({title:X})=>s.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white px-3 py-2 -mx-4 mt-4 mb-2 first:mt-0 border-y border-gray-100",children:s.jsx("h4",{className:"text-xs font-bold text-gray-600",children:X})}),$=X=>{const _e=G[X];if(_e){const me=(_e.EQT_SERNO||_e.MAC_ADDRESS||"").toUpperCase().replace(/[:-]/g,"");O.current.delete(me)}K(me=>me.filter((Z,le)=>le!==X))},ie=()=>{I(!1),B&&(G.length>0||Y.length>0||S>0)&&(V(!0),d(null))},fe=()=>{window.location.href=`tel:${J}`},pe=X=>G.some(me=>me.EQT_SERNO===X.EQT_SERNO||me.EQT_NO===X.EQT_NO||me.MAC_ADDRESS&&X.MAC_ADDRESS&&me.MAC_ADDRESS===X.MAC_ADDRESS)?(e==null||e("  . ( )","warning"),!1):(K(me=>[...me,X]),!0),[de,Re]=x.useState(null);return x.useEffect(()=>()=>{de&&clearTimeout(de)},[de]),s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{ref:ee,type:"text",value:n,onChange:X=>r(X.target.value.toUpperCase()),onKeyDown:X=>X.key==="Enter"&&k(),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono",placeholder:"S/N  MAC  ",autoFocus:!0}),s.jsxs("button",{onClick:()=>I(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),s.jsx("button",{onClick:()=>k(),disabled:i||!n.trim(),className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-3 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation flex items-center justify-center gap-2",style:{WebkitTapHighlightColor:"transparent"},children:i?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," ..."]}):""})]})}),B&&G.length>0&&s.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-sm font-bold text-blue-700 flex items-center gap-2",children:[s.jsx("span",{children:"  "}),s.jsxs("span",{className:"bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full text-xs",children:[G.length,""]})]}),s.jsx("button",{onClick:()=>V(!q),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${q?"bg-blue-500 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:q?" ":" "})]}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:G.map((X,_e)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100",children:[s.jsxs("div",{className:"flex-1 cursor-pointer active:bg-gray-100 rounded-lg -m-1 p-1",onClick:()=>d(P0(X)),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:X.EQT_CL_NM||X.ITEM_NM||""}),s.jsx("span",{className:"text-xs text-gray-500 font-mono",children:X.EQT_SERNO||"-"})]}),s.jsxs("div",{className:"text-[10px] text-gray-400 mt-0.5",children:[X.EQT_STAT_CD_NM||X.EQT_USE_STAT_CD_NM||"",(()=>{const me=iy(X.EQT_LOC_NM);return me.id?`  ${me.name}(${me.id})`:X.WRKR_NM?`  ${X.WRKR_NM}`:""})()]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>d(P0(X)),className:"text-blue-500 hover:text-blue-700 p-1.5 hover:bg-blue-50 rounded-lg transition-colors",title:" ",children:s.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),s.jsx("button",{onClick:()=>$(_e),className:"text-red-400 hover:text-red-600 p-1.5 hover:bg-red-50 rounded-lg transition-colors",title:"",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},_e))})]}),B&&q&&G.length>0&&s.jsxs("div",{className:"bg-white rounded-xl border border-green-200 shadow-sm p-4",children:[s.jsxs("h3",{className:"text-sm font-bold text-green-700 mb-4 flex items-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"  "}),s.jsxs("span",{className:"bg-green-100 text-green-600 px-2 py-0.5 rounded-full text-xs",children:[G.length,""]})]}),s.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:G.map((X,_e)=>{const me=P0(X);return s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-all active:scale-[0.99]",onClick:()=>{d(me),V(!1)},children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsxs("span",{className:"bg-blue-500 text-white text-xs font-bold px-1.5 py-0.5 rounded flex-shrink-0",children:["#",_e+1]}),s.jsx("span",{className:"font-bold text-gray-800 text-sm truncate",children:me.EQT_CL_NM||me.ITEM_NM||""})]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[s.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-semibold whitespace-nowrap ${me.EQT_STAT_CD==="10"?"bg-green-100 text-green-700":me.EQT_STAT_CD==="20"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:me.EQT_STAT_CD_NM||"-"}),s.jsx("span",{className:"text-[10px] text-blue-500 whitespace-nowrap",children:""})]})]}),s.jsxs("div",{className:"space-y-1 text-xs",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:"S/N"}),s.jsx("span",{className:"font-mono text-gray-800 truncate",children:me.EQT_SERNO||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:"MAC"}),s.jsx("span",{className:"font-mono text-gray-700 truncate",children:me.MAC_ADDRESS||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:"No."}),s.jsx("span",{className:"font-mono text-gray-700 truncate",children:me.EQT_NO||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:me.EQT_LOC_TP_CD_NM||"-"}),me.EQT_LOC_NM&&s.jsxs("span",{className:"text-gray-500 ml-1 truncate",children:[" ",me.EQT_LOC_NM]})]})]})]},_e)})})]}),m&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"   "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"S/N  MAC  "})]})}),c&&!q&&s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-100",children:s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800 flex items-center gap-2",children:[s.jsx("span",{className:"text-blue-500",children:""}),"   "]})})}),s.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[s.jsx(H,{title:" "}),s.jsx(Q,{label:"",value:c.EQT_NO}),s.jsx(Q,{label:"(S/N)",value:c.EQT_SERNO}),s.jsx(Q,{label:"MAC ",value:c.MAC_ADDRESS}),s.jsx(H,{title:" "}),s.jsx(Q,{label:"",value:c.EQT_CL_NM||c.EQT_CL_CD}),s.jsx(Q,{label:"",value:c.EQT_TP_CD_NM||c.EQT_TP_CD}),s.jsx(Q,{label:"",value:c.ITEM_CD}),s.jsx(Q,{label:"",value:c.ITEM_NM}),s.jsx(Q,{label:"",value:c.MAKER}),s.jsx(Q,{label:"",value:c.MNFCT_DT}),s.jsxs("div",{className:"bg-amber-50 border-2 border-amber-400 rounded-lg p-3 -mx-4 my-3",children:[s.jsx("div",{className:"bg-gradient-to-r from-amber-100 to-amber-50 px-3 py-2 -mx-3 -mt-3 mb-2 border-b border-amber-200",children:s.jsxs("h4",{className:"text-xs font-bold text-amber-700 flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})," "]})}),s.jsxs("div",{className:"flex border-b border-amber-200 py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-amber-700 font-medium",children:""}),s.jsx("span",{className:"flex-1 text-xs text-gray-900 font-medium break-all",children:c.EQT_STAT_CD_NM||c.EQT_STAT_CD||"-"})]}),s.jsxs("div",{className:"flex border-b border-amber-200 py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-amber-700 font-medium",children:""}),s.jsx("span",{className:`flex-1 text-xs font-bold break-all ${c.EQT_USE_ARR_YN==="Y"?"text-green-600":c.EQT_USE_ARR_YN==="A"?"text-purple-600":c.EQT_USE_ARR_YN==="N"?"text-red-600":"text-gray-900"}`,children:c.EQT_USE_ARR_YN_NM||c.EQT_USE_ARR_YN||"-"})]}),s.jsxs("div",{className:"flex py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-amber-700 font-medium",children:""}),s.jsx("span",{className:"flex-1 text-xs text-gray-900 font-medium break-all",children:c.EQT_USE_END_DT||"-"})]})]}),s.jsx(H,{title:" "}),s.jsx(Q,{label:"",value:c.EQT_LOC_NM||c.EQT_LOC_TP_CD_NM}),s.jsx(Q,{label:"",value:c.OLD_EQT_LOC_NM||c.OLD_EQT_LOC_TP_CD_NM}),s.jsx(H,{title:"/"}),s.jsx(Q,{label:"",value:c.SO_NM||c.SO_ID}),s.jsx(Q,{label:"",value:c.CRR_NM||c.CRR_ID}),s.jsx(Q,{label:"",value:c.OLD_SO_NM||c.OLD_SO_ID}),s.jsx(Q,{label:"",value:c.OLD_CRR_NM||c.OLD_CRR_ID}),s.jsx(H,{title:" "}),s.jsx(Q,{label:"",value:(()=>{const X=iy(c.EQT_LOC_NM);return X.id?`${X.name} (${X.id})`:c.WRKR_NM?`${c.WRKR_NM} (${c.WRKR_ID})`:c.WRKR_ID||"-"})()}),s.jsx(Q,{label:"",value:(()=>{const X=iy(c.OLD_EQT_LOC_NM);return X.id?`${X.name} (${X.id})`:c.OLD_WRKR_NM?`${c.OLD_WRKR_NM} (${c.OLD_WRKR_ID})`:c.OLD_WRKR_ID||"-"})()}),s.jsx(H,{title:"/ "}),s.jsx(Q,{label:"ID",value:c.CUST_ID}),s.jsx(Q,{label:"",value:c.CUST_NM}),s.jsx(Q,{label:"ID",value:c.CTRT_ID}),s.jsx(H,{title:" "}),s.jsx(Q,{label:"",value:c.FIRST_IN_DT}),s.jsx(H,{title:"STB  "}),s.jsx(Q,{label:"CM MAC",value:c.STB_CM_MAC_ADDR}),s.jsx(Q,{label:"RTCA ID",value:c.STB_RTCA_ID}),s.jsx(H,{title:" "}),s.jsx(Q,{label:"",value:c.CHG_KND_CD_NM||c.CHG_KND_CD}),s.jsx(Q,{label:"",value:c.CHG_DATE}),s.jsx(Q,{label:"",value:c.CHG_UID_NM||c.CHG_UID})]})]}),u&&s.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 p-4",children:s.jsxs("details",{children:[s.jsx("summary",{className:"text-xs font-medium text-gray-600 cursor-pointer",children:"API   ()"}),s.jsx("pre",{className:"mt-2 text-xs text-gray-700 overflow-x-auto whitespace-pre-wrap bg-white p-3 rounded-lg border border-gray-100 max-h-48 overflow-y-auto",children:JSON.stringify(u,null,2)})]})}),!i&&!c&&!m&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"S/N  MAC   "})]})}),!c&&y.length>0&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("details",{children:[s.jsxs("summary",{className:"text-xs font-medium text-gray-700 cursor-pointer",children:["    (",y.length,")"]}),s.jsxs("div",{className:"mt-3 space-y-2 max-h-48 overflow-y-auto",children:[y.slice(0,20).map((X,_e)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg text-xs cursor-pointer hover:bg-blue-50 transition-colors active:scale-[0.99] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},onClick:()=>{r(X.EQT_SERNO||X.SERIAL_NO||X.MAC_ADDRESS||X.MAC||""),d(P0(X)),f({source:"    ",data:X})},children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-800",children:X.EQT_CL_NM||X.EQT_TP_CD||""}),s.jsx("span",{className:"ml-2 text-gray-500 font-mono",children:X.EQT_SERNO||X.SERIAL_NO||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs bg-gray-100 px-2 py-0.5 rounded",children:X.EQT_STAT_CD_NM||X.EQT_USE_STAT_CD||""})]},_e)),y.length>20&&s.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["...  ",y.length-20,""]})]})]})}),Y.length>0&&s.jsxs("div",{className:"bg-red-50 rounded-xl border border-red-200 shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-sm font-bold text-red-700 flex items-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"  "}),s.jsxs("span",{className:"bg-red-100 text-red-600 px-2 py-0.5 rounded-full text-xs",children:[Y.length,""]})]}),s.jsx("button",{onClick:()=>te([]),className:"text-xs text-red-500 hover:text-red-700",children:" "})]}),s.jsx("div",{className:"space-y-2 mb-4",children:Y.map((X,_e)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded-lg border border-red-100",children:[s.jsx("span",{className:"text-xs font-mono text-red-800",children:X}),s.jsx("span",{className:"text-xs text-red-500",children:""})]},_e))}),s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-100",children:[s.jsxs("p",{className:"text-xs text-gray-600 mb-3 text-center",children:["  .",s.jsx("br",{}),"     ."]}),s.jsxs("button",{onClick:fe,className:"w-full py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),J," "]})]})]}),s.jsx(Uf,{isOpen:F,onClose:ie,onScan:j,isMultiScanMode:B,scanCount:S}),U&&w.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"px-5 py-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-white rounded-t-2xl flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-800 flex items-center gap-2",children:[s.jsx("span",{className:"text-blue-500",children:""})," "]}),s.jsx("button",{onClick:()=>{L(!1),P([])},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[w.length,"  .  ."]})]}),s.jsx("div",{className:"p-4 space-y-3 overflow-y-auto flex-1",children:w.map((X,_e)=>{const me=P0(X),Z=(me.EQT_STAT_CD_NM||"").includes("")||(me.CHG_KND_CD_NM||"").includes(""),le=me.EQT_USE_ARR_YN==="Y"||(me.EQT_USE_ARR_YN_NM||"").includes("");return s.jsxs("div",{className:`p-4 rounded-xl border-2 cursor-pointer transition-all active:scale-[0.98] ${Z?"bg-red-50 border-red-200 hover:bg-red-100 hover:border-red-300":"bg-green-50 border-green-200 hover:bg-green-100 hover:border-green-300"}`,onClick:()=>{d(me),L(!1),P([]),f({source:"multiple_result_selection",data:me}),e==null||e(" .","success")},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${Z?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:Z?" ":" "}),s.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${le?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-600"}`,children:me.EQT_USE_ARR_YN_NM||(le?"":"")})]}),s.jsxs("span",{className:"text-xs text-gray-400",children:[_e+1,"/",w.length]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"font-bold text-gray-800 text-sm mb-1",children:me.EQT_CL_NM||me.ITEM_NM||""}),s.jsxs("div",{className:"text-xs text-gray-500",children:[me.ITEM_MODEL&&`: ${me.ITEM_MODEL}`,me.MAKER&&`  ${me.MAKER}`]})]}),s.jsxs("div",{className:"space-y-1.5 text-xs bg-white/60 rounded-lg p-2.5",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:"S/N"}),s.jsx("span",{className:"font-mono text-gray-800 font-medium",children:me.EQT_SERNO||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:`font-medium ${Z?"text-red-600":"text-green-600"}`,children:me.EQT_STAT_CD_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:`${me.EQT_TP_CD_NM===""?"text-orange-600":"text-gray-700"}`,children:me.EQT_TP_CD_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:me.EQT_LOC_NM||me.SO_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:`${Z?"text-red-600 font-medium":"text-gray-700"}`,children:me.CHG_KND_CD_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-600",children:me.CHG_DATE?me.CHG_DATE.split(" ")[0]:"-"})]})]}),s.jsx("div",{className:"flex justify-end mt-3",children:s.jsxs("span",{className:`text-xs flex items-center gap-1 px-3 py-1.5 rounded-lg ${Z?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:["  ",s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]},_e)})}),s.jsx("div",{className:"px-5 py-3 border-t border-gray-100 bg-gray-50 rounded-b-2xl flex-shrink-0",children:s.jsx("button",{onClick:()=>{L(!1),P([])},className:"w-full py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium text-sm transition-all",children:""})})]})})]})},HK=({onNavigateToMenu:t,showToast:e})=>{const[n,r]=x.useState("equipment-assignment"),i=[{id:"equipment-assignment",title:"",description:"    "},{id:"equipment-inquiry",title:"",description:"    /  / "},{id:"equipment-list",title:"",description:"S/N     "},{id:"equipment-movement",title:"",description:"    "},{id:"equipment-recovery",title:"",description:"   "}],l=c=>{r(c)};return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 z-40",children:s.jsx(CN,{tabs:i,activeTab:n,onTabChange:l})}),s.jsxs("div",{className:"flex-1 overflow-hidden",children:[s.jsx("div",{style:{display:n==="equipment-assignment"?"contents":"none"},children:s.jsx(EK,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-inquiry"?"contents":"none"},children:s.jsx(PK,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-list"?"contents":"none"},children:s.jsx($K,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-movement"?"contents":"none"},children:s.jsx(kK,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-recovery"?"contents":"none"},children:s.jsx(QK,{onBack:t,showToast:e})})]})]})},DT=[{id:"getEquipmentInfo",category:"-",name:"[]    ",path:"/work/equipment-info",description:"GET -     (workmanAssignManagement.getCustProdInfo)",params:[{name:"CTRT_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1},{name:"WRKR_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"BLD_ID",type:"string",required:!1},{name:"QUERY_TYPE",type:"string",required:!1}]},{id:"getCustProdInfo",category:"-",name:"[] /  ",path:"/customer/work/getCustProdInfo",description:"POST - /    (workmanAssignManagement.getCustProdInfo)",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"SO_ID",type:"string",required:!1},{name:"WORK_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"CRR_TSK_CL",type:"string",required:!1},{name:"WRK_DTL_TCD",type:"string",required:!1},{name:"CTRT_ID",type:"string",required:!1},{name:"requestType",type:"string",required:!1}]},{id:"equipmentWorkerTransfer",category:"-",name:"[]   ",path:"/equipment/worker-transfer",description:"POST -     (equipmentManager.changeEqtWrkr_3)",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1},{name:"EQT_NO",type:"string",required:!1},{name:"CRR_ID",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"eqtCmpsInfoChg",category:"-",name:"[]   ",path:"/customer/work/eqtCmpsInfoChg",description:"POST -     (workmanAssignManagement.eqtCmpsInfoChg)",params:[{name:"WRK_ID",type:"string",required:!1},{name:"RCPT_ID",type:"string",required:!1},{name:"CTRT_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"CRR_ID",type:"string",required:!1},{name:"WRKR_ID",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1},{name:"equipments",type:"array",required:!0,default:"[]"}]},{id:"signalCheck",category:"-",name:"[]   (Stub)",path:"/customer/work/signalCheck",description:"POST -   ( stub )",params:[{name:"CUST_ID",type:"string",required:!1},{name:"WRK_ID",type:"string",required:!1},{name:"CHECK_TYPE",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1}]},{id:"ensHistory",category:"-",name:"[] ENS  ",path:"/signal/ens-history",description:"GET - ENS    (sigtransManagement.getENSSendHist)",params:[{name:"CUST_ID",type:"string",required:!1},{name:"DEST_INFO",type:"string",required:!1},{name:"REG_DATE1",type:"string",required:!1},{name:"REG_DATE2",type:"string",required:!1},{name:"RSLT_DATE1",type:"string",required:!1},{name:"RSLT_DATE2",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1}]},{id:"checkStbServerConnection",category:"-",name:"[] STB   ",path:"/customer/work/checkStbServerConnection",description:"POST - STB     (workmanAssignManagement.checkStbServerConnection)",params:[{name:"REG_UID",type:"string",required:!1},{name:"CTRT_ID",type:"string",required:!1},{name:"WRK_ID",type:"string",required:!1},{name:"MSG_ID",type:"string",required:!1},{name:"STB_EQT_NO",type:"string",required:!1},{name:"MODEM_EQT_NO",type:"string",required:!1}]},{id:"getEquipmentNmListOfProd",category:"-",name:"[]   ",path:"/customer/receipt/contract/getEquipmentNmListOfProd",description:"POST -     (contract.getEquipmentNmListOfProd)",params:[{name:"CTRT_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1}]},{id:"getContractEqtList",category:"-",name:"[]   ",path:"/customer/receipt/contract/getContractEqtList",description:"POST -     (contract.getContractEqtList)",params:[{name:"CTRT_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1}]},{id:"getCustomerCtrtInfo",category:"-",name:"[]   ",path:"/customer/negociation/getCustomerCtrtInfo",description:"POST -     (commonCodeManagement.getCustomerCtrtInfo)",params:[{name:"CTRT_ID",type:"string",required:!0}]},{id:"getWorkReceiptList",category:"-",name:"[]   ",path:"/work/receipts",description:"GET -     (workmanAssignManagement.getWorkReceiptList)",params:[{name:"WRKR_ID",type:"string",required:!1},{name:"WORK_DT",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1}]},{id:"getWorkdrctnList",category:"-",name:"[]   ",path:"/work/directions",description:"GET -     (workmanAssignManagement.getWorkdrctnList)",params:[{name:"WRKR_ID",type:"string",required:!1},{name:"WORK_DT",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1}]},{id:"modWorkCancel",category:"-",name:"[]  ",path:"/work/cancel",description:"POST -    (workmanAssignManagement.modWorkCancel)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"CANCEL_REASON",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"modWorkComplete",category:"-",name:"[]  ",path:"/work/complete",description:"POST -    (workmanAssignManagement.modWorkComplete)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"COMPLETE_MEMO",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"modWorkDivision",category:"-",name:"[]  ",path:"/work/worker-adjustment",description:"POST -  / (workmanAssignManagement.modWorkDivision)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"FROM_WRKR_ID",type:"string",required:!0},{name:"TO_WRKR_ID",type:"string",required:!0},{name:"REG_UID",type:"string",required:!1}]},{id:"workCompleteWithParams",category:"-",name:"[]   ()",path:"/customer/work/workComplete",description:"POST -    with 7 parameters (workmanAssignManagement.modWorkComplete)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"COMPLETE_DT",type:"string",required:!1},{name:"COMPLETE_MEMO",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"getRsltSinho4Wrk",category:"-",name:"[]   ",path:"/work/result-signals",description:"POST -     (equipmentManager.getRsltSinho4Wrk_2)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1}]},{id:"saveInstallInfo",category:"-",name:"[]   ",path:"/customer/work/saveInstallInfo",description:"POST -    (workmanAssignManagement.modNetInfo)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"INSTALL_ADDR",type:"string",required:!1},{name:"INSTALL_MEMO",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"getEquipmentHistoryInfo",category:"-",name:"[]    (S/N, MAC)",path:"/statistics/equipment/getEquipmentHistoryInfo",description:"POST - S/N  MAC     (  )",params:[{name:"EQT_SERNO",type:"string",required:!1},{name:"MAC_ADDRESS",type:"string",required:!1}]},{id:"getEquipmentOutList",category:"-",name:"[]   ",path:"/customer/equipment/getEquipmentOutList",description:"POST - /    (  )",params:[{name:"FROM_OUT_REQ_DT",type:"string",required:!0,default:"20250101"},{name:"TO_OUT_REQ_DT",type:"string",required:!0,default:"20250131"},{name:"SO_ID",type:"string",required:!1},{name:"OUT_REQ_NO",type:"string",required:!1},{name:"PROC_STAT",type:"string",required:!1}]},{id:"checkEquipmentProc",category:"-",name:"[]     ",path:"/customer/equipment/getEquipmentProcYnCheck",description:"POST -       (  )",params:[{name:"OUT_REQ_NO",type:"string",required:!0}]},{id:"addEquipmentQuota",category:"-",name:"[]    ()",path:"/customer/equipment/addCorporationEquipmentQuota",description:"POST -     (  )",params:[{name:"OUT_REQ_NO",type:"string",required:!0},{name:"equipmentList",type:"array",required:!0,default:"[]"}]},{id:"getEquipmentReturnRequestList",category:"-",name:"[]     ()",path:"/customer/equipment/getEquipmentReturnRequestList",description:"POST -      (  )",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"SO_ID",type:"string",required:!1}]},{id:"checkEquipmentReturn",category:"-",name:"[]   ",path:"/customer/equipment/getEquipmentReturnRequestCheck",description:"POST -     (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0}]},{id:"addEquipmentReturnRequest",category:"-",name:"[]   ",path:"/customer/equipment/addEquipmentReturnRequest",description:"POST -     (  )",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"equipmentList",type:"array",required:!0,default:"[]"}]},{id:"getWorkerEquipmentList",category:"-",name:"[]    ",path:"/customer/equipment/getWrkrHaveEqtList",description:"POST -      (  )",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"SO_ID",type:"string",required:!1},{name:"ITEM_MID_CD",type:"string",required:!1},{name:"EQT_SERNO",type:"string",required:!1}]},{id:"changeEquipmentWorker",category:"-",name:"[]    ()",path:"/customer/equipment/changeEqtWrkr_3",description:"POST -     (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"FROM_WRKR_ID",type:"string",required:!0},{name:"TO_WRKR_ID",type:"string",required:!0}]},{id:"processEquipmentLoss",category:"-",name:"[]   ",path:"/customer/equipment/cmplEqtCustLossIndem",description:"POST -    (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"LOSS_REASON",type:"string",required:!1}]},{id:"setEquipmentCheckStandby",category:"-",name:"[]    ()",path:"/customer/equipment/setEquipmentChkStndByY",description:"POST -      (  )",params:[{name:"EQT_NO",type:"string",required:!0}]},{id:"getUnreturnedEquipmentList",category:"-",name:"[]   ",path:"/customer/work/getEquipLossInfo",description:"POST -     (  )",params:[{name:"FROM_DT",type:"string",required:!1},{name:"TO_DT",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"CUST_NM",type:"string",required:!1},{name:"EQT_SERNO",type:"string",required:!1}]},{id:"processEquipmentRecovery",category:"-",name:"[]    ",path:"/customer/work/modEquipLoss",description:"POST -      (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!0},{name:"WRK_ID",type:"string",required:!1}]},{id:"findUserList",category:"-",name:"[] () ",path:"/system/cm/getFindUsrList3",description:"POST - /ID   (  )",params:[{name:"USR_NM",type:"string",required:!1},{name:"USR_ID",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1}]},{id:"sendSmsNotification",category:"-",name:"[]   (ENS)",path:"/customer/sigtrans/saveENSSendHist",description:"POST -   (   ) (  )",params:[{name:"RECV_PHONE_NO",type:"string",required:!0},{name:"MSG_CONTENT",type:"string",required:!0},{name:"SEND_UID",type:"string",required:!0}]},{id:"changeEqtWrkrBatch",category:"-",name:"[]    ()",path:"/customer/equipment/changeEqtWrkr_3",description:"POST -       (  )",params:[{name:"FROM_WRKR_ID",type:"string",required:!0},{name:"TO_WRKR_ID",type:"string",required:!0},{name:"equipmentList",type:"array",required:!0,default:"[]"}]},{id:"getCodeDetail",category:"-",name:"[]  ",path:"/system/cm/getCodeDetail",description:"POST -      (  )",params:[{name:"GRP_CD",type:"string",required:!0,default:"EQT_STS"}]},{id:"getTodayWorkList",category:"-",name:"[]   ",path:"/customer/work/getTodayWorkList",description:"POST -      (  )",params:[{name:"WORK_DT",type:"string",required:!1},{name:"WRKR_ID",type:"string",required:!1}]}],zK=()=>{const[t,e]=x.useState(null),[n,r]=x.useState({}),[i,l]=x.useState([]),[c,d]=x.useState(null),[u,f]=x.useState(!1),[m,_]=x.useState(""),[y,g]=x.useState("");x.useEffect(()=>{const K=localStorage.getItem("apiExplorer_calls");if(K)try{l(JSON.parse(K))}catch(B){console.error("Failed to restore API calls",B)}},[]),x.useEffect(()=>{localStorage.setItem("apiExplorer_calls",JSON.stringify(i))},[i]),x.useEffect(()=>{if(t){const K={},B=localStorage.getItem("userInfo");let O=null;if(B)try{O=JSON.parse(B)}catch(S){console.error("Failed to parse userInfo",S)}t.params.forEach(S=>{if(S.default!==void 0&&(K[S.name]=S.default),O)switch(S.name){case"WRKR_ID":K[S.name]=O.workerId||"A20130708";break;case"SO_ID":case"MST_SO_ID":K[S.name]=O.soId||"";break;case"CRR_ID":K[S.name]=O.crrId||"";break;case"REG_UID":case"SEND_UID":K[S.name]=O.userId||O.workerId||"";break;case"USR_ID":K[S.name]=O.userId||"";break}}),r(K)}},[t]);const N=(K,B)=>{r(O=>({...O,[K]:B}))},C=async()=>{if(!t)return;const K=`${Date.now()}-${Math.random()}`,B=performance.now(),O={id:K,timestamp:new Date().toISOString(),method:"POST",url:t.path,params:{...n},response:null,error:null,duration:0,status:"pending"};l(S=>[O,...S]),d(O),f(!0);try{const S=await fetch(`/api${t.path}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),Y=performance.now()-B;if(!S.ok)throw new Error(`HTTP ${S.status}: ${S.statusText}`);const te=await S.json();l(J=>J.map(q=>q.id===K?{...q,response:te,duration:Math.round(Y),status:"success"}:q)),d({...O,response:te,duration:Math.round(Y),status:"success"})}catch(S){const Y=performance.now()-B;l(te=>te.map(J=>J.id===K?{...J,error:S.message,duration:Math.round(Y),status:"error"}:J)),d({...O,error:S.message,duration:Math.round(Y),status:"error"})}finally{f(!1)}},v=()=>{confirm(" API   ?")&&(l([]),d(null),localStorage.removeItem("apiExplorer_calls"))},R=()=>{if(!t)return;const K=localStorage.getItem("userInfo");let B=null;if(K)try{B=JSON.parse(K)}catch(S){console.error("Failed to parse userInfo",S)}const O={...n};t.params.forEach(S=>{if(!(O[S.name]&&O[S.name]!==""))switch(S.name){case"WORK_ID":case"WRK_ID":O[S.name]="W202501020001";break;case"RCPT_ID":O[S.name]="R202501020001";break;case"CTRT_ID":O[S.name]="C202501020001";break;case"WRK_DRCTN_ID":O[S.name]="D202501020001";break;case"EQT_NO":O[S.name]="EQ20250102001";break;case"EQT_SERNO":O[S.name]="SN20250102001";break;case"ITEM_MID_CD":O[S.name]="05";break;case"EQT_CL_CD":case"EQT_CL":O[S.name]="090401";break;case"MAC_ADDRESS":O[S.name]="00:11:22:33:44:55";break;case"CUST_ID":O[S.name]="CUST20250102001";break;case"CUST_NM":O[S.name]="";break;case"PHONE_NO":case"RECV_PHONE_NO":O[S.name]="010-1234-5678";break;case"WORK_DT":case"FROM_DT":case"TO_DT":const A=new Date().toISOString().slice(0,10).replace(/-/g,"");O[S.name]=A;break;case"WRK_STAT_CD":O[S.name]="2";break;case"EQT_USE_STAT_CD":O[S.name]="1";break;case"PROD_CD":O[S.name]="PROD001";break;case"SVC_CD":O[S.name]="SVC001";break;case"BLD_ID":O[S.name]="BLD20250102001";break;case"ADDR_ORD":O[S.name]="1";break;case"GRP_CD":O[S.name]="EQT_STS";break;case"USR_NM":O[S.name]="";break;case"MSG_CONTENT":O[S.name]=" .";break;case"LOSS_REASON":O[S.name]="";break}}),r(O)},U=()=>{const K=JSON.stringify(i,null,2),B="data:application/json;charset=utf-8,"+encodeURIComponent(K),O=`api-calls-${new Date().toISOString().slice(0,10)}.json`,S=document.createElement("a");S.setAttribute("href",B),S.setAttribute("download",O),S.click()},L=()=>{const K=["Timestamp","Method","URL","Status","Duration (ms)","Error"],B=i.map(te=>[te.timestamp,te.method,te.url,te.status,te.duration,te.error||""]),O=[K.join(","),...B.map(te=>te.map(J=>`"${J}"`).join(","))].join(`
`),S="data:text/csv;charset=utf-8,"+encodeURIComponent(O),A=`api-calls-${new Date().toISOString().slice(0,10)}.csv`,Y=document.createElement("a");Y.setAttribute("href",S),Y.setAttribute("download",A),Y.click()},w=DT.filter(K=>{const B=m===""||K.name.toLowerCase().includes(m.toLowerCase())||K.path.toLowerCase().includes(m.toLowerCase()),O=y===""||K.category===y;return B&&O}),P=["",...Array.from(new Set(DT.map(K=>K.category)))],G=i.filter(K=>m===""?!0:K.url.toLowerCase().includes(m.toLowerCase())||JSON.stringify(K.params).toLowerCase().includes(m.toLowerCase()));return s.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"API Explorer"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"D-Live   API  "})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"API "}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsx("select",{value:y,onChange:K=>g(K.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",children:P.map(K=>s.jsx("option",{value:K,children:K},K))})]}),s.jsx("div",{className:"mb-4",children:s.jsx("input",{type:"text",placeholder:"...",value:m,onChange:K=>_(K.target.value),className:"w-full border border-gray-300 rounded px-3 py-2"})}),s.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:w.map(K=>s.jsxs("button",{onClick:()=>e(K),className:`w-full text-left p-3 rounded border ${(t==null?void 0:t.id)===K.id?"bg-blue-50 border-blue-500":"bg-white border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("div",{className:"font-medium text-sm",children:K.name}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:K.path}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:K.category})]},K.id))})]})}),s.jsxs("div",{className:"lg:col-span-1",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:" "}),t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-medium text-lg",children:t.name}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description}),s.jsxs("code",{className:"block bg-gray-100 p-2 rounded mt-2 text-sm",children:["POST ",t.path]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-medium",children:""}),t.params.length>0&&s.jsx("button",{onClick:R,className:"text-xs bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200",children:"  "})]}),t.params.length>0?s.jsx("div",{className:"space-y-3",children:t.params.map(K=>{var B;return s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[K.name,K.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"}),s.jsxs("span",{className:"text-gray-400 ml-2 text-xs",children:["(",K.type,")"]})]}),s.jsx("input",{type:"text",value:n[K.name]||"",onChange:O=>N(K.name,O.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:((B=K.default)==null?void 0:B.toString())||""})]},K.name)})}):s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}),s.jsx("button",{onClick:C,disabled:u,className:"w-full bg-blue-600 text-white py-3 rounded font-medium hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:u?" ...":"API "})]}):s.jsx("p",{className:"text-gray-500 text-center py-8",children:" API  "})]}),c&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mt-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"font-medium",children:""}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${c.status==="success"?"bg-green-100 text-green-800":c.status==="error"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:c.status}),s.jsxs("span",{className:"text-xs text-gray-500",children:[c.duration,"ms"]})]})]}),c.error?s.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-3 text-red-700 text-sm",children:c.error}):c.response?s.jsx("div",{className:"bg-gray-50 rounded p-3 max-h-[400px] overflow-y-auto",children:s.jsx("pre",{className:"text-xs",children:JSON.stringify(c.response,null,2)})}):s.jsx("p",{className:"text-gray-500 text-sm",children:"  ..."})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:U,className:"text-xs bg-gray-200 px-2 py-1 rounded hover:bg-gray-300",disabled:i.length===0,children:"JSON"}),s.jsx("button",{onClick:L,className:"text-xs bg-gray-200 px-2 py-1 rounded hover:bg-gray-300",disabled:i.length===0,children:"CSV"}),s.jsx("button",{onClick:v,className:"text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",disabled:i.length===0,children:""})]})]}),s.jsx("div",{className:"space-y-2 max-h-[800px] overflow-y-auto",children:G.length>0?G.map(K=>s.jsxs("button",{onClick:()=>d(K),className:`w-full text-left p-3 rounded border ${(c==null?void 0:c.id)===K.id?"bg-blue-50 border-blue-500":"bg-white border-gray-300 hover:bg-gray-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:new Date(K.timestamp).toLocaleTimeString("ko-KR")}),s.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${K.status==="success"?"bg-green-100 text-green-800":K.status==="error"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:[K.duration,"ms"]})]}),s.jsx("div",{className:"text-sm font-medium truncate",children:K.url}),K.error&&s.jsx("div",{className:"text-xs text-red-600 truncate mt-1",children:K.error})]},K.id)):s.jsx("p",{className:"text-gray-500 text-center py-8 text-sm",children:"  "})})]})})]})]})})},qK=({onBack:t,userInfo:e,showToast:n})=>{const[r,i]=x.useState([]),[l,c]=x.useState(null),[d,u]=x.useState(!1),[f,m]=x.useState(null);x.useEffect(()=>{_()},[]);const _=async()=>{try{u(!0),m(null);const v=new Date,R=new Date;R.setMonth(v.getMonth()-1);const U={ENTR_NO:"",CTRT_ID:"",WORK_DT_FROM:R.toISOString().slice(0,10).replace(/-/g,""),WORK_DT_TO:v.toISOString().slice(0,10).replace(/-/g,""),WRKR_ID:(e==null?void 0:e.userId)||""},L=await e4(U);i(L),L.length>0&&c(L[0]),console.log(" LGU    :",L.length)}catch(v){console.error(" LGU    :",v),m("   .")}finally{u(!1)}},y=v=>{c(v)},g=()=>{n&&n("   .","info")},N=()=>{if(!l||!l.CONSREQNO){n&&n("     .","warning");return}n&&n("   .","info")},C=()=>{if(!l||!l.CONSREQNO){n&&n("     .","warning");return}n&&n("   .","info")};return s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 sm:mb-3 flex items-center justify-between gap-2",children:[s.jsx("div",{children:s.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-900",children:"(LGU) "})}),s.jsxs("button",{onClick:_,disabled:d,className:"flex items-center gap-1 px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-xs sm:text-sm text-gray-700 disabled:opacity-50",children:[s.jsx(uc,{className:`w-3.5 h-3.5 sm:w-4 sm:h-4 ${d?"animate-spin":""}`}),""]})]}),d?s.jsxs("div",{className:"text-center p-6 sm:p-10",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 sm:h-8 sm:w-8 border-4 border-orange-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-gray-600 text-sm sm:text-base",children:" ..."})]}):f?s.jsxs("div",{className:"text-center p-6 sm:p-10 bg-white rounded-lg shadow-sm border border-red-200",children:[s.jsx("p",{className:"text-red-500 text-sm sm:text-base",children:f}),s.jsx("button",{onClick:_,className:"mt-3 sm:mt-4 px-3 sm:px-4 py-1.5 sm:py-2 bg-orange-500 text-white text-sm rounded-lg hover:bg-orange-600",children:" "})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden mb-2 sm:mb-3",children:r.length>0?s.jsx("div",{className:"max-h-40 sm:max-h-48 overflow-y-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:"ID"}),s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""})]})}),s.jsx("tbody",{children:r.map((v,R)=>s.jsxs("tr",{onClick:()=>y(v),className:`cursor-pointer hover:bg-orange-50 transition-colors ${l===v?"bg-orange-100":""}`,children:[s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:v.CONSREQNO||"-"}),s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:v.CTRT_ID||"-"}),s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:v.CONSCHRRNM||"-"}),s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:v.CONSFNSHSCDLDT||"-"})]},R))})]})}):s.jsx("div",{className:"p-4 sm:p-6 text-center text-gray-500 text-xs sm:text-sm",children:"   "})}),l&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSREQNO||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSCHRRNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSCHRRTLNO||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("textarea",{value:l.CONSCHRRMAKRMKS||"",readOnly:!0,rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50 resize-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSFNSHSCDLDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSFNSHDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSNEEDDIVSNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSDLYRSNNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSIPSBPRSSDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSIPSBRSNNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:l.CONSNREQPRSSDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("textarea",{value:l.CONSNREQRSNNM||"",readOnly:!0,rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50 resize-none"})]})]}),s.jsxs("div",{className:"mt-3 sm:mt-4 grid grid-cols-3 gap-1.5 sm:gap-2",children:[s.jsx("button",{onClick:g,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""}),s.jsx("button",{onClick:N,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""}),s.jsx("button",{onClick:C,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""})]})]})]})},$0={WORK_FILTERS:"dlive_work_filters",WORK_SELECTED_ORDER:"dlive_work_selected_order",WORK_SELECTED_DIRECTION:"dlive_work_selected_direction",WORK_FORM_DATA:"dlive_work_form_data",ACTIVE_TAB:"dlive_active_tab",ACTIVE_VIEW:"dlive_active_view",LGU_CONSTRUCTION_FORM:"dlive_lgu_construction_form",LGU_NETWORK_FAULT_FORM:"dlive_lgu_network_fault_form",SIGNAL_HISTORY_FILTERS:"dlive_signal_history_filters",WORK_RESULT_SIGNAL_FILTERS:"dlive_work_result_signal_filters",WORK_PROCESS_STEP:"dlive_work_process_step",WORK_PROCESS_EQUIPMENT:"dlive_work_process_equipment"},XK=(t,e)=>{try{typeof window<"u"&&localStorage.setItem(t,JSON.stringify(e))}catch(n){console.error("  :",n)}},JK=t=>{try{if(typeof window<"u"){const e=localStorage.getItem(t);return e?JSON.parse(e):null}return null}catch(e){return console.error("  :",e),null}},RT=t=>{try{typeof window<"u"&&localStorage.removeItem(t)}catch(e){console.error("  :",e)}},ZK=()=>{try{if(typeof window<"u"){Object.values($0).forEach(n=>{localStorage.removeItem(n)});const t=["dlive-work-equipment-storage","dlive-work-process-storage","dlive-equipment-storage","dlive-ui-storage"];t.forEach(n=>{localStorage.removeItem(n)});const e=[];for(let n=0;n<localStorage.length;n++){const r=localStorage.key(n);r&&(r.startsWith("work_complete_draft_")||r.startsWith("equipment_draft_"))&&e.push(r)}e.forEach(n=>{localStorage.removeItem(n)}),console.log("[clearAllSessions]  :",{sessionKeys:Object.values($0).length,zustandKeys:t.length,draftKeys:e.length})}}catch(t){console.error("   :",t)}},eQ=({onBack:t,userInfo:e,showToast:n})=>{const r=JK($0.LGU_NETWORK_FAULT_FORM),[i,l]=x.useState({CTRT_ID:(r==null?void 0:r.CTRT_ID)||"",CUST_ID:(r==null?void 0:r.CUST_ID)||"",WRK_ID:(r==null?void 0:r.WRK_ID)||"",CANCEL_TYPE:(r==null?void 0:r.CANCEL_TYPE)||""}),[c,d]=x.useState(!1),[u,f]=x.useState(null);x.useEffect(()=>{XK($0.LGU_NETWORK_FAULT_FORM,i)},[i]);const m=(y,g)=>{l(N=>({...N,[y]:g}))},_=async y=>{if(y.preventDefault(),!i.CTRT_ID||!i.CUST_ID||!i.WRK_ID){n&&n("   .","warning");return}d(!0),f(null);try{const g={...i,CRR_ID:(e==null?void 0:e.crrId)||"01",SO_ID:(e==null?void 0:e.soId)||"",REG_UID:(e==null?void 0:e.userId)||"mobile_user"},N=await o5(g);console.log(" LGU   :",N),f({success:!0,data:N}),n&&n("LGU   .","success"),l({CTRT_ID:"",CUST_ID:"",WRK_ID:"",CANCEL_TYPE:""}),RT($0.LGU_NETWORK_FAULT_FORM)}catch(g){console.error(" LGU   :",g),f({success:!1,error:g.message}),n&&n(`LGU   : ${g.message}`,"error")}finally{d(!1)}};return s.jsxs("div",{children:[s.jsx("div",{className:"mb-2 sm:mb-3",children:s.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-900",children:"(LGU) "})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4",children:s.jsxs("form",{onSubmit:_,className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:[" ID ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i.CTRT_ID,onChange:y=>m("CTRT_ID",y.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:" ID ",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:[" ID ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i.CUST_ID,onChange:y=>m("CUST_ID",y.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:" ID ",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:[" ID ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i.WRK_ID,onChange:y=>m("WRK_ID",y.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:" ID ",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("input",{type:"text",value:i.CANCEL_TYPE,onChange:y=>m("CANCEL_TYPE",y.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"  ()"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2 mt-3 sm:mt-4",children:[s.jsx("button",{type:"submit",disabled:c,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c?" ...":" "}),s.jsx("button",{type:"button",onClick:()=>{l({CTRT_ID:"",CUST_ID:"",WRK_ID:"",CANCEL_TYPE:""}),f(null),RT($0.LGU_NETWORK_FAULT_FORM)},className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""})]})]})}),u&&s.jsxs("div",{className:"mt-2 sm:mt-3 bg-white rounded-lg shadow-sm border border-gray-200 p-2.5 sm:p-3",children:[s.jsx("div",{className:"mb-1.5 sm:mb-2",children:s.jsx("span",{className:`text-xs sm:text-sm font-semibold flex items-center gap-1 ${u.success?"text-green-600":"text-red-600"}`,children:u.success?s.jsxs(s.Fragment,{children:[s.jsx(Vi,{size:14,className:"sm:w-4 sm:h-4"}),"  "]}):s.jsxs(s.Fragment,{children:[s.jsx(Wr,{size:14,className:"sm:w-4 sm:h-4"}),"  "]})})}),s.jsx("div",{className:"bg-gray-50 rounded p-1.5 sm:p-2",children:s.jsx("pre",{className:"text-xs text-gray-700 overflow-x-auto whitespace-pre-wrap break-words",children:JSON.stringify(u.success?u.data:u.error,null,2)})})]})]})},tQ=({onNavigateToMenu:t,userInfo:e,showToast:n})=>{const[r,i]=x.useState("time-request"),l=Gi.useRef(null),c=Gi.useRef([]),d=[{id:"time-request",title:""},{id:"time-record",title:""},{id:"notice",title:""},{id:"signal-interlock",title:""},{id:"lgu-construction",title:"(LGU)"},{id:"lgu-network-fault",title:"(LGU)"},{id:"auto-confirm",title:""}],u=f=>{i(f),setTimeout(()=>{const _=l.current,y=c.current[d.findIndex(g=>g.id===f)];if(_&&y){const g=_.getBoundingClientRect(),N=y.getBoundingClientRect(),C=N.left-g.left-g.width/2+N.width/2;_.scrollTo({left:_.scrollLeft+C,behavior:"smooth"})}},0)};return s.jsx("div",{className:"w-full",children:s.jsxs(Fj,{value:r,onValueChange:u,className:"w-full",children:[s.jsx("div",{className:"bg-white border-b border-gray-200",children:s.jsx("div",{ref:l,className:"w-full overflow-x-auto scrollbar-hide",children:s.jsx(_N,{className:"inline-flex justify-start bg-white rounded-none h-auto py-2 px-3 border-none min-w-max overflow-visible",children:d.map((f,m)=>s.jsx(xN,{value:f.id,ref:_=>c.current[m]=_,className:"data-[state=active]:bg-blue-500 data-[state=active]:text-white data-[state=inactive]:text-gray-600 rounded-full px-4 py-2 text-sm font-medium flex-shrink-0 mx-1 transition-colors whitespace-nowrap",children:f.title},f.id))})})}),s.jsx(Ql,{value:"time-request",className:"px-3 pt-1",children:s.jsx(Fm,{onNavigateToMenu:t,title:"",description:"    ."})}),s.jsx(Ql,{value:"time-record",className:"px-3 pt-1",children:s.jsx(Fm,{onNavigateToMenu:t,title:"",description:"     ."})}),s.jsx(Ql,{value:"notice",className:"px-3 pt-1",children:s.jsx(Fm,{onNavigateToMenu:t,title:"",description:"   ."})}),s.jsx(Ql,{value:"signal-interlock",className:"px-3 pt-1",children:s.jsx(A5,{onBack:t,userInfo:e,showToast:n})}),s.jsx(Ql,{value:"lgu-construction",className:"px-3 pt-1",children:s.jsx(qK,{onBack:t,userInfo:e,showToast:n})}),s.jsx(Ql,{value:"lgu-network-fault",className:"px-3 pt-1",children:s.jsx(eQ,{onBack:t,userInfo:e,showToast:n})}),s.jsx(Ql,{value:"auto-confirm",className:"px-3 pt-1",children:s.jsx(Fm,{onNavigateToMenu:t,title:"",description:"   ."})})]})})},sQ=[{key:"small",label:"",size:"14px",preview:"text-xs"},{key:"medium",label:"",size:"16px",preview:"text-sm"},{key:"large",label:"",size:"18px",preview:"text-base"},{key:"xlarge",label:" ",size:"20px",preview:"text-lg"}],nQ=({onBack:t})=>{const{fontScale:e,setFontScale:n}=Yl();return s.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[s.jsxs("div",{className:"bg-white border-b px-4 py-3 flex items-center gap-3",children:[s.jsx("button",{onClick:t,className:"p-1 -ml-1",children:s.jsx(t5,{className:"w-5 h-5 text-gray-600"})}),s.jsx("h1",{className:"font-bold text-base",children:""})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[s.jsx("h2",{className:"font-semibold text-sm text-gray-800 mb-3",children:" "}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:sQ.map(r=>s.jsxs("button",{onClick:()=>n(r.key),className:`flex flex-col items-center justify-center py-3 px-2 rounded-lg border-2 transition-all ${e===r.key?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("span",{className:`font-bold mb-1 ${e===r.key?"text-blue-600":"text-gray-700"}`,style:{fontSize:r.size},children:""}),s.jsx("span",{className:`text-xs ${e===r.key?"text-blue-600 font-semibold":"text-gray-500"}`,children:r.label})]},r.key))}),s.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"  .     ."})]})})]})},rQ="/shuild.png",UI="notice_popup_dismissed",iQ=()=>{try{return localStorage.getItem(UI)}catch{return null}},aQ=()=>{try{const t=new Date().toISOString().split("T")[0];localStorage.setItem(UI,t)}catch{}},lQ=()=>{const t=iQ();if(!t)return!0;const e=new Date().toISOString().split("T")[0];return t!==e},oQ=({isOpen:t,onClose:e})=>{const[n,r]=x.useState(!1);if(x.useEffect(()=>{t&&r(!1)},[t]),!t)return null;const i=()=>{n&&aQ(),e()},l=c=>{c.target===c.currentTarget&&i()};return s.jsx("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.75)"},onClick:l,children:s.jsxs("div",{className:"relative w-full max-w-md",children:[s.jsx("button",{onClick:i,className:"absolute -top-12 right-0 p-2 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-sm transition-all z-10",children:s.jsx(bi,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"relative rounded-2xl overflow-hidden shadow-2xl bg-white",children:s.jsx("img",{src:rQ,alt:"  ",className:"w-full h-auto"})}),s.jsxs("div",{className:"mt-4 flex items-center justify-between px-1",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:n,onChange:c=>r(c.target.checked),className:"w-4 h-4 rounded border-white/50 bg-white/20 text-blue-500 focus:ring-0"}),s.jsx("span",{className:"text-sm text-white/90",children:"   "})]}),s.jsx("button",{onClick:i,className:"px-5 py-2 bg-white/20 hover:bg-white/30 text-white text-sm font-semibold rounded-full transition-all backdrop-blur-sm",children:""})]})]})})},cQ={"today-work":null,menu:"today-work","work-management":"today-work","work-item-list":"work-management","work-order-detail":"work-item-list","work-process-flow":"work-item-list","work-complete-form":"work-order-detail","work-complete-detail":"work-item-list","customer-management":"today-work","equipment-management":"today-work","other-management":"today-work","api-explorer":"today-work","coming-soon":"today-work",settings:"today-work"},dQ=()=>{const[t,e]=x.useState(!1),[n,r]=x.useState(null),[i,l]=x.useState(null),[c,d]=x.useState(""),[u,f]=x.useState(!1),[m,_]=x.useState({todayInProgress:0,todayCompleted:0,weekTotal:0,monthTotal:0}),{isDrawerOpen:y,openDrawer:g,closeDrawer:N,currentView:C,setCurrentView:v,setWorkFilters:R,selectedWorkItem:U,setSelectedWorkItem:L,selectedWorkDirection:w,setSelectedWorkDirection:P,fontScale:G}=Yl();x.useEffect(()=>{const V={small:"14px",medium:"16px",large:"18px",xlarge:"20px"};document.documentElement.style.fontSize=V[G]||"16px"},[G]),x.useEffect(()=>{const V=I=>{console.error("Unhandled Promise Rejection:",I.reason),A("   .","error")},F=I=>{console.error("Global Error:",I.error)};return window.addEventListener("unhandledrejection",V),window.addEventListener("error",F),()=>{window.removeEventListener("unhandledrejection",V),window.removeEventListener("error",F)}},[]);const K=(V,F,I,ee,ae,T,j,k,Q)=>{if(e(!0),v("today-work"),V){const $={userId:V,userName:F||"",userNameEn:I||F||"",userRole:ee||"",crrId:ae,soId:T,mstSoId:j,telNo2:k,authSoList:Q||[]};r($),localStorage.setItem("userInfo",JSON.stringify($)),sessionStorage.setItem("userInfo",JSON.stringify($)),localStorage.setItem("user",JSON.stringify({USR_ID:V,WRKR_ID:V,userId:V,soId:T,SO_ID:T,AUTH_SO_List:Q||[]})),Q&&Q.length>0&&localStorage.setItem("branchList",JSON.stringify(Q))}const H=new Date().toISOString().split("T")[0];R({startDate:H,endDate:H,filter:""}),lQ()&&f(!0)},B=()=>{e(!1),r(null),localStorage.removeItem("userInfo"),localStorage.removeItem("user"),localStorage.removeItem("branchList"),ZK(),L(null),P(null),v("today-work"),uv.clear()},O=()=>{v("today-work")},S=V=>{d(V),v("coming-soon")},A=x.useCallback((V,F="info",I=!1)=>{l({message:V,type:F,persistent:I})},[]),Y=(V,F)=>{if(v(V),F)switch(V){case"work-order-detail":case"work-process-flow":case"work-complete-form":case"work-complete-detail":L(F);break;case"work-item-list":P(F);break}},te=()=>{const V=cQ[C];V&&v(V)};if(!t)return s.jsx(AU,{onLogin:K});const J=()=>{switch(C){case"today-work":return s.jsx(KU,{onNavigateToView:Y,onNavigateToComingSoon:S,userInfo:n,showToast:A});case"menu":return s.jsx(qD,{onSelectMenu:Y});case"work-management":return s.jsx(OU,{onNavigateToMenu:O,onNavigateToView:Y,userInfo:n,showToast:A});case"work-order-detail":return U?s.jsx(N5,{order:U,onBack:te,onStartWorkProcess:V=>{L(V),v("work-process-flow")},onComplete:V=>{L(V),v("work-process-flow")},showToast:A},U.id):s.jsx("div",{children:"     ."});case"work-process-flow":return U?s.jsx(g9,{workItem:U,onComplete:()=>{A("  .","success"),v("work-item-list")},onBack:te,showToast:A}):s.jsx("div",{children:"    ."});case"work-complete-form":return U?s.jsx(j_,{order:U,onBack:te,onSuccess:()=>{A("  .","success"),v("work-item-list")},showToast:A}):s.jsx("div",{children:"    ."});case"work-complete-detail":return U?s.jsx(FU,{order:U,onBack:()=>{L(null),v("work-item-list")}}):s.jsx("div",{children:"    ."});case"work-item-list":return w?s.jsx(L5,{direction:w,onBack:te,onNavigateToView:Y,userId:n==null?void 0:n.userId,showToast:A}):s.jsx("div",{children:"    ."});case"customer-management":return null;case"equipment-management":return null;case"api-explorer":return s.jsx(zK,{});case"other-management":return s.jsx(tQ,{onNavigateToMenu:O,userInfo:n,showToast:A});case"settings":return s.jsx(nQ,{onBack:te});case"coming-soon":return s.jsx(Fm,{onNavigateToMenu:O,title:c});default:return s.jsx(qD,{onSelectMenu:Y})}},q=V=>{switch(V){case"today-work":Y("today-work");break;case"work-management":Y("work-management");break;case"customer-management":Y("customer-management");break;case"equipment-management":Y("equipment-management");break;case"other-management":Y("other-management");break;default:Y("today-work")}};return s.jsxs(OM,{client:uv,children:[s.jsx(x9,{children:s.jsxs("div",{className:"h-[100dvh] bg-white font-sans overflow-hidden flex flex-col",children:[s.jsx(_9,{isOpen:y,onClose:N,userName:n==null?void 0:n.userName,userId:n==null?void 0:n.userId,stats:m,onLogout:B,onNavigate:q}),s.jsx(Yw,{onLogout:B,onNavigateHome:O,onNavigateBack:te,onMenuClick:g,currentView:C,userInfo:n,selectedWorkItem:U}),s.jsxs("main",{className:"flex-1 w-full max-w-7xl mx-auto pt-12 pb-[calc(52px+env(safe-area-inset-bottom,0px))] flex flex-col overflow-hidden",children:[J(),s.jsx("div",{style:{display:C==="customer-management"?"contents":"none"},children:s.jsx(CK,{onNavigateToMenu:O,showToast:A})}),s.jsx("div",{style:{display:C==="equipment-management"?"contents":"none"},children:s.jsx(HK,{onNavigateToMenu:O,showToast:A})})]}),s.jsx(UU,{currentView:C,onSelectMenu:Y}),i&&s.jsx(p9,{message:i.message,type:i.type,persistent:i.persistent,onClose:()=>l(null)}),s.jsx(oQ,{isOpen:u,onClose:()=>f(!1)})]})}),s.jsx($M,{initialIsOpen:!1})]})},TT=500;let H0=[],BI=!0;const uQ=t=>{const e={...t,id:`log_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString()};return H0.unshift(e),H0.length>TT&&(H0=H0.slice(0,TT)),BI&&gQ(e),typeof window<"u"&&window.dispatchEvent(new CustomEvent("api-log-added",{detail:e})),e},hQ=()=>[...H0],fQ=()=>{H0=[]},mQ=t=>{BI=t},gQ=t=>{const e={success:"",error:"",timeout:""}[t.status],n={success:"color: #10B981",error:"color: #EF4444",timeout:"color: #F59E0B"}[t.status];console.group(`%c${e} [${t.method}] ${t.api} (${t.duration}ms)`,`font-weight: bold; ${n}`),console.log("%c Request:","color: #3B82F6; font-weight: bold"),console.table(t.request),t.status==="success"?(console.log("%c Response:","color: #10B981; font-weight: bold"),Array.isArray(t.response)?(console.log(`Array[${t.response.length}]`),t.response.length>0&&(console.log("First item fields:",Object.keys(t.response[0])),console.table(t.response.slice(0,3)))):typeof t.response=="object"?console.table(t.response):console.log(t.response)):console.log("%c Error:","color: #EF4444; font-weight: bold",t.error),console.groupEnd()},WI=[{name:"",api:"/customer/equipment/getEquipmentOutList",method:"POST",params:{WRKR_ID:"20230019"},expectedFields:["EQT_NO","EQT_TYPE","SERIAL_NO","WRKR_ID"],description:"   "},{name:"",api:"/customer/equipment/getEquipmentProcYnCheck",method:"POST",params:{WRKR_ID:"20230019",SO_ID:"SO001",EQT_NO:"EQT001"},expectedFields:["PROC_YN","EQT_NO"],description:"    "},{name:"",api:"/customer/equipment/addCorporationEquipmentQuota",method:"POST",params:{SO_ID:"SO001",EQT_NO:"EQT001",CARRIER_ID:"CRR001",WRKR_ID:"20230019"},expectedFields:["RESULT","MESSAGE"],description:"    ()"},{name:"",api:"/customer/equipment/getEquipmentReturnRequestList",method:"POST",params:{WRKR_ID:"20230019"},expectedFields:["REQUEST_ID","EQT_NO","STATUS"],description:"  "},{name:"",api:"/customer/equipment/getEquipmentReturnRequestCheck",method:"POST",params:{WRKR_ID:"20230019",SO_ID:"SO001",EQT_NO:"EQT001"},expectedFields:["RETURN_YN"],description:"     "},{name:"",api:"/customer/equipment/addEquipmentReturnRequest",method:"POST",params:{EQT_NO:"EQT001",WRKR_ID:"20230019"},expectedFields:["RESULT","REQUEST_ID"],description:"   "},{name:"",api:"/customer/equipment/getWrkrHaveEqtList",method:"POST",params:{WRKR_ID:"20230019"},expectedFields:["EQT_NO","EQT_TYPE","SERIAL_NO","STATUS"],description:"   "},{name:"",api:"/customer/equipment/cmplEqtCustLossIndem",method:"POST",params:{EQT_NO:"EQT001"},expectedFields:["RESULT","INDEM_AMOUNT"],description:"   "},{name:"()",api:"/customer/equipment/setEquipmentChkStndByY",method:"POST",params:{EQT_NO:"EQT001",WRKR_ID:"20230019"},expectedFields:["RESULT","NEW_STATUS"],description:"  "},{name:"",api:"/statistics/equipment/getEquipmentHistoryInfo",method:"POST",params:{EQT_NO:"EQT001"},expectedFields:["HIST_ID","HIST_TYPE","HIST_DATE"],description:"  "},{name:"",api:"/customer/equipment/changeEqtWrkr_3_ForM",method:"POST",params:{EQT_NO:"EQT001",TO_WRKR_ID:"20230020"},expectedFields:["MSGCODE","MESSAGE","MV_WRKR_ID"],description:"    (Map  )"},{name:"",api:"/system/cm/getFindUsrList3",method:"POST",params:{USR_NM:""},expectedFields:["USR_ID","USR_NM","MOBILE"],description:" "},{name:"",api:"/customer/sigtrans/saveENSSendHist",method:"POST",params:{EQT_NO:"EQT001",TO_WRKR_ID:"20230020",FROM_WRKR_ID:"20230019"},expectedFields:["RESULT","ENS_ID"],description:"   "},{name:"",api:"/customer/work/getEquipLossInfo",method:"POST",params:{},expectedFields:["LOSS_ID","EQT_NO","STATE"],description:"/  "},{name:"",api:"/customer/work/modEquipLoss",method:"POST",params:{EQT_NO:"EQT001",STATE:"Recovered"},expectedFields:["RESULT","NEW_STATE"],description:"   "},{name:"",api:"/customer/work/getCustProdInfo",method:"POST",params:{WRKR_ID:"20230019",EQT_SEL:"0",EQT_CL:"ALL"},expectedFields:["output1","output2","output3"],description:" 3  "},{name:"",api:"/customer/work/eqtCmpsInfoChg",method:"POST",params:{WRK_ID:"WRK001",parameters:[]},expectedFields:["RESULT"],description:"    "},{name:"",api:"/customer/work/signalCheck",method:"POST",params:{serialNo:"TEST001",equipmentType:"modem"},expectedFields:["status","message"],description:"/STB  "},{name:"",api:"/customer/receipt/contract/getEquipmentNmListOfProd",method:"POST",params:{PROD_CD:"PROD001"},expectedFields:["EQT_CL_CD","EQT_CL_NM"],description:"    "},{name:"",api:"/customer/receipt/contract/getContractEqtList",method:"POST",params:{CTRT_ID:"CTRT001",PROD_CD:"PROD001"},expectedFields:["SVC_CMPS_ID","EQT_NO"],description:"  "}],pQ={"/customer/equipment/getWrkrHaveEqtList":[{param:"EQT_STAT_CD",values:["10","3","20","30","Assigned","Available","Lost"],description:"   ( vs )"},{param:"ITEM_MID_CD",values:["04","05","07","03","4","5","MODEM","STB"],description:"  (04:, 05:STB)"},{param:"EQT_SEL",values:["0","1","Y","N","ALL"],description:"  "},{param:"EQT_CL",values:["ALL","MODEM","STB","04","05"],description:" "}],"/customer/equipment/getEquipmentOutList":[{param:"OUT_STAT",values:["Y","N","1","0","OUT","IN"],description:" "},{param:"SEARCH_TYPE",values:["1","2","3","A","B","ALL"],description:" "}],"/customer/work/getCustProdInfo":[{param:"EQT_SEL",values:["0","1","2","Y","N"],description:"  "},{param:"EQT_CL",values:["ALL","04","05","MODEM","STB","1","2"],description:"  "},{param:"CRR_TSK_CL",values:["01","05","07","09","11","1","5","7","9"],description:"  (01:, 05:, 07:, 09:AS)"}],"/system/cm/getFindUsrList3":[{param:"SEARCH_TYPE",values:["1","2","3","NM","ID","ALL"],description:" "},{param:"USR_TYPE",values:["W","M","A","Worker","Manager","1","2"],description:" "}]},_Q=async(t,e,n,r)=>{const i={api:t,workingParams:[],failedParams:[],discoveredFields:[],notes:[]};console.group(`%c  : ${t}`,"font-weight: bold; color: #8B5CF6"),console.log(" :",e),console.log(" :",n.length," ");try{const l=await ET(r+t,"POST",e);l.success&&(i.workingParams.push({...e,_note:" "}),i.discoveredFields=l.fields,i.notes.push("    "))}catch{i.notes.push("   ")}for(const l of n){console.log(`
: ${l.param} - ${l.description}`);for(const c of l.values){const d={...e,[l.param]:c};try{const u=await ET(r+t,"POST",d);u.success?(console.log(`   ${l.param}=${c}   (${u.fields.length} fields)`),i.workingParams.push({...d,_note:`${l.param}=${c} `}),u.fields.forEach(f=>{i.discoveredFields.includes(f)||(i.discoveredFields.push(f),i.notes.push(`   : ${f} (${l.param}=${c})`))})):(console.log(`   ${l.param}=${c}  `),i.failedParams.push({...d,_error:u.error}))}catch{console.log(`   ${l.param}=${c}  `)}await new Promise(u=>setTimeout(u,100))}}return console.groupEnd(),i},ET=async(t,e,n)=>{try{const r=await fetch(t,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!r.ok)return{success:!1,fields:[],error:`HTTP ${r.status}`};const i=await r.json();let l=[];return Array.isArray(i)&&i.length>0?l=Object.keys(i[0]):typeof i=="object"&&i!==null&&(l=Object.keys(i)),i.code==="ERROR"||i.error||i.RESULT==="FAIL"?{success:!1,fields:l,error:i.message||i.error}:{success:!0,fields:l}}catch(r){return{success:!1,fields:[],error:r.message}}},xQ=async(t,e=WI,n=1e4)=>{const r=Date.now();console.clear(),console.log("%c D'Live  API   ","font-size: 20px; font-weight: bold; color: #3B82F6"),console.log(` : ${new Date().toLocaleString()}`),console.log(`API Base: ${t}`),console.log(` : ${e.length}`),console.log("".repeat(60));const i=[];for(let m=0;m<e.length;m++){const _=e[m],y=`[${m+1}/${e.length}]`;console.log(`
${y} : ${_.name}`),console.log(`  API: ${_.api}`),console.log("  Params:",_.params);const g=Date.now();try{const N=new AbortController,C=setTimeout(()=>N.abort(),n),v=await fetch(t+_.api,{method:_.method,headers:{"Content-Type":"application/json"},body:_.method==="POST"?JSON.stringify(_.params):void 0,credentials:"include",signal:N.signal});clearTimeout(C);const R=Date.now()-g;if(!v.ok){console.log(`   HTTP Error: ${v.status}`),i.push({name:_.name,api:_.api,status:"error",duration:R,error:`HTTP ${v.status}`});continue}const U=await v.json();let L=[];if(Array.isArray(U)&&U.length>0?(L=Object.keys(U[0]),console.log(`    (${R}ms) - Array[${U.length}]`),console.log(`   : ${L.join(", ")}`)):U.output1||U.output2?(L=Object.keys(U),console.log(`    (${R}ms) - Multi-output`),Object.keys(U).forEach(w=>{Array.isArray(U[w])&&console.log(`    ${w}: Array[${U[w].length}]`)})):typeof U=="object"&&(L=Object.keys(U),console.log(`    (${R}ms)`),console.log(`   : ${L.join(", ")}`)),_.expectedFields){const w=_.expectedFields.filter(P=>!L.includes(P));w.length>0&&console.log(`     : ${w.join(", ")}`)}i.push({name:_.name,api:_.api,status:"success",duration:R,responseFields:L})}catch(N){const C=Date.now()-g;N.name==="AbortError"?(console.log(`    (${n}ms)`),i.push({name:_.name,api:_.api,status:"timeout",duration:C,error:"Timeout"})):(console.log(`   : ${N.message}`),i.push({name:_.name,api:_.api,status:"error",duration:C,error:N.message}))}await new Promise(N=>setTimeout(N,200))}const l=i.filter(m=>m.status==="success").length,c=i.filter(m=>m.status==="error").length,d=i.filter(m=>m.status==="timeout").length,u=Date.now()-r;console.log(`
`+"".repeat(60)),console.log("%c   ","font-size: 16px; font-weight: bold"),console.log("".repeat(60)),console.log(` API: ${e.length}`),console.log(`%c : ${l}`,"color: #10B981"),console.log(`%c : ${c}`,"color: #EF4444"),console.log(`%c : ${d}`,"color: #F59E0B"),console.log(` : ${(u/1e3).toFixed(1)}`),console.log("".repeat(60)),(c>0||d>0)&&(console.log(`
%c   API:`,"font-weight: bold; color: #F59E0B"),i.filter(m=>m.status!=="success").forEach(m=>{console.log(`  - ${m.name}: ${m.error||m.status}`)})),console.log(`
%c   :`,"font-weight: bold; color: #3B82F6"),i.filter(m=>m.status==="success"&&m.responseFields).forEach(m=>{var _;console.log(`  ${m.name}: ${(_=m.responseFields)==null?void 0:_.join(", ")}`)});const f={timestamp:new Date().toISOString(),totalApis:e.length,successCount:l,failCount:c,timeoutCount:d,results:i,summary:`${l}/${e.length} APIs working (${c} failed, ${d} timeout)`};return typeof window<"u"&&(window.__lastApiCheck=f,console.log(`
  : window.__lastApiCheck`)),f},CQ=t=>{const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`api-check-${new Date().toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(n)};typeof window<"u"&&(window.dliveDebug={runFullCheck:t=>xQ(t||"/api"),getLogs:hQ,clearLogs:fQ,setDebugMode:mQ,testCases:WI,paramVariations:pQ,discoverParams:_Q,downloadResult:CQ},window.addEventListener("api-call-complete",(t=>{const e=t.detail;e&&e.api&&uQ(e)})),console.log("%c D'Live API  ","font-weight: bold; color: #8B5CF6"),console.log("".repeat(50)),console.log("%c  :","font-weight: bold"),console.log("  dliveDebug.runFullCheck()     -    API "),console.log("  dliveDebug.getLogs()          -  API  "),console.log("  dliveDebug.clearLogs()        -   "),console.log("  dliveDebug.setDebugMode(true) -    ON/OFF"),console.log("".repeat(50)),console.log("%c :  > API   UI  ","color: #6366F1"));const FI=document.getElementById("root");if(!FI)throw new Error("Could not find root element to mount to");const yQ=lM.createRoot(FI);yQ.render(s.jsx(Gi.StrictMode,{children:s.jsx(dQ,{})}));export{pr as _,NQ as c,lb as g};

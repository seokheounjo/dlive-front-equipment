var G3=Object.defineProperty;var w5=t=>{throw TypeError(t)};var W3=(t,e,n)=>e in t?G3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var dr=(t,e,n)=>W3(t,typeof e!="symbol"?e+"":e,n),mb=(t,e,n)=>e.has(t)||w5("Cannot "+n);var yt=(t,e,n)=>(mb(t,e,"read from private field"),n?n.call(t):e.get(t)),an=(t,e,n)=>e.has(t)?w5("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Bs=(t,e,n,r)=>(mb(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),jn=(t,e,n)=>(mb(t,e,"access private method"),n);var Mx=(t,e,n,r)=>({set _(i){Bs(t,e,i,n)},get _(){return yt(t,e,r)}});function F3(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var uX=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function F2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gb={exports:{}},ag={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L5;function K3(){if(L5)return ag;L5=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return ag.Fragment=e,ag.jsx=n,ag.jsxs=n,ag}var P5;function Q3(){return P5||(P5=1,gb.exports=K3()),gb.exports}var s=Q3(),_b={exports:{}},Sn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A5;function Y3(){if(A5)return Sn;A5=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),p=Symbol.iterator;function g(R){return R===null||typeof R!="object"?null:(R=p&&R[p]||R["@@iterator"],typeof R=="function"?R:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,S={};function v(R,O,U){this.props=R,this.context=O,this.refs=S,this.updater=U||C}v.prototype.isReactComponent={},v.prototype.setState=function(R,O){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,O,"setState")},v.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function k(){}k.prototype=v.prototype;function L(R,O,U){this.props=R,this.context=O,this.refs=S,this.updater=U||C}var M=L.prototype=new k;M.constructor=L,y(M,v.prototype),M.isPureReactComponent=!0;var P=Array.isArray;function F(){}var G={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function I(R,O,U){var Q=U.ref;return{$$typeof:t,type:R,key:O,ref:Q!==void 0?Q:null,props:U}}function E(R,O){return I(R.type,O,R.props)}function A(R){return typeof R=="object"&&R!==null&&R.$$typeof===t}function Y(R){var O={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(U){return O[U]})}var ee=/\/+/g;function J(R,O){return typeof R=="object"&&R!==null&&R.key!=null?Y(""+R.key):O.toString(36)}function H(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(F,F):(R.status="pending",R.then(function(O){R.status==="pending"&&(R.status="fulfilled",R.value=O)},function(O){R.status==="pending"&&(R.status="rejected",R.reason=O)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function V(R,O,U,Q,q){var $=typeof R;($==="undefined"||$==="boolean")&&(R=null);var de=!1;if(R===null)de=!0;else switch($){case"bigint":case"string":case"number":de=!0;break;case"object":switch(R.$$typeof){case t:case e:de=!0;break;case m:return de=R._init,V(de(R._payload),O,U,Q,q)}}if(de)return q=q(R),de=Q===""?"."+J(R,0):Q,P(q)?(U="",de!=null&&(U=de.replace(ee,"$&/")+"/"),V(q,O,U,"",function(ie){return ie})):q!=null&&(A(q)&&(q=E(q,U+(q.key==null||R&&R.key===q.key?"":(""+q.key).replace(ee,"$&/")+"/")+de)),O.push(q)),1;de=0;var ae=Q===""?".":Q+":";if(P(R))for(var _e=0;_e<R.length;_e++)Q=R[_e],$=ae+J(Q,_e),de+=V(Q,O,U,$,q);else if(_e=g(R),typeof _e=="function")for(R=_e.call(R),_e=0;!(Q=R.next()).done;)Q=Q.value,$=ae+J(Q,_e++),de+=V(Q,O,U,$,q);else if($==="object"){if(typeof R.then=="function")return V(H(R),O,U,Q,q);throw O=String(R),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return de}function K(R,O,U){if(R==null)return R;var Q=[],q=0;return V(R,Q,"","",function($){return O.call(U,$,q++)}),Q}function j(R){if(R._status===-1){var O=R._result;O=O(),O.then(function(U){(R._status===0||R._status===-1)&&(R._status=1,R._result=U)},function(U){(R._status===0||R._status===-1)&&(R._status=2,R._result=U)}),R._status===-1&&(R._status=0,R._result=O)}if(R._status===1)return R._result.default;throw R._result}var te=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)},ce={map:K,forEach:function(R,O,U){K(R,function(){O.apply(this,arguments)},U)},count:function(R){var O=0;return K(R,function(){O++}),O},toArray:function(R){return K(R,function(O){return O})||[]},only:function(R){if(!A(R))throw Error("React.Children.only expected to receive a single React element child.");return R}};return Sn.Activity=_,Sn.Children=ce,Sn.Component=v,Sn.Fragment=n,Sn.Profiler=i,Sn.PureComponent=L,Sn.StrictMode=r,Sn.Suspense=u,Sn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,Sn.__COMPILER_RUNTIME={__proto__:null,c:function(R){return G.H.useMemoCache(R)}},Sn.cache=function(R){return function(){return R.apply(null,arguments)}},Sn.cacheSignal=function(){return null},Sn.cloneElement=function(R,O,U){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var Q=y({},R.props),q=R.key;if(O!=null)for($ in O.key!==void 0&&(q=""+O.key),O)!B.call(O,$)||$==="key"||$==="__self"||$==="__source"||$==="ref"&&O.ref===void 0||(Q[$]=O[$]);var $=arguments.length-2;if($===1)Q.children=U;else if(1<$){for(var de=Array($),ae=0;ae<$;ae++)de[ae]=arguments[ae+2];Q.children=de}return I(R.type,q,Q)},Sn.createContext=function(R){return R={$$typeof:o,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:a,_context:R},R},Sn.createElement=function(R,O,U){var Q,q={},$=null;if(O!=null)for(Q in O.key!==void 0&&($=""+O.key),O)B.call(O,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(q[Q]=O[Q]);var de=arguments.length-2;if(de===1)q.children=U;else if(1<de){for(var ae=Array(de),_e=0;_e<de;_e++)ae[_e]=arguments[_e+2];q.children=ae}if(R&&R.defaultProps)for(Q in de=R.defaultProps,de)q[Q]===void 0&&(q[Q]=de[Q]);return I(R,$,q)},Sn.createRef=function(){return{current:null}},Sn.forwardRef=function(R){return{$$typeof:c,render:R}},Sn.isValidElement=A,Sn.lazy=function(R){return{$$typeof:m,_payload:{_status:-1,_result:R},_init:j}},Sn.memo=function(R,O){return{$$typeof:h,type:R,compare:O===void 0?null:O}},Sn.startTransition=function(R){var O=G.T,U={};G.T=U;try{var Q=R(),q=G.S;q!==null&&q(U,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(F,te)}catch($){te($)}finally{O!==null&&U.types!==null&&(O.types=U.types),G.T=O}},Sn.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},Sn.use=function(R){return G.H.use(R)},Sn.useActionState=function(R,O,U){return G.H.useActionState(R,O,U)},Sn.useCallback=function(R,O){return G.H.useCallback(R,O)},Sn.useContext=function(R){return G.H.useContext(R)},Sn.useDebugValue=function(){},Sn.useDeferredValue=function(R,O){return G.H.useDeferredValue(R,O)},Sn.useEffect=function(R,O){return G.H.useEffect(R,O)},Sn.useEffectEvent=function(R){return G.H.useEffectEvent(R)},Sn.useId=function(){return G.H.useId()},Sn.useImperativeHandle=function(R,O,U){return G.H.useImperativeHandle(R,O,U)},Sn.useInsertionEffect=function(R,O){return G.H.useInsertionEffect(R,O)},Sn.useLayoutEffect=function(R,O){return G.H.useLayoutEffect(R,O)},Sn.useMemo=function(R,O){return G.H.useMemo(R,O)},Sn.useOptimistic=function(R,O){return G.H.useOptimistic(R,O)},Sn.useReducer=function(R,O,U){return G.H.useReducer(R,O,U)},Sn.useRef=function(R){return G.H.useRef(R)},Sn.useState=function(R){return G.H.useState(R)},Sn.useSyncExternalStore=function(R,O,U){return G.H.useSyncExternalStore(R,O,U)},Sn.useTransition=function(){return G.H.useTransition()},Sn.version="19.2.3",Sn}var k5;function K2(){return k5||(k5=1,_b.exports=Y3()),_b.exports}var b=K2();const Ji=F2(b),nM=F3({__proto__:null,default:Ji},[b]);var xb={exports:{}},lg={},pb={exports:{}},yb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U5;function V3(){return U5||(U5=1,(function(t){function e(V,K){var j=V.length;V.push(K);e:for(;0<j;){var te=j-1>>>1,ce=V[te];if(0<i(ce,K))V[te]=K,V[j]=ce,j=te;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var K=V[0],j=V.pop();if(j!==K){V[0]=j;e:for(var te=0,ce=V.length,R=ce>>>1;te<R;){var O=2*(te+1)-1,U=V[O],Q=O+1,q=V[Q];if(0>i(U,j))Q<ce&&0>i(q,U)?(V[te]=q,V[Q]=j,te=Q):(V[te]=U,V[O]=j,te=O);else if(Q<ce&&0>i(q,j))V[te]=q,V[Q]=j,te=Q;else break e}}return K}function i(V,K){var j=V.sortIndex-K.sortIndex;return j!==0?j:V.id-K.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],m=1,_=null,p=3,g=!1,C=!1,y=!1,S=!1,v=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function M(V){for(var K=n(h);K!==null;){if(K.callback===null)r(h);else if(K.startTime<=V)r(h),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(h)}}function P(V){if(y=!1,M(V),!C)if(n(u)!==null)C=!0,F||(F=!0,Y());else{var K=n(h);K!==null&&H(P,K.startTime-V)}}var F=!1,G=-1,B=5,I=-1;function E(){return S?!0:!(t.unstable_now()-I<B)}function A(){if(S=!1,F){var V=t.unstable_now();I=V;var K=!0;try{e:{C=!1,y&&(y=!1,k(G),G=-1),g=!0;var j=p;try{t:{for(M(V),_=n(u);_!==null&&!(_.expirationTime>V&&E());){var te=_.callback;if(typeof te=="function"){_.callback=null,p=_.priorityLevel;var ce=te(_.expirationTime<=V);if(V=t.unstable_now(),typeof ce=="function"){_.callback=ce,M(V),K=!0;break t}_===n(u)&&r(u),M(V)}else r(u);_=n(u)}if(_!==null)K=!0;else{var R=n(h);R!==null&&H(P,R.startTime-V),K=!1}}break e}finally{_=null,p=j,g=!1}K=void 0}}finally{K?Y():F=!1}}}var Y;if(typeof L=="function")Y=function(){L(A)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,J=ee.port2;ee.port1.onmessage=A,Y=function(){J.postMessage(null)}}else Y=function(){v(A,0)};function H(V,K){G=v(function(){V(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(V){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var j=p;p=K;try{return V()}finally{p=j}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(V,K){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var j=p;p=V;try{return K()}finally{p=j}},t.unstable_scheduleCallback=function(V,K,j){var te=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?te+j:te):j=te,V){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=j+ce,V={id:m++,callback:K,priorityLevel:V,startTime:j,expirationTime:ce,sortIndex:-1},j>te?(V.sortIndex=j,e(h,V),n(u)===null&&V===n(h)&&(y?(k(G),G=-1):y=!0,H(P,j-te))):(V.sortIndex=ce,e(u,V),C||g||(C=!0,F||(F=!0,Y()))),V},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(V){var K=p;return function(){var j=p;p=K;try{return V.apply(this,arguments)}finally{p=j}}}})(yb)),yb}var B5;function $3(){return B5||(B5=1,pb.exports=V3()),pb.exports}var bb={exports:{}},ja={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G5;function z3(){if(G5)return ja;G5=1;var t=K2();function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,h,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:u,containerInfo:h,implementation:m}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return ja.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,ja.createPortal=function(u,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(u,h,null,m)},ja.flushSync=function(u){var h=o.T,m=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=h,r.p=m,r.d.f()}},ja.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(u,h))},ja.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},ja.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var m=h.as,_=c(m,h.crossOrigin),p=typeof h.integrity=="string"?h.integrity:void 0,g=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?r.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:_,integrity:p,fetchPriority:g}):m==="script"&&r.d.X(u,{crossOrigin:_,integrity:p,fetchPriority:g,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},ja.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=c(h.as,h.crossOrigin);r.d.M(u,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(u)},ja.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,_=c(m,h.crossOrigin);r.d.L(u,m,{crossOrigin:_,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},ja.preloadModule=function(u,h){if(typeof u=="string")if(h){var m=c(h.as,h.crossOrigin);r.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(u)},ja.requestFormReset=function(u){r.d.r(u)},ja.unstable_batchedUpdates=function(u,h){return u(h)},ja.useFormState=function(u,h,m){return o.H.useFormState(u,h,m)},ja.useFormStatus=function(){return o.H.useHostTransitionStatus()},ja.version="19.2.3",ja}var W5;function rM(){if(W5)return bb.exports;W5=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),bb.exports=z3(),bb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F5;function H3(){if(F5)return lg;F5=1;var t=$3(),e=K2(),n=rM();function r(l){var d="https://react.dev/errors/"+l;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function a(l){var d=l,f=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(f=d.return),l=d.return;while(l)}return d.tag===3?f:null}function o(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function c(l){if(l.tag===31){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function u(l){if(a(l)!==l)throw Error(r(188))}function h(l){var d=l.alternate;if(!d){if(d=a(l),d===null)throw Error(r(188));return d!==l?null:l}for(var f=l,x=d;;){var D=f.return;if(D===null)break;var w=D.alternate;if(w===null){if(x=D.return,x!==null){f=x;continue}break}if(D.child===w.child){for(w=D.child;w;){if(w===f)return u(D),l;if(w===x)return u(D),d;w=w.sibling}throw Error(r(188))}if(f.return!==x.return)f=D,x=w;else{for(var oe=!1,Ae=D.child;Ae;){if(Ae===f){oe=!0,f=D,x=w;break}if(Ae===x){oe=!0,x=D,f=w;break}Ae=Ae.sibling}if(!oe){for(Ae=w.child;Ae;){if(Ae===f){oe=!0,f=w,x=D;break}if(Ae===x){oe=!0,x=w,f=D;break}Ae=Ae.sibling}if(!oe)throw Error(r(189))}}if(f.alternate!==x)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?l:d}function m(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l;for(l=l.child;l!==null;){if(d=m(l),d!==null)return d;l=l.sibling}return null}var _=Object.assign,p=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),L=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),E=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function Y(l){return l===null||typeof l!="object"?null:(l=A&&l[A]||l["@@iterator"],typeof l=="function"?l:null)}var ee=Symbol.for("react.client.reference");function J(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===ee?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case v:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case F:return"SuspenseList";case I:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case C:return"Portal";case L:return l.displayName||"Context";case k:return(l._context.displayName||"Context")+".Consumer";case M:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case G:return d=l.displayName||null,d!==null?d:J(l.type)||"Memo";case B:d=l._payload,l=l._init;try{return J(l(d))}catch{}}return null}var H=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},te=[],ce=-1;function R(l){return{current:l}}function O(l){0>ce||(l.current=te[ce],te[ce]=null,ce--)}function U(l,d){ce++,te[ce]=l.current,l.current=d}var Q=R(null),q=R(null),$=R(null),de=R(null);function ae(l,d){switch(U($,d),U(q,l),U(Q,null),d.nodeType){case 9:case 11:l=(l=d.documentElement)&&(l=l.namespaceURI)?s5(l):0;break;default:if(l=d.tagName,d=d.namespaceURI)d=s5(d),l=n5(d,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}O(Q),U(Q,l)}function _e(){O(Q),O(q),O($)}function ie(l){l.memoizedState!==null&&U(de,l);var d=Q.current,f=n5(d,l.type);d!==f&&(U(q,l),U(Q,f))}function Ne(l){q.current===l&&(O(Q),O(q)),de.current===l&&(O(de),sg._currentValue=j)}var X,xe;function fe(l){if(X===void 0)try{throw Error()}catch(f){var d=f.stack.trim().match(/\n( *(at )?)/);X=d&&d[1]||"",xe=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+X+l+xe}var Z=!1;function le(l,d){if(!l||Z)return"";Z=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(d){var us=function(){throw Error()};if(Object.defineProperty(us.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(us,[])}catch(Ht){var Vt=Ht}Reflect.construct(l,[],us)}else{try{us.call()}catch(Ht){Vt=Ht}l.call(us.prototype)}}else{try{throw Error()}catch(Ht){Vt=Ht}(us=l())&&typeof us.catch=="function"&&us.catch(function(){})}}catch(Ht){if(Ht&&Vt&&typeof Ht.stack=="string")return[Ht.stack,Vt.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=x.DetermineComponentFrameRoot(),oe=w[0],Ae=w[1];if(oe&&Ae){var pt=oe.split(`
`),Qt=Ae.split(`
`);for(D=x=0;x<pt.length&&!pt[x].includes("DetermineComponentFrameRoot");)x++;for(;D<Qt.length&&!Qt[D].includes("DetermineComponentFrameRoot");)D++;if(x===pt.length||D===Qt.length)for(x=pt.length-1,D=Qt.length-1;1<=x&&0<=D&&pt[x]!==Qt[D];)D--;for(;1<=x&&0<=D;x--,D--)if(pt[x]!==Qt[D]){if(x!==1||D!==1)do if(x--,D--,0>D||pt[x]!==Qt[D]){var ns=`
`+pt[x].replace(" at new "," at ");return l.displayName&&ns.includes("<anonymous>")&&(ns=ns.replace("<anonymous>",l.displayName)),ns}while(1<=x&&0<=D);break}}}finally{Z=!1,Error.prepareStackTrace=f}return(f=l?l.displayName||l.name:"")?fe(f):""}function se(l,d){switch(l.tag){case 26:case 27:case 5:return fe(l.type);case 16:return fe("Lazy");case 13:return l.child!==d&&d!==null?fe("Suspense Fallback"):fe("Suspense");case 19:return fe("SuspenseList");case 0:case 15:return le(l.type,!1);case 11:return le(l.type.render,!1);case 1:return le(l.type,!0);case 31:return fe("Activity");default:return""}}function Re(l){try{var d="",f=null;do d+=se(l,f),f=l,l=l.return;while(l);return d}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var be=Object.prototype.hasOwnProperty,De=t.unstable_scheduleCallback,re=t.unstable_cancelCallback,me=t.unstable_shouldYield,ve=t.unstable_requestPaint,et=t.unstable_now,Dt=t.unstable_getCurrentPriorityLevel,ot=t.unstable_ImmediatePriority,At=t.unstable_UserBlockingPriority,ct=t.unstable_NormalPriority,Ge=t.unstable_LowPriority,at=t.unstable_IdlePriority,xt=t.log,mt=t.unstable_setDisableYieldValue,Ve=null,it=null;function Fe(l){if(typeof xt=="function"&&mt(l),it&&typeof it.setStrictMode=="function")try{it.setStrictMode(Ve,l)}catch{}}var nt=Math.clz32?Math.clz32:ut,lt=Math.log,Mt=Math.LN2;function ut(l){return l>>>=0,l===0?32:31-(lt(l)/Mt|0)|0}var qe=256,Ee=262144,Ye=4194304;function pe(l){var d=l&42;if(d!==0)return d;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function ge(l,d,f){var x=l.pendingLanes;if(x===0)return 0;var D=0,w=l.suspendedLanes,oe=l.pingedLanes;l=l.warmLanes;var Ae=x&134217727;return Ae!==0?(x=Ae&~w,x!==0?D=pe(x):(oe&=Ae,oe!==0?D=pe(oe):f||(f=Ae&~l,f!==0&&(D=pe(f))))):(Ae=x&~w,Ae!==0?D=pe(Ae):oe!==0?D=pe(oe):f||(f=x&~l,f!==0&&(D=pe(f)))),D===0?0:d!==0&&d!==D&&(d&w)===0&&(w=D&-D,f=d&-d,w>=f||w===32&&(f&4194048)!==0)?d:D}function Be(l,d){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&d)===0}function ue(l,d){switch(l){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var l=Ye;return Ye<<=1,(Ye&62914560)===0&&(Ye=4194304),l}function Je(l){for(var d=[],f=0;31>f;f++)d.push(l);return d}function Pe(l,d){l.pendingLanes|=d,d!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Nt(l,d,f,x,D,w){var oe=l.pendingLanes;l.pendingLanes=f,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=f,l.entangledLanes&=f,l.errorRecoveryDisabledLanes&=f,l.shellSuspendCounter=0;var Ae=l.entanglements,pt=l.expirationTimes,Qt=l.hiddenUpdates;for(f=oe&~f;0<f;){var ns=31-nt(f),us=1<<ns;Ae[ns]=0,pt[ns]=-1;var Vt=Qt[ns];if(Vt!==null)for(Qt[ns]=null,ns=0;ns<Vt.length;ns++){var Ht=Vt[ns];Ht!==null&&(Ht.lane&=-536870913)}f&=~us}x!==0&&Oe(l,x,0),w!==0&&D===0&&l.tag!==0&&(l.suspendedLanes|=w&~(oe&~d))}function Oe(l,d,f){l.pendingLanes|=d,l.suspendedLanes&=~d;var x=31-nt(d);l.entangledLanes|=d,l.entanglements[x]=l.entanglements[x]|1073741824|f&261930}function dt(l,d){var f=l.entangledLanes|=d;for(l=l.entanglements;f;){var x=31-nt(f),D=1<<x;D&d|l[x]&d&&(l[x]|=d),f&=~D}}function gt(l,d){var f=d&-d;return f=(f&42)!==0?1:It(f),(f&(l.suspendedLanes|d))!==0?0:f}function It(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function $e(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function $t(){var l=K.p;return l!==0?l:(l=window.event,l===void 0?32:D5(l.type))}function Ue(l,d){var f=K.p;try{return K.p=l,d()}finally{K.p=f}}var ss=Math.random().toString(36).slice(2),ls="__reactFiber$"+ss,ds="__reactProps$"+ss,vs="__reactContainer$"+ss,Ss="__reactEvents$"+ss,ke="__reactListeners$"+ss,ft="__reactHandles$"+ss,st="__reactResources$"+ss,Ft="__reactMarker$"+ss;function _t(l){delete l[ls],delete l[ds],delete l[Ss],delete l[ke],delete l[ft]}function qt(l){var d=l[ls];if(d)return d;for(var f=l.parentNode;f;){if(d=f[vs]||f[ls]){if(f=d.alternate,d.child!==null||f!==null&&f.child!==null)for(l=d5(l);l!==null;){if(f=l[ls])return f;l=d5(l)}return d}l=f,f=l.parentNode}return null}function jt(l){if(l=l[ls]||l[vs]){var d=l.tag;if(d===5||d===6||d===13||d===31||d===26||d===27||d===3)return l}return null}function he(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l.stateNode;throw Error(r(33))}function ye(l){var d=l[st];return d||(d=l[st]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function je(l){l[Ft]=!0}var Me=new Set,tt={};function Te(l,d){bt(l,d),bt(l+"Capture",d)}function bt(l,d){for(tt[l]=d,l=0;l<d.length;l++)Me.add(d[l])}var Ke=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),St={},Et={};function ze(l){return be.call(Et,l)?!0:be.call(St,l)?!1:Ke.test(l)?Et[l]=!0:(St[l]=!0,!1)}function ht(l,d,f){if(ze(d))if(f===null)l.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":l.removeAttribute(d);return;case"boolean":var x=d.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){l.removeAttribute(d);return}}l.setAttribute(d,""+f)}}function Lt(l,d,f){if(f===null)l.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttribute(d,""+f)}}function Bt(l,d,f,x){if(x===null)l.removeAttribute(f);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(f);return}l.setAttributeNS(d,f,""+x)}}function Yt(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Xt(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function ts(l,d,f){var x=Object.getOwnPropertyDescriptor(l.constructor.prototype,d);if(!l.hasOwnProperty(d)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var D=x.get,w=x.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return D.call(this)},set:function(oe){f=""+oe,w.call(this,oe)}}),Object.defineProperty(l,d,{enumerable:x.enumerable}),{getValue:function(){return f},setValue:function(oe){f=""+oe},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function Ut(l){if(!l._valueTracker){var d=Xt(l)?"checked":"value";l._valueTracker=ts(l,d,""+l[d])}}function Is(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var f=d.getValue(),x="";return l&&(x=Xt(l)?l.checked?"true":"false":l.value),l=x,l!==f?(d.setValue(l),!0):!1}function Cs(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var Us=/[\n"\\]/g;function _s(l){return l.replace(Us,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function Es(l,d,f,x,D,w,oe,Ae){l.name="",oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"?l.type=oe:l.removeAttribute("type"),d!=null?oe==="number"?(d===0&&l.value===""||l.value!=d)&&(l.value=""+Yt(d)):l.value!==""+Yt(d)&&(l.value=""+Yt(d)):oe!=="submit"&&oe!=="reset"||l.removeAttribute("value"),d!=null?cs(l,oe,Yt(d)):f!=null?cs(l,oe,Yt(f)):x!=null&&l.removeAttribute("value"),D==null&&w!=null&&(l.defaultChecked=!!w),D!=null&&(l.checked=D&&typeof D!="function"&&typeof D!="symbol"),Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?l.name=""+Yt(Ae):l.removeAttribute("name")}function Ls(l,d,f,x,D,w,oe,Ae){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(l.type=w),d!=null||f!=null){if(!(w!=="submit"&&w!=="reset"||d!=null)){Ut(l);return}f=f!=null?""+Yt(f):"",d=d!=null?""+Yt(d):f,Ae||d===l.value||(l.value=d),l.defaultValue=d}x=x??D,x=typeof x!="function"&&typeof x!="symbol"&&!!x,l.checked=Ae?l.checked:!!x,l.defaultChecked=!!x,oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"&&(l.name=oe),Ut(l)}function cs(l,d,f){d==="number"&&Cs(l.ownerDocument)===l||l.defaultValue===""+f||(l.defaultValue=""+f)}function ms(l,d,f,x){if(l=l.options,d){d={};for(var D=0;D<f.length;D++)d["$"+f[D]]=!0;for(f=0;f<l.length;f++)D=d.hasOwnProperty("$"+l[f].value),l[f].selected!==D&&(l[f].selected=D),D&&x&&(l[f].defaultSelected=!0)}else{for(f=""+Yt(f),d=null,D=0;D<l.length;D++){if(l[D].value===f){l[D].selected=!0,x&&(l[D].defaultSelected=!0);return}d!==null||l[D].disabled||(d=l[D])}d!==null&&(d.selected=!0)}}function Ys(l,d,f){if(d!=null&&(d=""+Yt(d),d!==l.value&&(l.value=d),f==null)){l.defaultValue!==d&&(l.defaultValue=d);return}l.defaultValue=f!=null?""+Yt(f):""}function Ps(l,d,f,x){if(d==null){if(x!=null){if(f!=null)throw Error(r(92));if(H(x)){if(1<x.length)throw Error(r(93));x=x[0]}f=x}f==null&&(f=""),d=f}f=Yt(d),l.defaultValue=f,x=l.textContent,x===f&&x!==""&&x!==null&&(l.value=x),Ut(l)}function rt(l,d){if(d){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=d;return}}l.textContent=d}var Wt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bs(l,d,f){var x=d.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?x?l.setProperty(d,""):d==="float"?l.cssFloat="":l[d]="":x?l.setProperty(d,f):typeof f!="number"||f===0||Wt.has(d)?d==="float"?l.cssFloat=f:l[d]=(""+f).trim():l[d]=f+"px"}function zt(l,d,f){if(d!=null&&typeof d!="object")throw Error(r(62));if(l=l.style,f!=null){for(var x in f)!f.hasOwnProperty(x)||d!=null&&d.hasOwnProperty(x)||(x.indexOf("--")===0?l.setProperty(x,""):x==="float"?l.cssFloat="":l[x]="");for(var D in d)x=d[D],d.hasOwnProperty(D)&&f[D]!==x&&bs(l,D,x)}else for(var w in d)d.hasOwnProperty(w)&&bs(l,w,d[w])}function ws(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ds=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function js(l){return Ds.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function hs(){}var Ws=null;function Vs(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Os=null,xs=null;function Br(l){var d=jt(l);if(d&&(l=d.stateNode)){var f=l[ds]||null;e:switch(l=d.stateNode,d.type){case"input":if(Es(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),d=f.name,f.type==="radio"&&d!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+_s(""+d)+'"][type="radio"]'),d=0;d<f.length;d++){var x=f[d];if(x!==l&&x.form===l.form){var D=x[ds]||null;if(!D)throw Error(r(90));Es(x,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(d=0;d<f.length;d++)x=f[d],x.form===l.form&&Is(x)}break e;case"textarea":Ys(l,f.value,f.defaultValue);break e;case"select":d=f.value,d!=null&&ms(l,!!f.multiple,d,!1)}}}var Pr=!1;function ti(l,d,f){if(Pr)return l(d,f);Pr=!0;try{var x=l(d);return x}finally{if(Pr=!1,(Os!==null||xs!==null)&&(lx(),Os&&(d=Os,l=xs,xs=Os=null,Br(d),l)))for(d=0;d<l.length;d++)Br(l[d])}}function Mr(l,d){var f=l.stateNode;if(f===null)return null;var x=f[ds]||null;if(x===null)return null;f=x[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(r(231,d,typeof f));return f}var hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fr=!1;if(hn)try{var ci={};Object.defineProperty(ci,"passive",{get:function(){fr=!0}}),window.addEventListener("test",ci,ci),window.removeEventListener("test",ci,ci)}catch{fr=!1}var $r=null,sa=null,Ar=null;function na(){if(Ar)return Ar;var l,d=sa,f=d.length,x,D="value"in $r?$r.value:$r.textContent,w=D.length;for(l=0;l<f&&d[l]===D[l];l++);var oe=f-l;for(x=1;x<=oe&&d[f-x]===D[w-x];x++);return Ar=D.slice(l,1<x?1-x:void 0)}function Ir(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function Ga(){return!0}function tl(){return!1}function Rs(l){function d(f,x,D,w,oe){this._reactName=f,this._targetInst=D,this.type=x,this.nativeEvent=w,this.target=oe,this.currentTarget=null;for(var Ae in l)l.hasOwnProperty(Ae)&&(f=l[Ae],this[Ae]=f?f(w):w[Ae]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ga:tl,this.isPropagationStopped=tl,this}return _(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ga)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ga)},persist:function(){},isPersistent:Ga}),d}var Un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vn=Rs(Un),si=_({},Un,{view:0,detail:0}),Ii=Rs(si),No,Il,ks,Xn=_({},si,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mn,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==ks&&(ks&&l.type==="mousemove"?(No=l.screenX-ks.screenX,Il=l.screenY-ks.screenY):Il=No=0,ks=l),No)},movementY:function(l){return"movementY"in l?l.movementY:Il}}),zr=Rs(Xn),ji=_({},Xn,{dataTransfer:0}),Bi=Rs(ji),p0=_({},si,{relatedTarget:0}),So=Rs(p0),y0=_({},Un,{animationName:0,elapsedTime:0,pseudoElement:0}),W=Rs(y0),Ce=_({},Un,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Ze=Rs(Ce),Ct=_({},Un,{data:0}),Ot=Rs(Ct),rs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function en(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=zs[l])?!!d[l]:!1}function mn(){return en}var Cn=_({},si,{key:function(l){if(l.key){var d=rs[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=Ir(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?gs[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mn,charCode:function(l){return l.type==="keypress"?Ir(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Ir(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Fn=Rs(Cn),Gr=_({},Xn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ni=Rs(Gr),Sr=_({},si,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mn}),Ci=Rs(Sr),di=_({},Un,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gi=Rs(di),vo=_({},Xn,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),jl=Rs(vo),Eo=_({},Un,{newState:0,oldState:0}),eh=Rs(Eo),wd=[9,13,27,32],Kl=hn&&"CompositionEvent"in window,Ol=null;hn&&"documentMode"in document&&(Ol=document.documentMode);var Bc=hn&&"TextEvent"in window&&!Ol,Do=hn&&(!Kl||Ol&&8<Ol&&11>=Ol),Oi=" ",rc=!1;function ic(l,d){switch(l){case"keyup":return wd.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ld(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Ql=!1;function pa(l,d){switch(l){case"compositionend":return Ld(d);case"keypress":return d.which!==32?null:(rc=!0,Oi);case"textInput":return l=d.data,l===Oi&&rc?null:l;default:return null}}function Ro(l,d){if(Ql)return l==="compositionend"||!Kl&&ic(l,d)?(l=na(),Ar=sa=$r=null,Ql=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Do&&d.locale!=="ko"?null:d.data;default:return null}}var Pd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function th(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!Pd[l.type]:d==="textarea"}function Wa(l,d,f,x){Os?xs?xs.push(x):xs=[x]:Os=x,d=mx(d,"onChange"),0<d.length&&(f=new Vn("onChange","change",null,f,x),l.push({event:f,listeners:d}))}var wl=null,To=null;function sh(l){qv(l,0)}function Ll(l){var d=he(l);if(Is(d))return l}function ac(l,d){if(l==="change")return d}var Ma=!1;if(hn){var ya;if(hn){var Yl="oninput"in document;if(!Yl){var Vl=document.createElement("div");Vl.setAttribute("oninput","return;"),Yl=typeof Vl.oninput=="function"}ya=Yl}else ya=!1;Ma=ya&&(!document.documentMode||9<document.documentMode)}function Mo(){wl&&(wl.detachEvent("onpropertychange",Ad),To=wl=null)}function Ad(l){if(l.propertyName==="value"&&Ll(To)){var d=[];Wa(d,To,l,Vs(l)),ti(sh,d)}}function kd(l,d,f){l==="focusin"?(Mo(),wl=d,To=f,wl.attachEvent("onpropertychange",Ad)):l==="focusout"&&Mo()}function ri(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Ll(To)}function b0(l,d){if(l==="click")return Ll(d)}function $l(l,d){if(l==="input"||l==="change")return Ll(d)}function zl(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var Wi=typeof Object.is=="function"?Object.is:zl;function Io(l,d){if(Wi(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var f=Object.keys(l),x=Object.keys(d);if(f.length!==x.length)return!1;for(x=0;x<f.length;x++){var D=f[x];if(!be.call(d,D)||!Wi(l[D],d[D]))return!1}return!0}function Ud(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Bd(l,d){var f=Ud(l);l=0;for(var x;f;){if(f.nodeType===3){if(x=l+f.textContent.length,l<=d&&x>=d)return{node:f,offset:d-l};l=x}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Ud(f)}}function jo(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?jo(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function Oo(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var d=Cs(l.document);d instanceof l.HTMLIFrameElement;){try{var f=typeof d.contentWindow.location.href=="string"}catch{f=!1}if(f)l=d.contentWindow;else break;d=Cs(l.document)}return d}function Hl(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}var Gc=hn&&"documentMode"in document&&11>=document.documentMode,Fa=null,wo=null,ra=null,sl=!1;function Jn(l,d,f){var x=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;sl||Fa==null||Fa!==Cs(x)||(x=Fa,"selectionStart"in x&&Hl(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ra&&Io(ra,x)||(ra=x,x=mx(wo,"onSelect"),0<x.length&&(d=new Vn("onSelect","select",null,d,f),l.push({event:d,listeners:x}),d.target=Fa)))}function Kn(l,d){var f={};return f[l.toLowerCase()]=d.toLowerCase(),f["Webkit"+l]="webkit"+d,f["Moz"+l]="moz"+d,f}var vr={animationend:Kn("Animation","AnimationEnd"),animationiteration:Kn("Animation","AnimationIteration"),animationstart:Kn("Animation","AnimationStart"),transitionrun:Kn("Transition","TransitionRun"),transitionstart:Kn("Transition","TransitionStart"),transitioncancel:Kn("Transition","TransitionCancel"),transitionend:Kn("Transition","TransitionEnd")},ii={},ql={};hn&&(ql=document.createElement("div").style,"AnimationEvent"in window||(delete vr.animationend.animation,delete vr.animationiteration.animation,delete vr.animationstart.animation),"TransitionEvent"in window||delete vr.transitionend.transition);function Pl(l){if(ii[l])return ii[l];if(!vr[l])return l;var d=vr[l],f;for(f in d)if(d.hasOwnProperty(f)&&f in ql)return ii[l]=d[f];return l}var Wc=Pl("animationend"),nh=Pl("animationiteration"),Em=Pl("animationstart"),k_=Pl("transitionrun"),U_=Pl("transitionstart"),B_=Pl("transitioncancel"),Dm=Pl("transitionend"),Rm=new Map,Fc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fc.push("scrollEnd");function nl(l,d){Rm.set(l,d),Te(d,[l])}var rh=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},Ka=[],Kc=0,C0=0;function ih(){for(var l=Kc,d=C0=Kc=0;d<l;){var f=Ka[d];Ka[d++]=null;var x=Ka[d];Ka[d++]=null;var D=Ka[d];Ka[d++]=null;var w=Ka[d];if(Ka[d++]=null,x!==null&&D!==null){var oe=x.pending;oe===null?D.next=D:(D.next=oe.next,oe.next=D),x.pending=D}w!==0&&lh(f,D,w)}}function ah(l,d,f,x){Ka[Kc++]=l,Ka[Kc++]=d,Ka[Kc++]=f,Ka[Kc++]=x,C0|=x,l.lanes|=x,l=l.alternate,l!==null&&(l.lanes|=x)}function N0(l,d,f,x){return ah(l,d,f,x),ia(l)}function Lo(l,d){return ah(l,null,null,d),ia(l)}function lh(l,d,f){l.lanes|=f;var x=l.alternate;x!==null&&(x.lanes|=f);for(var D=!1,w=l.return;w!==null;)w.childLanes|=f,x=w.alternate,x!==null&&(x.childLanes|=f),w.tag===22&&(l=w.stateNode,l===null||l._visibility&1||(D=!0)),l=w,w=w.return;return l.tag===3?(w=l.stateNode,D&&d!==null&&(D=31-nt(f),l=w.hiddenUpdates,x=l[D],x===null?l[D]=[d]:x.push(d),d.lane=f|536870912),w):null}function ia(l){if(50<Hm)throw Hm=0,Uy=null,Error(r(185));for(var d=l.return;d!==null;)l=d,d=l.return;return l.tag===3?l.stateNode:null}var Fi={};function S0(l,d,f,x){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function aa(l,d,f,x){return new S0(l,d,f,x)}function v0(l){return l=l.prototype,!(!l||!l.isReactComponent)}function rl(l,d){var f=l.alternate;return f===null?(f=aa(l.tag,d,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=d,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&65011712,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,d=l.dependencies,f.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f.refCleanup=l.refCleanup,f}function oh(l,d){l.flags&=65011714;var f=l.alternate;return f===null?(l.childLanes=0,l.lanes=d,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,d=f.dependencies,l.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),l}function Gd(l,d,f,x,D,w){var oe=0;if(x=l,typeof l=="function")v0(l)&&(oe=1);else if(typeof l=="string")oe=T3(l,f,Q.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case I:return l=aa(31,f,d,D),l.elementType=I,l.lanes=w,l;case y:return lc(f.children,D,w,d);case S:oe=8,D|=24;break;case v:return l=aa(12,f,d,D|2),l.elementType=v,l.lanes=w,l;case P:return l=aa(13,f,d,D),l.elementType=P,l.lanes=w,l;case F:return l=aa(19,f,d,D),l.elementType=F,l.lanes=w,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case L:oe=10;break e;case k:oe=9;break e;case M:oe=11;break e;case G:oe=14;break e;case B:oe=16,x=null;break e}oe=29,f=Error(r(130,l===null?"null":typeof l,"")),x=null}return d=aa(oe,f,d,D),d.elementType=l,d.type=x,d.lanes=w,d}function lc(l,d,f,x){return l=aa(7,l,x,d),l.lanes=f,l}function ch(l,d,f){return l=aa(6,l,null,d),l.lanes=f,l}function E0(l){var d=aa(18,null,null,0);return d.stateNode=l,d}function Wd(l,d,f){return d=aa(4,l.children!==null?l.children:[],l.key,d),d.lanes=f,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}var D0=new WeakMap;function il(l,d){if(typeof l=="object"&&l!==null){var f=D0.get(l);return f!==void 0?f:(d={value:l,source:d,stack:Re(d)},D0.set(l,d),d)}return{value:l,source:d,stack:Re(d)}}var Fd=[],Qc=0,R0=null,dh=0,al=[],ll=0,oc=null,ol=1,cl="";function Qa(l,d){Fd[Qc++]=dh,Fd[Qc++]=R0,R0=l,dh=d}function G_(l,d,f){al[ll++]=ol,al[ll++]=cl,al[ll++]=oc,oc=l;var x=ol;l=cl;var D=32-nt(x)-1;x&=~(1<<D),f+=1;var w=32-nt(d)+D;if(30<w){var oe=D-D%5;w=(x&(1<<oe)-1).toString(32),x>>=oe,D-=oe,ol=1<<32-nt(d)+D|f<<D|x,cl=w+l}else ol=1<<w|f<<D|x,cl=l}function Tm(l){l.return!==null&&(Qa(l,1),G_(l,1,0))}function T0(l){for(;l===R0;)R0=Fd[--Qc],Fd[Qc]=null,dh=Fd[--Qc],Fd[Qc]=null;for(;l===oc;)oc=al[--ll],al[ll]=null,cl=al[--ll],al[ll]=null,ol=al[--ll],al[ll]=null}function W_(l,d){al[ll++]=ol,al[ll++]=cl,al[ll++]=oc,ol=d.id,cl=d.overflow,oc=l}var Ki=null,jr=null,Pn=!1,ba=null,Hr=!1,Al=Error(r(519));function cc(l){var d=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kd(il(d,l)),Al}function Mm(l){var d=l.stateNode,f=l.type,x=l.memoizedProps;switch(d[ls]=l,d[ds]=x,f){case"dialog":kn("cancel",d),kn("close",d);break;case"iframe":case"object":case"embed":kn("load",d);break;case"video":case"audio":for(f=0;f<Xm.length;f++)kn(Xm[f],d);break;case"source":kn("error",d);break;case"img":case"image":case"link":kn("error",d),kn("load",d);break;case"details":kn("toggle",d);break;case"input":kn("invalid",d),Ls(d,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":kn("invalid",d);break;case"textarea":kn("invalid",d),Ps(d,x.value,x.defaultValue,x.children)}f=x.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||d.textContent===""+f||x.suppressHydrationWarning===!0||e5(d.textContent,f)?(x.popover!=null&&(kn("beforetoggle",d),kn("toggle",d)),x.onScroll!=null&&kn("scroll",d),x.onScrollEnd!=null&&kn("scrollend",d),x.onClick!=null&&(d.onclick=hs),d=!0):d=!1,d||cc(l,!0)}function Po(l){for(Ki=l.return;Ki;)switch(Ki.tag){case 5:case 31:case 13:Hr=!1;return;case 27:case 3:Hr=!0;return;default:Ki=Ki.return}}function Qi(l){if(l!==Ki)return!1;if(!Pn)return Po(l),Pn=!0,!1;var d=l.tag,f;if((f=d!==3&&d!==27)&&((f=d===5)&&(f=l.type,f=!(f!=="form"&&f!=="button")||Zy(l.type,l.memoizedProps)),f=!f),f&&jr&&cc(l),Po(l),d===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));jr=c5(l)}else if(d===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));jr=c5(l)}else d===27?(d=jr,nu(l.type)?(l=rb,rb=null,jr=l):jr=d):jr=Ki?eo(l.stateNode.nextSibling):null;return!0}function Yc(){jr=Ki=null,Pn=!1}function Im(){var l=ba;return l!==null&&(gl===null?gl=l:gl.push.apply(gl,l),ba=null),l}function Kd(l){ba===null?ba=[l]:ba.push(l)}var M0=R(null),dc=null,Xl=null;function uc(l,d,f){U(M0,d._currentValue),d._currentValue=f}function dl(l){l._currentValue=M0.current,O(M0)}function Qd(l,d,f){for(;l!==null;){var x=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,x!==null&&(x.childLanes|=d)):x!==null&&(x.childLanes&d)!==d&&(x.childLanes|=d),l===f)break;l=l.return}}function Vc(l,d,f,x){var D=l.child;for(D!==null&&(D.return=l);D!==null;){var w=D.dependencies;if(w!==null){var oe=D.child;w=w.firstContext;e:for(;w!==null;){var Ae=w;w=D;for(var pt=0;pt<d.length;pt++)if(Ae.context===d[pt]){w.lanes|=f,Ae=w.alternate,Ae!==null&&(Ae.lanes|=f),Qd(w.return,f,l),x||(oe=null);break e}w=Ae.next}}else if(D.tag===18){if(oe=D.return,oe===null)throw Error(r(341));oe.lanes|=f,w=oe.alternate,w!==null&&(w.lanes|=f),Qd(oe,f,l),oe=null}else oe=D.child;if(oe!==null)oe.return=D;else for(oe=D;oe!==null;){if(oe===l){oe=null;break}if(D=oe.sibling,D!==null){D.return=oe.return,oe=D;break}oe=oe.return}D=oe}}function hc(l,d,f,x){l=null;for(var D=d,w=!1;D!==null;){if(!w){if((D.flags&524288)!==0)w=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var oe=D.alternate;if(oe===null)throw Error(r(387));if(oe=oe.memoizedProps,oe!==null){var Ae=D.type;Wi(D.pendingProps.value,oe.value)||(l!==null?l.push(Ae):l=[Ae])}}else if(D===de.current){if(oe=D.alternate,oe===null)throw Error(r(387));oe.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(l!==null?l.push(sg):l=[sg])}D=D.return}l!==null&&Vc(d,l,f,x),d.flags|=262144}function I0(l){for(l=l.firstContext;l!==null;){if(!Wi(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function fc(l){dc=l,Xl=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Yi(l){return F_(dc,l)}function j0(l,d){return dc===null&&fc(l),F_(l,d)}function F_(l,d){var f=d._currentValue;if(d={context:d,memoizedValue:f,next:null},Xl===null){if(l===null)throw Error(r(308));Xl=d,l.dependencies={lanes:0,firstContext:d},l.flags|=524288}else Xl=Xl.next=d;return f}var ny=typeof AbortController<"u"?AbortController:function(){var l=[],d=this.signal={aborted:!1,addEventListener:function(f,x){l.push(x)}};this.abort=function(){d.aborted=!0,l.forEach(function(f){return f()})}},ry=t.unstable_scheduleCallback,iy=t.unstable_NormalPriority,ai={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yd(){return{controller:new ny,data:new Map,refCount:0}}function uh(l){l.refCount--,l.refCount===0&&ry(iy,function(){l.controller.abort()})}var hh=null,O0=0,N=0,T=null;function z(l,d){if(hh===null){var f=hh=[];O0=0,N=Qy(),T={status:"pending",value:void 0,then:function(x){f.push(x)}}}return O0++,d.then(ne,ne),d}function ne(){if(--O0===0&&hh!==null){T!==null&&(T.status="fulfilled");var l=hh;hh=null,N=0,T=null;for(var d=0;d<l.length;d++)(0,l[d])()}}function Se(l,d){var f=[],x={status:"pending",value:null,reason:null,then:function(D){f.push(D)}};return l.then(function(){x.status="fulfilled",x.value=d;for(var D=0;D<f.length;D++)(0,f[D])(d)},function(D){for(x.status="rejected",x.reason=D,D=0;D<f.length;D++)(0,f[D])(void 0)}),x}var Ie=V.S;V.S=function(l,d){vv=et(),typeof d=="object"&&d!==null&&typeof d.then=="function"&&z(l,d),Ie!==null&&Ie(l,d)};var Le=R(null);function We(){var l=Le.current;return l!==null?l:wr.pooledCache}function Qe(l,d){d===null?U(Le,Le.current):U(Le,d.pool)}function Xe(){var l=We();return l===null?null:{parent:ai._currentValue,pool:l}}var vt=Error(r(460)),Gt=Error(r(474)),He=Error(r(542)),Tt={then:function(){}};function Pt(l){return l=l.status,l==="fulfilled"||l==="rejected"}function es(l,d,f){switch(f=l[f],f===void 0?l.push(d):f!==d&&(d.then(hs,hs),d=f),d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,ys(l),l;default:if(typeof d.status=="string")d.then(hs,hs);else{if(l=wr,l!==null&&100<l.shellSuspendCounter)throw Error(r(482));l=d,l.status="pending",l.then(function(x){if(d.status==="pending"){var D=d;D.status="fulfilled",D.value=x}},function(x){if(d.status==="pending"){var D=d;D.status="rejected",D.reason=x}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,ys(l),l}throw Jt=d,vt}}function kt(l){try{var d=l._init;return d(l._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Jt=f,vt):f}}var Jt=null;function is(){if(Jt===null)throw Error(r(459));var l=Jt;return Jt=null,l}function ys(l){if(l===vt||l===He)throw Error(r(483))}var fs=null,qs=0;function Fs(l){var d=qs;return qs+=1,fs===null&&(fs=[]),es(fs,l,d)}function xn(l,d){d=d.props.ref,l.ref=d!==void 0?d:null}function $s(l,d){throw d.$$typeof===p?Error(r(525)):(l=Object.prototype.toString.call(d),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l)))}function Ln(l){function d(wt,Rt){if(l){var Kt=wt.deletions;Kt===null?(wt.deletions=[Rt],wt.flags|=16):Kt.push(Rt)}}function f(wt,Rt){if(!l)return null;for(;Rt!==null;)d(wt,Rt),Rt=Rt.sibling;return null}function x(wt){for(var Rt=new Map;wt!==null;)wt.key!==null?Rt.set(wt.key,wt):Rt.set(wt.index,wt),wt=wt.sibling;return Rt}function D(wt,Rt){return wt=rl(wt,Rt),wt.index=0,wt.sibling=null,wt}function w(wt,Rt,Kt){return wt.index=Kt,l?(Kt=wt.alternate,Kt!==null?(Kt=Kt.index,Kt<Rt?(wt.flags|=67108866,Rt):Kt):(wt.flags|=67108866,Rt)):(wt.flags|=1048576,Rt)}function oe(wt){return l&&wt.alternate===null&&(wt.flags|=67108866),wt}function Ae(wt,Rt,Kt,os){return Rt===null||Rt.tag!==6?(Rt=ch(Kt,wt.mode,os),Rt.return=wt,Rt):(Rt=D(Rt,Kt),Rt.return=wt,Rt)}function pt(wt,Rt,Kt,os){var on=Kt.type;return on===y?ns(wt,Rt,Kt.props.children,os,Kt.key):Rt!==null&&(Rt.elementType===on||typeof on=="object"&&on!==null&&on.$$typeof===B&&kt(on)===Rt.type)?(Rt=D(Rt,Kt.props),xn(Rt,Kt),Rt.return=wt,Rt):(Rt=Gd(Kt.type,Kt.key,Kt.props,null,wt.mode,os),xn(Rt,Kt),Rt.return=wt,Rt)}function Qt(wt,Rt,Kt,os){return Rt===null||Rt.tag!==4||Rt.stateNode.containerInfo!==Kt.containerInfo||Rt.stateNode.implementation!==Kt.implementation?(Rt=Wd(Kt,wt.mode,os),Rt.return=wt,Rt):(Rt=D(Rt,Kt.children||[]),Rt.return=wt,Rt)}function ns(wt,Rt,Kt,os,on){return Rt===null||Rt.tag!==7?(Rt=lc(Kt,wt.mode,os,on),Rt.return=wt,Rt):(Rt=D(Rt,Kt),Rt.return=wt,Rt)}function us(wt,Rt,Kt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return Rt=ch(""+Rt,wt.mode,Kt),Rt.return=wt,Rt;if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case g:return Kt=Gd(Rt.type,Rt.key,Rt.props,null,wt.mode,Kt),xn(Kt,Rt),Kt.return=wt,Kt;case C:return Rt=Wd(Rt,wt.mode,Kt),Rt.return=wt,Rt;case B:return Rt=kt(Rt),us(wt,Rt,Kt)}if(H(Rt)||Y(Rt))return Rt=lc(Rt,wt.mode,Kt,null),Rt.return=wt,Rt;if(typeof Rt.then=="function")return us(wt,Fs(Rt),Kt);if(Rt.$$typeof===L)return us(wt,j0(wt,Rt),Kt);$s(wt,Rt)}return null}function Vt(wt,Rt,Kt,os){var on=Rt!==null?Rt.key:null;if(typeof Kt=="string"&&Kt!==""||typeof Kt=="number"||typeof Kt=="bigint")return on!==null?null:Ae(wt,Rt,""+Kt,os);if(typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case g:return Kt.key===on?pt(wt,Rt,Kt,os):null;case C:return Kt.key===on?Qt(wt,Rt,Kt,os):null;case B:return Kt=kt(Kt),Vt(wt,Rt,Kt,os)}if(H(Kt)||Y(Kt))return on!==null?null:ns(wt,Rt,Kt,os,null);if(typeof Kt.then=="function")return Vt(wt,Rt,Fs(Kt),os);if(Kt.$$typeof===L)return Vt(wt,Rt,j0(wt,Kt),os);$s(wt,Kt)}return null}function Ht(wt,Rt,Kt,os,on){if(typeof os=="string"&&os!==""||typeof os=="number"||typeof os=="bigint")return wt=wt.get(Kt)||null,Ae(Rt,wt,""+os,on);if(typeof os=="object"&&os!==null){switch(os.$$typeof){case g:return wt=wt.get(os.key===null?Kt:os.key)||null,pt(Rt,wt,os,on);case C:return wt=wt.get(os.key===null?Kt:os.key)||null,Qt(Rt,wt,os,on);case B:return os=kt(os),Ht(wt,Rt,Kt,os,on)}if(H(os)||Y(os))return wt=wt.get(Kt)||null,ns(Rt,wt,os,on,null);if(typeof os.then=="function")return Ht(wt,Rt,Kt,Fs(os),on);if(os.$$typeof===L)return Ht(wt,Rt,Kt,j0(Rt,os),on);$s(Rt,os)}return null}function Hs(wt,Rt,Kt,os){for(var on=null,er=null,tn=Rt,Rn=Rt=0,Gn=null;tn!==null&&Rn<Kt.length;Rn++){tn.index>Rn?(Gn=tn,tn=null):Gn=tn.sibling;var tr=Vt(wt,tn,Kt[Rn],os);if(tr===null){tn===null&&(tn=Gn);break}l&&tn&&tr.alternate===null&&d(wt,tn),Rt=w(tr,Rt,Rn),er===null?on=tr:er.sibling=tr,er=tr,tn=Gn}if(Rn===Kt.length)return f(wt,tn),Pn&&Qa(wt,Rn),on;if(tn===null){for(;Rn<Kt.length;Rn++)tn=us(wt,Kt[Rn],os),tn!==null&&(Rt=w(tn,Rt,Rn),er===null?on=tn:er.sibling=tn,er=tn);return Pn&&Qa(wt,Rn),on}for(tn=x(tn);Rn<Kt.length;Rn++)Gn=Ht(tn,wt,Rn,Kt[Rn],os),Gn!==null&&(l&&Gn.alternate!==null&&tn.delete(Gn.key===null?Rn:Gn.key),Rt=w(Gn,Rt,Rn),er===null?on=Gn:er.sibling=Gn,er=Gn);return l&&tn.forEach(function(ou){return d(wt,ou)}),Pn&&Qa(wt,Rn),on}function fn(wt,Rt,Kt,os){if(Kt==null)throw Error(r(151));for(var on=null,er=null,tn=Rt,Rn=Rt=0,Gn=null,tr=Kt.next();tn!==null&&!tr.done;Rn++,tr=Kt.next()){tn.index>Rn?(Gn=tn,tn=null):Gn=tn.sibling;var ou=Vt(wt,tn,tr.value,os);if(ou===null){tn===null&&(tn=Gn);break}l&&tn&&ou.alternate===null&&d(wt,tn),Rt=w(ou,Rt,Rn),er===null?on=ou:er.sibling=ou,er=ou,tn=Gn}if(tr.done)return f(wt,tn),Pn&&Qa(wt,Rn),on;if(tn===null){for(;!tr.done;Rn++,tr=Kt.next())tr=us(wt,tr.value,os),tr!==null&&(Rt=w(tr,Rt,Rn),er===null?on=tr:er.sibling=tr,er=tr);return Pn&&Qa(wt,Rn),on}for(tn=x(tn);!tr.done;Rn++,tr=Kt.next())tr=Ht(tn,wt,Rn,tr.value,os),tr!==null&&(l&&tr.alternate!==null&&tn.delete(tr.key===null?Rn:tr.key),Rt=w(tr,Rt,Rn),er===null?on=tr:er.sibling=tr,er=tr);return l&&tn.forEach(function(B3){return d(wt,B3)}),Pn&&Qa(wt,Rn),on}function Tr(wt,Rt,Kt,os){if(typeof Kt=="object"&&Kt!==null&&Kt.type===y&&Kt.key===null&&(Kt=Kt.props.children),typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case g:e:{for(var on=Kt.key;Rt!==null;){if(Rt.key===on){if(on=Kt.type,on===y){if(Rt.tag===7){f(wt,Rt.sibling),os=D(Rt,Kt.props.children),os.return=wt,wt=os;break e}}else if(Rt.elementType===on||typeof on=="object"&&on!==null&&on.$$typeof===B&&kt(on)===Rt.type){f(wt,Rt.sibling),os=D(Rt,Kt.props),xn(os,Kt),os.return=wt,wt=os;break e}f(wt,Rt);break}else d(wt,Rt);Rt=Rt.sibling}Kt.type===y?(os=lc(Kt.props.children,wt.mode,os,Kt.key),os.return=wt,wt=os):(os=Gd(Kt.type,Kt.key,Kt.props,null,wt.mode,os),xn(os,Kt),os.return=wt,wt=os)}return oe(wt);case C:e:{for(on=Kt.key;Rt!==null;){if(Rt.key===on)if(Rt.tag===4&&Rt.stateNode.containerInfo===Kt.containerInfo&&Rt.stateNode.implementation===Kt.implementation){f(wt,Rt.sibling),os=D(Rt,Kt.children||[]),os.return=wt,wt=os;break e}else{f(wt,Rt);break}else d(wt,Rt);Rt=Rt.sibling}os=Wd(Kt,wt.mode,os),os.return=wt,wt=os}return oe(wt);case B:return Kt=kt(Kt),Tr(wt,Rt,Kt,os)}if(H(Kt))return Hs(wt,Rt,Kt,os);if(Y(Kt)){if(on=Y(Kt),typeof on!="function")throw Error(r(150));return Kt=on.call(Kt),fn(wt,Rt,Kt,os)}if(typeof Kt.then=="function")return Tr(wt,Rt,Fs(Kt),os);if(Kt.$$typeof===L)return Tr(wt,Rt,j0(wt,Kt),os);$s(wt,Kt)}return typeof Kt=="string"&&Kt!==""||typeof Kt=="number"||typeof Kt=="bigint"?(Kt=""+Kt,Rt!==null&&Rt.tag===6?(f(wt,Rt.sibling),os=D(Rt,Kt),os.return=wt,wt=os):(f(wt,Rt),os=ch(Kt,wt.mode,os),os.return=wt,wt=os),oe(wt)):f(wt,Rt)}return function(wt,Rt,Kt,os){try{qs=0;var on=Tr(wt,Rt,Kt,os);return fs=null,on}catch(tn){if(tn===vt||tn===He)throw tn;var er=aa(29,tn,null,wt.mode);return er.lanes=os,er.return=wt,er}finally{}}}var Or=Ln(!0),Nn=Ln(!1),Ks=!1;function Ts(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wr(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function un(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function En(l,d,f){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(cr&2)!==0){var D=x.pending;return D===null?d.next=d:(d.next=D.next,D.next=d),x.pending=d,d=ia(l),lh(l,null,f),d}return ah(l,x,d,f),ia(l)}function lr(l,d,f){if(d=d.updateQueue,d!==null&&(d=d.shared,(f&4194048)!==0)){var x=d.lanes;x&=l.pendingLanes,f|=x,d.lanes=f,dt(l,f)}}function Ni(l,d){var f=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,f===x)){var D=null,w=null;if(f=f.firstBaseUpdate,f!==null){do{var oe={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};w===null?D=w=oe:w=w.next=oe,f=f.next}while(f!==null);w===null?D=w=d:w=w.next=d}else D=w=d;f={baseState:x.baseState,firstBaseUpdate:D,lastBaseUpdate:w,shared:x.shared,callbacks:x.callbacks},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=d}var Vi=!1;function Er(){if(Vi){var l=T;if(l!==null)throw l}}function ui(l,d,f,x){Vi=!1;var D=l.updateQueue;Ks=!1;var w=D.firstBaseUpdate,oe=D.lastBaseUpdate,Ae=D.shared.pending;if(Ae!==null){D.shared.pending=null;var pt=Ae,Qt=pt.next;pt.next=null,oe===null?w=Qt:oe.next=Qt,oe=pt;var ns=l.alternate;ns!==null&&(ns=ns.updateQueue,Ae=ns.lastBaseUpdate,Ae!==oe&&(Ae===null?ns.firstBaseUpdate=Qt:Ae.next=Qt,ns.lastBaseUpdate=pt))}if(w!==null){var us=D.baseState;oe=0,ns=Qt=pt=null,Ae=w;do{var Vt=Ae.lane&-536870913,Ht=Vt!==Ae.lane;if(Ht?(Bn&Vt)===Vt:(x&Vt)===Vt){Vt!==0&&Vt===N&&(Vi=!0),ns!==null&&(ns=ns.next={lane:0,tag:Ae.tag,payload:Ae.payload,callback:null,next:null});e:{var Hs=l,fn=Ae;Vt=d;var Tr=f;switch(fn.tag){case 1:if(Hs=fn.payload,typeof Hs=="function"){us=Hs.call(Tr,us,Vt);break e}us=Hs;break e;case 3:Hs.flags=Hs.flags&-65537|128;case 0:if(Hs=fn.payload,Vt=typeof Hs=="function"?Hs.call(Tr,us,Vt):Hs,Vt==null)break e;us=_({},us,Vt);break e;case 2:Ks=!0}}Vt=Ae.callback,Vt!==null&&(l.flags|=64,Ht&&(l.flags|=8192),Ht=D.callbacks,Ht===null?D.callbacks=[Vt]:Ht.push(Vt))}else Ht={lane:Vt,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},ns===null?(Qt=ns=Ht,pt=us):ns=ns.next=Ht,oe|=Vt;if(Ae=Ae.next,Ae===null){if(Ae=D.shared.pending,Ae===null)break;Ht=Ae,Ae=Ht.next,Ht.next=null,D.lastBaseUpdate=Ht,D.shared.pending=null}}while(!0);ns===null&&(pt=us),D.baseState=pt,D.firstBaseUpdate=Qt,D.lastBaseUpdate=ns,w===null&&(D.shared.lanes=0),Jd|=oe,l.lanes=oe,l.memoizedState=us}}function la(l,d){if(typeof l!="function")throw Error(r(191,l));l.call(d)}function hi(l,d){var f=l.callbacks;if(f!==null)for(l.callbacks=null,l=0;l<f.length;l++)la(f[l],d)}var In=R(null),$n=R(0);function Fr(l,d){l=sd,U($n,l),U(In,d),sd=l|d.baseLanes}function Zn(){U($n,sd),U(In,In.current)}function Si(){sd=$n.current,O(In),O($n)}var Kr=R(null),zn=null;function li(l){var d=l.alternate;U(Qn,Qn.current&1),U(Kr,l),zn===null&&(d===null||In.current!==null||d.memoizedState!==null)&&(zn=l)}function or(l){U(Qn,Qn.current),U(Kr,l),zn===null&&(zn=l)}function fi(l){l.tag===22?(U(Qn,Qn.current),U(Kr,l),zn===null&&(zn=l)):mi()}function mi(){U(Qn,Qn.current),U(Kr,Kr.current)}function pr(l){O(Kr),zn===l&&(zn=null),O(Qn)}var Qn=R(0);function oa(l){for(var d=l;d!==null;){if(d.tag===13){var f=d.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||sb(f)||nb(f)))return d}else if(d.tag===19&&(d.memoizedProps.revealOrder==="forwards"||d.memoizedProps.revealOrder==="backwards"||d.memoizedProps.revealOrder==="unstable_legacy-backwards"||d.memoizedProps.revealOrder==="together")){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var qr=0,rn=null,ln=null,Hn=null,Ia=!1,ul=!1,Ca=!1,gi=0,mc=0,gc=null,w0=0;function Dr(){throw Error(r(321))}function jm(l,d){if(d===null)return!1;for(var f=0;f<d.length&&f<l.length;f++)if(!Wi(l[f],d[f]))return!1;return!0}function Om(l,d,f,x,D,w){return qr=w,rn=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,V.H=l===null||l.memoizedState===null?PS:fy,Ca=!1,w=f(x,D),Ca=!1,ul&&(w=Ao(d,f,x,D)),L0(l),w}function L0(l){V.H=Gm;var d=ln!==null&&ln.next!==null;if(qr=0,Hn=ln=rn=null,Ia=!1,mc=0,gc=null,d)throw Error(r(300));l===null||Li||(l=l.dependencies,l!==null&&I0(l)&&(Li=!0))}function Ao(l,d,f,x){rn=l;var D=0;do{if(ul&&(gc=null),mc=0,ul=!1,25<=D)throw Error(r(301));if(D+=1,Hn=ln=null,l.updateQueue!=null){var w=l.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}V.H=AS,w=d(f,x)}while(ul);return w}function ay(){var l=V.H,d=l.useState()[0];return d=typeof d.then=="function"?_c(d):d,l=l.useState()[0],(ln!==null?ln.memoizedState:null)!==l&&(rn.flags|=1024),d}function wm(){var l=gi!==0;return gi=0,l}function Lm(l,d,f){d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~f}function P0(l){if(Ia){for(l=l.memoizedState;l!==null;){var d=l.queue;d!==null&&(d.pending=null),l=l.next}Ia=!1}qr=0,Hn=ln=rn=null,ul=!1,mc=gi=0,gc=null}function wi(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?rn.memoizedState=Hn=l:Hn=Hn.next=l,Hn}function Xr(){if(ln===null){var l=rn.alternate;l=l!==null?l.memoizedState:null}else l=ln.next;var d=Hn===null?rn.memoizedState:Hn.next;if(d!==null)Hn=d,ln=l;else{if(l===null)throw rn.alternate===null?Error(r(467)):Error(r(310));ln=l,l={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},Hn===null?rn.memoizedState=Hn=l:Hn=Hn.next=l}return Hn}function fh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _c(l){var d=mc;return mc+=1,gc===null&&(gc=[]),l=es(gc,l,d),d=rn,(Hn===null?d.memoizedState:Hn.next)===null&&(d=d.alternate,V.H=d===null||d.memoizedState===null?PS:fy),l}function Vd(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return _c(l);if(l.$$typeof===L)return Yi(l)}throw Error(r(438,String(l)))}function $c(l){var d=null,f=rn.updateQueue;if(f!==null&&(d=f.memoCache),d==null){var x=rn.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(d={data:x.data.map(function(D){return D.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),f===null&&(f=fh(),rn.updateQueue=f),f.memoCache=d,f=d.data[d.index],f===void 0)for(f=d.data[d.index]=Array(l),x=0;x<l;x++)f[x]=E;return d.index++,f}function Jl(l,d){return typeof d=="function"?d(l):d}function A0(l){var d=Xr();return $d(d,ln,l)}function $d(l,d,f){var x=l.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=f;var D=l.baseQueue,w=x.pending;if(w!==null){if(D!==null){var oe=D.next;D.next=w.next,w.next=oe}d.baseQueue=D=w,x.pending=null}if(w=l.baseState,D===null)l.memoizedState=w;else{d=D.next;var Ae=oe=null,pt=null,Qt=d,ns=!1;do{var us=Qt.lane&-536870913;if(us!==Qt.lane?(Bn&us)===us:(qr&us)===us){var Vt=Qt.revertLane;if(Vt===0)pt!==null&&(pt=pt.next={lane:0,revertLane:0,gesture:null,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null}),us===N&&(ns=!0);else if((qr&Vt)===Vt){Qt=Qt.next,Vt===N&&(ns=!0);continue}else us={lane:0,revertLane:Qt.revertLane,gesture:null,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},pt===null?(Ae=pt=us,oe=w):pt=pt.next=us,rn.lanes|=Vt,Jd|=Vt;us=Qt.action,Ca&&f(w,us),w=Qt.hasEagerState?Qt.eagerState:f(w,us)}else Vt={lane:us,revertLane:Qt.revertLane,gesture:Qt.gesture,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},pt===null?(Ae=pt=Vt,oe=w):pt=pt.next=Vt,rn.lanes|=us,Jd|=us;Qt=Qt.next}while(Qt!==null&&Qt!==d);if(pt===null?oe=w:pt.next=Ae,!Wi(w,l.memoizedState)&&(Li=!0,ns&&(f=T,f!==null)))throw f;l.memoizedState=w,l.baseState=oe,l.baseQueue=pt,x.lastRenderedState=w}return D===null&&(x.lanes=0),[l.memoizedState,x.dispatch]}function k0(l){var d=Xr(),f=d.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=l;var x=f.dispatch,D=f.pending,w=d.memoizedState;if(D!==null){f.pending=null;var oe=D=D.next;do w=l(w,oe.action),oe=oe.next;while(oe!==D);Wi(w,d.memoizedState)||(Li=!0),d.memoizedState=w,d.baseQueue===null&&(d.baseState=w),f.lastRenderedState=w}return[w,x]}function U0(l,d,f){var x=rn,D=Xr(),w=Pn;if(w){if(f===void 0)throw Error(r(407));f=f()}else f=d();var oe=!Wi((ln||D).memoizedState,f);if(oe&&(D.memoizedState=f,Li=!0),D=D.queue,ly(Am.bind(null,x,D,l),[l]),D.getSnapshot!==d||oe||Hn!==null&&Hn.memoizedState.tag&1){if(x.flags|=2048,Hc(9,{destroy:void 0},Pm.bind(null,x,D,f,d),null),wr===null)throw Error(r(349));w||(qr&127)!==0||ko(x,d,f)}return f}function ko(l,d,f){l.flags|=16384,l={getSnapshot:d,value:f},d=rn.updateQueue,d===null?(d=fh(),rn.updateQueue=d,d.stores=[l]):(f=d.stores,f===null?d.stores=[l]:f.push(l))}function Pm(l,d,f,x){d.value=f,d.getSnapshot=x,K_(d)&&km(l)}function Am(l,d,f){return f(function(){K_(d)&&km(l)})}function K_(l){var d=l.getSnapshot;l=l.value;try{var f=d();return!Wi(l,f)}catch{return!0}}function km(l){var d=Lo(l,2);d!==null&&_l(d,l,2)}function xc(l){var d=wi();if(typeof l=="function"){var f=l;if(l=f(),Ca){Fe(!0);try{f()}finally{Fe(!1)}}}return d.memoizedState=d.baseState=l,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:l},d}function Q_(l,d,f,x){return l.baseState=f,$d(l,ln,typeof x=="function"?x:Jl)}function Y_(l,d,f,x,D){if(H_(l))throw Error(r(485));if(l=d.action,l!==null){var w={payload:D,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(oe){w.listeners.push(oe)}};V.T!==null?f(!0):w.isTransition=!1,x(w),f=d.pending,f===null?(w.next=d.pending=w,V_(d,w)):(w.next=f.next,d.pending=f.next=w)}}function V_(l,d){var f=d.action,x=d.payload,D=l.state;if(d.isTransition){var w=V.T,oe={};V.T=oe;try{var Ae=f(D,x),pt=V.S;pt!==null&&pt(oe,Ae),Um(l,d,Ae)}catch(Qt){zc(l,d,Qt)}finally{w!==null&&oe.types!==null&&(w.types=oe.types),V.T=w}}else try{w=f(D,x),Um(l,d,w)}catch(Qt){zc(l,d,Qt)}}function Um(l,d,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(x){$_(l,d,x)},function(x){return zc(l,d,x)}):$_(l,d,f)}function $_(l,d,f){d.status="fulfilled",d.value=f,B0(d),l.state=f,d=l.pending,d!==null&&(f=d.next,f===d?l.pending=null:(f=f.next,d.next=f,V_(l,f)))}function zc(l,d,f){var x=l.pending;if(l.pending=null,x!==null){x=x.next;do d.status="rejected",d.reason=f,B0(d),d=d.next;while(d!==x)}l.action=null}function B0(l){l=l.listeners;for(var d=0;d<l.length;d++)(0,l[d])()}function mh(l,d){return d}function Zl(l,d){if(Pn){var f=wr.formState;if(f!==null){e:{var x=rn;if(Pn){if(jr){t:{for(var D=jr,w=Hr;D.nodeType!==8;){if(!w){D=null;break t}if(D=eo(D.nextSibling),D===null){D=null;break t}}w=D.data,D=w==="F!"||w==="F"?D:null}if(D){jr=eo(D.nextSibling),x=D.data==="F!";break e}}cc(x)}x=!1}x&&(d=f[0])}}return f=wi(),f.memoizedState=f.baseState=d,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:d},f.queue=x,f=OS.bind(null,rn,x),x.dispatch=f,x=xc(!1),w=hy.bind(null,rn,!1,x.queue),x=wi(),D={state:d,dispatch:null,action:l,pending:null},x.queue=D,f=Y_.bind(null,rn,D,w,f),D.dispatch=f,x.memoizedState=l,[d,f,!1]}function Uo(l){var d=Xr();return Bo(d,ln,l)}function Bo(l,d,f){if(d=$d(l,d,mh)[0],l=A0(Jl)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var x=_c(d)}catch(oe){throw oe===vt?He:oe}else x=d;d=Xr();var D=d.queue,w=D.dispatch;return f!==d.memoizedState&&(rn.flags|=2048,Hc(9,{destroy:void 0},G0.bind(null,D,f),null)),[x,w,l]}function G0(l,d){l.action=d}function W0(l){var d=Xr(),f=ln;if(f!==null)return Bo(d,f,l);Xr(),d=d.memoizedState,f=Xr();var x=f.queue.dispatch;return f.memoizedState=l,[d,x,!1]}function Hc(l,d,f,x){return l={tag:l,create:f,deps:x,inst:d,next:null},d=rn.updateQueue,d===null&&(d=fh(),rn.updateQueue=d),f=d.lastEffect,f===null?d.lastEffect=l.next=l:(x=f.next,f.next=l,l.next=x,d.lastEffect=l),l}function z_(){return Xr().memoizedState}function zd(l,d,f,x){var D=wi();rn.flags|=l,D.memoizedState=Hc(1|d,{destroy:void 0},f,x===void 0?null:x)}function Hd(l,d,f,x){var D=Xr();x=x===void 0?null:x;var w=D.memoizedState.inst;ln!==null&&x!==null&&jm(x,ln.memoizedState.deps)?D.memoizedState=Hc(d,w,f,x):(rn.flags|=l,D.memoizedState=Hc(1|d,w,f,x))}function pS(l,d){zd(8390656,8,l,d)}function ly(l,d){Hd(2048,8,l,d)}function wO(l){rn.flags|=4;var d=rn.updateQueue;if(d===null)d=fh(),rn.updateQueue=d,d.events=[l];else{var f=d.events;f===null?d.events=[l]:f.push(l)}}function yS(l){var d=Xr().memoizedState;return wO({ref:d,nextImpl:l}),function(){if((cr&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}function bS(l,d){return Hd(4,2,l,d)}function CS(l,d){return Hd(4,4,l,d)}function NS(l,d){if(typeof d=="function"){l=l();var f=d(l);return function(){typeof f=="function"?f():d(null)}}if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function SS(l,d,f){f=f!=null?f.concat([l]):null,Hd(4,4,NS.bind(null,d,l),f)}function oy(){}function vS(l,d){var f=Xr();d=d===void 0?null:d;var x=f.memoizedState;return d!==null&&jm(d,x[1])?x[0]:(f.memoizedState=[l,d],l)}function ES(l,d){var f=Xr();d=d===void 0?null:d;var x=f.memoizedState;if(d!==null&&jm(d,x[1]))return x[0];if(x=l(),Ca){Fe(!0);try{l()}finally{Fe(!1)}}return f.memoizedState=[x,d],x}function cy(l,d,f){return f===void 0||(qr&1073741824)!==0&&(Bn&261930)===0?l.memoizedState=d:(l.memoizedState=f,l=Dv(),rn.lanes|=l,Jd|=l,f)}function DS(l,d,f,x){return Wi(f,d)?f:In.current!==null?(l=cy(l,f,x),Wi(l,d)||(Li=!0),l):(qr&42)===0||(qr&1073741824)!==0&&(Bn&261930)===0?(Li=!0,l.memoizedState=f):(l=Dv(),rn.lanes|=l,Jd|=l,d)}function RS(l,d,f,x,D){var w=K.p;K.p=w!==0&&8>w?w:8;var oe=V.T,Ae={};V.T=Ae,hy(l,!1,d,f);try{var pt=D(),Qt=V.S;if(Qt!==null&&Qt(Ae,pt),pt!==null&&typeof pt=="object"&&typeof pt.then=="function"){var ns=Se(pt,x);Bm(l,d,ns,Bl(l))}else Bm(l,d,x,Bl(l))}catch(us){Bm(l,d,{then:function(){},status:"rejected",reason:us},Bl())}finally{K.p=w,oe!==null&&Ae.types!==null&&(oe.types=Ae.types),V.T=oe}}function LO(){}function dy(l,d,f,x){if(l.tag!==5)throw Error(r(476));var D=TS(l).queue;RS(l,D,d,j,f===null?LO:function(){return MS(l),f(x)})}function TS(l){var d=l.memoizedState;if(d!==null)return d;d={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:j},next:null};var f={};return d.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:f},next:null},l.memoizedState=d,l=l.alternate,l!==null&&(l.memoizedState=d),d}function MS(l){var d=TS(l);d.next===null&&(d=l.alternate.memoizedState),Bm(l,d.next.queue,{},Bl())}function uy(){return Yi(sg)}function IS(){return Xr().memoizedState}function jS(){return Xr().memoizedState}function PO(l){for(var d=l.return;d!==null;){switch(d.tag){case 24:case 3:var f=Bl();l=un(f);var x=En(d,l,f);x!==null&&(_l(x,d,f),lr(x,d,f)),d={cache:Yd()},l.payload=d;return}d=d.return}}function AO(l,d,f){var x=Bl();f={lane:x,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},H_(l)?wS(d,f):(f=N0(l,d,f,x),f!==null&&(_l(f,l,x),LS(f,d,x)))}function OS(l,d,f){var x=Bl();Bm(l,d,f,x)}function Bm(l,d,f,x){var D={lane:x,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(H_(l))wS(d,D);else{var w=l.alternate;if(l.lanes===0&&(w===null||w.lanes===0)&&(w=d.lastRenderedReducer,w!==null))try{var oe=d.lastRenderedState,Ae=w(oe,f);if(D.hasEagerState=!0,D.eagerState=Ae,Wi(Ae,oe))return ah(l,d,D,0),wr===null&&ih(),!1}catch{}finally{}if(f=N0(l,d,D,x),f!==null)return _l(f,l,x),LS(f,d,x),!0}return!1}function hy(l,d,f,x){if(x={lane:2,revertLane:Qy(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},H_(l)){if(d)throw Error(r(479))}else d=N0(l,f,x,2),d!==null&&_l(d,l,2)}function H_(l){var d=l.alternate;return l===rn||d!==null&&d===rn}function wS(l,d){ul=Ia=!0;var f=l.pending;f===null?d.next=d:(d.next=f.next,f.next=d),l.pending=d}function LS(l,d,f){if((f&4194048)!==0){var x=d.lanes;x&=l.pendingLanes,f|=x,d.lanes=f,dt(l,f)}}var Gm={readContext:Yi,use:Vd,useCallback:Dr,useContext:Dr,useEffect:Dr,useImperativeHandle:Dr,useLayoutEffect:Dr,useInsertionEffect:Dr,useMemo:Dr,useReducer:Dr,useRef:Dr,useState:Dr,useDebugValue:Dr,useDeferredValue:Dr,useTransition:Dr,useSyncExternalStore:Dr,useId:Dr,useHostTransitionStatus:Dr,useFormState:Dr,useActionState:Dr,useOptimistic:Dr,useMemoCache:Dr,useCacheRefresh:Dr};Gm.useEffectEvent=Dr;var PS={readContext:Yi,use:Vd,useCallback:function(l,d){return wi().memoizedState=[l,d===void 0?null:d],l},useContext:Yi,useEffect:pS,useImperativeHandle:function(l,d,f){f=f!=null?f.concat([l]):null,zd(4194308,4,NS.bind(null,d,l),f)},useLayoutEffect:function(l,d){return zd(4194308,4,l,d)},useInsertionEffect:function(l,d){zd(4,2,l,d)},useMemo:function(l,d){var f=wi();d=d===void 0?null:d;var x=l();if(Ca){Fe(!0);try{l()}finally{Fe(!1)}}return f.memoizedState=[x,d],x},useReducer:function(l,d,f){var x=wi();if(f!==void 0){var D=f(d);if(Ca){Fe(!0);try{f(d)}finally{Fe(!1)}}}else D=d;return x.memoizedState=x.baseState=D,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:D},x.queue=l,l=l.dispatch=AO.bind(null,rn,l),[x.memoizedState,l]},useRef:function(l){var d=wi();return l={current:l},d.memoizedState=l},useState:function(l){l=xc(l);var d=l.queue,f=OS.bind(null,rn,d);return d.dispatch=f,[l.memoizedState,f]},useDebugValue:oy,useDeferredValue:function(l,d){var f=wi();return cy(f,l,d)},useTransition:function(){var l=xc(!1);return l=RS.bind(null,rn,l.queue,!0,!1),wi().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,d,f){var x=rn,D=wi();if(Pn){if(f===void 0)throw Error(r(407));f=f()}else{if(f=d(),wr===null)throw Error(r(349));(Bn&127)!==0||ko(x,d,f)}D.memoizedState=f;var w={value:f,getSnapshot:d};return D.queue=w,pS(Am.bind(null,x,w,l),[l]),x.flags|=2048,Hc(9,{destroy:void 0},Pm.bind(null,x,w,f,d),null),f},useId:function(){var l=wi(),d=wr.identifierPrefix;if(Pn){var f=cl,x=ol;f=(x&~(1<<32-nt(x)-1)).toString(32)+f,d="_"+d+"R_"+f,f=gi++,0<f&&(d+="H"+f.toString(32)),d+="_"}else f=w0++,d="_"+d+"r_"+f.toString(32)+"_";return l.memoizedState=d},useHostTransitionStatus:uy,useFormState:Zl,useActionState:Zl,useOptimistic:function(l){var d=wi();d.memoizedState=d.baseState=l;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=f,d=hy.bind(null,rn,!0,f),f.dispatch=d,[l,d]},useMemoCache:$c,useCacheRefresh:function(){return wi().memoizedState=PO.bind(null,rn)},useEffectEvent:function(l){var d=wi(),f={impl:l};return d.memoizedState=f,function(){if((cr&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},fy={readContext:Yi,use:Vd,useCallback:vS,useContext:Yi,useEffect:ly,useImperativeHandle:SS,useInsertionEffect:bS,useLayoutEffect:CS,useMemo:ES,useReducer:A0,useRef:z_,useState:function(){return A0(Jl)},useDebugValue:oy,useDeferredValue:function(l,d){var f=Xr();return DS(f,ln.memoizedState,l,d)},useTransition:function(){var l=A0(Jl)[0],d=Xr().memoizedState;return[typeof l=="boolean"?l:_c(l),d]},useSyncExternalStore:U0,useId:IS,useHostTransitionStatus:uy,useFormState:Uo,useActionState:Uo,useOptimistic:function(l,d){var f=Xr();return Q_(f,ln,l,d)},useMemoCache:$c,useCacheRefresh:jS};fy.useEffectEvent=yS;var AS={readContext:Yi,use:Vd,useCallback:vS,useContext:Yi,useEffect:ly,useImperativeHandle:SS,useInsertionEffect:bS,useLayoutEffect:CS,useMemo:ES,useReducer:k0,useRef:z_,useState:function(){return k0(Jl)},useDebugValue:oy,useDeferredValue:function(l,d){var f=Xr();return ln===null?cy(f,l,d):DS(f,ln.memoizedState,l,d)},useTransition:function(){var l=k0(Jl)[0],d=Xr().memoizedState;return[typeof l=="boolean"?l:_c(l),d]},useSyncExternalStore:U0,useId:IS,useHostTransitionStatus:uy,useFormState:W0,useActionState:W0,useOptimistic:function(l,d){var f=Xr();return ln!==null?Q_(f,ln,l,d):(f.baseState=l,[l,f.queue.dispatch])},useMemoCache:$c,useCacheRefresh:jS};AS.useEffectEvent=yS;function my(l,d,f,x){d=l.memoizedState,f=f(x,d),f=f==null?d:_({},d,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var gy={enqueueSetState:function(l,d,f){l=l._reactInternals;var x=Bl(),D=un(x);D.payload=d,f!=null&&(D.callback=f),d=En(l,D,x),d!==null&&(_l(d,l,x),lr(d,l,x))},enqueueReplaceState:function(l,d,f){l=l._reactInternals;var x=Bl(),D=un(x);D.tag=1,D.payload=d,f!=null&&(D.callback=f),d=En(l,D,x),d!==null&&(_l(d,l,x),lr(d,l,x))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var f=Bl(),x=un(f);x.tag=2,d!=null&&(x.callback=d),d=En(l,x,f),d!==null&&(_l(d,l,f),lr(d,l,f))}};function kS(l,d,f,x,D,w,oe){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,w,oe):d.prototype&&d.prototype.isPureReactComponent?!Io(f,x)||!Io(D,w):!0}function US(l,d,f,x){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(f,x),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(f,x),d.state!==l&&gy.enqueueReplaceState(d,d.state,null)}function gh(l,d){var f=d;if("ref"in d){f={};for(var x in d)x!=="ref"&&(f[x]=d[x])}if(l=l.defaultProps){f===d&&(f=_({},f));for(var D in l)f[D]===void 0&&(f[D]=l[D])}return f}function BS(l){rh(l)}function GS(l){console.error(l)}function WS(l){rh(l)}function q_(l,d){try{var f=l.onUncaughtError;f(d.value,{componentStack:d.stack})}catch(x){setTimeout(function(){throw x})}}function FS(l,d,f){try{var x=l.onCaughtError;x(f.value,{componentStack:f.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function _y(l,d,f){return f=un(f),f.tag=3,f.payload={element:null},f.callback=function(){q_(l,d)},f}function KS(l){return l=un(l),l.tag=3,l}function QS(l,d,f,x){var D=f.type.getDerivedStateFromError;if(typeof D=="function"){var w=x.value;l.payload=function(){return D(w)},l.callback=function(){FS(d,f,x)}}var oe=f.stateNode;oe!==null&&typeof oe.componentDidCatch=="function"&&(l.callback=function(){FS(d,f,x),typeof D!="function"&&(Zd===null?Zd=new Set([this]):Zd.add(this));var Ae=x.stack;this.componentDidCatch(x.value,{componentStack:Ae!==null?Ae:""})})}function kO(l,d,f,x,D){if(f.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(d=f.alternate,d!==null&&hc(d,f,D,!0),f=Kr.current,f!==null){switch(f.tag){case 31:case 13:return zn===null?ox():f.alternate===null&&_i===0&&(_i=3),f.flags&=-257,f.flags|=65536,f.lanes=D,x===Tt?f.flags|=16384:(d=f.updateQueue,d===null?f.updateQueue=new Set([x]):d.add(x),Wy(l,x,D)),!1;case 22:return f.flags|=65536,x===Tt?f.flags|=16384:(d=f.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([x])},f.updateQueue=d):(f=d.retryQueue,f===null?d.retryQueue=new Set([x]):f.add(x)),Wy(l,x,D)),!1}throw Error(r(435,f.tag))}return Wy(l,x,D),ox(),!1}if(Pn)return d=Kr.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=D,x!==Al&&(l=Error(r(422),{cause:x}),Kd(il(l,f)))):(x!==Al&&(d=Error(r(423),{cause:x}),Kd(il(d,f))),l=l.current.alternate,l.flags|=65536,D&=-D,l.lanes|=D,x=il(x,f),D=_y(l.stateNode,x,D),Ni(l,D),_i!==4&&(_i=2)),!1;var w=Error(r(520),{cause:x});if(w=il(w,f),zm===null?zm=[w]:zm.push(w),_i!==4&&(_i=2),d===null)return!0;x=il(x,f),f=d;do{switch(f.tag){case 3:return f.flags|=65536,l=D&-D,f.lanes|=l,l=_y(f.stateNode,x,l),Ni(f,l),!1;case 1:if(d=f.type,w=f.stateNode,(f.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Zd===null||!Zd.has(w))))return f.flags|=65536,D&=-D,f.lanes|=D,D=KS(D),QS(D,l,f,x),Ni(f,D),!1}f=f.return}while(f!==null);return!1}var xy=Error(r(461)),Li=!1;function Na(l,d,f,x){d.child=l===null?Nn(d,null,f,x):Or(d,l.child,f,x)}function YS(l,d,f,x,D){f=f.render;var w=d.ref;if("ref"in x){var oe={};for(var Ae in x)Ae!=="ref"&&(oe[Ae]=x[Ae])}else oe=x;return fc(d),x=Om(l,d,f,oe,w,D),Ae=wm(),l!==null&&!Li?(Lm(l,d,D),qc(l,d,D)):(Pn&&Ae&&Tm(d),d.flags|=1,Na(l,d,x,D),d.child)}function VS(l,d,f,x,D){if(l===null){var w=f.type;return typeof w=="function"&&!v0(w)&&w.defaultProps===void 0&&f.compare===null?(d.tag=15,d.type=w,$S(l,d,w,x,D)):(l=Gd(f.type,null,x,d,d.mode,D),l.ref=d.ref,l.return=d,d.child=l)}if(w=l.child,!Ey(l,D)){var oe=w.memoizedProps;if(f=f.compare,f=f!==null?f:Io,f(oe,x)&&l.ref===d.ref)return qc(l,d,D)}return d.flags|=1,l=rl(w,x),l.ref=d.ref,l.return=d,d.child=l}function $S(l,d,f,x,D){if(l!==null){var w=l.memoizedProps;if(Io(w,x)&&l.ref===d.ref)if(Li=!1,d.pendingProps=x=w,Ey(l,D))(l.flags&131072)!==0&&(Li=!0);else return d.lanes=l.lanes,qc(l,d,D)}return py(l,d,f,x,D)}function zS(l,d,f,x){var D=x.children,w=l!==null?l.memoizedState:null;if(l===null&&d.stateNode===null&&(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((d.flags&128)!==0){if(w=w!==null?w.baseLanes|f:f,l!==null){for(x=d.child=l.child,D=0;x!==null;)D=D|x.lanes|x.childLanes,x=x.sibling;x=D&~w}else x=0,d.child=null;return HS(l,d,w,f,x)}if((f&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},l!==null&&Qe(d,w!==null?w.cachePool:null),w!==null?Fr(d,w):Zn(),fi(d);else return x=d.lanes=536870912,HS(l,d,w!==null?w.baseLanes|f:f,f,x)}else w!==null?(Qe(d,w.cachePool),Fr(d,w),mi(),d.memoizedState=null):(l!==null&&Qe(d,null),Zn(),mi());return Na(l,d,D,f),d.child}function Wm(l,d){return l!==null&&l.tag===22||d.stateNode!==null||(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.sibling}function HS(l,d,f,x,D){var w=We();return w=w===null?null:{parent:ai._currentValue,pool:w},d.memoizedState={baseLanes:f,cachePool:w},l!==null&&Qe(d,null),Zn(),fi(d),l!==null&&hc(l,d,x,!0),d.childLanes=D,null}function X_(l,d){return d=Z_({mode:d.mode,children:d.children},l.mode),d.ref=l.ref,l.child=d,d.return=l,d}function qS(l,d,f){return Or(d,l.child,null,f),l=X_(d,d.pendingProps),l.flags|=2,pr(d),d.memoizedState=null,l}function UO(l,d,f){var x=d.pendingProps,D=(d.flags&128)!==0;if(d.flags&=-129,l===null){if(Pn){if(x.mode==="hidden")return l=X_(d,x),d.lanes=536870912,Wm(null,l);if(or(d),(l=jr)?(l=o5(l,Hr),l=l!==null&&l.data==="&"?l:null,l!==null&&(d.memoizedState={dehydrated:l,treeContext:oc!==null?{id:ol,overflow:cl}:null,retryLane:536870912,hydrationErrors:null},f=E0(l),f.return=d,d.child=f,Ki=d,jr=null)):l=null,l===null)throw cc(d);return d.lanes=536870912,null}return X_(d,x)}var w=l.memoizedState;if(w!==null){var oe=w.dehydrated;if(or(d),D)if(d.flags&256)d.flags&=-257,d=qS(l,d,f);else if(d.memoizedState!==null)d.child=l.child,d.flags|=128,d=null;else throw Error(r(558));else if(Li||hc(l,d,f,!1),D=(f&l.childLanes)!==0,Li||D){if(x=wr,x!==null&&(oe=gt(x,f),oe!==0&&oe!==w.retryLane))throw w.retryLane=oe,Lo(l,oe),_l(x,l,oe),xy;ox(),d=qS(l,d,f)}else l=w.treeContext,jr=eo(oe.nextSibling),Ki=d,Pn=!0,ba=null,Hr=!1,l!==null&&W_(d,l),d=X_(d,x),d.flags|=4096;return d}return l=rl(l.child,{mode:x.mode,children:x.children}),l.ref=d.ref,d.child=l,l.return=d,l}function J_(l,d){var f=d.ref;if(f===null)l!==null&&l.ref!==null&&(d.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(l===null||l.ref!==f)&&(d.flags|=4194816)}}function py(l,d,f,x,D){return fc(d),f=Om(l,d,f,x,void 0,D),x=wm(),l!==null&&!Li?(Lm(l,d,D),qc(l,d,D)):(Pn&&x&&Tm(d),d.flags|=1,Na(l,d,f,D),d.child)}function XS(l,d,f,x,D,w){return fc(d),d.updateQueue=null,f=Ao(d,x,f,D),L0(l),x=wm(),l!==null&&!Li?(Lm(l,d,w),qc(l,d,w)):(Pn&&x&&Tm(d),d.flags|=1,Na(l,d,f,w),d.child)}function JS(l,d,f,x,D){if(fc(d),d.stateNode===null){var w=Fi,oe=f.contextType;typeof oe=="object"&&oe!==null&&(w=Yi(oe)),w=new f(x,w),d.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=gy,d.stateNode=w,w._reactInternals=d,w=d.stateNode,w.props=x,w.state=d.memoizedState,w.refs={},Ts(d),oe=f.contextType,w.context=typeof oe=="object"&&oe!==null?Yi(oe):Fi,w.state=d.memoizedState,oe=f.getDerivedStateFromProps,typeof oe=="function"&&(my(d,f,oe,x),w.state=d.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(oe=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),oe!==w.state&&gy.enqueueReplaceState(w,w.state,null),ui(d,x,w,D),Er(),w.state=d.memoizedState),typeof w.componentDidMount=="function"&&(d.flags|=4194308),x=!0}else if(l===null){w=d.stateNode;var Ae=d.memoizedProps,pt=gh(f,Ae);w.props=pt;var Qt=w.context,ns=f.contextType;oe=Fi,typeof ns=="object"&&ns!==null&&(oe=Yi(ns));var us=f.getDerivedStateFromProps;ns=typeof us=="function"||typeof w.getSnapshotBeforeUpdate=="function",Ae=d.pendingProps!==Ae,ns||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(Ae||Qt!==oe)&&US(d,w,x,oe),Ks=!1;var Vt=d.memoizedState;w.state=Vt,ui(d,x,w,D),Er(),Qt=d.memoizedState,Ae||Vt!==Qt||Ks?(typeof us=="function"&&(my(d,f,us,x),Qt=d.memoizedState),(pt=Ks||kS(d,f,pt,x,Vt,Qt,oe))?(ns||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(d.flags|=4194308)):(typeof w.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=x,d.memoizedState=Qt),w.props=x,w.state=Qt,w.context=oe,x=pt):(typeof w.componentDidMount=="function"&&(d.flags|=4194308),x=!1)}else{w=d.stateNode,Wr(l,d),oe=d.memoizedProps,ns=gh(f,oe),w.props=ns,us=d.pendingProps,Vt=w.context,Qt=f.contextType,pt=Fi,typeof Qt=="object"&&Qt!==null&&(pt=Yi(Qt)),Ae=f.getDerivedStateFromProps,(Qt=typeof Ae=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(oe!==us||Vt!==pt)&&US(d,w,x,pt),Ks=!1,Vt=d.memoizedState,w.state=Vt,ui(d,x,w,D),Er();var Ht=d.memoizedState;oe!==us||Vt!==Ht||Ks||l!==null&&l.dependencies!==null&&I0(l.dependencies)?(typeof Ae=="function"&&(my(d,f,Ae,x),Ht=d.memoizedState),(ns=Ks||kS(d,f,ns,x,Vt,Ht,pt)||l!==null&&l.dependencies!==null&&I0(l.dependencies))?(Qt||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(x,Ht,pt),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(x,Ht,pt)),typeof w.componentDidUpdate=="function"&&(d.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof w.componentDidUpdate!="function"||oe===l.memoizedProps&&Vt===l.memoizedState||(d.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||oe===l.memoizedProps&&Vt===l.memoizedState||(d.flags|=1024),d.memoizedProps=x,d.memoizedState=Ht),w.props=x,w.state=Ht,w.context=pt,x=ns):(typeof w.componentDidUpdate!="function"||oe===l.memoizedProps&&Vt===l.memoizedState||(d.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||oe===l.memoizedProps&&Vt===l.memoizedState||(d.flags|=1024),x=!1)}return w=x,J_(l,d),x=(d.flags&128)!==0,w||x?(w=d.stateNode,f=x&&typeof f.getDerivedStateFromError!="function"?null:w.render(),d.flags|=1,l!==null&&x?(d.child=Or(d,l.child,null,D),d.child=Or(d,null,f,D)):Na(l,d,f,D),d.memoizedState=w.state,l=d.child):l=qc(l,d,D),l}function ZS(l,d,f,x){return Yc(),d.flags|=256,Na(l,d,f,x),d.child}var yy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function by(l){return{baseLanes:l,cachePool:Xe()}}function Cy(l,d,f){return l=l!==null?l.childLanes&~f:0,d&&(l|=Ul),l}function ev(l,d,f){var x=d.pendingProps,D=!1,w=(d.flags&128)!==0,oe;if((oe=w)||(oe=l!==null&&l.memoizedState===null?!1:(Qn.current&2)!==0),oe&&(D=!0,d.flags&=-129),oe=(d.flags&32)!==0,d.flags&=-33,l===null){if(Pn){if(D?li(d):mi(),(l=jr)?(l=o5(l,Hr),l=l!==null&&l.data!=="&"?l:null,l!==null&&(d.memoizedState={dehydrated:l,treeContext:oc!==null?{id:ol,overflow:cl}:null,retryLane:536870912,hydrationErrors:null},f=E0(l),f.return=d,d.child=f,Ki=d,jr=null)):l=null,l===null)throw cc(d);return nb(l)?d.lanes=32:d.lanes=536870912,null}var Ae=x.children;return x=x.fallback,D?(mi(),D=d.mode,Ae=Z_({mode:"hidden",children:Ae},D),x=lc(x,D,f,null),Ae.return=d,x.return=d,Ae.sibling=x,d.child=Ae,x=d.child,x.memoizedState=by(f),x.childLanes=Cy(l,oe,f),d.memoizedState=yy,Wm(null,x)):(li(d),Ny(d,Ae))}var pt=l.memoizedState;if(pt!==null&&(Ae=pt.dehydrated,Ae!==null)){if(w)d.flags&256?(li(d),d.flags&=-257,d=Sy(l,d,f)):d.memoizedState!==null?(mi(),d.child=l.child,d.flags|=128,d=null):(mi(),Ae=x.fallback,D=d.mode,x=Z_({mode:"visible",children:x.children},D),Ae=lc(Ae,D,f,null),Ae.flags|=2,x.return=d,Ae.return=d,x.sibling=Ae,d.child=x,Or(d,l.child,null,f),x=d.child,x.memoizedState=by(f),x.childLanes=Cy(l,oe,f),d.memoizedState=yy,d=Wm(null,x));else if(li(d),nb(Ae)){if(oe=Ae.nextSibling&&Ae.nextSibling.dataset,oe)var Qt=oe.dgst;oe=Qt,x=Error(r(419)),x.stack="",x.digest=oe,Kd({value:x,source:null,stack:null}),d=Sy(l,d,f)}else if(Li||hc(l,d,f,!1),oe=(f&l.childLanes)!==0,Li||oe){if(oe=wr,oe!==null&&(x=gt(oe,f),x!==0&&x!==pt.retryLane))throw pt.retryLane=x,Lo(l,x),_l(oe,l,x),xy;sb(Ae)||ox(),d=Sy(l,d,f)}else sb(Ae)?(d.flags|=192,d.child=l.child,d=null):(l=pt.treeContext,jr=eo(Ae.nextSibling),Ki=d,Pn=!0,ba=null,Hr=!1,l!==null&&W_(d,l),d=Ny(d,x.children),d.flags|=4096);return d}return D?(mi(),Ae=x.fallback,D=d.mode,pt=l.child,Qt=pt.sibling,x=rl(pt,{mode:"hidden",children:x.children}),x.subtreeFlags=pt.subtreeFlags&65011712,Qt!==null?Ae=rl(Qt,Ae):(Ae=lc(Ae,D,f,null),Ae.flags|=2),Ae.return=d,x.return=d,x.sibling=Ae,d.child=x,Wm(null,x),x=d.child,Ae=l.child.memoizedState,Ae===null?Ae=by(f):(D=Ae.cachePool,D!==null?(pt=ai._currentValue,D=D.parent!==pt?{parent:pt,pool:pt}:D):D=Xe(),Ae={baseLanes:Ae.baseLanes|f,cachePool:D}),x.memoizedState=Ae,x.childLanes=Cy(l,oe,f),d.memoizedState=yy,Wm(l.child,x)):(li(d),f=l.child,l=f.sibling,f=rl(f,{mode:"visible",children:x.children}),f.return=d,f.sibling=null,l!==null&&(oe=d.deletions,oe===null?(d.deletions=[l],d.flags|=16):oe.push(l)),d.child=f,d.memoizedState=null,f)}function Ny(l,d){return d=Z_({mode:"visible",children:d},l.mode),d.return=l,l.child=d}function Z_(l,d){return l=aa(22,l,null,d),l.lanes=0,l}function Sy(l,d,f){return Or(d,l.child,null,f),l=Ny(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function tv(l,d,f){l.lanes|=d;var x=l.alternate;x!==null&&(x.lanes|=d),Qd(l.return,d,f)}function vy(l,d,f,x,D,w){var oe=l.memoizedState;oe===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:x,tail:f,tailMode:D,treeForkCount:w}:(oe.isBackwards=d,oe.rendering=null,oe.renderingStartTime=0,oe.last=x,oe.tail=f,oe.tailMode=D,oe.treeForkCount=w)}function sv(l,d,f){var x=d.pendingProps,D=x.revealOrder,w=x.tail;x=x.children;var oe=Qn.current,Ae=(oe&2)!==0;if(Ae?(oe=oe&1|2,d.flags|=128):oe&=1,U(Qn,oe),Na(l,d,x,f),x=Pn?dh:0,!Ae&&l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&tv(l,f,d);else if(l.tag===19)tv(l,f,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(D){case"forwards":for(f=d.child,D=null;f!==null;)l=f.alternate,l!==null&&oa(l)===null&&(D=f),f=f.sibling;f=D,f===null?(D=d.child,d.child=null):(D=f.sibling,f.sibling=null),vy(d,!1,D,f,w,x);break;case"backwards":case"unstable_legacy-backwards":for(f=null,D=d.child,d.child=null;D!==null;){if(l=D.alternate,l!==null&&oa(l)===null){d.child=D;break}l=D.sibling,D.sibling=f,f=D,D=l}vy(d,!0,f,null,w,x);break;case"together":vy(d,!1,null,null,void 0,x);break;default:d.memoizedState=null}return d.child}function qc(l,d,f){if(l!==null&&(d.dependencies=l.dependencies),Jd|=d.lanes,(f&d.childLanes)===0)if(l!==null){if(hc(l,d,f,!1),(f&d.childLanes)===0)return null}else return null;if(l!==null&&d.child!==l.child)throw Error(r(153));if(d.child!==null){for(l=d.child,f=rl(l,l.pendingProps),d.child=f,f.return=d;l.sibling!==null;)l=l.sibling,f=f.sibling=rl(l,l.pendingProps),f.return=d;f.sibling=null}return d.child}function Ey(l,d){return(l.lanes&d)!==0?!0:(l=l.dependencies,!!(l!==null&&I0(l)))}function BO(l,d,f){switch(d.tag){case 3:ae(d,d.stateNode.containerInfo),uc(d,ai,l.memoizedState.cache),Yc();break;case 27:case 5:ie(d);break;case 4:ae(d,d.stateNode.containerInfo);break;case 10:uc(d,d.type,d.memoizedProps.value);break;case 31:if(d.memoizedState!==null)return d.flags|=128,or(d),null;break;case 13:var x=d.memoizedState;if(x!==null)return x.dehydrated!==null?(li(d),d.flags|=128,null):(f&d.child.childLanes)!==0?ev(l,d,f):(li(d),l=qc(l,d,f),l!==null?l.sibling:null);li(d);break;case 19:var D=(l.flags&128)!==0;if(x=(f&d.childLanes)!==0,x||(hc(l,d,f,!1),x=(f&d.childLanes)!==0),D){if(x)return sv(l,d,f);d.flags|=128}if(D=d.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),U(Qn,Qn.current),x)break;return null;case 22:return d.lanes=0,zS(l,d,f,d.pendingProps);case 24:uc(d,ai,l.memoizedState.cache)}return qc(l,d,f)}function nv(l,d,f){if(l!==null)if(l.memoizedProps!==d.pendingProps)Li=!0;else{if(!Ey(l,f)&&(d.flags&128)===0)return Li=!1,BO(l,d,f);Li=(l.flags&131072)!==0}else Li=!1,Pn&&(d.flags&1048576)!==0&&G_(d,dh,d.index);switch(d.lanes=0,d.tag){case 16:e:{var x=d.pendingProps;if(l=kt(d.elementType),d.type=l,typeof l=="function")v0(l)?(x=gh(l,x),d.tag=1,d=JS(null,d,l,x,f)):(d.tag=0,d=py(null,d,l,x,f));else{if(l!=null){var D=l.$$typeof;if(D===M){d.tag=11,d=YS(null,d,l,x,f);break e}else if(D===G){d.tag=14,d=VS(null,d,l,x,f);break e}}throw d=J(l)||l,Error(r(306,d,""))}}return d;case 0:return py(l,d,d.type,d.pendingProps,f);case 1:return x=d.type,D=gh(x,d.pendingProps),JS(l,d,x,D,f);case 3:e:{if(ae(d,d.stateNode.containerInfo),l===null)throw Error(r(387));x=d.pendingProps;var w=d.memoizedState;D=w.element,Wr(l,d),ui(d,x,null,f);var oe=d.memoizedState;if(x=oe.cache,uc(d,ai,x),x!==w.cache&&Vc(d,[ai],f,!0),Er(),x=oe.element,w.isDehydrated)if(w={element:x,isDehydrated:!1,cache:oe.cache},d.updateQueue.baseState=w,d.memoizedState=w,d.flags&256){d=ZS(l,d,x,f);break e}else if(x!==D){D=il(Error(r(424)),d),Kd(D),d=ZS(l,d,x,f);break e}else{switch(l=d.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(jr=eo(l.firstChild),Ki=d,Pn=!0,ba=null,Hr=!0,f=Nn(d,null,x,f),d.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Yc(),x===D){d=qc(l,d,f);break e}Na(l,d,x,f)}d=d.child}return d;case 26:return J_(l,d),l===null?(f=m5(d.type,null,d.pendingProps,null))?d.memoizedState=f:Pn||(f=d.type,l=d.pendingProps,x=gx($.current).createElement(f),x[ls]=d,x[ds]=l,Sa(x,f,l),je(x),d.stateNode=x):d.memoizedState=m5(d.type,l.memoizedProps,d.pendingProps,l.memoizedState),null;case 27:return ie(d),l===null&&Pn&&(x=d.stateNode=u5(d.type,d.pendingProps,$.current),Ki=d,Hr=!0,D=jr,nu(d.type)?(rb=D,jr=eo(x.firstChild)):jr=D),Na(l,d,d.pendingProps.children,f),J_(l,d),l===null&&(d.flags|=4194304),d.child;case 5:return l===null&&Pn&&((D=x=jr)&&(x=g3(x,d.type,d.pendingProps,Hr),x!==null?(d.stateNode=x,Ki=d,jr=eo(x.firstChild),Hr=!1,D=!0):D=!1),D||cc(d)),ie(d),D=d.type,w=d.pendingProps,oe=l!==null?l.memoizedProps:null,x=w.children,Zy(D,w)?x=null:oe!==null&&Zy(D,oe)&&(d.flags|=32),d.memoizedState!==null&&(D=Om(l,d,ay,null,null,f),sg._currentValue=D),J_(l,d),Na(l,d,x,f),d.child;case 6:return l===null&&Pn&&((l=f=jr)&&(f=_3(f,d.pendingProps,Hr),f!==null?(d.stateNode=f,Ki=d,jr=null,l=!0):l=!1),l||cc(d)),null;case 13:return ev(l,d,f);case 4:return ae(d,d.stateNode.containerInfo),x=d.pendingProps,l===null?d.child=Or(d,null,x,f):Na(l,d,x,f),d.child;case 11:return YS(l,d,d.type,d.pendingProps,f);case 7:return Na(l,d,d.pendingProps,f),d.child;case 8:return Na(l,d,d.pendingProps.children,f),d.child;case 12:return Na(l,d,d.pendingProps.children,f),d.child;case 10:return x=d.pendingProps,uc(d,d.type,x.value),Na(l,d,x.children,f),d.child;case 9:return D=d.type._context,x=d.pendingProps.children,fc(d),D=Yi(D),x=x(D),d.flags|=1,Na(l,d,x,f),d.child;case 14:return VS(l,d,d.type,d.pendingProps,f);case 15:return $S(l,d,d.type,d.pendingProps,f);case 19:return sv(l,d,f);case 31:return UO(l,d,f);case 22:return zS(l,d,f,d.pendingProps);case 24:return fc(d),x=Yi(ai),l===null?(D=We(),D===null&&(D=wr,w=Yd(),D.pooledCache=w,w.refCount++,w!==null&&(D.pooledCacheLanes|=f),D=w),d.memoizedState={parent:x,cache:D},Ts(d),uc(d,ai,D)):((l.lanes&f)!==0&&(Wr(l,d),ui(d,null,null,f),Er()),D=l.memoizedState,w=d.memoizedState,D.parent!==x?(D={parent:x,cache:x},d.memoizedState=D,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=D),uc(d,ai,x)):(x=w.cache,uc(d,ai,x),x!==D.cache&&Vc(d,[ai],f,!0))),Na(l,d,d.pendingProps.children,f),d.child;case 29:throw d.pendingProps}throw Error(r(156,d.tag))}function Xc(l){l.flags|=4}function Dy(l,d,f,x,D){if((d=(l.mode&32)!==0)&&(d=!1),d){if(l.flags|=16777216,(D&335544128)===D)if(l.stateNode.complete)l.flags|=8192;else if(Iv())l.flags|=8192;else throw Jt=Tt,Gt}else l.flags&=-16777217}function rv(l,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!y5(d))if(Iv())l.flags|=8192;else throw Jt=Tt,Gt}function ex(l,d){d!==null&&(l.flags|=4),l.flags&16384&&(d=l.tag!==22?we():536870912,l.lanes|=d,Y0|=d)}function Fm(l,d){if(!Pn)switch(l.tailMode){case"hidden":d=l.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var x=null;f!==null;)f.alternate!==null&&(x=f),f=f.sibling;x===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function Qr(l){var d=l.alternate!==null&&l.alternate.child===l.child,f=0,x=0;if(d)for(var D=l.child;D!==null;)f|=D.lanes|D.childLanes,x|=D.subtreeFlags&65011712,x|=D.flags&65011712,D.return=l,D=D.sibling;else for(D=l.child;D!==null;)f|=D.lanes|D.childLanes,x|=D.subtreeFlags,x|=D.flags,D.return=l,D=D.sibling;return l.subtreeFlags|=x,l.childLanes=f,d}function GO(l,d,f){var x=d.pendingProps;switch(T0(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qr(d),null;case 1:return Qr(d),null;case 3:return f=d.stateNode,x=null,l!==null&&(x=l.memoizedState.cache),d.memoizedState.cache!==x&&(d.flags|=2048),dl(ai),_e(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(l===null||l.child===null)&&(Qi(d)?Xc(d):l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Im())),Qr(d),null;case 26:var D=d.type,w=d.memoizedState;return l===null?(Xc(d),w!==null?(Qr(d),rv(d,w)):(Qr(d),Dy(d,D,null,x,f))):w?w!==l.memoizedState?(Xc(d),Qr(d),rv(d,w)):(Qr(d),d.flags&=-16777217):(l=l.memoizedProps,l!==x&&Xc(d),Qr(d),Dy(d,D,l,x,f)),null;case 27:if(Ne(d),f=$.current,D=d.type,l!==null&&d.stateNode!=null)l.memoizedProps!==x&&Xc(d);else{if(!x){if(d.stateNode===null)throw Error(r(166));return Qr(d),null}l=Q.current,Qi(d)?Mm(d):(l=u5(D,x,f),d.stateNode=l,Xc(d))}return Qr(d),null;case 5:if(Ne(d),D=d.type,l!==null&&d.stateNode!=null)l.memoizedProps!==x&&Xc(d);else{if(!x){if(d.stateNode===null)throw Error(r(166));return Qr(d),null}if(w=Q.current,Qi(d))Mm(d);else{var oe=gx($.current);switch(w){case 1:w=oe.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:w=oe.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":w=oe.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":w=oe.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":w=oe.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof x.is=="string"?oe.createElement("select",{is:x.is}):oe.createElement("select"),x.multiple?w.multiple=!0:x.size&&(w.size=x.size);break;default:w=typeof x.is=="string"?oe.createElement(D,{is:x.is}):oe.createElement(D)}}w[ls]=d,w[ds]=x;e:for(oe=d.child;oe!==null;){if(oe.tag===5||oe.tag===6)w.appendChild(oe.stateNode);else if(oe.tag!==4&&oe.tag!==27&&oe.child!==null){oe.child.return=oe,oe=oe.child;continue}if(oe===d)break e;for(;oe.sibling===null;){if(oe.return===null||oe.return===d)break e;oe=oe.return}oe.sibling.return=oe.return,oe=oe.sibling}d.stateNode=w;e:switch(Sa(w,D,x),D){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Xc(d)}}return Qr(d),Dy(d,d.type,l===null?null:l.memoizedProps,d.pendingProps,f),null;case 6:if(l&&d.stateNode!=null)l.memoizedProps!==x&&Xc(d);else{if(typeof x!="string"&&d.stateNode===null)throw Error(r(166));if(l=$.current,Qi(d)){if(l=d.stateNode,f=d.memoizedProps,x=null,D=Ki,D!==null)switch(D.tag){case 27:case 5:x=D.memoizedProps}l[ls]=d,l=!!(l.nodeValue===f||x!==null&&x.suppressHydrationWarning===!0||e5(l.nodeValue,f)),l||cc(d,!0)}else l=gx(l).createTextNode(x),l[ls]=d,d.stateNode=l}return Qr(d),null;case 31:if(f=d.memoizedState,l===null||l.memoizedState!==null){if(x=Qi(d),f!==null){if(l===null){if(!x)throw Error(r(318));if(l=d.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(557));l[ls]=d}else Yc(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Qr(d),l=!1}else f=Im(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=f),l=!0;if(!l)return d.flags&256?(pr(d),d):(pr(d),null);if((d.flags&128)!==0)throw Error(r(558))}return Qr(d),null;case 13:if(x=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(D=Qi(d),x!==null&&x.dehydrated!==null){if(l===null){if(!D)throw Error(r(318));if(D=d.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(r(317));D[ls]=d}else Yc(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Qr(d),D=!1}else D=Im(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=D),D=!0;if(!D)return d.flags&256?(pr(d),d):(pr(d),null)}return pr(d),(d.flags&128)!==0?(d.lanes=f,d):(f=x!==null,l=l!==null&&l.memoizedState!==null,f&&(x=d.child,D=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(D=x.alternate.memoizedState.cachePool.pool),w=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(w=x.memoizedState.cachePool.pool),w!==D&&(x.flags|=2048)),f!==l&&f&&(d.child.flags|=8192),ex(d,d.updateQueue),Qr(d),null);case 4:return _e(),l===null&&zy(d.stateNode.containerInfo),Qr(d),null;case 10:return dl(d.type),Qr(d),null;case 19:if(O(Qn),x=d.memoizedState,x===null)return Qr(d),null;if(D=(d.flags&128)!==0,w=x.rendering,w===null)if(D)Fm(x,!1);else{if(_i!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(w=oa(l),w!==null){for(d.flags|=128,Fm(x,!1),l=w.updateQueue,d.updateQueue=l,ex(d,l),d.subtreeFlags=0,l=f,f=d.child;f!==null;)oh(f,l),f=f.sibling;return U(Qn,Qn.current&1|2),Pn&&Qa(d,x.treeForkCount),d.child}l=l.sibling}x.tail!==null&&et()>ix&&(d.flags|=128,D=!0,Fm(x,!1),d.lanes=4194304)}else{if(!D)if(l=oa(w),l!==null){if(d.flags|=128,D=!0,l=l.updateQueue,d.updateQueue=l,ex(d,l),Fm(x,!0),x.tail===null&&x.tailMode==="hidden"&&!w.alternate&&!Pn)return Qr(d),null}else 2*et()-x.renderingStartTime>ix&&f!==536870912&&(d.flags|=128,D=!0,Fm(x,!1),d.lanes=4194304);x.isBackwards?(w.sibling=d.child,d.child=w):(l=x.last,l!==null?l.sibling=w:d.child=w,x.last=w)}return x.tail!==null?(l=x.tail,x.rendering=l,x.tail=l.sibling,x.renderingStartTime=et(),l.sibling=null,f=Qn.current,U(Qn,D?f&1|2:f&1),Pn&&Qa(d,x.treeForkCount),l):(Qr(d),null);case 22:case 23:return pr(d),Si(),x=d.memoizedState!==null,l!==null?l.memoizedState!==null!==x&&(d.flags|=8192):x&&(d.flags|=8192),x?(f&536870912)!==0&&(d.flags&128)===0&&(Qr(d),d.subtreeFlags&6&&(d.flags|=8192)):Qr(d),f=d.updateQueue,f!==null&&ex(d,f.retryQueue),f=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),x=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==f&&(d.flags|=2048),l!==null&&O(Le),null;case 24:return f=null,l!==null&&(f=l.memoizedState.cache),d.memoizedState.cache!==f&&(d.flags|=2048),dl(ai),Qr(d),null;case 25:return null;case 30:return null}throw Error(r(156,d.tag))}function WO(l,d){switch(T0(d),d.tag){case 1:return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return dl(ai),_e(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 26:case 27:case 5:return Ne(d),null;case 31:if(d.memoizedState!==null){if(pr(d),d.alternate===null)throw Error(r(340));Yc()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 13:if(pr(d),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(r(340));Yc()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return O(Qn),null;case 4:return _e(),null;case 10:return dl(d.type),null;case 22:case 23:return pr(d),Si(),l!==null&&O(Le),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 24:return dl(ai),null;case 25:return null;default:return null}}function iv(l,d){switch(T0(d),d.tag){case 3:dl(ai),_e();break;case 26:case 27:case 5:Ne(d);break;case 4:_e();break;case 31:d.memoizedState!==null&&pr(d);break;case 13:pr(d);break;case 19:O(Qn);break;case 10:dl(d.type);break;case 22:case 23:pr(d),Si(),l!==null&&O(Le);break;case 24:dl(ai)}}function Km(l,d){try{var f=d.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var D=x.next;f=D;do{if((f.tag&l)===l){x=void 0;var w=f.create,oe=f.inst;x=w(),oe.destroy=x}f=f.next}while(f!==D)}}catch(Ae){br(d,d.return,Ae)}}function qd(l,d,f){try{var x=d.updateQueue,D=x!==null?x.lastEffect:null;if(D!==null){var w=D.next;x=w;do{if((x.tag&l)===l){var oe=x.inst,Ae=oe.destroy;if(Ae!==void 0){oe.destroy=void 0,D=d;var pt=f,Qt=Ae;try{Qt()}catch(ns){br(D,pt,ns)}}}x=x.next}while(x!==w)}}catch(ns){br(d,d.return,ns)}}function av(l){var d=l.updateQueue;if(d!==null){var f=l.stateNode;try{hi(d,f)}catch(x){br(l,l.return,x)}}}function lv(l,d,f){f.props=gh(l.type,l.memoizedProps),f.state=l.memoizedState;try{f.componentWillUnmount()}catch(x){br(l,d,x)}}function Qm(l,d){try{var f=l.ref;if(f!==null){switch(l.tag){case 26:case 27:case 5:var x=l.stateNode;break;case 30:x=l.stateNode;break;default:x=l.stateNode}typeof f=="function"?l.refCleanup=f(x):f.current=x}}catch(D){br(l,d,D)}}function pc(l,d){var f=l.ref,x=l.refCleanup;if(f!==null)if(typeof x=="function")try{x()}catch(D){br(l,d,D)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(D){br(l,d,D)}else f.current=null}function ov(l){var d=l.type,f=l.memoizedProps,x=l.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":f.autoFocus&&x.focus();break e;case"img":f.src?x.src=f.src:f.srcSet&&(x.srcset=f.srcSet)}}catch(D){br(l,l.return,D)}}function Ry(l,d,f){try{var x=l.stateNode;c3(x,l.type,f,d),x[ds]=d}catch(D){br(l,l.return,D)}}function cv(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&nu(l.type)||l.tag===4}function Ty(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||cv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&nu(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function My(l,d,f){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(l,d):(d=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,d.appendChild(l),f=f._reactRootContainer,f!=null||d.onclick!==null||(d.onclick=hs));else if(x!==4&&(x===27&&nu(l.type)&&(f=l.stateNode,d=null),l=l.child,l!==null))for(My(l,d,f),l=l.sibling;l!==null;)My(l,d,f),l=l.sibling}function tx(l,d,f){var x=l.tag;if(x===5||x===6)l=l.stateNode,d?f.insertBefore(l,d):f.appendChild(l);else if(x!==4&&(x===27&&nu(l.type)&&(f=l.stateNode),l=l.child,l!==null))for(tx(l,d,f),l=l.sibling;l!==null;)tx(l,d,f),l=l.sibling}function dv(l){var d=l.stateNode,f=l.memoizedProps;try{for(var x=l.type,D=d.attributes;D.length;)d.removeAttributeNode(D[0]);Sa(d,x,f),d[ls]=l,d[ds]=f}catch(w){br(l,l.return,w)}}var Jc=!1,Pi=!1,Iy=!1,uv=typeof WeakSet=="function"?WeakSet:Set,ca=null;function FO(l,d){if(l=l.containerInfo,Xy=Nx,l=Oo(l),Hl(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var x=f.getSelection&&f.getSelection();if(x&&x.rangeCount!==0){f=x.anchorNode;var D=x.anchorOffset,w=x.focusNode;x=x.focusOffset;try{f.nodeType,w.nodeType}catch{f=null;break e}var oe=0,Ae=-1,pt=-1,Qt=0,ns=0,us=l,Vt=null;t:for(;;){for(var Ht;us!==f||D!==0&&us.nodeType!==3||(Ae=oe+D),us!==w||x!==0&&us.nodeType!==3||(pt=oe+x),us.nodeType===3&&(oe+=us.nodeValue.length),(Ht=us.firstChild)!==null;)Vt=us,us=Ht;for(;;){if(us===l)break t;if(Vt===f&&++Qt===D&&(Ae=oe),Vt===w&&++ns===x&&(pt=oe),(Ht=us.nextSibling)!==null)break;us=Vt,Vt=us.parentNode}us=Ht}f=Ae===-1||pt===-1?null:{start:Ae,end:pt}}else f=null}f=f||{start:0,end:0}}else f=null;for(Jy={focusedElem:l,selectionRange:f},Nx=!1,ca=d;ca!==null;)if(d=ca,l=d.child,(d.subtreeFlags&1028)!==0&&l!==null)l.return=d,ca=l;else for(;ca!==null;){switch(d=ca,w=d.alternate,l=d.flags,d.tag){case 0:if((l&4)!==0&&(l=d.updateQueue,l=l!==null?l.events:null,l!==null))for(f=0;f<l.length;f++)D=l[f],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&w!==null){l=void 0,f=d,D=w.memoizedProps,w=w.memoizedState,x=f.stateNode;try{var Hs=gh(f.type,D);l=x.getSnapshotBeforeUpdate(Hs,w),x.__reactInternalSnapshotBeforeUpdate=l}catch(fn){br(f,f.return,fn)}}break;case 3:if((l&1024)!==0){if(l=d.stateNode.containerInfo,f=l.nodeType,f===9)tb(l);else if(f===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":tb(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(r(163))}if(l=d.sibling,l!==null){l.return=d.return,ca=l;break}ca=d.return}}function hv(l,d,f){var x=f.flags;switch(f.tag){case 0:case 11:case 15:ed(l,f),x&4&&Km(5,f);break;case 1:if(ed(l,f),x&4)if(l=f.stateNode,d===null)try{l.componentDidMount()}catch(oe){br(f,f.return,oe)}else{var D=gh(f.type,d.memoizedProps);d=d.memoizedState;try{l.componentDidUpdate(D,d,l.__reactInternalSnapshotBeforeUpdate)}catch(oe){br(f,f.return,oe)}}x&64&&av(f),x&512&&Qm(f,f.return);break;case 3:if(ed(l,f),x&64&&(l=f.updateQueue,l!==null)){if(d=null,f.child!==null)switch(f.child.tag){case 27:case 5:d=f.child.stateNode;break;case 1:d=f.child.stateNode}try{hi(l,d)}catch(oe){br(f,f.return,oe)}}break;case 27:d===null&&x&4&&dv(f);case 26:case 5:ed(l,f),d===null&&x&4&&ov(f),x&512&&Qm(f,f.return);break;case 12:ed(l,f);break;case 31:ed(l,f),x&4&&gv(l,f);break;case 13:ed(l,f),x&4&&_v(l,f),x&64&&(l=f.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(f=XO.bind(null,f),x3(l,f))));break;case 22:if(x=f.memoizedState!==null||Jc,!x){d=d!==null&&d.memoizedState!==null||Pi,D=Jc;var w=Pi;Jc=x,(Pi=d)&&!w?td(l,f,(f.subtreeFlags&8772)!==0):ed(l,f),Jc=D,Pi=w}break;case 30:break;default:ed(l,f)}}function fv(l){var d=l.alternate;d!==null&&(l.alternate=null,fv(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&_t(d)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var Jr=null,hl=!1;function Zc(l,d,f){for(f=f.child;f!==null;)mv(l,d,f),f=f.sibling}function mv(l,d,f){if(it&&typeof it.onCommitFiberUnmount=="function")try{it.onCommitFiberUnmount(Ve,f)}catch{}switch(f.tag){case 26:Pi||pc(f,d),Zc(l,d,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Pi||pc(f,d);var x=Jr,D=hl;nu(f.type)&&(Jr=f.stateNode,hl=!1),Zc(l,d,f),Zm(f.stateNode),Jr=x,hl=D;break;case 5:Pi||pc(f,d);case 6:if(x=Jr,D=hl,Jr=null,Zc(l,d,f),Jr=x,hl=D,Jr!==null)if(hl)try{(Jr.nodeType===9?Jr.body:Jr.nodeName==="HTML"?Jr.ownerDocument.body:Jr).removeChild(f.stateNode)}catch(w){br(f,d,w)}else try{Jr.removeChild(f.stateNode)}catch(w){br(f,d,w)}break;case 18:Jr!==null&&(hl?(l=Jr,a5(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,f.stateNode),Z0(l)):a5(Jr,f.stateNode));break;case 4:x=Jr,D=hl,Jr=f.stateNode.containerInfo,hl=!0,Zc(l,d,f),Jr=x,hl=D;break;case 0:case 11:case 14:case 15:qd(2,f,d),Pi||qd(4,f,d),Zc(l,d,f);break;case 1:Pi||(pc(f,d),x=f.stateNode,typeof x.componentWillUnmount=="function"&&lv(f,d,x)),Zc(l,d,f);break;case 21:Zc(l,d,f);break;case 22:Pi=(x=Pi)||f.memoizedState!==null,Zc(l,d,f),Pi=x;break;default:Zc(l,d,f)}}function gv(l,d){if(d.memoizedState===null&&(l=d.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{Z0(l)}catch(f){br(d,d.return,f)}}}function _v(l,d){if(d.memoizedState===null&&(l=d.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Z0(l)}catch(f){br(d,d.return,f)}}function KO(l){switch(l.tag){case 31:case 13:case 19:var d=l.stateNode;return d===null&&(d=l.stateNode=new uv),d;case 22:return l=l.stateNode,d=l._retryCache,d===null&&(d=l._retryCache=new uv),d;default:throw Error(r(435,l.tag))}}function sx(l,d){var f=KO(l);d.forEach(function(x){if(!f.has(x)){f.add(x);var D=JO.bind(null,l,x);x.then(D,D)}})}function fl(l,d){var f=d.deletions;if(f!==null)for(var x=0;x<f.length;x++){var D=f[x],w=l,oe=d,Ae=oe;e:for(;Ae!==null;){switch(Ae.tag){case 27:if(nu(Ae.type)){Jr=Ae.stateNode,hl=!1;break e}break;case 5:Jr=Ae.stateNode,hl=!1;break e;case 3:case 4:Jr=Ae.stateNode.containerInfo,hl=!0;break e}Ae=Ae.return}if(Jr===null)throw Error(r(160));mv(w,oe,D),Jr=null,hl=!1,w=D.alternate,w!==null&&(w.return=null),D.return=null}if(d.subtreeFlags&13886)for(d=d.child;d!==null;)xv(d,l),d=d.sibling}var Go=null;function xv(l,d){var f=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:fl(d,l),ml(l),x&4&&(qd(3,l,l.return),Km(3,l),qd(5,l,l.return));break;case 1:fl(d,l),ml(l),x&512&&(Pi||f===null||pc(f,f.return)),x&64&&Jc&&(l=l.updateQueue,l!==null&&(x=l.callbacks,x!==null&&(f=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=f===null?x:f.concat(x))));break;case 26:var D=Go;if(fl(d,l),ml(l),x&512&&(Pi||f===null||pc(f,f.return)),x&4){var w=f!==null?f.memoizedState:null;if(x=l.memoizedState,f===null)if(x===null)if(l.stateNode===null){e:{x=l.type,f=l.memoizedProps,D=D.ownerDocument||D;t:switch(x){case"title":w=D.getElementsByTagName("title")[0],(!w||w[Ft]||w[ls]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=D.createElement(x),D.head.insertBefore(w,D.querySelector("head > title"))),Sa(w,x,f),w[ls]=l,je(w),x=w;break e;case"link":var oe=x5("link","href",D).get(x+(f.href||""));if(oe){for(var Ae=0;Ae<oe.length;Ae++)if(w=oe[Ae],w.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&w.getAttribute("rel")===(f.rel==null?null:f.rel)&&w.getAttribute("title")===(f.title==null?null:f.title)&&w.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){oe.splice(Ae,1);break t}}w=D.createElement(x),Sa(w,x,f),D.head.appendChild(w);break;case"meta":if(oe=x5("meta","content",D).get(x+(f.content||""))){for(Ae=0;Ae<oe.length;Ae++)if(w=oe[Ae],w.getAttribute("content")===(f.content==null?null:""+f.content)&&w.getAttribute("name")===(f.name==null?null:f.name)&&w.getAttribute("property")===(f.property==null?null:f.property)&&w.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&w.getAttribute("charset")===(f.charSet==null?null:f.charSet)){oe.splice(Ae,1);break t}}w=D.createElement(x),Sa(w,x,f),D.head.appendChild(w);break;default:throw Error(r(468,x))}w[ls]=l,je(w),x=w}l.stateNode=x}else p5(D,l.type,l.stateNode);else l.stateNode=_5(D,x,l.memoizedProps);else w!==x?(w===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):w.count--,x===null?p5(D,l.type,l.stateNode):_5(D,x,l.memoizedProps)):x===null&&l.stateNode!==null&&Ry(l,l.memoizedProps,f.memoizedProps)}break;case 27:fl(d,l),ml(l),x&512&&(Pi||f===null||pc(f,f.return)),f!==null&&x&4&&Ry(l,l.memoizedProps,f.memoizedProps);break;case 5:if(fl(d,l),ml(l),x&512&&(Pi||f===null||pc(f,f.return)),l.flags&32){D=l.stateNode;try{rt(D,"")}catch(Hs){br(l,l.return,Hs)}}x&4&&l.stateNode!=null&&(D=l.memoizedProps,Ry(l,D,f!==null?f.memoizedProps:D)),x&1024&&(Iy=!0);break;case 6:if(fl(d,l),ml(l),x&4){if(l.stateNode===null)throw Error(r(162));x=l.memoizedProps,f=l.stateNode;try{f.nodeValue=x}catch(Hs){br(l,l.return,Hs)}}break;case 3:if(px=null,D=Go,Go=_x(d.containerInfo),fl(d,l),Go=D,ml(l),x&4&&f!==null&&f.memoizedState.isDehydrated)try{Z0(d.containerInfo)}catch(Hs){br(l,l.return,Hs)}Iy&&(Iy=!1,pv(l));break;case 4:x=Go,Go=_x(l.stateNode.containerInfo),fl(d,l),ml(l),Go=x;break;case 12:fl(d,l),ml(l);break;case 31:fl(d,l),ml(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,sx(l,x)));break;case 13:fl(d,l),ml(l),l.child.flags&8192&&l.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(rx=et()),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,sx(l,x)));break;case 22:D=l.memoizedState!==null;var pt=f!==null&&f.memoizedState!==null,Qt=Jc,ns=Pi;if(Jc=Qt||D,Pi=ns||pt,fl(d,l),Pi=ns,Jc=Qt,ml(l),x&8192)e:for(d=l.stateNode,d._visibility=D?d._visibility&-2:d._visibility|1,D&&(f===null||pt||Jc||Pi||_h(l)),f=null,d=l;;){if(d.tag===5||d.tag===26){if(f===null){pt=f=d;try{if(w=pt.stateNode,D)oe=w.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none";else{Ae=pt.stateNode;var us=pt.memoizedProps.style,Vt=us!=null&&us.hasOwnProperty("display")?us.display:null;Ae.style.display=Vt==null||typeof Vt=="boolean"?"":(""+Vt).trim()}}catch(Hs){br(pt,pt.return,Hs)}}}else if(d.tag===6){if(f===null){pt=d;try{pt.stateNode.nodeValue=D?"":pt.memoizedProps}catch(Hs){br(pt,pt.return,Hs)}}}else if(d.tag===18){if(f===null){pt=d;try{var Ht=pt.stateNode;D?l5(Ht,!0):l5(pt.stateNode,!1)}catch(Hs){br(pt,pt.return,Hs)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===l)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break e;for(;d.sibling===null;){if(d.return===null||d.return===l)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}x&4&&(x=l.updateQueue,x!==null&&(f=x.retryQueue,f!==null&&(x.retryQueue=null,sx(l,f))));break;case 19:fl(d,l),ml(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,sx(l,x)));break;case 30:break;case 21:break;default:fl(d,l),ml(l)}}function ml(l){var d=l.flags;if(d&2){try{for(var f,x=l.return;x!==null;){if(cv(x)){f=x;break}x=x.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var D=f.stateNode,w=Ty(l);tx(l,w,D);break;case 5:var oe=f.stateNode;f.flags&32&&(rt(oe,""),f.flags&=-33);var Ae=Ty(l);tx(l,Ae,oe);break;case 3:case 4:var pt=f.stateNode.containerInfo,Qt=Ty(l);My(l,Qt,pt);break;default:throw Error(r(161))}}catch(ns){br(l,l.return,ns)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function pv(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var d=l;pv(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),l=l.sibling}}function ed(l,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)hv(l,d.alternate,d),d=d.sibling}function _h(l){for(l=l.child;l!==null;){var d=l;switch(d.tag){case 0:case 11:case 14:case 15:qd(4,d,d.return),_h(d);break;case 1:pc(d,d.return);var f=d.stateNode;typeof f.componentWillUnmount=="function"&&lv(d,d.return,f),_h(d);break;case 27:Zm(d.stateNode);case 26:case 5:pc(d,d.return),_h(d);break;case 22:d.memoizedState===null&&_h(d);break;case 30:_h(d);break;default:_h(d)}l=l.sibling}}function td(l,d,f){for(f=f&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var x=d.alternate,D=l,w=d,oe=w.flags;switch(w.tag){case 0:case 11:case 15:td(D,w,f),Km(4,w);break;case 1:if(td(D,w,f),x=w,D=x.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(Qt){br(x,x.return,Qt)}if(x=w,D=x.updateQueue,D!==null){var Ae=x.stateNode;try{var pt=D.shared.hiddenCallbacks;if(pt!==null)for(D.shared.hiddenCallbacks=null,D=0;D<pt.length;D++)la(pt[D],Ae)}catch(Qt){br(x,x.return,Qt)}}f&&oe&64&&av(w),Qm(w,w.return);break;case 27:dv(w);case 26:case 5:td(D,w,f),f&&x===null&&oe&4&&ov(w),Qm(w,w.return);break;case 12:td(D,w,f);break;case 31:td(D,w,f),f&&oe&4&&gv(D,w);break;case 13:td(D,w,f),f&&oe&4&&_v(D,w);break;case 22:w.memoizedState===null&&td(D,w,f),Qm(w,w.return);break;case 30:break;default:td(D,w,f)}d=d.sibling}}function jy(l,d){var f=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),l=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(l=d.memoizedState.cachePool.pool),l!==f&&(l!=null&&l.refCount++,f!=null&&uh(f))}function Oy(l,d){l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&uh(l))}function Wo(l,d,f,x){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)yv(l,d,f,x),d=d.sibling}function yv(l,d,f,x){var D=d.flags;switch(d.tag){case 0:case 11:case 15:Wo(l,d,f,x),D&2048&&Km(9,d);break;case 1:Wo(l,d,f,x);break;case 3:Wo(l,d,f,x),D&2048&&(l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&uh(l)));break;case 12:if(D&2048){Wo(l,d,f,x),l=d.stateNode;try{var w=d.memoizedProps,oe=w.id,Ae=w.onPostCommit;typeof Ae=="function"&&Ae(oe,d.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(pt){br(d,d.return,pt)}}else Wo(l,d,f,x);break;case 31:Wo(l,d,f,x);break;case 13:Wo(l,d,f,x);break;case 23:break;case 22:w=d.stateNode,oe=d.alternate,d.memoizedState!==null?w._visibility&2?Wo(l,d,f,x):Ym(l,d):w._visibility&2?Wo(l,d,f,x):(w._visibility|=2,F0(l,d,f,x,(d.subtreeFlags&10256)!==0||!1)),D&2048&&jy(oe,d);break;case 24:Wo(l,d,f,x),D&2048&&Oy(d.alternate,d);break;default:Wo(l,d,f,x)}}function F0(l,d,f,x,D){for(D=D&&((d.subtreeFlags&10256)!==0||!1),d=d.child;d!==null;){var w=l,oe=d,Ae=f,pt=x,Qt=oe.flags;switch(oe.tag){case 0:case 11:case 15:F0(w,oe,Ae,pt,D),Km(8,oe);break;case 23:break;case 22:var ns=oe.stateNode;oe.memoizedState!==null?ns._visibility&2?F0(w,oe,Ae,pt,D):Ym(w,oe):(ns._visibility|=2,F0(w,oe,Ae,pt,D)),D&&Qt&2048&&jy(oe.alternate,oe);break;case 24:F0(w,oe,Ae,pt,D),D&&Qt&2048&&Oy(oe.alternate,oe);break;default:F0(w,oe,Ae,pt,D)}d=d.sibling}}function Ym(l,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var f=l,x=d,D=x.flags;switch(x.tag){case 22:Ym(f,x),D&2048&&jy(x.alternate,x);break;case 24:Ym(f,x),D&2048&&Oy(x.alternate,x);break;default:Ym(f,x)}d=d.sibling}}var Vm=8192;function K0(l,d,f){if(l.subtreeFlags&Vm)for(l=l.child;l!==null;)bv(l,d,f),l=l.sibling}function bv(l,d,f){switch(l.tag){case 26:K0(l,d,f),l.flags&Vm&&l.memoizedState!==null&&M3(f,Go,l.memoizedState,l.memoizedProps);break;case 5:K0(l,d,f);break;case 3:case 4:var x=Go;Go=_x(l.stateNode.containerInfo),K0(l,d,f),Go=x;break;case 22:l.memoizedState===null&&(x=l.alternate,x!==null&&x.memoizedState!==null?(x=Vm,Vm=16777216,K0(l,d,f),Vm=x):K0(l,d,f));break;default:K0(l,d,f)}}function Cv(l){var d=l.alternate;if(d!==null&&(l=d.child,l!==null)){d.child=null;do d=l.sibling,l.sibling=null,l=d;while(l!==null)}}function $m(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var f=0;f<d.length;f++){var x=d[f];ca=x,Sv(x,l)}Cv(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Nv(l),l=l.sibling}function Nv(l){switch(l.tag){case 0:case 11:case 15:$m(l),l.flags&2048&&qd(9,l,l.return);break;case 3:$m(l);break;case 12:$m(l);break;case 22:var d=l.stateNode;l.memoizedState!==null&&d._visibility&2&&(l.return===null||l.return.tag!==13)?(d._visibility&=-3,nx(l)):$m(l);break;default:$m(l)}}function nx(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var f=0;f<d.length;f++){var x=d[f];ca=x,Sv(x,l)}Cv(l)}for(l=l.child;l!==null;){switch(d=l,d.tag){case 0:case 11:case 15:qd(8,d,d.return),nx(d);break;case 22:f=d.stateNode,f._visibility&2&&(f._visibility&=-3,nx(d));break;default:nx(d)}l=l.sibling}}function Sv(l,d){for(;ca!==null;){var f=ca;switch(f.tag){case 0:case 11:case 15:qd(8,f,d);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var x=f.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:uh(f.memoizedState.cache)}if(x=f.child,x!==null)x.return=f,ca=x;else e:for(f=l;ca!==null;){x=ca;var D=x.sibling,w=x.return;if(fv(x),x===f){ca=null;break e}if(D!==null){D.return=w,ca=D;break e}ca=w}}}var QO={getCacheForType:function(l){var d=Yi(ai),f=d.data.get(l);return f===void 0&&(f=l(),d.data.set(l,f)),f},cacheSignal:function(){return Yi(ai).controller.signal}},YO=typeof WeakMap=="function"?WeakMap:Map,cr=0,wr=null,An=null,Bn=0,yr=0,kl=null,Xd=!1,Q0=!1,wy=!1,sd=0,_i=0,Jd=0,xh=0,Ly=0,Ul=0,Y0=0,zm=null,gl=null,Py=!1,rx=0,vv=0,ix=1/0,ax=null,Zd=null,$i=0,eu=null,V0=null,nd=0,Ay=0,ky=null,Ev=null,Hm=0,Uy=null;function Bl(){return(cr&2)!==0&&Bn!==0?Bn&-Bn:V.T!==null?Qy():$t()}function Dv(){if(Ul===0)if((Bn&536870912)===0||Pn){var l=Ee;Ee<<=1,(Ee&3932160)===0&&(Ee=262144),Ul=l}else Ul=536870912;return l=Kr.current,l!==null&&(l.flags|=32),Ul}function _l(l,d,f){(l===wr&&(yr===2||yr===9)||l.cancelPendingCommit!==null)&&($0(l,0),tu(l,Bn,Ul,!1)),Pe(l,f),((cr&2)===0||l!==wr)&&(l===wr&&((cr&2)===0&&(xh|=f),_i===4&&tu(l,Bn,Ul,!1)),yc(l))}function Rv(l,d,f){if((cr&6)!==0)throw Error(r(327));var x=!f&&(d&127)===0&&(d&l.expiredLanes)===0||Be(l,d),D=x?zO(l,d):Gy(l,d,!0),w=x;do{if(D===0){Q0&&!x&&tu(l,d,0,!1);break}else{if(f=l.current.alternate,w&&!VO(f)){D=Gy(l,d,!1),w=!1;continue}if(D===2){if(w=d,l.errorRecoveryDisabledLanes&w)var oe=0;else oe=l.pendingLanes&-536870913,oe=oe!==0?oe:oe&536870912?536870912:0;if(oe!==0){d=oe;e:{var Ae=l;D=zm;var pt=Ae.current.memoizedState.isDehydrated;if(pt&&($0(Ae,oe).flags|=256),oe=Gy(Ae,oe,!1),oe!==2){if(wy&&!pt){Ae.errorRecoveryDisabledLanes|=w,xh|=w,D=4;break e}w=gl,gl=D,w!==null&&(gl===null?gl=w:gl.push.apply(gl,w))}D=oe}if(w=!1,D!==2)continue}}if(D===1){$0(l,0),tu(l,d,0,!0);break}e:{switch(x=l,w=D,w){case 0:case 1:throw Error(r(345));case 4:if((d&4194048)!==d)break;case 6:tu(x,d,Ul,!Xd);break e;case 2:gl=null;break;case 3:case 5:break;default:throw Error(r(329))}if((d&62914560)===d&&(D=rx+300-et(),10<D)){if(tu(x,d,Ul,!Xd),ge(x,0,!0)!==0)break e;nd=d,x.timeoutHandle=r5(Tv.bind(null,x,f,gl,ax,Py,d,Ul,xh,Y0,Xd,w,"Throttled",-0,0),D);break e}Tv(x,f,gl,ax,Py,d,Ul,xh,Y0,Xd,w,null,-0,0)}}break}while(!0);yc(l)}function Tv(l,d,f,x,D,w,oe,Ae,pt,Qt,ns,us,Vt,Ht){if(l.timeoutHandle=-1,us=d.subtreeFlags,us&8192||(us&16785408)===16785408){us={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hs},bv(d,w,us);var Hs=(w&62914560)===w?rx-et():(w&4194048)===w?vv-et():0;if(Hs=I3(us,Hs),Hs!==null){nd=w,l.cancelPendingCommit=Hs(Av.bind(null,l,d,w,f,x,D,oe,Ae,pt,ns,us,null,Vt,Ht)),tu(l,w,oe,!Qt);return}}Av(l,d,w,f,x,D,oe,Ae,pt)}function VO(l){for(var d=l;;){var f=d.tag;if((f===0||f===11||f===15)&&d.flags&16384&&(f=d.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var x=0;x<f.length;x++){var D=f[x],w=D.getSnapshot;D=D.value;try{if(!Wi(w(),D))return!1}catch{return!1}}if(f=d.child,d.subtreeFlags&16384&&f!==null)f.return=d,d=f;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function tu(l,d,f,x){d&=~Ly,d&=~xh,l.suspendedLanes|=d,l.pingedLanes&=~d,x&&(l.warmLanes|=d),x=l.expirationTimes;for(var D=d;0<D;){var w=31-nt(D),oe=1<<w;x[w]=-1,D&=~oe}f!==0&&Oe(l,f,d)}function lx(){return(cr&6)===0?(qm(0),!1):!0}function By(){if(An!==null){if(yr===0)var l=An.return;else l=An,Xl=dc=null,P0(l),fs=null,qs=0,l=An;for(;l!==null;)iv(l.alternate,l),l=l.return;An=null}}function $0(l,d){var f=l.timeoutHandle;f!==-1&&(l.timeoutHandle=-1,h3(f)),f=l.cancelPendingCommit,f!==null&&(l.cancelPendingCommit=null,f()),nd=0,By(),wr=l,An=f=rl(l.current,null),Bn=d,yr=0,kl=null,Xd=!1,Q0=Be(l,d),wy=!1,Y0=Ul=Ly=xh=Jd=_i=0,gl=zm=null,Py=!1,(d&8)!==0&&(d|=d&32);var x=l.entangledLanes;if(x!==0)for(l=l.entanglements,x&=d;0<x;){var D=31-nt(x),w=1<<D;d|=l[D],x&=~w}return sd=d,ih(),f}function Mv(l,d){rn=null,V.H=Gm,d===vt||d===He?(d=is(),yr=3):d===Gt?(d=is(),yr=4):yr=d===xy?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,kl=d,An===null&&(_i=1,q_(l,il(d,l.current)))}function Iv(){var l=Kr.current;return l===null?!0:(Bn&4194048)===Bn?zn===null:(Bn&62914560)===Bn||(Bn&536870912)!==0?l===zn:!1}function jv(){var l=V.H;return V.H=Gm,l===null?Gm:l}function Ov(){var l=V.A;return V.A=QO,l}function ox(){_i=4,Xd||(Bn&4194048)!==Bn&&Kr.current!==null||(Q0=!0),(Jd&134217727)===0&&(xh&134217727)===0||wr===null||tu(wr,Bn,Ul,!1)}function Gy(l,d,f){var x=cr;cr|=2;var D=jv(),w=Ov();(wr!==l||Bn!==d)&&(ax=null,$0(l,d)),d=!1;var oe=_i;e:do try{if(yr!==0&&An!==null){var Ae=An,pt=kl;switch(yr){case 8:By(),oe=6;break e;case 3:case 2:case 9:case 6:Kr.current===null&&(d=!0);var Qt=yr;if(yr=0,kl=null,z0(l,Ae,pt,Qt),f&&Q0){oe=0;break e}break;default:Qt=yr,yr=0,kl=null,z0(l,Ae,pt,Qt)}}$O(),oe=_i;break}catch(ns){Mv(l,ns)}while(!0);return d&&l.shellSuspendCounter++,Xl=dc=null,cr=x,V.H=D,V.A=w,An===null&&(wr=null,Bn=0,ih()),oe}function $O(){for(;An!==null;)wv(An)}function zO(l,d){var f=cr;cr|=2;var x=jv(),D=Ov();wr!==l||Bn!==d?(ax=null,ix=et()+500,$0(l,d)):Q0=Be(l,d);e:do try{if(yr!==0&&An!==null){d=An;var w=kl;t:switch(yr){case 1:yr=0,kl=null,z0(l,d,w,1);break;case 2:case 9:if(Pt(w)){yr=0,kl=null,Lv(d);break}d=function(){yr!==2&&yr!==9||wr!==l||(yr=7),yc(l)},w.then(d,d);break e;case 3:yr=7;break e;case 4:yr=5;break e;case 7:Pt(w)?(yr=0,kl=null,Lv(d)):(yr=0,kl=null,z0(l,d,w,7));break;case 5:var oe=null;switch(An.tag){case 26:oe=An.memoizedState;case 5:case 27:var Ae=An;if(oe?y5(oe):Ae.stateNode.complete){yr=0,kl=null;var pt=Ae.sibling;if(pt!==null)An=pt;else{var Qt=Ae.return;Qt!==null?(An=Qt,cx(Qt)):An=null}break t}}yr=0,kl=null,z0(l,d,w,5);break;case 6:yr=0,kl=null,z0(l,d,w,6);break;case 8:By(),_i=6;break e;default:throw Error(r(462))}}HO();break}catch(ns){Mv(l,ns)}while(!0);return Xl=dc=null,V.H=x,V.A=D,cr=f,An!==null?0:(wr=null,Bn=0,ih(),_i)}function HO(){for(;An!==null&&!me();)wv(An)}function wv(l){var d=nv(l.alternate,l,sd);l.memoizedProps=l.pendingProps,d===null?cx(l):An=d}function Lv(l){var d=l,f=d.alternate;switch(d.tag){case 15:case 0:d=XS(f,d,d.pendingProps,d.type,void 0,Bn);break;case 11:d=XS(f,d,d.pendingProps,d.type.render,d.ref,Bn);break;case 5:P0(d);default:iv(f,d),d=An=oh(d,sd),d=nv(f,d,sd)}l.memoizedProps=l.pendingProps,d===null?cx(l):An=d}function z0(l,d,f,x){Xl=dc=null,P0(d),fs=null,qs=0;var D=d.return;try{if(kO(l,D,d,f,Bn)){_i=1,q_(l,il(f,l.current)),An=null;return}}catch(w){if(D!==null)throw An=D,w;_i=1,q_(l,il(f,l.current)),An=null;return}d.flags&32768?(Pn||x===1?l=!0:Q0||(Bn&536870912)!==0?l=!1:(Xd=l=!0,(x===2||x===9||x===3||x===6)&&(x=Kr.current,x!==null&&x.tag===13&&(x.flags|=16384))),Pv(d,l)):cx(d)}function cx(l){var d=l;do{if((d.flags&32768)!==0){Pv(d,Xd);return}l=d.return;var f=GO(d.alternate,d,sd);if(f!==null){An=f;return}if(d=d.sibling,d!==null){An=d;return}An=d=l}while(d!==null);_i===0&&(_i=5)}function Pv(l,d){do{var f=WO(l.alternate,l);if(f!==null){f.flags&=32767,An=f;return}if(f=l.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!d&&(l=l.sibling,l!==null)){An=l;return}An=l=f}while(l!==null);_i=6,An=null}function Av(l,d,f,x,D,w,oe,Ae,pt){l.cancelPendingCommit=null;do dx();while($i!==0);if((cr&6)!==0)throw Error(r(327));if(d!==null){if(d===l.current)throw Error(r(177));if(w=d.lanes|d.childLanes,w|=C0,Nt(l,f,w,oe,Ae,pt),l===wr&&(An=wr=null,Bn=0),V0=d,eu=l,nd=f,Ay=w,ky=D,Ev=x,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,ZO(ct,function(){return Wv(),null})):(l.callbackNode=null,l.callbackPriority=0),x=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,D=K.p,K.p=2,oe=cr,cr|=4;try{FO(l,d,f)}finally{cr=oe,K.p=D,V.T=x}}$i=1,kv(),Uv(),Bv()}}function kv(){if($i===1){$i=0;var l=eu,d=V0,f=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||f){f=V.T,V.T=null;var x=K.p;K.p=2;var D=cr;cr|=4;try{xv(d,l);var w=Jy,oe=Oo(l.containerInfo),Ae=w.focusedElem,pt=w.selectionRange;if(oe!==Ae&&Ae&&Ae.ownerDocument&&jo(Ae.ownerDocument.documentElement,Ae)){if(pt!==null&&Hl(Ae)){var Qt=pt.start,ns=pt.end;if(ns===void 0&&(ns=Qt),"selectionStart"in Ae)Ae.selectionStart=Qt,Ae.selectionEnd=Math.min(ns,Ae.value.length);else{var us=Ae.ownerDocument||document,Vt=us&&us.defaultView||window;if(Vt.getSelection){var Ht=Vt.getSelection(),Hs=Ae.textContent.length,fn=Math.min(pt.start,Hs),Tr=pt.end===void 0?fn:Math.min(pt.end,Hs);!Ht.extend&&fn>Tr&&(oe=Tr,Tr=fn,fn=oe);var wt=Bd(Ae,fn),Rt=Bd(Ae,Tr);if(wt&&Rt&&(Ht.rangeCount!==1||Ht.anchorNode!==wt.node||Ht.anchorOffset!==wt.offset||Ht.focusNode!==Rt.node||Ht.focusOffset!==Rt.offset)){var Kt=us.createRange();Kt.setStart(wt.node,wt.offset),Ht.removeAllRanges(),fn>Tr?(Ht.addRange(Kt),Ht.extend(Rt.node,Rt.offset)):(Kt.setEnd(Rt.node,Rt.offset),Ht.addRange(Kt))}}}}for(us=[],Ht=Ae;Ht=Ht.parentNode;)Ht.nodeType===1&&us.push({element:Ht,left:Ht.scrollLeft,top:Ht.scrollTop});for(typeof Ae.focus=="function"&&Ae.focus(),Ae=0;Ae<us.length;Ae++){var os=us[Ae];os.element.scrollLeft=os.left,os.element.scrollTop=os.top}}Nx=!!Xy,Jy=Xy=null}finally{cr=D,K.p=x,V.T=f}}l.current=d,$i=2}}function Uv(){if($i===2){$i=0;var l=eu,d=V0,f=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||f){f=V.T,V.T=null;var x=K.p;K.p=2;var D=cr;cr|=4;try{hv(l,d.alternate,d)}finally{cr=D,K.p=x,V.T=f}}$i=3}}function Bv(){if($i===4||$i===3){$i=0,ve();var l=eu,d=V0,f=nd,x=Ev;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?$i=5:($i=0,V0=eu=null,Gv(l,l.pendingLanes));var D=l.pendingLanes;if(D===0&&(Zd=null),$e(f),d=d.stateNode,it&&typeof it.onCommitFiberRoot=="function")try{it.onCommitFiberRoot(Ve,d,void 0,(d.current.flags&128)===128)}catch{}if(x!==null){d=V.T,D=K.p,K.p=2,V.T=null;try{for(var w=l.onRecoverableError,oe=0;oe<x.length;oe++){var Ae=x[oe];w(Ae.value,{componentStack:Ae.stack})}}finally{V.T=d,K.p=D}}(nd&3)!==0&&dx(),yc(l),D=l.pendingLanes,(f&261930)!==0&&(D&42)!==0?l===Uy?Hm++:(Hm=0,Uy=l):Hm=0,qm(0)}}function Gv(l,d){(l.pooledCacheLanes&=d)===0&&(d=l.pooledCache,d!=null&&(l.pooledCache=null,uh(d)))}function dx(){return kv(),Uv(),Bv(),Wv()}function Wv(){if($i!==5)return!1;var l=eu,d=Ay;Ay=0;var f=$e(nd),x=V.T,D=K.p;try{K.p=32>f?32:f,V.T=null,f=ky,ky=null;var w=eu,oe=nd;if($i=0,V0=eu=null,nd=0,(cr&6)!==0)throw Error(r(331));var Ae=cr;if(cr|=4,Nv(w.current),yv(w,w.current,oe,f),cr=Ae,qm(0,!1),it&&typeof it.onPostCommitFiberRoot=="function")try{it.onPostCommitFiberRoot(Ve,w)}catch{}return!0}finally{K.p=D,V.T=x,Gv(l,d)}}function Fv(l,d,f){d=il(f,d),d=_y(l.stateNode,d,2),l=En(l,d,2),l!==null&&(Pe(l,2),yc(l))}function br(l,d,f){if(l.tag===3)Fv(l,l,f);else for(;d!==null;){if(d.tag===3){Fv(d,l,f);break}else if(d.tag===1){var x=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Zd===null||!Zd.has(x))){l=il(f,l),f=KS(2),x=En(d,f,2),x!==null&&(QS(f,x,d,l),Pe(x,2),yc(x));break}}d=d.return}}function Wy(l,d,f){var x=l.pingCache;if(x===null){x=l.pingCache=new YO;var D=new Set;x.set(d,D)}else D=x.get(d),D===void 0&&(D=new Set,x.set(d,D));D.has(f)||(wy=!0,D.add(f),l=qO.bind(null,l,d,f),d.then(l,l))}function qO(l,d,f){var x=l.pingCache;x!==null&&x.delete(d),l.pingedLanes|=l.suspendedLanes&f,l.warmLanes&=~f,wr===l&&(Bn&f)===f&&(_i===4||_i===3&&(Bn&62914560)===Bn&&300>et()-rx?(cr&2)===0&&$0(l,0):Ly|=f,Y0===Bn&&(Y0=0)),yc(l)}function Kv(l,d){d===0&&(d=we()),l=Lo(l,d),l!==null&&(Pe(l,d),yc(l))}function XO(l){var d=l.memoizedState,f=0;d!==null&&(f=d.retryLane),Kv(l,f)}function JO(l,d){var f=0;switch(l.tag){case 31:case 13:var x=l.stateNode,D=l.memoizedState;D!==null&&(f=D.retryLane);break;case 19:x=l.stateNode;break;case 22:x=l.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(d),Kv(l,f)}function ZO(l,d){return De(l,d)}var ux=null,H0=null,Fy=!1,hx=!1,Ky=!1,su=0;function yc(l){l!==H0&&l.next===null&&(H0===null?ux=H0=l:H0=H0.next=l),hx=!0,Fy||(Fy=!0,t3())}function qm(l,d){if(!Ky&&hx){Ky=!0;do for(var f=!1,x=ux;x!==null;){if(l!==0){var D=x.pendingLanes;if(D===0)var w=0;else{var oe=x.suspendedLanes,Ae=x.pingedLanes;w=(1<<31-nt(42|l)+1)-1,w&=D&~(oe&~Ae),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(f=!0,$v(x,w))}else w=Bn,w=ge(x,x===wr?w:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(w&3)===0||Be(x,w)||(f=!0,$v(x,w));x=x.next}while(f);Ky=!1}}function e3(){Qv()}function Qv(){hx=Fy=!1;var l=0;su!==0&&u3()&&(l=su);for(var d=et(),f=null,x=ux;x!==null;){var D=x.next,w=Yv(x,d);w===0?(x.next=null,f===null?ux=D:f.next=D,D===null&&(H0=f)):(f=x,(l!==0||(w&3)!==0)&&(hx=!0)),x=D}$i!==0&&$i!==5||qm(l),su!==0&&(su=0)}function Yv(l,d){for(var f=l.suspendedLanes,x=l.pingedLanes,D=l.expirationTimes,w=l.pendingLanes&-62914561;0<w;){var oe=31-nt(w),Ae=1<<oe,pt=D[oe];pt===-1?((Ae&f)===0||(Ae&x)!==0)&&(D[oe]=ue(Ae,d)):pt<=d&&(l.expiredLanes|=Ae),w&=~Ae}if(d=wr,f=Bn,f=ge(l,l===d?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x=l.callbackNode,f===0||l===d&&(yr===2||yr===9)||l.cancelPendingCommit!==null)return x!==null&&x!==null&&re(x),l.callbackNode=null,l.callbackPriority=0;if((f&3)===0||Be(l,f)){if(d=f&-f,d===l.callbackPriority)return d;switch(x!==null&&re(x),$e(f)){case 2:case 8:f=At;break;case 32:f=ct;break;case 268435456:f=at;break;default:f=ct}return x=Vv.bind(null,l),f=De(f,x),l.callbackPriority=d,l.callbackNode=f,d}return x!==null&&x!==null&&re(x),l.callbackPriority=2,l.callbackNode=null,2}function Vv(l,d){if($i!==0&&$i!==5)return l.callbackNode=null,l.callbackPriority=0,null;var f=l.callbackNode;if(dx()&&l.callbackNode!==f)return null;var x=Bn;return x=ge(l,l===wr?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x===0?null:(Rv(l,x,d),Yv(l,et()),l.callbackNode!=null&&l.callbackNode===f?Vv.bind(null,l):null)}function $v(l,d){if(dx())return null;Rv(l,d,!0)}function t3(){f3(function(){(cr&6)!==0?De(ot,e3):Qv()})}function Qy(){if(su===0){var l=N;l===0&&(l=qe,qe<<=1,(qe&261888)===0&&(qe=256)),su=l}return su}function zv(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:js(""+l)}function Hv(l,d){var f=d.ownerDocument.createElement("input");return f.name=d.name,f.value=d.value,l.id&&f.setAttribute("form",l.id),d.parentNode.insertBefore(f,d),l=new FormData(l),f.parentNode.removeChild(f),l}function s3(l,d,f,x,D){if(d==="submit"&&f&&f.stateNode===D){var w=zv((D[ds]||null).action),oe=x.submitter;oe&&(d=(d=oe[ds]||null)?zv(d.formAction):oe.getAttribute("formAction"),d!==null&&(w=d,oe=null));var Ae=new Vn("action","action",null,x,D);l.push({event:Ae,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(su!==0){var pt=oe?Hv(D,oe):new FormData(D);dy(f,{pending:!0,data:pt,method:D.method,action:w},null,pt)}}else typeof w=="function"&&(Ae.preventDefault(),pt=oe?Hv(D,oe):new FormData(D),dy(f,{pending:!0,data:pt,method:D.method,action:w},w,pt))},currentTarget:D}]})}}for(var Yy=0;Yy<Fc.length;Yy++){var Vy=Fc[Yy],n3=Vy.toLowerCase(),r3=Vy[0].toUpperCase()+Vy.slice(1);nl(n3,"on"+r3)}nl(Wc,"onAnimationEnd"),nl(nh,"onAnimationIteration"),nl(Em,"onAnimationStart"),nl("dblclick","onDoubleClick"),nl("focusin","onFocus"),nl("focusout","onBlur"),nl(k_,"onTransitionRun"),nl(U_,"onTransitionStart"),nl(B_,"onTransitionCancel"),nl(Dm,"onTransitionEnd"),bt("onMouseEnter",["mouseout","mouseover"]),bt("onMouseLeave",["mouseout","mouseover"]),bt("onPointerEnter",["pointerout","pointerover"]),bt("onPointerLeave",["pointerout","pointerover"]),Te("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Te("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Te("onBeforeInput",["compositionend","keypress","textInput","paste"]),Te("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),i3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xm));function qv(l,d){d=(d&4)!==0;for(var f=0;f<l.length;f++){var x=l[f],D=x.event;x=x.listeners;e:{var w=void 0;if(d)for(var oe=x.length-1;0<=oe;oe--){var Ae=x[oe],pt=Ae.instance,Qt=Ae.currentTarget;if(Ae=Ae.listener,pt!==w&&D.isPropagationStopped())break e;w=Ae,D.currentTarget=Qt;try{w(D)}catch(ns){rh(ns)}D.currentTarget=null,w=pt}else for(oe=0;oe<x.length;oe++){if(Ae=x[oe],pt=Ae.instance,Qt=Ae.currentTarget,Ae=Ae.listener,pt!==w&&D.isPropagationStopped())break e;w=Ae,D.currentTarget=Qt;try{w(D)}catch(ns){rh(ns)}D.currentTarget=null,w=pt}}}}function kn(l,d){var f=d[Ss];f===void 0&&(f=d[Ss]=new Set);var x=l+"__bubble";f.has(x)||(Xv(d,l,2,!1),f.add(x))}function $y(l,d,f){var x=0;d&&(x|=4),Xv(f,l,x,d)}var fx="_reactListening"+Math.random().toString(36).slice(2);function zy(l){if(!l[fx]){l[fx]=!0,Me.forEach(function(f){f!=="selectionchange"&&(i3.has(f)||$y(f,!1,l),$y(f,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[fx]||(d[fx]=!0,$y("selectionchange",!1,d))}}function Xv(l,d,f,x){switch(D5(d)){case 2:var D=w3;break;case 8:D=L3;break;default:D=cb}f=D.bind(null,d,f,l),D=void 0,!fr||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(D=!0),x?D!==void 0?l.addEventListener(d,f,{capture:!0,passive:D}):l.addEventListener(d,f,!0):D!==void 0?l.addEventListener(d,f,{passive:D}):l.addEventListener(d,f,!1)}function Hy(l,d,f,x,D){var w=x;if((d&1)===0&&(d&2)===0&&x!==null)e:for(;;){if(x===null)return;var oe=x.tag;if(oe===3||oe===4){var Ae=x.stateNode.containerInfo;if(Ae===D)break;if(oe===4)for(oe=x.return;oe!==null;){var pt=oe.tag;if((pt===3||pt===4)&&oe.stateNode.containerInfo===D)return;oe=oe.return}for(;Ae!==null;){if(oe=qt(Ae),oe===null)return;if(pt=oe.tag,pt===5||pt===6||pt===26||pt===27){x=w=oe;continue e}Ae=Ae.parentNode}}x=x.return}ti(function(){var Qt=w,ns=Vs(f),us=[];e:{var Vt=Rm.get(l);if(Vt!==void 0){var Ht=Vn,Hs=l;switch(l){case"keypress":if(Ir(f)===0)break e;case"keydown":case"keyup":Ht=Fn;break;case"focusin":Hs="focus",Ht=So;break;case"focusout":Hs="blur",Ht=So;break;case"beforeblur":case"afterblur":Ht=So;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ht=zr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ht=Bi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ht=Ci;break;case Wc:case nh:case Em:Ht=W;break;case Dm:Ht=Gi;break;case"scroll":case"scrollend":Ht=Ii;break;case"wheel":Ht=jl;break;case"copy":case"cut":case"paste":Ht=Ze;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ht=ni;break;case"toggle":case"beforetoggle":Ht=eh}var fn=(d&4)!==0,Tr=!fn&&(l==="scroll"||l==="scrollend"),wt=fn?Vt!==null?Vt+"Capture":null:Vt;fn=[];for(var Rt=Qt,Kt;Rt!==null;){var os=Rt;if(Kt=os.stateNode,os=os.tag,os!==5&&os!==26&&os!==27||Kt===null||wt===null||(os=Mr(Rt,wt),os!=null&&fn.push(Jm(Rt,os,Kt))),Tr)break;Rt=Rt.return}0<fn.length&&(Vt=new Ht(Vt,Hs,null,f,ns),us.push({event:Vt,listeners:fn}))}}if((d&7)===0){e:{if(Vt=l==="mouseover"||l==="pointerover",Ht=l==="mouseout"||l==="pointerout",Vt&&f!==Ws&&(Hs=f.relatedTarget||f.fromElement)&&(qt(Hs)||Hs[vs]))break e;if((Ht||Vt)&&(Vt=ns.window===ns?ns:(Vt=ns.ownerDocument)?Vt.defaultView||Vt.parentWindow:window,Ht?(Hs=f.relatedTarget||f.toElement,Ht=Qt,Hs=Hs?qt(Hs):null,Hs!==null&&(Tr=a(Hs),fn=Hs.tag,Hs!==Tr||fn!==5&&fn!==27&&fn!==6)&&(Hs=null)):(Ht=null,Hs=Qt),Ht!==Hs)){if(fn=zr,os="onMouseLeave",wt="onMouseEnter",Rt="mouse",(l==="pointerout"||l==="pointerover")&&(fn=ni,os="onPointerLeave",wt="onPointerEnter",Rt="pointer"),Tr=Ht==null?Vt:he(Ht),Kt=Hs==null?Vt:he(Hs),Vt=new fn(os,Rt+"leave",Ht,f,ns),Vt.target=Tr,Vt.relatedTarget=Kt,os=null,qt(ns)===Qt&&(fn=new fn(wt,Rt+"enter",Hs,f,ns),fn.target=Kt,fn.relatedTarget=Tr,os=fn),Tr=os,Ht&&Hs)t:{for(fn=a3,wt=Ht,Rt=Hs,Kt=0,os=wt;os;os=fn(os))Kt++;os=0;for(var on=Rt;on;on=fn(on))os++;for(;0<Kt-os;)wt=fn(wt),Kt--;for(;0<os-Kt;)Rt=fn(Rt),os--;for(;Kt--;){if(wt===Rt||Rt!==null&&wt===Rt.alternate){fn=wt;break t}wt=fn(wt),Rt=fn(Rt)}fn=null}else fn=null;Ht!==null&&Jv(us,Vt,Ht,fn,!1),Hs!==null&&Tr!==null&&Jv(us,Tr,Hs,fn,!0)}}e:{if(Vt=Qt?he(Qt):window,Ht=Vt.nodeName&&Vt.nodeName.toLowerCase(),Ht==="select"||Ht==="input"&&Vt.type==="file")var er=ac;else if(th(Vt))if(Ma)er=$l;else{er=ri;var tn=kd}else Ht=Vt.nodeName,!Ht||Ht.toLowerCase()!=="input"||Vt.type!=="checkbox"&&Vt.type!=="radio"?Qt&&ws(Qt.elementType)&&(er=ac):er=b0;if(er&&(er=er(l,Qt))){Wa(us,er,f,ns);break e}tn&&tn(l,Vt,Qt),l==="focusout"&&Qt&&Vt.type==="number"&&Qt.memoizedProps.value!=null&&cs(Vt,"number",Vt.value)}switch(tn=Qt?he(Qt):window,l){case"focusin":(th(tn)||tn.contentEditable==="true")&&(Fa=tn,wo=Qt,ra=null);break;case"focusout":ra=wo=Fa=null;break;case"mousedown":sl=!0;break;case"contextmenu":case"mouseup":case"dragend":sl=!1,Jn(us,f,ns);break;case"selectionchange":if(Gc)break;case"keydown":case"keyup":Jn(us,f,ns)}var Rn;if(Kl)e:{switch(l){case"compositionstart":var Gn="onCompositionStart";break e;case"compositionend":Gn="onCompositionEnd";break e;case"compositionupdate":Gn="onCompositionUpdate";break e}Gn=void 0}else Ql?ic(l,f)&&(Gn="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(Gn="onCompositionStart");Gn&&(Do&&f.locale!=="ko"&&(Ql||Gn!=="onCompositionStart"?Gn==="onCompositionEnd"&&Ql&&(Rn=na()):($r=ns,sa="value"in $r?$r.value:$r.textContent,Ql=!0)),tn=mx(Qt,Gn),0<tn.length&&(Gn=new Ot(Gn,l,null,f,ns),us.push({event:Gn,listeners:tn}),Rn?Gn.data=Rn:(Rn=Ld(f),Rn!==null&&(Gn.data=Rn)))),(Rn=Bc?pa(l,f):Ro(l,f))&&(Gn=mx(Qt,"onBeforeInput"),0<Gn.length&&(tn=new Ot("onBeforeInput","beforeinput",null,f,ns),us.push({event:tn,listeners:Gn}),tn.data=Rn)),s3(us,l,Qt,f,ns)}qv(us,d)})}function Jm(l,d,f){return{instance:l,listener:d,currentTarget:f}}function mx(l,d){for(var f=d+"Capture",x=[];l!==null;){var D=l,w=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||w===null||(D=Mr(l,f),D!=null&&x.unshift(Jm(l,D,w)),D=Mr(l,d),D!=null&&x.push(Jm(l,D,w))),l.tag===3)return x;l=l.return}return[]}function a3(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function Jv(l,d,f,x,D){for(var w=d._reactName,oe=[];f!==null&&f!==x;){var Ae=f,pt=Ae.alternate,Qt=Ae.stateNode;if(Ae=Ae.tag,pt!==null&&pt===x)break;Ae!==5&&Ae!==26&&Ae!==27||Qt===null||(pt=Qt,D?(Qt=Mr(f,w),Qt!=null&&oe.unshift(Jm(f,Qt,pt))):D||(Qt=Mr(f,w),Qt!=null&&oe.push(Jm(f,Qt,pt)))),f=f.return}oe.length!==0&&l.push({event:d,listeners:oe})}var l3=/\r\n?/g,o3=/\u0000|\uFFFD/g;function Zv(l){return(typeof l=="string"?l:""+l).replace(l3,`
`).replace(o3,"")}function e5(l,d){return d=Zv(d),Zv(l)===d}function Rr(l,d,f,x,D,w){switch(f){case"children":typeof x=="string"?d==="body"||d==="textarea"&&x===""||rt(l,x):(typeof x=="number"||typeof x=="bigint")&&d!=="body"&&rt(l,""+x);break;case"className":Lt(l,"class",x);break;case"tabIndex":Lt(l,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Lt(l,f,x);break;case"style":zt(l,x,w);break;case"data":if(d!=="object"){Lt(l,"data",x);break}case"src":case"href":if(x===""&&(d!=="a"||f!=="href")){l.removeAttribute(f);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(f);break}x=js(""+x),l.setAttribute(f,x);break;case"action":case"formAction":if(typeof x=="function"){l.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(f==="formAction"?(d!=="input"&&Rr(l,d,"name",D.name,D,null),Rr(l,d,"formEncType",D.formEncType,D,null),Rr(l,d,"formMethod",D.formMethod,D,null),Rr(l,d,"formTarget",D.formTarget,D,null)):(Rr(l,d,"encType",D.encType,D,null),Rr(l,d,"method",D.method,D,null),Rr(l,d,"target",D.target,D,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(f);break}x=js(""+x),l.setAttribute(f,x);break;case"onClick":x!=null&&(l.onclick=hs);break;case"onScroll":x!=null&&kn("scroll",l);break;case"onScrollEnd":x!=null&&kn("scrollend",l);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(f=x.__html,f!=null){if(D.children!=null)throw Error(r(60));l.innerHTML=f}}break;case"multiple":l.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":l.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){l.removeAttribute("xlink:href");break}f=js(""+x),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(f,""+x):l.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(f,""):l.removeAttribute(f);break;case"capture":case"download":x===!0?l.setAttribute(f,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(f,x):l.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?l.setAttribute(f,x):l.removeAttribute(f);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?l.removeAttribute(f):l.setAttribute(f,x);break;case"popover":kn("beforetoggle",l),kn("toggle",l),ht(l,"popover",x);break;case"xlinkActuate":Bt(l,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Bt(l,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Bt(l,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Bt(l,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Bt(l,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Bt(l,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Bt(l,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Bt(l,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Bt(l,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":ht(l,"is",x);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Zt.get(f)||f,ht(l,f,x))}}function qy(l,d,f,x,D,w){switch(f){case"style":zt(l,x,w);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(f=x.__html,f!=null){if(D.children!=null)throw Error(r(60));l.innerHTML=f}}break;case"children":typeof x=="string"?rt(l,x):(typeof x=="number"||typeof x=="bigint")&&rt(l,""+x);break;case"onScroll":x!=null&&kn("scroll",l);break;case"onScrollEnd":x!=null&&kn("scrollend",l);break;case"onClick":x!=null&&(l.onclick=hs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tt.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(D=f.endsWith("Capture"),d=f.slice(2,D?f.length-7:void 0),w=l[ds]||null,w=w!=null?w[f]:null,typeof w=="function"&&l.removeEventListener(d,w,D),typeof x=="function")){typeof w!="function"&&w!==null&&(f in l?l[f]=null:l.hasAttribute(f)&&l.removeAttribute(f)),l.addEventListener(d,x,D);break e}f in l?l[f]=x:x===!0?l.setAttribute(f,""):ht(l,f,x)}}}function Sa(l,d,f){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kn("error",l),kn("load",l);var x=!1,D=!1,w;for(w in f)if(f.hasOwnProperty(w)){var oe=f[w];if(oe!=null)switch(w){case"src":x=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,d));default:Rr(l,d,w,oe,f,null)}}D&&Rr(l,d,"srcSet",f.srcSet,f,null),x&&Rr(l,d,"src",f.src,f,null);return;case"input":kn("invalid",l);var Ae=w=oe=D=null,pt=null,Qt=null;for(x in f)if(f.hasOwnProperty(x)){var ns=f[x];if(ns!=null)switch(x){case"name":D=ns;break;case"type":oe=ns;break;case"checked":pt=ns;break;case"defaultChecked":Qt=ns;break;case"value":w=ns;break;case"defaultValue":Ae=ns;break;case"children":case"dangerouslySetInnerHTML":if(ns!=null)throw Error(r(137,d));break;default:Rr(l,d,x,ns,f,null)}}Ls(l,w,Ae,pt,Qt,oe,D,!1);return;case"select":kn("invalid",l),x=oe=w=null;for(D in f)if(f.hasOwnProperty(D)&&(Ae=f[D],Ae!=null))switch(D){case"value":w=Ae;break;case"defaultValue":oe=Ae;break;case"multiple":x=Ae;default:Rr(l,d,D,Ae,f,null)}d=w,f=oe,l.multiple=!!x,d!=null?ms(l,!!x,d,!1):f!=null&&ms(l,!!x,f,!0);return;case"textarea":kn("invalid",l),w=D=x=null;for(oe in f)if(f.hasOwnProperty(oe)&&(Ae=f[oe],Ae!=null))switch(oe){case"value":x=Ae;break;case"defaultValue":D=Ae;break;case"children":w=Ae;break;case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(r(91));break;default:Rr(l,d,oe,Ae,f,null)}Ps(l,x,D,w);return;case"option":for(pt in f)if(f.hasOwnProperty(pt)&&(x=f[pt],x!=null))switch(pt){case"selected":l.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Rr(l,d,pt,x,f,null)}return;case"dialog":kn("beforetoggle",l),kn("toggle",l),kn("cancel",l),kn("close",l);break;case"iframe":case"object":kn("load",l);break;case"video":case"audio":for(x=0;x<Xm.length;x++)kn(Xm[x],l);break;case"image":kn("error",l),kn("load",l);break;case"details":kn("toggle",l);break;case"embed":case"source":case"link":kn("error",l),kn("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Qt in f)if(f.hasOwnProperty(Qt)&&(x=f[Qt],x!=null))switch(Qt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,d));default:Rr(l,d,Qt,x,f,null)}return;default:if(ws(d)){for(ns in f)f.hasOwnProperty(ns)&&(x=f[ns],x!==void 0&&qy(l,d,ns,x,f,void 0));return}}for(Ae in f)f.hasOwnProperty(Ae)&&(x=f[Ae],x!=null&&Rr(l,d,Ae,x,f,null))}function c3(l,d,f,x){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,w=null,oe=null,Ae=null,pt=null,Qt=null,ns=null;for(Ht in f){var us=f[Ht];if(f.hasOwnProperty(Ht)&&us!=null)switch(Ht){case"checked":break;case"value":break;case"defaultValue":pt=us;default:x.hasOwnProperty(Ht)||Rr(l,d,Ht,null,x,us)}}for(var Vt in x){var Ht=x[Vt];if(us=f[Vt],x.hasOwnProperty(Vt)&&(Ht!=null||us!=null))switch(Vt){case"type":w=Ht;break;case"name":D=Ht;break;case"checked":Qt=Ht;break;case"defaultChecked":ns=Ht;break;case"value":oe=Ht;break;case"defaultValue":Ae=Ht;break;case"children":case"dangerouslySetInnerHTML":if(Ht!=null)throw Error(r(137,d));break;default:Ht!==us&&Rr(l,d,Vt,Ht,x,us)}}Es(l,oe,Ae,pt,Qt,ns,w,D);return;case"select":Ht=oe=Ae=Vt=null;for(w in f)if(pt=f[w],f.hasOwnProperty(w)&&pt!=null)switch(w){case"value":break;case"multiple":Ht=pt;default:x.hasOwnProperty(w)||Rr(l,d,w,null,x,pt)}for(D in x)if(w=x[D],pt=f[D],x.hasOwnProperty(D)&&(w!=null||pt!=null))switch(D){case"value":Vt=w;break;case"defaultValue":Ae=w;break;case"multiple":oe=w;default:w!==pt&&Rr(l,d,D,w,x,pt)}d=Ae,f=oe,x=Ht,Vt!=null?ms(l,!!f,Vt,!1):!!x!=!!f&&(d!=null?ms(l,!!f,d,!0):ms(l,!!f,f?[]:"",!1));return;case"textarea":Ht=Vt=null;for(Ae in f)if(D=f[Ae],f.hasOwnProperty(Ae)&&D!=null&&!x.hasOwnProperty(Ae))switch(Ae){case"value":break;case"children":break;default:Rr(l,d,Ae,null,x,D)}for(oe in x)if(D=x[oe],w=f[oe],x.hasOwnProperty(oe)&&(D!=null||w!=null))switch(oe){case"value":Vt=D;break;case"defaultValue":Ht=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(r(91));break;default:D!==w&&Rr(l,d,oe,D,x,w)}Ys(l,Vt,Ht);return;case"option":for(var Hs in f)if(Vt=f[Hs],f.hasOwnProperty(Hs)&&Vt!=null&&!x.hasOwnProperty(Hs))switch(Hs){case"selected":l.selected=!1;break;default:Rr(l,d,Hs,null,x,Vt)}for(pt in x)if(Vt=x[pt],Ht=f[pt],x.hasOwnProperty(pt)&&Vt!==Ht&&(Vt!=null||Ht!=null))switch(pt){case"selected":l.selected=Vt&&typeof Vt!="function"&&typeof Vt!="symbol";break;default:Rr(l,d,pt,Vt,x,Ht)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fn in f)Vt=f[fn],f.hasOwnProperty(fn)&&Vt!=null&&!x.hasOwnProperty(fn)&&Rr(l,d,fn,null,x,Vt);for(Qt in x)if(Vt=x[Qt],Ht=f[Qt],x.hasOwnProperty(Qt)&&Vt!==Ht&&(Vt!=null||Ht!=null))switch(Qt){case"children":case"dangerouslySetInnerHTML":if(Vt!=null)throw Error(r(137,d));break;default:Rr(l,d,Qt,Vt,x,Ht)}return;default:if(ws(d)){for(var Tr in f)Vt=f[Tr],f.hasOwnProperty(Tr)&&Vt!==void 0&&!x.hasOwnProperty(Tr)&&qy(l,d,Tr,void 0,x,Vt);for(ns in x)Vt=x[ns],Ht=f[ns],!x.hasOwnProperty(ns)||Vt===Ht||Vt===void 0&&Ht===void 0||qy(l,d,ns,Vt,x,Ht);return}}for(var wt in f)Vt=f[wt],f.hasOwnProperty(wt)&&Vt!=null&&!x.hasOwnProperty(wt)&&Rr(l,d,wt,null,x,Vt);for(us in x)Vt=x[us],Ht=f[us],!x.hasOwnProperty(us)||Vt===Ht||Vt==null&&Ht==null||Rr(l,d,us,Vt,x,Ht)}function t5(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function d3(){if(typeof performance.getEntriesByType=="function"){for(var l=0,d=0,f=performance.getEntriesByType("resource"),x=0;x<f.length;x++){var D=f[x],w=D.transferSize,oe=D.initiatorType,Ae=D.duration;if(w&&Ae&&t5(oe)){for(oe=0,Ae=D.responseEnd,x+=1;x<f.length;x++){var pt=f[x],Qt=pt.startTime;if(Qt>Ae)break;var ns=pt.transferSize,us=pt.initiatorType;ns&&t5(us)&&(pt=pt.responseEnd,oe+=ns*(pt<Ae?1:(Ae-Qt)/(pt-Qt)))}if(--x,d+=8*(w+oe)/(D.duration/1e3),l++,10<l)break}}if(0<l)return d/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Xy=null,Jy=null;function gx(l){return l.nodeType===9?l:l.ownerDocument}function s5(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function n5(l,d){if(l===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&d==="foreignObject"?0:l}function Zy(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var eb=null;function u3(){var l=window.event;return l&&l.type==="popstate"?l===eb?!1:(eb=l,!0):(eb=null,!1)}var r5=typeof setTimeout=="function"?setTimeout:void 0,h3=typeof clearTimeout=="function"?clearTimeout:void 0,i5=typeof Promise=="function"?Promise:void 0,f3=typeof queueMicrotask=="function"?queueMicrotask:typeof i5<"u"?function(l){return i5.resolve(null).then(l).catch(m3)}:r5;function m3(l){setTimeout(function(){throw l})}function nu(l){return l==="head"}function a5(l,d){var f=d,x=0;do{var D=f.nextSibling;if(l.removeChild(f),D&&D.nodeType===8)if(f=D.data,f==="/$"||f==="/&"){if(x===0){l.removeChild(D),Z0(d);return}x--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")x++;else if(f==="html")Zm(l.ownerDocument.documentElement);else if(f==="head"){f=l.ownerDocument.head,Zm(f);for(var w=f.firstChild;w;){var oe=w.nextSibling,Ae=w.nodeName;w[Ft]||Ae==="SCRIPT"||Ae==="STYLE"||Ae==="LINK"&&w.rel.toLowerCase()==="stylesheet"||f.removeChild(w),w=oe}}else f==="body"&&Zm(l.ownerDocument.body);f=D}while(f);Z0(d)}function l5(l,d){var f=l;l=0;do{var x=f.nextSibling;if(f.nodeType===1?d?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(d?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),x&&x.nodeType===8)if(f=x.data,f==="/$"){if(l===0)break;l--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||l++;f=x}while(f)}function tb(l){var d=l.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var f=d;switch(d=d.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":tb(f),_t(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}l.removeChild(f)}}function g3(l,d,f,x){for(;l.nodeType===1;){var D=f;if(l.nodeName.toLowerCase()!==d.toLowerCase()){if(!x&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(x){if(!l[Ft])switch(d){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(w=l.getAttribute("rel"),w==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(w!==D.rel||l.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||l.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||l.getAttribute("title")!==(D.title==null?null:D.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(w=l.getAttribute("src"),(w!==(D.src==null?null:D.src)||l.getAttribute("type")!==(D.type==null?null:D.type)||l.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&w&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(d==="input"&&l.type==="hidden"){var w=D.name==null?null:""+D.name;if(D.type==="hidden"&&l.getAttribute("name")===w)return l}else return l;if(l=eo(l.nextSibling),l===null)break}return null}function _3(l,d,f){if(d==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!f||(l=eo(l.nextSibling),l===null))return null;return l}function o5(l,d){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!d||(l=eo(l.nextSibling),l===null))return null;return l}function sb(l){return l.data==="$?"||l.data==="$~"}function nb(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function x3(l,d){var f=l.ownerDocument;if(l.data==="$~")l._reactRetry=d;else if(l.data!=="$?"||f.readyState!=="loading")d();else{var x=function(){d(),f.removeEventListener("DOMContentLoaded",x)};f.addEventListener("DOMContentLoaded",x),l._reactRetry=x}}function eo(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"||d==="F!"||d==="F")break;if(d==="/$"||d==="/&")return null}}return l}var rb=null;function c5(l){l=l.nextSibling;for(var d=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"||f==="/&"){if(d===0)return eo(l.nextSibling);d--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||d++}l=l.nextSibling}return null}function d5(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(d===0)return l;d--}else f!=="/$"&&f!=="/&"||d++}l=l.previousSibling}return null}function u5(l,d,f){switch(d=gx(f),l){case"html":if(l=d.documentElement,!l)throw Error(r(452));return l;case"head":if(l=d.head,!l)throw Error(r(453));return l;case"body":if(l=d.body,!l)throw Error(r(454));return l;default:throw Error(r(451))}}function Zm(l){for(var d=l.attributes;d.length;)l.removeAttributeNode(d[0]);_t(l)}var to=new Map,h5=new Set;function _x(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var rd=K.d;K.d={f:p3,r:y3,D:b3,C:C3,L:N3,m:S3,X:E3,S:v3,M:D3};function p3(){var l=rd.f(),d=lx();return l||d}function y3(l){var d=jt(l);d!==null&&d.tag===5&&d.type==="form"?MS(d):rd.r(l)}var q0=typeof document>"u"?null:document;function f5(l,d,f){var x=q0;if(x&&typeof d=="string"&&d){var D=_s(d);D='link[rel="'+l+'"][href="'+D+'"]',typeof f=="string"&&(D+='[crossorigin="'+f+'"]'),h5.has(D)||(h5.add(D),l={rel:l,crossOrigin:f,href:d},x.querySelector(D)===null&&(d=x.createElement("link"),Sa(d,"link",l),je(d),x.head.appendChild(d)))}}function b3(l){rd.D(l),f5("dns-prefetch",l,null)}function C3(l,d){rd.C(l,d),f5("preconnect",l,d)}function N3(l,d,f){rd.L(l,d,f);var x=q0;if(x&&l&&d){var D='link[rel="preload"][as="'+_s(d)+'"]';d==="image"&&f&&f.imageSrcSet?(D+='[imagesrcset="'+_s(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(D+='[imagesizes="'+_s(f.imageSizes)+'"]')):D+='[href="'+_s(l)+'"]';var w=D;switch(d){case"style":w=X0(l);break;case"script":w=J0(l)}to.has(w)||(l=_({rel:"preload",href:d==="image"&&f&&f.imageSrcSet?void 0:l,as:d},f),to.set(w,l),x.querySelector(D)!==null||d==="style"&&x.querySelector(eg(w))||d==="script"&&x.querySelector(tg(w))||(d=x.createElement("link"),Sa(d,"link",l),je(d),x.head.appendChild(d)))}}function S3(l,d){rd.m(l,d);var f=q0;if(f&&l){var x=d&&typeof d.as=="string"?d.as:"script",D='link[rel="modulepreload"][as="'+_s(x)+'"][href="'+_s(l)+'"]',w=D;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=J0(l)}if(!to.has(w)&&(l=_({rel:"modulepreload",href:l},d),to.set(w,l),f.querySelector(D)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(tg(w)))return}x=f.createElement("link"),Sa(x,"link",l),je(x),f.head.appendChild(x)}}}function v3(l,d,f){rd.S(l,d,f);var x=q0;if(x&&l){var D=ye(x).hoistableStyles,w=X0(l);d=d||"default";var oe=D.get(w);if(!oe){var Ae={loading:0,preload:null};if(oe=x.querySelector(eg(w)))Ae.loading=5;else{l=_({rel:"stylesheet",href:l,"data-precedence":d},f),(f=to.get(w))&&ib(l,f);var pt=oe=x.createElement("link");je(pt),Sa(pt,"link",l),pt._p=new Promise(function(Qt,ns){pt.onload=Qt,pt.onerror=ns}),pt.addEventListener("load",function(){Ae.loading|=1}),pt.addEventListener("error",function(){Ae.loading|=2}),Ae.loading|=4,xx(oe,d,x)}oe={type:"stylesheet",instance:oe,count:1,state:Ae},D.set(w,oe)}}}function E3(l,d){rd.X(l,d);var f=q0;if(f&&l){var x=ye(f).hoistableScripts,D=J0(l),w=x.get(D);w||(w=f.querySelector(tg(D)),w||(l=_({src:l,async:!0},d),(d=to.get(D))&&ab(l,d),w=f.createElement("script"),je(w),Sa(w,"link",l),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},x.set(D,w))}}function D3(l,d){rd.M(l,d);var f=q0;if(f&&l){var x=ye(f).hoistableScripts,D=J0(l),w=x.get(D);w||(w=f.querySelector(tg(D)),w||(l=_({src:l,async:!0,type:"module"},d),(d=to.get(D))&&ab(l,d),w=f.createElement("script"),je(w),Sa(w,"link",l),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},x.set(D,w))}}function m5(l,d,f,x){var D=(D=$.current)?_x(D):null;if(!D)throw Error(r(446));switch(l){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(d=X0(f.href),f=ye(D).hoistableStyles,x=f.get(d),x||(x={type:"style",instance:null,count:0,state:null},f.set(d,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){l=X0(f.href);var w=ye(D).hoistableStyles,oe=w.get(l);if(oe||(D=D.ownerDocument||D,oe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(l,oe),(w=D.querySelector(eg(l)))&&!w._p&&(oe.instance=w,oe.state.loading=5),to.has(l)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},to.set(l,f),w||R3(D,l,f,oe.state))),d&&x===null)throw Error(r(528,""));return oe}if(d&&x!==null)throw Error(r(529,""));return null;case"script":return d=f.async,f=f.src,typeof f=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=J0(f),f=ye(D).hoistableScripts,x=f.get(d),x||(x={type:"script",instance:null,count:0,state:null},f.set(d,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,l))}}function X0(l){return'href="'+_s(l)+'"'}function eg(l){return'link[rel="stylesheet"]['+l+"]"}function g5(l){return _({},l,{"data-precedence":l.precedence,precedence:null})}function R3(l,d,f,x){l.querySelector('link[rel="preload"][as="style"]['+d+"]")?x.loading=1:(d=l.createElement("link"),x.preload=d,d.addEventListener("load",function(){return x.loading|=1}),d.addEventListener("error",function(){return x.loading|=2}),Sa(d,"link",f),je(d),l.head.appendChild(d))}function J0(l){return'[src="'+_s(l)+'"]'}function tg(l){return"script[async]"+l}function _5(l,d,f){if(d.count++,d.instance===null)switch(d.type){case"style":var x=l.querySelector('style[data-href~="'+_s(f.href)+'"]');if(x)return d.instance=x,je(x),x;var D=_({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return x=(l.ownerDocument||l).createElement("style"),je(x),Sa(x,"style",D),xx(x,f.precedence,l),d.instance=x;case"stylesheet":D=X0(f.href);var w=l.querySelector(eg(D));if(w)return d.state.loading|=4,d.instance=w,je(w),w;x=g5(f),(D=to.get(D))&&ib(x,D),w=(l.ownerDocument||l).createElement("link"),je(w);var oe=w;return oe._p=new Promise(function(Ae,pt){oe.onload=Ae,oe.onerror=pt}),Sa(w,"link",x),d.state.loading|=4,xx(w,f.precedence,l),d.instance=w;case"script":return w=J0(f.src),(D=l.querySelector(tg(w)))?(d.instance=D,je(D),D):(x=f,(D=to.get(w))&&(x=_({},f),ab(x,D)),l=l.ownerDocument||l,D=l.createElement("script"),je(D),Sa(D,"link",x),l.head.appendChild(D),d.instance=D);case"void":return null;default:throw Error(r(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(x=d.instance,d.state.loading|=4,xx(x,f.precedence,l));return d.instance}function xx(l,d,f){for(var x=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=x.length?x[x.length-1]:null,w=D,oe=0;oe<x.length;oe++){var Ae=x[oe];if(Ae.dataset.precedence===d)w=Ae;else if(w!==D)break}w?w.parentNode.insertBefore(l,w.nextSibling):(d=f.nodeType===9?f.head:f,d.insertBefore(l,d.firstChild))}function ib(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.title==null&&(l.title=d.title)}function ab(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.integrity==null&&(l.integrity=d.integrity)}var px=null;function x5(l,d,f){if(px===null){var x=new Map,D=px=new Map;D.set(f,x)}else D=px,x=D.get(f),x||(x=new Map,D.set(f,x));if(x.has(l))return x;for(x.set(l,null),f=f.getElementsByTagName(l),D=0;D<f.length;D++){var w=f[D];if(!(w[Ft]||w[ls]||l==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var oe=w.getAttribute(d)||"";oe=l+oe;var Ae=x.get(oe);Ae?Ae.push(w):x.set(oe,[w])}}return x}function p5(l,d,f){l=l.ownerDocument||l,l.head.insertBefore(f,d==="title"?l.querySelector("head > title"):null)}function T3(l,d,f){if(f===1||d.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return l=d.disabled,typeof d.precedence=="string"&&l==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function y5(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function M3(l,d,f,x){if(f.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var D=X0(x.href),w=d.querySelector(eg(D));if(w){d=w._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(l.count++,l=yx.bind(l),d.then(l,l)),f.state.loading|=4,f.instance=w,je(w);return}w=d.ownerDocument||d,x=g5(x),(D=to.get(D))&&ib(x,D),w=w.createElement("link"),je(w);var oe=w;oe._p=new Promise(function(Ae,pt){oe.onload=Ae,oe.onerror=pt}),Sa(w,"link",x),f.instance=w}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(f,d),(d=f.state.preload)&&(f.state.loading&3)===0&&(l.count++,f=yx.bind(l),d.addEventListener("load",f),d.addEventListener("error",f))}}var lb=0;function I3(l,d){return l.stylesheets&&l.count===0&&Cx(l,l.stylesheets),0<l.count||0<l.imgCount?function(f){var x=setTimeout(function(){if(l.stylesheets&&Cx(l,l.stylesheets),l.unsuspend){var w=l.unsuspend;l.unsuspend=null,w()}},6e4+d);0<l.imgBytes&&lb===0&&(lb=62500*d3());var D=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&Cx(l,l.stylesheets),l.unsuspend)){var w=l.unsuspend;l.unsuspend=null,w()}},(l.imgBytes>lb?50:800)+d);return l.unsuspend=f,function(){l.unsuspend=null,clearTimeout(x),clearTimeout(D)}}:null}function yx(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cx(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var bx=null;function Cx(l,d){l.stylesheets=null,l.unsuspend!==null&&(l.count++,bx=new Map,d.forEach(j3,l),bx=null,yx.call(l))}function j3(l,d){if(!(d.state.loading&4)){var f=bx.get(l);if(f)var x=f.get(null);else{f=new Map,bx.set(l,f);for(var D=l.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<D.length;w++){var oe=D[w];(oe.nodeName==="LINK"||oe.getAttribute("media")!=="not all")&&(f.set(oe.dataset.precedence,oe),x=oe)}x&&f.set(null,x)}D=d.instance,oe=D.getAttribute("data-precedence"),w=f.get(oe)||x,w===x&&f.set(null,D),f.set(oe,D),this.count++,x=yx.bind(this),D.addEventListener("load",x),D.addEventListener("error",x),w?w.parentNode.insertBefore(D,w.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(D,l.firstChild)),d.state.loading|=4}}var sg={$$typeof:L,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function O3(l,d,f,x,D,w,oe,Ae,pt){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Je(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Je(0),this.hiddenUpdates=Je(null),this.identifierPrefix=x,this.onUncaughtError=D,this.onCaughtError=w,this.onRecoverableError=oe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=pt,this.incompleteTransitions=new Map}function b5(l,d,f,x,D,w,oe,Ae,pt,Qt,ns,us){return l=new O3(l,d,f,oe,pt,Qt,ns,us,Ae),d=1,w===!0&&(d|=24),w=aa(3,null,null,d),l.current=w,w.stateNode=l,d=Yd(),d.refCount++,l.pooledCache=d,d.refCount++,w.memoizedState={element:x,isDehydrated:f,cache:d},Ts(w),l}function C5(l){return l?(l=Fi,l):Fi}function N5(l,d,f,x,D,w){D=C5(D),x.context===null?x.context=D:x.pendingContext=D,x=un(d),x.payload={element:f},w=w===void 0?null:w,w!==null&&(x.callback=w),f=En(l,x,d),f!==null&&(_l(f,l,d),lr(f,l,d))}function S5(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<d?f:d}}function ob(l,d){S5(l,d),(l=l.alternate)&&S5(l,d)}function v5(l){if(l.tag===13||l.tag===31){var d=Lo(l,67108864);d!==null&&_l(d,l,67108864),ob(l,67108864)}}function E5(l){if(l.tag===13||l.tag===31){var d=Bl();d=It(d);var f=Lo(l,d);f!==null&&_l(f,l,d),ob(l,d)}}var Nx=!0;function w3(l,d,f,x){var D=V.T;V.T=null;var w=K.p;try{K.p=2,cb(l,d,f,x)}finally{K.p=w,V.T=D}}function L3(l,d,f,x){var D=V.T;V.T=null;var w=K.p;try{K.p=8,cb(l,d,f,x)}finally{K.p=w,V.T=D}}function cb(l,d,f,x){if(Nx){var D=db(x);if(D===null)Hy(l,d,x,Sx,f),R5(l,x);else if(A3(D,l,d,f,x))x.stopPropagation();else if(R5(l,x),d&4&&-1<P3.indexOf(l)){for(;D!==null;){var w=jt(D);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var oe=pe(w.pendingLanes);if(oe!==0){var Ae=w;for(Ae.pendingLanes|=2,Ae.entangledLanes|=2;oe;){var pt=1<<31-nt(oe);Ae.entanglements[1]|=pt,oe&=~pt}yc(w),(cr&6)===0&&(ix=et()+500,qm(0))}}break;case 31:case 13:Ae=Lo(w,2),Ae!==null&&_l(Ae,w,2),lx(),ob(w,2)}if(w=db(x),w===null&&Hy(l,d,x,Sx,f),w===D)break;D=w}D!==null&&x.stopPropagation()}else Hy(l,d,x,null,f)}}function db(l){return l=Vs(l),ub(l)}var Sx=null;function ub(l){if(Sx=null,l=qt(l),l!==null){var d=a(l);if(d===null)l=null;else{var f=d.tag;if(f===13){if(l=o(d),l!==null)return l;l=null}else if(f===31){if(l=c(d),l!==null)return l;l=null}else if(f===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null)}}return Sx=l,null}function D5(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dt()){case ot:return 2;case At:return 8;case ct:case Ge:return 32;case at:return 268435456;default:return 32}default:return 32}}var hb=!1,ru=null,iu=null,au=null,ng=new Map,rg=new Map,lu=[],P3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function R5(l,d){switch(l){case"focusin":case"focusout":ru=null;break;case"dragenter":case"dragleave":iu=null;break;case"mouseover":case"mouseout":au=null;break;case"pointerover":case"pointerout":ng.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":rg.delete(d.pointerId)}}function ig(l,d,f,x,D,w){return l===null||l.nativeEvent!==w?(l={blockedOn:d,domEventName:f,eventSystemFlags:x,nativeEvent:w,targetContainers:[D]},d!==null&&(d=jt(d),d!==null&&v5(d)),l):(l.eventSystemFlags|=x,d=l.targetContainers,D!==null&&d.indexOf(D)===-1&&d.push(D),l)}function A3(l,d,f,x,D){switch(d){case"focusin":return ru=ig(ru,l,d,f,x,D),!0;case"dragenter":return iu=ig(iu,l,d,f,x,D),!0;case"mouseover":return au=ig(au,l,d,f,x,D),!0;case"pointerover":var w=D.pointerId;return ng.set(w,ig(ng.get(w)||null,l,d,f,x,D)),!0;case"gotpointercapture":return w=D.pointerId,rg.set(w,ig(rg.get(w)||null,l,d,f,x,D)),!0}return!1}function T5(l){var d=qt(l.target);if(d!==null){var f=a(d);if(f!==null){if(d=f.tag,d===13){if(d=o(f),d!==null){l.blockedOn=d,Ue(l.priority,function(){E5(f)});return}}else if(d===31){if(d=c(f),d!==null){l.blockedOn=d,Ue(l.priority,function(){E5(f)});return}}else if(d===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function vx(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var f=db(l.nativeEvent);if(f===null){f=l.nativeEvent;var x=new f.constructor(f.type,f);Ws=x,f.target.dispatchEvent(x),Ws=null}else return d=jt(f),d!==null&&v5(d),l.blockedOn=f,!1;d.shift()}return!0}function M5(l,d,f){vx(l)&&f.delete(d)}function k3(){hb=!1,ru!==null&&vx(ru)&&(ru=null),iu!==null&&vx(iu)&&(iu=null),au!==null&&vx(au)&&(au=null),ng.forEach(M5),rg.forEach(M5)}function Ex(l,d){l.blockedOn===d&&(l.blockedOn=null,hb||(hb=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,k3)))}var Dx=null;function I5(l){Dx!==l&&(Dx=l,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Dx===l&&(Dx=null);for(var d=0;d<l.length;d+=3){var f=l[d],x=l[d+1],D=l[d+2];if(typeof x!="function"){if(ub(x||f)===null)continue;break}var w=jt(f);w!==null&&(l.splice(d,3),d-=3,dy(w,{pending:!0,data:D,method:f.method,action:x},x,D))}}))}function Z0(l){function d(pt){return Ex(pt,l)}ru!==null&&Ex(ru,l),iu!==null&&Ex(iu,l),au!==null&&Ex(au,l),ng.forEach(d),rg.forEach(d);for(var f=0;f<lu.length;f++){var x=lu[f];x.blockedOn===l&&(x.blockedOn=null)}for(;0<lu.length&&(f=lu[0],f.blockedOn===null);)T5(f),f.blockedOn===null&&lu.shift();if(f=(l.ownerDocument||l).$$reactFormReplay,f!=null)for(x=0;x<f.length;x+=3){var D=f[x],w=f[x+1],oe=D[ds]||null;if(typeof w=="function")oe||I5(f);else if(oe){var Ae=null;if(w&&w.hasAttribute("formAction")){if(D=w,oe=w[ds]||null)Ae=oe.formAction;else if(ub(D)!==null)continue}else Ae=oe.action;typeof Ae=="function"?f[x+1]=Ae:(f.splice(x,3),x-=3),I5(f)}}}function j5(){function l(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(oe){return D=oe})},focusReset:"manual",scroll:"manual"})}function d(){D!==null&&(D(),D=null),x||setTimeout(f,20)}function f(){if(!x&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,D=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",d),navigation.addEventListener("navigateerror",d),setTimeout(f,100),function(){x=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",d),navigation.removeEventListener("navigateerror",d),D!==null&&(D(),D=null)}}}function fb(l){this._internalRoot=l}Rx.prototype.render=fb.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(r(409));var f=d.current,x=Bl();N5(f,x,l,d,null,null)},Rx.prototype.unmount=fb.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;N5(l.current,2,null,l,null,null),lx(),d[vs]=null}};function Rx(l){this._internalRoot=l}Rx.prototype.unstable_scheduleHydration=function(l){if(l){var d=$t();l={blockedOn:null,target:l,priority:d};for(var f=0;f<lu.length&&d!==0&&d<lu[f].priority;f++);lu.splice(f,0,l),f===0&&T5(l)}};var O5=e.version;if(O5!=="19.2.3")throw Error(r(527,O5,"19.2.3"));K.findDOMNode=function(l){var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=h(d),l=l!==null?m(l):null,l=l===null?null:l.stateNode,l};var U3={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tx.isDisabled&&Tx.supportsFiber)try{Ve=Tx.inject(U3),it=Tx}catch{}}return lg.createRoot=function(l,d){if(!i(l))throw Error(r(299));var f=!1,x="",D=BS,w=GS,oe=WS;return d!=null&&(d.unstable_strictMode===!0&&(f=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onUncaughtError!==void 0&&(D=d.onUncaughtError),d.onCaughtError!==void 0&&(w=d.onCaughtError),d.onRecoverableError!==void 0&&(oe=d.onRecoverableError)),d=b5(l,1,!1,null,null,f,x,null,D,w,oe,j5),l[vs]=d.current,zy(l),new fb(d)},lg.hydrateRoot=function(l,d,f){if(!i(l))throw Error(r(299));var x=!1,D="",w=BS,oe=GS,Ae=WS,pt=null;return f!=null&&(f.unstable_strictMode===!0&&(x=!0),f.identifierPrefix!==void 0&&(D=f.identifierPrefix),f.onUncaughtError!==void 0&&(w=f.onUncaughtError),f.onCaughtError!==void 0&&(oe=f.onCaughtError),f.onRecoverableError!==void 0&&(Ae=f.onRecoverableError),f.formState!==void 0&&(pt=f.formState)),d=b5(l,1,!0,d,f??null,x,D,pt,w,oe,Ae,j5),d.context=C5(null),f=d.current,x=Bl(),x=It(x),D=un(x),D.callback=null,En(f,D,x),f=x,d.current.lanes=f,Pe(d,f),yc(d),l[vs]=d.current,zy(l),new Rx(d)},lg.version="19.2.3",lg}var K5;function q3(){if(K5)return xb.exports;K5=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xb.exports=H3(),xb.exports}var X3=q3();const J3=F2(X3);var mm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Z3={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Eu,W2,VT,ew=(VT=class{constructor(){an(this,Eu,Z3);an(this,W2,!1)}setTimeoutProvider(t){Bs(this,Eu,t)}setTimeout(t,e){return yt(this,Eu).setTimeout(t,e)}clearTimeout(t){yt(this,Eu).clearTimeout(t)}setInterval(t,e){return yt(this,Eu).setInterval(t,e)}clearInterval(t){yt(this,Eu).clearInterval(t)}},Eu=new WeakMap,W2=new WeakMap,VT),Mh=new ew;function tw(t){setTimeout(t,0)}var Yh=typeof window>"u"||"Deno"in globalThis;function za(){}function sw(t,e){return typeof t=="function"?t(e):t}function OC(t){return typeof t=="number"&&t>=0&&t!==1/0}function iM(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Bu(t,e){return typeof t=="function"?t(e):t}function ao(t,e){return typeof t=="function"?t(e):t}function Q5(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:a,queryKey:o,stale:c}=t;if(o){if(r){if(e.queryHash!==Q2(o,e.options))return!1}else if(!Vg(e.queryKey,o))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||i&&i!==e.state.fetchStatus||a&&!a(e))}function Y5(t,e){const{exact:n,status:r,predicate:i,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(n){if(Vh(e.options.mutationKey)!==Vh(a))return!1}else if(!Vg(e.options.mutationKey,a))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function Q2(t,e){return((e==null?void 0:e.queryKeyHashFn)||Vh)(t)}function Vh(t){return JSON.stringify(t,(e,n)=>wC(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Vg(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Vg(t[n],e[n])):!1}var nw=Object.prototype.hasOwnProperty;function aM(t,e){if(t===e)return t;const n=V5(t)&&V5(e);if(!n&&!(wC(t)&&wC(e)))return e;const i=(n?t:Object.keys(t)).length,a=n?e:Object.keys(e),o=a.length,c=n?new Array(o):{};let u=0;for(let h=0;h<o;h++){const m=n?h:a[h],_=t[m],p=e[m];if(_===p){c[m]=_,(n?h<i:nw.call(t,m))&&u++;continue}if(_===null||p===null||typeof _!="object"||typeof p!="object"){c[m]=p;continue}const g=aM(_,p);c[m]=g,g===_&&u++}return i===o&&u===i?t:c}function jp(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function V5(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function wC(t){if(!$5(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!$5(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function $5(t){return Object.prototype.toString.call(t)==="[object Object]"}function rw(t){return new Promise(e=>{Mh.setTimeout(e,t)})}function LC(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?aM(t,e):e}function iw(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function aw(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Y2=Symbol();function lM(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Y2?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function oM(t,e){return typeof t=="function"?t(...e):!!t}var Lh,Du,Yf,$T,lw=($T=class extends mm{constructor(){super();an(this,Lh);an(this,Du);an(this,Yf);Bs(this,Yf,e=>{if(!Yh&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){yt(this,Du)||this.setEventListener(yt(this,Yf))}onUnsubscribe(){var e;this.hasListeners()||((e=yt(this,Du))==null||e.call(this),Bs(this,Du,void 0))}setEventListener(e){var n;Bs(this,Yf,e),(n=yt(this,Du))==null||n.call(this),Bs(this,Du,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){yt(this,Lh)!==e&&(Bs(this,Lh,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof yt(this,Lh)=="boolean"?yt(this,Lh):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Lh=new WeakMap,Du=new WeakMap,Yf=new WeakMap,$T),V2=new lw;function PC(){let t,e;const n=new Promise((i,a)=>{t=i,e=a});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var ow=tw;function cw(){let t=[],e=0,n=c=>{c()},r=c=>{c()},i=ow;const a=c=>{e?t.push(c):i(()=>{n(c)})},o=()=>{const c=t;t=[],c.length&&i(()=>{r(()=>{c.forEach(u=>{n(u)})})})};return{batch:c=>{let u;e++;try{u=c()}finally{e--,e||o()}return u},batchCalls:c=>(...u)=>{a(()=>{c(...u)})},schedule:a,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{i=c}}}var Zi=cw(),Vf,Ru,$f,zT,dw=(zT=class extends mm{constructor(){super();an(this,Vf,!0);an(this,Ru);an(this,$f);Bs(this,$f,e=>{if(!Yh&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){yt(this,Ru)||this.setEventListener(yt(this,$f))}onUnsubscribe(){var e;this.hasListeners()||((e=yt(this,Ru))==null||e.call(this),Bs(this,Ru,void 0))}setEventListener(e){var n;Bs(this,$f,e),(n=yt(this,Ru))==null||n.call(this),Bs(this,Ru,e(this.setOnline.bind(this)))}setOnline(e){yt(this,Vf)!==e&&(Bs(this,Vf,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return yt(this,Vf)}},Vf=new WeakMap,Ru=new WeakMap,$f=new WeakMap,zT),Op=new dw;function uw(t){return Math.min(1e3*2**t,3e4)}function cM(t){return(t??"online")==="online"?Op.isOnline():!0}var AC=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function dM(t){let e=!1,n=0,r;const i=PC(),a=()=>i.status!=="pending",o=y=>{var S;if(!a()){const v=new AC(y);p(v),(S=t.onCancel)==null||S.call(t,v)}},c=()=>{e=!0},u=()=>{e=!1},h=()=>V2.isFocused()&&(t.networkMode==="always"||Op.isOnline())&&t.canRun(),m=()=>cM(t.networkMode)&&t.canRun(),_=y=>{a()||(r==null||r(),i.resolve(y))},p=y=>{a()||(r==null||r(),i.reject(y))},g=()=>new Promise(y=>{var S;r=v=>{(a()||h())&&y(v)},(S=t.onPause)==null||S.call(t)}).then(()=>{var y;r=void 0,a()||(y=t.onContinue)==null||y.call(t)}),C=()=>{if(a())return;let y;const S=n===0?t.initialPromise:void 0;try{y=S??t.fn()}catch(v){y=Promise.reject(v)}Promise.resolve(y).then(_).catch(v=>{var F;if(a())return;const k=t.retry??(Yh?0:3),L=t.retryDelay??uw,M=typeof L=="function"?L(n,v):L,P=k===!0||typeof k=="number"&&n<k||typeof k=="function"&&k(n,v);if(e||!P){p(v);return}n++,(F=t.onFail)==null||F.call(t,n,v),rw(M).then(()=>h()?void 0:g()).then(()=>{e?p(v):C()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(r==null||r(),i),cancelRetry:c,continueRetry:u,canStart:m,start:()=>(m()?C():g().then(C),i)}}var Ph,HT,uM=(HT=class{constructor(){an(this,Ph)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),OC(this.gcTime)&&Bs(this,Ph,Mh.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Yh?1/0:300*1e3))}clearGcTimeout(){yt(this,Ph)&&(Mh.clearTimeout(yt(this,Ph)),Bs(this,Ph,void 0))}},Ph=new WeakMap,HT),Ah,zf,io,kh,ua,h_,Uh,Yo,dd,qT,hw=(qT=class extends uM{constructor(e){super();an(this,Yo);an(this,Ah);an(this,zf);an(this,io);an(this,kh);an(this,ua);an(this,h_);an(this,Uh);Bs(this,Uh,!1),Bs(this,h_,e.defaultOptions),this.setOptions(e.options),this.observers=[],Bs(this,kh,e.client),Bs(this,io,yt(this,kh).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Bs(this,Ah,H5(this.options)),this.state=e.state??yt(this,Ah),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=yt(this,ua))==null?void 0:e.promise}setOptions(e){if(this.options={...yt(this,h_),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=H5(this.options);n.data!==void 0&&(this.setState(z5(n.data,n.dataUpdatedAt)),Bs(this,Ah,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&yt(this,io).remove(this)}setData(e,n){const r=LC(this.state.data,e,this.options);return jn(this,Yo,dd).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){jn(this,Yo,dd).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=yt(this,ua))==null?void 0:r.promise;return(i=yt(this,ua))==null||i.cancel(e),n?n.then(za).catch(za):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(yt(this,Ah))}isActive(){return this.observers.some(e=>ao(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Y2||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Bu(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!iM(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=yt(this,ua))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=yt(this,ua))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),yt(this,io).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(yt(this,ua)&&(yt(this,Uh)?yt(this,ua).cancel({revert:!0}):yt(this,ua).cancelRetry()),this.scheduleGc()),yt(this,io).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||jn(this,Yo,dd).call(this,{type:"invalidate"})}async fetch(e,n){var u,h,m,_,p,g,C,y,S,v,k,L;if(this.state.fetchStatus!=="idle"&&((u=yt(this,ua))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(yt(this,ua))return yt(this,ua).continueRetry(),yt(this,ua).promise}if(e&&this.setOptions(e),!this.options.queryFn){const M=this.observers.find(P=>P.options.queryFn);M&&this.setOptions(M.options)}const r=new AbortController,i=M=>{Object.defineProperty(M,"signal",{enumerable:!0,get:()=>(Bs(this,Uh,!0),r.signal)})},a=()=>{const M=lM(this.options,n),F=(()=>{const G={client:yt(this,kh),queryKey:this.queryKey,meta:this.meta};return i(G),G})();return Bs(this,Uh,!1),this.options.persister?this.options.persister(M,F,this):M(F)},c=(()=>{const M={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:yt(this,kh),state:this.state,fetchFn:a};return i(M),M})();(h=this.options.behavior)==null||h.onFetch(c,this),Bs(this,zf,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=c.fetchOptions)==null?void 0:m.meta))&&jn(this,Yo,dd).call(this,{type:"fetch",meta:(_=c.fetchOptions)==null?void 0:_.meta}),Bs(this,ua,dM({initialPromise:n==null?void 0:n.initialPromise,fn:c.fetchFn,onCancel:M=>{M instanceof AC&&M.revert&&this.setState({...yt(this,zf),fetchStatus:"idle"}),r.abort()},onFail:(M,P)=>{jn(this,Yo,dd).call(this,{type:"failed",failureCount:M,error:P})},onPause:()=>{jn(this,Yo,dd).call(this,{type:"pause"})},onContinue:()=>{jn(this,Yo,dd).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const M=await yt(this,ua).start();if(M===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(M),(g=(p=yt(this,io).config).onSuccess)==null||g.call(p,M,this),(y=(C=yt(this,io).config).onSettled)==null||y.call(C,M,this.state.error,this),M}catch(M){if(M instanceof AC){if(M.silent)return yt(this,ua).promise;if(M.revert){if(this.state.data===void 0)throw M;return this.state.data}}throw jn(this,Yo,dd).call(this,{type:"error",error:M}),(v=(S=yt(this,io).config).onError)==null||v.call(S,M,this),(L=(k=yt(this,io).config).onSettled)==null||L.call(k,this.state.data,M,this),M}finally{this.scheduleGc()}}},Ah=new WeakMap,zf=new WeakMap,io=new WeakMap,kh=new WeakMap,ua=new WeakMap,h_=new WeakMap,Uh=new WeakMap,Yo=new WeakSet,dd=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...hM(r.data,this.options),fetchMeta:e.meta??null};case"success":const i={...r,...z5(e.data,e.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Bs(this,zf,e.manual?i:void 0),i;case"error":const a=e.error;return{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),Zi.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),yt(this,io).notify({query:this,type:"updated",action:e})})},qT);function hM(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:cM(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function z5(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function H5(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var pl,Yn,f_,Va,Bh,Hf,gd,Tu,m_,qf,Xf,Gh,Wh,Mu,Jf,xr,bg,kC,UC,BC,GC,WC,FC,KC,fM,XT,fw=(XT=class extends mm{constructor(e,n){super();an(this,xr);an(this,pl);an(this,Yn);an(this,f_);an(this,Va);an(this,Bh);an(this,Hf);an(this,gd);an(this,Tu);an(this,m_);an(this,qf);an(this,Xf);an(this,Gh);an(this,Wh);an(this,Mu);an(this,Jf,new Set);this.options=n,Bs(this,pl,e),Bs(this,Tu,null),Bs(this,gd,PC()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(yt(this,Yn).addObserver(this),q5(yt(this,Yn),this.options)?jn(this,xr,bg).call(this):this.updateResult(),jn(this,xr,GC).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return QC(yt(this,Yn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return QC(yt(this,Yn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,jn(this,xr,WC).call(this),jn(this,xr,FC).call(this),yt(this,Yn).removeObserver(this)}setOptions(e){const n=this.options,r=yt(this,Yn);if(this.options=yt(this,pl).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ao(this.options.enabled,yt(this,Yn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");jn(this,xr,KC).call(this),yt(this,Yn).setOptions(this.options),n._defaulted&&!jp(this.options,n)&&yt(this,pl).getQueryCache().notify({type:"observerOptionsUpdated",query:yt(this,Yn),observer:this});const i=this.hasListeners();i&&X5(yt(this,Yn),r,this.options,n)&&jn(this,xr,bg).call(this),this.updateResult(),i&&(yt(this,Yn)!==r||ao(this.options.enabled,yt(this,Yn))!==ao(n.enabled,yt(this,Yn))||Bu(this.options.staleTime,yt(this,Yn))!==Bu(n.staleTime,yt(this,Yn)))&&jn(this,xr,kC).call(this);const a=jn(this,xr,UC).call(this);i&&(yt(this,Yn)!==r||ao(this.options.enabled,yt(this,Yn))!==ao(n.enabled,yt(this,Yn))||a!==yt(this,Mu))&&jn(this,xr,BC).call(this,a)}getOptimisticResult(e){const n=yt(this,pl).getQueryCache().build(yt(this,pl),e),r=this.createResult(n,e);return gw(this,r)&&(Bs(this,Va,r),Bs(this,Hf,this.options),Bs(this,Bh,yt(this,Yn).state)),r}getCurrentResult(){return yt(this,Va)}trackResult(e,n){return new Proxy(e,{get:(r,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&yt(this,gd).status==="pending"&&yt(this,gd).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,i))})}trackProp(e){yt(this,Jf).add(e)}getCurrentQuery(){return yt(this,Yn)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=yt(this,pl).defaultQueryOptions(e),r=yt(this,pl).getQueryCache().build(yt(this,pl),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return jn(this,xr,bg).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),yt(this,Va)))}createResult(e,n){var I;const r=yt(this,Yn),i=this.options,a=yt(this,Va),o=yt(this,Bh),c=yt(this,Hf),h=e!==r?e.state:yt(this,f_),{state:m}=e;let _={...m},p=!1,g;if(n._optimisticResults){const E=this.hasListeners(),A=!E&&q5(e,n),Y=E&&X5(e,r,n,i);(A||Y)&&(_={..._,...hM(m.data,e.options)}),n._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:C,errorUpdatedAt:y,status:S}=_;g=_.data;let v=!1;if(n.placeholderData!==void 0&&g===void 0&&S==="pending"){let E;a!=null&&a.isPlaceholderData&&n.placeholderData===(c==null?void 0:c.placeholderData)?(E=a.data,v=!0):E=typeof n.placeholderData=="function"?n.placeholderData((I=yt(this,Xf))==null?void 0:I.state.data,yt(this,Xf)):n.placeholderData,E!==void 0&&(S="success",g=LC(a==null?void 0:a.data,E,n),p=!0)}if(n.select&&g!==void 0&&!v)if(a&&g===(o==null?void 0:o.data)&&n.select===yt(this,m_))g=yt(this,qf);else try{Bs(this,m_,n.select),g=n.select(g),g=LC(a==null?void 0:a.data,g,n),Bs(this,qf,g),Bs(this,Tu,null)}catch(E){Bs(this,Tu,E)}yt(this,Tu)&&(C=yt(this,Tu),g=yt(this,qf),y=Date.now(),S="error");const k=_.fetchStatus==="fetching",L=S==="pending",M=S==="error",P=L&&k,F=g!==void 0,B={status:S,fetchStatus:_.fetchStatus,isPending:L,isSuccess:S==="success",isError:M,isInitialLoading:P,isLoading:P,data:g,dataUpdatedAt:_.dataUpdatedAt,error:C,errorUpdatedAt:y,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>h.dataUpdateCount||_.errorUpdateCount>h.errorUpdateCount,isFetching:k,isRefetching:k&&!L,isLoadingError:M&&!F,isPaused:_.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:M&&F,isStale:$2(e,n),refetch:this.refetch,promise:yt(this,gd),isEnabled:ao(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const E=ee=>{B.status==="error"?ee.reject(B.error):B.data!==void 0&&ee.resolve(B.data)},A=()=>{const ee=Bs(this,gd,B.promise=PC());E(ee)},Y=yt(this,gd);switch(Y.status){case"pending":e.queryHash===r.queryHash&&E(Y);break;case"fulfilled":(B.status==="error"||B.data!==Y.value)&&A();break;case"rejected":(B.status!=="error"||B.error!==Y.reason)&&A();break}}return B}updateResult(){const e=yt(this,Va),n=this.createResult(yt(this,Yn),this.options);if(Bs(this,Bh,yt(this,Yn).state),Bs(this,Hf,this.options),yt(this,Bh).data!==void 0&&Bs(this,Xf,yt(this,Yn)),jp(n,e))return;Bs(this,Va,n);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!yt(this,Jf).size)return!0;const o=new Set(a??yt(this,Jf));return this.options.throwOnError&&o.add("error"),Object.keys(yt(this,Va)).some(c=>{const u=c;return yt(this,Va)[u]!==e[u]&&o.has(u)})};jn(this,xr,fM).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&jn(this,xr,GC).call(this)}},pl=new WeakMap,Yn=new WeakMap,f_=new WeakMap,Va=new WeakMap,Bh=new WeakMap,Hf=new WeakMap,gd=new WeakMap,Tu=new WeakMap,m_=new WeakMap,qf=new WeakMap,Xf=new WeakMap,Gh=new WeakMap,Wh=new WeakMap,Mu=new WeakMap,Jf=new WeakMap,xr=new WeakSet,bg=function(e){jn(this,xr,KC).call(this);let n=yt(this,Yn).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(za)),n},kC=function(){jn(this,xr,WC).call(this);const e=Bu(this.options.staleTime,yt(this,Yn));if(Yh||yt(this,Va).isStale||!OC(e))return;const r=iM(yt(this,Va).dataUpdatedAt,e)+1;Bs(this,Gh,Mh.setTimeout(()=>{yt(this,Va).isStale||this.updateResult()},r))},UC=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(yt(this,Yn)):this.options.refetchInterval)??!1},BC=function(e){jn(this,xr,FC).call(this),Bs(this,Mu,e),!(Yh||ao(this.options.enabled,yt(this,Yn))===!1||!OC(yt(this,Mu))||yt(this,Mu)===0)&&Bs(this,Wh,Mh.setInterval(()=>{(this.options.refetchIntervalInBackground||V2.isFocused())&&jn(this,xr,bg).call(this)},yt(this,Mu)))},GC=function(){jn(this,xr,kC).call(this),jn(this,xr,BC).call(this,jn(this,xr,UC).call(this))},WC=function(){yt(this,Gh)&&(Mh.clearTimeout(yt(this,Gh)),Bs(this,Gh,void 0))},FC=function(){yt(this,Wh)&&(Mh.clearInterval(yt(this,Wh)),Bs(this,Wh,void 0))},KC=function(){const e=yt(this,pl).getQueryCache().build(yt(this,pl),this.options);if(e===yt(this,Yn))return;const n=yt(this,Yn);Bs(this,Yn,e),Bs(this,f_,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},fM=function(e){Zi.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(yt(this,Va))}),yt(this,pl).getQueryCache().notify({query:yt(this,Yn),type:"observerResultsUpdated"})})},XT);function mw(t,e){return ao(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function q5(t,e){return mw(t,e)||t.state.data!==void 0&&QC(t,e,e.refetchOnMount)}function QC(t,e,n){if(ao(e.enabled,t)!==!1&&Bu(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&$2(t,e)}return!1}function X5(t,e,n,r){return(t!==e||ao(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&$2(t,n)}function $2(t,e){return ao(e.enabled,t)!==!1&&t.isStaleByTime(Bu(e.staleTime,t))}function gw(t,e){return!jp(t.getCurrentResult(),e)}function J5(t){return{onFetch:(e,n)=>{var m,_,p,g,C;const r=e.options,i=(p=(_=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:_.fetchMore)==null?void 0:p.direction,a=((g=e.state.data)==null?void 0:g.pages)||[],o=((C=e.state.data)==null?void 0:C.pageParams)||[];let c={pages:[],pageParams:[]},u=0;const h=async()=>{let y=!1;const S=L=>{Object.defineProperty(L,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},v=lM(e.options,e.fetchOptions),k=async(L,M,P)=>{if(y)return Promise.reject();if(M==null&&L.pages.length)return Promise.resolve(L);const G=(()=>{const A={client:e.client,queryKey:e.queryKey,pageParam:M,direction:P?"backward":"forward",meta:e.options.meta};return S(A),A})(),B=await v(G),{maxPages:I}=e.options,E=P?aw:iw;return{pages:E(L.pages,B,I),pageParams:E(L.pageParams,M,I)}};if(i&&a.length){const L=i==="backward",M=L?_w:Z5,P={pages:a,pageParams:o},F=M(r,P);c=await k(P,F,L)}else{const L=t??a.length;do{const M=u===0?o[0]??r.initialPageParam:Z5(r,c);if(u>0&&M==null)break;c=await k(c,M),u++}while(u<L)}return c};e.options.persister?e.fetchFn=()=>{var y,S;return(S=(y=e.options).persister)==null?void 0:S.call(y,h,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=h}}}function Z5(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function _w(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var g_,vc,$a,Fh,Ec,yu,JT,xw=(JT=class extends uM{constructor(e){super();an(this,Ec);an(this,g_);an(this,vc);an(this,$a);an(this,Fh);Bs(this,g_,e.client),this.mutationId=e.mutationId,Bs(this,$a,e.mutationCache),Bs(this,vc,[]),this.state=e.state||mM(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){yt(this,vc).includes(e)||(yt(this,vc).push(e),this.clearGcTimeout(),yt(this,$a).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Bs(this,vc,yt(this,vc).filter(n=>n!==e)),this.scheduleGc(),yt(this,$a).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){yt(this,vc).length||(this.state.status==="pending"?this.scheduleGc():yt(this,$a).remove(this))}continue(){var e;return((e=yt(this,Fh))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,c,u,h,m,_,p,g,C,y,S,v,k,L,M,P,F,G,B,I;const n=()=>{jn(this,Ec,yu).call(this,{type:"continue"})},r={client:yt(this,g_),meta:this.options.meta,mutationKey:this.options.mutationKey};Bs(this,Fh,dM({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(E,A)=>{jn(this,Ec,yu).call(this,{type:"failed",failureCount:E,error:A})},onPause:()=>{jn(this,Ec,yu).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>yt(this,$a).canRun(this)}));const i=this.state.status==="pending",a=!yt(this,Fh).canStart();try{if(i)n();else{jn(this,Ec,yu).call(this,{type:"pending",variables:e,isPaused:a}),await((c=(o=yt(this,$a).config).onMutate)==null?void 0:c.call(o,e,this,r));const A=await((h=(u=this.options).onMutate)==null?void 0:h.call(u,e,r));A!==this.state.context&&jn(this,Ec,yu).call(this,{type:"pending",context:A,variables:e,isPaused:a})}const E=await yt(this,Fh).start();return await((_=(m=yt(this,$a).config).onSuccess)==null?void 0:_.call(m,E,e,this.state.context,this,r)),await((g=(p=this.options).onSuccess)==null?void 0:g.call(p,E,e,this.state.context,r)),await((y=(C=yt(this,$a).config).onSettled)==null?void 0:y.call(C,E,null,this.state.variables,this.state.context,this,r)),await((v=(S=this.options).onSettled)==null?void 0:v.call(S,E,null,e,this.state.context,r)),jn(this,Ec,yu).call(this,{type:"success",data:E}),E}catch(E){try{throw await((L=(k=yt(this,$a).config).onError)==null?void 0:L.call(k,E,e,this.state.context,this,r)),await((P=(M=this.options).onError)==null?void 0:P.call(M,E,e,this.state.context,r)),await((G=(F=yt(this,$a).config).onSettled)==null?void 0:G.call(F,void 0,E,this.state.variables,this.state.context,this,r)),await((I=(B=this.options).onSettled)==null?void 0:I.call(B,void 0,E,e,this.state.context,r)),E}finally{jn(this,Ec,yu).call(this,{type:"error",error:E})}}finally{yt(this,$a).runNext(this)}}},g_=new WeakMap,vc=new WeakMap,$a=new WeakMap,Fh=new WeakMap,Ec=new WeakSet,yu=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Zi.batch(()=>{yt(this,vc).forEach(r=>{r.onMutationUpdate(e)}),yt(this,$a).notify({mutation:this,type:"updated",action:e})})},JT);function mM(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var _d,Vo,__,ZT,pw=(ZT=class extends mm{constructor(e={}){super();an(this,_d);an(this,Vo);an(this,__);this.config=e,Bs(this,_d,new Set),Bs(this,Vo,new Map),Bs(this,__,0)}build(e,n,r){const i=new xw({client:e,mutationCache:this,mutationId:++Mx(this,__)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){yt(this,_d).add(e);const n=Ix(e);if(typeof n=="string"){const r=yt(this,Vo).get(n);r?r.push(e):yt(this,Vo).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(yt(this,_d).delete(e)){const n=Ix(e);if(typeof n=="string"){const r=yt(this,Vo).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&yt(this,Vo).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Ix(e);if(typeof n=="string"){const r=yt(this,Vo).get(n),i=r==null?void 0:r.find(a=>a.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=Ix(e);if(typeof n=="string"){const i=(r=yt(this,Vo).get(n))==null?void 0:r.find(a=>a!==e&&a.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Zi.batch(()=>{yt(this,_d).forEach(e=>{this.notify({type:"removed",mutation:e})}),yt(this,_d).clear(),yt(this,Vo).clear()})}getAll(){return Array.from(yt(this,_d))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Y5(n,r))}findAll(e={}){return this.getAll().filter(n=>Y5(e,n))}notify(e){Zi.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Zi.batch(()=>Promise.all(e.map(n=>n.continue().catch(za))))}},_d=new WeakMap,Vo=new WeakMap,__=new WeakMap,ZT);function Ix(t){var e;return(e=t.options.scope)==null?void 0:e.id}var xd,Iu,yl,pd,Sd,hp,YC,eM,yw=(eM=class extends mm{constructor(n,r){super();an(this,Sd);an(this,xd);an(this,Iu);an(this,yl);an(this,pd);Bs(this,xd,n),this.setOptions(r),this.bindMethods(),jn(this,Sd,hp).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=yt(this,xd).defaultMutationOptions(n),jp(this.options,r)||yt(this,xd).getMutationCache().notify({type:"observerOptionsUpdated",mutation:yt(this,yl),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Vh(r.mutationKey)!==Vh(this.options.mutationKey)?this.reset():((i=yt(this,yl))==null?void 0:i.state.status)==="pending"&&yt(this,yl).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=yt(this,yl))==null||n.removeObserver(this)}onMutationUpdate(n){jn(this,Sd,hp).call(this),jn(this,Sd,YC).call(this,n)}getCurrentResult(){return yt(this,Iu)}reset(){var n;(n=yt(this,yl))==null||n.removeObserver(this),Bs(this,yl,void 0),jn(this,Sd,hp).call(this),jn(this,Sd,YC).call(this)}mutate(n,r){var i;return Bs(this,pd,r),(i=yt(this,yl))==null||i.removeObserver(this),Bs(this,yl,yt(this,xd).getMutationCache().build(yt(this,xd),this.options)),yt(this,yl).addObserver(this),yt(this,yl).execute(n)}},xd=new WeakMap,Iu=new WeakMap,yl=new WeakMap,pd=new WeakMap,Sd=new WeakSet,hp=function(){var r;const n=((r=yt(this,yl))==null?void 0:r.state)??mM();Bs(this,Iu,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},YC=function(n){Zi.batch(()=>{var r,i,a,o,c,u,h,m;if(yt(this,pd)&&this.hasListeners()){const _=yt(this,Iu).variables,p=yt(this,Iu).context,g={client:yt(this,xd),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((i=(r=yt(this,pd)).onSuccess)==null||i.call(r,n.data,_,p,g),(o=(a=yt(this,pd)).onSettled)==null||o.call(a,n.data,null,_,p,g)):(n==null?void 0:n.type)==="error"&&((u=(c=yt(this,pd)).onError)==null||u.call(c,n.error,_,p,g),(m=(h=yt(this,pd)).onSettled)==null||m.call(h,void 0,n.error,_,p,g))}this.listeners.forEach(_=>{_(yt(this,Iu))})})},eM),Dc,tM,bw=(tM=class extends mm{constructor(e={}){super();an(this,Dc);this.config=e,Bs(this,Dc,new Map)}build(e,n,r){const i=n.queryKey,a=n.queryHash??Q2(i,n);let o=this.get(a);return o||(o=new hw({client:e,queryKey:i,queryHash:a,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){yt(this,Dc).has(e.queryHash)||(yt(this,Dc).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=yt(this,Dc).get(e.queryHash);n&&(e.destroy(),n===e&&yt(this,Dc).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Zi.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return yt(this,Dc).get(e)}getAll(){return[...yt(this,Dc).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Q5(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Q5(e,r)):n}notify(e){Zi.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Zi.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Zi.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Dc=new WeakMap,tM),xi,ju,Ou,Zf,em,wu,tm,sm,sM,Cw=(sM=class{constructor(t={}){an(this,xi);an(this,ju);an(this,Ou);an(this,Zf);an(this,em);an(this,wu);an(this,tm);an(this,sm);Bs(this,xi,t.queryCache||new bw),Bs(this,ju,t.mutationCache||new pw),Bs(this,Ou,t.defaultOptions||{}),Bs(this,Zf,new Map),Bs(this,em,new Map),Bs(this,wu,0)}mount(){Mx(this,wu)._++,yt(this,wu)===1&&(Bs(this,tm,V2.subscribe(async t=>{t&&(await this.resumePausedMutations(),yt(this,xi).onFocus())})),Bs(this,sm,Op.subscribe(async t=>{t&&(await this.resumePausedMutations(),yt(this,xi).onOnline())})))}unmount(){var t,e;Mx(this,wu)._--,yt(this,wu)===0&&((t=yt(this,tm))==null||t.call(this),Bs(this,tm,void 0),(e=yt(this,sm))==null||e.call(this),Bs(this,sm,void 0))}isFetching(t){return yt(this,xi).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return yt(this,ju).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=yt(this,xi).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=yt(this,xi).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Bu(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return yt(this,xi).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=yt(this,xi).get(r.queryHash),a=i==null?void 0:i.state.data,o=sw(e,a);if(o!==void 0)return yt(this,xi).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Zi.batch(()=>yt(this,xi).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=yt(this,xi).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=yt(this,xi);Zi.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=yt(this,xi);return Zi.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Zi.batch(()=>yt(this,xi).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(za).catch(za)}invalidateQueries(t,e={}){return Zi.batch(()=>(yt(this,xi).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Zi.batch(()=>yt(this,xi).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,n);return n.throwOnError||(a=a.catch(za)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(r).then(za)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=yt(this,xi).build(this,e);return n.isStaleByTime(Bu(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(za).catch(za)}fetchInfiniteQuery(t){return t.behavior=J5(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(za).catch(za)}ensureInfiniteQueryData(t){return t.behavior=J5(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Op.isOnline()?yt(this,ju).resumePausedMutations():Promise.resolve()}getQueryCache(){return yt(this,xi)}getMutationCache(){return yt(this,ju)}getDefaultOptions(){return yt(this,Ou)}setDefaultOptions(t){Bs(this,Ou,t)}setQueryDefaults(t,e){yt(this,Zf).set(Vh(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...yt(this,Zf).values()],n={};return e.forEach(r=>{Vg(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){yt(this,em).set(Vh(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...yt(this,em).values()],n={};return e.forEach(r=>{Vg(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...yt(this,Ou).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Q2(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Y2&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...yt(this,Ou).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){yt(this,xi).clear(),yt(this,ju).clear()}},xi=new WeakMap,ju=new WeakMap,Ou=new WeakMap,Zf=new WeakMap,em=new WeakMap,wu=new WeakMap,tm=new WeakMap,sm=new WeakMap,sM),gM=b.createContext(void 0),z2=t=>{const e=b.useContext(gM);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Nw=({client:t,children:e})=>(b.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(gM.Provider,{value:t,children:e})),_M=b.createContext(!1),Sw=()=>b.useContext(_M);_M.Provider;function vw(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Ew=b.createContext(vw()),Dw=()=>b.useContext(Ew),Rw=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Tw=t=>{b.useEffect(()=>{t.clearReset()},[t])},Mw=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||oM(n,[t.error,r])),Iw=t=>{if(t.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},jw=(t,e)=>t.isLoading&&t.isFetching&&!e,Ow=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,eE=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function ww(t,e,n){var _,p,g,C,y;const r=Sw(),i=Dw(),a=z2(),o=a.defaultQueryOptions(t);(p=(_=a.getDefaultOptions().queries)==null?void 0:_._experimental_beforeQuery)==null||p.call(_,o),o._optimisticResults=r?"isRestoring":"optimistic",Iw(o),Rw(o,i),Tw(i);const c=!a.getQueryCache().get(o.queryHash),[u]=b.useState(()=>new e(a,o)),h=u.getOptimisticResult(o),m=!r&&t.subscribed!==!1;if(b.useSyncExternalStore(b.useCallback(S=>{const v=m?u.subscribe(Zi.batchCalls(S)):za;return u.updateResult(),v},[u,m]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),b.useEffect(()=>{u.setOptions(o)},[o,u]),Ow(o,h))throw eE(o,u,i);if(Mw({result:h,errorResetBoundary:i,throwOnError:o.throwOnError,query:a.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw h.error;if((C=(g=a.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||C.call(g,o,h),o.experimental_prefetchInRender&&!Yh&&jw(h,r)){const S=c?eE(o,u,i):(y=a.getQueryCache().get(o.queryHash))==null?void 0:y.promise;S==null||S.catch(za).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?h:u.trackResult(h)}function Lw(t,e){return ww(t,fw)}function Pw(t,e){const n=z2(),[r]=b.useState(()=>new yw(n,t));b.useEffect(()=>{r.setOptions(t)},[r,t]);const i=b.useSyncExternalStore(b.useCallback(o=>r.subscribe(Zi.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),a=b.useCallback((o,c)=>{r.mutate(o,c).catch(za)},[r]);if(i.error&&oM(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}const Aw="modulepreload",kw=function(t){return"/"+t},tE={},Cb=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let o=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=o(n.map(h=>{if(h=kw(h),h in tE)return;tE[h]=!0;const m=h.endsWith(".css"),_=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${_}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":Aw,m||(p.as="script"),p.crossOrigin="",p.href=h,u&&p.setAttribute("nonce",u),document.head.appendChild(p),m)return new Promise((g,C)=>{p.addEventListener("load",g),p.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};var Uw=function(){return null};const sE=new Cw({defaultOptions:{queries:{staleTime:300*1e3,gcTime:600*1e3,retry:1,retryDelay:1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!0,networkMode:"online"},mutations:{retry:0,networkMode:"online"}}});/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gw=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),nE=t=>{const e=Gw(t);return e.charAt(0).toUpperCase()+e.slice(1)},xM=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),Ww=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>b.createElement("svg",{ref:u,...Fw,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:xM("lucide",i),...!a&&!Ww(c)&&{"aria-hidden":"true"},...c},[...o.map(([h,m])=>b.createElement(h,m)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=(t,e)=>{const n=b.forwardRef(({className:r,...i},a)=>b.createElement(Kw,{ref:a,iconNode:e,className:xM(`lucide-${Bw(nE(t))}`,`lucide-${t}`,r),...i}));return n.displayName=nE(t),n};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],r0=Gs("arrow-down",Qw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],H2=Gs("arrow-left",Yw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],$w=Gs("arrow-right-left",Vw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Hw=Gs("arrow-right",zw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],i0=Gs("arrow-up",qw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],Jw=Gs("boxes",Xw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],eL=Gs("building-2",Zw);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tL=[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]],sL=Gs("cable",tL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],nm=Gs("calendar",nL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rL=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],rE=Gs("camera",rL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],jc=Gs("check",iL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ir=Gs("chevron-down",aL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],pM=Gs("chevron-left",lL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],cL=Gs("chevron-right",oL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],kr=Gs("chevron-up",dL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Vr=Gs("circle-alert",uL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ea=Gs("circle-check-big",hL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],a0=Gs("circle-check",fL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],tc=Gs("circle-x",mL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],C1=Gs("clipboard-list",gL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _L=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],wp=Gs("clock",_L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xL=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Lp=Gs("credit-card",xL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pL=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],yL=Gs("crown",pL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],yM=Gs("database",bL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],bM=Gs("ellipsis",CL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],og=Gs("external-link",NL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],vL=Gs("file-down",SL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EL=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$h=Gs("file-text",EL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],CM=Gs("funnel",DL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],vd=Gs("history",RL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],ML=Gs("house",TL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],NM=Gs("info",IL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],OL=Gs("layers",jL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],q2=Gs("list",wL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],On=Gs("loader-circle",LL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],AL=Gs("log-out",PL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ed=Gs("map-pin",kL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],BL=Gs("map",UL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],WL=Gs("menu",GL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FL=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],iE=Gs("message-square",FL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],QL=Gs("monitor",KL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],VL=Gs("navigation",YL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],rm=Gs("package",$L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],HL=Gs("pause",zL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qL=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],XL=Gs("pen-tool",qL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],VC=Gs("phone",JL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],eP=Gs("play",ZL);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],sP=Gs("plus",tP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Oc=Gs("refresh-cw",nP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ai=Gs("rotate-ccw",rP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]],aP=Gs("router",iP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oP=Gs("save",lP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],l0=Gs("scan-barcode",cP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Yu=Gs("search",dP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],X2=Gs("send",uP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],aE=Gs("server",hP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J2=Gs("settings",fP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],lE=Gs("shield",mP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],$C=Gs("smartphone",gP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Pp=Gs("square-check-big",_P);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ap=Gs("square-x",xP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],yP=Gs("test-tube",pP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],CP=Gs("trash-2",bP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],go=Gs("triangle-alert",NP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],vP=Gs("tv",SP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],DP=Gs("user-check",EP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],TP=Gs("user-plus",RP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],o0=Gs("user",MP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],SM=Gs("users",IP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],kp=Gs("wifi",jP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],Gu=Gs("wrench",OP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Mi=Gs("x",wP);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],oE=Gs("zap",LP),PP=({className:t})=>s.jsx("div",{className:`font-extrabold tracking-tight ${t}`,style:{fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"},children:"D'LIVE"}),AP=({onLogout:t,onNavigateHome:e,onNavigateBack:n,onMenuClick:r,currentView:i,userInfo:a,selectedWorkItem:o})=>{const[c,u]=b.useState(!1),h=b.useRef(null);b.useEffect(()=>{const g=C=>{h.current&&!h.current.contains(C.target)&&u(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const _=(g=>{const C=(o==null?void 0:o.WRK_CD_NM)||(o==null?void 0:o.typeDisplay)||"";switch(g){case"today-work":return{title:" "};case"work-management":return{title:""};case"work-order-detail":return{title:""};case"work-complete-form":return{title:"",workType:C};case"work-complete-detail":return{title:"",workType:C};case"work-item-list":return{title:""};case"work-process-flow":return{title:"",workType:C};case"customer-management":return{title:""};case"equipment-management":return{title:""};case"other-management":return{title:""};case"coming-soon":return{title:""};default:return null}})(i),p=i==="today-work"||i==="menu"||!i;return s.jsx("header",{className:"bg-white shadow-sm fixed top-0 left-0 right-0 z-[100] border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6",children:s.jsxs("div",{className:"flex items-center h-12",children:[s.jsxs("div",{className:"flex items-center gap-0 w-24 flex-shrink-0",children:[!p&&s.jsx("button",{onClick:n||e,className:"p-1.5 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors duration-200","aria-label":"",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),r&&s.jsx("button",{onClick:r,className:"p-1.5 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors duration-200","aria-label":" ",children:s.jsx(WL,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:p?s.jsx("button",{onClick:e,className:"flex items-center cursor-pointer","aria-label":"  ",children:s.jsx(PP,{className:"text-xl text-blue-600"})}):_?s.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[_.title,_.workType&&s.jsxs("span",{className:"text-blue-600",children:["(",_.workType,")"]})]}):null}),s.jsx("div",{className:"w-24 flex-shrink-0 flex justify-end",children:s.jsxs("div",{className:"relative",ref:h,children:[s.jsxs("button",{onClick:()=>u(!c),className:`flex flex-col items-center p-1.5 rounded-lg transition-colors duration-200 ${c?"text-blue-700 bg-blue-50":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,"aria-label":" ",children:[s.jsx(o0,{className:"w-4 h-4"}),s.jsx("span",{className:"text-[0.5625rem] mt-0.5 truncate max-w-[60px]",children:a?`${a.userName||""}`:""})]}),c&&s.jsxs("div",{className:"fixed right-2 top-12 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[9999]",children:[s.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(a==null?void 0:a.userName)||""}),s.jsx("p",{className:"text-xs text-gray-500",children:(a==null?void 0:a.userId)||""}),s.jsx("p",{className:"text-xs text-gray-400",children:(a==null?void 0:a.userRole)||""})]}),s.jsx("button",{onClick:()=>{u(!1),t()},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:""})]})]})})]})})})};var fp={exports:{}},kP=fp.exports,cE;function UP(){return cE||(cE=1,(function(t,e){(function(n,r){t.exports=r()})(kP,(function(){var n=1e3,r=6e4,i=36e5,a="millisecond",o="second",c="minute",u="hour",h="day",m="week",_="month",p="quarter",g="year",C="date",y="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(J){var H=["th","st","nd","rd"],V=J%100;return"["+J+(H[(V-20)%10]||H[V]||H[0])+"]"}},L=function(J,H,V){var K=String(J);return!K||K.length>=H?J:""+Array(H+1-K.length).join(V)+J},M={s:L,z:function(J){var H=-J.utcOffset(),V=Math.abs(H),K=Math.floor(V/60),j=V%60;return(H<=0?"+":"-")+L(K,2,"0")+":"+L(j,2,"0")},m:function J(H,V){if(H.date()<V.date())return-J(V,H);var K=12*(V.year()-H.year())+(V.month()-H.month()),j=H.clone().add(K,_),te=V-j<0,ce=H.clone().add(K+(te?-1:1),_);return+(-(K+(V-j)/(te?j-ce:ce-j))||0)},a:function(J){return J<0?Math.ceil(J)||0:Math.floor(J)},p:function(J){return{M:_,y:g,w:m,d:h,D:C,h:u,m:c,s:o,ms:a,Q:p}[J]||String(J||"").toLowerCase().replace(/s$/,"")},u:function(J){return J===void 0}},P="en",F={};F[P]=k;var G="$isDayjsObject",B=function(J){return J instanceof Y||!(!J||!J[G])},I=function J(H,V,K){var j;if(!H)return P;if(typeof H=="string"){var te=H.toLowerCase();F[te]&&(j=te),V&&(F[te]=V,j=te);var ce=H.split("-");if(!j&&ce.length>1)return J(ce[0])}else{var R=H.name;F[R]=H,j=R}return!K&&j&&(P=j),j||!K&&P},E=function(J,H){if(B(J))return J.clone();var V=typeof H=="object"?H:{};return V.date=J,V.args=arguments,new Y(V)},A=M;A.l=I,A.i=B,A.w=function(J,H){return E(J,{locale:H.$L,utc:H.$u,x:H.$x,$offset:H.$offset})};var Y=(function(){function J(V){this.$L=I(V.locale,null,!0),this.parse(V),this.$x=this.$x||V.x||{},this[G]=!0}var H=J.prototype;return H.parse=function(V){this.$d=(function(K){var j=K.date,te=K.utc;if(j===null)return new Date(NaN);if(A.u(j))return new Date;if(j instanceof Date)return new Date(j);if(typeof j=="string"&&!/Z$/i.test(j)){var ce=j.match(S);if(ce){var R=ce[2]-1||0,O=(ce[7]||"0").substring(0,3);return te?new Date(Date.UTC(ce[1],R,ce[3]||1,ce[4]||0,ce[5]||0,ce[6]||0,O)):new Date(ce[1],R,ce[3]||1,ce[4]||0,ce[5]||0,ce[6]||0,O)}}return new Date(j)})(V),this.init()},H.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},H.$utils=function(){return A},H.isValid=function(){return this.$d.toString()!==y},H.isSame=function(V,K){var j=E(V);return this.startOf(K)<=j&&j<=this.endOf(K)},H.isAfter=function(V,K){return E(V)<this.startOf(K)},H.isBefore=function(V,K){return this.endOf(K)<E(V)},H.$g=function(V,K,j){return A.u(V)?this[K]:this.set(j,V)},H.unix=function(){return Math.floor(this.valueOf()/1e3)},H.valueOf=function(){return this.$d.getTime()},H.startOf=function(V,K){var j=this,te=!!A.u(K)||K,ce=A.p(V),R=function(_e,ie){var Ne=A.w(j.$u?Date.UTC(j.$y,ie,_e):new Date(j.$y,ie,_e),j);return te?Ne:Ne.endOf(h)},O=function(_e,ie){return A.w(j.toDate()[_e].apply(j.toDate("s"),(te?[0,0,0,0]:[23,59,59,999]).slice(ie)),j)},U=this.$W,Q=this.$M,q=this.$D,$="set"+(this.$u?"UTC":"");switch(ce){case g:return te?R(1,0):R(31,11);case _:return te?R(1,Q):R(0,Q+1);case m:var de=this.$locale().weekStart||0,ae=(U<de?U+7:U)-de;return R(te?q-ae:q+(6-ae),Q);case h:case C:return O($+"Hours",0);case u:return O($+"Minutes",1);case c:return O($+"Seconds",2);case o:return O($+"Milliseconds",3);default:return this.clone()}},H.endOf=function(V){return this.startOf(V,!1)},H.$set=function(V,K){var j,te=A.p(V),ce="set"+(this.$u?"UTC":""),R=(j={},j[h]=ce+"Date",j[C]=ce+"Date",j[_]=ce+"Month",j[g]=ce+"FullYear",j[u]=ce+"Hours",j[c]=ce+"Minutes",j[o]=ce+"Seconds",j[a]=ce+"Milliseconds",j)[te],O=te===h?this.$D+(K-this.$W):K;if(te===_||te===g){var U=this.clone().set(C,1);U.$d[R](O),U.init(),this.$d=U.set(C,Math.min(this.$D,U.daysInMonth())).$d}else R&&this.$d[R](O);return this.init(),this},H.set=function(V,K){return this.clone().$set(V,K)},H.get=function(V){return this[A.p(V)]()},H.add=function(V,K){var j,te=this;V=Number(V);var ce=A.p(K),R=function(Q){var q=E(te);return A.w(q.date(q.date()+Math.round(Q*V)),te)};if(ce===_)return this.set(_,this.$M+V);if(ce===g)return this.set(g,this.$y+V);if(ce===h)return R(1);if(ce===m)return R(7);var O=(j={},j[c]=r,j[u]=i,j[o]=n,j)[ce]||1,U=this.$d.getTime()+V*O;return A.w(U,this)},H.subtract=function(V,K){return this.add(-1*V,K)},H.format=function(V){var K=this,j=this.$locale();if(!this.isValid())return j.invalidDate||y;var te=V||"YYYY-MM-DDTHH:mm:ssZ",ce=A.z(this),R=this.$H,O=this.$m,U=this.$M,Q=j.weekdays,q=j.months,$=j.meridiem,de=function(ie,Ne,X,xe){return ie&&(ie[Ne]||ie(K,te))||X[Ne].slice(0,xe)},ae=function(ie){return A.s(R%12||12,ie,"0")},_e=$||function(ie,Ne,X){var xe=ie<12?"AM":"PM";return X?xe.toLowerCase():xe};return te.replace(v,(function(ie,Ne){return Ne||(function(X){switch(X){case"YY":return String(K.$y).slice(-2);case"YYYY":return A.s(K.$y,4,"0");case"M":return U+1;case"MM":return A.s(U+1,2,"0");case"MMM":return de(j.monthsShort,U,q,3);case"MMMM":return de(q,U);case"D":return K.$D;case"DD":return A.s(K.$D,2,"0");case"d":return String(K.$W);case"dd":return de(j.weekdaysMin,K.$W,Q,2);case"ddd":return de(j.weekdaysShort,K.$W,Q,3);case"dddd":return Q[K.$W];case"H":return String(R);case"HH":return A.s(R,2,"0");case"h":return ae(1);case"hh":return ae(2);case"a":return _e(R,O,!0);case"A":return _e(R,O,!1);case"m":return String(O);case"mm":return A.s(O,2,"0");case"s":return String(K.$s);case"ss":return A.s(K.$s,2,"0");case"SSS":return A.s(K.$ms,3,"0");case"Z":return ce}return null})(ie)||ce.replace(":","")}))},H.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},H.diff=function(V,K,j){var te,ce=this,R=A.p(K),O=E(V),U=(O.utcOffset()-this.utcOffset())*r,Q=this-O,q=function(){return A.m(ce,O)};switch(R){case g:te=q()/12;break;case _:te=q();break;case p:te=q()/3;break;case m:te=(Q-U)/6048e5;break;case h:te=(Q-U)/864e5;break;case u:te=Q/i;break;case c:te=Q/r;break;case o:te=Q/n;break;default:te=Q}return j?te:A.a(te)},H.daysInMonth=function(){return this.endOf(_).$D},H.$locale=function(){return F[this.$L]},H.locale=function(V,K){if(!V)return this.$L;var j=this.clone(),te=I(V,K,!0);return te&&(j.$L=te),j},H.clone=function(){return A.w(this.$d,this)},H.toDate=function(){return new Date(this.valueOf())},H.toJSON=function(){return this.isValid()?this.toISOString():null},H.toISOString=function(){return this.$d.toISOString()},H.toString=function(){return this.$d.toUTCString()},J})(),ee=Y.prototype;return E.prototype=ee,[["$ms",a],["$s",o],["$m",c],["$H",u],["$W",h],["$M",_],["$y",g],["$D",C]].forEach((function(J){ee[J[1]]=function(H){return this.$g(H,J[0],J[1])}})),E.extend=function(J,H){return J.$i||(J(H,Y,E),J.$i=!0),E},E.locale=I,E.isDayjs=B,E.unix=function(J){return E(1e3*J)},E.en=F[P],E.Ls=F,E.p={},E}))})(fp)),fp.exports}var BP=UP();const hd=F2(BP);var gn=(t=>(t.Pending="",t.Completed="",t.Cancelled="",t))(gn||{}),ga=(t=>(t.Installation="",t.AS="A/S",t.Change="",t.Move="",t.Etc="",t))(ga||{});const Nb=[{code:"020",name:"",template:"[$1]",kkoMsgId:"KKO020_003",refCode:"WK"},{code:"021",name:"",template:"[$1]      .",kkoMsgId:"KKO021_001",refCode:"WK"},{code:"027",name:"",template:"[$1]  [$2]    .()",kkoMsgId:"KKO027_001",refCode:"WK"},{code:"028",name:"",template:"[$1]  [$2]    [$3]   .",kkoMsgId:"KKO028_001",refCode:"WK"},{code:"138",name:"",template:"[$1] .   .",kkoMsgId:"KKO138_003",refCode:"AS"},{code:"139",name:"",template:"[$1]AS    . :$2",kkoMsgId:"KKO139_001",refCode:"AS"},{code:"141",name:"",template:"[$1][$2]",kkoMsgId:"KKO141_001",refCode:"AS"},{code:"059_002",name:"KB",template:"[$1][$2]",kkoMsgId:"KKO059_002",refCode:"WK"},{code:"059",name:"URL",template:"[$1][$2]",kkoMsgId:"KKO059_001",refCode:"WK"},{code:"271",name:"",template:"[]  1644-1100 . .",kkoMsgId:"KKO271_001",refCode:"AS"},{code:"235",name:"()",template:"[$1] [$2]",kkoMsgId:"KKO059_002",refCode:"WK"},{code:"059_005",name:"()SE",template:"[$1] [$2]",kkoMsgId:"KKO059_002",refCode:"WK"}],Z2=({customer:t,className:e=""})=>{if(!t.isVip)return null;const r=(()=>{switch(t.vipLevel){case"VVIP":return{bgColor:"bg-gradient-to-r from-yellow-400 to-yellow-500",textColor:"text-yellow-900",borderColor:"border-yellow-300",shadow:"shadow-yellow-200",label:"VVIP"};case"VIP":default:return{bgColor:"bg-gradient-to-r from-purple-400 to-purple-500",textColor:"text-purple-900",borderColor:"border-purple-300",shadow:"shadow-purple-200",label:"VIP"}}})();return s.jsxs("div",{className:`
        inline-flex items-center px-2 py-1 rounded-full text-xs font-bold
        ${r.bgColor} ${r.textColor} ${r.borderColor}
        border shadow-sm ${r.shadow}
        ${e}
      `,children:[s.jsx(yL,{className:"w-3 h-3 mr-1"}),r.label]})},GP=t=>{try{const e=new Date(t);if(isNaN(e.getTime()))return"  ";const n=e.getMonth()+1,r=e.getDate();return`${n} ${r}`}catch{return"  "}},Up=t=>{try{const e=new Date(t);if(isNaN(e.getTime()))return"  ";const n=e.getMonth()+1,r=e.getDate();let i=e.getHours();const a=i>=12?"":"";i=i%12||12;const o=e.getMinutes().toString().padStart(2,"0");return`${n} ${r} ${a} ${i}:${o}`}catch{return"  "}},Xi=t=>{if(!t)return"-";const e=String(t).replace(/\D/g,"");return e.length!==10?String(t):`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`},WP=({direction:t,onSelect:e,onSms:n,onWorkerAdjust:r,workStatusCounts:i,index:a})=>{const o=i||{pending:1,completed:0,cancelled:0},c=()=>{const _=o.pendingByProdGrp||{},p=o.completedByProdGrp||{},g={};[...Object.keys(_),...Object.keys(p)].forEach(S=>{g[S]=(_[S]||0)+(p[S]||0)});const C=["D","I","V","C"],y=[];return C.forEach(S=>{g[S]&&g[S]>0&&y.push(`${S}_${g[S]}`)}),Object.keys(g).forEach(S=>{!C.includes(S)&&g[S]>0&&y.push(`${S}_${g[S]}`)}),y.join(" / ")},u=()=>{const _=c();return{statusBadges:s.jsxs("div",{className:"flex items-center gap-1",children:[o.pending>0&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-amber-50 text-amber-700 border border-amber-200",children:[" ",o.pending]}),o.completed>0&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200",children:[" ",o.completed]}),o.cancelled>0&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-rose-50 text-rose-700 border border-rose-200",children:[" ",o.cancelled]})]}),serviceBadge:_?s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200",children:_}):null}},h=_=>{_.stopPropagation(),t.customer.phone&&(window.location.href=`tel:${t.customer.phone}`)},m=_=>{_.stopPropagation(),n&&n(t)};return s.jsx("div",{onClick:()=>e(t),className:"bg-white rounded-xl shadow-sm hover:shadow-md border border-gray-100 transition-all duration-200 cursor-pointer active:scale-[0.99] mb-3 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"p-4",children:[(()=>{const{statusBadges:_,serviceBadge:p}=u();return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a!==void 0&&s.jsx("div",{className:"flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full bg-blue-500 text-white text-sm font-bold",children:a}),s.jsxs("h3",{className:"font-bold text-gray-900 text-base truncate",children:[t.customer.name,t.customer.id&&s.jsxs("span",{className:"font-normal ml-1",children:["(",t.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200 flex-shrink-0",children:t.typeDisplay}),t.WRK_CD==="04"&&t.WRK_DTL_TCD==="0440"&&s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-50 text-amber-700 border border-amber-200 flex-shrink-0",children:""})]}),s.jsx("div",{className:"flex-shrink-0",children:_})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-sm text-gray-600",children:Up(t.scheduledAt)}),s.jsx(Z2,{customer:t.customer})]}),s.jsx("div",{className:"flex-shrink-0",children:p})]})]})})(),s.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[s.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:t.customer.address||"  "})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("button",{onClick:h,className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),""]}),n&&s.jsxs("button",{onClick:m,className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),""]}),r&&s.jsxs("button",{onClick:_=>{_.stopPropagation(),r(t)},className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"whitespace-nowrap",children:""})]})]})]})})},Sb=t=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),dE=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),uE=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),vb=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})}),Eb=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})}),cu=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),FP=t=>[{id:`${t}_1`,directionId:t,type:ga.AS,typeDisplay:"A/S ",status:gn.Completed,scheduledAt:"2025-09-30T14:00:00",customer:{id:"1001857578",name:"",phone:"01044586687",address:"   261 17"},details:"   ",assignedEquipment:[],productName:"ISP  ",cellNo:"-",installLocation:""},{id:`${t}_2`,directionId:t,type:ga.AS,typeDisplay:"A/S ",status:gn.Pending,scheduledAt:"2025-09-30T14:30:00",customer:{id:"1001857578",name:"",phone:"01044586687",address:"   261 17"},details:"  ",assignedEquipment:[],productName:"ISP ",cellNo:"C001",installLocation:""},{id:`${t}_3`,directionId:t,type:ga.AS,typeDisplay:"A/S ",status:gn.Pending,scheduledAt:"2025-09-30T15:00:00",customer:{id:"1001857578",name:"",phone:"01044586687",address:"   261 17"},details:"  ",assignedEquipment:[],productName:"ISP  ",cellNo:"C002",installLocation:""}],zC=async t=>{console.log("[LGU API] getUplsCtrtInfo params:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsCtrtInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[LGU API] getUplsCtrtInfo HTTP error:",e.status),null;const n=await e.json();return console.log("[LGU API] getUplsCtrtInfo response:",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n?[n]:null}catch(e){return console.error("[LGU API] getUplsCtrtInfo error:",e),null}},hE=async t=>{console.log("[L2 API] getUplsNwcs params:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsNwcs`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[L2 API] getUplsNwcs HTTP error:",e.status),null;const n=await e.json();return console.log("[L2 API] getUplsNwcs response:",n),Array.isArray(n)&&n.length>0?n[0]:n&&typeof n=="object"?n:null}catch(e){return console.error("[L2 API] getUplsNwcs error:",e),null}},fE=async t=>{console.log("[L2 API] getUplsEntrEqipDtl params:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsEntrEqipDtl`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[L2 API] getUplsEntrEqipDtl HTTP error:",e.status),null;const n=await e.json();return console.log("[L2 API] getUplsEntrEqipDtl response:",n),n}catch(e){return console.error("[L2 API] getUplsEntrEqipDtl error:",e),null}},KP=async t=>{if(console.log("[ API] setCertifyCL04 params:",t),qn())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"   "};try{const e=await fetch(`${Ns}/customer/etc/setCertifyCL04`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CMD:"CL-04",...t})});if(!e.ok)return console.error("[ API] setCertifyCL04 HTTP error:",e.status),{code:"ERROR",message:`HTTP error: ${e.status}`};const n=await e.json();return console.log("[ API] setCertifyCL04 response:",n),{code:n.code||n.RESULT_CODE||"SUCCESS",message:n.message||n.RESULT_MSG||"   "}}catch(e){return console.error("[ API] setCertifyCL04 error:",e),{code:"ERROR",message:String(e)}}},Bp=async t=>{console.log("[Certify API] setCertifyCL06 params:",t);try{const e=await fetch(`${Ns}/customer/etc/setCertifyCL06`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,CONT_ID:t.CTRT_ID})});if(!e.ok)return console.error("[Certify API] setCertifyCL06 HTTP error:",e.status),{ERROR:`HTTP ${e.status}`};const n=await e.json();return console.log("[Certify API] setCertifyCL06 response:",n),n.data?n.data:n}catch(e){return console.error("[Certify API] setCertifyCL06 error:",e),{ERROR:String(e)}}},$g=async t=>{console.log("[Certify API] getCertifyCL08 params:",t);try{const e=await fetch(`${Ns}/customer/etc/getCertifyCL08`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,CONT_ID:t.CTRT_ID})});if(!e.ok)return console.error("[Certify API] getCertifyCL08 HTTP error:",e.status),{ERROR:`HTTP ${e.status}`};const n=await e.json();return console.log("[Certify API] getCertifyCL08 response:",n),n.data?n.data:n}catch(e){return console.error("[Certify API] getCertifyCL08 error:",e),{ERROR:String(e)}}},N1=async()=>{var t;if(console.log("[FTTH API] getCertifyProdMap "),qn())return await new Promise(e=>setTimeout(e,300)),["PD10007399","PD10007400"];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/customer/work/getCertifyProdMap`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify({})});if(!n.ok)return console.error("[FTTH API] getCertifyProdMap HTTP error:",n.status),[];const r=await n.json();console.log("[FTTH API] getCertifyProdMap response:",r);const i=((t=r.output)==null?void 0:t.output)||r.output;if(i&&Array.isArray(i)){const a=i.map(o=>o.PROD_CD).filter(Boolean);return console.log("[FTTH API] FTTH   :",a.length,""),a}if(Array.isArray(r)){const a=r.map(o=>o.PROD_CD).filter(Boolean);return console.log("[FTTH API] FTTH   :",a.length,""),a}return[]}catch(e){return console.error("[FTTH API] getCertifyProdMap error:",e),[]}},eN=async t=>{console.log("[Certify API] getUplsLdapRslt CTRT_ID:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsLdapRslt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CTRT_ID:t})});if(!e.ok)return console.error("[Certify API] getUplsLdapRslt HTTP error:",e.status),{exists:!1,data:[]};const n=await e.json();console.log("[Certify API] getUplsLdapRslt response:",n);const r=n.output||n.data||[];return{exists:(n.rowcount||r.length||0)>0,data:Array.isArray(r)?r:[]}}catch(e){return console.error("[Certify API] getUplsLdapRslt error:",e),{exists:!1,data:[]}}},QP=async t=>{try{const e=await fetch(`${Ns}/customer/etc/getCertifyApiHist`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return e.ok?(await e.json()).output||[]:[]}catch(e){return console.error("[Signal API] getCertifyApiHist error:",e),[]}},YP=async t=>{if(qn())return await new Promise(e=>setTimeout(e,1e3)),[{CONSREQNO:"20240101001",CTRT_ID:"CTRT001",CONSCHRRNM:"",CONSCHRRTLNO:"010-1234-5678",CONSCHRRMAKRMKS:"LGU+   ",CONSFNSHSCDLDT:"20240115",CONSFNSHDT:"20240114",CONSNEEDDIVSNM:"",CONSDLYRSNNM:"",CONSIPSBPRSSDT:"",CONSIPSBRSNNM:"",CONSNREQPRSSDT:"",CONSNREQRSNNM:"",ENTR_NO:"500030621784",ENTR_RQST_NO:"300241327941",MSTR_FL:"Y",SBGNEGNRNM:"LGU+"},{CONSREQNO:"20240102002",CTRT_ID:"CTRT002",CONSCHRRNM:"",CONSCHRRTLNO:"010-2345-6789",CONSCHRRMAKRMKS:"  ",CONSFNSHSCDLDT:"20240120",CONSFNSHDT:"",CONSNEEDDIVSNM:"",CONSDLYRSNNM:" ",CONSIPSBPRSSDT:"",CONSIPSBRSNNM:"",CONSNREQPRSSDT:"",CONSNREQRSNNM:"",ENTR_NO:"500030621785",ENTR_RQST_NO:"300241327942",MSTR_FL:"Y",SBGNEGNRNM:"LGU+"}];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/customer/etc/getUplsRqstConsList`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)});if(!n.ok)throw new Error(`LGU    : ${n.status}`);return await n.json()}catch(e){throw console.error("LGU    :",e),e}},VP=async t=>{console.log("[LGU API] uplsEntrBgnEstbChg params:",t);try{const e=await fetch(`${Ns}/customer/receipt/uplsEntrBgnEstbChg`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[LGU API] uplsEntrBgnEstbChg HTTP error:",e.status),{RESULT_CD:"N",RESULT_MSG:`HTTP error: ${e.status}`};const n=await e.json();return console.log("[LGU API] uplsEntrBgnEstbChg response:",n),{RESULT_CD:n.RESULT_CD||"N",RESULT_MSG:n.RESULT_MSG||"",ENTR_NO:n.ENTR_NO||"",ENTR_RQST_NO:n.ENTR_RQST_NO||"",ENTR_CNTRT_NO:n.ENTR_CNTRT_NO||"",SVC_CD:n.SVC_CD||"",UPLS_PROD_YN:n.UPLS_PROD_YN||"",RQST_DV_CD:n.RQST_DV_CD||"",NET_TYP:n.NET_TYP||""}}catch(e){return console.error("[LGU API] uplsEntrBgnEstbChg error:",e),{RESULT_CD:"N",RESULT_MSG:String(e)}}},mE=async t=>{console.log("[LGU API] reqUplsHspdLdap params:",t);try{const e=await fetch(`${Ns}/lgu/construction-request`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw console.error("[LGU API] reqUplsHspdLdap HTTP error:",e.status),new Error(`LDAP request failed: ${e.status}`);const n=await e.json();return console.log("[LGU API] reqUplsHspdLdap response:",n),n}catch(e){throw console.error("[LGU API] reqUplsHspdLdap error:",e),e}},$P=async t=>{console.log("[LGU API] getUplsDuplicationMember params:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsDuplicationMember`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return{success:!1,ENTR_EXIST:"N",RESULT_CD:"N",RESULT_MSG:`HTTP error: ${e.status}`};const n=await e.json();console.log("[LGU API] getUplsDuplicationMember response:",n);const r=Array.isArray(n)?n[0]:n,i=(r==null?void 0:r.RESULT_CD)||"";return i.startsWith("N")?{success:!1,ENTR_EXIST:"N",RESULT_CD:i,RESULT_MSG:(r==null?void 0:r.RESULT_MSG)||""}:{success:!0,ENTR_EXIST:(r==null?void 0:r.ENTR_EXIST)||"N",RESULT_CD:i,RESULT_MSG:(r==null?void 0:r.RESULT_MSG)||""}}catch(e){return console.error("[LGU API] getUplsDuplicationMember error:",e),{success:!1,ENTR_EXIST:"N",RESULT_CD:"N",RESULT_MSG:String(e)}}},vM=async t=>{console.log("[LGU API] getUplsEqipInfo params:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsEqipInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return[];const n=await e.json();return console.log("[LGU API] getUplsEqipInfo response:",n),Array.isArray(n)?n:n.output&&Array.isArray(n.output)?n.output:n?[n]:[]}catch(e){return console.error("[LGU API] getUplsEqipInfo error:",e),[]}},HC=async t=>{console.log("[LGU API] getUplsEqipPortInfo params:",t);try{const e=await fetch(`${Ns}/customer/etc/getUplsEqipPortInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return[];const n=await e.json();return console.log("[LGU API] getUplsEqipPortInfo response:",n),Array.isArray(n)?n:n.output&&Array.isArray(n.output)?n.output:n?[n]:[]}catch(e){return console.error("[LGU API] getUplsEqipPortInfo error:",e),[]}},zP=async t=>{console.log("[LGU API] setUplsRqstConsReq params:",t);try{const e=await fetch(`${Ns}/customer/etc/setUplsRqstConsReq`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw new Error(`Port : ${e.status}`);const n=await e.json();return console.log("[LGU API] setUplsRqstConsReq response:",n),n}catch(e){throw console.error("[LGU API] setUplsRqstConsReq error:",e),e}},EM=async t=>{if(qn())return await new Promise(e=>setTimeout(e,1500)),[{code:"SUCCESS",message:"LGU    ()",CANCEL_ID:"FAULT"+Date.now(),STATUS:""}];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/lgu/network-fault`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)});if(!n.ok)throw new Error(`LGU   : ${n.status}`);return await n.json()}catch(e){throw console.error("LGU   :",e),e}};class Qs extends Error{constructor(e,n,r){super(e),this.name="NetworkError",this.statusCode=n,this.details=r}}class HP{constructor(){this.states=new Map,this.failureThreshold=5,this.openDuration=3e4,this.halfOpenDuration=1e4}getState(e){return this.states.has(e)||this.states.set(e,{failureCount:0,lastFailureTime:0,state:"CLOSED"}),this.states.get(e)}canRequest(e){const n=this.getState(e),r=Date.now();return n.state==="CLOSED"?!0:n.state==="OPEN"?r-n.lastFailureTime>=this.openDuration?(console.log(`[Circuit Breaker] ${e} - OPEN  HALF_OPEN ( )`),n.state="HALF_OPEN",!0):(console.warn(` Circuit Breaker: ${e} -   (${Math.round((this.openDuration-(r-n.lastFailureTime))/1e3)}   )`),!1):n.state==="HALF_OPEN"}recordSuccess(e){const n=this.getState(e);n.state==="HALF_OPEN"&&console.log(`[Circuit Breaker] ${e} - HALF_OPEN  CLOSED ()`),n.failureCount=0,n.state="CLOSED"}recordFailure(e){const n=this.getState(e);n.failureCount++,n.lastFailureTime=Date.now(),n.failureCount>=this.failureThreshold?(n.state!=="OPEN"&&console.error(` Circuit Breaker: ${e} - CLOSED  OPEN (${this.failureThreshold}  , ${this.openDuration/1e3}  )`),n.state="OPEN"):n.state==="HALF_OPEN"&&(console.warn(`[Circuit Breaker] ${e} - HALF_OPEN  OPEN ( )`),n.state="OPEN")}reset(){this.states.clear()}}class qP{constructor(){this.pendingRequests=new Map,this.maxAge=5e3}getOrCreate(e,n){this.cleanup();const r=this.pendingRequests.get(e);if(r)return console.log(`[Request Dedup]   : ${e} (  )`),r.promise;const i=n();return this.pendingRequests.set(e,{promise:i,timestamp:Date.now()}),i.finally(()=>{this.pendingRequests.delete(e)}),i}cleanup(){const e=Date.now();for(const[n,r]of this.pendingRequests.entries())e-r.timestamp>this.maxAge&&this.pendingRequests.delete(n)}reset(){this.pendingRequests.clear()}}const bu=new HP,DM=new qP;typeof window<"u"&&(window.resetCircuitBreaker=()=>{bu.reset(),DM.reset(),console.log("[API ] Circuit Breaker  Request Deduplicator ")});const gE=(t,e=" .")=>{switch(t){case 400:return" .   .";case 401:return" .";case 403:return"  .";case 404:return"    .";case 408:return"  .  .";case 429:return"   .    .";case 500:return"  .    .";case 502:case 503:return"   .    .";case 504:return"   .  .";default:return e}},ar=async(t,e,n=3,r=3e4)=>{if(!bu.canRequest(t))throw new Qs("  .    .",503);if(!(e.method==="GET"||!e.method))return a();return DM.getOrCreate(t,a);async function a(){let o=null;for(let c=0;c<n;c++)try{const u=new AbortController,h=setTimeout(()=>u.abort(),r),m=await fetch(t,{...e,signal:u.signal});if(clearTimeout(h),m.ok)return bu.recordSuccess(t),m;if(m.status>=400&&m.status<500)throw bu.recordFailure(t),new Qs(gE(m.status),m.status);if(m.status>=500){bu.recordFailure(t);let _=gE(m.status);try{const p=await m.json();p&&p.message&&(_=p.message)}catch{}throw new Qs(_,m.status)}return m}catch(u){if(o=u,u.name==="AbortError"){if(console.error(`API  ( ${c+1}/${n}):`,t),bu.recordFailure(t),c===n-1)throw new Qs("  .  .",408)}else if(u instanceof TypeError&&u.message.includes("fetch")){if(console.error(`  ( ${c+1}/${n}):`,u),bu.recordFailure(t),c===n-1)throw new Qs("  .",void 0,u)}else if(u instanceof Qs){if(u.statusCode&&u.statusCode>=400&&u.statusCode<500||c===n-1)throw u}else if(console.error(`API   ( ${c+1}/${n}):`,u),bu.recordFailure(t),c===n-1)throw new Qs(u.message||"    .");if(c<n-1){const h=Math.min(1e3*Math.pow(2,c),5e3);console.log(`${h}ms  ...`),await new Promise(m=>setTimeout(m,h))}}throw o||new Qs("    .")}},XP=(t,e)=>{const n=["","","","","","","",""],r=[{type:ga.AS,display:"A/S"},{type:ga.Installation,display:""},{type:ga.Move,display:""},{type:ga.Change,display:""},{type:ga.Etc,display:""}],i=[gn.Pending,gn.Completed,gn.Cancelled],a=["   15 1","   123 5","   456 12","   789 3","   321 8","   654 2","   987 15","   147 7"];return n.map((c,u)=>{const h=r[u%r.length],m=i[u%i.length],_=9+u%8,p=u%4*15;return{id:`WRK${String(u+1).padStart(3,"0")}`,type:h.type,typeDisplay:h.display,status:m,scheduledAt:`2025-09-30T${String(_).padStart(2,"0")}:${String(p).padStart(2,"0")}:00`,customer:{id:`CUST${String(u+1).padStart(3,"0")}`,name:c,phone:`010-${String(Math.floor(Math.random()*9e3)+1e3)}-${String(Math.floor(Math.random()*9e3)+1e3)}`,address:a[u%a.length]},details:`${h.display}  `,assignedEquipment:[],directionId:`WRK${String(u+1).padStart(3,"0")}`}})},_E=async(t,e,n="N")=>{const r=typeof window<"u"?window.location.origin:"http://localhost:3000";try{return await(await ar(`${Ns}/login`,{method:"POST",headers:{"Content-Type":"application/json",Origin:r},credentials:"include",body:JSON.stringify({USR_ID:t,USR_PWD:e,DISCONN_YN:n})},1)).json()}catch(i){throw console.error(" API  :",i),i instanceof Qs?i:new Qs("   .  .")}},qn=()=>typeof window<"u"&&localStorage.getItem("demoMode")==="true",JP=()=>[{INSP_ID:"INSP001",SO_ID:"209",CRR_ID:"01",INSP_END_DT:"20251015",STTL_YN:"Y",CUST_ID:"CUST001",CUST_NM:"",TEL_NO:"010-1234-5678",PASS_YN:"Y",PROD_GRP_NM:"+TV"},{INSP_ID:"INSP002",SO_ID:"209",CRR_ID:"01",INSP_END_DT:"20251014",STTL_YN:"N",CUST_ID:"CUST002",CUST_NM:"",TEL_NO:"010-2345-6789",PASS_YN:"N",FAIL_GRADE:"B",DAPPR_RESN:" ",PROD_GRP_NM:""},{INSP_ID:"INSP003",SO_ID:"209",CRR_ID:"01",INSP_END_DT:"20251013",STTL_YN:"Y",CUST_ID:"CUST003",CUST_NM:"",TEL_NO:"010-3456-7890",PASS_YN:"Y",PROD_GRP_NM:"+TV+"}],ZP=()=>[{WRK_DRCTN_ID:"WRK001",WRK_ID:"1008409324",CUST_ID:"CUST001",CUST_NM:"",SO_ID:"209",SO_NM:"",CRR_ID:"01",CRR_NM:"LG",PROD_CD:"PROD001",PROD_NM:" 100M",WRK_CD:"02",WRK_CD_NM:"A/S",WRK_STAT_CD:"4",WRK_STAT_NM:"",SIGNAL_RESULT:"",SIGNAL_DATE:"2025-10-16 15:30"},{WRK_DRCTN_ID:"WRK002",WRK_ID:"1008409325",CUST_ID:"CUST002",CUST_NM:"",SO_ID:"209",SO_NM:"",CRR_ID:"01",CRR_NM:"LG",PROD_CD:"PROD002",PROD_NM:" 500M + TV",WRK_CD:"01",WRK_CD_NM:"",WRK_STAT_CD:"2",WRK_STAT_NM:"",SIGNAL_RESULT:""},{WRK_DRCTN_ID:"WRK003",WRK_ID:"1008409326",CUST_ID:"CUST003",CUST_NM:"",SO_ID:"209",SO_NM:"",CRR_ID:"01",CRR_NM:"LG",PROD_CD:"PROD003",PROD_NM:" 1G",WRK_CD:"03",WRK_CD_NM:"",WRK_STAT_CD:"1",WRK_STAT_NM:"",SIGNAL_RESULT:""}],eA=(t,e)=>{if(!t&&!e)return null;const n={total:0,pending:0,completed:0,cancelled:0,pendingByProdGrp:{},completedByProdGrp:{}},r={DTV:"D",D:"D",ISP:"I",I:"I",VOIP:"V",VoIP:"V",V:"V",C:"C",:"C",:"C"},i={:"pending",:"pending",:"pending",:"completed",:"completed","()":"completed",:"cancelled"};if(e){const a=e.split(/\s*\/\s*/).filter(o=>o.trim());n.total=a.length,a.forEach(o=>{const c=o.trim();let u=i[c];u||(c.includes("")?u="cancelled":c.includes("")&&!c.includes("")||c.includes("")&&c.includes("")?u="completed":u="pending",console.log("[parseWorkStatusFromStrings] :",c,"->",u)),n[u]++})}if(t){const a=t.split(/\s*\/\s*/).filter(o=>o.trim());n.total===0&&(n.total=a.length,n.pending=a.length),a.forEach(o=>{const c=o.trim().toUpperCase(),u=r[c]||c.charAt(0);n.pendingByProdGrp[u]=(n.pendingByProdGrp[u]||0)+1})}return n},qC=async t=>{if(qn())return FP(t);try{const n=typeof window<"u"?window.location.origin:"http://localhost:3000";return await(await ar(`${Ns}/work/receipts`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify({WRK_DRCTN_ID:t})})).json()}catch(n){throw n instanceof Qs?n:new Qs("   .")}},tN=async t=>{if(typeof window<"u"&&localStorage.getItem("demoMode")==="true")return await new Promise(n=>setTimeout(n,1e3)),{code:"SUCCESS",message:"   ()"};try{const n=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await fetch(`${Ns}/work/cancel`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify(t)});if(!r.ok)throw new Error(` : ${r.status}`);return await r.json()}catch(n){throw console.error(" API  :",n),n}},S1=async t=>{if(console.log("[] API :",t),qn())return await new Promise(e=>setTimeout(e,300)),{WRK_ID:t.WRK_ID,RCPT_ID:t.RCPT_ID||"",CUST_ID:t.CUST_ID||"",CTRT_ID:"CT001",SO_ID:"100",WRK_CD:"01",WRK_CD_NM:"",WRK_STAT_CD:"2",WRK_STAT_CD_NM:"",WRK_RCPT_CL:"",OST_WORKABLE_STAT:"X",HOTBILL_YN:"N"};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/work/getDetailWorkInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[] :",r),Array.isArray(r)&&r.length>0?r[0]:r&&!Array.isArray(r)?r:null}catch(e){throw console.error("[] API :",e),e}},tA=async t=>{if(console.log("[OST] API :",t),qn())return await new Promise(e=>setTimeout(e,300)),{AGENT_FL:"1",BUSI_TYPE:"031",RES_CD:"0BS0000"};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/etc/getOSTInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify({AGENT_FL:t.AGENT_FL||"1",RCPT_ID:t.RCPT_ID,CUST_ID:t.CUST_ID})})).json();return console.log("[OST] :",r),Array.isArray(r)&&r.length>0?r[0]:r&&!Array.isArray(r)?r:null}catch(e){return console.error("[OST] API :",e),null}},sA=async t=>{if(console.log("[OST] API :",t),qn())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:" ."};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/etc/modOstWorkCancel`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[OST] :",r),r.MESSAGE==="SUCCESS"||r.code==="SUCCESS"?{code:"SUCCESS",message:" .",RCPT_ID:r.RCPT_ID}:{code:r.code||"ERROR",message:r.message||r.MESSAGE||"  "}}catch(e){throw console.error("[OST] API :",e),new Qs(e.message||"OST     .")}},Ns=typeof window<"u"?(()=>{const t=window.location.hostname,e=window.location.protocol;return console.log("[ API]  :",{hostname:t,protocol:e}),t==="localhost"||t==="127.0.0.1"?"http://58.143.140.222:8080/api":"/api"})():"/api",nA=t=>{switch(t){case"":return ga.Installation;case"A/S":return ga.AS;case"":return ga.Change;case"":return ga.Move;default:return ga.Etc}},rA=(t,e)=>{if(e){if(e==="4"||e==="7")return gn.Completed;if(e==="3")return gn.Cancelled;if(e==="1"||e==="2")return gn.Pending}switch(t){case"":return gn.Pending;case"":return gn.Completed;case"":return gn.Cancelled;default:return gn.Pending}},iA=async({startDate:t,endDate:e})=>{if(qn())return XP();const r=t.replace(/-/g,""),i=e.replace(/-/g,""),a=typeof window<"u"?localStorage.getItem("userInfo"):null,o=a?JSON.parse(a):{},c={WRKR_ID:o.userId||"",SO_ID:o.soId||"",PROC_CL:"A02",VIEW_TYP:"MOBILE",SCH_HOPEDT_GB:"2",PRT_STAT:"%",WRK_DTL_TCD:"%",HOPE_DT_STRT:r,HOPE_DT_END:i,PDA_WORK_STATUS:"%",EMRG_YN:"",WRK_CD:"",DATE_GBN:""};try{const u=typeof window<"u"?window.location.origin:"http://localhost:3000",m=await(await ar(`${Ns}/work/directions`,{method:"POST",headers:{"Content-Type":"application/json",Origin:u},credentials:"include",body:JSON.stringify(c)},3,6e4)).json();return!Array.isArray(m)||m.length===0?[]:m.map(p=>{const g=p.HOPE_DT,C=p.HOPE_TM,y=new Date(`${g.slice(0,4)}-${g.slice(4,6)}-${g.slice(6,8)}T${C}:00`).toISOString();return{id:p.WRK_DRCTN_ID,type:nA(p.WRK_CD_NM),typeDisplay:p.WRK_CD_NM||"",status:rA(p.WRK_STAT,p.MIN_WRK_STAT_CD||p.WRK_STAT_CD),scheduledAt:y,customer:{id:p.CUST_ID,name:p.NONMASK_CUST_NM||p.CUST_NM,phone:p.CUST_TEL_NO||p.REQ_CUST_TEL_NO||"",address:p.ADDR,isVip:!!(p.VIP_GB&&String(p.VIP_GB).length>0),vipLevel:p.VIP_GB==="VIP_VVIP"?"VVIP":p.VIP_GB?"VIP":void 0},details:p.REQ_CTX,assignedEquipment:[],directionId:p.WRK_DRCTN_ID,installLocation:p.INSTL_LOC||"",WRK_CD:p.WRK_CD,WRK_CD_NM:p.WRK_CD_NM,WRK_DTL_TCD:p.WRK_DTL_TCD,PROD_CD:p.PROD_CD,PROD_NM:p.PROD_NM,PROD_GRP:p.PROD_GRP,CTRT_ID:p.CTRT_ID,CTRT_STAT:p.CTRT_STAT,CTRT_STAT_NM:p.CTRT_STAT_NM,SO_ID:p.SO_ID,SO_NM:p.SO_NM,CRR_ID:p.CRR_ID,CUST_REL:p.CUST_REL||"",UP_CTRL_CL:p.UP_CTRL_CL||"",PSN_USE_CORP:p.PSN_USE_CORP||"",VOIP_USE_CORP:p.VOIP_USE_CORP||"",DTV_USE_CORP:p.DTV_USE_CORP||"",VIEW_MOD_CD:p.VIEW_MOD_CD||"",VIEW_MOD_NM:p.VIEW_MOD_NM||"",VIP_GB:p.VIP_GB||"",PROD_GRPS:p.PROD_GRPS||"",WRK_STATS:p.WRK_STATS||"",OST_WORKABLE_STAT:p.OST_WORKABLE_STAT||""}})}catch(u){throw console.error("API  :",u),u instanceof Qs?u:new Qs("   .")}},Rd=async t=>{if(qn())return null;try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n={PROC_CL:"A02",WRK_DRCTN_ID:t.WRK_DRCTN_ID,WRK_ID:t.WRK_ID||"",SO_ID:t.SO_ID||""};console.log("[getWorkReceiptDetail] Requesting with:",n);const r=await fetch(`${Ns}/work/receipts`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(n)});if(!r.ok)return console.error("[getWorkReceiptDetail] HTTP Error:",r.status),null;const i=await r.json();if(console.log("[getWorkReceiptDetail] Response:",i),Array.isArray(i)&&i.length>0){if(t.WRK_ID){const a=i.find(o=>String(o.WRK_ID)===String(t.WRK_ID));if(a)return console.log("[getWorkReceiptDetail] Found matching WRK_ID:",t.WRK_ID,"MEMO:",a.MEMO,"NET_CL:",a.NET_CL),a;console.log("[getWorkReceiptDetail] WRK_ID not found in response, params.WRK_ID:",t.WRK_ID,"available WRK_IDs:",i.map(o=>o.WRK_ID))}return i[0]}return null}catch(e){return console.error("[getWorkReceiptDetail] Error:",e),null}},aA=async t=>{try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/customer/work/getSafeCheckList_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},body:JSON.stringify(t||{}),credentials:"include"});if(!n.ok)return console.warn(`[SafetyChecklist API] Failed: ${n.status}`),[];const r=await n.json();return r.data&&Array.isArray(r.data)?r.data:Array.isArray(r)?r:[]}catch(e){return console.warn("[SafetyChecklist API] Error:",e),[]}},lA=async t=>{try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/customer/work/saveSafeCheckList_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},body:JSON.stringify({USR_ID:t.USR_ID,IMG_PATHS:t.IMG_PATHS||"",ANS_ITEM_IDS:t.ANS_ITEM_IDS,ANS_VALUES:t.ANS_VALUES}),credentials:"include"});if(!n.ok)return console.warn(`[SafetyChecklist Save API] Failed: ${n.status}`),{code:"ERROR",message:`HTTP ${n.status}`};const r=await n.json();return{code:r.code||"SUCCESS",message:r.message||"Safety checklist saved"}}catch(e){return console.warn("[SafetyChecklist Save API] Error:",e),{code:"ERROR",message:String(e)}}},RM=async t=>{try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/customer/work/getSafeCheckResultInfo_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},body:JSON.stringify({WRKR_ID:t}),credentials:"include"});if(!n.ok)return console.warn(`[SafetyCheckResult API] Failed: ${n.status}`),[];const r=await n.json();return r.code==="SUCCESS"&&r.output?r.output:[]}catch(e){return console.warn("[SafetyCheckResult API] Error:",e),[]}},oA=async t=>{if(qn())return await new Promise(e=>setTimeout(e,500)),JP();try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=new URLSearchParams;n.append("SO_ID",t.SO_ID),n.append("CRR_ID",t.CRR_ID);const r=new Date,i=new Date(r.getFullYear(),r.getMonth()-3,r.getDate()),a=m=>{const _=m.getFullYear(),p=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0");return`${_}${p}${g}`},o=t.INSP_DT_FROM||a(i),c=t.INSP_DT_TO||a(r);n.append("INSP_DT_FROM",o),n.append("INSP_DT_TO",c),t.INSP_ID&&n.append("INSP_ID",t.INSP_ID);const u=await fetch(`${Ns}/work/safety-checks?${n.toString()}`,{method:"GET",headers:{Origin:e},credentials:"include"});return u.ok?await u.json():(console.warn(`[ API]   : ${u.status} -    `),[])}catch(e){return console.warn("[ API]    -   :",e),[]}},cA=async t=>{if(qn())return await new Promise(e=>setTimeout(e,500)),ZP();try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=new URLSearchParams;Object.entries(t).forEach(([a,o])=>{o&&n.append(a,o)});const r=await fetch(`${Ns}/work/result-signals?${n.toString()}`,{method:"GET",headers:{Origin:e},credentials:"include"});return r.ok?await r.json():(console.warn(`[ API]   : ${r.status} -    `),[])}catch(e){return console.warn("[ API]    -   :",e),[]}},Co=async t=>{var n;if(qn())return await new Promise(r=>setTimeout(r,500)),{contractEquipments:[{SVC_CMPS_ID:"SVC001",ITEM_MID_NM:"",EQT_CL_NM:"RS-M100",ITEM_MID_CD:"04"},{SVC_CMPS_ID:"SVC002",ITEM_MID_NM:"",EQT_CL_NM:"DTV-STB100",ITEM_MID_CD:"05"}],technicianEquipments:[{EQT_NO:"EQT001",ITEM_MID_NM:"",EQT_CL_NM:"RS-M100",EQT_SERNO:"RSM100001",ITEM_MID_CD:"04",MAC_ADDRESS:"AA:BB:CC:DD:EE:01"},{EQT_NO:"EQT002",ITEM_MID_NM:"",EQT_CL_NM:"RS-M200",EQT_SERNO:"RSM200001",ITEM_MID_CD:"04",MAC_ADDRESS:"AA:BB:CC:DD:EE:02"},{EQT_NO:"EQT003",ITEM_MID_NM:"",EQT_CL_NM:"DTV-STB100",EQT_SERNO:"DTV100001",ITEM_MID_CD:"05"},{EQT_NO:"EQT004",ITEM_MID_NM:"",EQT_CL_NM:"DTV-STB200",EQT_SERNO:"DTV200001",ITEM_MID_CD:"05"}],customerEquipments:[],removedEquipments:[]};try{const r=typeof window<"u"?window.location.origin:"http://localhost:3000",{WORK_ID:i,...a}=t,o={...a,WRK_ID:t.WRK_ID||i,EQT_SEL:"0",EQT_CL:"ALL"},h=(await(await ar(`${Ns}/customer/work/getCustProdInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:r},credentials:"include",body:JSON.stringify(o)})).text()).replace(/[\x00-\x1f\x7f]/g,g=>g===`
`||g==="\r"||g==="	"?" ":""),m=JSON.parse(h),_=((n=m==null?void 0:m.output1)==null?void 0:n[0])||{},p=o.WRK_CD==="02";return{contractEquipments:(m==null?void 0:m.output2)||[],technicianEquipments:(m==null?void 0:m.output3)||[],customerEquipments:p?[]:(m==null?void 0:m.output4)||[],removedEquipments:p?(m==null?void 0:m.output4)||[]:(m==null?void 0:m.output5)||[],kpiProdGrpCd:_.KPI_PROD_GRP_CD,prodChgGb:_.PROD_CHG_GB,chgKpiProdGrpCd:_.CHG_KPI_PROD_GRP_CD,prodGrp:_.PROD_GRP,upCtrlCl:_.UP_CTRL_CL,prodPromoInfo:(m==null?void 0:m.output1)||[]}}catch(r){throw console.error("[ API]    :",r),r instanceof Qs?r:new Qs("   .")}},c0=async t=>{if(qn())return await new Promise(a=>setTimeout(a,1e3)),{code:"SUCCESS",message:"   ()"};const e=typeof window<"u"?localStorage.getItem("userInfo"):null,n=e?JSON.parse(e):{},r=n.userId||n.id||"",i=t.WRKR_ID||n.userId||"";try{const a=typeof window<"u"?window.location.origin:"http://localhost:3000",o=(F,G,B)=>{const I=(F==null?"":String(F)).trim();return I.length>=G?I.substring(0,G):I+new Array(G-I.length+1).join(B)};let c="",u="",h="",m="",_="",p="",g="",C="",y="",S="",v=0;const k=(t.equipments||[]).filter(F=>String(F.SEL||"1")==="1").map((F,G)=>({eq:F,order:Number(F.EQUIP_SEQ||F.SVC_CMPS_ID||G+1),idx:G})).sort((F,G)=>(F.order||0)-(G.order||0));for(let F=0;F<k.length;F++){const{eq:G,idx:B}=k[F],I=String(G.PROD_GRP||"");c+=I;const E=String(G.PROD_TYP||""),A=String(G.EQUIP_SEQ||G.SVC_CMPS_ID||"");u+=E+A,h+=String(G.PROD_CD||""),m+=String(G.SVC_CD||"");const Y=o(G.ITEM_MID_CD||G.EQT||G.EQT_CD||"",10," ");_+=Y;const ee=o(G.EQT_CL||G.EQT_CL_CD||"",10," ");p+=ee;const J=String(G.LENT||"");g+=J;const H=o(String(G.EQT_USE_STAT_CD||""),1," ");C+=H,y=o(G.EQT_SALE_AMT||0,10," ");const V=o(G.ITLLMT_PRD||"00",2," ");S+=V,v+=1}const L={RCPT_ID:t.RCPT_ID||"",WRK_ID:t.WRK_ID,CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:i,REG_UID:r,PROD_GRPS:c,PROD_CMPS_CLS:u,PROD_CDS:h,SVC_CDS:m,ITEM_MID_CDS:_,EQT_CLS:p,LENTS:g,EQT_USE_STATS:C,EQT_SALE_AMTS:y,ITLLMT_PRDS:S,SERVICE_CNT:String(v),PROM_CNT:t.PROM_CNT||""},M=await fetch(`${Ns}/customer/work/eqtCmpsInfoChg`,{method:"POST",headers:{"Content-Type":"application/json",Origin:a},credentials:"include",body:JSON.stringify({parameters:L})});if(!M.ok){let F=`HTTP ${M.status}: ${M.statusText}`;try{const G=await M.json();F=G.MESSAGE||G.message||F}catch{try{const G=await M.text();G&&(F=G)}catch{}}throw new Qs(F)}return await M.json()}catch(a){throw console.error("[ API]     :",a),a instanceof Qs?a:new Qs("    .")}},dA=async(t,e)=>{if(qn())return await new Promise(n=>setTimeout(n,500)),[{EQT_CD:"05",EQT_CL_CD:"STB001",EQT_CL_NM:"STB-HD"},{EQT_CD:"05",EQT_CL_CD:"STB002",EQT_CL_NM:"STB-UHD"},{EQT_CD:"05",EQT_CL_CD:"STB003",EQT_CL_NM:"STB-4K"},{EQT_CD:"04",EQT_CL_CD:"MDM001",EQT_CL_NM:"DOCSIS 3.0"},{EQT_CD:"04",EQT_CL_CD:"MDM002",EQT_CL_NM:"DOCSIS 3.1"}];try{const n={EQT_SEL:"0",PROD_CD:t,BUGA_EQT_SEL:"Y"};e&&(n.CTRT_ID=e);const r=await fetch(`${Ns}/customer/receipt/contract/getEquipmentNmListOfProd`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();if(Array.isArray(i))return i;throw i.code&&i.message?new Error(i.message||"    "):new Error("    :   ")}catch(n){throw console.error("[ API]     API :",n),n}},uA=async(t,e)=>{if(console.log("[ API]     API :"),console.log("  - PROD_CD:",t),console.log("  - CTRT_ID:",e),qn())return await new Promise(n=>setTimeout(n,500)),{output1:[{ITEM_MID_CDS:"05        10        ",EQT_CLS:"STB001    MDM001    ",LENTS:"1030",EQT_USE_STATS:"11",ITLLMT_PRDS:"0000",EQT_SALE_AMTS:"0         0         "}],output2:[{SEL:"1",PROD_CD:t,SVC_CD:"SVC001",PROD_TYP:"01",PROD_GRP:"V",EQT:"05",EQT_CD:"05",EQT_CL:"STB001",EQT_CL_NM:"STB-HD",ITM_MID_CD:"05",LENT:"10",EQT_USE_STAT_CD:"1",ITLLMT_PRD:"00",LENT_YN:"Y",EQT_SALE_AMT:0,EQUIP_SEQ:"1",EQT_BASIC_YN:"Y",EQT_NM:""},{SEL:"1",PROD_CD:t,SVC_CD:"SVC001",PROD_TYP:"01",PROD_GRP:"V",EQT:"04",EQT_CD:"04",EQT_CL:"MDM001",EQT_CL_NM:"DOCSIS 3.0",ITM_MID_CD:"04",LENT:"30",EQT_USE_STAT_CD:"1",ITLLMT_PRD:"00",LENT_YN:"Y",EQT_SALE_AMT:0,EQUIP_SEQ:"2",EQT_BASIC_YN:"Y",EQT_NM:""}],output3:[]};try{const n={EQT_SEL:"0",PROD_CD:t,BUGA_EQT_SEL:"Y"};e&&(n.CTRT_ID=e),console.log("[ API]  :",n);const r=await fetch(`${Ns}/customer/receipt/contract/getContractEqtList`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();return console.log("[ API] getContractEqtList  :",i),i}catch(n){throw console.error("[ API]     API :",n),n}},po=async t=>{if(console.log("[ API]   API :",t),qn()){await new Promise(n=>setTimeout(n,300));const e={};return t.includes("CMCU027")&&(e.CMCU027=[{COMMON_CD:"10",COMMON_CD_NM:""},{COMMON_CD:"30",COMMON_CD_NM:""},{COMMON_CD:"31",COMMON_CD_NM:""},{COMMON_CD:"60",COMMON_CD_NM:""}]),t.includes("CMEP314")&&(e.CMEP314=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU064")&&(e.CMCU064=[{COMMON_CD:"0",COMMON_CD_NM:""},{COMMON_CD:"1",COMMON_CD_NM:"1"},{COMMON_CD:"2",COMMON_CD_NM:"2"},{COMMON_CD:"3",COMMON_CD_NM:"3"}]),t.includes("CMCU057")&&(e.CMCU057=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU110")&&(e.CMCU110=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU148")&&(e.CMCU148=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""}]),t.includes("CMCU005")&&(e.CMCU005=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""},{COMMON_CD:"3",COMMON_CD_NM:""},{COMMON_CD:"4",COMMON_CD_NM:""},{COMMON_CD:"5",COMMON_CD_NM:""}]),t.includes("CMCT015")&&(e.CMCT015=[{COMMON_CD:"1",COMMON_CD_NM:""},{COMMON_CD:"2",COMMON_CD_NM:""}]),e}try{const e={CODE_IDS:t.join(",")};console.log("[ API]  :",e);const n=await fetch(`${Ns}/common/getCommonCodeList`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const r=await n.json();return console.log("[ API] getCommonCodeList  :",r),r}catch(e){throw console.error("[ API]   API :",e),e}},hA=async t=>{try{const e={P_COMM_GRP_CD:t},n=await fetch(`${Ns}/common/getCommonCodeList`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(e){throw console.error("[ API]    API :",e),e}},qu=async(t,e,n,r,i,a)=>{if(console.log("[STB API]    API "),console.log("[STB API]  :",{regUid:t,ctrtId:e,wrkId:n,msgId:r,stbEqtNo:i,modemEqtNo:a}),qn())return await new Promise(c=>setTimeout(c,800)),{MSGCODE:"SUCCESS",MESSAGE:"STB server connection check completed",O_IFSVC_RESULT:"TRUE0000000001SMR03000000"};try{const u=`${typeof window<"u"?window.location.origin:"http://localhost:3000"}/api/customer/work/checkStbServerConnection`,h={REG_UID:t,CTRT_ID:e,WRK_ID:n,MSG_ID:r,STB_EQT_NO:i,MODEM_EQT_NO:a};console.log("[STB API] API URL:",u),console.log("[STB API]  :",h),console.log("[STB API] fetch  ...");const m=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(console.log("[STB API]  :",m.status,m.statusText),!m.ok){const p=await m.text();throw console.error("[STB API] HTTP  :",p),new Error(`HTTP ${m.status}: ${m.statusText}`)}const _=await m.json();return console.log("[STB API]  :",_),Array.isArray(_)&&_.length>0?(console.log("[STB API]      :",_[0]),_[0]):_}catch(c){throw console.error("[STB API] STB    API :",c),c}},fA=async t=>{if(console.log("  API :",t),qn())return await new Promise(e=>setTimeout(e,1500)),{code:"SUCCESS",message:"   ()",data:{WRK_ID:t.workInfo.WRK_ID,WRK_STAT_CD:"4",CMPL_DT:t.workInfo.WRKR_CMPL_DT}};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000";console.log("    API :",`${Ns}/customer/work/workComplete`);const n=await ar(`${Ns}/customer/work/workComplete`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)},1);console.log("   API  :",n.status,n.statusText);const r=await n.json();return console.log("  API :",r),Array.isArray(r)?(console.log("   -  "),{code:"SUCCESS",message:" .",data:r}):r}catch(e){throw console.error("  API :",e),e instanceof Qs?e:new Qs(e.message||"     .")}},mA=async t=>{if(console.log(" [  ] API :",t),qn())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"  ."};try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000";console.log("     API :",`${Ns}/customer/work/saveInstallInfo`);const n=await ar(`${Ns}/customer/work/saveInstallInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)},1);console.log("    API  :",n.status,n.statusText);const r=await n.json();return console.log("   API :",r),r}catch(e){throw console.error("   API :",e),e instanceof Qs?e:new Qs(e.message||"     .")}},qa=async t=>{if(console.log("[  ] API :",t),qn())return await new Promise(n=>setTimeout(n,300)),{CMCU048:[{code:"1",name:"HFC"},{code:"2",name:"FTTH"},{code:"3",name:"FTTB"}],BLST010:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:""}],BLST014:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:""}],CMCU030:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:"UTP"}],BLST016:[{code:"1",name:""},{code:"2",name:""}],CMCU046:[{code:"1",name:""},{code:"2",name:""},{code:"3",name:""}],CMCU050:[{code:"1",name:"HDMI"},{code:"2",name:"Component"},{code:"3",name:"Composite"}],CMCU051:[{code:"1",name:""},{code:"2",name:""}],CMCU049:[{code:"1",name:""},{code:"2",name:""}]}[t]||[];try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/common/getCommonCodes`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify({CODE_GROUP:t})})).json();return Array.isArray(r)?r.map(i=>({code:i.COMMON_CD||i.code||"",name:i.COMMON_CD_NM||i.name||"",description:i.DESCRIPTION||i.description||"",ref_code:i.REF_CODE||i.ref_code||"",ref_code2:i.REF_CODE2||i.ref_code2||"",ref_code3:i.REF_CODE3||i.ref_code3||"",ref_code8:i.REF_CODE8||i.ref_code8||"",ref_code12:i.REF_CODE12||i.ref_code12||""})):[]}catch{return[]}},xE=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/equipment/getEquipmentOutList`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("    :",r),Array.isArray(r)?r:r.output1||[]}catch(e){throw console.error("    :",e),e instanceof Qs?e:new Qs("    .")}},gA=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/equipment/addCorporationEquipmentQuota`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",r),r}catch(e){throw console.error("   :",e),e instanceof Qs?e:new Qs("   .")}},_A=async(t,e)=>{console.log("[addEquipmentReturnRequest]  :",t);try{if(!t.WRKR_ID||!t.CRR_ID)throw new Qs("  .");if(!t.equipmentList||t.equipmentList.length===0)throw new Qs("  .");const n=typeof window<"u"?window.location.origin:"http://localhost:3000",r=t.equipmentList.length;let i=0,a=[],o=0;for(const c of t.equipmentList){o++,e==null||e(o,r,c.EQT_SERNO||c.EQT_NO);const u={EQT_NO:c.EQT_NO,EQT_SERNO:c.EQT_SERNO||"",RETN_RESN_CD:c.RETN_RESN_CD||"01",ACTION:c.ACTION||"RETURN",WRKR_ID:t.WRKR_ID,CRR_ID:t.CRR_ID,SO_ID:t.SO_ID||"",MST_SO_ID:t.MST_SO_ID||t.SO_ID||"",RETURN_TP:t.RETURN_TP||"2",PROC_STAT:"1",RETN_PSN_ID:t.WRKR_ID};console.log("[addEquipmentReturnRequest]  :",c.EQT_SERNO,u);try{const m=await(await ar(`${Ns}/customer/equipment/addEquipmentReturnRequest`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify(u)})).json();console.log("[addEquipmentReturnRequest]  :",c.EQT_SERNO,m),m&&(m.MSGCODE==="0"||m.MSGCODE==="SUCCESS"||m.success===!0)?i++:a.push(c.EQT_SERNO||c.EQT_NO)}catch(h){console.error("[addEquipmentReturnRequest]  :",c.EQT_SERNO,h),a.push(c.EQT_SERNO||c.EQT_NO)}}if(console.log("[addEquipmentReturnRequest] : ",i,"/ ",a.length),i>0)return{success:!0,MSGCODE:"SUCCESS",message:a.length>0?`${i}  , ${a.length} `:`${i}  .`,data:{successCount:i,failedItems:a}};throw new Qs(` : ${a.join(", ")}`)}catch(n){throw console.error("[addEquipmentReturnRequest]  :",n),n instanceof Qs?n:new Qs(n.message||"  .")}},xA=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/equipment/cmplEqtCustLossIndem`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),r}catch(e){throw console.error("  :",e),e instanceof Qs?e:new Qs("  .")}},pA=async t=>{console.log("[fn:setEquipmentCheckStandby -> req:setEquipmentChkStndByY_ForM] API:",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n=await fetch(`${Ns}/customer/equipment/setEquipmentChkStndByY_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)}),r=await n.json();if(r.debugLogs&&(console.log("[backend debug logs]"),r.debugLogs.forEach(i=>console.log(i))),n.status===400&&r.code==="BUSINESS_RULE_ERROR")throw console.error("business rule error:",r.message),new Error(r.message||"business rule error");if(!n.ok){console.error("equipment status change failed:",r);const i=r.message||r.error||`server error (HTTP ${n.status})`;throw new Error(i)}return console.log("equipment status change success:",r),r}catch(e){throw console.error("equipment status change failed:",e),e instanceof Error?e:new Error("equipment status change failed.")}},im=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/statistics/equipment/getEquipmentHistoryInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();console.log("  :",r);const i=(r==null?void 0:r.data)||r;return Array.isArray(i)?i:[i]}catch(e){throw console.error("  :",e),e instanceof Qs?e:new Qs("  .")}},yA=async t=>{const e=`API_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,n=Date.now(),r={...t,TO_WRKR_ID:t.MV_WRKR_ID,WRKR_ID:t.MV_WRKR_ID};console.log(`[fn:changeEquipmentWorker -> req:changeEqtWrkr_3_ForM] ${e}`),console.log("params:",JSON.stringify(r,null,2));try{const i=`${Ns}/customer/equipment/changeEqtWrkr_3_ForM`,a=new AbortController,o=setTimeout(()=>a.abort(),3e4),c=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r),signal:a.signal});clearTimeout(o);const u=Date.now()-n;console.log(`[${e}] HTTP ${c.status} (${u}ms)`);const h=await c.text();console.log(`[${e}] RAW:`,h);let m;try{m=JSON.parse(h),console.log(`[${e}] PARSED:`,JSON.stringify(m,null,2))}catch{throw console.error(`[${e}] JSON parse failed`),new Error("server response parse failed")}const _=m==null?void 0:m.MSGCODE,p=(m==null?void 0:m.MESSAGE)||(m==null?void 0:m.message)||"";if(_==="SUCCESS")return console.log(`[${e}] SUCCESS (MSGCODE=SUCCESS, ${u}ms)`),m;if(_==="FAIL")throw new Error(p||"Oracle procedure failed (MSGCODE=FAIL)");if(!c.ok){const g=p||(m==null?void 0:m.error)||(m==null?void 0:m.code)||`server error (HTTP ${c.status})`;throw new Error(g)}if(p&&(p.includes("ERROR")||p.includes("FAIL")))throw new Error(p);return console.log(`[${e}] SUCCESS (${u}ms)`),m}catch(i){const a=Date.now()-n;throw console.error(`[${e}] FAILED (${a}ms):`,i.message),i.name==="AbortError"?new Error("Request timeout (30s)."):i instanceof Error?i:new Error("equipment transfer failed.")}},bA=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/work/worker-adjustment`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),r}catch(e){throw console.error("  :",e),e instanceof Qs?e:new Qs("  .")}},mp=async t=>{console.log("[fn:findUserList -> req:getFindUsrList3] API:",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",n={};t.USR_NM&&t.USR_NM.trim()&&(n.USR_NM=t.USR_NM.trim(),n.WRKR_NM=t.USR_NM.trim()),t.USR_ID&&t.USR_ID.trim()&&(n.USR_ID=t.USR_ID.trim(),n.WRKR_ID=t.USR_ID.trim()),t.SO_ID&&(n.SO_ID=t.SO_ID),t.CRR_ID&&(n.CRR_ID=t.CRR_ID),console.log("[findUserList] cleaned params:",n);const i=await(await ar(`${Ns}/system/cm/getFindUsrList3`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(n)})).json();return console.log("findUserList result:",i),Array.isArray(i)?i:i.output1&&Array.isArray(i.output1)?i.output1:i.data&&Array.isArray(i.data)?i.data:[]}catch(e){throw console.error("findUserList failed:",e),e instanceof Qs?e:new Qs("findUserList failed.")}},CA=async(t,e,n)=>{console.log(" [] API :",{custId:t,startDate:e,endDate:n});try{const r=new Date,i=r.toISOString().slice(0,10).replace(/-/g,""),o=new Date(r.getTime()-10080*60*1e3).toISOString().slice(0,10).replace(/-/g,""),c={CUST_ID:t,SMS_PROCESS:"ALL",REG_DATE1:e||o,REG_DATE2:n||i},u=typeof window<"u"?window.location.origin:"http://localhost:3000",m=await(await ar(`${Ns}/customer/sigtrans/getENSSendHist`,{method:"POST",headers:{"Content-Type":"application/json",Origin:u},credentials:"include",body:JSON.stringify(c)})).json();return console.log("  :",m),Array.isArray(m)?m:m.output&&Array.isArray(m.output)?m.output:m.data&&Array.isArray(m.data)?m.data:[]}catch(r){throw console.error("  :",r),r instanceof Qs?r:new Qs("  .")}},NA=async t=>{console.log(" [] API :",{custId:t});try{const e={CUST_ID:t},n=typeof window<"u"?window.location.origin:"http://localhost:3000",i=await(await ar(`${Ns}/customer/negociation/getCustConslHist`,{method:"POST",headers:{"Content-Type":"application/json",Origin:n},credentials:"include",body:JSON.stringify(e)})).json();return console.log("  :",i),Array.isArray(i)?i:i.output&&Array.isArray(i.output)?i.output:i.data&&Array.isArray(i.data)?i.data:[]}catch(e){throw console.error("  :",e),e instanceof Qs?e:new Qs("  .")}},Db=async t=>{console.log(" [] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/work/getEquipLossInfo_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",r),Array.isArray(r)?r:r.output1||[]}catch(e){throw console.error("   :",e),e instanceof Qs?e:new Qs("   .")}},SA=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/work/modEquipLoss_ForM`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),r}catch(e){throw console.error("  :",e),e instanceof Qs?e:new Qs("  .")}},TM=async t=>{console.log("[ ] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/contract/getFullContractInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",r),{contracts:r.contracts||[],billing:r.billing||null,currentContract:r.currentContract||null}}catch(e){throw console.error("   :",e),e instanceof Qs?e:new Qs("  .")}},gm=async t=>{console.log("[] API :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/contract/getContractInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("  :",r),Array.isArray(r)?r:[]}catch(e){throw console.error("  :",e),e instanceof Qs?e:new Qs("  .")}},Rl=async t=>{console.log("[getProdPromotionInfo]  :",t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/customer/work/getProdPromotionInfo`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[getProdPromotionInfo] :",r),Array.isArray(r)?r:(r==null?void 0:r.data)||(r==null?void 0:r.output)||[]}catch(e){return console.error("[getProdPromotionInfo] :",e),[]}},_a=async t=>{console.log(" [] sendSignal :",t.MSG_ID,t);try{const e=typeof window<"u"?window.location.origin:"http://localhost:3000",r=await(await ar(`${Ns}/signal/send`,{method:"POST",headers:{"Content-Type":"application/json",Origin:e},credentials:"include",body:JSON.stringify(t)})).json();return console.log(" [] :",r),r}catch(e){return console.error("[] :",e),{code:"ERROR",message:e.message||"  .",MSG_ID:t.MSG_ID}}},Gp=async t=>{if(console.log("[ API] insertWorkRemoveStat :",t),qn())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"  ()"};try{const e=localStorage.getItem("userInfo"),n=e?JSON.parse(e):{},r=t.REG_UID||n.userId||"A20130708",i={WRK_ID:t.WRK_ID,REMOVE_LINE_TP:t.REMOVE_LINE_TP,REMOVE_GB:t.REMOVE_GB,REMOVE_STAT:t.REMOVE_STAT||"",REG_UID:r};console.log("[ API]  :",i);const o=await(await fetch(`${Ns}/customer/work/insertWorkRemoveStat`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)})).json();return console.log("[ API] :",o),Array.isArray(o)||o.code==="SUCCESS"||o.success===!0?{code:"SUCCESS",message:" ."}:{code:"ERROR",message:o.message||o.msg||"  ."}}catch(e){return console.error("[ API] :",e),{code:"ERROR",message:e.message||"    ."}}},MM=async t=>{if(qn())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"AS  ()"};try{const e=localStorage.getItem("userInfo"),n=e?JSON.parse(e):{},r=t.REG_UID||n.userId||"A20130708",i=t.CRR_ID||n.crrId||"01",a={CUST_ID:t.CUST_ID,RCPT_ID:t.RCPT_ID||"",WRK_DTL_TCD:t.WRK_DTL_TCD,WRK_RCPT_CL:t.WRK_RCPT_CL,WRK_RCPT_CL_DTL:t.WRK_RCPT_CL_DTL,WRK_HOPE_DTTM:t.WRK_HOPE_DTTM,HOPE_DTTM:t.WRK_HOPE_DTTM,MEMO:t.MEMO||"",EMRG_YN:t.EMRG_YN||"N",HOLY_YN:t.HOLY_YN||"N",CRR_ID:i,WRKR_ID:t.WRKR_ID||r,REG_UID:r,WRK_DIV_ID:"",POST_ID:t.POST_ID||"",BLD_ID:t.BLD_ID||"",BLD_CL:t.BLD_CL||"",BLD_NM:t.BLD_NM||"",BUN_CL:t.BUN_CL||"",BUN_NO:t.BUN_NO||"",HO_NM:t.HO_NM||"",APT_DONG_NO:t.APT_DONG_NO||"",APT_HO_CNT:t.APT_HO_CNT||"",ADDR:t.ADDR||"",ADDR_DTL:t.ADDR_DTL||""},c=await(await fetch(`${Ns}/customer/work/modAsPdaReceipt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)})).json();return Array.isArray(c)||c.code==="SUCCESS"||c.success===!0?{code:"SUCCESS",message:"AS ."}:{code:"ERROR",message:c.message||c.msg||"AS ."}}catch(e){return console.error("[AS API] :",e),{code:"ERROR",message:e.message||"AS   ."}}},pE=async(t,e)=>{if(console.log("[Hotbill API] getHotbillSummary :",{custId:t,rcptId:e}),qn())return await new Promise(n=>setTimeout(n,500)),{details:[{BILL_SEQ_NO:"202412001",PROD_GRP:"DTV",SO_ID:"01",CHG_NM:"DTV ",BILL_AMT:15e3,PYM_AMT:15e3,UPYM_AMT:0},{BILL_SEQ_NO:"202412002",PROD_GRP:"ISP",SO_ID:"01",CHG_NM:" ",BILL_AMT:25e3,PYM_AMT:0,UPYM_AMT:25e3}],refund:{TOT_RFND_AMT:5e3,RFND_RSN:" "},totalAmount:4e4,paidAmount:15e3,unpaidAmount:25e3,refundAmount:5e3};try{const n=await fetch(`${Ns}/hotbill/summary`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CUST_ID:t,RCPT_ID:e})});if(!n.ok)throw console.error("[Hotbill API] HTTP :",n.status),new Error(`Hot Bill API   . (HTTP ${n.status})`);const r=n.headers.get("content-type");if(!r||!r.includes("application/json"))throw console.error("[Hotbill API]   :",r),new Error("Hot Bill API   .");const i=await n.json();return console.log("[Hotbill API] getHotbillSummary :",i),{details:Array.isArray(i.details)?i.details.map(a=>({...a,BILL_AMT:Number(a.BILL_AMT)||0,PYM_AMT:Number(a.PYM_AMT)||0,UPYM_AMT:Number(a.UPYM_AMT)||0})):[],refund:i.refund?{...i.refund,TOT_RFND_AMT:Number(i.refund.TOT_RFND_AMT)||0}:null,totalAmount:Number(i.totalAmount)||0,paidAmount:Number(i.paidAmount)||0,unpaidAmount:Number(i.unpaidAmount)||0,refundAmount:Number(i.refundAmount)||0}}catch(n){throw console.error("[Hotbill API] getHotbillSummary :",n),n}},vA=async t=>{if(console.log("[Hotbill API] runHotbillSimulation :",t),qn())return await new Promise(e=>setTimeout(e,300)),{code:"SUCCESS",RCPT_ID:t.RCPT_ID||"1044931550",message:"OK (Demo)",simulatedCount:1};try{const e={CUST_ID:t.CUST_ID,CTRT_ID:t.CTRT_ID,SO_ID:t.SO_ID,HOPE_DT:t.HOPE_DT,CLC_WRK_CL:t.CLC_WRK_CL||"2",RCPT_ID:t.RCPT_ID||"",IS_NEW:t.IS_NEW||"false",PNTY_EXMP_YN:t.PNTY_EXMP_YN||"N"},n=await fetch(`${Ns}/hotbill/simulate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw console.error("[Hotbill API] HTTP :",n.status),new Error(`Hot Bill  API  (HTTP ${n.status})`);const r=await n.json();return console.log("[Hotbill API] runHotbillSimulation :",r),{code:r.code||"ERROR",RCPT_ID:r.RCPT_ID||"",message:r.message||"",simulatedCount:r.simulatedCount||0}}catch(e){throw console.error("[Hotbill API] runHotbillSimulation :",e),e}},yE=async(t,e,n,r,i)=>{if(console.log("[Hotbill API] getHotbillByContract :",{billSeqNo:t,prodGrp:e,soId:n,clcWrkCl:r,rcptId:i}),qn())return await new Promise(a=>setTimeout(a,200)),[{BILL_SEQ_NO:t,PROD_GRP:e,SO_ID:n,CTRT_ID:"0000000001",CLC_WRK_NO:"20241201001",BILL_AMT:2e4}];try{const a=await fetch(`${Ns}/hotbill/byContract`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({BILL_SEQ_NO:t,PROD_GRP:e,SO_ID:n,CLC_WRK_CL:r,RCPT_ID:i})});if(!a.ok)throw console.error("[Hotbill API] HTTP :",a.status),new Error(`Hot Bill   API  (HTTP ${a.status})`);const o=await a.json();return console.log("[Hotbill API] getHotbillByContract :",o),Array.isArray(o)?o.map(c=>({BILL_SEQ_NO:c.BILL_SEQ_NO||"",PROD_GRP:c.PROD_GRP||"",SO_ID:c.SO_ID||"",CTRT_ID:c.CTRT_ID||"",CLC_WRK_NO:c.CLC_WRK_NO||"",BILL_AMT:Number(c.BILL_AMT)||0})):[]}catch(a){throw console.error("[Hotbill API] getHotbillByContract :",a),a}},bE=async(t,e,n)=>{if(console.log("[Hotbill API] getHotbillByCharge :",{billSeqNo:t,clcWrkNo:e,ctrtId:n}),qn())return await new Promise(r=>setTimeout(r,300)),[{CLC_WRK_NO:e,BILL_SEQ_NO:t,CUST_ID:"0000000001",CTRT_ID:n,SORT_SEQ:"1",CHRG_ITEM_NM:"",REQ_YN:"Y",BILL_AMT:15e3},{CLC_WRK_NO:e,BILL_SEQ_NO:t,CUST_ID:"0000000001",CTRT_ID:n,SORT_SEQ:"2",CHRG_ITEM_NM:"",REQ_YN:"N",BILL_AMT:5e3}];try{const i=await(await fetch(`${Ns}/hotbill/byCharge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({BILL_SEQ_NO:t,CLC_WRK_NO:e,CTRT_ID:n})})).json();return console.log("[Hotbill API] getHotbillByCharge :",i),Array.isArray(i)?i.map(a=>({CLC_WRK_NO:a.CLC_WRK_NO||"",BILL_SEQ_NO:a.BILL_SEQ_NO||"",CUST_ID:a.CUST_ID||"",CTRT_ID:a.CTRT_ID||"",SORT_SEQ:a.SORT_SEQ||"0",CHRG_ITEM_NM:a.CHRG_ITEM_NM||"",REQ_YN:a.REQ_YN||"N",BILL_AMT:Number(a.BILL_AMT)||0})):[]}catch(r){throw console.error("[Hotbill API] getHotbillByCharge :",r),r}},EA=async t=>{if(console.log("[SMS API] sendVisitSms :",t),qn())return await new Promise(e=>setTimeout(e,500)),{code:"SUCCESS",message:"  . (Demo)"};try{const e={SMS_EML_TYPE:t.SMS_EML_TYPE,SO_ID:t.SO_ID,USER_SMS:t.USER_SMS.replace(/-/g,"").replace(/\s/g,""),SEND_SMS:t.SEND_SMS.replace(/-/g,"").replace(/\s/g,""),USER_ID:t.USER_ID,USER_NAME:t.USER_NAME,MAP01:t.MAP01,KKO_MSG_ID:t.KKO_MSG_ID,REG_UID:t.REG_UID,TRANS_YN:t.TRANS_YN||"N",SMS_EML_CL:t.SMS_EML_CL||"20"},n=await fetch(`${Ns}/customer/sigtrans/saveENSSendHist`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw console.error("[SMS API] HTTP :",n.status),new Error(`  API  (HTTP ${n.status})`);const r=await n.json();return console.log("[SMS API] sendVisitSms :",r),r.MSGCODE==="SUCCESS"||r.code==="SUCCESS"?{code:"SUCCESS",message:r.MESSAGE||r.message||"  ."}:{code:r.MSGCODE||r.code||"ERROR",message:r.MESSAGE||r.message||"  ."}}catch(e){throw console.error("[SMS API] sendVisitSms :",e),e}},IM=async t=>{console.log("[ API] getMmtSusInfo :",t);try{const e=await fetch(`${Ns}/customer/etc/getMmtSusInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw console.error("[ API] HTTP :",e.status),new Error(`  API  (HTTP ${e.status})`);const n=await e.json();if(console.log("[ API] getMmtSusInfo :",n),n&&(n.SUS_HOPE_DD||n.output)){const r=n.output?n.output[0]:n;return{SUS_HOPE_DD:r.SUS_HOPE_DD||"",MMT_SUS_HOPE_DD:r.MMT_SUS_HOPE_DD||"",VALID_SUS_DAYS:r.VALID_SUS_DAYS||"",MMT_SUS_CD:r.MMT_SUS_CD||"",WRK_DTL_TCD:r.WRK_DTL_TCD||""}}return null}catch(e){throw console.error("[ API] getMmtSusInfo :",e),e}},jM=async t=>{console.log("[ API] modMmtSusInfo :",t);try{const e=await fetch(`${Ns}/customer/etc/modMmtSusInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)throw console.error("[ API] HTTP :",e.status),new Error(`  API  (HTTP ${e.status})`);const n=await e.json();return console.log("[ API] modMmtSusInfo :",n),n.MSGCODE==="SUCCESS"||n.code==="SUCCESS"?{code:"SUCCESS",message:n.MESSAGE||n.message||" ."}:{code:n.MSGCODE||n.code||"ERROR",message:n.MESSAGE||n.message||"  ."}}catch(e){throw console.error("[ API] modMmtSusInfo :",e),e}},OM=async(t,e)=>{console.log("[Contract API] getCtrtDetailInfo:",t,e);try{const n={CTRT_ID:t};e&&(n.CUST_ID=e);const r=await fetch(`${Ns}/customer/contract/getCtrtDetailInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(!r.ok)return console.error("[Contract API] getCtrtDetailInfo HTTP error:",r.status),null;const i=await r.json();return console.log("[Contract API] getCtrtDetailInfo response:",i),i}catch(n){return console.error("[Contract API] getCtrtDetailInfo error:",n),null}},wM=async t=>{console.log("[Work API] getAfterProcInfo:",t);try{const e=await fetch(`${Ns}/customer/work/getAfterProcInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({WRK_DRCTN_ID:t})});if(!e.ok)return console.error("[Work API] getAfterProcInfo HTTP error:",e.status),null;const n=await e.json();return console.log("[Work API] getAfterProcInfo response:",n),n}catch(e){return console.error("[Work API] getAfterProcInfo error:",e),null}},DA=async(t,e)=>{console.log("[Alarm API] getAllAlarmInfo:",{custId:t,wrkDrctnId:e});try{const n=await fetch(`${Ns}/customer/alarm/getAllAlarmInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CUST_ID:t,WRK_DRCTN_ID:e||""})});if(!n.ok)return console.error("[Alarm API] HTTP error:",n.status),{};const r=await n.json();return console.log("[Alarm API] getAllAlarmInfo response:",r),r}catch(n){return console.error("[Alarm API] getAllAlarmInfo error:",n),{}}},x_=async t=>{if(console.log("[ API] getMoveWorkInfo:",t),qn())return await new Promise(e=>setTimeout(e,500)),{MVM_TP:"01",MVM_TP_NM:"",WRK_ID:t.WRK_ID,PROD_NM:"DTV ",HOPE_DTTM:"2024-12-29 10:00",WRK_STAT_NM:"",ADDR_ORD:"   123",WRK_CD:t.WRK_CD};try{const e=await fetch(`${Ns}/customer/work/getMoveWorkInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),null;const n=await e.json();return console.log("[ API] getMoveWorkInfo response:",n),n.data?n.data:Array.isArray(n)&&n.length>0?n[0]:n}catch(e){return console.error("[ API] getMoveWorkInfo error:",e),null}},LM=async t=>{if(console.log("[ API] getMVRemoveEqtInfo:",t),qn())return await new Promise(e=>setTimeout(e,500)),[{CHK:1,CTRT_ID:"CT123456",EQT_CL_NM:"DTV ",LENT_YN_NM:"",EQT_USE_STAT_CD:"",NOTRECEV:"",EQT_LOC_TP_CD:"",EQT_STAT_CD:"",WRKR_NM:"",EQT_SERNO:"STB123456789",MAC_ADDRESS:"AA:BB:CC:DD:EE:FF",ITEM_NM:"UHD ",WRK_CD:"08"},{CHK:1,CTRT_ID:"CT123456",EQT_CL_NM:"",LENT_YN_NM:"",EQT_USE_STAT_CD:"",NOTRECEV:"",EQT_LOC_TP_CD:"",EQT_STAT_CD:"",WRKR_NM:"",EQT_SERNO:"MDM987654321",MAC_ADDRESS:"11:22:33:44:55:66",ITEM_NM:" ",WRK_CD:"08"}];try{const e=await fetch(`${Ns}/customer/equipment/getMVRemoveEqtInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),[];const n=await e.json();return console.log("[ API] getMVRemoveEqtInfo response:",n),n.data?Array.isArray(n.data)?n.data:[n.data]:Array.isArray(n)?n:[]}catch(e){return console.error("[ API] getMVRemoveEqtInfo error:",e),[]}},PM=async t=>{if(console.log("[ API] getEqtSoMoveInfo:",t),qn())return await new Promise(e=>setTimeout(e,500)),[];try{const e=await fetch(`${Ns}/customer/work/getEqtSoMoveInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),[];const n=await e.json();return console.log("[ API] getEqtSoMoveInfo response:",n),n.data?Array.isArray(n.data)?n.data:[n.data]:Array.isArray(n)?n:[]}catch(e){return console.error("[ API] getEqtSoMoveInfo error:",e),[]}},RA=async t=>{if(console.log("[ API] excuteSoMoveEqtChg:",t),qn())return await new Promise(e=>setTimeout(e,1e3)),{MSGCODE:"SUCCESS",MESSAGE:" ."};try{const e=await fetch(`${Ns}/customer/work/excuteSoMoveEqtChg`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),null;const n=await e.json();return console.log("[ API] excuteSoMoveEqtChg response:",n),n.data?n.data:n}catch(e){return console.error("[ API] excuteSoMoveEqtChg error:",e),null}},TA=async t=>{if(console.log("[ API] custEqtInfoDel:",t),qn())return await new Promise(e=>setTimeout(e,500)),{MSGCODE:"SUCCESS",MESSAGE:" ."};try{const e=await fetch(`${Ns}/customer/work/custEqtInfoDel`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[ API] HTTP error:",e.status),null;const n=await e.json();return console.log("[ API] custEqtInfoDel response:",n),n.data?n.data:n}catch(e){return console.error("[ API] custEqtInfoDel error:",e),null}},Ac=async()=>{console.log("[Work API] getLghvProdMap called");try{const t=await fetch(`${Ns}/customer/work/getLghvProdMap`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!t.ok)return console.error("[Work API] getLghvProdMap HTTP error:",t.status),[];const e=await t.json();return console.log("[Work API] getLghvProdMap response:",e),Array.isArray(e)?e:e.data&&Array.isArray(e.data)?e.data:[]}catch(t){return console.error("[Work API] getLghvProdMap error:",t),[]}},v1=async t=>{console.log("[Work API] getOttSale called:",t);try{const e=await fetch(`${Ns}/customer/work/getOttSale`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] getOttSale HTTP error:",e.status),null;const n=await e.json();return console.log("[Work API] getOttSale response:",n),Array.isArray(n)&&n.length>0?n[0]:n.data&&Array.isArray(n.data)&&n.data.length>0?n.data[0]:n.output&&Array.isArray(n.output)&&n.output.length>0?n.output[0]:n}catch(e){return console.error("[Work API] getOttSale error:",e),null}},MA=async t=>{console.log("[Work API] saveOttSale called:",t);try{const e=await fetch(`${Ns}/customer/work/saveOttSale`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] saveOttSale HTTP error:",e.status),{code:"ERROR",message:`HTTP ${e.status}`};const n=await e.json();return console.log("[Work API] saveOttSale response:",n),{code:n.code||n.CODE||"SUCCESS",message:n.message||n.MESSAGE||""}}catch(e){return console.error("[Work API] saveOttSale error:",e),{code:"ERROR",message:e.message||"Unknown error"}}},IA=async t=>{console.log("[Work API] getOttSerno called:",t);try{const e=await fetch(`${Ns}/customer/work/getOttSerno`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] getOttSerno HTTP error:",e.status),[];const n=await e.json();return console.log("[Work API] getOttSerno response:",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n.output&&Array.isArray(n.output)?n.output:[]}catch(e){return console.error("[Work API] getOttSerno error:",e),[]}},jA=async t=>{console.log("[Work API] getOttType called:",t);try{const e=await fetch(`${Ns}/customer/work/getOttType`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Work API] getOttType HTTP error:",e.status),null;const n=await e.json();return console.log("[Work API] getOttType response:",n),Array.isArray(n)&&n.length>0?n[0]:n.data&&Array.isArray(n.data)&&n.data.length>0?n.data[0]:n.output&&Array.isArray(n.output)&&n.output.length>0?n.output[0]:n}catch(e){return console.error("[Work API] getOttType error:",e),null}},zg=async t=>{console.log("[Common Code API] getCodeDetail params:",t);try{const e=await fetch(`${Ns}/system/common/getCodeDetail`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e.ok)return console.error("[Common Code API] getCodeDetail HTTP error:",e.status),[];const n=await e.json();return console.log("[Common Code API] getCodeDetail response:",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:[]}catch(e){return console.error("[Common Code API] getCodeDetail error:",e),[]}},OA=async t=>{console.log("[getEqtMasterInfo] API :",t);try{const n=await(await ar(`${Ns}/customer/equipment/getEqtMasterInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",n),Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n.output1&&Array.isArray(n.output1)?n.output1:n}catch(e){throw console.error("   :",e),e}},CE=async t=>{console.log("[getOutEquipmentTargetList] API :",t);try{const n=await(await ar(`${Ns}/customer/equipment/getOutEquipmentTargetList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("    :",n),n}catch(e){throw console.error("    :",e),e instanceof Qs?e:new Qs("    .")}},NE=async t=>{const e={...t,RETURN_TP:t.RETURN_TP||"2",RETURN_STAT:t.RETURN_STAT||"2"};console.log("[getEquipmentReturnRequestListAll] API :",e);try{const r=await(await ar(`${Ns}/customer/equipment/getEquipmentReturnRequestList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)})).json();return console.log("   :",r),Array.isArray(r)?r:r.output1||r.data||[]}catch(n){throw console.error("   :",n),n instanceof Qs?n:new Qs("   .")}},wA=async(t,e)=>{console.log("[delEquipmentReturnRequest]  :",t);try{if(!t.WRKR_ID||!t.CRR_ID)throw new Qs("  .");if(!t.equipmentList||t.equipmentList.length===0)throw new Qs("  .");const n=t.equipmentList.length;let r=0,i=[],a=0;for(const o of t.equipmentList){a++,e==null||e(a,n,o.EQT_SERNO||o.EQT_NO);const c={EQT_NO:o.EQT_NO,REQ_DT:o.REQ_DT||"",RETURN_TP:o.RETURN_TP||"2",EQT_USE_ARR_YN:o.EQT_USE_ARR_YN==="A"?"A":"Y",WRKR_ID:t.WRKR_ID,CRR_ID:t.CRR_ID,SO_ID:t.SO_ID||""};console.log("[delEquipmentReturnRequest]  :",o.EQT_SERNO,c);try{const h=await(await ar(`${Ns}/customer/equipment/delEquipmentReturnRequest`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)})).json();console.log("[delEquipmentReturnRequest]  :",o.EQT_SERNO,h),h&&(h.MSGCODE==="0"||h.MSGCODE==="SUCCESS"||h.success===!0)?r++:i.push(o.EQT_SERNO||o.EQT_NO)}catch(u){console.error("[delEquipmentReturnRequest]  :",o.EQT_SERNO,u),i.push(o.EQT_SERNO||o.EQT_NO)}}if(console.log("[delEquipmentReturnRequest] : ",r,"/ ",i.length),r>0)return{success:!0,message:i.length>0?`${r}  , ${i.length} `:`${r}  .`,data:{successCount:r,failedItems:i}};throw new Qs(` : ${i.join(", ")}`)}catch(n){throw console.error("[delEquipmentReturnRequest]  :",n),n instanceof Qs?n:new Qs(n.message||"  .")}},Og=async t=>{console.log("[getWrkrHaveEqtListAll] API :",t);try{const n=await(await ar(`${Ns}/customer/equipment/getWrkrHaveEqtList_All`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",n),n?n.data&&Array.isArray(n.data)?n.data:Array.isArray(n)?n:n.output1||[]:[]}catch(e){throw console.error("   :",e),e instanceof Qs?e:new Qs("   .")}},SE=async t=>{console.log("[getEquipmentChkStndByAAll] API :",t);try{const n=await(await ar(`${Ns}/customer/equipment/getEquipmentChkStndByA_All`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("   :",n),n?n.data&&Array.isArray(n.data)?n.data:Array.isArray(n)?n:n.output1||[]:[]}catch(e){throw console.error("   :",e),e instanceof Qs?e:new Qs("   .")}},AM=async t=>{console.log("[getEquipmentTypeList] API call:",t);try{const n=await(await ar(`${Ns}/customer/equipment/getEquipmentTypeList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return console.log("[getEquipmentTypeList] Result:",n),n?n.data&&Array.isArray(n.data)?n.data:Array.isArray(n)?n:n.output1||[]:[]}catch(e){return console.error("[getEquipmentTypeList] Failed:",e),[]}},Wp="dlive_transferred_equipment",LA=48,PA=t=>{try{const n=sN().filter(i=>i.EQT_SERNO!==t.EQT_SERNO),r={...t,transferredAt:Date.now(),isTransferred:!0};n.push(r),localStorage.setItem(Wp,JSON.stringify(n)),console.log("[TransferredEquipment] Saved:",t.EQT_SERNO)}catch(e){console.error("[TransferredEquipment] Save error:",e)}},sN=()=>{try{const t=localStorage.getItem(Wp);if(!t)return[];const e=JSON.parse(t),n=Date.now(),r=LA*60*60*1e3,i=e.filter(a=>n-a.transferredAt<r);return i.length!==e.length&&localStorage.setItem(Wp,JSON.stringify(i)),i}catch(t){return console.error("[TransferredEquipment] Get error:",t),[]}},AA=async t=>{try{const e=await fetch(`${Ns}/customer/sigtrans/getLghvSendHist`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return e.ok?(await e.json()).output||[]:(console.error("[Signal API] getLghvSendHist HTTP error:",e.status),[])}catch(e){return console.error("[Signal API] getLghvSendHist error:",e),[]}},kA=t=>sN().filter(n=>n.TO_WRKR_ID===t),UA=t=>{try{const n=sN().filter(r=>r.EQT_SERNO!==t);localStorage.setItem(Wp,JSON.stringify(n)),console.log("[TransferredEquipment] Removed:",t)}catch(e){console.error("[TransferredEquipment] Remove error:",e)}},BA=(t,e)=>{const n=kA(e);if(n.length===0)return{merged:t,transferredCount:0};const r=new Set(t.map(a=>a.EQT_SERNO)),i=[];return n.forEach(a=>{r.has(a.EQT_SERNO)?UA(a.EQT_SERNO):i.push({EQT_NO:a.EQT_NO,EQT_SERNO:a.EQT_SERNO,ITEM_NM:a.ITEM_NM,ITEM_MID_NM:a.ITEM_MID_NM||"",ITEM_MAX_NM:a.ITEM_MAX_NM||"",EQT_CL_NM:a.EQT_CL_NM||"",SO_ID:a.SO_ID,SO_NM:a.SO_NM||"",WRKR_ID:a.TO_WRKR_ID,FROM_WRKR_ID:a.FROM_WRKR_ID,FROM_WRKR_NM:a.FROM_WRKR_NM||"",isTransferred:!0,transferredAt:a.transferredAt})}),console.log("[TransferredEquipment] Merging:",i.length,"items not in API"),{merged:[...t,...i],transferredCount:i.length}},GA=async t=>{try{const e=await fetch(`${Ns}/customer/sigtrans/getLghvSvcRslt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({JOB_ID:t})});return e.ok?(await e.json()).output||[]:(console.error("[Signal API] getLghvSvcRslt HTTP error:",e.status),[])}catch(e){return console.error("[Signal API] getLghvSvcRslt error:",e),[]}},WA=async t=>{try{const e=await fetch(`${Ns}/customer/sigtrans/getSendHistory`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return e.ok?((await e.json()).output||[]).map(i=>{const a={};for(const o of Object.keys(i))a[o.toUpperCase()]=i[o];return a}):[]}catch(e){return console.error("[Signal API] getSendHistory error:",e),[]}},FA=async t=>{const e=n=>n.map(r=>{const i={};for(const a of Object.keys(r))i[a.toUpperCase()]=r[a];return i});try{const n=await fetch(`${Ns}/customer/sigtrans/getSvcRsltAndDtlRslt`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({IF_DTL_ID:t})});if(!n.ok)return{svcRslt:[],svcDtlRslt:[]};const r=await n.json(),i=r.output1||r.ds_svc_rest||r.ds_svc_rslt||[],a=r.output2||r.ds_svc_dtl_rslt||r.ds_svc_dtl||[];return{svcRslt:e(i),svcDtlRslt:e(a)}}catch(n){return console.error("[Signal API] getSvcRsltAndDtlRslt error:",n),{svcRslt:[],svcDtlRslt:[]}}},KA=()=>{try{const t=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(t){const e=JSON.parse(t);return e.userId||e.USR_ID||e.LOGIN_ID||"SYSTEM"}}catch{}return"SYSTEM"},E1=async t=>{try{const e=await fetch(`${Ns}/customer/common/customercommon/getConditionalCustList2`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...t,SERCH_GB:"3",LOGIN_ID:KA()})});if(!e.ok)return[];const n=await e.json();return n.output||n.data||[]}catch(e){return console.error("[Customer Search] error:",e),[]}},QA=async t=>E1({TEL_NO:t}),YA=async t=>E1({CUST_ID:t}),VA=async t=>E1({CTRT_ID:t}),$A=async t=>E1({EQT_SERNO:t}),zA=async t=>{try{const e=await fetch(`${Ns}/customer/contract/getContractInfo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({CUST_ID:t})});if(!e.ok)return[];const n=await e.json();return Array.isArray(n)?n:n.output||n.data||[]}catch(e){return console.error("[Customer Search] getContractList error:",e),[]}};var Xu=rM();const sn=({value:t,onValueChange:e,options:n=[],placeholder:r="",className:i="",required:a=!1,disabled:o=!1})=>{const[c,u]=b.useState(!1),[h,m]=b.useState(!1);b.useEffect(()=>{m(!0)},[]);const _=n==null?void 0:n.find(g=>g.value===t);b.useEffect(()=>{const g=C=>{C.key==="Escape"&&u(!1)};if(c)return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[c]);const p=g=>{e(g),u(!1)};return s.jsxs("div",{className:`relative ${i}`,style:{zIndex:"auto"},children:[s.jsxs("button",{type:"button",onClick:()=>!o&&u(!c),disabled:o,className:`
          w-full p-3 text-left border border-gray-300 rounded-lg
          transition-colors duration-200 flex items-center justify-between
          ${o?"bg-gray-100 cursor-not-allowed opacity-60":"bg-white hover:border-gray-400 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"}
          ${c&&!o?"ring-2 ring-cyan-500 border-cyan-500":""}
        `,"aria-expanded":c,"aria-haspopup":"listbox",required:a,children:[s.jsx("span",{className:`text-base ${_?"text-gray-900":"text-gray-500"}`,children:_?_.label:r}),s.jsx(ir,{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${c?"rotate-180":""}`})]}),c&&h&&typeof window<"u"&&Xu.createPortal(s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",style:{zIndex:99999},onClick:()=>u(!1)}),s.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white rounded-t-xl shadow-2xl",style:{zIndex:1e5,maxHeight:"60vh",display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"flex justify-center py-3 bg-white rounded-t-xl",style:{flexShrink:0},children:s.jsx("div",{className:"w-8 h-1 bg-gray-300 rounded-full"})}),s.jsx("div",{style:{flex:1,overflowY:"auto",minHeight:0,WebkitOverflowScrolling:"touch"},children:s.jsx("div",{className:"py-1",children:(n==null?void 0:n.length)>0?n.map(g=>s.jsxs("button",{type:"button",onClick:()=>p(g.value),className:`
                      w-full px-4 py-3 text-left text-base hover:bg-gray-50
                      transition-colors duration-150 flex items-center justify-between
                      ${t===g.value?"bg-cyan-50 text-cyan-700":"text-gray-900"}
                    `,role:"option","aria-selected":t===g.value,children:[s.jsx("span",{className:"font-medium",children:g.label}),t===g.value&&s.jsx(jc,{className:"w-5 h-5 text-cyan-600"})]},g.value)):s.jsx("div",{className:"px-4 py-3 text-center text-gray-500 text-sm",children:" "})})}),s.jsx("div",{className:"p-4 border-t border-gray-200 bg-white",style:{flexShrink:0,paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:s.jsx("button",{type:"button",onClick:()=>u(!1),className:"w-full py-3 text-center text-gray-600 font-medium",children:""})})]})]}),document.body)]})},HA=(t,e=10,n=500)=>{if(!t||typeof t!="string")return{valid:!1,message:" ."};const r=t.trim();return r.length<e?{valid:!1,message:` ${e}  . ( ${r.length})`}:r.length>n?{valid:!1,message:` ${n}  . ( ${r.length})`}:{valid:!0}},_n={INSTALLATION:"01",REMOVAL:"02",AS:"03",SUSPENSION:"04",PRODUCT_CHANGE:"05",HOME_RELOCATION:"06",RELOCATION_INSTALL:"07",RELOCATION_REMOVAL:"08",ADDITIONAL_PRODUCT:"09",TEMP_REMOVAL:"0430",TEMP_REMOVAL_RESTORE:"0440"},bc={INSTALL_SCHEDULED:"10",ACTIVE:"20",SUSPENDED:"30",SUSPENDED_SPECIFIC:"37",TERMINATED:"90"},vE={RECEIVED:"1",ASSIGNED:"2"},gf=t=>t===_n.INSTALLATION,_f=t=>t===_n.AS,wg=t=>t===_n.REMOVAL,Lg=t=>t===_n.RELOCATION_INSTALL||t===_n.RELOCATION_REMOVAL,gp=t=>t===_n.PRODUCT_CHANGE,Rb=t=>t===_n.SUSPENSION,qA=(t,e)=>t===_n.SUSPENSION&&e===_n.TEMP_REMOVAL,kM=qA,XA=(t,e)=>t===_n.SUSPENSION&&e===_n.TEMP_REMOVAL_RESTORE,UM=XA,JA=(t,e)=>{if(!t||!e)return!1;switch(t){case _n.INSTALLATION:return e===bc.INSTALL_SCHEDULED;case _n.REMOVAL:return e===bc.ACTIVE||e===bc.SUSPENDED||e===bc.SUSPENDED_SPECIFIC;case _n.AS:return e!==bc.TERMINATED;case _n.TEMP_REMOVAL:return e===bc.ACTIVE;case _n.TEMP_REMOVAL_RESTORE:return e===bc.SUSPENDED||e===bc.SUSPENDED_SPECIFIC;case _n.HOME_RELOCATION:case _n.PRODUCT_CHANGE:case _n.RELOCATION_INSTALL:case _n.RELOCATION_REMOVAL:return e===bc.ACTIVE;default:return e!==bc.TERMINATED}},ZA=(t,e)=>{if(JA(t,e))return{valid:!0};let r="       .";switch(t){case _n.INSTALLATION:r="    .";break;case _n.REMOVAL:r="      .";break;case _n.TEMP_REMOVAL:r="   .";break;case _n.TEMP_REMOVAL_RESTORE:r="   .";break;case _n.AS:r="A/S    .";break}return{valid:!1,message:r}},nN=t=>t?t===vE.RECEIVED||t===vE.ASSIGNED:!1,e6=(t,e,n)=>{const r=[];return(!e||e.trim()==="")&&r.push("   ."),t.WRK_STAT_CD&&(nN(t.WRK_STAT_CD)||r.push("       .")),e==="099Z"&&(!n||n.trim().length<10)&&r.push("      10   ."),t.WRK_CD,_n.RELOCATION_INSTALL,{valid:r.length===0,errors:r}},t6=t=>{switch(t){case _n.INSTALLATION:return" ";case _n.AS:return"A/S ";case _n.REMOVAL:return" ";case _n.RELOCATION_INSTALL:return" ";case _n.RELOCATION_REMOVAL:return" ";case _n.PRODUCT_CHANGE:return" ";case _n.SUSPENSION:case _n.TEMP_REMOVAL:return" ";case _n.TEMP_REMOVAL_RESTORE:return" ";case _n.HOME_RELOCATION:return" ";case _n.ADDITIONAL_PRODUCT:return" ";default:return" "}},EE=t=>{switch(t){case _n.INSTALLATION:return"  .";case _n.AS:return"A/S .";case _n.REMOVAL:return" .";case _n.RELOCATION_INSTALL:return" .";case _n.RELOCATION_REMOVAL:return" .";case _n.PRODUCT_CHANGE:return" .";case _n.SUSPENSION:case _n.TEMP_REMOVAL:return" .";case _n.TEMP_REMOVAL_RESTORE:return" .";case _n.HOME_RELOCATION:return" .";case _n.ADDITIONAL_PRODUCT:return" .";default:return" ."}},d0=t=>t?["F","FG","Z","ZG"].includes(t):!1,rN=({isOpen:t,onClose:e,onConfirm:n,workOrder:r,userId:i,showToast:a})=>{var te;const[o,c]=b.useState("[]"),[u,h]=b.useState(new Date().toISOString().slice(0,10)),m=ce=>{if(!ce)return"";const R=ce.replace(/\D/g,"");return R.length!==10?ce:`${R.slice(0,3)}-${R.slice(3,6)}-${R.slice(6)}`},[_,p]=b.useState(""),[g,C]=b.useState({}),[y,S]=b.useState(!1),[v,k]=b.useState([]),[L,M]=b.useState("X"),[P,F]=b.useState("N"),[G,B]=b.useState(!1),[I,E]=b.useState(!1),A=["600","700","701","710","800","802","803","804"];b.useEffect(()=>{(async()=>{var R;if(console.log("[WorkCancelModal] useEffect  - isOpen:",t,"WRK_STAT_CD:",r.WRK_STAT_CD,"workOrder.id:",r.id),!!t){if(r.WRK_STAT_CD&&!nN(r.WRK_STAT_CD)){a&&a("       .","error"),e();return}if(!r.id){console.log("[OST] workOrder.id  - ");return}B(!0);try{console.log("[OST] getWorkCancelInfo :",r.id);const O=await S1({WRK_ID:r.id,RCPT_ID:r.RCPT_ID,CUST_ID:(R=r.customer)==null?void 0:R.id});if(O){console.log("[OST] :",O),M(O.OST_WORKABLE_STAT||"X"),F(O.HOTBILL_YN||"N");const U=O.OST_WORKABLE_STAT,Q=r.WRK_CD;if(U==="0"||U==="3"||U==="4"){let q="";Q==="01"?q="    .":Q==="02"?q="    .":q="     .",a&&a(q,"error"),e();return}}}catch(O){console.error("[OST] :",O),M("X")}finally{B(!1)}}})()},[t,r.id,r.WRK_STAT_CD,r.RCPT_ID,(te=r.customer)==null?void 0:te.id,r.WRK_CD,a,e]),b.useEffect(()=>{t&&Y()},[t]);const Y=async()=>{try{console.log(" [] CMWO200   ");const ce=await qa("CMWO200");console.log(" [] API   :",ce[0]),console.log(" []   :",ce.length);const R=ce.filter(O=>O.code!=="[]").map(O=>({value:O.code,label:`[${O.code}] ${O.name}`,refCode:O.ref_code||"",refCode2:O.ref_code2||"",refCode12:O.ref_code12||""}));R.unshift({value:"[]",label:"( )",refCode:"",refCode2:"",refCode12:""}),k(R),console.log("[]   :",R.length,""),console.log(" []  :",R.slice(0,3))}catch(ce){console.error("[]   :",ce),k([{value:"[]",label:"( )",refCode:"",refCode2:"",refCode12:""}])}};b.useEffect(()=>{const ce={};if(o!=="[]"&&o.endsWith("Z")){const R=HA(_,10,200);R.valid||(ce.procCt=R.message||"  10  .")}C(ce)},[o,_]);const ee=ce=>!ce||ce==="05"||ce==="06"||ce==="07"||ce==="09"?"01":ce==="08"?"02":ce==="03"?"03":ce,J=b.useMemo(()=>{const ce=r.WRK_CD,R=r.asReasonCode,O=r.SO_ID,U=ee(ce),Q=U+"3";console.log(""),console.log("[ ]  "),console.log(""),console.log(" WRK_CD:",ce," refCode:",U," refCodeWithSuffix:",Q),console.log(" WRK_RCPT_CL:",R),console.log(" SO_ID:",O),console.log("   :",v.length);let q=v.filter($=>$.value==="[]"?(console.log("    "),!0):$.refCode!==Q?(console.log(`  [${$.value}] ${$.label}: refCode="${$.refCode}" != "${Q}"`),!1):(console.log(`  [${$.value}] ${$.label}: refCode="${$.refCode}" `),!0));return U==="03"&&(console.log("[AS ] AS    "),console.log("[AS ] WRK_RCPT_CL:",R),R==="JJ"?(console.log("[AS ] CS(JJ) - 033G "),q=q.filter($=>$.value==="033G")):R==="JH"?(console.log("[AS ] (JH) - 033H "),q=q.filter($=>$.value==="033H")):(console.log("[AS ]  AS -   "),q=q.filter($=>{if($.value==="033G")return console.log(`    [${$.value}] 033G `),!1;if($.refCode2==="Y"){const de=A.includes(O||"");if(console.log(`     [${$.value}] refCode2='Y' (), isCallCenter=${de}`),!de)return console.log(`    [${$.value}]   `),!1}return $.refCode12==="JH"?(console.log(`    [${$.value}] refCode12='JH' (033H) `),!1):(console.log(`    [${$.value}] `),!0)}))),console.log(""),console.log("[ ]  :",q.length,""),console.log(""),q},[r.WRK_CD,r.asReasonCode,r.SO_ID,v]),H=ce=>{const R=ce.type,O=ce.typeDisplay;return R===ga.Installation||R==="Installation"||R===""||O===""?"01":R===ga.AS||R==="AS"||R==="A/S"||O==="A/S"?"02":R===ga.Move||R==="Move"||R===""||O===""?"03":R===ga.Change||R==="Change"||R===""||O===""?"04":"05"},V=async()=>{E(!1),await K()},K=async()=>{var U;S(!0);const ce=r.WRK_CD||"";if(console.log("[] OST_WORKABLE_STAT:",L,"WRK_CD:",ce),(L==="1"||L==="2")&&(ce==="01"||ce==="02")){console.log("[] OST   ");try{const Q=await tA({RCPT_ID:r.RCPT_ID||"",CUST_ID:((U=r.customer)==null?void 0:U.id)||"",AGENT_FL:"1"});if(Q){const q=(Q.AGENT_FL||"")+(Q.BUSI_TYPE||"")+(Q.RES_CD||"");if(console.log("[] OST_BUSI:",q),q==="10310BS0000"||q==="10320BS0000"){console.log("[] modOstWorkCancel API ");const $=await sA({RCPT_ID:r.RCPT_ID||"",WRK_CD:ce,UNPROC_RESN_CD:o,WRK_STAT_CD:"3",PROC_CT:_||"",REG_UID:i||""});$.code==="SUCCESS"||$.message==="SUCCESS"?(a&&a(" .","success"),e()):a&&a($.message||"  .","error"),S(!1);return}}}catch(Q){console.error("[] OST  :",Q),a&&a("OST    .","error"),S(!1);return}}const R=H(r),O={WRK_ID:r.id,WRK_STAT_CD:"3",UNPROC_RESN_CD:o,CALL_CNTN_DATE:u.replace(/-/g,""),CHG_UID:i||"",REG_UID:i||"",PROC_CT:_||"",RCPT_ID:r.RCPT_ID||"",WRK_CD:R};console.log("  :",O),n(O),S(!1)},j=async ce=>{if(ce.preventDefault(),y)return;const R=e6(r,o,_);if(!R.valid){const U=R.errors.join(`
`);a&&a(U,"error",!0);return}if(o!=="[]"&&o.endsWith("Z")&&_.trim().length<10){a&&a("      10  .","error");return}if(!i){a&&a(" () .  .","error");return}if((r.WRK_CD||"")==="07"&&P==="Y"){E(!0);return}await K()};return t?s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4 z-[9999]",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto mx-2 sm:mx-0",children:[s.jsx("div",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-4 sm:p-6 rounded-t-2xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg sm:text-xl font-bold",children:" "}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-white/20 rounded-lg transition-colors",children:s.jsx(Mi,{className:"w-5 h-5"})})]})}),s.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-3 text-sm sm:text-base",children:"  "}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:":"}),s.jsx("span",{className:"text-sm font-medium",children:r.customer.name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:" :"}),s.jsx("span",{className:"text-sm font-medium",children:r.typeDisplay})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:" ID:"}),s.jsx("span",{className:"text-sm font-mono",children:m(r.id)})]})]})]}),s.jsxs("form",{onSubmit:j,className:"p-4 sm:p-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:o,onValueChange:c,options:J,placeholder:"",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:u,onChange:ce=>h(ce.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-cyan-500 focus:border-cyan-500 opacity-0 absolute inset-0 cursor-pointer",required:!0}),s.jsx("div",{className:"w-full p-3 border border-gray-300 rounded-lg bg-white text-gray-900",children:u||"YYYY-MM-DD"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[" ",o!=="[]"&&o.endsWith("Z")&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:_,onChange:ce=>p(ce.target.value),placeholder:o!=="[]"&&o.endsWith("Z")?"      10  ":"     ",className:`w-full p-3 border rounded-lg focus:ring-cyan-500 focus:border-cyan-500 min-h-[80px] resize-y ${g.procCt?"border-red-500":"border-gray-300"}`,maxLength:200,required:o!=="[]"&&o.endsWith("Z")}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[_.length,"/200"]}),o!=="[]"&&o.endsWith("Z")&&s.jsx("p",{className:"text-xs text-blue-600",children:"( 10 )"})]}),g.procCt&&s.jsx("p",{className:"text-xs text-red-500 mt-1",children:g.procCt})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:""}),s.jsx("button",{type:"submit",disabled:y||G||o&&o.endsWith("Z")&&_.trim().length<10,className:`flex-1 px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-lg font-semibold transition-all duration-200 ${y||G||o&&o.endsWith("Z")&&_.trim().length<10?"opacity-50 cursor-not-allowed":""}`,children:G?"...":y?"...":"  "})]})]})]}),I&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-[10000]",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 mx-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center",children:s.jsx(go,{className:"w-6 h-6 text-amber-600"})}),s.jsx("h4",{className:"text-lg font-bold text-gray-800",children:" "})]}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-2 mb-6",children:[s.jsxs("p",{children:["   ",s.jsx("strong",{className:"text-amber-700",children:" "}),"."]}),s.jsx("p",{className:"text-gray-600",children:"    CONA       ."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:()=>E(!1),className:"flex-1 px-4 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors",children:""}),s.jsx("button",{type:"button",onClick:V,className:"flex-1 px-4 py-2.5 bg-amber-500 hover:bg-amber-600 text-white rounded-lg font-medium transition-colors",children:"  "})]})]})})]}):null},s6=t=>{const e=t.toLowerCase();return e.includes("a/s")||e.includes("as")||e.includes("")||e.includes("")?Gu:e.includes("")&&(e.includes("")||e.includes(""))?sP:e.includes("")||e.includes("")||e.includes("")?$w:e.includes("")||e.includes("")?ML:e.includes("")||e.includes("")||e.includes("wifi")||e.includes("")?kp:e.includes("tv")||e.includes("")||e.includes("")?vP:e.includes("")||e.includes("phone")?$C:e.includes("")||e.includes("")||e.includes("")?QL:e.includes("")||e.includes("")||e.includes("")?sL:e.includes("")||e.includes("")||e.includes("")?aP:J2},n6=t=>{const e=t.toLowerCase();return e.includes("")||e.includes("")&&e.includes("")?"text-emerald-500":e.includes("a/s")||e.includes("as")||e.includes("")||e.includes("")?"text-orange-500":e.includes("")||e.includes("")?"text-red-500":e.includes("")||e.includes("")||e.includes("")?"text-blue-500":e.includes("")||e.includes("")?"text-purple-500":e.includes("")||e.includes("")?"text-gray-500":e.includes("")?"text-blue-500":e.includes("")||e.includes("")||e.includes("wifi")||e.includes("")?"text-cyan-500":e.includes("tv")||e.includes("")||e.includes("")?"text-indigo-500":e.includes("")||e.includes("phone")?"text-pink-500":"text-gray-500"},Tb=({label:t,value:e,children:n})=>s.jsx("div",{className:"py-2 sm:py-3 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 hover:bg-gray-50/50 transition-colors duration-150 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[s.jsx("dt",{className:"text-xs sm:text-sm font-medium text-gray-600 flex items-center",children:t}),s.jsx("dd",{className:"sm:col-span-2 flex items-center text-sm sm:text-base text-gray-900 mt-0.5 sm:mt-0",children:n||e||"-"})]})}),r6=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-orange-800 mb-2 flex items-center",children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-orange-500 rounded-full mr-2"}),"A/S  "]}),s.jsxs("div",{className:"space-y-1 text-sm text-orange-700",children:[s.jsx(Tb,{label:"A/S ",value:t.WRK_DTL_TCD||"AS "}),s.jsx(Tb,{label:" ID",value:t.CTRT_ID}),s.jsx(Tb,{label:" ID",value:t.RCPT_ID})]})]}),t.asHistory&&t.asHistory.length>0&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})," A/S "]}),s.jsx("div",{className:"space-y-2",children:t.asHistory.map((e,n)=>s.jsxs("div",{className:"border-l-2 border-blue-300 pl-3 py-2 hover:bg-blue-50 transition-colors rounded",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-gray-700",children:e.asDate}),s.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full",children:e.asResult})]}),s.jsx("div",{className:"text-sm text-gray-600",children:e.asReason}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[": ",e.asWorker]})]},n))})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-blue-800 mb-2",children:" A/S      "}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"/    "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"A/S      "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"   "})]})]})]})]}),jx=({label:t,value:e,children:n})=>s.jsx("div",{className:"py-2 sm:py-3 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 hover:bg-gray-50/50 transition-colors duration-150 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[s.jsx("dt",{className:"text-xs sm:text-sm font-medium text-gray-600 flex items-center",children:t}),s.jsx("dd",{className:"sm:col-span-2 flex items-center text-sm sm:text-base text-gray-900 mt-0.5 sm:mt-0",children:n||e||"-"})]})}),i6=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-green-800 mb-2 flex items-center",children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full mr-2"}),"  "]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(jx,{label:"",value:t.productName||" "}),s.jsx(jx,{label:" ",value:t.installLocation||t.customer.address}),s.jsx(jx,{label:" ID",value:t.CTRT_ID}),s.jsx(jx,{label:" ID",value:t.RCPT_ID})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})," "]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-green-600 focus:ring-green-500",disabled:!0}),s.jsx("span",{children:"    "})]})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-green-800 mb-2",children:"       "}),s.jsxs("ul",{className:"text-xs text-green-700 space-y-1",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     (,  )"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"    ()"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"  "})]})]})]})]}),Ox=({label:t,value:e,children:n})=>s.jsx("div",{className:"py-2 sm:py-3 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 hover:bg-gray-50/50 transition-colors duration-150 rounded-lg px-2 sm:px-3 py-1 sm:py-2",children:[s.jsx("dt",{className:"text-xs sm:text-sm font-medium text-gray-600 flex items-center",children:t}),s.jsx("dd",{className:"sm:col-span-2 flex items-center text-sm sm:text-base text-gray-900 mt-0.5 sm:mt-0",children:n||e||"-"})]})}),a6=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-red-800 mb-2 flex items-center",children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-red-500 rounded-full mr-2"}),"  "]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Ox,{label:"() ",value:t.termReasonCode||" "}),s.jsx(Ox,{label:"",value:t.termFee?`${t.termFee.toLocaleString()}`:""}),s.jsx(Ox,{label:" ID",value:t.CTRT_ID}),s.jsx(Ox,{label:" ID",value:t.RCPT_ID})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),"  "]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"  "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"   "})]}),s.jsxs("label",{className:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",className:"rounded text-red-600 focus:ring-red-500",disabled:!0}),s.jsx("span",{children:"   "})]})]})]}),s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-red-800 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:14}),"      "]}),s.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     (,  )"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"()      "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"     "})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"   "})]})]})]}),t.termFee&&t.termFee>0&&s.jsxs("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-yellow-800 mb-2 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"  "]}),s.jsxs("p",{className:"text-xs text-yellow-700",children:[" ",s.jsxs("strong",{className:"text-yellow-900",children:[t.termFee.toLocaleString(),""]})," .       ."]})]})]}),so=({label:t,value:e,highlight:n})=>s.jsxs("div",{className:`flex py-2 border-b border-gray-100 ${n?"bg-yellow-50":""}`,children:[s.jsx("div",{className:"w-1/3 text-xs sm:text-sm font-medium text-gray-700",children:t}),s.jsx("div",{className:"w-2/3 text-xs sm:text-sm text-gray-900",children:e||"-"})]}),l6=({order:t})=>{const e=kM(t.WRK_CD,t.WRK_DTL_TCD),n=UM(t.WRK_CD,t.WRK_DTL_TCD);return s.jsxs("div",{className:"space-y-4",children:[e&&s.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-orange-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-orange-100 divide-y divide-gray-100",children:[s.jsx(so,{label:" ",value:t.mmtSusCd||"",highlight:!t.mmtSusCd}),s.jsx(so,{label:" ",value:t.susHopeDd?wx(t.susHopeDd):"",highlight:!t.susHopeDd}),s.jsx(so,{label:" ",value:t.mmtSusHopeDd?wx(t.mmtSusHopeDd):"",highlight:!t.mmtSusHopeDd}),s.jsx(so,{label:" ",value:t.susProcYn==="Y"?"":""}),t.termDays&&s.jsx(so,{label:"  ",value:`${t.termDays}`}),t.mmtCnt&&s.jsx(so,{label:"   ",value:`${t.mmtCnt}`})]}),s.jsxs("div",{className:"mt-3 bg-orange-100 border border-orange-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-orange-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[s.jsx("li",{children:"    (MMT_SUS_CD)"}),s.jsx("li",{children:"   (SUS_HOPE_DD)"}),s.jsx("li",{children:"   (MMT_SUS_HOPE_DD)"}),s.jsx("li",{children:"    (SUS_PROC_YN)"})]})]}),s.jsxs("div",{className:"mt-3 bg-white border border-orange-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:14}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600",children:["   ",s.jsx("span",{className:"font-semibold text-orange-600",children:"'20'()"}),"  ."]}),s.jsxs("div",{className:"mt-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="20"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="20"?s.jsx(Pp,{size:14}):s.jsx(Ap,{size:14})]})]})]})]}),n&&s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[s.jsx(eP,{size:16}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-blue-100 divide-y divide-gray-100",children:[s.jsx(so,{label:" ",value:t.mmtSusCd||""}),s.jsx(so,{label:" ",value:t.susHopeDd?wx(t.susHopeDd):""}),s.jsx(so,{label:" ",value:t.mmtSusHopeDd?wx(t.mmtSusHopeDd):""}),t.termDays&&s.jsx(so,{label:"  ",value:`${t.termDays}`})]}),s.jsxs("div",{className:"mt-3 bg-blue-100 border border-blue-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-blue-800 mb-2 flex items-center gap-1",children:[s.jsx(q2,{size:14}),"  "]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsx("li",{children:"  "}),s.jsx("li",{children:"  "}),s.jsx("li",{children:"   "})]})]}),s.jsxs("div",{className:"mt-3 bg-white border border-blue-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:14}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600",children:["    ",s.jsx("span",{className:"font-semibold text-blue-600",children:"'30'()"})," "," ",s.jsx("span",{className:"font-semibold text-blue-600",children:"'37'(-)"}),"  ."]}),s.jsxs("div",{className:"mt-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="30"||t.CTRT_STAT==="37"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="30"||t.CTRT_STAT==="37"?s.jsx(Pp,{size:14}):s.jsx(Ap,{size:14})]})]})]})]}),t.WRK_CD==="06"&&s.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-100 divide-y divide-gray-100",children:[s.jsx(so,{label:" ",value:t.WRK_DTL_TCD==="0610"?"":t.WRK_DTL_TCD==="0620"?"":t.WRK_DTL_TCD||""}),s.jsx(so,{label:" ",value:t.details||""})]}),s.jsxs("div",{className:"mt-3 bg-gray-100 border border-gray-200 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0610 ()"}),":    "]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0620 ()"}),":     "]})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"  "}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-2",children:[e&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"1."}),s.jsx("span",{children:"     ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"2."}),s.jsx("span",{children:" (~)   ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"3."}),s.jsx("span",{children:"  '(20)' ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"4."}),s.jsx("span",{children:"        ."})]})]}),n&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"1."}),s.jsx("span",{children:"    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"2."}),s.jsx("span",{children:"    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"3."}),s.jsx("span",{children:"     ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"4."}),s.jsx("span",{children:"     ."})]})]})]})]})]})},wx=t=>!t||t.length!==8?t:`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`,cg=({label:t,value:e,highlight:n})=>s.jsxs("div",{className:`flex py-2 border-b border-gray-100 ${n?"bg-yellow-50":""}`,children:[s.jsx("div",{className:"w-1/3 text-xs sm:text-sm font-medium text-gray-700",children:t}),s.jsx("div",{className:"w-2/3 text-xs sm:text-sm text-gray-900",children:e||"-"})]}),o6=({order:t})=>{const n=(r=>{switch(r){case"0510":case"0520":return" ";case"0550":case"0560":return" ";default:return" "}})(t.WRK_DTL_TCD);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[s.jsx(Oc,{size:16})," "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-purple-100 divide-y divide-gray-100",children:[s.jsx(cg,{label:" ",value:n}),s.jsx(cg,{label:"  ",value:t.WRK_DTL_TCD||""}),s.jsx(cg,{label:" ",value:t.currentProduct||t.productName||"",highlight:!t.currentProduct&&!t.productName}),s.jsx(cg,{label:" ",value:t.newProduct||"",highlight:!t.newProduct}),s.jsx(cg,{label:"",value:t.productName||""})]}),s.jsxs("div",{className:"mt-3 bg-purple-100 border border-purple-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-purple-800 mb-2 flex items-center gap-1",children:[s.jsx(q2,{size:14}),"   "]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0510"}),":   (  )"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0520"}),":    ",s.jsx("span",{className:"text-red-600",children:"0510  "})]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0550"}),":   ( )"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"0560"}),":  2  ",s.jsx("span",{className:"text-red-600",children:"0550  "})]})]})]}),s.jsxs("div",{className:"mt-3 bg-white border border-purple-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-purple-800 mb-2 flex items-center gap-1",children:[s.jsx(ea,{size:14}),"  "]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[s.jsx("li",{children:"    (BASIC_PROD_CD)"}),s.jsx("li",{children:"    (NEW_PROD_CD)"}),s.jsx("li",{children:"  "}),s.jsx("li",{children:"   "})]})]})]}),(t.WRK_DTL_TCD==="0510"||t.WRK_DTL_TCD==="0520")&&s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-green-100 p-3",children:[s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[" / ,  ",s.jsx("span",{className:"font-semibold text-green-600",children:"'01'()"}),"    'Y'    ."]}),s.jsx("div",{className:"mt-2 bg-green-50 border border-green-200 rounded p-2",children:s.jsx("p",{className:"text-xs font-semibold text-green-700",children:"SQL : WRK_CD IN ('01','05','07') AND PYM_MTHD = '01' AND ATMT_YN = 'Y'"})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-3",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"      ."}),s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-700",children:" :"}),s.jsxs("ul",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[s.jsx("li",{children:" WRK_CD IN ('01','05','07','09')"}),s.jsx("li",{children:" PROD_CMPS_CL = '21' ()"})]})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"  "}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-2",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"1."}),s.jsx("span",{children:"     ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"2."}),s.jsx("span",{children:"       ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"3."}),s.jsx("span",{children:"       ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"4."}),s.jsx("span",{children:"   ,    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"5."}),s.jsx("span",{children:"    ."})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx("span",{className:"mr-2",children:"6."}),s.jsx("span",{children:"     ."})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:16,className:"text-gray-600"}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["   ",s.jsx("span",{className:"font-semibold text-purple-600",children:"'20'()"}),"   ."]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="20"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="20"?s.jsx(Pp,{size:14}):s.jsx(Ap,{size:14})]})]})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-yellow-800 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:16}),""]}),s.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[s.jsx("li",{children:"    0520 0560   "}),s.jsx("li",{children:"      ,     "}),s.jsx("li",{children:"        "}),s.jsx("li",{children:"           "})]})]})]})},Lx=({label:t,value:e,highlight:n})=>s.jsxs("div",{className:`flex py-2 border-b border-gray-100 ${n?"bg-yellow-50":""}`,children:[s.jsx("div",{className:"w-1/3 text-xs sm:text-sm font-medium text-gray-700",children:t}),s.jsx("div",{className:"w-2/3 text-xs sm:text-sm text-gray-900",children:e||"-"})]}),c6=({order:t})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-teal-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-teal-100 divide-y divide-gray-100",children:[s.jsx(Lx,{label:"  ",value:t.customer.address}),s.jsx(Lx,{label:"  ",value:t.installLocation||"",highlight:!t.installLocation}),s.jsx(Lx,{label:"",value:t.productName||""}),s.jsx(Lx,{label:" ID",value:t.CTRT_ID||""})]}),s.jsxs("div",{className:"mt-3 bg-teal-100 border border-teal-200 rounded-lg p-3",children:[s.jsxs("h4",{className:"text-xs font-semibold text-teal-800 mb-2 flex items-center gap-1",children:[s.jsx(ea,{size:14}),"  "]}),s.jsxs("ul",{className:"text-xs text-teal-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"  "}),s.jsx("li",{children:"   "})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[s.jsx(rm,{size:16})," "]}),t.assignedEquipment&&t.assignedEquipment.length>0?s.jsx("div",{className:"space-y-2",children:t.assignedEquipment.map((e,n)=>s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:":"}),s.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:e.type})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:":"}),s.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:e.model})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-600",children:":"}),s.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:e.serialNumber})]})]})},e.id||n))}):s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-xs text-yellow-700 flex items-center gap-1",children:[s.jsx(go,{size:14}),"   ."]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[s.jsx(Yu,{size:16}),"  "]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-2",children:"1"}),s.jsx("h5",{className:"text-xs font-semibold text-blue-800",children:"  "})]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1 ml-8",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("span",{className:"bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-2",children:"2"}),s.jsx("h5",{className:"text-xs font-semibold text-green-800",children:"  "})]}),s.jsxs("ul",{className:"text-xs text-green-700 space-y-1 ml-8",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"   "}),s.jsx("li",{children:"    "})]})]}),s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("span",{className:"bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-2",children:"3"}),s.jsx("h5",{className:"text-xs font-semibold text-purple-800",children:" "})]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1 ml-8",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"      "}),s.jsx("li",{children:"    "})]})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center",children:[s.jsx("span",{className:"mr-2",children:""}),"  "]}),s.jsxs("div",{className:"bg-white rounded-lg border border-green-100 p-3",children:[s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["  ,  ",s.jsx("span",{className:"font-semibold text-green-600",children:"'01'()"}),"    'Y'    ."]}),s.jsx("div",{className:"mt-2 bg-green-50 border border-green-200 rounded p-2",children:s.jsx("p",{className:"text-xs font-semibold text-green-700",children:"SQL : WRK_CD IN ('01','05','07') AND PYM_MTHD = '01' AND ATMT_YN = 'Y'"})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-3",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-2",children:" (WRK_CD='07')      :"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"()"})," WRK_CD='07':      "]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-semibold",children:"()"})," WRK_CD='08':    "]})]}),s.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded",children:s.jsx("p",{className:"text-xs text-blue-700",children:"         ."})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:16,className:"text-gray-600"}),"  "]}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["    ",s.jsx("span",{className:"font-semibold text-teal-600",children:"'20'()"}),"   ."]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded p-2 text-xs flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"  : "}),s.jsxs("span",{className:`font-semibold flex items-center gap-1 ${t.CTRT_STAT==="20"?"text-green-600":"text-red-600"}`,children:[t.CTRT_STAT||"",t.CTRT_STAT==="20"?s.jsx(Pp,{size:14}):s.jsx(Ap,{size:14})]})]})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-yellow-800 mb-2 flex items-center gap-1",children:[s.jsx(go,{size:16}),""]}),s.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"       "}),s.jsx("li",{children:"      "}),s.jsx("li",{children:"       "}),s.jsx("li",{children:"      "})]})]})]}),Ya=({label:t,value:e,children:n,icon:r})=>s.jsxs("div",{className:"bg-gray-50 rounded-md px-3 py-2 flex items-center justify-between gap-3",children:[s.jsxs("dt",{className:"flex items-center gap-1.5 text-xs text-gray-700 font-semibold flex-shrink-0",children:[r&&s.jsx("span",{className:"text-gray-500",children:r}),t]}),s.jsx("dd",{className:"text-sm text-black font-semibold text-right break-words",children:n||e})]}),BM=({order:t,onBack:e,onUpdateStatus:n,onComplete:r,onStartWorkProcess:i,showToast:a})=>{const o=t.WRK_STAT_CD==="4"||t.status===gn.Completed||t.status==="",[c,u]=b.useState("info"),[h,m]=b.useState(!1),[_,p]=b.useState(!1),g=o;b.useEffect(()=>{(async()=>{var P;try{const F=localStorage.getItem("userInfo");if(!F)return;const G=JSON.parse(F),B={WRKR_ID:G.userId||G.workerId||"",SO_ID:t.SO_ID||G.soId,WORK_ID:t.id,CUST_ID:(P=t.customer)==null?void 0:P.id,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};await Co(B)}catch{}})()},[t.id]);const C=()=>{if(t.WRK_CD&&t.CTRT_STAT){const M=ZA(t.WRK_CD,t.CTRT_STAT);if(!M.valid){a&&a(M.message||"   .","error",!0);return}}i?i(t):r&&r(t)},y=()=>{if(t.WRK_STAT_CD&&!nN(t.WRK_STAT_CD)){a&&a("       .","warning");return}p(!0)},S=async M=>{m(!0),p(!1);try{const P=await tN(M);P.code==="SUCCESS"||P.code==="OK"?(a&&a("  .","success"),n&&n(t.id,gn.Cancelled)):a&&a(` : ${P.message}`,"error",!0)}catch(P){a&&a(P.message||"   .","error",!0),console.error(" :",P)}finally{m(!1)}},v=({tabId:M,title:P,icon:F})=>{const G=o,B=c===M;return s.jsxs("button",{onClick:()=>u(M),className:`relative px-4 sm:px-6 py-3 sm:py-3.5 text-sm sm:text-base font-semibold transition-all duration-200 flex items-center gap-2 ${B?"text-blue-600 bg-blue-50":o?"text-green-600 bg-green-50 hover:text-green-700 hover:bg-green-100":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[G?s.jsx("svg",{className:`w-5 h-5 ${B?"text-blue-600":"text-green-600"}`,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):F,P,B&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 rounded-t-lg bg-blue-600"})]})},k=s6(t.typeDisplay);n6(t.typeDisplay);const L=M=>M?gf(M)?"bg-green-600":_f(M)?"bg-orange-500":wg(M)?"bg-red-600":Lg(M)?"bg-blue-600":gp(M)?"bg-purple-600":Rb(M)?"bg-gray-600":"bg-blue-500":"bg-blue-500";return s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"pb-40",style:{minHeight:"calc(100vh - 80px)"},children:[s.jsxs("div",{className:"bg-white overflow-hidden",children:[s.jsxs("div",{className:"bg-blue-600 px-4 py-4 text-white",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:s.jsx(k,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsx("h1",{className:"text-xl font-bold text-white truncate",children:t.customer.name}),t.customer.isVip&&s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-bold bg-yellow-400 text-yellow-900 flex-shrink-0",children:t.customer.vipLevel||"VIP"})]})]}),s.jsx("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-bold flex-shrink-0 ${t.status===""?"bg-yellow-400 text-yellow-900":t.status===""?"bg-green-400 text-green-900":"bg-red-400 text-red-900"}`,children:t.status})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-md font-semibold bg-white/20 border border-white/30",children:t.typeDisplay}),s.jsxs("div",{className:"text-right flex items-center gap-1.5",children:[s.jsx(Eb,{className:"w-4 h-4 text-white/80"}),s.jsx("span",{className:"font-semibold",children:Up(t.scheduledAt)})]})]})]}),s.jsx("div",{className:"border-b-2 border-gray-200 bg-white shadow-sm",children:s.jsxs("div",{className:"flex overflow-x-auto",children:[s.jsx(v,{tabId:"info",title:"/ ",icon:s.jsx(uE,{className:"w-5 h-5"})}),s.jsx(v,{tabId:"equipment",title:" ",icon:s.jsx(vb,{className:"w-5 h-5"})}),s.jsx(v,{tabId:"workflow",title:" ",icon:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})}),s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 pb-28",children:[c==="info"&&s.jsxs("div",{className:"space-y-4",children:[t.WRK_CD&&s.jsx("div",{className:`${L(t.WRK_CD)} rounded-lg p-4`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:s.jsx(cu,{className:"w-5 h-5 text-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-sm font-semibold text-white leading-relaxed",children:EE(t.WRK_CD)})})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"})," "]}),s.jsx(Ya,{label:"ID",value:Xi(t.directionId||t.id),icon:s.jsx(cu,{className:"w-4 h-4"})}),s.jsx(Ya,{label:"ID",value:Xi(t.id),icon:s.jsx(cu,{className:"w-4 h-4"})}),s.jsx(Ya,{label:"ID",value:Xi(t.RCPT_ID),icon:s.jsx(cu,{className:"w-4 h-4"})}),s.jsx(Ya,{label:" ",value:t.typeDisplay,icon:s.jsx(k,{className:"w-4 h-4"})}),t.WRK_CD&&s.jsx(Ya,{label:" ",icon:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M10 2a1 1 0 011 1v1.323l3.954 1.582 1.599-.8a1 1 0 01.894 1.79l-1.233.616 1.738 5.42a1 1 0 01-.285 1.05A3.989 3.989 0 0115 15a3.989 3.989 0 01-2.667-1.019 1 1 0 01-.285-1.05l1.738-5.42-1.233-.617a1 1 0 01.894-1.788l1.599.799L11 4.323V3a1 1 0 011-1h-2zm-5 8.274l-.818 2.552c-.25.78.409 1.565 1.237 1.474L9 13.796l3.581.504c.828.091 1.487-.694 1.237-1.474l-.818-2.552-3-1.2-3 1.2z"})}),children:s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-bold ${gf(t.WRK_CD)?"bg-red-100 text-red-800":_f(t.WRK_CD)?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:gf(t.WRK_CD)?" ()":_f(t.WRK_CD)?" (A/S)":""})}),t.CTRT_STAT&&s.jsx(Ya,{label:" ",icon:s.jsx(cu,{className:"w-4 h-4"}),children:s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-bold ${t.CTRT_STAT==="20"?"bg-green-100 text-green-800":t.CTRT_STAT==="10"?"bg-blue-100 text-blue-800":t.CTRT_STAT==="30"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.CTRT_STAT==="20"?"":t.CTRT_STAT==="10"?"":t.CTRT_STAT==="30"?"":t.CTRT_STAT==="90"?"":`: ${t.CTRT_STAT}`})}),t.CTRT_ID&&s.jsx(Ya,{label:"ID",value:Xi(t.CTRT_ID),icon:s.jsx(cu,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-3 mt-6",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"})," "]}),s.jsx(Ya,{label:"",value:t.customer.name,icon:s.jsx(uE,{className:"w-4 h-4"})}),s.jsx(Ya,{label:"",icon:s.jsx(dE,{className:"w-4 h-4"}),children:s.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between gap-2 xs:gap-2 w-full",children:[s.jsx("span",{className:"text-gray-900 font-medium flex-1 min-w-0 break-all",children:t.customer.phone||" "}),s.jsxs("button",{onClick:()=>{a&&a("   .","info")},className:"flex-shrink-0 w-full xs:w-9 py-2 xs:py-0 xs:h-9 rounded-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 flex items-center justify-center gap-1.5",disabled:!t.customer.phone,children:[s.jsx(dE,{className:"h-4 w-4 text-white"}),s.jsx("span",{className:"xs:hidden text-white text-sm font-medium",children:" "})]})]})}),s.jsx(Ya,{label:" ",icon:s.jsx(Sb,{className:"w-4 h-4"}),children:s.jsxs("div",{className:"flex flex-col xs:flex-row items-start justify-between gap-2 xs:gap-2 w-full",children:[s.jsx("span",{className:"text-gray-900 flex-1 min-w-0 leading-relaxed break-all",children:t.customer.address}),s.jsxs("button",{onClick:()=>{a&&a("    .","info")},className:"flex-shrink-0 w-full xs:w-9 py-2 xs:py-0 xs:h-9 rounded-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95 xs:mt-0.5 flex items-center justify-center gap-1.5",children:[s.jsx(Sb,{className:"h-4 w-4 text-white"}),s.jsx("span",{className:"xs:hidden text-white text-sm font-medium",children:" "})]})]})}),t.installLocation&&s.jsx(Ya,{label:"  ",value:t.installLocation,icon:s.jsx(Sb,{className:"w-4 h-4"})}),t.cellNo&&s.jsx(Ya,{label:"CELL NO",value:t.cellNo,icon:s.jsx(cu,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-3 mt-6",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"})," "]}),s.jsx(Ya,{label:" ",value:Up(t.scheduledAt),icon:s.jsx(Eb,{className:"w-4 h-4"})}),s.jsx(Ya,{label:"",value:GP(t.scheduledAt),icon:s.jsx(Eb,{className:"w-4 h-4"})}),s.jsx(Ya,{label:" ",icon:s.jsx(cu,{className:"w-4 h-4"}),children:s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border-l-4 border-blue-600 w-full",children:s.jsx("p",{className:"text-gray-800 whitespace-pre-wrap leading-relaxed",children:t.details})})})]}),(_f(t.WRK_CD)||gf(t.WRK_CD)||wg(t.WRK_CD)||Rb(t.WRK_CD)||gp(t.WRK_CD)||Lg(t.WRK_CD))&&s.jsxs("div",{className:"mt-6 pt-6 border-t-2 border-gray-200",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-1 h-6 bg-blue-600 rounded-full"}),"  "]}),_f(t.WRK_CD)&&s.jsx(r6,{order:t}),gf(t.WRK_CD)&&s.jsx(i6,{order:t}),wg(t.WRK_CD)&&s.jsx(a6,{order:t}),Rb(t.WRK_CD)&&s.jsx(l6,{order:t}),gp(t.WRK_CD)&&s.jsx(o6,{order:t}),Lg(t.WRK_CD)&&s.jsx(c6,{order:t})]}),t.status===gn.Pending&&s.jsx("div",{className:"mt-8 pt-6 border-t-2 border-gray-200",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-600 p-5 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:" ?"}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mb-3",children:EE(t.WRK_CD)}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 text-xs text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"  "})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:" /"})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:" "})]})]})]})]})})})]}),c==="equipment"&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-4 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"}),"  "]}),t.assignedEquipment.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.assignedEquipment.map(M=>{const F=(G=>G==="04"?{color:"bg-blue-600",label:"",status:""}:G==="05"?{color:"bg-purple-600",label:"",status:""}:G==="07"?{color:"bg-orange-500",label:"",status:""}:G==="03"?{color:"bg-green-600",label:"",status:""}:{color:"bg-gray-600",label:"",status:""})(M.itemMidCd);return s.jsx("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-200 p-4 border border-gray-200 hover:border-blue-300",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-lg ${F.color} flex items-center justify-center`,children:s.jsx(vb,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("p",{className:"font-bold text-gray-800 text-base",children:M.type}),s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-green-100 text-green-800 flex-shrink-0",children:F.status})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:M.model}),s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[s.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:["S/N: ",M.serialNumber]}),M.itemMidCd&&s.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[": ",F.label]})]})]})]})},M.id)})})}):s.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[s.jsx(vb,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"  ."}),s.jsx("p",{className:"text-gray-400 text-xs mt-2",children:"    ."})]})]}),c==="workflow"&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-bold text-gray-700 mb-3 flex items-center gap-2 px-1",children:[s.jsx("div",{className:"w-1 h-5 bg-blue-600 rounded-full"}),"  "]}),s.jsxs("div",{className:"mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("p",{className:"text-sm font-bold text-gray-800",children:" "}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:o?"100%":g&&t.assignedEquipment.length>0?"50%":g?"25%":"0%"})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 h-2.5 rounded-full transition-all duration-500 shadow-sm",style:{width:`${o?100:g&&t.assignedEquipment.length>0?50:g?25:0}%`}})}),s.jsx("p",{className:"text-xs text-gray-600 mt-1.5",children:o?"  ":g&&t.assignedEquipment.length>0?"   ":g?" ":" "})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${g?"bg-green-50 border-green-500 shadow-sm":!g&&!t.assignedEquipment.length&&t.status!==gn.Completed?"bg-blue-50 border-blue-500 shadow-md ring-2 ring-blue-200":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${g?"bg-green-500":!g&&!t.assignedEquipment.length&&t.status!==gn.Completed?"bg-blue-500 animate-pulse":"bg-gray-400"}`,children:g?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"1"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${g?"text-green-800":!g&&!t.assignedEquipment.length&&t.status!==gn.Completed?"text-blue-800":"text-gray-700"}`,children:""}),g?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):!g&&!t.assignedEquipment.length&&t.status!==gn.Completed?s.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full animate-pulse",children:" "}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:g?" .":"   ."})]})]})}),s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${o||t.assignedEquipment.length>0?"bg-green-50 border-green-500 shadow-sm":g&&!t.assignedEquipment.length&&t.status!==gn.Completed?"bg-blue-50 border-blue-500 shadow-md ring-2 ring-blue-200":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${o||t.assignedEquipment.length>0?"bg-green-500":g&&!t.assignedEquipment.length&&t.status!==gn.Completed?"bg-blue-500 animate-pulse":"bg-gray-400"}`,children:o||t.assignedEquipment.length>0?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"2"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${o||t.assignedEquipment.length>0?"text-green-800":g&&!t.assignedEquipment.length&&t.status!==gn.Completed?"text-blue-800":"text-gray-700"}`,children:" "}),o||t.assignedEquipment.length>0?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):g&&!t.assignedEquipment.length&&t.status!==gn.Completed?s.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full animate-pulse",children:" "}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:t.assignedEquipment.length>0?`${t.assignedEquipment.length}  .`:"  ."})]})]})}),s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${o?"bg-green-50 border-green-500 shadow-sm":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${o?"bg-green-500":"bg-gray-400"}`,children:o?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"3"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${o?"text-green-800":"text-gray-700"}`,children:" /  "}),o?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"LGU      ()"})]})]})}),s.jsx("div",{className:`rounded-lg border-2 p-3.5 transition-all duration-200 ${o?"bg-green-50 border-green-500 shadow-sm":g&&t.assignedEquipment.length>0&&t.status!==gn.Completed?"bg-blue-50 border-blue-500 shadow-md ring-2 ring-blue-200":"bg-gray-50 border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center shadow-sm ${o?"bg-green-500":g&&t.assignedEquipment.length>0&&t.status!==gn.Completed?"bg-blue-500 animate-pulse":"bg-gray-400"}`,children:o?s.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.jsx("span",{className:"text-white font-bold text-sm",children:"4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("p",{className:`font-bold text-sm ${o?"text-green-800":g&&t.assignedEquipment.length>0&&t.status!==gn.Completed?"text-blue-800":"text-gray-700"}`,children:"  "}),o?s.jsx("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:""}):g&&t.assignedEquipment.length>0&&t.status!==gn.Completed?s.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-0.5 rounded-full animate-pulse",children:" "}):s.jsx("span",{className:"text-xs font-semibold text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:""})]}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:o?"  .":"      ."})]})]})})]})]})]})]}),s.jsx(rN,{isOpen:_,onClose:()=>p(!1),onConfirm:S,workOrder:t,showToast:a})]}),t.status===gn.Pending&&s.jsx("div",{className:"bg-white border-t border-gray-200 shadow-2xl mt-4",children:s.jsx("div",{className:"max-w-4xl mx-auto px-3 py-2",children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsxs("button",{onClick:y,disabled:h,className:"flex-shrink-0 w-24 px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-xl font-bold transition-all duration-200 flex flex-col items-center justify-center gap-0.5 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-xs font-bold",children:h?"":""})]}),s.jsxs("button",{onClick:C,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-bold transition-all duration-200 flex items-center justify-center gap-2 shadow-lg hover:shadow-xl active:scale-[0.98]",children:[s.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})}),s.jsxs("div",{className:"flex flex-col items-start",children:[s.jsx("span",{className:"text-base leading-tight font-bold",children:""}),s.jsx("span",{className:"text-[0.625rem] opacity-90 leading-tight",children:t.typeDisplay})]})]})]})})})]})},DE=t=>{let e;const n=new Set,r=(h,m)=>{const _=typeof h=="function"?h(e):h;if(!Object.is(_,e)){const p=e;e=m??(typeof _!="object"||_===null)?_:Object.assign({},e,_),n.forEach(g=>g(e,p))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h))},u=e=t(r,i,c);return c},d6=(t=>t?DE(t):DE),u6=t=>t;function h6(t,e=u6){const n=Ji.useSyncExternalStore(t.subscribe,Ji.useCallback(()=>e(t.getState()),[t,e]),Ji.useCallback(()=>e(t.getInitialState()),[t,e]));return Ji.useDebugValue(n),n}const f6=t=>{const e=d6(t),n=r=>h6(e,r);return Object.assign(n,e),n},D1=(t=>f6);function m6(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=n.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const XC=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return XC(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return XC(r)(n)}}}},g6=(t,e)=>(n,r,i)=>{let a={storage:m6(()=>localStorage),partialize:y=>y,version:0,merge:(y,S)=>({...S,...y}),...e},o=!1;const c=new Set,u=new Set;let h=a.storage;if(!h)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...y)},r,i);const m=()=>{const y=a.partialize({...r()});return h.setItem(a.name,{state:y,version:a.version})},_=i.setState;i.setState=(y,S)=>(_(y,S),m());const p=t((...y)=>(n(...y),m()),r,i);i.getInitialState=()=>p;let g;const C=()=>{var y,S;if(!h)return;o=!1,c.forEach(k=>{var L;return k((L=r())!=null?L:p)});const v=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(y=r())!=null?y:p))||void 0;return XC(h.getItem.bind(h))(a.name).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==a.version){if(a.migrate){const L=a.migrate(k.state,k.version);return L instanceof Promise?L.then(M=>[!0,M]):[!0,L]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,k.state];return[!1,void 0]}).then(k=>{var L;const[M,P]=k;if(g=a.merge(P,(L=r())!=null?L:p),n(g,!0),M)return m()}).then(()=>{v==null||v(g,void 0),g=r(),o=!0,u.forEach(k=>k(g))}).catch(k=>{v==null||v(void 0,k)})};return i.persist={setOptions:y=>{a={...a,...y},y.storage&&(h=y.storage)},clearStorage:()=>{h==null||h.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:y=>(c.add(y),()=>{c.delete(y)}),onFinishHydration:y=>(u.add(y),()=>{u.delete(y)})},a.skipHydration||C(),g||p},R1=g6,Za=D1()(R1(t=>({certifyRegconfInfo:null,ldapResult:null,certifyProdList:[],isCertifyProd:!1,certifyOpLnkdCd:"",entrNo:null,entrRqstNo:null,lguMarketCd:"",lguOperatorId:"",lguJobType:"",lguJobTypeConf:"",cl02PortData:null,isSubscriptionDone:!1,isLineRegistrationDone:!1,setCertifyRegconfInfo:e=>t({certifyRegconfInfo:e}),setLdapResult:e=>t({ldapResult:e}),setCertifyProdList:e=>t({certifyProdList:e}),setIsCertifyProd:e=>t({isCertifyProd:e}),setCertifyOpLnkdCd:e=>t({certifyOpLnkdCd:e}),setEntrNo:(e,n)=>t({entrNo:e,entrRqstNo:n??null}),setLguCommonCd:(e,n,r,i)=>t({lguMarketCd:e,lguOperatorId:n,...r!==void 0?{lguJobType:r}:{},...i!==void 0?{lguJobTypeConf:i}:{}}),setCl02PortData:e=>t({cl02PortData:e}),setIsSubscriptionDone:e=>t({isSubscriptionDone:e}),setIsLineRegistrationDone:e=>t({isLineRegistrationDone:e}),reset:()=>t({certifyRegconfInfo:null,ldapResult:null,certifyProdList:[],isCertifyProd:!1,certifyOpLnkdCd:"",entrNo:null,entrRqstNo:null,lguMarketCd:"",lguOperatorId:"",lguJobType:"",lguJobTypeConf:"",cl02PortData:null,isSubscriptionDone:!1,isLineRegistrationDone:!1})}),{name:"dlive-certify-storage",partialize:t=>({certifyRegconfInfo:t.certifyRegconfInfo,ldapResult:t.ldapResult,entrNo:t.entrNo,entrRqstNo:t.entrRqstNo,isSubscriptionDone:t.isSubscriptionDone,isLineRegistrationDone:t.isLineRegistrationDone})})),p_=async({order:t,workerId:e,certifyRegconfInfo:n,addOnParam:r="",reason:i="",certifyType:a,contIdOld:o})=>{var c,u;if(!n)return{success:!1,code:"NO_DATA",message:" ."};try{const h=await KP({CONT_ID:t.CTRT_ID||"",CUST_ID:((c=t.customer)==null?void 0:c.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:t.SO_ID||"",REG_UID:e,CERTIFY_TYPE:a,ADDR:t.ADDR||((u=t.customer)==null?void 0:u.address)||"",BLD_NM:t.BLD_NM||"",T:n.T||"",ONT_MAC:n.ONT_MAC||"",ONT_SERIAL:n.ONT_SERIAL||"",AP_MAC:n.AP_MAC||"",DEV_ID:n.DEV_ID||"",IP:n.IP||"",PORT:n.PORT||"",MAX_SPEED:n.MAX_SPEED||"",ST:n.ST||"",EQIP_ID:n.EQIP_ID||"",EQIP_PORT_NO:n.EQIP_PORT_NO||"",EQIP_DIVS:n.EQIP_DIVS||"",SVC:t.PROD_CD||t.PROD_CD||"",ADD_ON:r,REASON:i,...o?{CONT_ID_OLD:o}:{}});return console.log("[useCertifyComplete] CL-04 :",h),h.code!=="SUCCESS"&&h.code!=="OK"?{success:!1,code:h.code,message:h.message}:{success:!0,code:h.code,message:h.message}}catch(h){return console.error("[useCertifyComplete] CL-04 :",h),{success:!1,code:"ERROR",message:h.message||"CL-04  "}}},GM=async(t,e,n)=>{var u;const r=n||t.CTRT_ID||"",i=t.SO_ID||"";let a=!1;try{const h=await $g({CTRT_ID:r,CUST_ID:((u=t.customer)==null?void 0:u.id)||t.CUST_ID||"",SO_ID:i,REG_UID:e,WRK_ID:t.id||""}),m=Array.isArray(h)?h[0]:h;m&&!m.ERROR&&m.CONT_ID===r&&(a=!0,console.log("[useCertifyComplete] CL-08  "))}catch(h){console.log("[useCertifyComplete] CL-08  :",h)}let o=!1;try{o=(await qa("CMIF006")).map(_=>_.code||_.COMMON_CD).includes(i)}catch(h){console.error("[useCertifyComplete] CMIF006  :",h)}let c="";return a&&o?c="U":!a&&o?c="C":a&&!o&&(c="D"),console.log("[useCertifyComplete] CERTIFY_TYPE:",c,"| bCl08:",a,"| SO in CMIF006:",o),{certifyType:c,bCl08:a}},_6=async(t,e)=>{var i,a;const n=t.CTRT_ID||"";let r="N";try{const o=await $g({CTRT_ID:n,CUST_ID:((i=t.customer)==null?void 0:i.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:e,WRK_ID:t.id||""}),c=Array.isArray(o)?o[0]:o;c&&!c.ERROR&&c.CONT_ID===n&&(r="Y",console.log("[useCertifyComplete] CL-08  , CERTIFY_TG=Y"))}catch(o){console.log("[useCertifyComplete] CL-08  :",o)}if(r==="Y")try{const o=await Bp({CTRT_ID:n,CUST_ID:((a=t.customer)==null?void 0:a.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:t.SO_ID||"",REG_UID:e});if(o!=null&&o.ERROR)return console.error("[useCertifyComplete] CL-06 :",o.ERROR),{success:!1,certifyTg:r,error:o.ERROR};console.log("[useCertifyComplete] CL-06  ")}catch(o){return console.error("[useCertifyComplete] CL-06  :",o),{success:!1,certifyTg:r,error:o.message}}return{success:!0,certifyTg:r}},x6=async(t,e,n)=>{var r;try{const i=await Bp({CTRT_ID:n,CUST_ID:((r=t.customer)==null?void 0:r.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:t.SO_ID||"",REG_UID:e});return i!=null&&i.ERROR?(console.error("[useCertifyComplete] CL-06 (Change) :",i.ERROR),{success:!1,error:i.ERROR}):{success:!0}}catch(i){return{success:!1,error:i.message}}},y_=async(t,e)=>{if(!(e==1||e==="1"))return!1;try{return(await qa("CMIF006")).map(a=>a.code||a.COMMON_CD).includes(t)}catch(r){return console.error("[useCertifySignal] CMIF006  :",r),!1}},Ra=({isOpen:t,onClose:e,title:n,size:r="medium",children:i,footer:a,subHeader:o})=>{if(b.useEffect(()=>{if(t){const u=window.scrollY,h={overflow:document.body.style.overflow,position:document.body.style.position,top:document.body.style.top,width:document.body.style.width};return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${u}px`,document.body.style.width="100%",()=>{document.body.style.overflow=h.overflow,document.body.style.position=h.position,document.body.style.top=h.top,document.body.style.width=h.width,window.scrollTo(0,u)}}},[t]),!t)return null;const c={small:"modal-sm",medium:"modal-md",large:"modal-lg"}[r];return s.jsx("div",{className:"base-modal-overlay",onClick:e,children:s.jsxs("div",{className:`base-modal-container ${c}`,onClick:u=>u.stopPropagation(),children:[s.jsxs("div",{className:"base-modal-header",children:[s.jsx("h2",{className:"base-modal-title",children:n}),s.jsx("button",{onClick:e,className:"base-modal-close-btn","aria-label":"",children:s.jsx(Mi,{size:18})})]}),o&&s.jsx("div",{className:"base-modal-subheader",children:o}),s.jsx("div",{className:"base-modal-body",children:i}),a&&s.jsx("div",{className:"base-modal-footer",children:a})]})})},wc=({isOpen:t,onClose:e,onSave:n,workId:r,initialData:i,workType:a,customerId:o,customerName:c,contractId:u,addrOrd:h,kpiProdGrpCd:m,prodChgGb:_,chgKpiProdGrpCd:p,prodGrp:g,wrkDtlTcd:C,readOnly:y=!1})=>{const[S,v]=b.useState({NET_CL:"",INSTL_TP:"",WRNG_TP:"",CB_INSTL_TP:"",CB_WRNG_TP:"",INOUT_LINE_TP:"N",INOUT_LEN:"",DVDR_YN:"N",BFR_LINE_YN:"N",CUT_YN:"N",TERM_NO:"",RCV_STS:"",SUBTAP_ID:"",PORT_NUM:"",EXTN_TP:"",TAB_LBL:"",CVT_LBL:"",STB_LBL:""}),[k,L]=b.useState([]),[M,P]=b.useState([]),[F,G]=b.useState([]),[B,I]=b.useState([]),[E,A]=b.useState([]),[Y,ee]=b.useState([]),[J,H]=b.useState(!1),[V,K]=b.useState(!1);b.useEffect(()=>{t&&r&&ce()},[t,r]),b.useEffect(()=>{if(i){const X=a==="02"||a==="04"||a==="08",xe={...i};X&&((!i.NET_CL||i.NET_CL.trim()==="")&&(delete xe.NET_CL,delete xe.NET_CL_NM),(!i.INSTL_TP||i.INSTL_TP.trim()==="")&&delete xe.INSTL_TP),v(fe=>({...fe,...xe}))}},[i,a]);const j=(X,xe)=>!X||!xe?-1:X.indexOf(xe),te=(X,xe,fe,Z)=>{const le=a,se=m,Re=_,be=p,De=g,re=C;console.log(" [Filter]   :",{WRK_CD:le,KPI_PROD_GRP_CD:se,PROD_CHG_GB:Re,PROD_GRP:De,WRK_DTL_TCD:re}),console.log(" [Filter]    :",{instlTpList:X.length,wrngTpList:xe.length,cbInstlTpList:fe.length,cbWrngTpList:Z.length});let me=X,ve=fe,et=Z;le==="01"||le==="03"||le==="06"||le==="07"||le==="09"?(console.log(" [Filter] :",le,"- /AS/ "),re==="0920"?(console.log(" [Filter] :",re,"- code=77 "),me=X.filter(ot=>j(ot.ref_code,se||"")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77")):(console.log(" [Filter] :",re,"- code!=77 "),me=X.filter(ot=>j(ot.ref_code,se||"")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77")),console.log(" [Filter]   :",me.length,""),De==="C"&&(re==="0920"?ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"):ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"))):le==="05"?Re==="01"?(me=X.filter(ot=>j(ot.ref_code,be||"")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"),De==="C"&&(ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"),et=Z.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"))):Re==="02"&&(me=X.filter(ot=>j(ot.ref_code,se||"")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"),De==="C"&&(ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"),et=Z.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"))):le==="04"?re==="0440"?(me=X.filter(ot=>j(ot.ref_code,se||"")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"),De==="C"&&(ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"),et=Z.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code!=="77"))):re==="0430"&&(me=X.filter(ot=>j(ot.ref_code,se||"")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"),De==="C"&&(ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"),et=Z.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"))):(me=X.filter(ot=>{const At=ot.code==="77",ct=(ot.ref_code3||"")>="20090901",Ge=se?j(ot.ref_code,se)>-1:!0;return At&&ct&&Ge}),De==="C"&&(ve=fe.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77"),et=Z.filter(ot=>j(ot.ref_code,"I")>-1&&(ot.ref_code3||"")>="20090901"&&ot.code==="77")));const Dt=xe.filter(ot=>j(ot.ref_code,se||"")>-1&&(ot.ref_code3||"")>="20090901");return console.log(" [Filter]   :",{instlTp:me.length,wrngTp:Dt.length,cbInstlTp:ve.length,cbWrngTp:et.length}),{filteredInstlTp:me,filteredWrngTp:Dt,filteredCbInstlTp:ve,filteredCbWrngTp:et}},ce=async()=>{H(!0);try{console.log(" [InstallInfoModal]   "),console.log(" [InstallInfoModal]  :",{workType:a,kpiProdGrpCd:m,prodChgGb:_,chgKpiProdGrpCd:p,prodGrp:g,wrkDtlTcd:C});const[X,xe,fe,Z,le]=await Promise.all([qa("CMCU048"),qa("BLST014"),qa("BLST010"),qa("CMCU030"),qa("CMCU046")]);console.log(" [InstallInfoModal]  :",{netCl:X.length,wrngTp:xe.length,instlTp:fe.length,cbWrngTp:Z.length,cbInstlTp:le.length}),fe.length>0&&(console.log(" [InstallInfoModal] (BLST010)    ():",fe[0]),console.log(" [InstallInfoModal]   ref_code :",{ref_code:fe[0].ref_code,ref_code2:fe[0].ref_code2,ref_code3:fe[0].ref_code3})),fe.length>1&&(console.log(" [InstallInfoModal] (BLST010)    ( ):",fe[1]),console.log(" [InstallInfoModal]   ref_code :",{ref_code:fe[1].ref_code,ref_code2:fe[1].ref_code2,ref_code3:fe[1].ref_code3}),console.log(" [InstallInfoModal]     :",Object.keys(fe[1]))),xe.length>1&&console.log(" [InstallInfoModal] (BLST014)   :",xe[1]);const se=a==="02"||a==="04"||a==="08";if(a&&(m||se)){const Re=te(fe,xe,le,Z);L(X),P(Re.filteredWrngTp),G(xe),I(Re.filteredInstlTp),A(Re.filteredCbWrngTp),ee(Re.filteredCbInstlTp),console.log(" [Filter]    - instlTp:",Re.filteredInstlTp.length,"")}else L(X),P(xe),G(xe),I(fe),A(Z),ee(le),console.log(" [Filter]    -   ");if(console.log(" [InstallInfoModal]  state  "),se){const Re=(i==null?void 0:i.NET_CL)&&i.NET_CL.trim()!=="",be=(i==null?void 0:i.INSTL_TP)&&i.INSTL_TP.trim()!=="";console.log(" [InstallInfoModal]     - hasNetCl:",Re,"hasInstlTp:",be);const De={};if(!Re&&X.length>0){console.log(" [InstallInfoModal] netCl :",X.map(ve=>({code:ve.code,name:ve.name})));const me=X.find(ve=>ve.name&&(ve.name.includes("DLIVE")||ve.name.includes("")));console.log(" [InstallInfoModal]   NET_CL:",me),me&&(De.NET_CL=me.code,De.NET_CL_NM=me.name,console.log(" [InstallInfoModal] NET_CL  :",me.code,me.name))}if(be||(De.INSTL_TP="77",console.log(" [InstallInfoModal] INSTL_TP  : 77()")),Object.keys(De).length>0&&v(me=>({...me,...De})),(be?i==null?void 0:i.INSTL_TP:"77")==="77"){const me=xe.filter(ve=>j(ve.ref_code2,"77")>-1);console.log(" [InstallInfoModal]   -  :",me.length,""),P(me)}}}catch(X){console.error(" [InstallInfoModal] Failed to load common codes:",X)}finally{H(!1)}},R=b.useMemo(()=>k.map(X=>({value:X.code,label:X.name})),[k]),O=b.useMemo(()=>B.map(X=>({value:X.code,label:X.name})),[B]),U=b.useMemo(()=>M.map(X=>({value:X.code,label:X.name})),[M]),Q=b.useMemo(()=>Y.map(X=>({value:X.code,label:X.name})),[Y]),q=b.useMemo(()=>E.map(X=>({value:X.code,label:X.name})),[E]);if(!t)return null;const $=(X,xe)=>{y||(v(fe=>({...fe,[X]:xe})),X==="INSTL_TP"&&(v(fe=>({...fe,WRNG_TP:""})),xe?de(xe):P(F)),X==="CB_INSTL_TP"&&(v(fe=>({...fe,CB_WRNG_TP:""})),xe&&ae(xe)))},de=X=>{if(console.log(" [Filter]  :",{instlTpValue:X,workType:a,prodChgGb:_,kpiProdGrpCd:m,chgKpiProdGrpCd:p}),!X||F.length===0){P(F);return}if(!m&&!p){console.log(" [Filter] KPI_PROD_GRP_CD  - ref_code2 ");const fe=F.filter(Z=>j(Z.ref_code2,X)>-1);console.log(" [Filter]   :",fe.length,""),P(fe);return}let xe=F;a==="05"?_==="01"?xe=F.filter(fe=>j(fe.ref_code2,X)>-1&&j(fe.ref_code,p||"")>-1):_==="02"?xe=F.filter(fe=>j(fe.ref_code2,X)>-1&&j(fe.ref_code,m||"")>-1):xe=F.filter(fe=>j(fe.ref_code2,X)>-1&&j(fe.ref_code,m||"")>-1):xe=F.filter(fe=>j(fe.ref_code2,X)>-1&&j(fe.ref_code,m||"")>-1),console.log(" [Filter]   :",xe.length,""),P(xe),S.WRNG_TP&&!xe.find(fe=>fe.code===S.WRNG_TP)&&v(fe=>({...fe,WRNG_TP:""}))},ae=X=>{if(console.log(" [Filter]  :",X),!X)return;const xe=E.filter(fe=>j(fe.ref_code2,X)>-1&&j(fe.ref_code,"I")>-1);console.log(" [Filter]   :",xe.length,""),A(xe)},_e=async()=>{var X;if(!S.NET_CL){alert(" .");return}if(!S.INSTL_TP){alert(" .");return}if(!S.WRNG_TP){alert(" .");return}K(!0);try{const xe=((X=k.find(le=>le.code===S.NET_CL))==null?void 0:X.name)||"",fe={...S,NET_CL_NM:xe},Z=await mA({WRK_ID:r,CTRT_ID:u||"",ADDR_ORD:h||"",WRK_DTL_TCD:C||"",...S});Z.code==="SUCCESS"?(n(fe),e()):alert(Z.message||" .")}catch(xe){console.error("Save failed:",xe),alert(xe.message||"     .")}finally{K(!1)}},ie=J?null:s.jsxs("div",{className:"install-subheader",children:[s.jsxs("div",{className:"info-row whitespace-nowrap",children:[s.jsx("span",{className:"info-label",children:"ID:"}),s.jsx("span",{className:"info-value",children:Xi(o)})]}),s.jsxs("div",{className:"info-row whitespace-nowrap",children:[s.jsx("span",{className:"info-label",children:":"}),s.jsx("span",{className:"info-value",children:c||"-"})]}),s.jsxs("div",{className:"info-row whitespace-nowrap",children:[s.jsx("span",{className:"info-label",children:"ID:"}),s.jsx("span",{className:"info-value",children:Xi(u)})]})]}),Ne=y?s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:e,children:""}):s.jsx("button",{className:"btn btn-primary btn-sm",onClick:_e,disabled:J||V,children:V?" ...":""});return s.jsx(Ra,{isOpen:t,onClose:e,title:a==="02"||a==="04"||a==="08"||a==="09"?"":"",size:"medium",subHeader:ie,footer:Ne,children:s.jsx("div",{className:"install-modal-content",children:J?s.jsxs("div",{className:"loading-message",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"  ..."})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"install-info-section",children:[s.jsxs("div",{className:"install-form-row",children:[s.jsxs("label",{className:"install-label",children:[" ",!y&&s.jsx("span",{className:"required",children:"*"})]}),s.jsx(sn,{value:S.NET_CL||"",onValueChange:X=>$("NET_CL",X),options:R,placeholder:"",required:!y,disabled:y})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsxs("label",{className:"install-label",children:[" ",!y&&s.jsx("span",{className:"required",children:"*"})]}),s.jsx(sn,{value:S.INSTL_TP||"",onValueChange:X=>$("INSTL_TP",X),options:O,placeholder:"",required:!y,disabled:y})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsxs("label",{className:"install-label",children:[" ",!y&&s.jsx("span",{className:"required",children:"*"})]}),s.jsx(sn,{value:S.WRNG_TP||"",onValueChange:X=>$("WRNG_TP",X),options:U,placeholder:S.INSTL_TP?"":"  ",disabled:y||!S.INSTL_TP,required:!y})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsx("label",{className:"install-label",children:""}),s.jsx(sn,{value:S.CB_INSTL_TP||"",onValueChange:X=>$("CB_INSTL_TP",X),options:Q,placeholder:"",disabled:!0})]}),s.jsxs("div",{className:"install-form-row",children:[s.jsx("label",{className:"install-label",children:""}),s.jsx(sn,{value:S.CB_WRNG_TP||"",onValueChange:X=>$("CB_WRNG_TP",X),options:q,placeholder:"",disabled:!0})]}),s.jsxs("div",{className:"install-form-row-inline",children:[s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:S.INOUT_LINE_TP==="Y",onChange:X=>$("INOUT_LINE_TP",X.target.checked?"Y":"N"),disabled:y}),s.jsx("span",{children:""})]}),s.jsxs("div",{className:"install-inline-group",children:[s.jsx("label",{className:"install-inline-label",children:""}),s.jsx("input",{type:"text",className:"install-input-inline",value:S.INOUT_LEN||"",onChange:X=>$("INOUT_LEN",X.target.value),disabled:y})]})]}),s.jsxs("div",{className:"install-form-row-inline",children:[s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:S.DVDR_YN==="Y",onChange:X=>$("DVDR_YN",X.target.checked?"Y":"N"),disabled:y}),s.jsx("span",{children:""})]}),a==="02"||a==="08"?s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:S.CUT_YN==="Y",onChange:X=>$("CUT_YN",X.target.checked?"Y":"N"),disabled:y}),s.jsx("span",{children:""})]}):s.jsxs("label",{className:"install-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:S.BFR_LINE_YN==="Y",onChange:X=>$("BFR_LINE_YN",X.target.checked?"Y":"N"),disabled:y}),s.jsx("span",{children:""})]})]})]})})})})},el=({isOpen:t,onClose:e,ctrtId:n,custId:r})=>{const[i,a]=b.useState([]),[o,c]=b.useState(!1),[u,h]=b.useState(null),m=S=>{const v=S.getFullYear(),k=String(S.getMonth()+1).padStart(2,"0"),L=String(S.getDate()).padStart(2,"0");return`${v}${k}${L}`},_=(S,v)=>{const k=new Date(S);return k.setDate(k.getDate()+v),k},p=S=>{if(!S||S.length<14)return S;const v=S.substring(0,4),k=S.substring(4,6),L=S.substring(6,8),M=S.substring(8,10),P=S.substring(10,12),F=S.substring(12,14);return`${v}-${k}-${L} ${M}:${P}:${F}`},g=async()=>{if(!n){console.error("[] ID ");return}c(!0),h(null);try{const S=new Date,v=m(_(S,-7)),k=m(_(S,1));console.log("[]  :",{ctrtId:n,custId:r,startDate:v,endDate:k});const L=typeof window<"u"?window.location.origin:"http://localhost:3000",M=await fetch(`${Ns}/integration/history`,{method:"POST",headers:{"Content-Type":"application/json",Origin:L},credentials:"include",body:JSON.stringify({CTRT_ID:n,CUST_ID:r||"",STRT_DTTM1:v,STRT_DTTM2:k})});if(!M.ok)throw new Error(`API  : ${M.status}`);const P=await M.json();console.log("[] API :",P);const F=P.output||P.ds_svc_dtl||[];a(Array.isArray(F)?F:[]),console.log("[]  :",F.length,"")}catch(S){console.error("[]  :",S),h(S instanceof Error?S.message:"   ")}finally{c(!1)}};b.useEffect(()=>{t&&n&&g()},[t,n]);const C=s.jsxs("div",{className:"text-xs text-gray-700 space-y-0.5",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-600",children:"ID:"})," ",s.jsx("span",{className:"font-medium text-blue-700",children:Xi(n)})]}),s.jsx("div",{className:"text-gray-600",children:":  7"})]}),y=s.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:""});return s.jsx(Ra,{isOpen:t,onClose:e,title:"",size:"medium",subHeader:C,footer:y,children:s.jsxs("div",{children:[o&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:" ..."})}),u&&s.jsx("div",{className:"flex items-center justify-center py-8 px-4",children:s.jsx("div",{className:"text-red-500 text-xs text-center",children:u})}),!o&&!u&&i.length===0&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:" "})}),!o&&!u&&i.length>0&&s.jsx("div",{className:"space-y-2.5 p-2.5",children:i.map((S,v)=>s.jsx("div",{className:`rounded-lg border shadow-sm p-2.5 ${v%2===0?"bg-white border-gray-200":"bg-gray-50 border-gray-200"}`,children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",S.prod_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"ID:"})," ",Xi(S.ctrt_id)]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",S.msg_id_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",S.proc_rslt_cd_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",S.rslt_cd_nm||"-"]})}),s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",S.strt_dttm?p(S.strt_dttm):"-"]})})]})},v))})]})})},RE=[{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"()",label:"()"},{value:"()",label:"()"},{value:"()",label:"()"},{value:"99",label:"()"}],p6=[{value:"01",label:"HDMI1"},{value:"02",label:"HDMI2"},{value:"03",label:"HDMI3"},{value:"04",label:"HDMI4"},{value:"05",label:""},{value:"06",label:"1"},{value:"07",label:"2"},{value:"08",label:"3"},{value:"09",label:"4"},{value:"11",label:"RF "}],_m=({isOpen:t,onClose:e,onSave:n,workId:r,ctrtId:i,prodGrp:a,initialInstlLoc:o,initialViewModCd:c,initialViewModNm:u,showToast:h,readOnly:m=!1})=>{const[_,p]=b.useState(""),[g,C]=b.useState(""),[y,S]=b.useState(""),[v,k]=b.useState(p6),L=a==="D";b.useEffect(()=>{t&&L&&(async()=>{try{const G=await qa("CMWO048");if(console.log("[InstallLocationModal] API  :",G),G&&G.length>0){const B=G.map(I=>({value:I.code||I.COMMON_CD||"",label:I.name||I.COMMON_CD_NM||""})).filter(I=>I.value&&I.label);B.length>0?(k(B),console.log("[InstallLocationModal]    :",B)):console.log("[InstallLocationModal]   ,  ")}}catch(G){console.error("[InstallLocationModal]    ,  :",G)}})()},[t,L]),b.useEffect(()=>{if(t){if(o){const F=RE.find(G=>G.value===o||G.label===o);F&&F.value!=="99"?(p(F.value),C("")):(p("99"),C(o))}else p(""),C("");S(c||"")}},[t,o,c]);const M=()=>!_||_==="[]"?" .":_==="99"&&!g.trim()?"   . ()":L&&(!y||y==="[]")?" .":null,P=async()=>{var E;const F=M();if(F){h?h(F,"warning"):alert(F);return}const G=_==="99"?g:_,B=((E=v.find(A=>A.value===y))==null?void 0:E.label)||"",I=L&&y?`${G}${y}`:G;h&&h(".","success"),n({INSTL_LOC:G,VIEW_MOD_CD:y,VIEW_MOD_NM:B,INSTL_LOC_FULL:I}),e()};return t?s.jsxs(Ra,{isOpen:t,onClose:e,title:"(, )",size:"md",children:[s.jsxs("div",{className:"space-y-5 p-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!m&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:_,onValueChange:F=>{m||(p(F),F!=="99"&&C(""))},options:RE,placeholder:" ",required:!m,disabled:m})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:["  ",!m&&_==="99"&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:g,onChange:F=>!m&&C(F.target.value),placeholder:_==="99"?", ,     ":"    ",disabled:m||_!=="99",maxLength:512,rows:3,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border rounded-lg text-sm sm:text-base resize-none
              ${m?"border-gray-200 bg-gray-100 text-gray-700 cursor-not-allowed":_==="99"?"border-gray-300 bg-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500":"border-gray-200 bg-gray-100 text-gray-500 cursor-not-allowed"}`}),!m&&s.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:"* "})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!m&&L&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:y,onValueChange:F=>!m&&S(F),options:v,placeholder:" ",disabled:m||!L,required:!m&&L}),!m&&!L&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"DTV    ."})]})]}),s.jsxs("div",{className:"flex gap-2 sm:gap-3 p-3 sm:p-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:e,className:"py-2 sm:py-3 px-3 sm:px-4 font-semibold rounded-lg transition-colors text-sm sm:text-base flex-1 bg-gray-200 text-gray-700 hover:bg-gray-300",children:""}),!m&&s.jsx("button",{type:"button",onClick:P,className:"flex-1 py-2 sm:py-3 px-3 sm:px-4 bg-cyan-600 text-white font-semibold rounded-lg hover:bg-cyan-700 transition-colors text-sm sm:text-base",children:""})]})]}):null},iN=({isOpen:t,onClose:e,onSave:n,wrkId:r,wrkDrctnId:i,crrId:a,wrkrId:o,dataType:c,showToast:u,readOnly:h=!1})=>{const[m,_]=b.useState(""),[p,g]=b.useState([]),[C,y]=b.useState(""),[S,v]=b.useState(!1),[k,L]=b.useState(!1);b.useEffect(()=>{t&&r&&i&&(M(),c==="C"&&P())},[t,r,i,c]);const M=async()=>{try{const E=await v1({WRK_ID:r,WRK_DRCTN_ID:i,DATA_TYPE:c});E!=null&&E.EQT_SERNO&&_(E.EQT_SERNO)}catch(E){console.error("[OttSerialModal]    :",E)}},P=async()=>{try{const E=await jA({WRK_ID:r});E!=null&&E.OTT_TYPE?y(E.OTT_TYPE):(u==null||u("OTT BOX   .      .","warning"),e())}catch(E){console.error("[OttSerialModal] OTT   :",E)}},F=async()=>{if(!m.trim()){u==null||u("OTT BOX  .","warning");return}L(!0);try{const E={EQT_SERNO:m,DATA_TYPE:c};c==="C"&&(E.CRR_ID=a||"",E.OTT_TYPE=C,E.WRKR_ID=o||"");const A=await IA(E),Y=c==="C"?A.filter(ee=>ee.EQT_STAT==="OK"):A;g(Y),Y.length===0&&(u==null||u("  .","info"))}catch(E){console.error("[OttSerialModal]   :",E),u==null||u("    .","error")}finally{L(!1)}},G=E=>{_(E.EQT_SERNO||"")},B=async()=>{if(!m.trim()){u==null||u("OTT BOX  .","warning");return}if(c==="C"&&p.length<1){u==null||u("    .","warning");return}v(!0);try{const E=localStorage.getItem("userInfo"),A=E?JSON.parse(E):{},Y=await MA({WRK_ID:r,WRK_DRCTN_ID:i,EQT_SERNO:m,DATA_TYPE:c,REG_UID:A.userId||""});Y.code==="SUCCESS"||Y.code==="OK"?(u==null||u("OTT  .","success"),n(m),e()):u==null||u(Y.message||" .","error")}catch(E){console.error("[OttSerialModal]  :",E),u==null||u(E.message||"   .","error")}finally{v(!1)}},I=E=>{E.key==="Enter"&&(E.preventDefault(),F())};return s.jsx(Ra,{isOpen:t,onClose:e,title:c==="C"?" OTT  ":"OTT  ",maxWidth:"md",children:s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"BOX S/N"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:m,onChange:E=>_(E.target.value),onKeyDown:I,placeholder:" ",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",readOnly:h,disabled:h}),s.jsxs("button",{onClick:F,disabled:k||h,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center gap-2 disabled:bg-gray-300",children:[k?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(Yu,{className:"w-4 h-4"}),s.jsx("span",{children:""})]})]})]}),c==="C"&&C&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),s.jsx("input",{type:"text",value:C,readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-600"})]}),p.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"  ( )"}),s.jsx("div",{className:"border border-gray-300 rounded-lg max-h-48 overflow-y-auto",children:p.map((E,A)=>s.jsxs("div",{onClick:()=>!h&&G(E),className:`px-4 py-3 border-b last:border-b-0 cursor-pointer transition-colors ${m===E.EQT_SERNO?"bg-blue-50 text-blue-700":"hover:bg-gray-50"} ${h?"cursor-not-allowed":""}`,children:[s.jsx("span",{className:"font-medium",children:E.EQT_SERNO}),E.EQT_STAT&&s.jsx("span",{className:`ml-2 text-xs px-2 py-0.5 rounded ${E.EQT_STAT==="OK"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:E.EQT_STAT})]},A))})]}),s.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[!h&&s.jsx("button",{onClick:B,disabled:S||!m.trim(),className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed",children:S?" ...":""}),s.jsx("button",{onClick:e,className:"flex-1 py-3 bg-gray-500 hover:bg-gray-600 text-white font-semibold rounded-lg",children:h?"":""})]})]})})},y6=[{value:"0",label:""},{value:"1",label:" "},{value:"2",label:" "},{value:"3",label:" "}],b_=({isOpen:t,onClose:e,onSave:n,soId:r})=>{const[i,a]=b.useState("");b.useEffect(()=>{t&&a("")},[t]);const o=()=>{if(!i){alert("  .");return}n({POLE_YN:i,LAN_GB:""})};return t?s.jsxs(Ra,{isOpen:t,onClose:e,title:"",size:"sm",children:[s.jsx("div",{className:"space-y-5 p-4",children:s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:i,onValueChange:a,options:y6,placeholder:"",required:!0})]})}),s.jsxs("div",{className:"flex gap-2 sm:gap-3 p-3 sm:p-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 py-2 sm:py-3 px-3 sm:px-4 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition-colors text-sm sm:text-base",children:""}),s.jsx("button",{type:"button",onClick:o,className:"flex-1 py-2 sm:py-3 px-3 sm:px-4 bg-cyan-600 text-white font-semibold rounded-lg hover:bg-cyan-700 transition-colors text-sm sm:text-base",children:""})]})]}):null},Ba=({isOpen:t,onClose:e,onConfirm:n,title:r,message:i,type:a="confirm",confirmText:o="",cancelText:c="",showCancel:u=!0,children:h})=>{if(!t)return null;const m=()=>{switch(a){case"warning":return s.jsx(go,{className:"w-12 h-12 text-yellow-500"});case"error":return s.jsx(tc,{className:"w-12 h-12 text-red-500"});case"info":return s.jsx(NM,{className:"w-12 h-12 text-blue-500"});case"confirm":default:return s.jsx(ea,{className:"w-12 h-12 text-green-500"})}},_=()=>{switch(a){case"warning":return"bg-yellow-50 border-yellow-200";case"error":return"bg-red-50 border-red-200";case"info":return"bg-blue-50 border-blue-200";case"confirm":default:return"bg-green-50 border-green-200"}},p=()=>{switch(a){case"warning":return"bg-yellow-500 hover:bg-yellow-600";case"error":return"bg-red-500 hover:bg-red-600";case"info":return"bg-blue-500 hover:bg-blue-600";case"confirm":default:return"bg-blue-500 hover:bg-blue-600"}},g=()=>{n(),e()};return s.jsxs("div",{className:"fixed inset-0 z-[300] flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-[90%] max-w-sm mx-4 overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:`px-4 sm:px-6 py-4 sm:py-5 flex flex-col items-center border-b ${_()}`,children:[m(),r&&s.jsx("h3",{className:"mt-2 sm:mt-3 text-base sm:text-lg font-bold text-gray-900 text-center",children:r})]}),s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-5 max-h-[60vh] overflow-y-auto",children:[h,s.jsx("p",{className:"text-center text-gray-700 whitespace-pre-line text-sm sm:text-base",children:i})]}),s.jsxs("div",{className:"px-3 sm:px-4 py-3 sm:py-4 bg-gray-50 flex gap-2 sm:gap-3",children:[u&&s.jsx("button",{onClick:e,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors text-sm sm:text-base",children:c}),s.jsx("button",{onClick:g,className:`flex-1 px-3 sm:px-4 py-2 sm:py-3 text-white rounded-lg font-semibold transition-colors text-sm sm:text-base ${p()}`,children:o})]})]})]})},TE={isOpen:!1,message:"",title:void 0,type:"confirm",onConfirm:()=>{}},b6={"01":"","02":"","03":"A/S","04":"","05":"","06":"","07":"","08":"","09":""},C6={11:"",22:"",33:"",44:"IF",55:"FTTB",66:"FTTH",77:"",88:""},Td=({workType:t,workTypeName:e,custRel:n,custRelName:r,networkType:i,networkTypeName:a,installType:o,installTypeName:c,installedEquipments:u,removedEquipments:h,installLocation:m,upCtrlCl:_,upCtrlClName:p,memo:g,kpiProdGrp:C,kpiProdGrpName:y,obsRcptCd:S,obsRcptCdName:v,obsRcptDtlCd:k,obsRcptDtlCdName:L,extraItems:M=[],equipmentData:P,installInfoData:F,order:G,custRelOptions:B,installLocationText:I})=>{var q;const E=t||(G==null?void 0:G.WRK_CD)||"",A=e||(G==null?void 0:G.WRK_CD_NM)||b6[E]||"",Y=r||((q=B==null?void 0:B.find($=>$.value===n))==null?void 0:q.label),ee=i||(F==null?void 0:F.networkType)||(F==null?void 0:F.NET_CL),J=a||(F==null?void 0:F.networkTypeName)||(F==null?void 0:F.NET_CL_NM),H=o||(F==null?void 0:F.installType)||(F==null?void 0:F.INSTL_TP),V=c||(F==null?void 0:F.installTypeName)||(F==null?void 0:F.INSTL_TP_NM),K=_||(F==null?void 0:F.upCtrlCl),j=p||(F==null?void 0:F.upCtrlClName),te=u||(P==null?void 0:P.installedEquipments)||[],ce=h||(P==null?void 0:P.removedEquipments)||[],R=m||(F?{floor:F.floor,room:F.room,position:F.position}:void 0),O=$=>{var de,ae,_e,ie,Ne,X,xe,fe;return(de=$.contractEquipment)!=null&&de.EQT_NM?$.contractEquipment.EQT_NM:(ae=$.contractEquipment)!=null&&ae.eqtNm?$.contractEquipment.eqtNm:(_e=$.contractEquipment)!=null&&_e.type?$.contractEquipment.type:(ie=$.contractEquipment)!=null&&ie.ITEM_MID_NM?$.contractEquipment.ITEM_MID_NM:(Ne=$.actualEquipment)!=null&&Ne.EQT_NM?$.actualEquipment.EQT_NM:(X=$.actualEquipment)!=null&&X.eqtNm?$.actualEquipment.eqtNm:(xe=$.actualEquipment)!=null&&xe.type?$.actualEquipment.type:(fe=$.actualEquipment)!=null&&fe.ITEM_MID_NM?$.actualEquipment.ITEM_MID_NM:$.EQT_NM?$.EQT_NM:$.eqtNm?$.eqtNm:$.type?$.type:$.ITEM_MID_NM?$.ITEM_MID_NM:$.name||""},U=$=>{var de,ae,_e,ie,Ne;return(de=$.actualEquipment)!=null&&de.EQT_SERNO?$.actualEquipment.EQT_SERNO:(ae=$.actualEquipment)!=null&&ae.eqtSerno?$.actualEquipment.eqtSerno:(_e=$.actualEquipment)!=null&&_e.serialNumber?$.actualEquipment.serialNumber:(ie=$.contractEquipment)!=null&&ie.EQT_SERNO?$.contractEquipment.EQT_SERNO:(Ne=$.contractEquipment)!=null&&Ne.serialNumber?$.contractEquipment.serialNumber:$.EQT_SERNO?$.EQT_SERNO:$.eqtSerno?$.eqtSerno:$.serialNumber?$.serialNumber:""},Q=I||R&&[R.floor,R.room,R.position].filter(Boolean).join(" / ")||"-";return s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-blue-200",children:[s.jsx(ea,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"font-bold text-blue-800 text-sm",children:" "}),s.jsx("span",{className:"text-xs text-blue-600 ml-auto",children:A})]}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(o0,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:`font-medium ${n?"text-gray-900":"text-red-500"}`,children:Y||n||""})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(kp,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:`font-medium ${ee?"text-gray-900":"text-red-500"}`,children:J||ee||""})]}),H&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gu,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:V||C6[H]||H})]}),K&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(kp,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:j||K})]}),Q!=="-"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ed,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900 truncate max-w-[180px]",children:Q})]}),C&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rm,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:"KPI"}),s.jsx("span",{className:"font-medium text-gray-900",children:y||C})]}),S&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gu,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsxs("span",{className:"font-medium text-gray-900",children:[v||S,k&&` > ${L||k}`]})]}),(te.length>0||ce.length>0)&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(rm,{className:"w-3.5 h-3.5 text-gray-500"}),s.jsx("span",{className:"text-gray-600 font-medium",children:""})]}),s.jsxs("div",{className:"space-y-2",children:[te.length>0&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-2",children:[s.jsx("div",{className:"mb-1.5",children:s.jsx("span",{className:"text-green-600 font-semibold text-xs",children:""})}),s.jsx("div",{className:"space-y-1",children:te.map(($,de)=>s.jsxs("div",{className:"text-green-700",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-green-500 font-bold",children:"+"}),s.jsx("span",{className:"font-medium text-xs",children:O($)})]}),U($)&&s.jsxs("div",{className:"ml-4 text-green-600/70 text-[0.625rem] break-all",children:["S/N: ",U($)]})]},`install-${de}`))})]}),ce.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2",children:[s.jsx("div",{className:"mb-1.5",children:s.jsx("span",{className:"text-red-600 font-semibold text-xs",children:""})}),s.jsx("div",{className:"space-y-1",children:ce.map(($,de)=>s.jsxs("div",{className:"text-red-700",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-red-500 font-bold",children:"-"}),s.jsx("span",{className:"font-medium text-xs",children:O($)})]}),U($)&&s.jsxs("div",{className:"ml-4 text-red-600/70 text-[0.625rem] break-all",children:["S/N: ",U($)]})]},`remove-${de}`))})]})]})]}),M.map(($,de)=>s.jsxs("div",{className:"flex items-center gap-2",children:[$.icon||s.jsx($h,{className:"w-3.5 h-3.5 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 w-16",children:$.label}),s.jsx("span",{className:`font-medium ${$.isWarning?"text-orange-600":"text-gray-900"}`,children:$.value||"-"})]},de)),g&&s.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx($h,{className:"w-3.5 h-3.5 text-gray-500 mt-0.5"}),s.jsx("span",{className:"text-gray-600 w-16",children:""}),s.jsx("span",{className:"font-medium text-gray-900 flex-1 break-all line-clamp-2",children:g})]})})]})]})},ta=D1()(R1((t,e)=>({currentWorkId:null,workSteps:{},currentStep:1,workItem:null,equipmentData:null,filteringData:null,removalLineData:null,setCurrentWorkId:n=>{const{workSteps:r}=e(),i=n&&r[n]||1;t({currentWorkId:n,currentStep:i})},setCurrentStep:n=>t(r=>{const i=typeof n=="function"?n(r.currentStep):n,a={...r.workSteps};return r.currentWorkId&&(a[r.currentWorkId]=i),{currentStep:i,workSteps:a}}),setWorkItem:n=>t({workItem:n}),setEquipmentData:n=>t({equipmentData:n}),setFilteringData:n=>t({filteringData:n}),setRemovalLineData:n=>t({removalLineData:n}),getStepForWork:n=>{const{workSteps:r}=e();return r[n]||1},reset:()=>t({currentWorkId:null,workSteps:{},currentStep:1,workItem:null,equipmentData:null,filteringData:null,removalLineData:null}),resetWork:n=>t(r=>{const i={...r.workSteps};return delete i[n],{workSteps:i}}),clearPreviousWorkDraft:n=>{const{currentWorkId:r,workSteps:i}=e();if(r&&r!==n){console.log(`[WorkProcessStore]  (${r}) draft `);try{localStorage.removeItem(`work_complete_draft_${r}`),localStorage.removeItem(`equipment_draft_${r}`),console.log("localStorage draft  ")}catch(o){console.error("localStorage  :",o)}const a={...i};delete a[r],t({currentWorkId:n,workSteps:a,currentStep:a[n]||1,workItem:null,equipmentData:null,filteringData:null,removalLineData:null})}else{const a=i[n]||1;t({currentWorkId:n,currentStep:a})}}}),{name:"dlive-work-process-storage",partialize:t=>({workSteps:t.workSteps,currentWorkId:t.currentWorkId,filteringData:t.filteringData,equipmentData:t.equipmentData,removalLineData:t.removalLineData})})),zi=()=>({contractEquipments:[],technicianEquipments:[],customerEquipments:[],removeEquipments:[],installedEquipments:[],removalStatus:{},markedForRemoval:[],pendingLossStatusList:[],reuseAll:!1,selectedContract:null,selectedStock:null,signalStatus:"idle",signalResult:"",filteringData:{},lastUpdated:null,isDataLoaded:!1}),ki=D1()(R1((t,e)=>({workStates:{},currentWorkId:null,initWorkState:n=>{t(r=>r.workStates[n]?r:{...r,workStates:{...r.workStates,[n]:zi()}})},setCurrentWorkId:n=>{t(r=>{const i={...r.workStates};return n&&!i[n]&&(i[n]=zi()),{...r,currentWorkId:n,workStates:i}})},clearWorkState:n=>{t(r=>{const i={...r.workStates};return delete i[n],{...r,workStates:i}})},clearAllWorkStates:()=>{t({workStates:{},currentWorkId:null})},setApiData:(n,r)=>{var i,a,o,c,u,h;console.log("[Equipment Store] API  ",{workId:n,:((i=r.contractEquipments)==null?void 0:i.length)??0,:((a=r.technicianEquipments)==null?void 0:a.length)??0,:((o=r.customerEquipments)==null?void 0:o.length)??0,:((c=r.removeEquipments)==null?void 0:c.length)??0,:{contractEquipments:(u=r.contractEquipments)==null?void 0:u.map(m=>({id:m.id,model:m.model,type:m.type})),removeEquipments:(h=r.removeEquipments)==null?void 0:h.map(m=>({id:m.id,model:m.model,EQT_NO:m.EQT_NO}))}}),t(m=>{const p={...m.workStates[n]||zi(),lastUpdated:new Date().toISOString()};return r.contractEquipments!==void 0&&(p.contractEquipments=r.contractEquipments),r.technicianEquipments!==void 0&&(p.technicianEquipments=r.technicianEquipments),r.customerEquipments!==void 0&&(p.customerEquipments=r.customerEquipments),r.removeEquipments!==void 0&&(p.removeEquipments=r.removeEquipments),r.filteringData!==void 0&&(p.filteringData=r.filteringData),{...m,workStates:{...m.workStates,[n]:p}}})},addInstalledEquipment:(n,r)=>{t(i=>{const a=i.workStates[n]||zi(),o=a.installedEquipments.findIndex(u=>u.contractEquipment.id===r.contractEquipment.id);let c;return o>=0?(c=[...a.installedEquipments],c[o]=r):c=[...a.installedEquipments,r],console.log("[Equipment Store]  ",{workId:n,action:o>=0?"":"",equipment:{contractId:r.contractEquipment.id,contractModel:r.contractEquipment.model,actualId:r.actualEquipment.id,actualModel:r.actualEquipment.model,EQT_CHG_GB:r.actualEquipment.EQT_CHG_GB},:c.length}),{...i,workStates:{...i.workStates,[n]:{...a,installedEquipments:c,lastUpdated:new Date().toISOString()}}}})},removeInstalledEquipment:(n,r)=>{t(i=>{const a=i.workStates[n];if(!a)return i;const o=a.installedEquipments.find(u=>u.contractEquipment.id===r),c=a.installedEquipments.filter(u=>u.contractEquipment.id!==r);return console.log("[Equipment Store]   ",{workId:n,removed:o?{contractId:o.contractEquipment.id,actualId:o.actualEquipment.id,model:o.actualEquipment.model}:null,:c.length}),{...i,workStates:{...i.workStates,[n]:{...a,installedEquipments:c,lastUpdated:new Date().toISOString()}}}})},updateInstalledEquipment:(n,r,i)=>{t(a=>{const o=a.workStates[n];if(!o)return a;const c=o.installedEquipments.findIndex(h=>h.contractEquipment.id===r);if(c<0)return a;const u=[...o.installedEquipments];return u[c]={...u[c],...i},{...a,workStates:{...a.workStates,[n]:{...o,installedEquipments:u,lastUpdated:new Date().toISOString()}}}})},setInstalledEquipments:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,installedEquipments:r,lastUpdated:new Date().toISOString()}}}})},clearInstalledEquipments:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,installedEquipments:[],lastUpdated:new Date().toISOString()}}}:r})},setRemovalStatus:(n,r,i,a)=>{t(o=>{const c=o.workStates[n]||zi(),u=c.removalStatus[r]||{};return{...o,workStates:{...o.workStates,[n]:{...c,removalStatus:{...c.removalStatus,[r]:{...u,[i]:a}},lastUpdated:new Date().toISOString()}}}})},toggleRemovalStatus:(n,r,i)=>{t(a=>{const o=a.workStates[n]||zi(),c=o.removalStatus[r]||{},h=(c[i]||"0")==="1"?"0":"1";return console.log("[Equipment Store] / ",{workId:n,eqtNo:r,field:{EQT_LOSS_YN:"",PART_LOSS_BRK_YN:"/",EQT_BRK_YN:"",EQT_CABL_LOSS_YN:"",EQT_CRDL_LOSS_YN:""}[i]||i,:h==="1"?"Y":"N",:{...c,[i]:h}}),{...a,workStates:{...a.workStates,[n]:{...o,removalStatus:{...o.removalStatus,[r]:{...c,[i]:h}},lastUpdated:new Date().toISOString()}}}})},setFullRemovalStatus:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,removalStatus:r,lastUpdated:new Date().toISOString()}}}})},clearRemovalStatus:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,removalStatus:{},lastUpdated:new Date().toISOString()}}}:r})},addMarkedForRemoval:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();if(a.markedForRemoval.some(u=>u.id===r.id))return i;const c=[...a.markedForRemoval,r];return console.log("[Equipment Store]  ",{workId:n,equipment:{id:r.id,model:r.model,serialNumber:r.serialNumber,itemMidCd:r.itemMidCd},:c.length}),{...i,workStates:{...i.workStates,[n]:{...a,markedForRemoval:c,lastUpdated:new Date().toISOString()}}}})},removeMarkedForRemoval:(n,r)=>{t(i=>{const a=i.workStates[n];if(!a)return i;const o=a.markedForRemoval.find(u=>u.id===r),c=a.markedForRemoval.filter(u=>u.id!==r);return console.log("[Equipment Store]  ",{workId:n,removed:o?{id:o.id,model:o.model}:null,:c.length}),{...i,workStates:{...i.workStates,[n]:{...a,markedForRemoval:c,lastUpdated:new Date().toISOString()}}}})},setMarkedForRemoval:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return console.log("[Equipment Store]   ",{workId:n,:r.length,:r.map(o=>({id:o.id,model:o.model}))}),{...i,workStates:{...i.workStates,[n]:{...a,markedForRemoval:r,lastUpdated:new Date().toISOString()}}}})},clearMarkedForRemoval:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,markedForRemoval:[],lastUpdated:new Date().toISOString()}}}:r})},addPendingLossStatus:(n,r)=>{t(i=>{const a=i.workStates[n]||zi(),o=a.pendingLossStatusList.filter(c=>c.EQT_SERNO!==r.EQT_SERNO);return{...i,workStates:{...i.workStates,[n]:{...a,pendingLossStatusList:[...o,r],lastUpdated:new Date().toISOString()}}}})},setPendingLossStatusList:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,pendingLossStatusList:r,lastUpdated:new Date().toISOString()}}}})},clearPendingLossStatusList:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,pendingLossStatusList:[],lastUpdated:new Date().toISOString()}}}:r})},setReuseAll:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return console.log("[Equipment Store]   ",{workId:n,value:r?"Y":"N"}),{...i,workStates:{...i.workStates,[n]:{...a,reuseAll:r,lastUpdated:new Date().toISOString()}}}})},setSelectedContract:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,selectedContract:r}}}})},setSelectedStock:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,selectedStock:r}}}})},clearSelection:n=>{t(r=>{const i=r.workStates[n];return i?{...r,workStates:{...r.workStates,[n]:{...i,selectedContract:null,selectedStock:null}}}:r})},setSignalStatus:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,signalStatus:r}}}})},setSignalResult:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,signalResult:r}}}})},setDataLoaded:(n,r)=>{t(i=>{const a=i.workStates[n]||zi();return{...i,workStates:{...i.workStates,[n]:{...a,isDataLoaded:r}}}})},getCurrentWorkState:()=>{const{currentWorkId:n,workStates:r}=e();return n&&r[n]||null},getWorkState:n=>e().workStates[n]||null}),{name:"dlive-work-equipment-storage",partialize:t=>({workStates:Object.fromEntries(Object.entries(t.workStates).map(([e,n])=>[e,{installedEquipments:n.installedEquipments,removalStatus:n.removalStatus,markedForRemoval:n.markedForRemoval,pendingLossStatusList:n.pendingLossStatusList,reuseAll:n.reuseAll,signalStatus:n.signalStatus,signalResult:n.signalResult,filteringData:n.filteringData,lastUpdated:n.lastUpdated}])),currentWorkId:t.currentWorkId}),merge:(t,e)=>{const n={...e};if(t!=null&&t.workStates){n.workStates={};for(const[r,i]of Object.entries(t.workStates))n.workStates[r]={...zi(),...i}}return t!=null&&t.currentWorkId&&(n.currentWorkId=t.currentWorkId),n}})),ME={workId:null,state:null,isReady:!1,contractEquipments:[],technicianEquipments:[],customerEquipments:[],removeEquipments:[],installedEquipments:[],removalStatus:{},markedForRemoval:[],pendingLossStatusList:[],selectedContract:null,selectedStock:null,signalStatus:"idle",signalResult:"",filteringData:{}},xa=t=>{const e=ki(n=>t?n.workStates[t]??null:null);return t?e?{workId:t,state:e,isReady:e.isDataLoaded??!1,contractEquipments:e.contractEquipments??[],technicianEquipments:e.technicianEquipments??[],customerEquipments:e.customerEquipments??[],removeEquipments:e.removeEquipments??[],installedEquipments:e.installedEquipments??[],removalStatus:e.removalStatus??{},markedForRemoval:e.markedForRemoval??[],pendingLossStatusList:e.pendingLossStatusList??[],selectedContract:e.selectedContract??null,selectedStock:e.selectedStock??null,signalStatus:e.signalStatus??"idle",signalResult:e.signalResult??"",filteringData:e.filteringData??{}}:{...ME,workId:t}:ME},Md=()=>{const t=z2();return Pw({mutationFn:e=>fA(e),onSuccess:e=>(t.invalidateQueries({queryKey:["workOrders"]}),console.log(" [useCompleteWork]    -    "),e),onError:e=>{console.error(" [useCompleteWork]   :",e)}})},JC=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1,certifyReason:c})=>{var Ft,_t,qt,jt;const u=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[h,m]=b.useState(""),[_,p]=b.useState(!1),g=h==="0"||h==="1"||h==="4",[C,y]=b.useState(!1),{equipmentData:S,filteringData:v}=ta(),{certifyRegconfInfo:k}=Za(),L=t.id||"",M=xa(L),P={...S||i||v||{},installedEquipments:M.installedEquipments.length>0?M.installedEquipments:(S==null?void 0:S.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:M.markedForRemoval.length>0?M.markedForRemoval:(S==null?void 0:S.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(M.removalStatus).length>0?M.removalStatus:(S==null?void 0:S.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:F,isPending:G}=Md(),B=()=>`work_complete_draft_${t.id}`,[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(""),[H,V]=b.useState(!1),[K,j]=b.useState(""),[te,ce]=b.useState(""),[R,O]=b.useState(void 0),[U,Q]=b.useState(!1),[q,$]=b.useState(!1),[de,ae]=b.useState(""),[_e,ie]=b.useState(""),[Ne,X]=b.useState(""),[xe,fe]=b.useState(""),[Z,le]=b.useState(""),[se,Re]=b.useState(""),[be,De]=b.useState(!1),[re,me]=b.useState(""),[ve,et]=b.useState([]),[Dt,ot]=b.useState(!1),[At,ct]=b.useState([]),[Ge,at]=b.useState(!1),[xt,mt]=b.useState(""),[Ve,it]=b.useState(!1),[Fe,nt]=b.useState([]),[lt,Mt]=b.useState(!1),[ut,qe]=b.useState(""),[Ee,Ye]=b.useState(!1),[pe,ge]=b.useState("B"),[Be,ue]=b.useState(!1),[we,Je]=b.useState(null),[Pe,Nt]=b.useState([]),[Oe,dt]=b.useState([]),[gt,It]=b.useState([]),[$e,$t]=b.useState([]),[Ue,ss]=b.useState([]),[ls,ds]=b.useState(()=>{const he=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(he&&he.length>=8)return`${he.slice(0,4)}-${he.slice(4,6)}-${he.slice(6,8)}`;const ye=new Date;return ye.getFullYear()+"-"+String(ye.getMonth()+1).padStart(2,"0")+"-"+String(ye.getDate()).padStart(2,"0")});b.useEffect(()=>{if(u){console.log("[WorkCompleteInstall]   - getWorkReceiptDetail API "),(async()=>{try{const je=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(je){console.log("[WorkCompleteInstall] API :",je);const Me=je.INSTL_LOC||"";if(Me.includes("")){const[Te,bt]=Me.split("");ae(Te),ie(bt)}else ae(Me),ie(je.VIEW_MOD_CD||""),X(je.VIEW_MOD_NM||"");const tt=je.UP_CTRL_CL||(P==null?void 0:P.upCtrlCl)||"";console.log("[CompleteInstall]  :",{API:je.UP_CTRL_CL,:P==null?void 0:P.upCtrlCl,:tt}),Y(tt),fe(je.PSN_USE_CORP||""),le(je.VOIP_USE_CORP||""),Re(je.DTV_USE_CORP||""),j(je.NET_CL||""),ce(je.NET_CL_NM||""),O({NET_CL:je.NET_CL||"",NET_CL_NM:je.NET_CL_NM||"",WRNG_TP:je.WRNG_TP||"",INSTL_TP:je.INSTL_TP||"",CB_WRNG_TP:je.CB_WRNG_TP||"",CB_INSTL_TP:je.CB_INSTL_TP||"",INOUT_LINE_TP:je.INOUT_LINE_TP||"",INOUT_LEN:je.INOUT_LEN||"",DVDR_YN:je.DVDR_YN||"",BFR_LINE_YN:je.BFR_LINE_YN||"",CUT_YN:je.CUT_YN||"",TERM_NO:je.TERM_NO||"",RCV_STS:je.RCV_STS||"",SUBTAP_ID:je.SUBTAP_ID||"",PORT_NUM:je.PORT_NUM||"",EXTN_TP:je.EXTN_TP||"",TAB_LBL:je.TAB_LBL||"",CVT_LBL:je.CVT_LBL||"",STB_LBL:je.STB_LBL||""}),E(je.CUST_REL||""),J((je.WRK_PROC_CT||"").replace(/\\n/g,`
`)),je.VOIP_JOIN_CTRT_ID&&me(je.VOIP_JOIN_CTRT_ID),je.WRKR_CMPL_DT&&je.WRKR_CMPL_DT.length>=8&&ds(`${je.WRKR_CMPL_DT.slice(0,4)}-${je.WRKR_CMPL_DT.slice(4,6)}-${je.WRKR_CMPL_DT.slice(6,8)}`)}else console.log("[WorkCompleteInstall] API  - order  "),E(t.CUST_REL||""),j(t.NET_CL||""),ce(t.NET_CL_NM||"")}catch(je){console.error("[WorkCompleteInstall] API  :",je),E(t.CUST_REL||""),j(t.NET_CL||""),ce(t.NET_CL_NM||"")}finally{y(!0)}})();return}const he=localStorage.getItem(B());if(he)try{const ye=JSON.parse(he);E(ye.custRel||""),Y(ye.upCtrlCl||""),J(ye.memo||""),fe(ye.internetUse||""),le(ye.voipUse||""),Re(ye.dtvUse||""),j(ye.networkType||""),ce(ye.networkTypeName||""),O(ye.installInfoData),ae(ye.installLocationText||""),ie(ye.viewModCd||""),X(ye.viewModNm||""),ye.voipJoinCtrtId&&me(ye.voipJoinCtrtId)}catch(ye){console.error("[WorkCompleteInstall] localStorage  :",ye)}y(!0)},[t.id,u]),b.useEffect(()=>{if(!C||u)return;const he={custRel:I,upCtrlCl:A,memo:ee,internetUse:xe,voipUse:Z,dtvUse:se,networkType:K,networkTypeName:te,installInfoData:R,installLocationText:de,viewModCd:_e,viewModNm:Ne,voipJoinCtrtId:re,savedAt:new Date().toISOString()};localStorage.setItem(B(),JSON.stringify(he))},[I,A,ee,xe,Z,se,K,te,R,de,_e,Ne,re,C,u]),b.useEffect(()=>{(async()=>{try{const ye=await po(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);ye.CMCU005&&Nt(ye.CMCU005.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),ye.CMCT015&&(console.log("[CompleteInstall]  CMCT015 :",ye.CMCT015),dt(ye.CMCT015.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM})))),ye.CMCU057&&It(ye.CMCU057.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),ye.CMCU110&&$t(ye.CMCU110.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),ye.CMCU148&&ss(ye.CMCU148.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM})))}catch(ye){console.error("[WorkCompleteInstall]    :",ye)}})()},[]),b.useEffect(()=>{(async()=>{var ye;if(!(!t.id||u)){p(!0);try{console.log("[CompleteInstall] OST  :",t.id);const je=await S1({WRK_ID:t.id,RCPT_ID:t.RCPT_ID,CUST_ID:(ye=t.customer)==null?void 0:ye.id});if(je){const Me=je.OST_WORKABLE_STAT||"";console.log("[CompleteInstall] OST  :",Me),m(Me),(Me==="0"||Me==="1"||Me==="4")&&(r==null||r("    .","warning",!0))}}catch(je){console.error("[CompleteInstall] OST   :",je)}finally{p(!1)}}})()},[t.id,t.RCPT_ID,(Ft=t.customer)==null?void 0:Ft.id,u]),b.useEffect(()=>{console.log("[CompleteInstall] OST  :",{OST_WORKABLE_STAT:h,isOstBlocked:g,isOstChecking:_,isWorkCompleted:u,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,:h==="0"?"":h==="1"?"":h==="2"?"":h==="3"?"":h==="4"?"/":h==="X"?"OST":h===""?"  ":""})},[h,g,_,u]),b.useEffect(()=>{(async()=>{try{const ye=await Ac(),je=(ye==null?void 0:ye.output)||ye||[];nt(je);const Me=t.PROD_CD||t.PROD_CD||"",tt=je.some(Te=>Te.PROD_CD===Me);it(tt),console.log("[CompleteInstall] LGHV :",{currentProdCd:Me,isLghv:tt,prodListCount:je.length})}catch(ye){console.error("[CompleteInstall] LGHV   :",ye)}})()},[t.PROD_CD]),b.useEffect(()=>{(async()=>{const ye=t.PROD_CD||t.PROD_CD||"",je=(P==null?void 0:P.prodPromoInfo)||[];if(ye==="PD10018480")console.log("[CompleteInstall] OTT   :",ye),Ye(!0),ge("C");else if(je.some(Te=>Te.PROD_CD==="PD10018160"))console.log("[CompleteInstall] OTT   : PD10018160"),Ye(!0),ge("B");else{Ye(!1);return}const Me=t.id||"",tt=t.directionId||t.WRK_DRCTN_ID||"";if(Me&&tt)try{const Te=await v1({WRK_ID:Me,WRK_DRCTN_ID:tt,DATA_TYPE:ye==="PD10018480"?"C":"B"});Te!=null&&Te.EQT_SERNO&&(console.log("[CompleteInstall]  OTT :",Te.EQT_SERNO),qe(Te.EQT_SERNO))}catch(Te){console.error("[CompleteInstall] OTT   :",Te)}})()},[t.PROD_CD,t.id,t.directionId,P==null?void 0:P.prodPromoInfo]),b.useEffect(()=>{P!=null&&P.upCtrlCl&&!A?(console.log("[CompleteInstall] equipmentData  :",P.upCtrlCl),Y(P.upCtrlCl)):!A&&C&&!u&&(console.log("[CompleteInstall]   : 01 ()"),Y("01"))},[P==null?void 0:P.upCtrlCl,C,u,A]),b.useEffect(()=>{var je,Me;if(u)return;const he=((je=t.customer)==null?void 0:je.id)||t.CUST_ID||t.customerId;if(console.log("[WorkCompleteInstall] CUST_ID :",{"order.customer?.id":(Me=t.customer)==null?void 0:Me.id,"order.CUST_ID":t.CUST_ID,"order.customerId":t.customerId,custId:he}),!he){console.log("[WorkCompleteInstall] CUST_ID  -    ");return}(async()=>{try{console.log("[WorkCompleteInstall]     :",he);const tt=await gm({CUST_ID:he});console.log("[WorkCompleteInstall]   :",tt),ct(tt||[])}catch(tt){console.error("[WorkCompleteInstall]     :",tt),ct([])}})()},[(_t=t.customer)==null?void 0:_t.id,t.CUST_ID,u]),b.useEffect(()=>{if(u)return;if(At.length===0){console.log("[WorkCompleteInstall]     ...");return}const he=t.PROD_GRP||"",ye=t.VOIP_PROD_CD||"",je=t.ISP_PROD_CD||"",Me=t.WRK_STAT_CD||"",tt=t.ADDR_ORD||"";if(console.log("[WorkCompleteInstall]   :",{prodGrp:he,voipProdCd:ye,ispProdCd:je,wrkStatCd:Me,addrOrd:tt,customerCtrtListCount:At.length}),he==="V"&&!ye){const Te=At.filter(Ke=>{const St=Ke.PROD_GRP||"",Et=Ke.CTRT_STAT||"",ze=Ke.ADDR_ORD||Ke.addr_ord||"";return(St==="C"||St==="D"||St==="I")&&Et==="20"&&(!tt||ze===tt)});console.log("[WorkCompleteInstall] VoIP   :",Te),Te.length<1&&Me==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const bt=[{value:"",label:""},...Te.map(Ke=>({value:Ke.CTRT_ID||"",label:`[${Ke.CTRT_ID}] ${Ke.BASIC_PROD_CD_NM||Ke.PROD_NM||""}`}))];et(bt),ot(!0);return}if(he==="I"&&je){const Te=At.filter(Ke=>{const St=Ke.PROD_GRP||"",Et=Ke.CTRT_STAT||"",ze=Ke.ADDR_ORD||Ke.addr_ord||"",ht=Ke.ISP_JOIN_ID||"",Lt=Ke.KPI_PROD_GRP_CD||"";return(St==="D"||St==="C")&&Et==="20"&&!ht&&Lt==="D"&&(!tt||ze===tt)});console.log("[WorkCompleteInstall] ISP   :",Te),Te.length<1&&Me==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const bt=[{value:"",label:""},...Te.map(Ke=>({value:Ke.CTRT_ID||"",label:`[${Ke.CTRT_ID}] ${Ke.BASIC_PROD_CD_NM||Ke.PROD_NM||""}`}))];et(bt),ot(!0);return}ot(!1),et([])},[t.id,t.WRK_STAT_CD,u,r,At]);const vs=()=>{const he=[];(!I||I==="[]")&&he.push("  ."),R!=null&&R.NET_CL||he.push(" ."),!t.installLocation&&!de&&he.push(" ."),ls||he.push(" .");const ye=t.PROD_GRP||"",je=t.VOIP_PROD_CD||"",Me=t.ISP_PROD_CD||"";ye==="V"&&!je&&Dt&&(re||he.push("VOIP    .")),ye==="I"&&Me&&Dt&&(re||he.push("  ISP .    ."));const tt=(P==null?void 0:P.installedEquipments)||[];return ye!=="V"&&tt.length<1&&he.push("()  ."),Ee&&!ut&&he.push("OTT   OTT BOX   ."),he},Ss=he=>{O(he),he.NET_CL&&j(he.NET_CL),he.NET_CL_NM&&ce(he.NET_CL_NM),r==null||r("  .","success")},ke=()=>{if(G)return;if(g){r==null||r("    .","warning");return}const he=vs();if(he.length>0){he.forEach(je=>r==null?void 0:r(je,"error"));return}(t.PROD_GRP||"")!=="V"?ue(!0):(mt(" ?"),at(!0))},ft=he=>{Je(he),ue(!1),mt(" ?"),at(!0)},st=async()=>{var ze,ht,Lt,Bt;console.log("[WorkCompleteInstall]   ");const he=ls.replace(/-/g,""),ye=localStorage.getItem("userInfo"),je=ye?JSON.parse(ye):{},Me=je.userId||"A20130708",tt=o||d0(t.OP_LNKD_CD);let Te="";if(tt){let Yt=(P==null?void 0:P.prodPromoInfo)||[];if(Yt.length===0)try{console.log("[CompleteInstall] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),Yt=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"01"}),console.log("[CompleteInstall] getProdPromotionInfo fallback :",Yt.length,"")}catch(ts){console.log("[CompleteInstall] getProdPromotionInfo fallback :",ts)}const Xt=Yt.filter(ts=>(ts.PROD_CMPS_CL==="21"||ts.PROD_CMPS_CL==="22")&&ts.PROD_STAT_CD==="10").map(ts=>ts.PROD_CD).filter(ts=>ts);Te=Xt.join(","),console.log("[CompleteInstall] ADD_ON :",Te,"(",Xt.length," )")}const bt=(P==null?void 0:P.installedEquipments)||[];if(tt&&bt.length>0&&!k){r==null||r("  .","error");return}if(tt&&k)try{const Yt=await p_({order:t,workerId:Me,certifyRegconfInfo:k,addOnParam:Te,reason:c||""});if(!Yt.success){r==null||r(` : ${Yt.message}`,"error");return}console.log("[CompleteInstall] CL-04    ")}catch(Yt){console.error("[CompleteInstall] CL-04  :",Yt),r==null||r(`  : ${Yt.message||"   "}`,"error");return}const Ke=async()=>{var Cs,Us;const Yt=(P==null?void 0:P.installedEquipments)||[],Xt=!!t.ISP_PROD_CD;let ts=!1;const Ut=(P==null?void 0:P.customerEquipments)||Yt;for(const _s of Ut){const Es=_s.actualEquipment||_s,Ls=Es.eqtClCd||Es.EQT_CL_CD||"";if(Ls==="090901"||Ls==="091001"||Ls==="091005")continue;(Es.EQT_KND||Es.eqtKnd||"WRKER")==="WRKER"&&(ts=!0)}if(Ut.some(_s=>{const Es=_s.actualEquipment||_s;return(Es.itemMidCd||Es.ITEM_MID_CD)==="23"})&&(ts=!1),Xt&&(ts=!0),await y_(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD)&&(ts=!1),ts&&(Yt.length>0||Xt))try{const _s=t.PROD_GRP||"";let Es="SMR03",Ls="",cs="",ms="",Ys="",Ps="",rt="";Ve&&(Es="STB_CRT"),_s==="V"&&(Es="SMR60");let Wt=(P==null?void 0:P.prodPromoInfo)||[];if(Wt.length===0)try{Wt=await Rl({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:Me,PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"01",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||"",WRK_CD:t.WRK_CD||"01",WRK_STAT_CD:t.WRK_STAT_CD||""})}catch(Os){console.log("[CompleteInstall] prodPromoInfo  :",Os)}const bs=((Cs=Wt.find(Os=>Os.PROD_CMPS_CL==="23"))==null?void 0:Cs.PROD_CMPS_ID)||"",zt=Wt.find(Os=>Os.PROD_CMPS_CL==="11"),ws=(zt==null?void 0:zt.PROD_CD)||"",Zt=(zt==null?void 0:zt.PROD_GRP)||_s,Ds=Wt.filter(Os=>Os.BASIC_PROD_FL==="V").map(Os=>Os.PROD_CD),js=Ds.length>0?Ds.join(","):"",hs=Os=>{const xs=Yt.find(Pr=>{const ti=Pr.actualEquipment||Pr;return(ti.itemMidCd||ti.ITEM_MID_CD)===Os});if(!xs)return"";const Br=xs.actualEquipment||xs;return Br.id||Br.EQT_NO||""};t.VOIP_PROD_CD?(Ls=hs("08"),cs=hs("02")):(Ls=hs("05")||hs("01")||hs("03")||(Zt==="I"?hs("02"):"")||hs("08")||"",cs=hs("04"),!cs&&Zt==="A"&&(cs=(R==null?void 0:R.NET_CL)||"")),ms=hs("07"),Zt==="C"&&(Ys=hs("02")),Zt==="V"&&(Ps=hs("10")),Xt&&(Ps=hs("21")),(_s==="V"||Xt)&&(rt=re||t.CTRT_ID||"");let Ws=t.id||"";for(const Os of Yt){const xs=Os.actualEquipment||Os,Br=xs.eqtClCd||xs.EQT_CL_CD||"";if(Br==="091003"||Br==="091004"){Ws=xs.id||xs.EQT_NO||t.id||"";break}if(Br==="092201"){Ws=xs.macAddress||xs.MAC_ADDRESS||xs.id||xs.EQT_NO||t.id||"";break}}console.log("[CompleteInstall]   :",{msgId:Es,eqtNo:Ls,prodCd:ws,subProdCd:js,etc1:cs,etc2:ms,etc3:Ys,etc4:Ps});const Vs=await _a({MSG_ID:Es,CUST_ID:((Us=t.customer)==null?void 0:Us.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ls,EQT_PROD_CMPS_ID:bs,PROD_CD:ws,ITV_USR_ID:"",IP_CNT:"",ETC_1:cs,ETC_2:ms,ETC_3:Ys,ETC_4:Ps,SUB_PROD_CD:js,IF_DTL_ID:"",WRK_ID:Ws,REG_UID:Me,VOIP_JOIN_CTRT_ID:rt,WTIME:"3"});Vs.code!=="SUCCESS"&&Vs.code!=="OK"?console.warn("[CompleteInstall]    :",Vs.message):console.log("[CompleteInstall]    ")}catch(_s){console.log("[CompleteInstall]      (  ):",_s)}},St=(Yt,Xt=!1)=>{if(!Yt||Yt.length===0)return[];const ts=(P==null?void 0:P.removalStatus)||{};return Yt.map(Ut=>{var _s,Es,Ls;const Is=Ut.EQT_NO||Ut.id||((_s=Ut.actualEquipment)==null?void 0:_s.id)||"",Cs=ts[Is]||{},Us=Xt?{CRR_TSK_CL:t.WRK_CD||"01",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||je.crrId||"01",WRKR_ID:Me,EQT_LOSS_YN:Cs.isLost?"1":"0",EQT_BRK_YN:Cs.isDamaged?"1":"0",REUSE_YN:Cs.isReusable?"1":"0"}:{};if(Ut.actualEquipment){const cs=Ut.actualEquipment,ms=Ut.contractEquipment||{};return{...cs,EQT_NO:cs.id,EQT_SERNO:cs.serialNumber,ITEM_MID_CD:cs.itemMidCd,EQT_CL_CD:cs.eqtClCd,MAC_ADDRESS:Ut.macAddress||cs.macAddress,WRK_ID:t.id,CUST_ID:(Es=t.customer)==null?void 0:Es.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:ms.id||ms.SVC_CMPS_ID||cs.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:cs.BASIC_PROD_CMPS_ID||ms.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:cs.EQT_PROD_CMPS_ID||ms.id,PROD_CD:cs.PROD_CD||ms.PROD_CD||t.PROD_CD||"",SVC_CD:cs.SVC_CD||ms.SVC_CD||"",EQT_SALE_AMT:cs.EQT_SALE_AMT||"0",MST_SO_ID:cs.MST_SO_ID||t.SO_ID||"",SO_ID:cs.SO_ID||t.SO_ID||"",REG_UID:Me,CHG_UID:Me,OLD_LENT_YN:cs.OLD_LENT_YN||"N",LENT:cs.LENT||"10",LENT_KND:cs.LENT_KND||"",ITLLMT_PRD:cs.ITLLMT_PRD||"00",EQT_USE_STAT_CD:cs.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:cs.IF_DTL_ID||"",...Us}}return{...Ut,EQT_NO:Ut.EQT_NO||Ut.id||"",EQT_SERNO:Ut.EQT_SERNO||Ut.serialNumber||"",ITEM_MID_CD:Ut.ITEM_MID_CD||Ut.itemMidCd||"",EQT_CL_CD:Ut.EQT_CL_CD||Ut.eqtClCd||"",MAC_ADDRESS:Ut.MAC_ADDRESS||Ut.macAddress||"",SVC_CMPS_ID:Ut.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Ut.BASIC_PROD_CMPS_ID||"",PROD_CD:Ut.PROD_CD||"",SVC_CD:Ut.SVC_CD||"",WRK_ID:Ut.WRK_ID||t.id,CUST_ID:Ut.CUST_ID||((Ls=t.customer)==null?void 0:Ls.id),CTRT_ID:Ut.CTRT_ID||t.CTRT_ID,WRK_CD:Ut.WRK_CD||t.WRK_CD,REG_UID:Me,CHG_UID:Me,LENT_KND:Ut.LENT_KND||"",...Us}})},Et={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(ze=t.customer)==null?void 0:ze.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||je.crrId||"01",WRKR_ID:Me,WRKR_CMPL_DT:he,MEMO:ee||" ",STTL_YN:"Y",REG_UID:Me,CUST_REL:I,CNFM_CUST_NM:(ht=t.customer)==null?void 0:ht.name,CNFM_CUST_TELNO:((Lt=t.customer)==null?void 0:Lt.contactNumber)||"",REQ_CUST_TEL_NO:((Bt=t.customer)==null?void 0:Bt.contactNumber)||"",INSTL_LOC:t.installLocation||de||"",UP_CTRL_CL:A||"",PSN_USE_CORP:xe||"",VOIP_USE_CORP:Z||"",DTV_USE_CORP:se||"",WRK_ACT_CL:"20",NET_CL:(R==null?void 0:R.NET_CL)||"",WRNG_TP:(R==null?void 0:R.WRNG_TP)||"",INSTL_TP:(R==null?void 0:R.INSTL_TP)||"",CB_WRNG_TP:(R==null?void 0:R.CB_WRNG_TP)||"",CB_INSTL_TP:(R==null?void 0:R.CB_INSTL_TP)||"",INOUT_LINE_TP:(R==null?void 0:R.INOUT_LINE_TP)||"",INOUT_LEN:(R==null?void 0:R.INOUT_LEN)||"",DVDR_YN:(R==null?void 0:R.DVDR_YN)||"",BFR_LINE_YN:(R==null?void 0:R.BFR_LINE_YN)||"",CUT_YN:(R==null?void 0:R.CUT_YN)||"",TERM_NO:(R==null?void 0:R.TERM_NO)||"",RCV_STS:(R==null?void 0:R.RCV_STS)||"",SUBTAP_ID:(R==null?void 0:R.SUBTAP_ID)||"",PORT_NUM:(R==null?void 0:R.PORT_NUM)||"",EXTN_TP:(R==null?void 0:R.EXTN_TP)||"",TAB_LBL:(R==null?void 0:R.TAB_LBL)||"",CVT_LBL:(R==null?void 0:R.CVT_LBL)||"",STB_LBL:(R==null?void 0:R.STB_LBL)||"",KPI_PROD_GRP:"",OBS_RCPT_CD:"",OBS_RCPT_DTL_CD:"",VOIP_JOIN_CTRT_ID:re||"",AGREE_YN:"",ISP_YN:"",AGREE_GB:"",CUST_CLEAN_YN:"",EQT_RMV_FLAG:"",TV_TYPE:"",ADD_ON:Te||""},equipmentList:St((P==null?void 0:P.installedEquipments)||[],!1),removeEquipmentList:St((P==null?void 0:P.removedEquipments)||[],!0),spendItemList:(P==null?void 0:P.spendItems)||[],agreementList:(P==null?void 0:P.agreements)||[],poleList:we?[{WRK_ID:t.id,POLE_YN:we.POLE_YN,LAN_GB:we.LAN_GB||"",REG_UID:Me}]:[]};F(Et,{onSuccess:Yt=>{Yt.code==="SUCCESS"||Yt.code==="OK"?(localStorage.removeItem(B()),t.WRK_STAT_CD="3",Ke(),r==null||r("  .","success"),n()):r==null||r(Yt.message||"   .","error",!0)},onError:Yt=>{r==null||r(Yt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[G&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",Dt&&!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),Dt?s.jsx(sn,{value:re,onValueChange:me,options:ve,placeholder:" ",required:!0,disabled:u}):s.jsx("input",{type:"text",value:"",readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:te||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>V(!0),className:`min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:u?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:I,onValueChange:E,options:Pe,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-xs sm:text-sm",children:[s.jsx("span",{className:"truncate",children:de||t.installLocation||""}),Ne&&s.jsxs("span",{className:"ml-1 sm:ml-2 text-xs sm:text-sm text-gray-500 flex-shrink-0 whitespace-nowrap",children:["(: ",Ne,")"]})]}),s.jsxs("button",{type:"button",onClick:()=>$(!0),className:`min-h-10 sm:min-h-12 px-3 sm:px-4 rounded-lg font-bold transition-colors flex items-center gap-1 sm:gap-2 text-xs sm:text-sm flex-shrink-0 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:[s.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{children:u?"":""})]})]})]}),((P==null?void 0:P.kpiProdGrpCd)==="D"||(P==null?void 0:P.prodGrp)==="D"||t.PROD_GRP==="D"||(t.PROD_NM||"").includes("DTV"))&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx(sn,{value:A,onValueChange:Y,options:Oe,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:ee,onChange:he=>J(he.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${u?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:u,disabled:u}),!u&&s.jsxs("p",{className:`text-xs text-right mt-1 ${ee.length>=500?"text-red-500":"text-gray-400"}`,children:[ee.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:ls,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>De(!be),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${be?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),be&&s.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"DTV ()"}),s.jsx(sn,{value:se,onValueChange:Re,options:Ue,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"ISP ()"}),s.jsx(sn,{value:xe,onValueChange:fe,options:gt,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"VoIP (VoIP)"}),s.jsx(sn,{value:Z,onValueChange:le,options:$e,placeholder:"",disabled:u})]})]})]}),Ee&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["OTT BOX  ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:ut,readOnly:!0,placeholder:"SER_NO   ",className:"flex-1 px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600"}),s.jsxs("button",{type:"button",onClick:()=>Mt(!0),disabled:u,className:`px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 ${u?"bg-gray-400 text-white cursor-not-allowed":ut?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"SER_NO"]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!u&&s.jsx("button",{onClick:ke,disabled:G||_||g,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${G||_||g?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:G?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>Q(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:H,onClose:()=>V(!1),onSave:Ss,workId:t.id,initialData:R,workType:t.WRK_CD,customerId:t.customer.id,customerName:t.customer.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(P==null?void 0:P.kpiProdGrpCd)||(P==null?void 0:P.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(P==null?void 0:P.prodChgGb)||(P==null?void 0:P.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(P==null?void 0:P.chgKpiProdGrpCd)||(P==null?void 0:P.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(P==null?void 0:P.prodGrp)||(P==null?void 0:P.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:u}),s.jsx(el,{isOpen:U,onClose:()=>Q(!1),ctrtId:t.CTRT_ID,custId:t.customer.id}),s.jsx(_m,{isOpen:q,onClose:()=>$(!1),onSave:he=>{ae(he.INSTL_LOC),ie(he.VIEW_MOD_CD),X(he.VIEW_MOD_NM),$(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(P==null?void 0:P.prodGrp)||(P==null?void 0:P.PROD_GRP),initialInstlLoc:de||t.installLocation,initialViewModCd:_e,initialViewModNm:Ne,showToast:r,readOnly:u}),s.jsx(Ba,{isOpen:Ge,onClose:()=>at(!1),onConfirm:st,title:" ",message:xt,type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{workType:"01",workTypeName:"",custRel:I,custRelName:(qt=Pe.find(he=>he.value===I))==null?void 0:qt.label,networkType:K,networkTypeName:te,upCtrlCl:A,upCtrlClName:(jt=Oe.find(he=>he.value===A))==null?void 0:jt.label,installedEquipments:(P==null?void 0:P.installedEquipments)||[],removedEquipments:(P==null?void 0:P.removedEquipments)||[],installLocation:de?{position:de}:void 0,memo:ee})}),s.jsx(b_,{isOpen:Be,onClose:()=>ue(!1),onSave:ft,soId:t.SO_ID||""}),s.jsx(iN,{isOpen:lt,onClose:()=>Mt(!1),onSave:he=>{qe(he),r==null||r("OTT  .","success")},wrkId:t.id||"",wrkDrctnId:t.directionId||t.WRK_DRCTN_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",dataType:pe,showToast:r,readOnly:u})]})},aN=({custId:t,rcptId:e,ctrtId:n,soId:r,termHopeDt:i,wrkCd:a,wrkStatCd:o,showToast:c,onHotbillConfirmChange:u,onSimulatingChange:h,readOnly:m=!1})=>{const[_,p]=b.useState(null),[g,C]=b.useState(!0),[y,S]=b.useState(!1),[v,k]=b.useState(null),[L,M]=b.useState([]),[P,F]=b.useState(0),[G,B]=b.useState(!1),[I,E]=b.useState(!1),[A,Y]=b.useState(!1),[ee,J]=b.useState(!1),[H,V]=b.useState(!1),[K,j]=b.useState(!1),[te,ce]=b.useState(!1),R=a==="02"&&o!=="7",O=()=>{const ae=new Date;return ae.getFullYear().toString()+String(ae.getMonth()+1).padStart(2,"0")+String(ae.getDate()).padStart(2,"0")},U=ae=>{if(!ae)return"-";const _e=ae.replace(/-/g,"");return _e.length>=8?`${_e.slice(0,4)}-${_e.slice(4,6)}-${_e.slice(6,8)}`:ae},Q=ae=>ae.toLocaleString("ko-KR"),q=async()=>{if(!t||!e){C(!1);return}C(!0),k(null);try{const ae=await pE(t,e);p(ae);const _e=ae&&ae.details&&ae.details.length>0;if(B(_e),_e&&ae.details.length>0){const X=ae.details[0],xe=X.BILL_SEQ_NO||"",fe=X.PROD_GRP||"",Z=X.SO_ID||r||"",le=X.CTRT_ID||n||"",se=X.CLC_WRK_CL||"4";if(console.log("[HotbillSection] Step 2 -   :",{billSeqNo:xe,prodGrp:fe,detailSoId:Z,clcWrkCl:se,rcptId:e}),xe&&fe&&Z&&e)try{const Re=await yE(xe,fe,Z,se,e);console.log("[HotbillSection]   :",Re);let be="",De=le;if(Re.length>0){const re=Re.find(me=>me.CTRT_ID===le);re?(be=re.CLC_WRK_NO,De=re.CTRT_ID):(be=Re[0].CLC_WRK_NO,De=Re[0].CTRT_ID||le)}if(console.log("[HotbillSection] Step 3 -   :",{billSeqNo:xe,clcWrkNo:be,targetCtrtId:De}),xe&&be&&De){const re=await bE(xe,be,De);console.log("[HotbillSection] ==========    =========="),console.log("[HotbillSection]  :",re.length),re.forEach((et,Dt)=>{console.log(`[HotbillSection] [${Dt}] CHRG_ITEM_NM: ${et.CHRG_ITEM_NM}, BILL_AMT: ${et.BILL_AMT}, REQ_YN: ${et.REQ_YN}, SORT_SEQ: ${et.SORT_SEQ}`)});const me=re.filter(et=>et.BILL_AMT>0||et.REQ_YN==="Y").sort((et,Dt)=>parseInt(et.SORT_SEQ||"0")-parseInt(Dt.SORT_SEQ||"0"));console.log("[HotbillSection] ==========    (BILL_AMT > 0 OR REQ_YN = Y) =========="),console.log("[HotbillSection]   :",me.length),me.forEach((et,Dt)=>{console.log(`[HotbillSection] [${Dt}] CHRG_ITEM_NM: ${et.CHRG_ITEM_NM}, BILL_AMT: ${et.BILL_AMT}, REQ_YN: ${et.REQ_YN}, SORT_SEQ: ${et.SORT_SEQ}`)}),M(me);const ve=me.reduce((et,Dt)=>et+Dt.BILL_AMT,0);console.log("[HotbillSection] :",ve),F(ve)}}catch(Re){console.warn("[HotbillSection]    ():",Re)}}const ie=O(),Ne=(i||"").replace(/-/g,"");!_e||Ne>ie?E(!0):E(!1)}catch(ae){console.error("[HotbillSection]  :",ae),k("  "),B(!1),E(!0)}finally{C(!1)}},$=async()=>{if(!t||!n||!r){c==null||c("    ","error");return}const ae=O();S(!0),h==null||h(!0),k(null);try{const _e=await vA({CUST_ID:t,CTRT_ID:n,SO_ID:r,HOPE_DT:ae,CLC_WRK_CL:"2",PNTY_EXMP_YN:"N"});if(_e.code==="SUCCESS"||_e.code==="OK"){c==null||c("  .","success"),Y(!0);const ie=_e.RCPT_ID||e,Ne=await pE(t,ie);p(Ne);const X=Ne&&Ne.details&&Ne.details.length>0;if(B(X),X&&Ne.details.length>0){const xe=Ne.details[0],fe=xe.BILL_SEQ_NO||"",Z=xe.PROD_GRP||"",le=xe.SO_ID||r||"",se=xe.CTRT_ID||n||"";if(fe&&Z&&le&&e)try{const Re=await yE(fe,Z,le,"4",e);let be="",De=se;if(Re.length>0){const re=Re.find(me=>me.CTRT_ID===se);re?(be=re.CLC_WRK_NO,De=re.CTRT_ID):(be=Re[0].CLC_WRK_NO,De=Re[0].CTRT_ID||se)}if(fe&&be&&De){const me=(await bE(fe,be,De)).filter(et=>et.BILL_AMT>0||et.REQ_YN==="Y").sort((et,Dt)=>parseInt(et.SORT_SEQ||"0")-parseInt(Dt.SORT_SEQ||"0"));M(me);const ve=me.reduce((et,Dt)=>et+Dt.BILL_AMT,0);F(ve)}}catch(Re){console.warn("[HotbillSection]    ():",Re)}}}else k(_e.message||"  "),c==null||c(_e.message||"  ","error",!0)}catch(_e){console.error("[HotbillSection]  :",_e),k(_e.message||"    "),c==null||c(_e.message||"    ","error",!0)}finally{S(!1),h==null||h(!1)}};if(b.useEffect(()=>{R&&t?q():C(!1)},[t,e,R]),b.useEffect(()=>{if(!R){u==null||u(!0);return}let ae=!1;I?ae=H||K:ae=ee,u==null||u(ae)},[R,I,ee,H,K]),!R)return null;const de=_&&_.details&&_.details.length>0;return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 sm:px-4 py-2.5 sm:py-3 flex items-center bg-orange-50",children:s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"text-xs sm:text-sm font-bold text-orange-800",children:""})]})}),s.jsxs("div",{className:"p-2.5 sm:p-3 space-y-2.5 sm:space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5 sm:p-3",children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-semibold text-gray-900",children:U(i)})]}),g&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-5 sm:py-6 gap-1.5 sm:gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-blue-600"}),s.jsx("div",{className:"text-gray-500 text-[0.625rem] sm:text-xs",children:"   ..."})]}),!g&&v&&s.jsx("div",{className:"flex items-center justify-center py-3 sm:py-4 px-3 sm:px-4",children:s.jsx("div",{className:"text-red-500 text-[0.625rem] sm:text-xs text-center",children:v})}),!g&&!v&&s.jsxs(s.Fragment,{children:[de&&s.jsxs("div",{className:"space-y-2.5 sm:space-y-3",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"grid grid-cols-12 bg-gray-100 border-b border-gray-200",children:[s.jsx("div",{className:"col-span-8 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-semibold text-gray-700 text-center",children:""}),s.jsx("div",{className:"col-span-4 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-semibold text-gray-700 text-center",children:""})]}),s.jsx("div",{className:"divide-y divide-gray-100 max-h-40 sm:max-h-48 overflow-y-auto",children:L.length>0?L.map((ae,_e)=>s.jsxs("div",{className:`grid grid-cols-12 ${_e%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("div",{className:"col-span-8 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs text-gray-900",children:ae.CHRG_ITEM_NM||"-"}),s.jsx("div",{className:"col-span-4 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-medium text-gray-900 text-right",children:Q(ae.BILL_AMT)})]},_e)):_.details.map((ae,_e)=>s.jsxs("div",{className:`grid grid-cols-12 ${_e%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("div",{className:"col-span-8 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs text-gray-900",children:ae.CHRG_ITM_NM||ae.CHG_NM||"-"}),s.jsx("div",{className:"col-span-4 px-1.5 sm:px-2 py-1.5 sm:py-2 text-[0.625rem] sm:text-xs font-medium text-gray-900 text-right",children:Q(ae.BILL_AMT)})]},_e))})]}),s.jsx("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-2.5 sm:p-3",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5 sm:gap-2",children:[s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-800 whitespace-nowrap",children:":"}),s.jsxs("span",{className:"text-base sm:text-lg font-bold text-blue-700",children:[Q(P>0?P:_.refundAmount||_.totalAmount),""]})]})})]}),!de&&s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 py-2.5 sm:py-3 px-2.5 sm:px-3 bg-amber-50 rounded-lg border border-amber-200",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-amber-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs sm:text-sm text-amber-800",children:"  "})]}),s.jsx("div",{className:"space-y-2",children:I?s.jsxs(s.Fragment,{children:[(()=>{const ae=O();return(i||"").replace(/-/g,"")>ae?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 py-2 px-2.5 sm:px-3 bg-red-50 rounded-lg border border-red-200",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs sm:text-sm text-red-800 font-medium",children:"  ."})]}),s.jsxs("button",{type:"button",onClick:()=>{m||(ce(!te),te&&V(!1))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":te?"bg-amber-50 border-amber-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${te?"bg-amber-500 border-amber-500":"bg-white border-gray-400"}`,children:te&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":te?"text-amber-700":"text-gray-700"}`,children:"  "})]}),te&&!m&&s.jsx("div",{className:"space-y-2",children:A?s.jsxs("button",{type:"button",onClick:()=>{m||(V(!H),H||j(!1))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":H?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${H?"bg-green-500 border-green-500":"bg-white border-gray-400"}`,children:H&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":H?"text-green-700":"text-gray-700"}`,children:"  "})]}):s.jsx("button",{type:"button",onClick:$,disabled:y||m,className:"w-full py-3 bg-amber-600 hover:bg-amber-700 disabled:bg-gray-400 text-white text-sm font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:y?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:" "})]})})})]}):s.jsx("div",{className:"space-y-2",children:!A&&!m?s.jsx("button",{type:"button",onClick:$,disabled:y||m,className:"w-full py-3 bg-amber-600 hover:bg-amber-700 disabled:bg-gray-400 text-white text-sm font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:y?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:" "})]})}):A?s.jsxs("button",{type:"button",onClick:()=>{m||(V(!H),H||j(!1))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":H?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${H?"bg-green-500 border-green-500":"bg-white border-gray-400"}`,children:H&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":H?"text-green-700":"text-gray-700"}`,children:"  "})]}):null})})(),s.jsxs("button",{type:"button",onClick:()=>{m||(j(!K),K||(V(!1),ce(!1)))},disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":K?"bg-gray-100 border-gray-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${K?"bg-gray-500 border-gray-500":"bg-white border-gray-400"}`,children:K&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":K?"text-gray-700":"text-gray-600"}`,children:"  "})]})]}):s.jsxs("button",{type:"button",onClick:()=>!m&&J(!ee),disabled:m,className:`w-full p-3 rounded-lg border-2 transition-all flex items-center gap-3 ${m?"bg-gray-100 border-gray-300 cursor-not-allowed":ee?"bg-green-50 border-green-500":"bg-white border-gray-300 hover:border-gray-400"}`,children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${ee?"bg-green-500 border-green-500":"bg-white border-gray-400"}`,children:ee&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsx("span",{className:`text-sm font-medium ${m?"text-gray-500":ee?"text-green-700":"text-gray-700"}`,children:" "})]})})]})]})]})},N6={1:"",2:"1:1",3:"",4:""},S6={4:"",1:""},v6={5:"",6:"21",7:""},WM=({onComplete:t,onAssignAS:e,showToast:n,disabled:r=!1,savedData:i,onReset:a})=>{const[o,c]=b.useState(""),[u,h]=b.useState("4"),[m,_]=b.useState(""),[p,g]=b.useState(!1);b.useEffect(()=>{i&&(c(i.REMOVE_LINE_TP||""),h(i.REMOVE_GB||"4"),_(i.REMOVE_STAT||""),g(!1))},[i]);const C=[{value:"1",label:""},{value:"2",label:"1:1"},{value:"3",label:""},{value:"4",label:""}],y=[{value:"4",label:""},{value:"1",label:""}],S=[{value:"5",label:""},{value:"6",label:"21"},{value:"7",label:""}],v=B=>{c(B),h("4"),_("")},k=B=>{h(B),B==="4"&&_("")},L=()=>{if(!o){n==null||n("  ","warning");return}if(!u){n==null||n(" ","warning");return}const B={REMOVE_LINE_TP:o,REMOVE_GB:u,REMOVE_STAT:m};g(!1),t(B)},M=()=>{if(!o){n==null||n("  ","warning");return}if(!u){n==null||n(" ","warning");return}if(u==="1"&&!m){n==null||n("  ","warning");return}const B={REMOVE_LINE_TP:o,REMOVE_GB:u,REMOVE_STAT:m};g(!1),e(B)},P=()=>{g(!0),a==null||a()};if(r)return null;const F=i&&!p,G=(i==null?void 0:i.REMOVE_GB)==="1";return s.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden ${F?G?"border-orange-300":"border-green-300":"border-gray-200"}`,id:"removal-line-section",children:[s.jsx("div",{className:`w-full px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between ${F?G?"bg-orange-50":"bg-green-50":"bg-teal-50"}`,children:s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 ${F?G?"text-orange-600":"text-green-600":"text-teal-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("span",{className:`text-xs sm:text-sm font-bold ${F?G?"text-orange-800":"text-green-800":"text-teal-800"}`,children:" "}),F&&(G?s.jsx("span",{className:"ml-1 inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-orange-500 text-white text-xs font-bold",children:"AS"}):s.jsxs("span",{className:"ml-1 inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-green-500 text-white text-xs font-bold",children:[s.jsx(ea,{className:"w-3 h-3"}),""]}))]})}),F&&i&&s.jsx("div",{className:"p-3 sm:p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"font-semibold text-gray-900",children:N6[i.REMOVE_LINE_TP]||i.REMOVE_LINE_TP})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:`font-semibold ${i.REMOVE_GB==="4"?"text-blue-600":"text-red-600"}`,children:S6[i.REMOVE_GB]||i.REMOVE_GB}),i.REMOVE_GB==="1"&&i.REMOVE_STAT&&s.jsxs("span",{className:"text-yellow-600 font-medium",children:["(",v6[i.REMOVE_STAT]||i.REMOVE_STAT,")"]})]})]}),s.jsxs("button",{type:"button",onClick:P,className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(Ai,{className:"w-4 h-4"}),""]})]})}),!F&&s.jsxs("div",{className:"p-2.5 sm:p-3 space-y-3 sm:space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:""}),s.jsx("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2",children:C.map(B=>s.jsx("button",{type:"button",onClick:()=>v(B.value),className:`min-h-10 sm:min-h-12 py-2 sm:py-3 px-3 sm:px-4 rounded-lg font-medium text-xs sm:text-sm transition-colors border-2 ${o===B.value?"bg-green-100 border-green-500 text-green-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:B.label},B.value))})]}),o&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:""}),s.jsx("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2",children:y.map(B=>s.jsx("button",{type:"button",onClick:()=>k(B.value),className:`min-h-10 sm:min-h-12 py-2 sm:py-3 px-3 sm:px-4 rounded-lg font-bold text-sm sm:text-base transition-colors border-2 ${u===B.value?B.value==="4"?"bg-blue-100 border-blue-500 text-blue-700":"bg-red-100 border-red-500 text-red-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:B.label},B.value))})]}),o&&u==="1"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-3 gap-1.5 sm:gap-2",children:S.map(B=>s.jsx("button",{type:"button",onClick:()=>_(B.value),className:`min-h-10 sm:min-h-12 py-2 sm:py-3 px-1.5 sm:px-2 rounded-lg font-bold text-xs sm:text-sm transition-colors border-2 ${m===B.value?"bg-yellow-100 border-yellow-500 text-yellow-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:B.label},B.value))})]}),o&&s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-1.5 sm:pt-2",children:[s.jsx("button",{type:"button",onClick:L,disabled:!o||!u||u==="1",className:`flex-1 min-h-12 py-2 sm:py-3 rounded-lg font-bold text-sm sm:text-base transition-colors ${o&&u==="4"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:""}),s.jsx("button",{type:"button",onClick:M,disabled:!o||u!=="1"||!m,className:`flex-1 min-h-12 py-2 sm:py-3 rounded-lg font-bold text-sm sm:text-base transition-colors ${o&&u==="1"&&m?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"AS"})]})]})]})},E6={5:"JHA",6:"JHB",7:"JHC"},FM=({isOpen:t,onClose:e,onSave:n,removalLineData:r,custId:i,custNm:a,addrOrd:o,address:c,showToast:u,addressInfo:h})=>{const[m,_]=b.useState(""),[p,g]=b.useState("10"),[C,y]=b.useState("00"),[S,v]=b.useState(""),k=Array.from({length:13},(F,G)=>{const B=(9+G).toString().padStart(2,"0");return{value:B,label:B}}),L=["00","10","20","30","40","50"].map(F=>({value:F,label:F}));b.useEffect(()=>{if(t){const F=new Date,G=F.getFullYear(),B=F.getMonth(),I=new Date(G,B+1,0).getDate(),A=F.getDate()>I-7;let Y;A?Y=new Date(G,B+2,0):Y=new Date(G,B+1,0);const ee=Y.getFullYear(),J=String(Y.getMonth()+1).padStart(2,"0"),H=String(Y.getDate()).padStart(2,"0");_(`${ee}-${J}-${H}`),g("10"),y("00"),v("")}},[t]);const M=()=>{if(!m){u&&u(" ","warning");return}const F=new Date,G=m.replace(/-/g,"")+p+C,B=F.getFullYear().toString()+String(F.getMonth()+1).padStart(2,"0")+String(F.getDate()).padStart(2,"0")+String(F.getHours()).padStart(2,"0")+String(F.getMinutes()).padStart(2,"0");if(Number(G)<Number(B)){u&&u("   ","warning");return}const I=localStorage.getItem("userInfo"),E=I?JSON.parse(I):{},A=E.userId||"A20130708",Y=E.crrId||"01",ee=r!=null&&r.REMOVE_STAT&&E6[r.REMOVE_STAT]||"",J={CUST_ID:i,RCPT_ID:"",WRK_DTL_TCD:"0380",WRK_RCPT_CL:"JH",WRK_RCPT_CL_DTL:ee,WRK_HOPE_DTTM:G,HOPE_DTTM:G,MEMO:S,EMRG_YN:"N",HOLY_YN:"N",CRR_ID:Y,WRKR_ID:A,REG_UID:A,REMOVE_LINE_TP:(r==null?void 0:r.REMOVE_LINE_TP)||"",REMOVE_GB:(r==null?void 0:r.REMOVE_GB)||"",REMOVE_STAT:(r==null?void 0:r.REMOVE_STAT)||"",POST_ID:(h==null?void 0:h.POST_ID)||"",BLD_ID:(h==null?void 0:h.BLD_ID)||"",BLD_CL:(h==null?void 0:h.BLD_CL)||"",BLD_NM:(h==null?void 0:h.BLD_NM)||"",BUN_CL:(h==null?void 0:h.BUN_CL)||"",BUN_NO:(h==null?void 0:h.BUN_NO)||"",HO_NM:(h==null?void 0:h.HO_NM)||"",APT_DONG_NO:(h==null?void 0:h.APT_DONG_NO)||"",APT_HO_CNT:(h==null?void 0:h.APT_HO_CNT)||"",ADDR:(h==null?void 0:h.ADDR)||c||"",ADDR_DTL:(h==null?void 0:h.ADDR_DTL)||""};n(J)},P=F=>({5:"",6:"21",7:""})[F]||F;return t?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-[90%] max-w-md mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"bg-purple-600 text-white px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between sticky top-0",children:[s.jsx("h2",{className:"text-sm sm:text-lg font-bold",children:" AS"}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-purple-700 rounded-full transition-colors",children:s.jsx(Mi,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5 sm:p-3 space-y-1.5 sm:space-y-2",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20",children:""}),s.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[i," / ",a]})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium truncate",children:c})]})]}),(r==null?void 0:r.REMOVE_STAT)&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("span",{className:"text-sm text-yellow-700 font-medium",children:[" : ",P(r.REMOVE_STAT)]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:"AS"}),s.jsx("input",{type:"text",value:"(AS)",readOnly:!0,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 bg-gray-100 border border-gray-300 rounded-lg text-xs sm:text-sm text-gray-600"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:"AS()"}),s.jsx("input",{type:"text",value:"CS()",readOnly:!0,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 bg-gray-100 border border-gray-300 rounded-lg text-xs sm:text-sm text-gray-600"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:"AS()"}),s.jsx("input",{type:"text",value:P((r==null?void 0:r.REMOVE_STAT)||""),readOnly:!0,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 bg-gray-100 border border-gray-300 rounded-lg text-xs sm:text-sm text-gray-600"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(nm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"date",value:m,onChange:F=>_(F.target.value),min:new Date().toISOString().split("T")[0],className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(wp,{className:"w-4 h-4 text-gray-400"}),s.jsx("select",{value:p,onChange:F=>g(F.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500",children:k.map(F=>s.jsx("option",{value:F.value,children:F.label},F.value))}),s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("select",{value:C,onChange:F=>y(F.target.value),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500",children:L.map(F=>s.jsx("option",{value:F.value,children:F.label},F.value))})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1",children:""}),s.jsx("textarea",{value:S,onChange:F=>v(F.target.value),placeholder:"  ...",rows:3,maxLength:512,className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 border border-gray-300 rounded-lg text-xs sm:text-sm resize-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 border-t border-gray-200 sticky bottom-0",children:s.jsx("button",{onClick:M,className:"w-full py-2 sm:py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors text-sm sm:text-base",children:""})})]})]}):null},KM=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1})=>{var pe,ge,Be,ue,we,Je,Pe,Nt;const c=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[u,h]=b.useState(!1),[m,_]=b.useState(""),[p,g]=b.useState(!1),{equipmentData:C,filteringData:y,removalLineData:S,setRemovalLineData:v}=ta(),{certifyRegconfInfo:k}=Za(),L=t.id||"",M=xa(L),P={...C||i||y||{},installedEquipments:M.installedEquipments.length>0?M.installedEquipments:(C==null?void 0:C.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:M.removeEquipments.length>0?M.removeEquipments:(C==null?void 0:C.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(M.removalStatus).length>0?M.removalStatus:(C==null?void 0:C.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:F,isPending:G}=Md(),B=()=>`work_complete_draft_${t.id}`,[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(!1),[H,V]=b.useState(""),[K,j]=b.useState(""),[te,ce]=b.useState(void 0),R=S,O=v,[U,Q]=b.useState(!1),[q,$]=b.useState(!1),[de,ae]=b.useState(null),[_e,ie]=b.useState(!1),[Ne,X]=b.useState(""),[xe,fe]=b.useState(!1),[Z,le]=b.useState(!1),[se,Re]=b.useState(!1),[be,De]=b.useState(!1),[re,me]=b.useState(!1),[ve,et]=b.useState([]),[Dt,ot]=b.useState([]),[At,ct]=b.useState(()=>{const Oe=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(Oe&&Oe.length>=8)return`${Oe.slice(0,4)}-${Oe.slice(4,6)}-${Oe.slice(6,8)}`;const dt=new Date;return dt.getFullYear()+"-"+String(dt.getMonth()+1).padStart(2,"0")+"-"+String(dt.getDate()).padStart(2,"0")});t.SO_ID;const Ge=t.VOIP_CTX||"",at=t.WRK_STAT_CD||"";t.KPI_PROD_GRP_CD;const xt=m==="0"||m==="1"||m==="4",mt=c||p||xt||Ge?!1:at==="1"||at==="2",Ve=c||p||xt?!1:at==="1"||at==="2"||at==="7";b.useEffect(()=>{(async()=>{var dt;if(!(!t.id||c)){g(!0);try{console.log("[CompleteTerminate] OST  :",t.id);const gt=await S1({WRK_ID:t.id,RCPT_ID:t.RCPT_ID,CUST_ID:(dt=t.customer)==null?void 0:dt.id});if(gt){const It=gt.OST_WORKABLE_STAT||"";console.log("[CompleteTerminate] OST  :",It),_(It),(It==="0"||It==="1"||It==="4")&&(r==null||r("    .","warning",!0))}}catch(gt){console.error("[CompleteTerminate] OST   :",gt)}finally{g(!1)}}})()},[t.id,t.RCPT_ID,(pe=t.customer)==null?void 0:pe.id,c]),b.useEffect(()=>{(async()=>{try{console.log("[WorkCompleteTerminate]    ");const dt=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});dt&&(console.log("[WorkCompleteTerminate] API  :",dt),console.log("[WorkCompleteTerminate] :",{NET_CL:dt.NET_CL,NET_CL_NM:dt.NET_CL_NM}),console.log("[WorkCompleteTerminate] :",{INSTL_TP:dt.INSTL_TP,WRNG_TP:dt.WRNG_TP}),console.log("[WorkCompleteTerminate] /:",{CUST_REL:dt.CUST_REL,WRK_PROC_CT:dt.WRK_PROC_CT}),console.log("[WorkCompleteTerminate] isWorkCompleted:",c),c&&(console.log("[WorkCompleteTerminate]   -   "),E(dt.CUST_REL||""),Y((dt.WRK_PROC_CT||"").replace(/\\n/g,`
`)),dt.WRKR_CMPL_DT&&dt.WRKR_CMPL_DT.length>=8&&ct(`${dt.WRKR_CMPL_DT.slice(0,4)}-${dt.WRKR_CMPL_DT.slice(4,6)}-${dt.WRKR_CMPL_DT.slice(6,8)}`)),V(dt.NET_CL||""),j(dt.NET_CL_NM||""),ce(gt=>gt||{NET_CL:dt.NET_CL||"",NET_CL_NM:dt.NET_CL_NM||"",WRNG_TP:dt.WRNG_TP||"",INSTL_TP:dt.INSTL_TP||"",CB_WRNG_TP:dt.CB_WRNG_TP||"",CB_INSTL_TP:dt.CB_INSTL_TP||"",INOUT_LINE_TP:dt.INOUT_LINE_TP||"",INOUT_LEN:dt.INOUT_LEN||"",DVDR_YN:dt.DVDR_YN||"",BFR_LINE_YN:dt.BFR_LINE_YN||"",CUT_YN:dt.CUT_YN||"",TERM_NO:dt.TERM_NO||"",RCV_STS:dt.RCV_STS||"",SUBTAP_ID:dt.SUBTAP_ID||"",PORT_NUM:dt.PORT_NUM||"",EXTN_TP:dt.EXTN_TP||"",TAB_LBL:dt.TAB_LBL||"",CVT_LBL:dt.CVT_LBL||"",STB_LBL:dt.STB_LBL||""}))}catch(dt){console.error("[WorkCompleteTerminate]    :",dt)}if(!c){const dt=localStorage.getItem(B());if(dt)try{const gt=JSON.parse(dt);E(gt.custRel||""),Y(gt.memo||""),gt.installInfoData&&(V(gt.networkType||""),j(gt.networkTypeName||""),ce(gt.installInfoData))}catch(gt){console.error("[WorkCompleteTerminate] localStorage  :",gt)}}h(!0)})()},[t.id,c]),b.useEffect(()=>{if(!u||c)return;const Oe={custRel:I,memo:A,networkType:H,networkTypeName:K,installInfoData:te,savedAt:new Date().toISOString()};localStorage.setItem(B(),JSON.stringify(Oe))},[I,A,H,K,te,u,c]),b.useEffect(()=>{(async()=>{try{const dt=await po(["CMCU005"]);dt.CMCU005&&ot(dt.CMCU005.map(gt=>({value:gt.COMMON_CD,label:gt.COMMON_CD_NM})))}catch(dt){console.error("[WorkCompleteTerminate]   :",dt)}})()},[]),b.useEffect(()=>{(async()=>{try{const dt=await Ac(),gt=(dt==null?void 0:dt.output)||dt||[];et(gt);const It=t.PROD_CD||t.PROD_CD||"",$e=gt.some($t=>$t.PROD_CD===It);me($e),console.log("[CompleteTerminate] LGHV :",{currentProdCd:It,isLghv:$e,prodListCount:gt.length})}catch(dt){console.error("[CompleteTerminate] LGHV   :",dt)}})()},[t.PROD_CD]),b.useEffect(()=>{console.log("[CompleteTerminate] OST  :",{OST_WORKABLE_STAT:m,isOstBlocked:xt,isOstChecking:p,isWorkCompleted:c,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,:m==="0"?"":m==="1"?"":m==="2"?"":m==="3"?"":m==="4"?"/":m==="X"?"OST":m===""?"  ":""})},[m,xt,p,c]);const it=()=>{const Oe=[];I||Oe.push("  ."),te!=null&&te.NET_CL||Oe.push(" . ( )"),At||Oe.push(" ."),t.WRK_CD==="02"&&at!=="7"&&!be&&Oe.push("  .");const dt=t.PROD_GRP||"",gt=(P==null?void 0:P.removedEquipments)||[];return dt!=="V"&&gt.length<1&&Oe.push("  .   ."),Mt()&&!R&&Oe.push("   ."),Oe},Fe=Oe=>{ce(Oe),Oe.NET_CL&&V(Oe.NET_CL),Oe.NET_CL_NM&&j(Oe.NET_CL_NM),r==null||r("  .","success")},nt=()=>{lt(!0)},lt=(Oe=!1)=>{if(G)return;if(xt){r==null||r("    .","warning");return}if(!Oe){const $e=t.KPI_PROD_GRP_CD||"";if($e==="C"||$e==="D"){r==null||r("    .","error");return}}const dt=it();if(dt.length>0){if(dt.forEach($e=>r==null?void 0:r($e,"error")),dt.some($e=>$e.includes(""))){const $e=document.getElementById("removal-line-section");$e&&($e.scrollIntoView({behavior:"smooth",block:"center"}),$e.classList.add("ring-2","ring-red-500","ring-offset-2"),setTimeout(()=>{$e.classList.remove("ring-2","ring-red-500","ring-offset-2")},2e3))}return}const gt=t.TERM_HOPE_DT||t.HOPE_DT||"";if(gt&&At){const $e=gt.replace(/-/g,"");At.replace(/-/g,"")<$e&&(r==null||r("  .","warning"))}X(Oe?" ?":" ?"),fe(Oe),ie(!0)},Mt=()=>{const Oe=t.KPI_PROD_GRP_CD||"",dt=t.VOIP_CTX||"";return["C","D","I"].includes(Oe)&&dt!=="T"&&dt!=="R"},ut=Oe=>{console.log("[WorkCompleteTerminate]   () :",Oe),O(Oe),r==null||r("  .   .","info")},qe=Oe=>{console.log("[WorkCompleteTerminate]   - AS  :",Oe),O(Oe),Q(!0)},Ee=Oe=>{console.log("[WorkCompleteTerminate] AS  :",Oe),ae(Oe),Q(!1),r==null||r("  AS  .","info")},Ye=async()=>{var Ss,ke,ft,st,Ft,_t,qt;const Oe=At.replace(/-/g,""),dt=localStorage.getItem("userInfo"),gt=dt?JSON.parse(dt):{},It=gt.userId||"A20130708";let $e="N";if(o||d0(t.OP_LNKD_CD)){const jt=await _6(t,It);if($e=jt.certifyTg,!jt.success){r==null||r(`  : ${jt.error}`,"error");return}}if(R&&R.REMOVE_GB==="4")try{console.log("[WorkCompleteTerminate]   API :",R);const jt=await Gp({WRK_ID:t.id||t.WRK_ID||"",REMOVE_LINE_TP:R.REMOVE_LINE_TP||"",REMOVE_GB:R.REMOVE_GB||"4",REMOVE_STAT:R.REMOVE_STAT||"",REG_UID:It});if(jt.code!=="SUCCESS"&&jt.code!=="OK"){r==null||r(jt.message||"   .","error",!0);return}console.log("[WorkCompleteTerminate]    ")}catch(jt){r==null||r(jt.message||"     .","error",!0);return}const Ue=(P==null?void 0:P.removedEquipments)||[],ss=!!t.ISP_PROD_CD;if($e!=="Y"&&(Ue.length>0||ss))try{let jt="SMR05",he="";if(re){jt="STB_DEL";const Ke=Ue.find(St=>{var Et,ze;return(St.ITEM_MID_CD||St.itemMidCd||((Et=St.actualEquipment)==null?void 0:Et.ITEM_MID_CD)||((ze=St.actualEquipment)==null?void 0:ze.itemMidCd))==="04"});Ke&&(he=Ke.EQT_NO||Ke.id||((Ss=Ke.actualEquipment)==null?void 0:Ss.EQT_NO)||((ke=Ke.actualEquipment)==null?void 0:ke.id)||"")}const ye=Ue[0],je=ye?ye.actualEquipment||ye:{},Me=je.PROD_CMPS_ID||(ye==null?void 0:ye.PROD_CMPS_ID)||je.EQT_PROD_CMPS_ID||(ye==null?void 0:ye.EQT_PROD_CMPS_ID)||"",Te=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"";console.log("[CompleteTerminate]   :",{msgId:jt,isLghvStb:re,etc1:he,eqtProdCmpsId:Me,voipJoinCtrtId:Te});const bt=await _a({MSG_ID:jt,CUST_ID:((ft=t.customer)==null?void 0:ft.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Me,PROD_CD:"",WRK_ID:t.id||"",REG_UID:It,ETC_1:he,VOIP_JOIN_CTRT_ID:Te,WTIME:"3"});if(bt.code!=="SUCCESS"&&bt.code!=="OK"){if((t.PROD_GRP||"")==="V"&&((st=bt.message)==null?void 0:st.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteTerminate] VoIP    -  :",bt.message),r==null||r("   .","error",!0);return}if((t.MSO_OUT_YN||"")==="Y"){r==null||r("MSO      .  .","error",!0);return}if(!window.confirm(` .
  ?`)){console.log("[CompleteTerminate]      ");return}console.log("[CompleteTerminate]      ")}else console.log("[CompleteTerminate]    ")}catch(jt){if(console.warn("[CompleteTerminate]     :",jt),!window.confirm(` .
  ?`))return}const ls=(P==null?void 0:P.removalStatus)||{},ds=Ue.map(jt=>{var Te;const he=jt.actualEquipment||jt,ye=jt.contractEquipment||{},je=he.id||jt.EQT_NO||jt.id||"",Me=ls[je]||ls[jt.id]||ls[jt.EQT_NO]||ls[he.id]||ls[jt.serialNumber]||ls[he.serialNumber]||{},tt=(bt,Ke)=>bt==="1"||bt==="Y"||Ke==="1"||Ke==="Y"?"1":"0";return{...he,EQT_NO:je,ITEM_MID_CD:he.ITEM_MID_CD||he.itemMidCd||jt.ITEM_MID_CD||jt.itemMidCd||"",ITEM_MID_NM:he.ITEM_MID_NM||he.type||jt.ITEM_MID_NM||jt.type||"",EQT_CL_CD:he.EQT_CL_CD||he.eqtClCd||jt.EQT_CL_CD||jt.eqtClCd||"",EQT_CL_NM:he.EQT_CL_NM||he.model||jt.EQT_CL_NM||jt.model||"",EQT_SERNO:he.EQT_SERNO||he.serialNumber||jt.EQT_SERNO||jt.serialNumber||"",MAC_ADDRESS:jt.macAddress||he.MAC_ADDRESS||he.macAddress||jt.MAC_ADDRESS||"",CRR_TSK_CL:"02",RCPT_ID:t.RCPT_ID||"",WRK_ID:t.id||"",CUST_ID:jt.CUST_ID||((Te=t.customer)==null?void 0:Te.id)||"",CTRT_ID:jt.CTRT_ID||t.CTRT_ID||"",CRR_ID:t.CRR_ID||gt.crrId||"01",WRKR_ID:It,REG_UID:It,SVC_CMPS_ID:ye.SVC_CMPS_ID||jt.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:ye.BASIC_PROD_CMPS_ID||jt.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:jt.EQT_PROD_CMPS_ID||"",PROD_CD:ye.PROD_CD||jt.PROD_CD||"",SVC_CD:ye.SVC_CD||jt.SVC_CD||"",MST_SO_ID:jt.MST_SO_ID||t.SO_ID||"",SO_ID:jt.SO_ID||t.SO_ID||"",OLD_LENT_YN:jt.OLD_LENT_YN||"N",LENT_YN:jt.lentYn||jt.LENT_YN||ye.LENT_YN||"10",...(console.log("[CompleteTerminate]  :",{eqtNo:je,"eq.EQT_LOSS_YN":jt.EQT_LOSS_YN,"status.EQT_LOSS_YN":Me.EQT_LOSS_YN,"status ":Me,"removalStatus ":Object.keys(ls)}),{}),EQT_LOSS_YN:tt(jt.EQT_LOSS_YN,Me.EQT_LOSS_YN),PART_LOSS_BRK_YN:tt(jt.PART_LOSS_BRK_YN,Me.PART_LOSS_BRK_YN),EQT_BRK_YN:tt(jt.EQT_BRK_YN,Me.EQT_BRK_YN),EQT_CABL_LOSS_YN:tt(jt.EQT_CABL_LOSS_YN,Me.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:tt(jt.EQT_CRDL_LOSS_YN,Me.EQT_CRDL_LOSS_YN),REUSE_YN:jt.REUSE_YN||Me.REUSE_YN||"1"}}),vs={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Ft=t.customer)==null?void 0:Ft.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||gt.crrId||"01",WRKR_ID:It,WRKR_CMPL_DT:Oe,MEMO:A||" ",STTL_YN:"Y",REG_UID:It,CUST_REL:I,CNFM_CUST_NM:(_t=t.customer)==null?void 0:_t.name,CNFM_CUST_TELNO:((qt=t.customer)==null?void 0:qt.contactNumber)||"",WRK_ACT_CL:"20",NET_CL:(te==null?void 0:te.NET_CL)||"",WRNG_TP:(te==null?void 0:te.WRNG_TP)||"",INSTL_TP:(te==null?void 0:te.INSTL_TP)||"",EQT_RMV_FLAG:xe?"Y":""},equipmentList:[],removeEquipmentList:ds,spendItemList:(P==null?void 0:P.spendItems)||[],agreementList:(P==null?void 0:P.agreements)||[],poleList:(P==null?void 0:P.poleResults)||[]};console.log("[CompleteTerminate]   :"),console.log("  - workInfo:",vs.workInfo),console.log("  -  modNetInfo   :"),console.log("    - NET_CL:",vs.workInfo.NET_CL,"( modNetInfo )"),console.log("    - INSTL_TP:",vs.workInfo.INSTL_TP),console.log("    - WRNG_TP:",vs.workInfo.WRNG_TP),console.log("    - WRK_ID:",vs.workInfo.WRK_ID),console.log("    - CTRT_ID:",vs.workInfo.CTRT_ID),console.log("    - installInfoData :",te),console.log("  - removeEquipmentList :",ds.length),ds.length>0&&(console.log("  - removeEquipmentList[0] :",ds[0]),console.log("  -   [0]:",Ue[0])),F(vs,{onSuccess:async jt=>{var he;if(jt.code==="SUCCESS"||jt.code==="OK"){if(localStorage.removeItem(B()),t.WRK_STAT_CD="3",de)try{const ye=await Gp({WRK_ID:t.id||t.WRK_ID||"",REMOVE_LINE_TP:de.REMOVE_LINE_TP||"",REMOVE_GB:de.REMOVE_GB||"1",REMOVE_STAT:de.REMOVE_STAT||"",REG_UID:de.REG_UID||It});ye.code!=="SUCCESS"&&ye.code!=="OK"&&console.error("[WorkCompleteTerminate]    :",ye.message);const je=await MM({CUST_ID:de.CUST_ID||((he=t.customer)==null?void 0:he.id)||"",RCPT_ID:de.RCPT_ID||"",WRK_DTL_TCD:de.WRK_DTL_TCD||"0380",WRK_RCPT_CL:de.WRK_RCPT_CL||"JH",WRK_RCPT_CL_DTL:de.WRK_RCPT_CL_DTL||"",WRK_HOPE_DTTM:de.WRK_HOPE_DTTM||"",MEMO:de.MEMO||"",EMRG_YN:de.EMRG_YN||"N",HOLY_YN:de.HOLY_YN||"N",CRR_ID:de.CRR_ID||"",WRKR_ID:de.WRKR_ID||"",REG_UID:de.REG_UID||It,POST_ID:de.POST_ID||"",BLD_ID:de.BLD_ID||"",BLD_CL:de.BLD_CL||"",BLD_NM:de.BLD_NM||"",BUN_CL:de.BUN_CL||"",BUN_NO:de.BUN_NO||"",HO_NM:de.HO_NM||"",APT_DONG_NO:de.APT_DONG_NO||"",APT_HO_CNT:de.APT_HO_CNT||"",ADDR:de.ADDR||"",ADDR_DTL:de.ADDR_DTL||""});je.code==="SUCCESS"||je.code==="OK"?console.log("[WorkCompleteTerminate] AS "):console.error("[WorkCompleteTerminate] AS :",je.message)}catch(ye){console.error("[WorkCompleteTerminate] AS  :",ye)}r==null||r("  .","success"),n()}else r==null||r(jt.message||"   .","error",!0)},onError:jt=>{r==null||r(jt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[se&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999]",onClick:Oe=>Oe.stopPropagation(),onTouchStart:Oe=>Oe.stopPropagation(),children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-4 shadow-xl",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-gray-700 font-medium",children:"  ..."}),s.jsx("p",{className:"text-gray-500 text-sm",children:" "})]})}),G&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("input",{type:"text",value:"",readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:K||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>J(!0),className:`min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${c?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:I,onValueChange:E,options:Dt,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:A,onChange:Oe=>Y(Oe.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:c,disabled:c}),!c&&s.jsxs("p",{className:`text-xs text-right mt-1 ${A.length>=500?"text-red-500":"text-gray-400"}`,children:[A.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:At,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsx(aN,{custId:((ge=t.customer)==null?void 0:ge.id)||"",rcptId:t.RCPT_ID||"",ctrtId:t.CTRT_ID||"",soId:t.SO_ID||"",termHopeDt:t.TERM_HOPE_DT||t.HOPE_DT||"",wrkCd:t.WRK_CD||"02",wrkStatCd:at,showToast:r,onHotbillConfirmChange:De,onSimulatingChange:Re,readOnly:c}),Mt()&&s.jsx(WM,{onComplete:ut,onAssignAS:qe,showToast:r,disabled:c,savedData:R,onReset:()=>O(null)}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!c&&s.jsxs("button",{onClick:()=>nt(),disabled:G||!mt,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${mt?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{children:""})]}),!c&&s.jsx("button",{onClick:()=>lt(!1),disabled:G||!Ve,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${Ve?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:G?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{onClick:()=>le(!0),className:"flex-1 btn btn-lg flex items-center justify-center gap-2 bg-gray-500 hover:bg-gray-600 text-white",children:[s.jsx(vd,{className:"w-5 h-5"}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:ee,onClose:()=>J(!1),onSave:Fe,workId:t.id,initialData:te,workType:t.WRK_CD,customerId:(Be=t.customer)==null?void 0:Be.id,customerName:(ue=t.customer)==null?void 0:ue.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||t.addrOrd||"",kpiProdGrpCd:t.KPI_PROD_GRP_CD||"",prodChgGb:t.PROD_CHG_GB||"",chgKpiProdGrpCd:t.CHG_KPI_PROD_GRP_CD||"",prodGrp:t.PROD_GRP||"",wrkDtlTcd:t.WRK_DTL_TCD||"",readOnly:c}),s.jsx(FM,{isOpen:U,onClose:()=>Q(!1),onSave:Ee,removalLineData:R,custId:((we=t.customer)==null?void 0:we.id)||"",custNm:((Je=t.customer)==null?void 0:Je.name)||"",addrOrd:((Pe=t.customer)==null?void 0:Pe.ADDR_ORD)||"",address:t.address||"",showToast:r,addressInfo:{POST_ID:t.POST_ID||"",BLD_ID:t.BLD_ID||"",BLD_CL:t.BLD_CL||"",BLD_NM:t.BLD_NM||"",BUN_CL:t.BUN_CL||"",BUN_NO:t.BUN_NO||"",HO_NM:t.HO_NM||"",APT_DONG_NO:t.APT_DONG_NO||"",APT_HO_CNT:t.APT_HO_CNT||"",ADDR:t.ADDR_TOTAL||t.ADDR||t.address||"",ADDR_DTL:t.ADDR_DTL||""}}),s.jsx(Ba,{isOpen:_e,onClose:()=>ie(!1),onConfirm:Ye,title:xe?" ":" ",message:Ne,type:"confirm",confirmText:xe?"":"",cancelText:"",children:s.jsx(Td,{workType:"02",workTypeName:xe?"":"",custRel:I,custRelName:(Nt=Dt.find(Oe=>Oe.value===I))==null?void 0:Nt.label,networkType:H,networkTypeName:K,installType:te==null?void 0:te.INSTL_TP,installTypeName:te==null?void 0:te.INSTL_TP_NM,removedEquipments:(P==null?void 0:P.removedEquipments)||[],memo:A})}),s.jsx(el,{isOpen:Z,onClose:()=>le(!1),ctrtId:t.CTRT_ID,prodCmpsId:t.BASIC_PROD_CMPS_ID||t.PROD_CMPS_ID})]})},QM=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1})=>{var ye,je,Me,tt,Te,bt,Ke,St,Et;const c=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[u,h]=b.useState(!1),{equipmentData:m,filteringData:_}=ta(),{certifyRegconfInfo:p}=Za(),g=t.id||"",C=xa(g),y={...m||i||_||{},installedEquipments:C.installedEquipments.length>0?C.installedEquipments:(m==null?void 0:m.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:C.markedForRemoval.length>0?C.markedForRemoval:(m==null?void 0:m.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(C.removalStatus).length>0?C.removalStatus:(m==null?void 0:m.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:S,isPending:v}=Md(),k=()=>`work_complete_draft_${t.id}`,[L,M]=b.useState(""),[P,F]=b.useState(""),[G,B]=b.useState(""),[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(""),[H,V]=b.useState(""),[K,j]=b.useState(""),[te,ce]=b.useState(!1),[R,O]=b.useState(""),[U,Q]=b.useState([]),[q,$]=b.useState(!1),[de,ae]=b.useState([]),[_e,ie]=b.useState(""),[Ne,X]=b.useState(""),[xe,fe]=b.useState(!1),[Z,le]=b.useState(""),[se,Re]=b.useState(""),[be,De]=b.useState(void 0),[re,me]=b.useState(!1),[ve,et]=b.useState(!1),[Dt,ot]=b.useState(""),[At,ct]=b.useState(""),[Ge,at]=b.useState(""),[xt,mt]=b.useState(!1),[Ve,it]=b.useState(!1),[Fe,nt]=b.useState([]),[lt,Mt]=b.useState(!1),[ut,qe]=b.useState(null),[Ee,Ye]=b.useState([]),[pe,ge]=b.useState([]),[Be,ue]=b.useState([]),[we,Je]=b.useState([]),[Pe,Nt]=b.useState([]),[Oe,dt]=b.useState([]),[gt,It]=b.useState([]),[$e,$t]=b.useState([]),[Ue,ss]=b.useState([]),[ls,ds]=b.useState([]),[vs,Ss]=b.useState([]),[ke,ft]=b.useState(()=>{const ze=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(ze&&ze.length>=8)return`${ze.slice(0,4)}-${ze.slice(4,6)}-${ze.slice(6,8)}`;const ht=new Date;return ht.getFullYear()+"-"+String(ht.getMonth()+1).padStart(2,"0")+"-"+String(ht.getDate()).padStart(2,"0")});b.useEffect(()=>{if(c){(async()=>{try{const Lt=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(Lt){M(Lt.CUST_REL||""),F((Lt.WRK_PROC_CT||"").replace(/\\n/g,`
`)),B(Lt.KPI_PROD_GRP||""),E(Lt.OBS_RCPT_CD||""),Y(Lt.OBS_RCPT_DTL_CD||""),J(Lt.PSN_USE_CORP||""),V(Lt.VOIP_USE_CORP||""),j(Lt.DTV_USE_CORP||""),le(Lt.NET_CL||""),Re(Lt.NET_CL_NM||""),ot(Lt.INSTL_LOC||"");const Bt=Lt.UP_CTRL_CL||(y==null?void 0:y.upCtrlCl)||"";ie(Bt),X(Lt.TV_TYPE||""),De({NET_CL:Lt.NET_CL||"",NET_CL_NM:Lt.NET_CL_NM||"",WRNG_TP:Lt.WRNG_TP||"",INSTL_TP:Lt.INSTL_TP||"",CB_WRNG_TP:Lt.CB_WRNG_TP||"",CB_INSTL_TP:Lt.CB_INSTL_TP||"",INOUT_LINE_TP:Lt.INOUT_LINE_TP||"",INOUT_LEN:Lt.INOUT_LEN||"",DVDR_YN:Lt.DVDR_YN||"",BFR_LINE_YN:Lt.BFR_LINE_YN||"",CUT_YN:Lt.CUT_YN||"",TERM_NO:Lt.TERM_NO||"",RCV_STS:Lt.RCV_STS||"",SUBTAP_ID:Lt.SUBTAP_ID||"",PORT_NUM:Lt.PORT_NUM||"",EXTN_TP:Lt.EXTN_TP||"",TAB_LBL:Lt.TAB_LBL||"",CVT_LBL:Lt.CVT_LBL||"",STB_LBL:Lt.STB_LBL||""}),Lt.VOIP_JOIN_CTRT_ID&&O(Lt.VOIP_JOIN_CTRT_ID),Lt.WRKR_CMPL_DT&&Lt.WRKR_CMPL_DT.length>=8&&ft(`${Lt.WRKR_CMPL_DT.slice(0,4)}-${Lt.WRKR_CMPL_DT.slice(4,6)}-${Lt.WRKR_CMPL_DT.slice(6,8)}`)}}catch(Lt){console.error("[WorkCompleteAS]     :",Lt)}h(!0)})();return}const ze=localStorage.getItem(k());if(ze)try{const ht=JSON.parse(ze);M(ht.custRel||""),F(ht.memo||""),B(ht.kpiProdGrp||""),E(ht.obsRcptCd||""),Y(ht.obsRcptDtlCd||""),J(ht.internetUse||""),V(ht.voipUse||""),j(ht.dtvUse||""),le(ht.networkType||""),Re(ht.networkTypeName||""),ot(ht.installLocationText||""),De(ht.installInfoData),ht.upCtrlCl&&ie(ht.upCtrlCl),ht.tvType&&X(ht.tvType),ht.voipJoinCtrtId&&O(ht.voipJoinCtrtId)}catch(ht){console.error("[WorkCompleteAS] localStorage  :",ht)}h(!0)},[t.id,c]),b.useEffect(()=>{if(!u||c)return;const ze={custRel:L,memo:P,kpiProdGrp:G,obsRcptCd:I,obsRcptDtlCd:A,internetUse:ee,voipUse:H,dtvUse:K,networkType:Z,networkTypeName:se,installLocationText:Dt,installInfoData:be,upCtrlCl:_e,tvType:Ne,voipJoinCtrtId:R,savedAt:new Date().toISOString()};localStorage.setItem(k(),JSON.stringify(ze))},[L,P,G,I,A,ee,H,K,Z,se,Dt,be,_e,Ne,R,u,c]),b.useEffect(()=>{(async()=>{try{const ht=await po(["CMCU005","CMCU057","CMCU110","CMCU148","CMCT015"]);ht.CMCU005&&Ye(ht.CMCU005.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ht.CMCU057&&ue(ht.CMCU057.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ht.CMCU110&&Je(ht.CMCU110.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ht.CMCU148&&Nt(ht.CMCU148.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM}))),ht.CMCT015&&ge(ht.CMCT015.map(ts=>({value:ts.COMMON_CD,label:ts.COMMON_CD_NM})));const Lt=await po(["PP00933","CMOB000","CMOB001"]),Bt=Lt.PP00933||[],Yt=Lt.CMOB000||[],Xt=Lt.CMOB001||[];dt(Bt),It(Yt),$t(Xt),ss(Bt.map(ts=>({value:ts.COMMON_CD||"",label:ts.COMMON_CD_NM||""})))}catch(ht){console.error("[WorkCompleteAS]   :",ht)}})()},[]),b.useEffect(()=>{(async()=>{try{const ht=await Ac(),Lt=(ht==null?void 0:ht.output)||ht||[];nt(Lt);const Bt=t.PROD_CD||t.PROD_CD||"",Yt=Lt.some(Xt=>Xt.PROD_CD===Bt);it(Yt)}catch(ht){console.error("[CompleteAS] LGHV   :",ht)}})()},[t.PROD_CD]),b.useEffect(()=>{y!=null&&y.upCtrlCl&&!_e?ie(y.upCtrlCl):!_e&&u&&!c&&ie("01")},[y==null?void 0:y.upCtrlCl,u,c,_e]),b.useEffect(()=>{if(Oe.length===0)return;const ze=t.KPI_PROD_GRP_CD||(y==null?void 0:y.kpiProdGrpCd)||"",ht=t.PROD_GRP||(y==null?void 0:y.prodGrp)||"";let Lt=Oe;ze&&(Lt=Oe.filter(Yt=>{const Xt=Yt.COMMON_CD||"";return Xt===ze||ht==="C"&&Xt==="I"}));const Bt=[{value:"",label:""},...Lt.map(Yt=>({value:Yt.COMMON_CD||"",label:Yt.COMMON_CD_NM||""}))];ss(Bt),ze&&!G&&!c&&B(ze)},[Oe,t,y==null?void 0:y.kpiProdGrpCd,y==null?void 0:y.prodGrp,c]),b.useEffect(()=>{if(gt.length===0)return;const ze=t.WRK_STAT_CD||"",ht=t.WRK_DTL_TCD||"",Lt=t.asReasonCode||t.WRK_RCPT_CL||"",Bt=t.asDetailCode||t.WRK_RCPT_CL_DTL||"";if(Ss([{value:"",label:""}]),!G){ds([{value:"",label:"  "}]);return}const Yt=Bt&&gt.some(Cs=>Cs.REF_CODE12===Bt),Xt=Lt&&gt.some(Cs=>Cs.REF_CODE12===Lt);let ts;Yt?ts="clDtl":Xt?ts="cl":ts="empty",console.log("[CompleteAS]   :",{kpiProdGrp:G,wrkStatCd:ze,wrkDtlTcd:ht,wrkRcptCl:Lt,wrkRcptClDtl:Bt,hasRefCode12ClDtl:Yt,hasRefCode12Cl:Xt,refCode12Filter:ts,totalCodes:gt.length});const Ut=gt.filter(Cs=>{const Us=Cs.COMMON_CD||"",_s=Cs.REF_CODE2||"",Es=Cs.REF_CODE12||"",Ls=Cs.REF_CODE16||"";if(!_s.includes(G)||ze==="2"&&Us==="KA")return!1;if(ht==="0350"){if(Ls!=="A"&&Ls!=="Y")return!1}else if(Ls&&Ls!=="A")return!1;if(ts==="clDtl"){if(Es!==Bt)return!1}else if(ts==="cl"){if(Es!==Lt)return!1}else if(Es)return!1;return!0});console.log("[CompleteAS]   :",Ut.map(Cs=>({code:Cs.COMMON_CD,name:Cs.COMMON_CD_NM,REF_CODE12:Cs.REF_CODE12,REF_CODE16:Cs.REF_CODE16})));const Is=[{value:"",label:""},...Ut.map(Cs=>({value:Cs.COMMON_CD||"",label:Cs.COMMON_CD_NM||""}))];ds(Is),I&&!Ut.some(Cs=>Cs.COMMON_CD===I)&&(E(""),Y(""))},[G,gt,t.WRK_STAT_CD,t.WRK_DTL_TCD,t.asReasonCode,t.asDetailCode]),b.useEffect(()=>{if($e.length===0)return;const ze=t.WRK_DTL_TCD||"",ht=t.asReasonCode||t.WRK_RCPT_CL||"",Lt=t.asDetailCode||t.WRK_RCPT_CL_DTL||"";if(!I||!G){Ss([{value:"",label:"  "}]);return}const Bt=Lt&&$e.some(Is=>Is.REF_CODE12===Lt),Yt=ht&&$e.some(Is=>Is.REF_CODE12===ht);let Xt;Bt?Xt="clDtl":Yt?Xt="cl":Xt="empty";const ts=$e.filter(Is=>{const Cs=Is.COMMON_CD||"",Us=Is.REF_CODE||"",_s=Is.REF_CODE2||"",Es=Is.REF_CODE12||"",Ls=Is.REF_CODE16||"";if(!Us.includes(I)||!_s.includes(G))return!1;if(ze==="0350"){if(Ls!=="A"&&Ls!=="Y")return!1}else if(Ls&&Ls!=="A")return!1;if(Xt==="clDtl"){if(Es!==Lt)return!1}else if(Xt==="cl"){if(Es!==ht)return!1}else if(Es)return!1;return!(Lt==="JJO"&&Cs!=="OOI")}),Ut=[{value:"",label:""},...ts.map(Is=>({value:Is.COMMON_CD||"",label:Is.COMMON_CD_NM||""}))];Ss(Ut),A&&!ts.some(Is=>Is.COMMON_CD===A)&&Y("")},[I,G,$e,t.WRK_DTL_TCD,t.asReasonCode,t.asDetailCode]),b.useEffect(()=>{var Lt;if(c)return;const ze=((Lt=t.customer)==null?void 0:Lt.id)||t.CUST_ID;if(!ze)return;(async()=>{try{const Bt=await gm({CUST_ID:ze});ae(Bt||[])}catch{ae([])}})()},[(ye=t.customer)==null?void 0:ye.id,t.CUST_ID,c]),b.useEffect(()=>{if(c||de.length===0)return;const ze=t.PROD_GRP||"",ht=t.VOIP_PROD_CD||"",Lt=t.ISP_PROD_CD||"",Bt=t.WRK_STAT_CD||"",Yt=t.ADDR_ORD||"";if(ze==="V"&&!ht){const Xt=de.filter(Ut=>{const Is=Ut.PROD_GRP||"",Cs=Ut.CTRT_STAT||"",Us=Ut.ADDR_ORD||Ut.addr_ord||"";return(Is==="C"||Is==="D"||Is==="I")&&Cs==="20"&&(!Yt||Us===Yt)});Xt.length<1&&Bt==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const ts=[{value:"",label:""},...Xt.map(Ut=>({value:Ut.CTRT_ID||"",label:`[${Ut.CTRT_ID}] ${Ut.BASIC_PROD_CD_NM||Ut.PROD_NM||""}`}))];Q(ts),$(!0);return}if(ze==="I"&&Lt){const Xt=de.filter(Ut=>{const Is=Ut.PROD_GRP||"",Cs=Ut.CTRT_STAT||"",Us=Ut.ADDR_ORD||Ut.addr_ord||"",_s=Ut.ISP_JOIN_ID||"",Es=Ut.KPI_PROD_GRP_CD||"";return(Is==="D"||Is==="C")&&Cs==="20"&&!_s&&Es==="D"&&(!Yt||Us===Yt)});Xt.length<1&&Bt==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const ts=[{value:"",label:""},...Xt.map(Ut=>({value:Ut.CTRT_ID||"",label:`[${Ut.CTRT_ID}] ${Ut.BASIC_PROD_CD_NM||Ut.PROD_NM||""}`}))];Q(ts),$(!0);return}$(!1),Q([])},[t.id,t.WRK_STAT_CD,c,r,de]);const st=()=>{const ze=[];L||ze.push("  ."),G||ze.push(" ."),I||ze.push(" ."),A||ze.push(" ."),be!=null&&be.NET_CL||ze.push(" ."),ke||ze.push(" .");const ht=t.PROD_GRP||"",Lt=t.VOIP_PROD_CD||"",Bt=t.ISP_PROD_CD||"";ht==="V"&&!Lt&&q&&(R||ze.push("VOIP    .")),ht==="I"&&Bt&&q&&(R||ze.push("  ISP .    ."));const Yt=(y==null?void 0:y.installedEquipments)||[],Xt=(y==null?void 0:y.removedEquipments)||[];return Yt.length>0||Xt.length>0,ze},Ft=ze=>{De(ze),ze.NET_CL&&le(ze.NET_CL),ze.NET_CL_NM&&Re(ze.NET_CL_NM),r==null||r("  .","success")},_t=()=>{if(v)return;const ze=st();if(ze.length>0){ze.forEach(Lt=>r==null?void 0:r(Lt,"error"));return}(t.PROD_GRP||"")!=="V"?Mt(!0):mt(!0)},qt=ze=>{qe(ze),Mt(!1),mt(!0)},jt=(ze,ht=!1)=>{if(!ze||ze.length===0)return[];const Lt=localStorage.getItem("userInfo"),Bt=Lt?JSON.parse(Lt):{},Yt=Bt.userId||"A20130708",Xt=(y==null?void 0:y.removalStatus)||{},ts=(Ut,Is)=>Ut==="1"||Ut==="Y"||Is==="1"||Is==="Y"?"1":"0";return ze.map(Ut=>{var _s,Es,Ls,cs;const Is=Ut.EQT_NO||Ut.id||((_s=Ut.actualEquipment)==null?void 0:_s.id)||"",Cs=Xt[Is]||Xt[Ut.id]||Xt[Ut.EQT_NO]||Xt[(Es=Ut.actualEquipment)==null?void 0:Es.id]||Xt[Ut.serialNumber]||{},Us=ht?{CRR_TSK_CL:t.WRK_CD||"03",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Bt.crrId||"01",WRKR_ID:Yt,EQT_LOSS_YN:ts(Ut.EQT_LOSS_YN,Cs.EQT_LOSS_YN),PART_LOSS_BRK_YN:ts(Ut.PART_LOSS_BRK_YN,Cs.PART_LOSS_BRK_YN),EQT_BRK_YN:ts(Ut.EQT_BRK_YN,Cs.EQT_BRK_YN),EQT_CABL_LOSS_YN:ts(Ut.EQT_CABL_LOSS_YN,Cs.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:ts(Ut.EQT_CRDL_LOSS_YN,Cs.EQT_CRDL_LOSS_YN)}:{};if(Ut.actualEquipment){const ms=Ut.actualEquipment,Ys=Ut.contractEquipment||{};return{...ms,EQT_NO:ms.id,EQT_SERNO:ms.serialNumber,ITEM_MID_CD:ms.itemMidCd,EQT_CL_CD:ms.eqtClCd,MAC_ADDRESS:Ut.macAddress||ms.macAddress,WRK_ID:t.id,CUST_ID:(Ls=t.customer)==null?void 0:Ls.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:Ys.id||Ys.SVC_CMPS_ID||ms.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ms.BASIC_PROD_CMPS_ID||Ys.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:ms.EQT_PROD_CMPS_ID||Ys.id,PROD_CD:ms.PROD_CD||Ys.PROD_CD||t.PROD_CD||"",SVC_CD:ms.SVC_CD||Ys.SVC_CD||"",EQT_SALE_AMT:ms.EQT_SALE_AMT||"0",MST_SO_ID:ms.MST_SO_ID||t.SO_ID||"",SO_ID:ms.SO_ID||t.SO_ID||"",REG_UID:Yt,OLD_LENT_YN:ms.OLD_LENT_YN||"N",LENT:ms.LENT||"10",LENT_YN:ms.LENT_YN||"10",ITLLMT_PRD:ms.ITLLMT_PRD||"00",EQT_USE_STAT_CD:ms.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:ms.IF_DTL_ID||"",VOIP_CUSTOWN_EQT:ms.VOIP_CUSTOWN_EQT||"N",...Us}}return{...Ut,EQT_NO:Ut.EQT_NO||Ut.id||"",EQT_SERNO:Ut.EQT_SERNO||Ut.serialNumber||"",ITEM_MID_CD:Ut.ITEM_MID_CD||Ut.itemMidCd||"",EQT_CL_CD:Ut.EQT_CL_CD||Ut.eqtClCd||"",MAC_ADDRESS:Ut.MAC_ADDRESS||Ut.macAddress||"",SVC_CMPS_ID:Ut.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Ut.BASIC_PROD_CMPS_ID||"",PROD_CD:Ut.PROD_CD||"",SVC_CD:Ut.SVC_CD||"",WRK_ID:t.id,CUST_ID:(cs=t.customer)==null?void 0:cs.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:Yt,...Us}})},he=async()=>{var Ys,Ps,rt,Wt,bs,zt,ws;const ze=ke.replace(/-/g,""),ht=localStorage.getItem("userInfo"),Lt=ht?JSON.parse(ht):{},Bt=Lt.userId||"A20130708",Yt=o||d0(t.OP_LNKD_CD),Xt=await y_(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let ts="";if(Yt){let Zt=(y==null?void 0:y.prodPromoInfo)||[];if(Zt.length===0)try{Zt=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"03"})}catch(js){console.log("[CompleteAS] getProdPromotionInfo fallback :",js)}const Ds=Zt.filter(js=>(js.PROD_CMPS_CL==="21"||js.PROD_CMPS_CL==="22")&&(js.PROD_STAT_CD==="10"||js.PROD_STAT_CD==="20")).map(js=>js.PROD_CD).filter(js=>js);ts=Ds.length>0?Ds.join(",")+",":"",console.log("[CompleteAS] ADD_ON :",ts)}const Ut=(y==null?void 0:y.installedEquipments)||[];if(Yt&&Ut.length>0&&!p){r==null||r("  .","error");return}if(Yt&&p)try{const Zt=await p_({order:t,workerId:Bt,certifyRegconfInfo:p,addOnParam:ts,reason:"AS"});if(!Zt.success){r==null||r(` : ${Zt.message}`,"error");return}}catch(Zt){console.error("[CompleteAS] CL-04  :",Zt),r==null||r(`  : ${Zt.message||"   "}`,"error");return}let Is="";const Cs=(y==null?void 0:y.removedEquipments)||[],Us=t.VOIP_CTX==="1",_s=Us&&(t.PROD_CD||t.PROD_CD)==="PD10004499",Es=["090901","091001","091002","091005"],Ls=Cs.some(Zt=>{var js,hs;const Ds=Zt.EQT_CL_CD||Zt.eqtClCd||((js=Zt.actualEquipment)==null?void 0:js.EQT_CL_CD)||((hs=Zt.actualEquipment)==null?void 0:hs.eqtClCd)||"";return!Es.includes(Ds)});if(Ve)console.log("[CompleteAS] LGHV :   skip ( )");else if(!Xt&&!Us&&Cs.length>0)try{let Zt="";try{const Vs=(await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"TERM",WRK_CD:"03"})).find(Os=>Os.PROD_CMPS_CL==="23");Vs&&(Zt=Vs.PROD_CMPS_ID||""),console.log("[CompleteAS] EQT_PROD_CMPS_ID:",Zt)}catch(Ws){console.log("[CompleteAS] getProdPromotionInfo   ():",Ws)}const js=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"",hs=await _a({MSG_ID:"SMR05",CUST_ID:((Ys=t.customer)==null?void 0:Ys.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Zt,PROD_CD:"",ITV_USR_ID:"",IP_CNT:"",ETC_1:"",ETC_2:"",ETC_3:"",ETC_4:"",SUB_PROD_CD:"",IF_DTL_ID:"",WRK_ID:t.id||"",REG_UID:Bt,VOIP_JOIN_CTRT_ID:js,WTIME:"3"});if((hs==null?void 0:hs.code)==="SUCCESS"||(hs==null?void 0:hs.code)==="PARTIAL")Is=(hs==null?void 0:hs.IF_DTL_ID)||"",console.log("[CompleteAS] SMR05 SUCCESS, IF_DTL_ID:",Is);else{const Ws=(hs==null?void 0:hs.message)||(hs==null?void 0:hs.rawResult)||"";console.error("[CompleteAS] SMR05 FAILED:",Ws),r==null||r(`   : ${Ws}`,"error");return}}catch(Zt){console.error("[CompleteAS] SMR05 error:",Zt),r==null||r("     .","error");return}if(_s&&Cs.length>0&&Ls)try{const Ds=((y==null?void 0:y.installedEquipments)||[]).find(Ws=>{var Vs,Os;return(Ws.ITEM_MID_CD||Ws.itemMidCd||((Vs=Ws.actualEquipment)==null?void 0:Vs.ITEM_MID_CD)||((Os=Ws.actualEquipment)==null?void 0:Os.itemMidCd))==="08"}),js=(Ds==null?void 0:Ds.EQT_NO)||(Ds==null?void 0:Ds.id)||((Ps=Ds==null?void 0:Ds.actualEquipment)==null?void 0:Ps.EQT_NO)||((rt=Ds==null?void 0:Ds.actualEquipment)==null?void 0:rt.id)||"";console.log("[CompleteAS] VoIP IPC (SMR65) :",{eqtNo:js});const hs=await _a({MSG_ID:"SMR65",CUST_ID:((Wt=t.customer)==null?void 0:Wt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:js,EQT_PROD_CMPS_ID:"",PROD_CD:t.PROD_CD||t.PROD_CD||"",ITV_USR_ID:"",IP_CNT:"",ETC_1:"",ETC_2:"",ETC_3:"",ETC_4:"",SUB_PROD_CD:"",IF_DTL_ID:"",WRK_ID:t.id||"",REG_UID:Bt,WTIME:"3"});if((hs==null?void 0:hs.code)==="SUCCESS"||(hs==null?void 0:hs.code)==="PARTIAL")Is=(hs==null?void 0:hs.IF_DTL_ID)||"",console.log("[CompleteAS] SMR65 SUCCESS, IF_DTL_ID:",Is);else{const Ws=(hs==null?void 0:hs.message)||(hs==null?void 0:hs.rawResult)||"";console.error("[CompleteAS] SMR65 FAILED:",Ws),r==null||r(`IPC   : ${Ws}`,"error");return}}catch(Zt){console.error("[CompleteAS] SMR65 error:",Zt),r==null||r("IPC     .","error");return}const cs={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(bs=t.customer)==null?void 0:bs.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||Lt.crrId||"01",WRKR_ID:Bt,WRKR_CMPL_DT:ze,MEMO:P||" ",STTL_YN:"Y",REG_UID:Bt,CUST_REL:L,CNFM_CUST_NM:((zt=t.customer)==null?void 0:zt.name)||"",CNFM_CUST_TELNO:((ws=t.customer)==null?void 0:ws.contactNumber)||"",INSTL_LOC:Dt||"",PSN_USE_CORP:ee||"",VOIP_USE_CORP:H||"",DTV_USE_CORP:K||"",WRK_ACT_CL:"20",NET_CL:(be==null?void 0:be.NET_CL)||"",WRNG_TP:(be==null?void 0:be.WRNG_TP)||"",INSTL_TP:(be==null?void 0:be.INSTL_TP)||"",KPI_PROD_GRP:G,OBS_RCPT_CD:I,OBS_RCPT_DTL_CD:A,CUST_CLEAN_YN:["MMA","MMB","MMC","II5"].includes(A)?"A":"",UP_CTRL_CL:_e.replace("[]",""),TV_TYPE:Ne||"",VOIP_JOIN_CTRT_ID:R||"",ADD_ON:ts||""},equipmentList:jt((y==null?void 0:y.installedEquipments)||[],!1),removeEquipmentList:jt((y==null?void 0:y.removedEquipments)||[],!0),spendItemList:(y==null?void 0:y.spendItems)||[],agreementList:(y==null?void 0:y.agreements)||[],poleList:ut?[{WRK_ID:t.id,POLE_YN:ut.POLE_YN,LAN_GB:ut.LAN_GB||"",REG_UID:Bt}]:[]},ms=async()=>{var Zt,Ds,js,hs,Ws,Vs;try{if((t.CERTIFY_TG||"")==="Y"){console.log("[CompleteAS] FTTH :  skip ( )");return}const xs=(y==null?void 0:y.installedEquipments)||[],Br=["090901","091001","091002","091005"];let Pr=!1;for(const ks of xs){const Xn=ks.EQT_CL_CD||ks.eqtClCd||((Zt=ks.actualEquipment)==null?void 0:Zt.EQT_CL_CD)||((Ds=ks.actualEquipment)==null?void 0:Ds.eqtClCd)||"";if(Br.includes(Xn))continue;(ks.EQT_KND||((js=ks.actualEquipment)==null?void 0:js.EQT_KND)||"WRKER")==="WRKER"&&(Pr=!0)}if(t.VOIP_CTX==="1"&&(Pr=!1),t.COLOR_RING_YN==="Y"&&(Pr=!1),!Pr){console.log("[CompleteAS]   : skip");return}const ti=t.PROD_GRP||"",Mr=t.VOIP_PROD_CD||"";let hn="SMR03";ti==="V"?hn="SMR60":Ve&&(hn="STB_CHG");let fr="",ci=t.PROD_CD||"",$r="",sa=ti;try{const ks=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"03"}),Xn=ks.find(Bi=>Bi.PROD_CMPS_CL==="23");Xn&&(fr=Xn.PROD_CMPS_ID||"");const zr=ks.find(Bi=>Bi.PROD_CMPS_CL==="11");zr&&(ci=zr.PROD_CD||ci,sa=zr.PROD_GRP||ti);const ji=ks.filter(Bi=>Bi.BASIC_PROD_FL==="V").map(Bi=>Bi.PROD_CD);ji.length>0&&($r=ji.join(","))}catch(ks){console.log("[CompleteAS] getProdPromotionInfo for install signal failed:",ks)}const Ar=ks=>xs.find(Xn=>{var zr,ji;return(Xn.ITEM_MID_CD||Xn.itemMidCd||((zr=Xn.actualEquipment)==null?void 0:zr.ITEM_MID_CD)||((ji=Xn.actualEquipment)==null?void 0:ji.itemMidCd))===ks}),na=ks=>{var Xn,zr;return(ks==null?void 0:ks.EQT_NO)||(ks==null?void 0:ks.id)||((Xn=ks==null?void 0:ks.actualEquipment)==null?void 0:Xn.EQT_NO)||((zr=ks==null?void 0:ks.actualEquipment)==null?void 0:zr.id)||""};let Ir="";if(Mr){const ks=Ar("08");ks&&(Ir=na(ks))}else{for(const ks of["05","01","03"]){const Xn=Ar(ks);if(Xn){Ir=na(Xn);break}}if(!Ir&&sa==="I"){const ks=Ar("02");ks&&(Ir=na(ks))}if(!Ir){const ks=Ar("08");ks&&(Ir=na(ks))}}let Ga="";if(Mr){const ks=Ar("02");ks&&(Ga=na(ks))}else{const ks=Ar("04");ks&&(Ga=na(ks))}const tl=na(Ar("07")),Rs=sa==="C"?na(Ar("02")):"",Un=na(Ar("10"));let Vn=t.id||"";const si=xs.find(ks=>{var Xn,zr;return(ks.EQT_CL_CD||ks.eqtClCd||((Xn=ks.actualEquipment)==null?void 0:Xn.EQT_CL_CD)||((zr=ks.actualEquipment)==null?void 0:zr.eqtClCd))==="091003"});if(si)Vn=na(si);else{const ks=xs.find(Xn=>{var zr,ji;return(Xn.EQT_CL_CD||Xn.eqtClCd||((zr=Xn.actualEquipment)==null?void 0:zr.EQT_CL_CD)||((ji=Xn.actualEquipment)==null?void 0:ji.eqtClCd))==="092201"});ks&&(Vn=(ks==null?void 0:ks.MAC_ADDRESS)||(ks==null?void 0:ks.macAddress)||((hs=ks==null?void 0:ks.actualEquipment)==null?void 0:hs.MAC_ADDRESS)||((Ws=ks==null?void 0:ks.actualEquipment)==null?void 0:Ws.macAddress)||"")}let Ii="";ti==="V"?Ii=Mr?t.CTRT_ID||"":R||"":t.ISP_PROD_CD&&(Ii=R||"");const No=Is||t.IF_DTL_ID||"",Il=ti==="V"||hn==="SMR03"?"":No;console.log("[CompleteAS]  :",{msgId:hn,eqtNo:Ir,instProdCd:ci,instEqtProdCmpsId:fr,subProdCd:$r}),await _a({MSG_ID:hn,CUST_ID:((Vs=t.customer)==null?void 0:Vs.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ir,EQT_PROD_CMPS_ID:fr,PROD_CD:ci,ITV_USR_ID:"",IP_CNT:"",ETC_1:Ga,ETC_2:tl,ETC_3:Rs,ETC_4:Un,SUB_PROD_CD:$r,IF_DTL_ID:Il,WRK_ID:Vn,REG_UID:Bt,VOIP_JOIN_CTRT_ID:Ii,WTIME:"3"}),console.log("[CompleteAS]   ")}catch(Os){console.log("[CompleteAS]     (  ):",Os)}};S(cs,{onSuccess:Zt=>{Zt.code==="SUCCESS"||Zt.code==="OK"?(localStorage.removeItem(k()),t.WRK_STAT_CD="3",ms(),r==null||r("  .","success"),n()):r==null||r(Zt.message||"   .","error",!0)},onError:Zt=>{r==null||r(Zt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[v&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[q&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:R,onValueChange:O,options:U,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:se||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>fe(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg ${c?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:L,onValueChange:M,options:Ee,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:G,onValueChange:B,options:Ue,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:I,onValueChange:E,options:ls,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:A,onValueChange:Y,options:vs,placeholder:I?" ":"  ",required:!0,disabled:c||!I})]}),((y==null?void 0:y.kpiProdGrpCd)==="D"||(y==null?void 0:y.prodGrp)==="D"||t.PROD_GRP==="D")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(sn,{value:_e,onValueChange:ie,options:pe,placeholder:" ",disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{className:"truncate",children:Dt||t.installLocation||""}),Ge&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500 flex-shrink-0 whitespace-nowrap",children:["(: ",Ge,")"]})]}),s.jsx("button",{type:"button",onClick:()=>et(!0),className:`min-h-10 px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${c?"bg-gray-500 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:P,onChange:ze=>F(ze.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:c,disabled:c}),!c&&s.jsxs("p",{className:`text-xs text-right mt-1 ${P.length>=500?"text-red-500":"text-gray-400"}`,children:[P.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:ke,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>ce(!te),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${te?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),te&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"DTV ()"}),s.jsx(sn,{value:K,onValueChange:j,options:Pe,placeholder:"",disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"ISP ()"}),s.jsx(sn,{value:ee,onValueChange:J,options:Be,placeholder:"",disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"VoIP (VoIP)"}),s.jsx(sn,{value:H,onValueChange:V,options:we,placeholder:"",disabled:c})]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!c&&s.jsx("button",{onClick:_t,disabled:v,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${v?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:v?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>me(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:xe,onClose:()=>fe(!1),onSave:Ft,workId:t.id,initialData:be,workType:t.WRK_CD,customerId:(je=t.customer)==null?void 0:je.id,customerName:(Me=t.customer)==null?void 0:Me.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD,kpiProdGrpCd:(y==null?void 0:y.kpiProdGrpCd)||(y==null?void 0:y.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(y==null?void 0:y.prodChgGb)||(y==null?void 0:y.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(y==null?void 0:y.chgKpiProdGrpCd)||(y==null?void 0:y.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(y==null?void 0:y.prodGrp)||(y==null?void 0:y.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:c}),s.jsx(el,{isOpen:re,onClose:()=>me(!1),ctrtId:t.CTRT_ID,custId:(tt=t.customer)==null?void 0:tt.id}),s.jsx(_m,{isOpen:ve,onClose:()=>et(!1),onSave:ze=>{ot(ze.INSTL_LOC),ct(ze.VIEW_MOD_CD),at(ze.VIEW_MOD_NM),et(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(y==null?void 0:y.prodGrp)||(y==null?void 0:y.PROD_GRP),initialInstlLoc:Dt||t.installLocation,initialViewModCd:At,initialViewModNm:Ge,showToast:r,readOnly:c}),s.jsx(b_,{isOpen:lt,onClose:()=>Mt(!1),onSave:qt,soId:t.SO_ID||""}),s.jsx(Ba,{isOpen:xt,onClose:()=>mt(!1),onConfirm:he,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{workType:"03",workTypeName:"A/S",custRel:L,custRelName:(Te=Ee.find(ze=>ze.value===L))==null?void 0:Te.label,networkType:Z,networkTypeName:se,upCtrlCl:_e,upCtrlClName:(bt=pe.find(ze=>ze.value===_e))==null?void 0:bt.label,kpiProdGrp:G,kpiProdGrpName:(Ke=Ue.find(ze=>ze.value===G))==null?void 0:Ke.label,obsRcptCd:I,obsRcptCdName:(St=ls.find(ze=>ze.value===I))==null?void 0:St.label,obsRcptDtlCd:A,obsRcptDtlCdName:(Et=vs.find(ze=>ze.value===A))==null?void 0:Et.label,installedEquipments:(y==null?void 0:y.installedEquipments)||[],removedEquipments:(y==null?void 0:y.removedEquipments)||[],installLocation:Dt?{position:Dt}:void 0,memo:P})})]})},D6=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1})=>{var Ft,_t,qt,jt;const o=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",c=t.WRK_DTL_TCD==="0440";t.WRK_DTL_TCD;const[u,h]=b.useState(!1),{equipmentData:m,filteringData:_}=ta(),{certifyRegconfInfo:p}=Za(),g=t.id||"",C=xa(g),y={...m||i||_||{},installedEquipments:C.installedEquipments.length>0?C.installedEquipments:(m==null?void 0:m.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:C.markedForRemoval.length>0?C.markedForRemoval:(m==null?void 0:m.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(C.removalStatus).length>0?C.removalStatus:(m==null?void 0:m.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:S,isPending:v}=Md(),k=()=>`work_complete_draft_${t.id}`,[L,M]=b.useState(""),[P,F]=b.useState(""),[G,B]=b.useState(""),[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(!1),[H,V]=b.useState(""),[K,j]=b.useState([]),[te,ce]=b.useState(!1),[R,O]=b.useState([]),[U,Q]=b.useState(!1),[q,$]=b.useState(t.NET_CL||""),[de,ae]=b.useState(t.NET_CL_NM||""),[_e,ie]=b.useState(()=>{if(t.NET_CL)return{NET_CL:t.NET_CL||"",NET_CL_NM:t.NET_CL_NM||"",WRNG_TP:t.WRNG_TP||"",INSTL_TP:t.INSTL_TP||"",CB_WRNG_TP:t.CB_WRNG_TP||"",CB_INSTL_TP:t.CB_INSTL_TP||"",INOUT_LINE_TP:t.INOUT_LINE_TP||"",INOUT_LEN:t.INOUT_LEN||"",DVDR_YN:t.DVDR_YN||"",BFR_LINE_YN:t.BFR_LINE_YN||"",CUT_YN:t.CUT_YN||"",TERM_NO:t.TERM_NO||"",RCV_STS:t.RCV_STS||"",SUBTAP_ID:t.SUBTAP_ID||"",PORT_NUM:t.PORT_NUM||"",EXTN_TP:t.EXTN_TP||"",TAB_LBL:t.TAB_LBL||"",CVT_LBL:t.CVT_LBL||"",STB_LBL:t.STB_LBL||""}}),[Ne,X]=b.useState(!1),[xe,fe]=b.useState(!1),[Z,le]=b.useState(""),[se,Re]=b.useState(""),[be,De]=b.useState(""),[re,me]=b.useState(!1),[ve,et]=b.useState(null),[Dt,ot]=b.useState(!1),[At,ct]=b.useState(""),[Ge,at]=b.useState(!1),[xt,mt]=b.useState(null),[Ve,it]=b.useState(!1),[Fe,nt]=b.useState(!1),[lt,Mt]=b.useState(!1),[ut,qe]=b.useState([]),[Ee,Ye]=b.useState([]),[pe,ge]=b.useState([]),[Be,ue]=b.useState([]),[we,Je]=b.useState([]),[Pe,Nt]=b.useState(()=>{const he=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(he&&he.length>=8)return`${he.slice(0,4)}-${he.slice(4,6)}-${he.slice(6,8)}`;const ye=new Date;return ye.getFullYear()+"-"+String(ye.getMonth()+1).padStart(2,"0")+"-"+String(ye.getDate()).padStart(2,"0")});b.useEffect(()=>{(async()=>{try{console.log("[WorkCompleteMove]    ");const ye=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});ye&&(console.log("[WorkCompleteMove]    :",{NET_CL:ye.NET_CL,NET_CL_NM:ye.NET_CL_NM}),o&&(M(ye.CUST_REL||""),F((ye.WRK_PROC_CT||"").replace(/\\n/g,`
`)),B(ye.PSN_USE_CORP||""),E(ye.VOIP_USE_CORP||""),Y(ye.DTV_USE_CORP||""),ye.WRKR_CMPL_DT&&ye.WRKR_CMPL_DT.length>=8&&Nt(`${ye.WRKR_CMPL_DT.slice(0,4)}-${ye.WRKR_CMPL_DT.slice(4,6)}-${ye.WRKR_CMPL_DT.slice(6,8)}`),ye.VOIP_JOIN_CTRT_ID&&V(ye.VOIP_JOIN_CTRT_ID)),$(ye.NET_CL||""),ae(ye.NET_CL_NM||""),le(je=>je||ye.INSTL_LOC||""),ie(je=>je||{NET_CL:ye.NET_CL||"",NET_CL_NM:ye.NET_CL_NM||"",WRNG_TP:ye.WRNG_TP||"",INSTL_TP:ye.INSTL_TP||"",CB_WRNG_TP:ye.CB_WRNG_TP||"",CB_INSTL_TP:ye.CB_INSTL_TP||"",INOUT_LINE_TP:ye.INOUT_LINE_TP||"",INOUT_LEN:ye.INOUT_LEN||"",DVDR_YN:ye.DVDR_YN||"",BFR_LINE_YN:ye.BFR_LINE_YN||"",CUT_YN:ye.CUT_YN||"",TERM_NO:ye.TERM_NO||"",RCV_STS:ye.RCV_STS||"",SUBTAP_ID:ye.SUBTAP_ID||"",PORT_NUM:ye.PORT_NUM||"",EXTN_TP:ye.EXTN_TP||"",TAB_LBL:ye.TAB_LBL||"",CVT_LBL:ye.CVT_LBL||"",STB_LBL:ye.STB_LBL||""}))}catch(ye){console.error("[WorkCompleteMove]    :",ye)}if(!o){const ye=localStorage.getItem(k());if(ye)try{const je=JSON.parse(ye);M(je.custRel||""),F(je.memo||""),je.installInfoData&&($(je.networkType||""),ae(je.networkTypeName||""),le(je.installLocationText||""),ie(je.installInfoData)),je.voipJoinCtrtId&&V(je.voipJoinCtrtId)}catch(je){console.error("[WorkCompleteMove] localStorage  :",je)}}h(!0)})()},[t.id,o]),b.useEffect(()=>{if(!u||o)return;const he={custRel:L,memo:P,internetUse:G,voipUse:I,dtvUse:A,networkType:q,networkTypeName:de,installLocationText:Z,installInfoData:_e,voipJoinCtrtId:H,savedAt:new Date().toISOString()};localStorage.setItem(k(),JSON.stringify(he))},[L,P,G,I,A,q,de,Z,_e,H,u,o]);const Oe=he=>!he||he.length!==8?"":`${he.slice(0,4)}-${he.slice(4,6)}-${he.slice(6,8)}`,dt=he=>he.replace(/-/g,""),gt=()=>new Date().toISOString().slice(0,10).replace(/-/g,""),It=(he,ye)=>{if(!he||!ye)return 0;const je=new Date(Oe(he)),Me=new Date(Oe(ye));return Math.ceil((Me.getTime()-je.getTime())/(1e3*60*60*24))},$e=he=>new Date(he.getFullYear(),he.getMonth()+1,0),$t=he=>$e(he).getDate()-he.getDate()<7,Ue=()=>{const he=new Date;let ye;return $t(he)?ye=new Date(he.getFullYear(),he.getMonth()+2,0):ye=$e(he),ye.toISOString().slice(0,10)},ss=b.useCallback(async()=>{const he=t.RCPT_ID||"",ye=t.CTRT_ID||"";if(!(!he||!ye)){ot(!0),mt(null);try{const je=await IM({RCPT_ID:he,CTRT_ID:ye});if(console.log("[CompleteMove]   :",je),je){et(je);const Me=gt();if(je.WRK_DTL_TCD==="0430"&&je.MMT_SUS_HOPE_DD<=Me){const tt=Ue();ct(tt),at(!0),console.log("[CompleteMove]   -   :",tt),r==null||r("  .   .","warning")}else ct(Oe(je.MMT_SUS_HOPE_DD)),at(!1)}}catch(je){console.error("[CompleteMove]   :",je),mt(je.message||"   ")}finally{ot(!1)}}},[t.RCPT_ID,t.CTRT_ID,r]);b.useEffect(()=>{ss()},[ss]);const ls=he=>{const ye=he.target.value;if(ct(ye),mt(null),!ve)return;const je=Oe(ve.SUS_HOPE_DD);if(ye<je){mt("   .");return}if(ve.VALID_SUS_DAYS&&parseInt(ve.VALID_SUS_DAYS)>0){const Me=parseInt(ve.VALID_SUS_DAYS),tt=new Date(je),Te=new Date(tt);Te.setDate(Te.getDate()+Me-1),new Date(ye)>Te&&mt(`   ${Te.toISOString().slice(0,10)}  .`)}},ds=()=>{if(!ve||!At)return;const he=Oe(ve.SUS_HOPE_DD);if(At<he){r==null||r("   .","error");return}nt(!0),at(!1),r==null||r(" .   .","info")};b.useEffect(()=>{(async()=>{try{const ye=await po(["CMCU005","CMCU057","CMCU110","CMCU148"]);ye.CMCU005&&Ye(ye.CMCU005.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),ye.CMCU057&&ge(ye.CMCU057.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),ye.CMCU110&&ue(ye.CMCU110.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM}))),ye.CMCU148&&Je(ye.CMCU148.map(je=>({value:je.COMMON_CD,label:je.COMMON_CD_NM})))}catch(ye){console.error("[WorkCompleteMove]   :",ye)}})()},[]),b.useEffect(()=>{(async()=>{try{const ye=await Ac(),je=(ye==null?void 0:ye.output)||ye||[];qe(je);const Me=t.PROD_CD||t.PROD_CD||"",tt=je.some(Te=>Te.PROD_CD===Me);Mt(tt),console.log("[CompleteSuspend] LGHV :",{currentProdCd:Me,isLghv:tt,prodListCount:je.length})}catch(ye){console.error("[CompleteSuspend] LGHV   :",ye)}})()},[t.PROD_CD]),b.useEffect(()=>{var je;if(o)return;const he=((je=t.customer)==null?void 0:je.id)||t.CUST_ID;if(!he)return;(async()=>{try{console.log("[WorkCompleteMove]     :",he);const Me=await gm({CUST_ID:he});console.log("[WorkCompleteMove]   :",Me),O(Me||[])}catch(Me){console.error("[WorkCompleteMove]     :",Me),O([])}})()},[(Ft=t.customer)==null?void 0:Ft.id,t.CUST_ID,o]),b.useEffect(()=>{if(o)return;if(R.length===0){console.log("[WorkCompleteMove]     ...");return}const he=t.PROD_GRP||"",ye=t.VOIP_PROD_CD||"",je=t.ISP_PROD_CD||"",Me=t.WRK_STAT_CD||"",tt=t.ADDR_ORD||"";if(console.log("[WorkCompleteMove]   :",{prodGrp:he,voipProdCd:ye,ispProdCd:je,wrkStatCd:Me,addrOrd:tt,customerCtrtListCount:R.length}),he==="V"&&!ye){const Te=R.filter(Ke=>{const St=Ke.PROD_GRP||"",Et=Ke.CTRT_STAT||"",ze=Ke.ADDR_ORD||Ke.addr_ord||"";return(St==="C"||St==="D"||St==="I")&&Et==="20"&&(!tt||ze===tt)});console.log("[WorkCompleteMove] VoIP   :",Te),Te.length<1&&Me==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const bt=[{value:"",label:""},...Te.map(Ke=>({value:Ke.CTRT_ID||"",label:`[${Ke.CTRT_ID}] ${Ke.BASIC_PROD_CD_NM||Ke.PROD_NM||""}`}))];j(bt),ce(!0);return}if(he==="I"&&je){const Te=R.filter(Ke=>{const St=Ke.PROD_GRP||"",Et=Ke.CTRT_STAT||"",ze=Ke.ADDR_ORD||Ke.addr_ord||"",ht=Ke.ISP_JOIN_ID||"",Lt=Ke.KPI_PROD_GRP_CD||"";return(St==="D"||St==="C")&&Et==="20"&&!ht&&Lt==="D"&&(!tt||ze===tt)});console.log("[WorkCompleteMove] ISP   :",Te),Te.length<1&&Me==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const bt=[{value:"",label:""},...Te.map(Ke=>({value:Ke.CTRT_ID||"",label:`[${Ke.CTRT_ID}] ${Ke.BASIC_PROD_CD_NM||Ke.PROD_NM||""}`}))];j(bt),ce(!0);return}ce(!1),j([])},[t.id,t.WRK_STAT_CD,o,r,R]);const vs=()=>{var tt;const he=[];L||he.push("  ."),_e!=null&&_e.NET_CL||he.push(" ."),t.WRK_CD!=="04"&&!Z&&!t.installLocation&&he.push(" ."),Pe||he.push(" .");const ye=t.PROD_GRP||"";if(t.WRK_DTL_TCD==="0430")(((tt=y==null?void 0:y.installedEquipments)==null?void 0:tt.length)||0)>0&&he.push("  .");else{const Te=(y==null?void 0:y.installedEquipments)||[];ye!=="V"&&Te.length<1&&he.push("()  .")}const je=t.VOIP_PROD_CD||"",Me=t.ISP_PROD_CD||"";return ye==="V"&&!je&&te&&(H||he.push("VOIP    .")),ye==="I"&&Me&&te&&(H||he.push("  ISP .    .")),he},Ss=he=>{ie(he),he.NET_CL&&$(he.NET_CL),he.NET_CL_NM&&ae(he.NET_CL_NM),r==null||r("  .","success")},ke=()=>{if(v)return;const he=vs();if(he.length>0){he.forEach(ye=>r==null?void 0:r(ye,"error"));return}me(!0)},ft=(he,ye=!1)=>{if(!he||he.length===0)return[];const je=localStorage.getItem("userInfo"),Me=je?JSON.parse(je):{},tt=Me.userId||"A20130708",Te=(y==null?void 0:y.removalStatus)||{},bt=(Ke,St)=>Ke==="1"||Ke==="Y"||St==="1"||St==="Y"?"1":"0";return he.map(Ke=>{var ht,Lt,Bt;const St=Ke.EQT_NO||Ke.id||((ht=Ke.actualEquipment)==null?void 0:ht.id)||"",Et=Te[St]||{},ze=ye?{CRR_TSK_CL:t.WRK_CD||"04",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Me.crrId||"01",WRKR_ID:tt,EQT_LOSS_YN:bt(Ke.EQT_LOSS_YN,Et.EQT_LOSS_YN),PART_LOSS_BRK_YN:bt(Ke.PART_LOSS_BRK_YN,Et.PART_LOSS_BRK_YN),EQT_BRK_YN:bt(Ke.EQT_BRK_YN,Et.EQT_BRK_YN),EQT_CABL_LOSS_YN:bt(Ke.EQT_CABL_LOSS_YN,Et.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:bt(Ke.EQT_CRDL_LOSS_YN,Et.EQT_CRDL_LOSS_YN)}:{};if(Ke.actualEquipment){const Yt=Ke.actualEquipment,Xt=Ke.contractEquipment||{};return{...Yt,EQT_NO:Yt.id,EQT_SERNO:Yt.serialNumber,ITEM_MID_CD:Yt.itemMidCd,EQT_CL_CD:Yt.eqtClCd,MAC_ADDRESS:Ke.macAddress||Yt.macAddress,WRK_ID:t.id,CUST_ID:(Lt=t.customer)==null?void 0:Lt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:tt,SVC_CMPS_ID:Xt.SVC_CMPS_ID||Ke.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Xt.BASIC_PROD_CMPS_ID||Ke.BASIC_PROD_CMPS_ID||"",PROD_CMPS_ID:Xt.PROD_CMPS_ID||Ke.PROD_CMPS_ID||"",SVC_CD:Xt.SVC_CD||Ke.SVC_CD||"",PROD_CD:Xt.PROD_CD||Ke.PROD_CD||"",LENT_YN:Ke.lentYn||Ke.LENT_YN||Xt.LENT_YN||"",EQT_CHG_GB:Ke.EQT_CHG_GB||"01",...ze}}return{...Ke,EQT_NO:Ke.EQT_NO||Ke.id||"",EQT_SERNO:Ke.EQT_SERNO||Ke.serialNumber||"",ITEM_MID_CD:Ke.ITEM_MID_CD||Ke.itemMidCd||"",EQT_CL_CD:Ke.EQT_CL_CD||Ke.eqtClCd||"",MAC_ADDRESS:Ke.MAC_ADDRESS||Ke.macAddress||"",SVC_CMPS_ID:Ke.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Ke.BASIC_PROD_CMPS_ID||"",PROD_CD:Ke.PROD_CD||"",SVC_CD:Ke.SVC_CD||"",WRK_ID:t.id,CUST_ID:(Bt=t.customer)==null?void 0:Bt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:tt,...ze}})},st=async()=>{var ht,Lt,Bt,Yt;const he=Pe.replace(/-/g,""),ye=localStorage.getItem("userInfo"),je=ye?JSON.parse(ye):{},Me=je.userId||"A20130708";if(Fe&&ve&&At){it(!0);try{const Xt=ve.SUS_HOPE_DD,ts=dt(At),Ut=It(Xt,ts),Is=await jM({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",SUS_HOPE_DD:Xt,MMT_SUS_HOPE_DD:ts,SUS_DD_NUM:String(Ut),REG_UID:Me});if(Is.code!=="SUCCESS"){r==null||r(Is.message||"  ","error",!0),it(!1);return}console.log("[CompleteMove]   ")}catch(Xt){r==null||r(Xt.message||"  ","error",!0),it(!1);return}it(!1)}const tt=(y==null?void 0:y.removedEquipments)||[],Te=(y==null?void 0:y.customerEquipments)||[],bt=(y==null?void 0:y.installedEquipments)||[],Ke=!!t.ISP_PROD_CD;if((t.WRK_DTL_TCD==="0430"||t.WRK_DTL_TCD==="0470")&&(tt.length>0||Te.length>0||bt.length>0||Ke))try{let Xt="SMR05",ts="";lt&&(Xt="STB_DEL");const Ut=tt[0],Is=Ut.actualEquipment||Ut,Cs=Is.PROD_CMPS_ID||Ut.PROD_CMPS_ID||Is.EQT_PROD_CMPS_ID||Ut.EQT_PROD_CMPS_ID||"",_s=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"";console.log("[CompleteMove]   :",{msgId:Xt,isLghvStb:lt,etc1:ts,eqtProdCmpsId:Cs});const Es=await _a({MSG_ID:Xt,CUST_ID:((ht=t.customer)==null?void 0:ht.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Cs,PROD_CD:"",WRK_ID:t.id||"",REG_UID:Me,ETC_1:ts,VOIP_JOIN_CTRT_ID:_s,WTIME:"3"});Es.code!=="SUCCESS"&&Es.code!=="OK"?(console.warn("[CompleteMove]    -  :",Es.message),r==null||r("   .","warning")):console.log("[CompleteMove]    ")}catch(Xt){console.warn("[CompleteMove]      -  :",Xt),r==null||r("     .","warning")}const Et=async()=>{var Is,Cs;const Xt=(y==null?void 0:y.customerEquipments)||[],ts=(y==null?void 0:y.installedEquipments)||[],Ut=!!t.ISP_PROD_CD;if(t.WRK_DTL_TCD==="0440"&&(Xt.length>0||ts.length>0||Ut))try{const Us=t.PROD_GRP||"";let _s="SMR03",Es="",Ls="",cs="",ms="",Ys="",Ps="";Us==="V"?_s="SMR60":lt&&(_s="STB_CRT");let rt=(y==null?void 0:y.prodPromoInfo)||[];if(rt.length===0)try{rt=await Rl({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:Me,PROD_CD:t.PROD_CD||"",CRR_TSK_CL:t.WRK_CD||"04",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||"",WRK_CD:t.WRK_CD||"04",WRK_STAT_CD:t.WRK_STAT_CD||""})}catch(Vs){console.log("[CompleteSuspend] prodPromoInfo  :",Vs)}const Wt=((Is=rt.find(Vs=>Vs.PROD_CMPS_CL==="23"))==null?void 0:Is.PROD_CMPS_ID)||"",bs=rt.find(Vs=>Vs.PROD_CMPS_CL==="11"),zt=(bs==null?void 0:bs.PROD_CD)||"",ws=(bs==null?void 0:bs.PROD_GRP)||Us,Zt=rt.filter(Vs=>Vs.BASIC_PROD_FL==="V").map(Vs=>Vs.PROD_CD),Ds=Zt.length>0?Zt.join(","):"",js=[...Xt,...ts],hs=Vs=>{const Os=js.find(Br=>{const Pr=Br.actualEquipment||Br;return(Pr.itemMidCd||Pr.ITEM_MID_CD)===Vs});if(!Os)return"";const xs=Os.actualEquipment||Os;return xs.id||xs.EQT_NO||""};t.VOIP_PROD_CD?(Es=hs("08"),Ls=hs("02")):(Es=hs("05")||hs("01")||hs("03")||(ws==="I"?hs("02"):"")||hs("08")||"",Ls=hs("04")),cs=hs("07"),ws==="C"&&(ms=hs("02")),ws==="V"&&(Ys=hs("10")),Ut&&(Ys=hs("21")),(Us==="V"||Ut)&&(Ps=H||t.CTRT_ID||"");let Ws=t.id||"";for(const Vs of js){const Os=Vs.actualEquipment||Vs,xs=Os.eqtClCd||Os.EQT_CL_CD||"";if(xs==="091003"||xs==="091004"){Ws=Os.id||Os.EQT_NO||t.id||"";break}if(xs==="092201"){Ws=Os.macAddress||Os.MAC_ADDRESS||Os.id||Os.EQT_NO||t.id||"";break}}console.log("[CompleteSuspend]   :",{msgId:_s,eqtNo:Es,prodCd:zt,subProdCd:Ds,etc1:Ls,etc2:cs,etc3:ms,etc4:Ys}),await _a({MSG_ID:_s,CUST_ID:((Cs=t.customer)==null?void 0:Cs.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Es,EQT_PROD_CMPS_ID:Wt,PROD_CD:zt,ITV_USR_ID:"",IP_CNT:"",ETC_1:Ls,ETC_2:cs,ETC_3:ms,ETC_4:Ys,SUB_PROD_CD:Ds,IF_DTL_ID:"",WRK_ID:Ws,REG_UID:Me,VOIP_JOIN_CTRT_ID:Ps,WTIME:"3"}),console.log("[CompleteSuspend]    ")}catch(Us){console.log("[CompleteSuspend]      (  ):",Us)}},ze={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Lt=t.customer)==null?void 0:Lt.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||je.crrId||"01",WRKR_ID:Me,WRKR_CMPL_DT:he,MEMO:P||" ",STTL_YN:"Y",REG_UID:Me,CUST_REL:L,CNFM_CUST_NM:((Bt=t.customer)==null?void 0:Bt.name)||"",CNFM_CUST_TELNO:((Yt=t.customer)==null?void 0:Yt.contactNumber)||"",INSTL_LOC:Z||t.installLocation||"",PSN_USE_CORP:G||"",VOIP_USE_CORP:I||"",DTV_USE_CORP:A||"",WRK_ACT_CL:"20",NET_CL:(_e==null?void 0:_e.NET_CL)||"",WRNG_TP:(_e==null?void 0:_e.WRNG_TP)||"",INSTL_TP:(_e==null?void 0:_e.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:H||""},equipmentList:ft((y==null?void 0:y.installedEquipments)||[],!1),removeEquipmentList:ft((y==null?void 0:y.removedEquipments)||[],!0),spendItemList:(y==null?void 0:y.spendItems)||[],agreementList:(y==null?void 0:y.agreements)||[],poleList:(y==null?void 0:y.poleResults)||[]};S(ze,{onSuccess:Xt=>{Xt.code==="SUCCESS"||Xt.code==="OK"?(localStorage.removeItem(k()),t.WRK_STAT_CD="3",Et(),r==null||r("  .","success"),n()):r==null||r(Xt.message||"   .","error",!0)},onError:Xt=>{r==null||r(Xt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[v&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[c&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:" .   ."})}),te&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!o&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:H,onValueChange:V,options:K,placeholder:" ",required:!0,disabled:o})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:de||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>Q(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg ${o?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:o?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!o&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:L,onValueChange:M,options:Ee,placeholder:" ",required:!0,disabled:o})]}),t.WRK_CD!=="04"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!o&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{className:"truncate",children:Z||t.installLocation||""}),be&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500 flex-shrink-0 whitespace-nowrap",children:["(: ",be,")"]})]}),s.jsx("button",{type:"button",onClick:()=>fe(!0),className:`min-h-10 px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${o?"bg-gray-500 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:o?"":""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:P,onChange:he=>F(he.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${o?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:o,disabled:o}),!o&&s.jsxs("p",{className:`text-xs text-right mt-1 ${P.length>=500?"text-red-500":"text-gray-400"}`,children:[P.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Pe,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 border border-indigo-200",children:[s.jsxs("div",{className:"text-sm font-semibold text-indigo-800 mb-2 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(nm,{size:16}),""]}),!o&&ve&&!Ge&&s.jsx("button",{type:"button",onClick:()=>at(!0),className:"px-2 py-0.5 bg-indigo-500 hover:bg-indigo-600 text-white rounded text-xs font-medium",children:""})]}),Dt?s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-500"})," ..."]}):ve?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"date",value:Oe(ve.SUS_HOPE_DD),disabled:!0,className:"flex-1 px-2 py-1.5 border border-gray-300 rounded bg-gray-100 text-gray-600 text-sm"}),s.jsx("span",{className:"text-gray-500",children:"~"}),Ge&&!o?s.jsx("input",{type:"date",value:At,onChange:ls,min:Oe(ve.SUS_HOPE_DD),className:"flex-1 px-2 py-1.5 border border-indigo-300 rounded bg-white text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):s.jsx("input",{type:"date",value:Fe?At:Oe(ve.MMT_SUS_HOPE_DD),disabled:!0,className:`flex-1 px-2 py-1.5 border rounded text-sm ${Fe?"border-orange-300 bg-orange-50 text-orange-700":"border-gray-300 bg-gray-100 text-gray-600"}`})]}),Ge&&!o&&At&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-indigo-600",children:[": ",It(ve.SUS_HOPE_DD,dt(At)),""]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",onClick:()=>{at(!1),nt(!1),ct(Oe(ve.MMT_SUS_HOPE_DD)),mt(null)},className:"px-3 py-1 bg-gray-400 hover:bg-gray-500 text-white rounded text-xs font-medium",children:""}),s.jsx("button",{type:"button",onClick:ds,disabled:!!xt,className:"px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white rounded text-xs font-medium disabled:opacity-50",children:""})]})]}),Fe&&!Ge&&!o&&s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"  (  )"}),s.jsx("button",{type:"button",onClick:()=>at(!0),className:"px-2 py-0.5 bg-orange-500 hover:bg-orange-600 text-white rounded text-xs font-medium",children:" "})]}),xt&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[s.jsx(Vr,{size:12}),xt]})]}):s.jsx("div",{className:"text-sm text-gray-500",children:"  "})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!o&&s.jsx("button",{onClick:ke,disabled:v,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${v?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:v?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>X(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:U,onClose:()=>Q(!1),onSave:Ss,workId:t.id,initialData:_e,workType:t.WRK_CD,customerId:(_t=t.customer)==null?void 0:_t.id,customerName:(qt=t.customer)==null?void 0:qt.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(y==null?void 0:y.kpiProdGrpCd)||(y==null?void 0:y.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(y==null?void 0:y.prodChgGb)||(y==null?void 0:y.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(y==null?void 0:y.chgKpiProdGrpCd)||(y==null?void 0:y.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(y==null?void 0:y.prodGrp)||(y==null?void 0:y.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:o}),s.jsx(el,{isOpen:Ne,onClose:()=>X(!1),ctrtId:t.CTRT_ID,custId:(jt=t.customer)==null?void 0:jt.id}),s.jsx(_m,{isOpen:xe,onClose:()=>fe(!1),onSave:he=>{le(he.INSTL_LOC),Re(he.VIEW_MOD_CD),De(he.VIEW_MOD_NM),fe(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(y==null?void 0:y.prodGrp)||(y==null?void 0:y.PROD_GRP),initialInstlLoc:Z||t.installLocation,initialViewModCd:se,initialViewModNm:be,showToast:r,readOnly:o}),s.jsx(Ba,{isOpen:re,onClose:()=>me(!1),onConfirm:st,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{equipmentData:y,installInfoData:_e,custRel:L,custRelOptions:Ee,memo:P,installLocationText:Z,order:t})})]})},YM=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1})=>{var st,Ft,_t,qt,jt,he;const c=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",u=t.WRK_DTL_TCD!=="0510",[h,m]=b.useState(!1),{equipmentData:_,filteringData:p}=ta(),{certifyRegconfInfo:g}=Za(),C=t.id||"",y=xa(C),S={..._||i||p||{},installedEquipments:y.installedEquipments.length>0?y.installedEquipments:(_==null?void 0:_.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:y.markedForRemoval.length>0?y.markedForRemoval:(_==null?void 0:_.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(y.removalStatus).length>0?y.removalStatus:(_==null?void 0:_.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:v,isPending:k}=Md(),L=()=>`work_complete_draft_${t.id}`,[M,P]=b.useState(""),[F,G]=b.useState(""),[B,I]=b.useState(""),[E,A]=b.useState(""),[Y,ee]=b.useState(""),[J,H]=b.useState(""),[V,K]=b.useState(!1),[j,te]=b.useState(""),[ce,R]=b.useState([]),[O,U]=b.useState(!1),[Q,q]=b.useState([]),[$,de]=b.useState(!1),[ae,_e]=b.useState(!1),[ie,Ne]=b.useState(""),[X,xe]=b.useState(""),[fe,Z]=b.useState(void 0),[le,se]=b.useState(void 0),[Re,be]=b.useState(!1),[De,re]=b.useState(!1),[me,ve]=b.useState(""),[et,Dt]=b.useState(""),[ot,At]=b.useState(""),[ct,Ge]=b.useState(!1),[at,xt]=b.useState(!1),[mt,Ve]=b.useState(null),[it,Fe]=b.useState([]),[nt,lt]=b.useState([]),[Mt,ut]=b.useState([]),[qe,Ee]=b.useState([]),[Ye,pe]=b.useState([]),[ge,Be]=b.useState(!1),[ue,we]=b.useState([]),[Je,Pe]=b.useState(!1),[Nt,Oe]=b.useState(""),[dt,gt]=b.useState(!1),[It,$e]=b.useState("B"),[$t,Ue]=b.useState(()=>{const ye=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(ye&&ye.length>=8)return`${ye.slice(0,4)}-${ye.slice(4,6)}-${ye.slice(6,8)}`;const je=new Date;return je.getFullYear()+"-"+String(je.getMonth()+1).padStart(2,"0")+"-"+String(je.getDate()).padStart(2,"0")});b.useEffect(()=>{if(c){(async()=>{try{const Me=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(Me){P(Me.CUST_REL||""),G((Me.WRK_PROC_CT||"").replace(/\\n/g,`
`)),I(Me.PSN_USE_CORP||""),A(Me.VOIP_USE_CORP||""),ee(Me.DTV_USE_CORP||"");const tt=Me.UP_CTRL_CL||(S==null?void 0:S.upCtrlCl)||"";console.log("[CompleteChange]  :",{API:Me.UP_CTRL_CL,:S==null?void 0:S.upCtrlCl,:tt}),H(tt),Ne(Me.NET_CL||""),xe(Me.NET_CL_NM||""),ve(Me.INSTL_LOC||""),Z({NET_CL:Me.NET_CL||"",NET_CL_NM:Me.NET_CL_NM||"",WRNG_TP:Me.WRNG_TP||"",INSTL_TP:Me.INSTL_TP||"",CB_WRNG_TP:Me.CB_WRNG_TP||"",CB_INSTL_TP:Me.CB_INSTL_TP||"",INOUT_LINE_TP:Me.INOUT_LINE_TP||"",INOUT_LEN:Me.INOUT_LEN||"",DVDR_YN:Me.DVDR_YN||"",BFR_LINE_YN:Me.BFR_LINE_YN||"",CUT_YN:Me.CUT_YN||"",TERM_NO:Me.TERM_NO||"",RCV_STS:Me.RCV_STS||"",SUBTAP_ID:Me.SUBTAP_ID||"",PORT_NUM:Me.PORT_NUM||"",EXTN_TP:Me.EXTN_TP||"",TAB_LBL:Me.TAB_LBL||"",CVT_LBL:Me.CVT_LBL||"",STB_LBL:Me.STB_LBL||""}),Dt(Me.VIEW_MOD_CD||""),At(Me.VIEW_MOD_NM||""),Me.VOIP_JOIN_CTRT_ID&&te(Me.VOIP_JOIN_CTRT_ID),Me.WRKR_CMPL_DT&&Me.WRKR_CMPL_DT.length>=8&&Ue(`${Me.WRKR_CMPL_DT.slice(0,4)}-${Me.WRKR_CMPL_DT.slice(4,6)}-${Me.WRKR_CMPL_DT.slice(6,8)}`)}}catch(Me){console.error("[WorkCompleteChange]     :",Me)}m(!0)})();return}const ye=localStorage.getItem(L());if(ye)try{const je=JSON.parse(ye);P(je.custRel||""),G(je.memo||""),I(je.internetUse||""),A(je.voipUse||""),ee(je.dtvUse||""),H(je.upCtrlCl||""),Ne(je.networkType||""),xe(je.networkTypeName||""),ve(je.installLocationText||""),Z(je.installInfoData),se(je.removalInfoData),Dt(je.viewModCd||""),At(je.viewModNm||""),je.voipJoinCtrtId&&te(je.voipJoinCtrtId)}catch(je){console.error("[WorkCompleteChange] localStorage  :",je)}m(!0)},[t.id,c]),b.useEffect(()=>{if(!h||c)return;const ye={custRel:M,memo:F,internetUse:B,voipUse:E,dtvUse:Y,upCtrlCl:J,networkType:ie,networkTypeName:X,installLocationText:me,installInfoData:fe,removalInfoData:le,viewModCd:et,viewModNm:ot,voipJoinCtrtId:j,savedAt:new Date().toISOString()};localStorage.setItem(L(),JSON.stringify(ye))},[M,F,B,E,Y,J,ie,X,me,fe,le,et,ot,j,h,c]),b.useEffect(()=>{(async()=>{try{const je=await po(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);je.CMCU005&&Fe(je.CMCU005.map(Me=>({value:Me.COMMON_CD,label:Me.COMMON_CD_NM}))),je.CMCT015&&(console.log("[CompleteChange]  CMCT015 :",je.CMCT015),lt(je.CMCT015.map(Me=>({value:Me.COMMON_CD,label:Me.COMMON_CD_NM})))),je.CMCU057&&ut(je.CMCU057.map(Me=>({value:Me.COMMON_CD,label:Me.COMMON_CD_NM}))),je.CMCU110&&Ee(je.CMCU110.map(Me=>({value:Me.COMMON_CD,label:Me.COMMON_CD_NM}))),je.CMCU148&&pe(je.CMCU148.map(Me=>({value:Me.COMMON_CD,label:Me.COMMON_CD_NM})))}catch(je){console.error("[WorkCompleteChange]   :",je)}})()},[]),b.useEffect(()=>{(async()=>{try{const je=await Ac();we(je||[]),console.log("[CompleteChange] LGHV  :",je==null?void 0:je.length);const Me=t.PROD_CD||t.BASIC_PROD_CD||"";if(Me&&je&&je.length>0){const tt=je.some(Te=>Te.PROD_CD===Me);Be(tt),console.log("[CompleteChange] LGHV STB :",tt,"PROD_CD:",Me)}}catch(je){console.error("[CompleteChange] LGHV    :",je)}})()},[t.id]),b.useEffect(()=>{(async()=>{const je=t.PROD_CD||t.PROD_CD||"",Me=(S==null?void 0:S.prodPromoInfo)||[];if(je==="PD10018480")console.log("[CompleteChange] OTT   :",je),gt(!0),$e("C");else if(Me.some(bt=>bt.PROD_CD==="PD10018160"))console.log("[CompleteChange] OTT   : PD10018160"),gt(!0),$e("B");else{gt(!1);return}const tt=t.id||"",Te=t.directionId||t.WRK_DRCTN_ID||"";if(tt&&Te)try{const bt=await v1({WRK_ID:tt,WRK_DRCTN_ID:Te,DATA_TYPE:je==="PD10018480"?"C":"B"});bt!=null&&bt.EQT_SERNO&&(console.log("[CompleteChange]  OTT :",bt.EQT_SERNO),Oe(bt.EQT_SERNO))}catch(bt){console.error("[CompleteChange] OTT   :",bt)}})()},[t.PROD_CD,t.id,t.directionId,S==null?void 0:S.prodPromoInfo]),b.useEffect(()=>{S!=null&&S.upCtrlCl&&!J?(console.log("[CompleteChange] equipmentData  :",S.upCtrlCl),H(S.upCtrlCl)):!J&&h&&!c&&(console.log("[CompleteChange]   : 01 ()"),H("01"))},[S==null?void 0:S.upCtrlCl,h,c,J]),b.useEffect(()=>{var Me;if(c)return;const ye=((Me=t.customer)==null?void 0:Me.id)||t.CUST_ID;if(!ye)return;(async()=>{try{console.log("[WorkCompleteChange]     :",ye);const tt=await gm({CUST_ID:ye});console.log("[WorkCompleteChange]   :",tt),q(tt||[])}catch(tt){console.error("[WorkCompleteChange]     :",tt),q([])}})()},[(st=t.customer)==null?void 0:st.id,t.CUST_ID,c]),b.useEffect(()=>{if(c)return;if(Q.length===0){console.log("[WorkCompleteChange]     ...");return}const ye=t.PROD_GRP||"",je=t.VOIP_PROD_CD||"",Me=t.ISP_PROD_CD||"",tt=t.WRK_STAT_CD||"",Te=t.ADDR_ORD||"";if(console.log("[WorkCompleteChange]   :",{prodGrp:ye,voipProdCd:je,ispProdCd:Me,wrkStatCd:tt,addrOrd:Te,customerCtrtListCount:Q.length}),ye==="V"&&!je){const bt=Q.filter(St=>{const Et=St.PROD_GRP||"",ze=St.CTRT_STAT||"",ht=St.ADDR_ORD||St.addr_ord||"";return(Et==="C"||Et==="D"||Et==="I")&&ze==="20"&&(!Te||ht===Te)});console.log("[WorkCompleteChange] VoIP   :",bt),bt.length<1&&tt==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const Ke=[{value:"",label:""},...bt.map(St=>({value:St.CTRT_ID||"",label:`[${St.CTRT_ID}] ${St.BASIC_PROD_CD_NM||St.PROD_NM||""}`}))];R(Ke),U(!0);return}if(ye==="I"&&Me){const bt=Q.filter(St=>{const Et=St.PROD_GRP||"",ze=St.CTRT_STAT||"",ht=St.ADDR_ORD||St.addr_ord||"",Lt=St.ISP_JOIN_ID||"",Bt=St.KPI_PROD_GRP_CD||"";return(Et==="D"||Et==="C")&&ze==="20"&&!Lt&&Bt==="D"&&(!Te||ht===Te)});console.log("[WorkCompleteChange] ISP   :",bt),bt.length<1&&tt==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const Ke=[{value:"",label:""},...bt.map(St=>({value:St.CTRT_ID||"",label:`[${St.CTRT_ID}] ${St.BASIC_PROD_CD_NM||St.PROD_NM||""}`}))];R(Ke),U(!0);return}U(!1),R([])},[t.id,t.WRK_STAT_CD,c,r,Q]);const ss=()=>{const ye=[];t.WRKR_ID||""||ye.push("  ."),M||ye.push("  ."),fe!=null&&fe.NET_CL||ye.push(" ."),fe!=null&&fe.WRNG_TP||ye.push(" ."),fe!=null&&fe.INSTL_TP||ye.push(" ."),!me&&!t.installLocation&&ye.push(" ."),$t||ye.push(" ."),B||ye.push("  ."),E||ye.push("VoIP  ."),Y||ye.push("DTV  .");const Me=t.PROD_GRP||"",tt=t.VOIP_PROD_CD||"",Te=t.ISP_PROD_CD||"";Me==="V"&&!tt&&O&&(j||ye.push("VOIP    .")),Me==="I"&&Te&&O&&(j||ye.push("  ISP .    ."));const bt=(S==null?void 0:S.installedEquipments)||[];return Me!=="V"&&bt.length<1&&ye.push("()  ."),dt&&!Nt&&ye.push("OTT   OTT BOX   ."),ye},ls=ye=>{Z(ye),ye.NET_CL&&Ne(ye.NET_CL),ye.NET_CL_NM&&xe(ye.NET_CL_NM),r==null||r("  .","success")},ds=ye=>{se(ye),r==null||r("  .","success")},vs=()=>{if(k)return;const ye=ss();if(ye.length>0){ye.forEach(Me=>r==null?void 0:r(Me,"error"));return}(t.PROD_GRP||"")!=="V"?xt(!0):Ge(!0)},Ss=ye=>{Ve(ye),xt(!1),Ge(!0)},ke=(ye,je=!1)=>{if(!ye||ye.length===0)return[];const Me=localStorage.getItem("userInfo"),tt=Me?JSON.parse(Me):{},Te=tt.userId||"A20130708",bt=(S==null?void 0:S.removalStatus)||{},Ke=(Bt,Yt)=>Bt==="1"||Bt==="Y"||Yt==="1"||Yt==="Y"?"1":"0",St=(S==null?void 0:S.removedEquipments)||[],Et=(Bt,Yt)=>{const Xt=St.find(ts=>(ts.itemMidCd===Bt||ts.ITEM_MID_CD===Bt)&&ts[Yt]);return(Xt==null?void 0:Xt[Yt])||""},ze=Bt=>Et(Bt,"BASIC_PROD_CMPS_ID"),ht=Bt=>Et(Bt,"LENT")||Et(Bt,"LENT_YN"),Lt=Bt=>Et(Bt,"SVC_CMPS_ID");return ye.map(Bt=>{var cs,ms,Ys;const Yt=Bt.EQT_NO||Bt.id||((cs=Bt.actualEquipment)==null?void 0:cs.id)||"",Xt=bt[Yt]||{},ts=je?{}:{CRR_TSK_CL:"01",CHG_UID:Te},Ut=je?{CRR_TSK_CL:"02",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||tt.crrId||"01",WRKR_ID:Te,REG_UID:Te,EQT_LOSS_YN:Ke(Bt.EQT_LOSS_YN,Xt.EQT_LOSS_YN),PART_LOSS_BRK_YN:Ke(Bt.PART_LOSS_BRK_YN,Xt.PART_LOSS_BRK_YN),EQT_BRK_YN:Ke(Bt.EQT_BRK_YN,Xt.EQT_BRK_YN),EQT_CABL_LOSS_YN:Ke(Bt.EQT_CABL_LOSS_YN,Xt.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Ke(Bt.EQT_CRDL_LOSS_YN,Xt.EQT_CRDL_LOSS_YN)}:{},Is=t.DTL_CTRT_ID||t.CTRT_ID||"",Cs=Bt.CTRT_ID||t.CTRT_ID||"";if(Bt.actualEquipment){const Ps=Bt.actualEquipment,rt=Bt.contractEquipment||{},Wt=Ps.itemMidCd||Ps.ITEM_MID_CD||"",bs=rt.BASIC_PROD_CMPS_ID||Bt.BASIC_PROD_CMPS_ID||ze(Wt),zt=rt.LENT||rt.LENT_YN||Bt.LENT||Bt.lentYn||Bt.LENT_YN||ht(Wt),ws=rt.SVC_CMPS_ID||Bt.SVC_CMPS_ID||Lt(Wt);return{...Ps,EQT_NO:Ps.id,EQT_SERNO:Ps.serialNumber,ITEM_MID_CD:Wt,EQT_CL_CD:Ps.eqtClCd,MAC_ADDRESS:Bt.macAddress||Ps.macAddress,WRK_ID:t.id,CUST_ID:(ms=t.customer)==null?void 0:ms.id,CTRT_ID:je?Cs:Is,WRK_CD:t.WRK_CD,REG_UID:Te,SVC_CMPS_ID:ws,BASIC_PROD_CMPS_ID:bs,PROD_CMPS_ID:rt.PROD_CMPS_ID||Bt.PROD_CMPS_ID||"",SVC_CD:rt.SVC_CD||Bt.SVC_CD||"",PROD_CD:rt.PROD_CD||Bt.PROD_CD||"",LENT_YN:zt,EQT_CHG_GB:Bt.EQT_CHG_GB||"01",...ts,...Ut}}const Us=Bt.ITEM_MID_CD||Bt.itemMidCd||"",_s=Bt.BASIC_PROD_CMPS_ID||ze(Us),Es=Bt.LENT||Bt.LENT_YN||Bt.lentYn||ht(Us),Ls=Bt.SVC_CMPS_ID||Lt(Us);return{...Bt,EQT_NO:Bt.EQT_NO||Bt.id||"",EQT_SERNO:Bt.EQT_SERNO||Bt.serialNumber||"",ITEM_MID_CD:Us,EQT_CL_CD:Bt.EQT_CL_CD||Bt.eqtClCd||"",MAC_ADDRESS:Bt.MAC_ADDRESS||Bt.macAddress||"",SVC_CMPS_ID:Ls,BASIC_PROD_CMPS_ID:_s,LENT_YN:Es,PROD_CD:Bt.PROD_CD||"",SVC_CD:Bt.SVC_CD||"",WRK_ID:t.id,CUST_ID:(Ys=t.customer)==null?void 0:Ys.id,CTRT_ID:je?Cs:Is,WRK_CD:t.WRK_CD,REG_UID:Te,...ts,...Ut}})},ft=async()=>{var Us,_s,Es,Ls,cs,ms,Ys,Ps,rt,Wt,bs;const ye=$t.replace(/-/g,""),je=localStorage.getItem("userInfo"),Me=je?JSON.parse(je):{},tt=Me.userId||"A20130708",Te=o||d0(t.OP_LNKD_CD),bt=await y_(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let Ke="";if(Te){let zt=(S==null?void 0:S.prodPromoInfo)||[];if(zt.length===0)try{console.log("[CompleteChange] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),zt=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"05"}),console.log("[CompleteChange] getProdPromotionInfo fallback :",zt.length,"")}catch(Zt){console.log("[CompleteChange] getProdPromotionInfo fallback :",Zt)}const ws=zt.filter(Zt=>(Zt.PROD_CMPS_CL==="21"||Zt.PROD_CMPS_CL==="22")&&(Zt.PROD_STAT_CD==="10"||Zt.PROD_STAT_CD==="20")).map(Zt=>Zt.PROD_CD).filter(Zt=>Zt);Ke=ws.length>0?ws.join(",")+",":"",console.log("[CompleteChange] ADD_ON :",Ke)}const St=(S==null?void 0:S.installedEquipments)||[];if(Te&&St.length>0&&!g){r==null||r("  .","error");return}if(Te&&g)try{const zt=t.OLD_PROD_CD||"",ws=t.CTRT_ID||"",Zt=t.SO_ID||"";let Ds="";const js=await N1(),Ws=(await qa("CMIF006")).map(Os=>Os.code);console.log("[CompleteChange] certifyProdList:",js.length,"certifySoIds:",Ws);let Vs=!1;if(js.includes(zt))try{const Os=await $g({CTRT_ID:ws,CUST_ID:((Us=t.customer)==null?void 0:Us.id)||t.CUST_ID||"",SO_ID:Zt,REG_UID:tt,WRK_ID:t.id||""}),xs=Array.isArray(Os)?Os[0]:Os;console.log("[CompleteChange] CL-08 result:",xs,"oldCtrtId:",ws),xs&&!xs.ERROR&&xs.CONT_ID===ws&&(Vs=!0)}catch(Os){console.log("[CompleteChange] CL-08 query failed:",Os)}else console.log("[CompleteChange] OLD_PROD_CD not in certify_prod, skip CL-08");if(Vs)if(t.IS_CERTIFY_PROD==1&&Ws.includes(Zt))Ds="U",console.log("[CompleteChange] CERTIFY_TYPE=U (OLD+NEW certified)");else{const Os=await x6(t,tt,ws);if(!Os.success){r==null||r(`  : ${Os.error}`,"error");return}}else t.IS_CERTIFY_PROD==1&&Ws.includes(Zt)&&(Ds="C",console.log("[CompleteChange] CERTIFY_TYPE=C (NEW only certified)"));if(Ds){const Os=await p_({order:t,workerId:tt,certifyRegconfInfo:g,addOnParam:Ke,reason:Ds==="U"?"":"",certifyType:Ds,contIdOld:Ds==="U"?ws:void 0});if(!Os.success){r==null||r(` : ${Os.message}`,"error");return}console.log("[CompleteChange] CL-04    ")}}catch(zt){console.error("[CompleteChange] CL-04  :",zt),r==null||r(`  : ${zt.message||"   "}`,"error");return}let Et="";const ze=t.CTRT_ID||"",ht=t.OLD_PROD_CD||"",Lt=ht&&ue.length>0&&ue.some(zt=>zt.PROD_CD===ht),Bt=(S==null?void 0:S.removedEquipments)||[];if(ge&&Lt)console.log("[CompleteChange] LGHVLGHV :   skip ( )");else if(!bt&&Bt.length>0)try{let zt="SMR05",ws="";if(Lt){zt="STB_DEL";const Ws=Bt.find(Vs=>{var Os,xs;return(Vs.ITEM_MID_CD||Vs.itemMidCd||((Os=Vs.actualEquipment)==null?void 0:Os.ITEM_MID_CD)||((xs=Vs.actualEquipment)==null?void 0:xs.itemMidCd))==="04"});Ws&&(ws=Ws.EQT_NO||Ws.id||((_s=Ws.actualEquipment)==null?void 0:_s.EQT_NO)||((Es=Ws.actualEquipment)==null?void 0:Es.id)||"")}let Zt="";try{const Ws=await Rl({CTRT_ID:ze,RCPT_ID:t.RCPT_ID||"",PROC_CL:"TERM",WRK_CD:"05"});console.log("[CompleteChange] getProdPromotionInfo :",Ws);const Vs=Ws.find(Os=>Os.PROD_CMPS_CL==="23");Vs&&(Zt=Vs.PROD_CMPS_ID||""),console.log("[CompleteChange] EQT_PROD_CMPS_ID:",Zt)}catch(Ws){console.log("[CompleteChange] getProdPromotionInfo   ():",Ws)}const Ds=t.END_PROD_CD||t.VOIP_PROD_CD||"";let js="";Ds&&(js=ze),console.log("[CompleteChange]   :",{msgId:zt,ctrtId:ze,eqtProdCmpsId:Zt});const hs=await _a({MSG_ID:zt,CUST_ID:((Ls=t.customer)==null?void 0:Ls.id)||t.CUST_ID||"",CTRT_ID:ze,SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Zt,PROD_CD:"",ITV_USR_ID:"",IP_CNT:"",ETC_1:ws,ETC_2:"",ETC_3:"",ETC_4:"",SUB_PROD_CD:"",IF_DTL_ID:"",WRK_ID:t.id||"",REG_UID:tt,VOIP_JOIN_CTRT_ID:js||j||"",WTIME:"3"});if(console.log("[CompleteChange]    :",hs),(hs==null?void 0:hs.code)==="SUCCESS"||(hs==null?void 0:hs.code)==="PARTIAL")Et=(hs==null?void 0:hs.IF_DTL_ID)||"",console.log("[CompleteChange] removal signal SUCCESS, IF_DTL_ID:",Et);else{const Ws=(hs==null?void 0:hs.message)||(hs==null?void 0:hs.rawResult)||"";console.warn("[CompleteChange] removal signal FAILED -  :",Ws),r==null||r(`   : ${Ws}`,"warning")}}catch(zt){console.warn("[CompleteChange] removal signal error -  :",zt),r==null||r("     .","warning")}const Yt=t.DTL_CTRT_ID||t.CTRT_ID||"";console.log("========== [CompleteChange]    =========="),console.log("[DEBUG] order.CTRT_ID (OLD ):",t.CTRT_ID),console.log("[DEBUG] order.DTL_CTRT_ID (NEW ):",t.DTL_CTRT_ID),console.log("[DEBUG] order.OLD_CTRT_ID:",t.OLD_CTRT_ID),console.log("[DEBUG] ctrtIdForProductChange (workInfo ):",Yt),console.log("[DEBUG]   (installedEquipments):",((cs=S==null?void 0:S.installedEquipments)==null?void 0:cs.length)||0,""),(ms=S==null?void 0:S.installedEquipments)==null||ms.forEach((zt,ws)=>{var Zt,Ds,js,hs,Ws;console.log(`[DEBUG] [${ws}]:`,{EQT_NO:zt.EQT_NO||zt.id||((Zt=zt.actualEquipment)==null?void 0:Zt.id),EQT_SERNO:zt.EQT_SERNO||zt.serialNumber||((Ds=zt.actualEquipment)==null?void 0:Ds.serialNumber),CTRT_ID:zt.CTRT_ID,SVC_CMPS_ID:zt.SVC_CMPS_ID||((js=zt.contractEquipment)==null?void 0:js.SVC_CMPS_ID),BASIC_PROD_CMPS_ID:zt.BASIC_PROD_CMPS_ID||((hs=zt.contractEquipment)==null?void 0:hs.BASIC_PROD_CMPS_ID),LENT_YN:zt.LENT_YN||zt.LENT||((Ws=zt.contractEquipment)==null?void 0:Ws.LENT)})}),console.log("[DEBUG]   (removedEquipments):",((Ys=S==null?void 0:S.removedEquipments)==null?void 0:Ys.length)||0,""),(Ps=S==null?void 0:S.removedEquipments)==null||Ps.forEach((zt,ws)=>{var Zt,Ds,js,hs,Ws;console.log(`[DEBUG] [${ws}]  :`,JSON.stringify(zt,null,2)),console.log(`[DEBUG] [${ws}] :`,{EQT_NO:zt.EQT_NO||zt.id||((Zt=zt.actualEquipment)==null?void 0:Zt.id),EQT_SERNO:zt.EQT_SERNO||zt.serialNumber||((Ds=zt.actualEquipment)==null?void 0:Ds.serialNumber),CTRT_ID:zt.CTRT_ID,SVC_CMPS_ID:zt.SVC_CMPS_ID||((js=zt.contractEquipment)==null?void 0:js.SVC_CMPS_ID),BASIC_PROD_CMPS_ID:zt.BASIC_PROD_CMPS_ID||((hs=zt.contractEquipment)==null?void 0:hs.BASIC_PROD_CMPS_ID),LENT_YN:zt.LENT_YN||zt.LENT||((Ws=zt.contractEquipment)==null?void 0:Ws.LENT),ITEM_MID_CD:zt.ITEM_MID_CD||zt.itemMidCd,ITEM_CD:zt.ITEM_CD,EQT_CL_CD:zt.EQT_CL_CD||zt.eqtClCd,PROD_CMPS_ID:zt.PROD_CMPS_ID})});const Xt=ke((S==null?void 0:S.installedEquipments)||[],!1),ts=ke((S==null?void 0:S.removedEquipments)||[],!0);console.log("[DEBUG]   (equipmentList):",Xt.length,""),Xt.forEach((zt,ws)=>{console.log(`[DEBUG]  [${ws}]:`,{EQT_NO:zt.EQT_NO,CTRT_ID:zt.CTRT_ID,CRR_TSK_CL:zt.CRR_TSK_CL,SVC_CMPS_ID:zt.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:zt.BASIC_PROD_CMPS_ID})}),console.log("[DEBUG]   (removeEquipmentList):",ts.length,""),ts.forEach((zt,ws)=>{console.log(`[DEBUG]  [${ws}] :`,JSON.stringify(zt,null,2))}),console.log("========== [CompleteChange]    ==========");let Ut=t.WRK_DTL_TCD||"";Ut==="0550"?Ut="0560":Ut==="0510"&&(Ut="0520");const Is={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:Ut,CUST_ID:(rt=t.customer)==null?void 0:rt.id,CTRT_ID:Yt,RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||Me.crrId||"01",WRKR_ID:tt,WRKR_CMPL_DT:ye,MEMO:F||" ",STTL_YN:"Y",REG_UID:tt,CUST_REL:M,CNFM_CUST_NM:((Wt=t.customer)==null?void 0:Wt.name)||"",CNFM_CUST_TELNO:((bs=t.customer)==null?void 0:bs.contactNumber)||"",INSTL_LOC:me||t.installLocation||"",UP_CTRL_CL:J||"",PSN_USE_CORP:B||"",VOIP_USE_CORP:E||"",DTV_USE_CORP:Y||"",WRK_ACT_CL:"20",TV_TYPE:"",NET_CL:(fe==null?void 0:fe.NET_CL)||"",WRNG_TP:(fe==null?void 0:fe.WRNG_TP)||"",INSTL_TP:(fe==null?void 0:fe.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:j||"",ADD_ON:Ke||""},equipmentList:Xt,removeEquipmentList:ts,spendItemList:(S==null?void 0:S.spendItems)||[],agreementList:(S==null?void 0:S.agreements)||[],poleList:mt?[{WRK_ID:t.id,POLE_YN:mt.POLE_YN,LAN_GB:mt.LAN_GB||"",REG_UID:tt}]:[]},Cs=async()=>{var zt,ws,Zt;try{if(bt){console.log("[CompleteChange] FTTH :  skip ( )");return}const Ds=(S==null?void 0:S.installedEquipments)||[],js=t.OLD_PROD_CD||"",hs=ue.some(Rs=>Rs.PROD_CD===js);let Ws="SMR03";ge&&(Ws=hs?"PKG_CHG":"STB_CRT");const Vs=Rs=>Ds.find(Un=>{var Vn,si;return(Un.ITEM_MID_CD||Un.itemMidCd||((Vn=Un.actualEquipment)==null?void 0:Vn.ITEM_MID_CD)||((si=Un.actualEquipment)==null?void 0:si.itemMidCd))===Rs}),Os=Rs=>{var Un,Vn;return(Rs==null?void 0:Rs.EQT_NO)||(Rs==null?void 0:Rs.id)||((Un=Rs==null?void 0:Rs.actualEquipment)==null?void 0:Un.EQT_NO)||((Vn=Rs==null?void 0:Rs.actualEquipment)==null?void 0:Vn.id)||""},xs=t.BGN_PROD_CD||t.VOIP_PROD_CD||"",Br=t.BGN_PROD_GRP||t.PROD_GRP||"";let Pr="",ti="",Mr="",hn="";try{const Rs=await Rl({CTRT_ID:t.DTL_CTRT_ID||t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"05"}),Un=Rs.find(Ii=>Ii.PROD_CMPS_CL==="23");Un&&(Pr=Un.PROD_CMPS_ID||"");const Vn=Rs.find(Ii=>Ii.PROD_CMPS_CL==="11");Vn&&(ti=Vn.PROD_CD||"",hn=Vn.PROD_GRP||"");const si=Rs.filter(Ii=>Ii.BASIC_PROD_FL==="V").map(Ii=>Ii.PROD_CD);si.length>0&&(Mr=si.join(","))}catch(Rs){console.log("[CompleteChange] getProdPromotionInfo for install signal failed:",Rs)}let fr="";if(xs){const Rs=Vs("08");Rs&&(fr=Os(Rs))}else{for(const Rs of["05","01","03"]){const Un=Vs(Rs);if(Un){fr=Os(Un);break}}if(!fr&&hn==="I"){const Rs=Vs("02");Rs&&(fr=Os(Rs))}if(!fr){const Rs=Vs("08");Rs&&(fr=Os(Rs))}}let ci="";if(xs){const Rs=Vs("02");Rs&&(ci=Os(Rs))}else{const Rs=Vs("04");Rs?ci=Os(Rs):ci=(fe==null?void 0:fe.NET_CL)||""}const $r=Os(Vs("07")),sa=hn==="C"?Os(Vs("02")):"";let Ar="";if(Vs("10")&&Br==="V"&&(Ar=Os(Vs("10"))),t.BGN_ISP_PROD_CD||t.ISP_PROD_CD||""){const Rs=Vs("21");Rs&&(Ar=Os(Rs))}let Ir=t.id||"";const Ga=Ds.find(Rs=>{var Un,Vn;return(Rs.EQT_CL_CD||Rs.eqtClCd||((Un=Rs.actualEquipment)==null?void 0:Un.EQT_CL_CD)||((Vn=Rs.actualEquipment)==null?void 0:Vn.eqtClCd))==="091003"});if(Ga)Ir=Os(Ga);else{const Rs=Ds.find(Un=>{var Vn,si;return(Un.EQT_CL_CD||Un.eqtClCd||((Vn=Un.actualEquipment)==null?void 0:Vn.EQT_CL_CD)||((si=Un.actualEquipment)==null?void 0:si.eqtClCd))==="092201"});Rs&&(Ir=(Rs==null?void 0:Rs.MAC_ADDRESS)||(Rs==null?void 0:Rs.macAddress)||((zt=Rs==null?void 0:Rs.actualEquipment)==null?void 0:zt.MAC_ADDRESS)||((ws=Rs==null?void 0:Rs.actualEquipment)==null?void 0:ws.macAddress)||"")}let tl="";xs?tl=t.CTRT_ID||"":tl=j||"",console.log("[CompleteChange]  :",{msgId:Ws,eqtNo:fr,instProdCd:ti,instEqtProdCmpsId:Pr,subProdCd:Mr}),await _a({MSG_ID:Ws,CUST_ID:((Zt=t.customer)==null?void 0:Zt.id)||t.CUST_ID||"",CTRT_ID:t.DTL_CTRT_ID||t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:fr,EQT_PROD_CMPS_ID:Pr,PROD_CD:ti,ITV_USR_ID:"",IP_CNT:"",ETC_1:ci,ETC_2:$r,ETC_3:sa,ETC_4:Ar,SUB_PROD_CD:Mr,IF_DTL_ID:"",WRK_ID:Ir,REG_UID:tt,VOIP_JOIN_CTRT_ID:tl,WTIME:"3"}),console.log("[CompleteChange]   ")}catch(Ds){console.log("[CompleteChange]     (  ):",Ds)}};v(Is,{onSuccess:zt=>{zt.code==="SUCCESS"||zt.code==="OK"?(localStorage.removeItem(L()),t.WRK_STAT_CD="3",Cs(),r==null||r("  .","success"),n()):r==null||r(zt.message||"   .","error",!0)},onError:zt=>{r==null||r(zt.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[k&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[O?s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:j,onValueChange:te,options:ce,placeholder:" ",required:!0,disabled:c})]}):s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx("input",{type:"text",value:"",readOnly:!0,disabled:!0,className:"w-full min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:X||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>de(!0),className:`px-3 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${c?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:c?"":""}),u&&s.jsx("button",{type:"button",onClick:()=>_e(!0),className:`px-3 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${c?"bg-gray-500 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:c?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:M,onValueChange:P,options:it,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{children:me||t.installLocation||""}),ot&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(: ",ot,")"]})]}),s.jsx("button",{type:"button",onClick:()=>re(!0),className:`px-4 py-2 rounded-lg font-bold text-sm whitespace-nowrap ${c?"bg-gray-500 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:c?"":""})]})]}),((S==null?void 0:S.kpiProdGrpCd)==="D"||(S==null?void 0:S.prodGrp)==="D"||t.PROD_GRP==="D"||(t.PROD_NM||"").includes("DTV"))&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(sn,{value:J,onValueChange:H,options:nt,placeholder:"",disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:F,onChange:ye=>G(ye.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:c,disabled:c}),!c&&s.jsxs("p",{className:`text-xs text-right mt-1 ${F.length>=500?"text-red-500":"text-gray-400"}`,children:[F.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:$t,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>K(!V),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${V?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),V&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"DTV ()"}),s.jsx(sn,{value:Y,onValueChange:ee,options:Ye,placeholder:"",disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"ISP ()"}),s.jsx(sn,{value:B,onValueChange:I,options:Mt,placeholder:"",disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"VoIP (VoIP)"}),s.jsx(sn,{value:E,onValueChange:A,options:qe,placeholder:"",disabled:c})]})]})]}),dt&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["OTT BOX  ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Nt,readOnly:!0,placeholder:"SER_NO   ",className:"flex-1 px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600"}),s.jsxs("button",{type:"button",onClick:()=>Pe(!0),disabled:c,className:`px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 ${c?"bg-gray-400 text-white cursor-not-allowed":Nt?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"SER_NO"]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!c&&s.jsx("button",{onClick:vs,disabled:k,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${k?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:k?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>be(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:$,onClose:()=>de(!1),onSave:ls,workId:t.id,initialData:fe,workType:t.WRK_CD,customerId:(Ft=t.customer)==null?void 0:Ft.id,customerName:(_t=t.customer)==null?void 0:_t.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD,kpiProdGrpCd:(S==null?void 0:S.kpiProdGrpCd)||(S==null?void 0:S.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:"01",chgKpiProdGrpCd:(S==null?void 0:S.chgKpiProdGrpCd)||(S==null?void 0:S.CHG_KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodGrp:(S==null?void 0:S.prodGrp)||(S==null?void 0:S.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:c}),s.jsx(wc,{isOpen:ae,onClose:()=>_e(!1),onSave:ds,workId:t.id,initialData:le,workType:"08",customerId:(qt=t.customer)==null?void 0:qt.id,customerName:(jt=t.customer)==null?void 0:jt.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD,kpiProdGrpCd:(S==null?void 0:S.kpiProdGrpCd)||(S==null?void 0:S.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:"02",chgKpiProdGrpCd:(S==null?void 0:S.chgKpiProdGrpCd)||(S==null?void 0:S.CHG_KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodGrp:(S==null?void 0:S.prodGrp)||(S==null?void 0:S.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:c}),s.jsx(el,{isOpen:Re,onClose:()=>be(!1),ctrtId:t.CTRT_ID,custId:(he=t.customer)==null?void 0:he.id}),s.jsx(_m,{isOpen:De,onClose:()=>re(!1),onSave:ye=>{ve(ye.INSTL_LOC),Dt(ye.VIEW_MOD_CD),At(ye.VIEW_MOD_NM),re(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(S==null?void 0:S.prodGrp)||(S==null?void 0:S.PROD_GRP),initialInstlLoc:me||t.installLocation,initialViewModCd:et,initialViewModNm:ot,showToast:r,readOnly:c}),s.jsx(b_,{isOpen:at,onClose:()=>xt(!1),onSave:Ss,soId:t.SO_ID||""}),s.jsx(Ba,{isOpen:ct,onClose:()=>Ge(!1),onConfirm:ft,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{equipmentData:S,installInfoData:fe,custRel:M,custRelOptions:it,memo:F,installLocationText:me,order:t})}),s.jsx(iN,{isOpen:Je,onClose:()=>Pe(!1),onSave:ye=>{Oe(ye),r==null||r("OTT  .","success")},wrkId:t.id||"",wrkDrctnId:t.directionId||t.WRK_DRCTN_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",dataType:It,showToast:r,readOnly:c})]})},lN=({isOpen:t,onClose:e,wrkCd:n,wrkId:r,rcptId:i})=>{const[a,o]=b.useState(!1),[c,u]=b.useState(null),[h,m]=b.useState(null),_=n==="07"?"":"";b.useEffect(()=>{t&&r&&p()},[t,r,n]);const p=async()=>{o(!0),m(null);try{const C=await x_({WRK_CD:n,WRK_ID:r,RCPT_ID:i});C?u(C):m("   .")}catch(C){console.error("  :",C),m(C.message||"  .")}finally{o(!1)}},g=s.jsx("button",{onClick:e,className:"w-full px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors",children:""});return s.jsx(Ra,{isOpen:t,onClose:e,title:_,size:"medium",footer:g,children:a?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:" ..."})]}):h?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-red-500 mb-2",children:h}),s.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700",children:" "})]}):c?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:c.MVM_TP_NM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:c.PROD_NM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:c.HOPE_DTTM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium",children:c.WRK_STAT_NM||"-"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"text-gray-900 font-medium whitespace-pre-wrap",children:c.ADDR_ORD||"-"})]})]}):s.jsx("div",{className:"text-center py-8 text-gray-500",children:" ."})})},VM=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1,certifyReason:c})=>{var ls,ds,vs,Ss;const u=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",h=t.WRK_CD==="07",[m,_]=b.useState(!1),{equipmentData:p,filteringData:g}=ta(),{certifyRegconfInfo:C}=Za(),y=t.id||"",S=xa(y),v={...p||i||g||{},installedEquipments:S.installedEquipments.length>0?S.installedEquipments:(p==null?void 0:p.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:S.markedForRemoval.length>0?S.markedForRemoval:(p==null?void 0:p.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(S.removalStatus).length>0?S.removalStatus:(p==null?void 0:p.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:k,isPending:L}=Md(),M=()=>`work_complete_draft_${t.id}`,[P,F]=b.useState(""),[G,B]=b.useState(""),[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(""),[H,V]=b.useState(""),[K,j]=b.useState(!1),[te,ce]=b.useState(!1),[R,O]=b.useState(!1),[U,Q]=b.useState(""),[q,$]=b.useState([]),[de,ae]=b.useState(!1),[_e,ie]=b.useState([]),[Ne,X]=b.useState(!1),[xe,fe]=b.useState(""),[Z,le]=b.useState(""),[se,Re]=b.useState(void 0),[be,De]=b.useState(!1),[re,me]=b.useState(!1),[ve,et]=b.useState(""),[Dt,ot]=b.useState(""),[At,ct]=b.useState(""),[Ge,at]=b.useState(!1),[xt,mt]=b.useState(!1),[Ve,it]=b.useState(!1),[Fe,nt]=b.useState(null),[lt,Mt]=b.useState([]),[ut,qe]=b.useState([]),[Ee,Ye]=b.useState([]),[pe,ge]=b.useState([]),[Be,ue]=b.useState([]),[we,Je]=b.useState(!1),[Pe,Nt]=b.useState([]),[Oe,dt]=b.useState(()=>{const ke=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(ke&&ke.length>=8)return`${ke.slice(0,4)}-${ke.slice(4,6)}-${ke.slice(6,8)}`;const ft=new Date;return ft.getFullYear()+"-"+String(ft.getMonth()+1).padStart(2,"0")+"-"+String(ft.getDate()).padStart(2,"0")});b.useEffect(()=>{if(u){(async()=>{try{const st=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(st){F(st.CUST_REL||""),B((st.WRK_PROC_CT||"").replace(/\\n/g,`
`)),E(st.PSN_USE_CORP||""),Y(st.VOIP_USE_CORP||""),J(st.DTV_USE_CORP||"");const Ft=st.UP_CTRL_CL||(v==null?void 0:v.upCtrlCl)||"";console.log("[CompleteMoveRemoval]  :",{API:st.UP_CTRL_CL,:v==null?void 0:v.upCtrlCl,:Ft}),V(Ft),fe(st.NET_CL||""),le(st.NET_CL_NM||""),et(st.INSTL_LOC||""),Re({NET_CL:st.NET_CL||"",NET_CL_NM:st.NET_CL_NM||"",WRNG_TP:st.WRNG_TP||"",INSTL_TP:st.INSTL_TP||"",CB_WRNG_TP:st.CB_WRNG_TP||"",CB_INSTL_TP:st.CB_INSTL_TP||"",INOUT_LINE_TP:st.INOUT_LINE_TP||"",INOUT_LEN:st.INOUT_LEN||"",DVDR_YN:st.DVDR_YN||"",BFR_LINE_YN:st.BFR_LINE_YN||"",CUT_YN:st.CUT_YN||"",TERM_NO:st.TERM_NO||"",RCV_STS:st.RCV_STS||"",SUBTAP_ID:st.SUBTAP_ID||"",PORT_NUM:st.PORT_NUM||"",EXTN_TP:st.EXTN_TP||"",TAB_LBL:st.TAB_LBL||"",CVT_LBL:st.CVT_LBL||"",STB_LBL:st.STB_LBL||""}),st.VOIP_JOIN_CTRT_ID&&Q(st.VOIP_JOIN_CTRT_ID),(st.CHK_CUST_ADDR==="true"||st.CHK_CUST_ADDR==="Y")&&j(!0),(st.CHK_PYM_ADDR==="true"||st.CHK_PYM_ADDR==="Y")&&ce(!0),st.WRKR_CMPL_DT&&st.WRKR_CMPL_DT.length>=8&&dt(`${st.WRKR_CMPL_DT.slice(0,4)}-${st.WRKR_CMPL_DT.slice(4,6)}-${st.WRKR_CMPL_DT.slice(6,8)}`)}}catch(st){console.error("[WorkCompleteMoveRemoval]     :",st)}_(!0)})();return}const ke=localStorage.getItem(M());if(ke)try{const ft=JSON.parse(ke);F(ft.custRel||""),B(ft.memo||""),E(ft.internetUse||""),Y(ft.voipUse||""),J(ft.dtvUse||""),V(ft.upCtrlCl||""),fe(ft.networkType||""),le(ft.networkTypeName||""),et(ft.installLocationText||""),Re(ft.installInfoData),ft.voipJoinCtrtId&&Q(ft.voipJoinCtrtId),ft.chkCustAddr!==void 0&&j(ft.chkCustAddr),ft.chkPymAddr!==void 0&&ce(ft.chkPymAddr)}catch(ft){console.error("[WorkCompleteMoveRemoval] localStorage  :",ft)}_(!0)},[t.id,u]),b.useEffect(()=>{if(!m||u)return;const ke={custRel:P,memo:G,internetUse:I,voipUse:A,dtvUse:ee,upCtrlCl:H,networkType:xe,networkTypeName:Z,installLocationText:ve,installInfoData:se,voipJoinCtrtId:U,chkCustAddr:K,chkPymAddr:te,savedAt:new Date().toISOString()};localStorage.setItem(M(),JSON.stringify(ke))},[P,G,I,A,ee,H,xe,Z,ve,se,U,K,te,m,u]),b.useEffect(()=>{(async()=>{try{const ft=await po(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);ft.CMCU005&&Mt(ft.CMCU005.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM}))),ft.CMCT015&&(console.log("[CompleteMoveRemoval]  CMCT015 :",ft.CMCT015),qe(ft.CMCT015.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM})))),ft.CMCU057&&Ye(ft.CMCU057.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM}))),ft.CMCU110&&ge(ft.CMCU110.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM}))),ft.CMCU148&&ue(ft.CMCU148.map(st=>({value:st.COMMON_CD,label:st.COMMON_CD_NM})))}catch(ft){console.error("[WorkCompleteMoveRemoval]   :",ft)}})()},[]),b.useEffect(()=>{(async()=>{try{const ft=await Ac();Nt(ft||[]),console.log("[CompleteInternalMove] LGHV  :",ft==null?void 0:ft.length);const st=t.PROD_CD||t.BASIC_PROD_CD||"";if(st&&ft&&ft.length>0){const Ft=ft.some(_t=>_t.PROD_CD===st);Je(Ft),console.log("[CompleteInternalMove] LGHV STB :",Ft,"PROD_CD:",st)}}catch(ft){console.error("[CompleteInternalMove] LGHV    :",ft)}})()},[t.id]),b.useEffect(()=>{v!=null&&v.upCtrlCl&&!H?(console.log("[CompleteMoveRemoval] equipmentData  :",v.upCtrlCl),V(v.upCtrlCl)):!H&&m&&!u&&(console.log("[CompleteMoveRemoval]   : 01 ()"),V("01"))},[v==null?void 0:v.upCtrlCl,m,u,H]),b.useEffect(()=>{var st;if(u)return;const ke=((st=t.customer)==null?void 0:st.id)||t.CUST_ID;if(!ke)return;(async()=>{try{console.log("[WorkCompleteMoveRemoval]     :",ke);const Ft=await gm({CUST_ID:ke});console.log("[WorkCompleteMoveRemoval]   :",Ft),ie(Ft||[])}catch(Ft){console.error("[WorkCompleteMoveRemoval]     :",Ft),ie([])}})()},[(ls=t.customer)==null?void 0:ls.id,t.CUST_ID,u]),b.useEffect(()=>{if(u)return;if(_e.length===0){console.log("[WorkCompleteMoveRemoval]     ...");return}const ke=t.PROD_GRP||"",ft=t.VOIP_PROD_CD||"",st=t.ISP_PROD_CD||"",Ft=t.WRK_STAT_CD||"",_t=t.ADDR_ORD||"";if(console.log("[WorkCompleteMoveRemoval]   :",{prodGrp:ke,voipProdCd:ft,ispProdCd:st,wrkStatCd:Ft,addrOrd:_t,customerCtrtListCount:_e.length}),ke==="V"&&!ft){const qt=_e.filter(he=>{const ye=he.PROD_GRP||"",je=he.CTRT_STAT||"",Me=he.ADDR_ORD||he.addr_ord||"";return(ye==="C"||ye==="D"||ye==="I")&&je==="20"&&(!_t||Me===_t)});console.log("[WorkCompleteMoveRemoval] VoIP   :",qt),qt.length<1&&Ft==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const jt=[{value:"",label:""},...qt.map(he=>({value:he.CTRT_ID||"",label:`[${he.CTRT_ID}] ${he.BASIC_PROD_CD_NM||he.PROD_NM||""}`}))];$(jt),ae(!0);return}if(ke==="I"&&st){const qt=_e.filter(he=>{const ye=he.PROD_GRP||"",je=he.CTRT_STAT||"",Me=he.ADDR_ORD||he.addr_ord||"",tt=he.ISP_JOIN_ID||"",Te=he.KPI_PROD_GRP_CD||"";return(ye==="D"||ye==="C")&&je==="20"&&!tt&&Te==="D"&&(!_t||Me===_t)});console.log("[WorkCompleteMoveRemoval] ISP   :",qt),qt.length<1&&Ft==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const jt=[{value:"",label:""},...qt.map(he=>({value:he.CTRT_ID||"",label:`[${he.CTRT_ID}] ${he.BASIC_PROD_CD_NM||he.PROD_NM||""}`}))];$(jt),ae(!0);return}ae(!1),$([])},[t.id,t.WRK_STAT_CD,u,r,_e]);const gt=()=>{const ke=[];P||ke.push("  ."),se!=null&&se.NET_CL||ke.push(" ."),ve||ke.push(" ."),Oe||ke.push(" .");const ft=t.PROD_GRP||"",st=t.VOIP_PROD_CD||"",Ft=t.ISP_PROD_CD||"";ft==="V"&&!st&&de&&(U||ke.push("VOIP    .")),ft==="I"&&Ft&&de&&(U||ke.push("  ISP .    ."));const _t=(v==null?void 0:v.installedEquipments)||[];return ft!=="V"&&_t.length<1&&ke.push("()  ."),ke},It=ke=>{Re(ke),ke.NET_CL&&fe(ke.NET_CL),ke.NET_CL_NM&&le(ke.NET_CL_NM),r==null||r("  .","success")},$e=()=>{if(L)return;const ke=gt();if(ke.length>0){ke.forEach(st=>r==null?void 0:r(st,"error"));return}(t.PROD_GRP||"")!=="V"?it(!0):at(!0)},$t=ke=>{nt(ke),it(!1),at(!0)},Ue=(ke,ft=!1)=>{if(!ke||ke.length===0)return[];const st=localStorage.getItem("userInfo"),Ft=st?JSON.parse(st):{},_t=Ft.userId||"A20130708",qt=(v==null?void 0:v.removalStatus)||{},jt=(he,ye)=>he==="1"||he==="Y"||ye==="1"||ye==="Y"?"1":"0";return ke.map(he=>{var tt,Te,bt;const ye=he.EQT_NO||he.id||((tt=he.actualEquipment)==null?void 0:tt.id)||"",je=qt[ye]||{},Me=ft?{CRR_TSK_CL:t.WRK_CD||"06",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Ft.crrId||"01",WRKR_ID:_t,EQT_LOSS_YN:jt(he.EQT_LOSS_YN,je.EQT_LOSS_YN),PART_LOSS_BRK_YN:jt(he.PART_LOSS_BRK_YN,je.PART_LOSS_BRK_YN),EQT_BRK_YN:jt(he.EQT_BRK_YN,je.EQT_BRK_YN),EQT_CABL_LOSS_YN:jt(he.EQT_CABL_LOSS_YN,je.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:jt(he.EQT_CRDL_LOSS_YN,je.EQT_CRDL_LOSS_YN)}:{};if(he.actualEquipment){const Ke=he.actualEquipment,St=he.contractEquipment||{};return{...Ke,EQT_NO:Ke.id,EQT_SERNO:Ke.serialNumber,ITEM_MID_CD:Ke.itemMidCd,EQT_CL_CD:Ke.eqtClCd,MAC_ADDRESS:he.macAddress||Ke.macAddress,WRK_ID:t.id,CUST_ID:(Te=t.customer)==null?void 0:Te.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:_t,SVC_CMPS_ID:St.SVC_CMPS_ID||he.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:St.BASIC_PROD_CMPS_ID||he.BASIC_PROD_CMPS_ID||"",PROD_CMPS_ID:St.PROD_CMPS_ID||he.PROD_CMPS_ID||"",SVC_CD:St.SVC_CD||he.SVC_CD||"",PROD_CD:St.PROD_CD||he.PROD_CD||"",LENT_YN:he.lentYn||he.LENT_YN||St.LENT_YN||"",EQT_CHG_GB:he.EQT_CHG_GB||"01",...Me}}return{...he,EQT_NO:he.EQT_NO||he.id||"",EQT_SERNO:he.EQT_SERNO||he.serialNumber||"",ITEM_MID_CD:he.ITEM_MID_CD||he.itemMidCd||"",EQT_CL_CD:he.EQT_CL_CD||he.eqtClCd||"",MAC_ADDRESS:he.MAC_ADDRESS||he.macAddress||"",SVC_CMPS_ID:he.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:he.BASIC_PROD_CMPS_ID||"",PROD_CD:he.PROD_CD||"",SVC_CD:he.SVC_CD||"",WRK_ID:t.id,CUST_ID:(bt=t.customer)==null?void 0:bt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:_t,...Me}})},ss=async()=>{var tt,Te,bt,Ke,St;const ke=Oe.replace(/-/g,""),ft=localStorage.getItem("userInfo"),st=ft?JSON.parse(ft):{},Ft=st.userId||"A20130708",_t=o||d0(t.OP_LNKD_CD),qt=await y_(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let jt="";if(_t){let Et=(v==null?void 0:v.prodPromoInfo)||[];if(Et.length===0)try{console.log("[CompleteInternalMove] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),Et=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"06"}),console.log("[CompleteInternalMove] getProdPromotionInfo fallback :",Et.length,"")}catch(ht){console.log("[CompleteInternalMove] getProdPromotionInfo fallback :",ht)}const ze=Et.filter(ht=>(ht.PROD_CMPS_CL==="21"||ht.PROD_CMPS_CL==="22")&&(ht.PROD_STAT_CD==="10"||ht.PROD_STAT_CD==="20")).map(ht=>ht.PROD_CD).filter(ht=>ht);jt=ze.length>0?ze.join(",")+",":"",console.log("[CompleteInternalMove] ADD_ON :",jt)}const he=(v==null?void 0:v.installedEquipments)||[];if(_t&&he.length>0&&!C){r==null||r("  .","error");return}if(_t&&C)try{const Et=t.OLD_CTRT_ID||t.CTRT_ID||"",{certifyType:ze}=await GM(t,Ft,Et);if(ze){const ht=c||(ze==="C"?"":""),Lt=ze==="U"?(t.CTRT_ID||"")!==Et?Et:t.CTRT_ID||"":void 0,Bt=await p_({order:t,workerId:Ft,certifyRegconfInfo:C,addOnParam:jt,reason:ht,certifyType:ze,contIdOld:Lt});if(!Bt.success){r==null||r(` : ${Bt.message}`,"error");return}console.log("[CompleteInternalMove] CL-04    ")}}catch(Et){console.error("[CompleteInternalMove] CL-04  :",Et),r==null||r(`  : ${Et.message||"   "}`,"error");return}const ye=(v==null?void 0:v.removedEquipments)||[];if(ye.length>0&&!qt&&!we){let Et=!1;for(const ze of ye){const ht=ze.actualEquipment||ze,Lt=ht.eqtClCd||ht.EQT_CL_CD||"";Lt==="090901"||Lt==="091001"||Lt==="091005"||(Et=!0)}if(Et)try{const ze=ye[0],ht=ze.EQT_PROD_CMPS_ID||((tt=ze.actualEquipment)==null?void 0:tt.EQT_PROD_CMPS_ID)||t.EQT_PROD_CMPS_ID||"";console.log("[CompleteInternalMove]   :",{eqtProdCmpsId:ht,voipJoinCtrtId:U});const Lt=await _a({MSG_ID:"SMR05",CUST_ID:((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:ht,PROD_CD:"",WRK_ID:t.id||"",REG_UID:Ft,ETC_1:"",VOIP_JOIN_CTRT_ID:U||"",WTIME:"3"});if(console.log("[CompleteInternalMove]    :",Lt),Lt&&Lt.PROC_VOIP&&Lt.PROC_VOIP.includes("KCT-029"))console.log("[CompleteInternalMove] VoIP KCT-029  ");else if(Lt.code!=="SUCCESS"&&Lt.code!=="OK"){console.warn("[CompleteInternalMove]    -  :",Lt.message),r==null||r("   .","error",!0);return}}catch(ze){console.warn("[CompleteInternalMove]      -  :",ze),r==null||r("     .","error",!0);return}}const je=async()=>{var Lt,Bt;const Et=!!t.ISP_PROD_CD,ze=(v==null?void 0:v.installedEquipments)||[];let ht=!1;if(!qt){const Yt=(v==null?void 0:v.customerEquipments)||ze;for(const Xt of Yt){const ts=Xt.actualEquipment||Xt,Ut=ts.eqtClCd||ts.EQT_CL_CD||"";if(Ut==="090901"||Ut==="091001"||Ut==="091005")continue;(ts.EQT_KND||ts.eqtKnd||"WRKER")==="WRKER"&&(ht=!0)}(Et||Yt.length>0)&&(ht=!0)}if(ht)try{const Yt=t.PROD_GRP||"";let Xt="SMR03",ts="",Ut="",Is="",Cs="",Us="",_s="";we&&(Xt="STB_CRT"),Yt==="V"&&(Xt="SMR60");let Es=(v==null?void 0:v.prodPromoInfo)||[];if(Es.length===0)try{Es=await Rl({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:Ft,PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"01",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||"",WRK_CD:t.WRK_CD||"06",WRK_STAT_CD:t.WRK_STAT_CD||""})}catch(ws){console.log("[CompleteInternalMove] prodPromoInfo  :",ws)}const Ls=((Lt=Es.find(ws=>ws.PROD_CMPS_CL==="23"))==null?void 0:Lt.PROD_CMPS_ID)||"",cs=Es.find(ws=>ws.PROD_CMPS_CL==="11"),ms=(cs==null?void 0:cs.PROD_CD)||"",Ys=(cs==null?void 0:cs.PROD_GRP)||Yt,Ps=Es.filter(ws=>ws.BASIC_PROD_FL==="V").map(ws=>ws.PROD_CD),rt=Ps.length>0?Ps.join(","):"",Wt=ws=>{const Zt=ze.find(js=>{const hs=js.actualEquipment||js;return(hs.itemMidCd||hs.ITEM_MID_CD)===ws});if(!Zt)return"";const Ds=Zt.actualEquipment||Zt;return Ds.id||Ds.EQT_NO||""};t.VOIP_PROD_CD?(ts=Wt("08"),Ut=Wt("02")):(ts=Wt("05")||Wt("01")||Wt("03")||(Ys==="I"?Wt("02"):"")||Wt("08")||"",Ut=Wt("04")),Is=Wt("07"),Ys==="C"&&(Cs=Wt("02")),Ys==="V"&&(Us=Wt("10")),Et&&(Us=Wt("21")),(Yt==="V"||Et)&&(_s=U||t.CTRT_ID||"");let bs=t.id||"";for(const ws of ze){const Zt=ws.actualEquipment||ws,Ds=Zt.eqtClCd||Zt.EQT_CL_CD||"";if(Ds==="091003"||Ds==="091004"){bs=Zt.id||Zt.EQT_NO||t.id||"";break}if(Ds==="092201"){bs=Zt.macAddress||Zt.MAC_ADDRESS||Zt.id||Zt.EQT_NO||t.id||"";break}}console.log("[CompleteInternalMove]   :",{msgId:Xt,eqtNo:ts,prodCd:ms,subProdCd:rt,etc1:Ut,etc2:Is,etc3:Cs,etc4:Us});const zt=await _a({MSG_ID:Xt,CUST_ID:((Bt=t.customer)==null?void 0:Bt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:ts,EQT_PROD_CMPS_ID:Ls,PROD_CD:ms,ITV_USR_ID:"",IP_CNT:"",ETC_1:Ut,ETC_2:Is,ETC_3:Cs,ETC_4:Us,SUB_PROD_CD:rt,IF_DTL_ID:"",WRK_ID:bs,REG_UID:Ft,VOIP_JOIN_CTRT_ID:_s,WTIME:"3"});zt.code==="SUCCESS"||zt.code==="OK"?console.log("[CompleteInternalMove]    "):console.warn("[CompleteInternalMove]    :",zt.message)}catch(Yt){console.log("[CompleteInternalMove]      (  ):",Yt)}},Me={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(bt=t.customer)==null?void 0:bt.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||st.crrId||"01",WRKR_ID:Ft,WRKR_CMPL_DT:ke,MEMO:G||" ",STTL_YN:"Y",REG_UID:Ft,CUST_REL:P,CNFM_CUST_NM:((Ke=t.customer)==null?void 0:Ke.name)||"",CNFM_CUST_TELNO:((St=t.customer)==null?void 0:St.contactNumber)||"",INSTL_LOC:ve||"",UP_CTRL_CL:H||"",PSN_USE_CORP:I||"",VOIP_USE_CORP:A||"",DTV_USE_CORP:ee||"",WRK_ACT_CL:"20",TV_TYPE:"",NET_CL:(se==null?void 0:se.NET_CL)||"",WRNG_TP:(se==null?void 0:se.WRNG_TP)||"",INSTL_TP:(se==null?void 0:se.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:U||"",CHK_CUST_ADDR:h?K?"true":"false":"",CHK_PYM_ADDR:h?te?"true":"false":"",ADD_ON:jt||""},equipmentList:Ue((v==null?void 0:v.installedEquipments)||[],!1),removeEquipmentList:Ue((v==null?void 0:v.removedEquipments)||[],!0),spendItemList:(v==null?void 0:v.spendItems)||[],agreementList:(v==null?void 0:v.agreements)||[],poleList:Fe?[{WRK_ID:t.id,POLE_YN:Fe.POLE_YN,LAN_GB:Fe.LAN_GB||"",REG_UID:Ft}]:[]};k(Me,{onSuccess:Et=>{Et.code==="SUCCESS"||Et.code==="OK"?(localStorage.removeItem(M()),t.WRK_STAT_CD="3",je(),r==null||r("  .","success"),n()):r==null||r(Et.message||"   .","error",!0)},onError:Et=>{r==null||r(Et.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[L&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[de&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:U,onValueChange:Q,options:q,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Z||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>X(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${u?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:u?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:P,onValueChange:F,options:lt,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{children:ve||""}),At&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(: ",At,")"]})]}),s.jsxs("button",{type:"button",onClick:()=>me(!0),className:`min-h-10 px-3 sm:px-4 rounded-lg font-bold text-sm whitespace-nowrap flex items-center gap-1.5 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:[s.jsx(Ed,{className:"w-4 h-4"}),s.jsx("span",{children:u?"":""})]})]})]}),((v==null?void 0:v.kpiProdGrpCd)==="D"||(v==null?void 0:v.prodGrp)==="D"||t.PROD_GRP==="D")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(sn,{value:H,onValueChange:V,options:ut,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:G,onChange:ke=>B(ke.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${u?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:u,disabled:u}),!u&&s.jsxs("p",{className:`text-xs text-right mt-1 ${G.length>=500?"text-red-500":"text-gray-400"}`,children:[G.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Oe,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>O(!R),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${R?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"DTV ()"}),s.jsx(sn,{value:ee,onValueChange:J,options:Be,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"ISP ()"}),s.jsx(sn,{value:I,onValueChange:E,options:Ee,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"VoIP (VoIP)"}),s.jsx(sn,{value:A,onValueChange:Y,options:pe,placeholder:"",disabled:u})]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!u&&s.jsx("button",{onClick:$e,disabled:L,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${L?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:L?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>De(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:Ne,onClose:()=>X(!1),onSave:It,workId:t.id,initialData:se,workType:t.WRK_CD,customerId:(ds=t.customer)==null?void 0:ds.id,customerName:(vs=t.customer)==null?void 0:vs.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:t.KPI_PROD_GRP_CD||"",prodChgGb:t.PROD_CHG_GB||"",chgKpiProdGrpCd:t.CHG_KPI_PROD_GRP_CD||"",prodGrp:t.PROD_GRP||"",wrkDtlTcd:t.WRK_DTL_TCD||"",readOnly:u}),s.jsx(el,{isOpen:be,onClose:()=>De(!1),ctrtId:t.CTRT_ID,custId:(Ss=t.customer)==null?void 0:Ss.id}),s.jsx(_m,{isOpen:re,onClose:()=>me(!1),onSave:ke=>{et(ke.INSTL_LOC),ot(ke.VIEW_MOD_CD),ct(ke.VIEW_MOD_NM),me(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(v==null?void 0:v.prodGrp)||(v==null?void 0:v.PROD_GRP),initialInstlLoc:ve,initialViewModCd:Dt,initialViewModNm:At,showToast:r,readOnly:u}),s.jsx(b_,{isOpen:Ve,onClose:()=>it(!1),onSave:$t,soId:t.SO_ID||""}),s.jsx(Ba,{isOpen:Ge,onClose:()=>at(!1),onConfirm:ss,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{equipmentData:v,installInfoData:se,custRel:P,custRelOptions:lt,memo:G,installLocationText:ve,order:t})}),s.jsx(lN,{isOpen:xt,onClose:()=>mt(!1),wrkCd:t.WRK_CD,wrkId:t.id,rcptId:t.RCPT_ID})]})},$M=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1,certifyReason:c})=>{var jt,he,ye,je;const u=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",h=t.WRK_CD==="07",[m,_]=b.useState(!1),{equipmentData:p,filteringData:g}=ta(),{certifyRegconfInfo:C}=Za(),y=t.id||"",S=xa(y),v={...p||i||g||{},installedEquipments:S.installedEquipments.length>0?S.installedEquipments:(p==null?void 0:p.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:S.markedForRemoval.length>0?S.markedForRemoval:(p==null?void 0:p.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(S.removalStatus).length>0?S.removalStatus:(p==null?void 0:p.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:k,isPending:L}=Md(),M=()=>`work_complete_draft_${t.id}`,[P,F]=b.useState(""),[G,B]=b.useState(""),[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(""),[H,V]=b.useState(""),[K,j]=b.useState(!1),[te,ce]=b.useState(!1),[R,O]=b.useState(!1),[U,Q]=b.useState(""),[q,$]=b.useState([]),[de,ae]=b.useState(!1),[_e,ie]=b.useState([]),[Ne,X]=b.useState(!1),[xe,fe]=b.useState(""),[Z,le]=b.useState(""),[se,Re]=b.useState(void 0),[be,De]=b.useState(!1),[re,me]=b.useState(!1),[ve,et]=b.useState(""),[Dt,ot]=b.useState(""),[At,ct]=b.useState(""),[Ge,at]=b.useState(!1),[xt,mt]=b.useState(!1),[Ve,it]=b.useState(!1),[Fe,nt]=b.useState(null),[lt,Mt]=b.useState(!1),[ut,qe]=b.useState([]),[Ee,Ye]=b.useState(null),[pe,ge]=b.useState(!1),[Be,ue]=b.useState(""),[we,Je]=b.useState(!1),[Pe,Nt]=b.useState("B"),[Oe,dt]=b.useState([]),[gt,It]=b.useState([]),[$e,$t]=b.useState([]),[Ue,ss]=b.useState([]),[ls,ds]=b.useState([]),[vs,Ss]=b.useState(()=>{const Me=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(Me&&Me.length>=8)return`${Me.slice(0,4)}-${Me.slice(4,6)}-${Me.slice(6,8)}`;const tt=new Date;return tt.getFullYear()+"-"+String(tt.getMonth()+1).padStart(2,"0")+"-"+String(tt.getDate()).padStart(2,"0")});b.useEffect(()=>{if(u){(async()=>{try{const Te=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(Te){F(Te.CUST_REL||""),B((Te.WRK_PROC_CT||"").replace(/\\n/g,`
`)),E(Te.PSN_USE_CORP||""),Y(Te.VOIP_USE_CORP||""),J(Te.DTV_USE_CORP||"");const bt=Te.UP_CTRL_CL||(v==null?void 0:v.upCtrlCl)||"";console.log("[CompleteMoveRemoval]  :",{API:Te.UP_CTRL_CL,:v==null?void 0:v.upCtrlCl,:bt}),V(bt),fe(Te.NET_CL||""),le(Te.NET_CL_NM||""),et(Te.INSTL_LOC||""),Re({NET_CL:Te.NET_CL||"",NET_CL_NM:Te.NET_CL_NM||"",WRNG_TP:Te.WRNG_TP||"",INSTL_TP:Te.INSTL_TP||"",CB_WRNG_TP:Te.CB_WRNG_TP||"",CB_INSTL_TP:Te.CB_INSTL_TP||"",INOUT_LINE_TP:Te.INOUT_LINE_TP||"",INOUT_LEN:Te.INOUT_LEN||"",DVDR_YN:Te.DVDR_YN||"",BFR_LINE_YN:Te.BFR_LINE_YN||"",CUT_YN:Te.CUT_YN||"",TERM_NO:Te.TERM_NO||"",RCV_STS:Te.RCV_STS||"",SUBTAP_ID:Te.SUBTAP_ID||"",PORT_NUM:Te.PORT_NUM||"",EXTN_TP:Te.EXTN_TP||"",TAB_LBL:Te.TAB_LBL||"",CVT_LBL:Te.CVT_LBL||"",STB_LBL:Te.STB_LBL||""}),Te.VOIP_JOIN_CTRT_ID&&Q(Te.VOIP_JOIN_CTRT_ID),(Te.CHK_CUST_ADDR==="true"||Te.CHK_CUST_ADDR==="Y")&&j(!0),(Te.CHK_PYM_ADDR==="true"||Te.CHK_PYM_ADDR==="Y")&&ce(!0),Te.WRKR_CMPL_DT&&Te.WRKR_CMPL_DT.length>=8&&Ss(`${Te.WRKR_CMPL_DT.slice(0,4)}-${Te.WRKR_CMPL_DT.slice(4,6)}-${Te.WRKR_CMPL_DT.slice(6,8)}`)}}catch(Te){console.error("[WorkCompleteMoveRemoval]     :",Te)}_(!0)})();return}const Me=localStorage.getItem(M());if(Me)try{const tt=JSON.parse(Me);F(tt.custRel||""),B(tt.memo||""),E(tt.internetUse||""),Y(tt.voipUse||""),J(tt.dtvUse||""),V(tt.upCtrlCl||""),fe(tt.networkType||""),le(tt.networkTypeName||""),et(tt.installLocationText||""),Re(tt.installInfoData),tt.voipJoinCtrtId&&Q(tt.voipJoinCtrtId),tt.chkCustAddr!==void 0&&j(tt.chkCustAddr),tt.chkPymAddr!==void 0&&ce(tt.chkPymAddr)}catch(tt){console.error("[WorkCompleteMoveRemoval] localStorage  :",tt)}_(!0)},[t.id,u]),b.useEffect(()=>{if(!m||u)return;const Me={custRel:P,memo:G,internetUse:I,voipUse:A,dtvUse:ee,upCtrlCl:H,networkType:xe,networkTypeName:Z,installLocationText:ve,installInfoData:se,voipJoinCtrtId:U,chkCustAddr:K,chkPymAddr:te,savedAt:new Date().toISOString()};localStorage.setItem(M(),JSON.stringify(Me))},[P,G,I,A,ee,H,xe,Z,ve,se,U,K,te,m,u]),b.useEffect(()=>{(async()=>{try{const tt=await po(["CMCU005","CMCT015","CMCU057","CMCU110","CMCU148"]);tt.CMCU005&&dt(tt.CMCU005.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM}))),tt.CMCT015&&(console.log("[CompleteMoveRemoval]  CMCT015 :",tt.CMCT015),It(tt.CMCT015.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM})))),tt.CMCU057&&$t(tt.CMCU057.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM}))),tt.CMCU110&&ss(tt.CMCU110.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM}))),tt.CMCU148&&ds(tt.CMCU148.map(Te=>({value:Te.COMMON_CD,label:Te.COMMON_CD_NM})))}catch(tt){console.error("[WorkCompleteMoveRemoval]   :",tt)}})()},[]),b.useEffect(()=>{(async()=>{try{const tt=await Ac(),Te=(tt==null?void 0:tt.output)||tt||[];qe(Te);const bt=t.PROD_CD||t.PROD_CD||"",Ke=Te.some(St=>St.PROD_CD===bt);Mt(Ke),console.log("[CompleteRelocate] LGHV :",{currentProdCd:bt,isLghv:Ke,prodListCount:Te.length})}catch(tt){console.error("[CompleteRelocate] LGHV   :",tt)}})()},[t.PROD_CD]),b.useEffect(()=>{if(t.WRK_CD!=="07")return;(async()=>{try{const tt=await x_({WRK_CD:t.WRK_CD||"07",WRK_ID:t.id||"",RCPT_ID:t.RCPT_ID||""});Ye(tt),console.log("[CompleteRelocate] getMoveWorkInfo:",tt)}catch(tt){console.error("[CompleteRelocate] getMoveWorkInfo :",tt)}})()},[t.id,t.WRK_CD]),b.useEffect(()=>{(async()=>{const tt=t.PROD_CD||t.PROD_CD||"",Te=(v==null?void 0:v.prodPromoInfo)||[];if(tt==="PD10018480")console.log("[CompleteRelocate] OTT   :",tt),Je(!0),Nt("C");else if(Te.some(St=>St.PROD_CD==="PD10018160"))console.log("[CompleteRelocate] OTT   : PD10018160"),Je(!0),Nt("B");else{Je(!1);return}const bt=t.id||"",Ke=t.directionId||t.WRK_DRCTN_ID||"";if(bt&&Ke)try{const St=await v1({WRK_ID:bt,WRK_DRCTN_ID:Ke,DATA_TYPE:tt==="PD10018480"?"C":"B"});St!=null&&St.EQT_SERNO&&(console.log("[CompleteRelocate]  OTT :",St.EQT_SERNO),ue(St.EQT_SERNO))}catch(St){console.error("[CompleteRelocate] OTT   :",St)}})()},[t.PROD_CD,t.id,t.directionId,v==null?void 0:v.prodPromoInfo]),b.useEffect(()=>{v!=null&&v.upCtrlCl&&!H?(console.log("[CompleteMoveRemoval] equipmentData  :",v.upCtrlCl),V(v.upCtrlCl)):!H&&m&&!u&&(console.log("[CompleteMoveRemoval]   : 01 ()"),V("01"))},[v==null?void 0:v.upCtrlCl,m,u,H]),b.useEffect(()=>{var Te;if(u)return;const Me=((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID;if(!Me)return;(async()=>{try{console.log("[WorkCompleteMoveRemoval]     :",Me);const bt=await gm({CUST_ID:Me});console.log("[WorkCompleteMoveRemoval]   :",bt),ie(bt||[])}catch(bt){console.error("[WorkCompleteMoveRemoval]     :",bt),ie([])}})()},[(jt=t.customer)==null?void 0:jt.id,t.CUST_ID,u]),b.useEffect(()=>{if(u)return;if(_e.length===0){console.log("[WorkCompleteMoveRemoval]     ...");return}const Me=t.PROD_GRP||"",tt=t.VOIP_PROD_CD||"",Te=t.ISP_PROD_CD||"",bt=t.WRK_STAT_CD||"",Ke=t.ADDR_ORD||"";if(console.log("[WorkCompleteMoveRemoval]   :",{prodGrp:Me,voipProdCd:tt,ispProdCd:Te,wrkStatCd:bt,addrOrd:Ke,customerCtrtListCount:_e.length}),Me==="V"&&!tt){const St=_e.filter(ze=>{const ht=ze.PROD_GRP||"",Lt=ze.CTRT_STAT||"",Bt=ze.ADDR_ORD||ze.addr_ord||"";return(ht==="C"||ht==="D"||ht==="I")&&Lt==="20"&&(!Ke||Bt===Ke)});console.log("[WorkCompleteMoveRemoval] VoIP   :",St),St.length<1&&bt==="2"&&(r==null||r("VOIP  DTV, ISP  . ISP DTV    .","warning"));const Et=[{value:"",label:""},...St.map(ze=>({value:ze.CTRT_ID||"",label:`[${ze.CTRT_ID}] ${ze.BASIC_PROD_CD_NM||ze.PROD_NM||""}`}))];$(Et),ae(!0);return}if(Me==="I"&&Te){const St=_e.filter(ze=>{const ht=ze.PROD_GRP||"",Lt=ze.CTRT_STAT||"",Bt=ze.ADDR_ORD||ze.addr_ord||"",Yt=ze.ISP_JOIN_ID||"",Xt=ze.KPI_PROD_GRP_CD||"";return(ht==="D"||ht==="C")&&Lt==="20"&&!Yt&&Xt==="D"&&(!Ke||Bt===Ke)});console.log("[WorkCompleteMoveRemoval] ISP   :",St),St.length<1&&bt==="2"&&(r==null||r("ISP  DTV  . DTV    .","warning"));const Et=[{value:"",label:""},...St.map(ze=>({value:ze.CTRT_ID||"",label:`[${ze.CTRT_ID}] ${ze.BASIC_PROD_CD_NM||ze.PROD_NM||""}`}))];$(Et),ae(!0);return}ae(!1),$([])},[t.id,t.WRK_STAT_CD,u,r,_e]);const ke=()=>{const Me=[];P||Me.push("  ."),se!=null&&se.NET_CL||Me.push(" ."),ve||Me.push(" ."),vs||Me.push(" .");const tt=t.PROD_GRP||"",Te=t.VOIP_PROD_CD||"",bt=t.ISP_PROD_CD||"";if(tt==="V"&&t.WRK_CD==="07"&&Ee&&Ee.WRK_STAT_CD!=="4"&&Me.push("VOIP         ."),lt&&Ee&&t.WRK_CD==="07"){const St=t.CTRT_ID||"",Et=Ee.OLD_CTRT_ID||"";if(St!==Et){const ze=Ee.WRK_STAT_CD||"";if(ze==="1"||ze==="2"){const ht=Ee.OLD_PROD_CD||"";ut.some(Lt=>Lt.PROD_CD===ht)&&Me.push("LGHV STB  ,     .")}}}tt==="V"&&!Te&&de&&(U||Me.push("VOIP    .")),tt==="I"&&bt&&de&&(U||Me.push("  ISP .    .")),we&&!Be&&Me.push("OTT   OTT BOX   .");const Ke=(v==null?void 0:v.installedEquipments)||[];return tt!=="V"&&Ke.length<1&&Me.push("()  ."),Me},ft=Me=>{Re(Me),Me.NET_CL&&fe(Me.NET_CL),Me.NET_CL_NM&&le(Me.NET_CL_NM),r==null||r("  .","success")},st=()=>{if(L)return;const Me=ke();if(Me.length>0){Me.forEach(Te=>r==null?void 0:r(Te,"error"));return}(t.PROD_GRP||"")!=="V"?it(!0):at(!0)},Ft=Me=>{nt(Me),it(!1),at(!0)},_t=(Me,tt=!1)=>{if(!Me||Me.length===0)return[];const Te=localStorage.getItem("userInfo"),bt=Te?JSON.parse(Te):{},Ke=bt.userId||"A20130708",St=(v==null?void 0:v.removalStatus)||{},Et=(ze,ht)=>ze==="1"||ze==="Y"||ht==="1"||ht==="Y"?"1":"0";return Me.map(ze=>{var Yt,Xt,ts;const ht=ze.EQT_NO||ze.id||((Yt=ze.actualEquipment)==null?void 0:Yt.id)||"",Lt=St[ht]||{},Bt=tt?{CRR_TSK_CL:t.WRK_CD||"07",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||bt.crrId||"01",WRKR_ID:Ke,EQT_LOSS_YN:Et(ze.EQT_LOSS_YN,Lt.EQT_LOSS_YN),PART_LOSS_BRK_YN:Et(ze.PART_LOSS_BRK_YN,Lt.PART_LOSS_BRK_YN),EQT_BRK_YN:Et(ze.EQT_BRK_YN,Lt.EQT_BRK_YN),EQT_CABL_LOSS_YN:Et(ze.EQT_CABL_LOSS_YN,Lt.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Et(ze.EQT_CRDL_LOSS_YN,Lt.EQT_CRDL_LOSS_YN)}:{};if(ze.actualEquipment){const Ut=ze.actualEquipment,Is=ze.contractEquipment||{};return{...Ut,EQT_NO:Ut.id,EQT_SERNO:Ut.serialNumber,ITEM_MID_CD:Ut.itemMidCd,EQT_CL_CD:Ut.eqtClCd,MAC_ADDRESS:ze.macAddress||Ut.macAddress,WRK_ID:t.id,CUST_ID:(Xt=t.customer)==null?void 0:Xt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:Ke,SVC_CMPS_ID:Is.SVC_CMPS_ID||ze.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:Is.BASIC_PROD_CMPS_ID||ze.BASIC_PROD_CMPS_ID||"",PROD_CMPS_ID:Is.PROD_CMPS_ID||ze.PROD_CMPS_ID||"",SVC_CD:Is.SVC_CD||ze.SVC_CD||"",PROD_CD:Is.PROD_CD||ze.PROD_CD||"",LENT_YN:ze.lentYn||ze.LENT_YN||Is.LENT_YN||"",EQT_CHG_GB:ze.EQT_CHG_GB||"01",...Bt}}return{...ze,EQT_NO:ze.EQT_NO||ze.id||"",EQT_SERNO:ze.EQT_SERNO||ze.serialNumber||"",ITEM_MID_CD:ze.ITEM_MID_CD||ze.itemMidCd||"",EQT_CL_CD:ze.EQT_CL_CD||ze.eqtClCd||"",MAC_ADDRESS:ze.MAC_ADDRESS||ze.macAddress||"",SVC_CMPS_ID:ze.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:ze.BASIC_PROD_CMPS_ID||"",PROD_CD:ze.PROD_CD||"",SVC_CD:ze.SVC_CD||"",WRK_ID:t.id,CUST_ID:(ts=t.customer)==null?void 0:ts.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,REG_UID:Ke,...Bt}})},qt=async()=>{var Xt,ts,Ut,Is,Cs,Us,_s,Es,Ls,cs;const Me=vs.replace(/-/g,""),tt=localStorage.getItem("userInfo"),Te=tt?JSON.parse(tt):{},bt=Te.userId||"A20130708",Ke=o||d0(t.OP_LNKD_CD),St=await y_(t.SO_ID||t.SO_ID||"",t.IS_CERTIFY_PROD);let Et="";if(Ke){let ms=(v==null?void 0:v.prodPromoInfo)||[];if(ms.length===0)try{console.log("[CompleteRelocate] prodPromoInfo , getProdPromotionInfo fallback  (ADD_ON)"),ms=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",WRK_CD:t.WRK_CD||"07"}),console.log("[CompleteRelocate] getProdPromotionInfo fallback :",ms.length,"")}catch(Ps){console.log("[CompleteRelocate] getProdPromotionInfo fallback :",Ps)}const Ys=ms.filter(Ps=>(Ps.PROD_CMPS_CL==="21"||Ps.PROD_CMPS_CL==="22")&&(Ps.PROD_STAT_CD==="10"||Ps.PROD_STAT_CD==="20")).map(Ps=>Ps.PROD_CD).filter(Ps=>Ps);Et=Ys.length>0?Ys.join(",")+",":"",console.log("[CompleteRelocate] ADD_ON :",Et)}const ze=(v==null?void 0:v.installedEquipments)||[];if(Ke&&ze.length>0&&!C){r==null||r("  .","error");return}if(Ke&&C)try{const ms=t.OLD_CTRT_ID||t.CTRT_ID||"",{certifyType:Ys}=await GM(t,bt,ms);if(Ys){const Ps=c||(Ys==="C"?"":""),rt=Ys==="U"?(t.CTRT_ID||"")!==ms?ms:t.CTRT_ID||"":void 0,Wt=await p_({order:t,workerId:bt,certifyRegconfInfo:C,addOnParam:Et,reason:Ps,certifyType:Ys,contIdOld:rt});if(!Wt.success){r==null||r(` : ${Wt.message}`,"error");return}console.log("[CompleteRelocate] CL-04    ")}}catch(ms){console.error("[CompleteRelocate] CL-04  :",ms),r==null||r(`  : ${ms.message||"   "}`,"error");return}const ht=(v==null?void 0:v.installedEquipments)||[],Lt=!!t.ISP_PROD_CD;if(!St&&(Lt||ht.length>0))try{const ms=t.PROD_GRP||"";let Ys="SMR03",Ps="",rt="",Wt="",bs="",zt="",ws="";lt&&(Ys="STB_CRT"),ms==="V"&&(Ys="SMR60");const Zt=(v==null?void 0:v.prodPromoInfo)||[],Ds=((Xt=Zt.find(hn=>hn.PROD_CMPS_CL==="23"))==null?void 0:Xt.PROD_CMPS_ID)||"",js=Zt.find(hn=>hn.PROD_CMPS_CL==="11"),hs=(js==null?void 0:js.PROD_CD)||"",Ws=(js==null?void 0:js.PROD_GRP)||ms,Vs=Zt.filter(hn=>hn.BASIC_PROD_FL==="V").map(hn=>hn.PROD_CD),Os=Vs.length>0?Vs.join(","):"",xs=hn=>{const fr=ht.find($r=>{const sa=$r.actualEquipment||$r;return(sa.itemMidCd||sa.ITEM_MID_CD)===hn});if(!fr)return"";const ci=fr.actualEquipment||fr;return ci.id||ci.EQT_NO||""};t.VOIP_PROD_CD?(Ps=xs("08"),rt=xs("02")):(Ps=xs("05")||xs("01")||xs("03")||(Ws==="I"?xs("02"):"")||xs("08")||"",rt=xs("04")),Wt=xs("07"),Ws==="C"&&(bs=xs("02")),Ws==="V"&&(zt=xs("10")),Lt&&(zt=xs("21")),(ms==="V"||Lt)&&(ws=U||t.CTRT_ID||"");let Br=t.id||"";const Pr=ht.find(hn=>{const fr=hn.actualEquipment||hn;return(fr.eqtClCd||fr.EQT_CL_CD)==="091003"}),ti=ht.find(hn=>{const fr=hn.actualEquipment||hn;return(fr.eqtClCd||fr.EQT_CL_CD)==="092201"});if(Pr){const hn=Pr.actualEquipment||Pr;Br=hn.id||hn.EQT_NO||t.id||""}else if(ti){const hn=ti.actualEquipment||ti;Br=hn.macAddress||hn.MAC_ADDRESS||t.id||""}console.log("[CompleteRelocate]   :",{msgId:Ys,eqtNo:Ps,eqtProdCmpsId:Ds,prodCd:hs,subProdCd:Os,etc1:rt,etc2:Wt,etc3:bs,etc4:zt,signalWrkId:Br});const Mr=await _a({MSG_ID:Ys,CUST_ID:((ts=t.customer)==null?void 0:ts.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ps,EQT_PROD_CMPS_ID:Ds,PROD_CD:hs,ITV_USR_ID:"",IP_CNT:"",ETC_1:rt,ETC_2:Wt,ETC_3:bs,ETC_4:zt,SUB_PROD_CD:Os,IF_DTL_ID:"",WRK_ID:Br,REG_UID:bt,VOIP_JOIN_CTRT_ID:ws,WTIME:"3"});Mr.code==="SUCCESS"||Mr.code==="OK"?console.log("[CompleteRelocate]    "):(console.warn("[CompleteRelocate]    :",Mr.message),ms!=="V"&&(r==null||r("   .  .","warning")))}catch(ms){console.error("[CompleteRelocate]    :",ms),r==null||r("   .  .","warning")}const Bt=(v==null?void 0:v.removedEquipments)||[];if(Bt.length>0&&!St&&!lt){let ms=!1;for(const Ps of Bt){const rt=Ps.actualEquipment||Ps,Wt=rt.eqtClCd||rt.EQT_CL_CD||"";Wt==="090901"||Wt==="091001"||Wt==="091005"||(ms=!0)}const Ys=t.PROD_GRP||"";if(t.WRK_CD==="07"&&Ys==="V"&&(ms=!1),ms)try{const Ps=(v==null?void 0:v.removedProdPromoInfo)||(v==null?void 0:v.prodPromoInfo)||[],rt=((Is=(Ut=Ps.find)==null?void 0:Ut.call(Ps,zt=>zt.PROD_CMPS_CL==="23"))==null?void 0:Is.PROD_CMPS_ID)||"";let Wt="";Ys==="V"&&(Wt=t.VOIP_PROD_CD?t.CTRT_ID||"":U||t.CTRT_ID||""),console.log("[CompleteRelocate]   :",{msgId:"SMR05",delEqtProdCmpsId:rt,prodGrpForDel:Ys});const bs=await _a({MSG_ID:"SMR05",CUST_ID:((Cs=t.customer)==null?void 0:Cs.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:rt,PROD_CD:"",WRK_ID:t.id||"",REG_UID:bt,ETC_1:"",ETC_2:"",ETC_3:"",ETC_4:"",VOIP_JOIN_CTRT_ID:Wt,WTIME:"3"});if(bs.code!=="SUCCESS"&&bs.code!=="OK"){if((((Us=bs.O_IFSVC_RESULT)==null?void 0:Us.substring(14,20))||"")!=="029"&&((_s=bs.message)==null?void 0:_s.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteRelocate]    -  :",bs.message),r==null||r("   .","error",!0);return}}else console.log("[CompleteRelocate]    ")}catch(Ps){console.error("[CompleteRelocate]     :",Ps),r==null||r("   .","error",!0);return}}else Bt.length>0&&lt&&console.log("[CompleteRelocate] LGHV STB  -  skip ( )");const Yt={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Es=t.customer)==null?void 0:Es.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||Te.crrId||"01",WRKR_ID:bt,WRKR_CMPL_DT:Me,MEMO:G||" ",STTL_YN:"Y",REG_UID:bt,CUST_REL:P,CNFM_CUST_NM:((Ls=t.customer)==null?void 0:Ls.name)||"",CNFM_CUST_TELNO:((cs=t.customer)==null?void 0:cs.contactNumber)||"",INSTL_LOC:ve||"",UP_CTRL_CL:H||"",PSN_USE_CORP:I||"",VOIP_USE_CORP:A||"",DTV_USE_CORP:ee||"",WRK_ACT_CL:"20",TV_TYPE:"",NET_CL:(se==null?void 0:se.NET_CL)||"",WRNG_TP:(se==null?void 0:se.WRNG_TP)||"",INSTL_TP:(se==null?void 0:se.INSTL_TP)||"",VOIP_JOIN_CTRT_ID:U||"",OLD_CTRT_ID:t.OLD_CTRT_ID||"",CHK_CUST_ADDR:h?K?"true":"false":"",CHK_PYM_ADDR:h?te?"true":"false":"",ADD_ON:Et||""},equipmentList:_t((v==null?void 0:v.installedEquipments)||[],!1),removeEquipmentList:_t((v==null?void 0:v.removedEquipments)||[],!0),spendItemList:(v==null?void 0:v.spendItems)||[],agreementList:(v==null?void 0:v.agreements)||[],poleList:Fe?[{WRK_ID:t.id,POLE_YN:Fe.POLE_YN,LAN_GB:Fe.LAN_GB||"",REG_UID:bt}]:[]};k(Yt,{onSuccess:ms=>{ms.code==="SUCCESS"||ms.code==="OK"?(localStorage.removeItem(M()),t.WRK_STAT_CD="3",r==null||r("  .","success"),n()):r==null||r(ms.message||"   .","error",!0)},onError:ms=>{r==null||r(ms.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[L&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[de&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:U,onValueChange:Q,options:q,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Z||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-h-10 px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed"}),s.jsx("button",{type:"button",onClick:()=>X(!0),className:`px-4 py-2 text-sm font-semibold rounded-lg whitespace-nowrap ${u?"bg-gray-500 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:u?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:P,onValueChange:F,options:Oe,placeholder:" ",required:!0,disabled:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:[" ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 flex items-center min-h-10 px-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm",children:[s.jsx("span",{children:ve||""}),At&&s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(: ",At,")"]})]}),s.jsxs("button",{type:"button",onClick:()=>me(!0),className:`min-h-10 px-3 sm:px-4 rounded-lg font-bold text-sm whitespace-nowrap flex items-center gap-1.5 ${u?"bg-gray-500 hover:bg-gray-600 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:[s.jsx(Ed,{className:"w-4 h-4"}),s.jsx("span",{children:u?"":""})]})]})]}),((v==null?void 0:v.kpiProdGrpCd)==="D"||(v==null?void 0:v.prodGrp)==="D"||t.PROD_GRP==="D")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5",children:""}),s.jsx(sn,{value:H,onValueChange:V,options:gt,placeholder:"",disabled:u})]}),we&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["OTT BOX  ",!u&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:Be,readOnly:!0,placeholder:"SER_NO   ",className:"flex-1 px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-600"}),s.jsxs("button",{type:"button",onClick:()=>ge(!0),disabled:u,className:`px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 ${u?"bg-gray-400 text-white cursor-not-allowed":Be?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"SER_NO"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:G,onChange:Me=>B(Me.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${u?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,rows:3,readOnly:u,disabled:u}),!u&&s.jsxs("p",{className:`text-xs text-right mt-1 ${G.length>=500?"text-red-500":"text-gray-400"}`,children:[G.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:vs,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>O(!R),className:"w-full flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:""}),s.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${R?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&s.jsxs("div",{className:"p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"DTV ()"}),s.jsx(sn,{value:ee,onValueChange:J,options:ls,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"ISP ()"}),s.jsx(sn,{value:I,onValueChange:E,options:$e,placeholder:"",disabled:u})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-900 mb-1",children:"VoIP (VoIP)"}),s.jsx(sn,{value:A,onValueChange:Y,options:Ue,placeholder:"",disabled:u})]})]})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!u&&s.jsx("button",{onClick:st,disabled:L,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${L?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:L?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>De(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:Ne,onClose:()=>X(!1),onSave:ft,workId:t.id,initialData:se,workType:t.WRK_CD,customerId:(he=t.customer)==null?void 0:he.id,customerName:(ye=t.customer)==null?void 0:ye.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:t.KPI_PROD_GRP_CD||"",prodChgGb:t.PROD_CHG_GB||"",chgKpiProdGrpCd:t.CHG_KPI_PROD_GRP_CD||"",prodGrp:t.PROD_GRP||"",wrkDtlTcd:t.WRK_DTL_TCD||"",readOnly:u}),s.jsx(el,{isOpen:be,onClose:()=>De(!1),ctrtId:t.CTRT_ID,custId:(je=t.customer)==null?void 0:je.id}),s.jsx(_m,{isOpen:re,onClose:()=>me(!1),onSave:Me=>{et(Me.INSTL_LOC),ot(Me.VIEW_MOD_CD),ct(Me.VIEW_MOD_NM),me(!1)},workId:t.id,ctrtId:t.CTRT_ID,prodGrp:(v==null?void 0:v.prodGrp)||(v==null?void 0:v.PROD_GRP),initialInstlLoc:ve,initialViewModCd:Dt,initialViewModNm:At,showToast:r,readOnly:u}),s.jsx(b_,{isOpen:Ve,onClose:()=>it(!1),onSave:Ft,soId:t.SO_ID||""}),s.jsx(Ba,{isOpen:Ge,onClose:()=>at(!1),onConfirm:qt,title:" ",message:" ?",type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{equipmentData:v,installInfoData:se,custRel:P,custRelOptions:Oe,memo:G,installLocationText:ve,order:t})}),s.jsx(lN,{isOpen:xt,onClose:()=>mt(!1),wrkCd:t.WRK_CD,wrkId:t.id,rcptId:t.RCPT_ID}),s.jsx(iN,{isOpen:pe,onClose:()=>ge(!1),onSave:Me=>{ue(Me),r==null||r("OTT  .","success")},wrkId:t.id||"",wrkDrctnId:t.directionId||t.WRK_DRCTN_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",dataType:Pe,showToast:r,readOnly:u})]})},zM=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1,certifyMode:o=!1})=>{var ye,je,Me,tt;const c=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[u,h]=b.useState(!1),{equipmentData:m,filteringData:_,removalLineData:p,setRemovalLineData:g}=ta(),{certifyRegconfInfo:C}=Za(),y=t.id||"",S=xa(y),v=ki(Te=>{var bt;return((bt=Te.workStates[y])==null?void 0:bt.reuseAll)??!1}),k=ki(Te=>Te.setReuseAll),L={...m||i||_||{},installedEquipments:S.installedEquipments.length>0?S.installedEquipments:(m==null?void 0:m.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:S.removeEquipments.length>0?S.removeEquipments:(m==null?void 0:m.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(S.removalStatus).length>0?S.removalStatus:(m==null?void 0:m.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:M,isPending:P}=Md(),F=()=>`work_complete_draft_${t.id}`,[G,B]=b.useState(""),[I,E]=b.useState(""),[A,Y]=b.useState(""),[ee,J]=b.useState(""),[H,V]=b.useState(!1),[K,j]=b.useState(""),[te,ce]=b.useState(""),[R,O]=b.useState(void 0),[U,Q]=b.useState(!1),q=p,$=g,[de,ae]=b.useState(!1),[_e,ie]=b.useState(!1),[Ne,X]=b.useState(!1),[xe,fe]=b.useState(null),[Z,le]=b.useState(!1),[se,Re]=b.useState(null),[be,De]=b.useState(!1),[re,me]=b.useState(""),[ve,et]=b.useState(!1),[Dt,ot]=b.useState(!1),[At,ct]=b.useState("none"),[Ge,at]=b.useState(""),[xt,mt]=b.useState(!1),[Ve,it]=b.useState([]),[Fe,nt]=b.useState([]),[lt,Mt]=b.useState([]),[ut,qe]=b.useState(null),[Ee,Ye]=b.useState(!1),[pe,ge]=b.useState(""),[Be,ue]=b.useState(!1),[we,Je]=b.useState(null),[Pe,Nt]=b.useState(!1),[Oe,dt]=b.useState(!1),[gt,It]=b.useState(()=>{const Te=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(Te&&Te.length>=8)return`${Te.slice(0,4)}-${Te.slice(4,6)}-${Te.slice(6,8)}`;const bt=new Date;return bt.getFullYear()+"-"+String(bt.getMonth()+1).padStart(2,"0")+"-"+String(bt.getDate()).padStart(2,"0")});b.useEffect(()=>{var bt,Ke;if(Y(((bt=t.customer)==null?void 0:bt.name)||""),J(((Ke=t.customer)==null?void 0:Ke.contactNumber)||t.REQ_CUST_TEL_NO||""),c){console.log("[WorkCompleteRemovalTerminate]   - getWorkReceiptDetail API "),(async()=>{try{const Et=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});Et?(console.log("[WorkCompleteRemovalTerminate] API :",Et),B(Et.CUST_REL||""),E((Et.WRK_PROC_CT||"").replace(/\\n/g,`
`)),j(Et.NET_CL||""),ce(Et.NET_CL_NM||""),O({NET_CL:Et.NET_CL||"",NET_CL_NM:Et.NET_CL_NM||"",WRNG_TP:Et.WRNG_TP||"",INSTL_TP:Et.INSTL_TP||"",CB_WRNG_TP:Et.CB_WRNG_TP||"",CB_INSTL_TP:Et.CB_INSTL_TP||"",INOUT_LINE_TP:Et.INOUT_LINE_TP||"",INOUT_LEN:Et.INOUT_LEN||"",DVDR_YN:Et.DVDR_YN||"",BFR_LINE_YN:Et.BFR_LINE_YN||"",CUT_YN:Et.CUT_YN||"",TERM_NO:Et.TERM_NO||"",RCV_STS:Et.RCV_STS||"",SUBTAP_ID:Et.SUBTAP_ID||"",PORT_NUM:Et.PORT_NUM||"",EXTN_TP:Et.EXTN_TP||"",TAB_LBL:Et.TAB_LBL||"",CVT_LBL:Et.CVT_LBL||"",STB_LBL:Et.STB_LBL||""}),E((Et.WRK_PROC_CT||"").replace(/\\n/g,`
`)),Et.WRKR_CMPL_DT&&Et.WRKR_CMPL_DT.length>=8&&It(`${Et.WRKR_CMPL_DT.slice(0,4)}-${Et.WRKR_CMPL_DT.slice(4,6)}-${Et.WRKR_CMPL_DT.slice(6,8)}`)):(console.log("[WorkCompleteRemovalTerminate] API  - order  "),B(t.CUST_REL||""),j(t.NET_CL||""),ce(t.NET_CL_NM||""))}catch(Et){console.error("[WorkCompleteRemovalTerminate] API  :",Et),B(t.CUST_REL||""),j(t.NET_CL||""),ce(t.NET_CL_NM||"")}finally{h(!0)}})();return}const Te=localStorage.getItem(F());if(Te)try{const St=JSON.parse(Te);B(St.custRel||""),E(St.memo||""),j(St.networkType||""),ce(St.networkTypeName||""),O(St.installInfoData),St.cnfmCustNm&&Y(St.cnfmCustNm),St.cnfmCustTelno&&J(St.cnfmCustTelno)}catch(St){console.error("[WorkCompleteRemovalTerminate] localStorage  :",St)}h(!0)},[t.id,c]),b.useEffect(()=>{if(!u||c)return;const Te={custRel:G,memo:I,networkType:K,networkTypeName:te,installInfoData:R,cnfmCustNm:A,cnfmCustTelno:ee,savedAt:new Date().toISOString()};localStorage.setItem(F(),JSON.stringify(Te))},[G,I,K,te,R,A,ee,u,c]),b.useEffect(()=>{(async()=>{var bt;try{const Ke=await po(["CMCU005"]);Ke.CMCU005&&Mt(Ke.CMCU005.map(ze=>({value:ze.COMMON_CD,label:ze.COMMON_CD_NM})));try{const ze=await x_({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:t.WRKR_ID||"",PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"02",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||((bt=t.customer)==null?void 0:bt.ADDR_ORD)||"",WRK_CD:t.WRK_CD||"08",WRK_STAT_CD:t.WRK_STAT_CD||""});console.log("[CompleteRelocateTerminate] :",ze),fe(ze);const ht=(ze==null?void 0:ze.MVM_TP)||"",Lt=(ze==null?void 0:ze.WRK_STAT_CD)||"",Bt=(ze==null?void 0:ze.CTRT_ID)||"",Yt=(ze==null?void 0:ze.OLD_CTRT_ID)||"",Xt=Lt==="2";console.log("[CompleteRelocateTerminate]  :",{MVM_TP:ht,WRK_STAT_CD:Lt,CTRT_ID:Bt,OLD_CTRT_ID:Yt,shouldReuse:Xt}),!Xt&&v&&k(y,!1)}catch(ze){console.error("[CompleteRelocateTerminate]   :",ze)}const St=await Ac();if(St&&St.length>0){it(St);const ze=t.PROD_CD||t.BASIC_PROD_CD||"",ht=St.some(Lt=>Lt.PROD_CD===ze);mt(ht),console.log("[WorkCompleteRemovalTerminate] LGHV STB :",{prodCd:ze,isLghv:ht,lghvListCount:St.length})}const Et=t.CERTIFY_TG||"";if(Et==="Y"){const ze=await N1();nt(ze);const ht=t.NEW_PROD_CD||t.PROD_CD||"",Lt=t.SO_ID||"",Bt=ze.some(Yt=>Yt.PROD_CD===ht);console.log("[WorkCompleteRemovalTerminate]  :",{certifyTg:Et,newProdCd:ht,soId:Lt,isCertifyProd:Bt}),Bt||et(!0)}}catch(Ke){console.error("[WorkCompleteRemovalTerminate]    :",Ke)}})()},[t]);const $e=Te=>!Te||Te.length!==8?"":`${Te.slice(0,4)}-${Te.slice(4,6)}-${Te.slice(6,8)}`,$t=Te=>Te.replace(/-/g,""),Ue=()=>new Date().toISOString().slice(0,10).replace(/-/g,""),ss=(Te,bt)=>{if(!Te||!bt)return 0;const Ke=new Date($e(Te)),St=new Date($e(bt));return Math.ceil((St.getTime()-Ke.getTime())/(1e3*60*60*24))},ls=b.useCallback(async()=>{const Te=t.RCPT_ID||"",bt=t.CTRT_ID||"";if(!(!Te||!bt)){Ye(!0),Je(null);try{const Ke=await IM({RCPT_ID:Te,CTRT_ID:bt});if(console.log("[CompleteRemovalTerminate]   :",Ke),Ke){qe(Ke),ge($e(Ke.MMT_SUS_HOPE_DD));const St=Ue();Ke.WRK_DTL_TCD==="0430"&&Ke.MMT_SUS_HOPE_DD<=St?(ue(!0),r==null||r("  .   .","warning")):ue(!1)}}catch(Ke){console.error("[CompleteRemovalTerminate]   :",Ke),Je(Ke.message||"   ")}finally{Ye(!1)}}},[t.RCPT_ID,t.CTRT_ID,r]);b.useEffect(()=>{ls()},[ls]);const ds=()=>{const Te=[];return(!G||G==="[]")&&Te.push("  ."),R!=null&&R.NET_CL||Te.push("  ."),R!=null&&R.WRNG_TP||Te.push("  ."),R!=null&&R.INSTL_TP?R.INSTL_TP!=="77"&&Te.push('   "(77)" .'):Te.push("  ."),gt||Te.push(" ."),st()&&!q&&Te.push("   ."),Te},vs=Te=>{O(Te),Te.NET_CL&&j(Te.NET_CL),Te.NET_CL_NM&&ce(Te.NET_CL_NM),r==null||r("  .","success")},Ss=async()=>{var Te;ot(!0),at(""),ct("none");try{const bt=localStorage.getItem("userInfo"),Ke=bt?JSON.parse(bt):{},St=await Bp({CTRT_ID:t.CTRT_ID||"",CUST_ID:((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:Ke.userId||"",WRK_ID:t.id||""});St!=null&&St.ERROR?(ct("error"),at(St.ERROR),r==null||r(` : ${St.ERROR}`,"error")):(ct("success"),at(" ."),r==null||r(" .","success"))}catch(bt){console.error("[ CL-06 ]:",bt),ct("error"),at(bt.message||"    ."),r==null||r(bt.message||"    .","error",!0)}finally{ot(!1)}},ke=async()=>{var Te;ot(!0),at("");try{const bt=localStorage.getItem("userInfo"),Ke=bt?JSON.parse(bt):{},St=await $g({CTRT_ID:t.CTRT_ID||"",CUST_ID:((Te=t.customer)==null?void 0:Te.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:Ke.userId||"",WRK_ID:t.id||""}),Et=Array.isArray(St)?St[0]:St;if(Et!=null&&Et.ERROR)ct("error"),at(` : ${Et.ERROR}`),r==null||r(` : ${Et.ERROR}`,"warning");else{const ze=(Et==null?void 0:Et.RESULT)||(Et==null?void 0:Et.MSG)||JSON.stringify(Et);at(` : ${ze}`),r==null||r(" ","info")}}catch(bt){console.error("[ CL-08 ]:",bt),at(bt.message||"   ."),r==null||r(bt.message||"   .","error",!0)}finally{ot(!1)}},ft=async()=>{var Ke,St,Et,ze,ht;const Te=(L==null?void 0:L.removedEquipments)||[];if((t.CTRT_STAT||"")==="20")return console.log("[]  20 - "),!0;try{const Lt=localStorage.getItem("userInfo"),Yt=(Lt?JSON.parse(Lt):{}).userId||"A20130708";let Xt="SMR05",ts="";if(xt){const cs=(xe==null?void 0:xe.NEW_PROD_CD)||"",ms=(xe==null?void 0:xe.OLD_PROD_CD)||"",Ys=(xe==null?void 0:xe.CTRT_ID)||t.CTRT_ID||"",Ps=(xe==null?void 0:xe.OLD_CTRT_ID)||"",rt=Ve.some(bs=>bs.PROD_CD===cs),Wt=Ve.some(bs=>bs.PROD_CD===ms);if(rt&&Wt){if(Ys===Ps)return console.log("[] LGHV LL  -   "),le(!0),!0}else{const bs=Te.find(zt=>{var ws,Zt;return(zt.ITEM_MID_CD||zt.itemMidCd||((ws=zt.actualEquipment)==null?void 0:ws.ITEM_MID_CD)||((Zt=zt.actualEquipment)==null?void 0:Zt.itemMidCd))==="04"});bs&&(ts=bs.EQT_NO||bs.id||((Ke=bs.actualEquipment)==null?void 0:Ke.EQT_NO)||((St=bs.actualEquipment)==null?void 0:St.id)||"")}Xt="STB_DEL"}const Ut=t.DTL_CTRT_ID||t.CTRT_ID||"",Is=Te.some(cs=>{var ms;return cs.CTRT_ID===Ut||((ms=cs.actualEquipment)==null?void 0:ms.CTRT_ID)===Ut});Te.length>0&&!Is&&(console.warn("[]    -   "),r==null||r("    .","warning"));const Cs=Te.find(cs=>{var ms;return cs.PROD_CMPS_CL==="23"||((ms=cs.actualEquipment)==null?void 0:ms.PROD_CMPS_CL)==="23"}),Us=(Cs==null?void 0:Cs.PROD_CMPS_ID)||((Et=Cs==null?void 0:Cs.actualEquipment)==null?void 0:Et.PROD_CMPS_ID)||(Cs==null?void 0:Cs.EQT_PROD_CMPS_ID)||((ze=Cs==null?void 0:Cs.actualEquipment)==null?void 0:ze.EQT_PROD_CMPS_ID)||"",Es=(t.VOIP_PROD_CD||"")&&t.CTRT_ID||"";console.log(`[] ${Xt}  `,{isLghvStb:xt,eqtProdCmpsId:Us,etc1:ts,voipJoinCtrtId:Es});const Ls=await _a({MSG_ID:Xt,CUST_ID:((ht=t.customer)==null?void 0:ht.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Us,PROD_CD:"",WRK_ID:t.id||"",REG_UID:Yt,ETC_1:ts,ETC_2:"",ETC_3:"",ETC_4:"",VOIP_JOIN_CTRT_ID:Es,WTIME:"3"});return Ls.code==="SUCCESS"||Ls.code==="OK"||Ls.message&&Ls.message.indexOf("TRUE")>-1&&Ls.message.indexOf("000000")>-1?(console.log("[] :",Ls),le(!0),Re({success:!0,message:"  "}),!0):(console.warn("[] :",Ls),Re({success:!1,message:Ls.message||"  "}),!1)}catch(Lt){return console.error("[] :",Lt),Re({success:!1,message:Lt.message||"  "}),!1}},st=()=>{const Te=t.KPI_PROD_GRP_CD||"",bt=t.VOIP_CTX||"";return["C","D","I"].includes(Te)&&bt!=="T"&&bt!=="R"},Ft=Te=>{console.log("[WorkCompleteRemovalTerminate]   () :",Te),$(Te),r==null||r("  .   .","info")},_t=Te=>{console.log("[WorkCompleteRemovalTerminate]   - AS  :",Te),$(Te),ae(!0)},qt=async Te=>{console.log("[WorkCompleteRemovalTerminate] AS :",Te),ie(!0);try{const bt=localStorage.getItem("userInfo"),St=(bt?JSON.parse(bt):{}).userId||"A20130708",Et=await Gp({WRK_ID:t.id,REMOVE_LINE_TP:Te.REMOVE_LINE_TP,REMOVE_GB:Te.REMOVE_GB,REMOVE_STAT:Te.REMOVE_STAT||"",REG_UID:St});if(Et.code!=="SUCCESS"&&Et.code!=="OK")throw new Error(Et.message||"   .");const ze=await MM({CUST_ID:Te.CUST_ID,RCPT_ID:Te.RCPT_ID||"",WRK_DTL_TCD:Te.WRK_DTL_TCD,WRK_RCPT_CL:Te.WRK_RCPT_CL,WRK_RCPT_CL_DTL:Te.WRK_RCPT_CL_DTL,WRK_HOPE_DTTM:Te.WRK_HOPE_DTTM,MEMO:Te.MEMO||"",EMRG_YN:Te.EMRG_YN||"N",HOLY_YN:Te.HOLY_YN||"N",CRR_ID:Te.CRR_ID||"01",WRKR_ID:Te.WRKR_ID||St,REG_UID:Te.REG_UID||St});if(ze.code==="SUCCESS"||ze.code==="OK")ae(!1),r==null||r("AS .   .","success");else throw new Error(ze.message||"AS .")}catch(bt){r==null||r(bt.message||"AS   .","error",!0)}finally{ie(!1)}},jt=()=>{if(P)return;if(((L==null?void 0:L.removedEquipments)||[]).some(Et=>{var ze;return Et.PROD_CMPS_CL==="23"||((ze=Et.actualEquipment)==null?void 0:ze.PROD_CMPS_CL)==="23"})){r==null||r("      .  .","error");return}const Ke=ds();if(Ke.length>0){if(Ke.forEach(Et=>r==null?void 0:r(Et,"error")),Ke.some(Et=>Et.includes(""))){const Et=document.getElementById("removal-line-section");Et&&(Et.scrollIntoView({behavior:"smooth",block:"center"}),Et.classList.add("ring-2","ring-red-500","ring-offset-2"),setTimeout(()=>{Et.classList.remove("ring-2","ring-red-500","ring-offset-2")},2e3))}return}const St=t.TERM_HOPE_DT||t.HOPE_DT||"";if(St&&gt){const Et=St.replace(/-/g,"");gt.replace(/-/g,"")<Et&&(r==null||r("  .","warning"))}me(" ?"),De(!0)},he=async()=>{var Is,Cs,Us;console.log("[WorkCompleteRemovalTerminate]   ");const Te=localStorage.getItem("userInfo"),bt=Te?JSON.parse(Te):{},Ke=bt.userId||"A20130708";let St="N";const Et=o||d0(t.OP_LNKD_CD);if(console.log("[CompleteRelocateTerminate] FTTH :",{IS_CERTIFY_PROD:t.IS_CERTIFY_PROD,OP_LNKD_CD:t.OP_LNKD_CD,isFtth:Et}),Et)try{const _s=t.CTRT_ID||"",Es=await $g({CTRT_ID:_s,CUST_ID:((Is=t.customer)==null?void 0:Is.id)||t.CUST_ID||"",SO_ID:t.SO_ID||"",REG_UID:Ke,WRK_ID:t.id||""}),Ls=Array.isArray(Es)?Es[0]:Es;console.log("[CompleteRelocateTerminate] CL-08 result:",Ls,"ctrtId:",_s),Ls&&!Ls.ERROR&&Ls.CONT_ID===_s&&(St="Y",console.log("[CompleteRelocateTerminate] CERTIFY_TG=Y (IS_CERTIFY_PROD=1 + CL-08 confirmed)"))}catch(_s){console.log("[CompleteRelocateTerminate] CL-08 query failed:",_s)}if(St==="Y")try{const _s=(xe==null?void 0:xe.NEW_PROD_CD)||"",Es=(xe==null?void 0:xe.SO_ID)||t.SO_ID||"",Ls=Fe.some(Ps=>Ps.PROD_CD===_s),Ys=(await qa("CMIF006")).map(Ps=>Ps.code).includes(Es);if(console.log("[CompleteRelocateTerminate] CL-06  :",{certifyTg:St,newProdCd:_s,newSoId:Es,isNewProdCertify:Ls,isNewSoCertify:Ys}),!Ls||!Ys){console.log("[CompleteRelocateTerminate] FTTH CL-06    ");const Ps=await Bp({CTRT_ID:t.CTRT_ID||"",CUST_ID:((Cs=t.customer)==null?void 0:Cs.id)||t.CUST_ID||"",WRK_ID:t.id||"",SO_ID:Es||t.SO_ID||"",REG_UID:Ke});if(Ps!=null&&Ps.ERROR){console.error("[CompleteRelocateTerminate] CL-06  :",Ps.ERROR),r==null||r(`  : ${Ps.ERROR}`,"error");return}console.log("[CompleteRelocateTerminate] CL-06    ")}else console.log("[CompleteRelocateTerminate]  /SO certify  CL-06 ")}catch(_s){console.error("[CompleteRelocateTerminate] CL-06  :",_s),r==null||r(`   : ${_s.message||"   "}`,"error");return}if(q&&q.REMOVE_GB==="4")try{console.log("[WorkCompleteRemovalTerminate]   API :",q);const _s=await Gp({WRK_ID:t.id||"",REMOVE_LINE_TP:q.REMOVE_LINE_TP||"",REMOVE_GB:q.REMOVE_GB||"4",REMOVE_STAT:q.REMOVE_STAT||"",REG_UID:Ke});if(_s.code!=="SUCCESS"&&_s.code!=="OK"){r==null||r(_s.message||"   .","error",!0);return}console.log("[WorkCompleteRemovalTerminate]    ")}catch(_s){r==null||r(_s.message||"     .","error",!0);return}if(Oe&&ut&&pe){Nt(!0);try{const _s=ut.SUS_HOPE_DD,Es=$t(pe),Ls=ss(_s,Es),cs=await jM({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",SUS_HOPE_DD:_s,MMT_SUS_HOPE_DD:Es,SUS_DD_NUM:String(Ls),REG_UID:Ke});if(cs.code!=="SUCCESS"){r==null||r(cs.message||"  ","error",!0),Nt(!1);return}console.log("[CompleteRemovalTerminate]   ")}catch(_s){r==null||r(_s.message||"  ","error",!0),Nt(!1);return}Nt(!1)}const ze=(L==null?void 0:L.removedEquipments)||[],ht=(L==null?void 0:L.customerEquipments)||[],Lt=(L==null?void 0:L.installedEquipments)||[],Bt=!!t.ISP_PROD_CD,Yt=t.CTRT_STAT||"";if(console.log("[CompleteRelocateTerminate]   :",{signalSent:Z,certifyTg:St,removedEquipments:ze.length,customerEquipments:ht.length,installedEquipments:Lt.length,hasIspProdForSignal:Bt,ctrtStat:Yt,ISP_PROD_CD:t.ISP_PROD_CD,CTRT_STAT:t.CTRT_STAT,shouldSendSignal:!Z&&St!=="Y"&&(ze.length>0||ht.length>0||Lt.length>0||Bt)&&Yt!=="20"}),!Z&&St!=="Y"&&(ze.length>0||ht.length>0||Lt.length>0||Bt)&&Yt!=="20"&&(r==null||r(" ...","info"),!await ft())){const Es=t.PROD_GRP||"",Ls=(se==null?void 0:se.message)||"";if(Es==="V"&&Ls.indexOf("PROC_VOIP_KCT-029")<0){r==null||r("VoIP   .","error",!0);return}if((t.MSO_OUT_YN||"")==="Y"){r==null||r("MSO      .  .","error");return}if(!window.confirm(` .
  ?`)){console.log("[CompleteRemovalTerminate]      ");return}console.log("[CompleteRemovalTerminate]      ")}const Xt=gt.replace(/-/g,""),ts=_s=>{if(!_s||_s.length===0)return[];const Es=(L==null?void 0:L.removalStatus)||{},Ls=(cs,ms)=>cs==="1"||cs==="Y"||ms==="1"||ms==="Y"?"1":"0";return _s.map(cs=>{var Wt,bs,zt,ws;const ms=cs.EQT_NO||cs.id||((Wt=cs.actualEquipment)==null?void 0:Wt.id)||"",Ys=Es[ms]||Es[cs.id]||Es[cs.EQT_NO]||Es[(bs=cs.actualEquipment)==null?void 0:bs.id]||Es[cs.serialNumber]||{},Ps=v?"1":"0",rt={CRR_TSK_CL:"02",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||bt.crrId||"01",WRKR_ID:Ke,EQT_LOSS_YN:Ls(cs.EQT_LOSS_YN,Ys.EQT_LOSS_YN),PART_LOSS_BRK_YN:Ls(cs.PART_LOSS_BRK_YN,Ys.PART_LOSS_BRK_YN),EQT_BRK_YN:Ls(cs.EQT_BRK_YN,Ys.EQT_BRK_YN),EQT_CABL_LOSS_YN:Ls(cs.EQT_CABL_LOSS_YN,Ys.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Ls(cs.EQT_CRDL_LOSS_YN,Ys.EQT_CRDL_LOSS_YN),REUSE_YN:Ps};if(cs.actualEquipment){const Zt=cs.actualEquipment,Ds=cs.contractEquipment||{};return{...Zt,EQT_NO:Zt.id,EQT_SERNO:Zt.serialNumber,ITEM_MID_CD:Zt.itemMidCd,EQT_CL_CD:Zt.eqtClCd,MAC_ADDRESS:cs.macAddress||Zt.macAddress,WRK_ID:t.id,CUST_ID:(zt=t.customer)==null?void 0:zt.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:Ds.id||Ds.SVC_CMPS_ID||Zt.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Zt.BASIC_PROD_CMPS_ID||Ds.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:Zt.EQT_PROD_CMPS_ID||Ds.id,PROD_CD:Zt.PROD_CD||Ds.PROD_CD||t.PROD_CD||"",SVC_CD:Zt.SVC_CD||Ds.SVC_CD||"",EQT_SALE_AMT:Zt.EQT_SALE_AMT||"0",MST_SO_ID:Zt.MST_SO_ID||t.SO_ID||"",SO_ID:Zt.SO_ID||t.SO_ID||"",REG_UID:Ke,OLD_LENT_YN:Zt.OLD_LENT_YN||"N",LENT:Zt.LENT||"10",ITLLMT_PRD:Zt.ITLLMT_PRD||"00",EQT_USE_STAT_CD:Zt.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:Zt.IF_DTL_ID||"",...rt}}return{...cs,EQT_NO:cs.EQT_NO||cs.id||"",EQT_SERNO:cs.EQT_SERNO||cs.serialNumber||"",ITEM_MID_CD:cs.ITEM_MID_CD||cs.itemMidCd||"",EQT_CL_CD:cs.EQT_CL_CD||cs.eqtClCd||"",MAC_ADDRESS:cs.MAC_ADDRESS||cs.macAddress||"",SVC_CMPS_ID:cs.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:cs.BASIC_PROD_CMPS_ID||"",PROD_CD:cs.PROD_CD||"",SVC_CD:cs.SVC_CD||"",WRK_ID:cs.WRK_ID||t.id,CUST_ID:cs.CUST_ID||((ws=t.customer)==null?void 0:ws.id),CTRT_ID:cs.CTRT_ID||t.CTRT_ID,WRK_CD:cs.WRK_CD||t.WRK_CD,REG_UID:Ke,...rt}})},Ut={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Us=t.customer)==null?void 0:Us.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||bt.crrId||"01",WRKR_ID:Ke,WRKR_CMPL_DT:Xt,MEMO:I||" ",STTL_YN:"Y",REG_UID:Ke,CUST_REL:G,CNFM_CUST_NM:A,CNFM_CUST_TELNO:ee,REQ_CUST_TEL_NO:ee,INSTL_LOC:"",UP_CTRL_CL:"",PSN_USE_CORP:"",VOIP_USE_CORP:"",DTV_USE_CORP:"",WRK_ACT_CL:"20",NET_CL:(R==null?void 0:R.NET_CL)||"",WRNG_TP:(R==null?void 0:R.WRNG_TP)||"",INSTL_TP:(R==null?void 0:R.INSTL_TP)||"77",CB_WRNG_TP:(R==null?void 0:R.CB_WRNG_TP)||"",CB_INSTL_TP:(R==null?void 0:R.CB_INSTL_TP)||"",INOUT_LINE_TP:(R==null?void 0:R.INOUT_LINE_TP)||"",INOUT_LEN:(R==null?void 0:R.INOUT_LEN)||"",DVDR_YN:(R==null?void 0:R.DVDR_YN)||"",BFR_LINE_YN:(R==null?void 0:R.BFR_LINE_YN)||"",CUT_YN:(R==null?void 0:R.CUT_YN)||"",TERM_NO:(R==null?void 0:R.TERM_NO)||"",RCV_STS:(R==null?void 0:R.RCV_STS)||"",SUBTAP_ID:(R==null?void 0:R.SUBTAP_ID)||"",PORT_NUM:(R==null?void 0:R.PORT_NUM)||"",EXTN_TP:(R==null?void 0:R.EXTN_TP)||"",TAB_LBL:(R==null?void 0:R.TAB_LBL)||"",CVT_LBL:(R==null?void 0:R.CVT_LBL)||"",STB_LBL:(R==null?void 0:R.STB_LBL)||"",KPI_PROD_GRP:"",OBS_RCPT_CD:"",OBS_RCPT_DTL_CD:"",VOIP_JOIN_CTRT_ID:"",AGREE_YN:"",ISP_YN:"",AGREE_GB:"",CUST_CLEAN_YN:"",EQT_RMV_FLAG:"",TV_TYPE:""},equipmentList:[],removeEquipmentList:ts((L==null?void 0:L.removedEquipments)||[]),spendItemList:(L==null?void 0:L.spendItems)||[],agreementList:(L==null?void 0:L.agreements)||[],poleList:(L==null?void 0:L.poleResults)||[]};M(Ut,{onSuccess:_s=>{_s.code==="SUCCESS"||_s.code==="OK"?(localStorage.removeItem(F()),t.WRK_STAT_CD="3",r==null||r("  .","success"),n()):r==null||r(_s.message||"   .","error",!0)},onError:_s=>{r==null||r(_s.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[P&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:te||"",readOnly:!0,disabled:!0,placeholder:"  ()",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>V(!0),className:`px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${c?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:c?"":""})]}),!c&&!(R!=null&&R.NET_CL)&&s.jsx("p",{className:"mt-1 text-xs text-red-500",children:"*    ."})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!c&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:G,onValueChange:B,options:lt,placeholder:" ",required:!0,disabled:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:I,onChange:Te=>E(Te.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${c?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:c,disabled:c}),!c&&s.jsxs("p",{className:`text-xs text-right mt-1 ${I.length>=500?"text-red-500":"text-gray-400"}`,children:[I.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:gt,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),ve&&!c&&s.jsxs("div",{className:"p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-semibold text-indigo-800",children:""}),At==="success"&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:""}),At==="error"&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-red-100 text-red-700 rounded-full",children:""})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{type:"button",onClick:Ss,disabled:Dt,className:"flex-1 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm font-semibold rounded-lg transition-colors flex items-center justify-center gap-1.5",children:[Dt?s.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),s.jsx("span",{children:""})]}),s.jsxs("button",{type:"button",onClick:ke,disabled:Dt,className:"flex-1 px-3 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white text-sm font-semibold rounded-lg transition-colors flex items-center justify-center gap-1.5",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),s.jsx("span",{children:""})]})]}),Ge&&s.jsx("p",{className:`mt-2 text-xs ${At==="error"?"text-red-600":At==="success"?"text-green-600":"text-gray-600"}`,children:Ge})]}),xt&&!c&&s.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-orange-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-sm font-medium text-orange-800",children:"LGHV STB .    STB   ."})]})}),s.jsx(aN,{custId:((ye=t.customer)==null?void 0:ye.id)||t.CUST_ID||"",rcptId:t.RCPT_ID||"",ctrtId:t.CTRT_ID||"",soId:t.SO_ID||"",termDt:t.TERM_DT||"",wrkCd:t.WRK_CD,showToast:r}),st()&&s.jsx(WM,{onComplete:Ft,onAssignAS:_t,showToast:r,disabled:c,savedData:q,onReset:()=>$(null)}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:[!c&&s.jsx("button",{onClick:jt,disabled:P,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${P?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:P?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})}),s.jsxs("button",{type:"button",onClick:()=>Q(!0),className:"flex-1 min-h-10 sm:min-h-12 px-3 sm:px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold transition-colors flex items-center justify-center gap-1.5 sm:gap-2 text-sm sm:text-base",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:""})]})]})]})})}),s.jsx(wc,{isOpen:H,onClose:()=>V(!1),onSave:vs,workId:t.id,initialData:R,workType:t.WRK_CD,customerId:t.customer.id,customerName:t.customer.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(L==null?void 0:L.kpiProdGrpCd)||(L==null?void 0:L.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(L==null?void 0:L.prodChgGb)||(L==null?void 0:L.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(L==null?void 0:L.chgKpiProdGrpCd)||(L==null?void 0:L.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(L==null?void 0:L.prodGrp)||(L==null?void 0:L.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:c}),s.jsx(el,{isOpen:U,onClose:()=>Q(!1),ctrtId:t.CTRT_ID,custId:t.customer.id}),s.jsx(lN,{isOpen:Ne,onClose:()=>X(!1),moveWorkData:xe,order:t}),s.jsx(FM,{isOpen:de,onClose:()=>ae(!1),onSave:qt,removalLineData:q,custId:((je=t.customer)==null?void 0:je.id)||"",custNm:((Me=t.customer)==null?void 0:Me.name)||"",addrOrd:((tt=t.customer)==null?void 0:tt.ADDR_ORD)||"",address:t.address||"",showToast:r}),s.jsx(Ba,{isOpen:be,onClose:()=>De(!1),onConfirm:he,title:" ",message:re,type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{equipmentData:L,installInfoData:R,custRel:G,custRelOptions:lt,memo:I,order:t})})]})},R6=({order:t,onBack:e,onSuccess:n,showToast:r,equipmentData:i,readOnly:a=!1})=>{var se,Re,be;const o=a||t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status===""||t.status==="",[c,u]=b.useState(!1),{equipmentData:h,filteringData:m}=ta(),{certifyRegconfInfo:_}=Za(),p=t.id||"",g=xa(p),C={...h||i||m||{},installedEquipments:g.installedEquipments.length>0?g.installedEquipments:(h==null?void 0:h.installedEquipments)||(i==null?void 0:i.installedEquipments)||[],removedEquipments:g.markedForRemoval.length>0?g.markedForRemoval:(h==null?void 0:h.removedEquipments)||(i==null?void 0:i.removedEquipments)||[],removalStatus:Object.keys(g.removalStatus).length>0?g.removalStatus:(h==null?void 0:h.removalStatus)||(i==null?void 0:i.removalStatus)||{}},{mutate:y,isPending:S}=Md(),v=()=>`work_complete_draft_${t.id}`,[k,L]=b.useState(""),[M,P]=b.useState(""),[F,G]=b.useState(((se=t.customer)==null?void 0:se.name)||""),[B,I]=b.useState(((Re=t.customer)==null?void 0:Re.phone)||""),[E,A]=b.useState(!1),[Y,ee]=b.useState(!1),[J,H]=b.useState(""),[V,K]=b.useState(""),[j,te]=b.useState(void 0),[ce,R]=b.useState(!1),[O,U]=b.useState(""),Q=t.MVM_TP==="1"&&["1","2"].includes(t.WRK_STAT_CD||"")&&t.CTRT_ID,[q,$]=b.useState([]),[de,ae]=b.useState(!1),[_e,ie]=b.useState([]),[Ne,X]=b.useState(()=>{const De=t.WRKR_CMPL_DT||t.WRK_END_DTTM;if(De&&De.length>=8)return`${De.slice(0,4)}-${De.slice(4,6)}-${De.slice(6,8)}`;const re=new Date;return re.getFullYear()+"-"+String(re.getMonth()+1).padStart(2,"0")+"-"+String(re.getDate()).padStart(2,"0")});b.useEffect(()=>{(async()=>{try{console.log("[WorkCompleteRemoval] getWorkReceiptDetail API ");const re=await Rd({WRK_DRCTN_ID:t.directionId||t.WRK_DRCTN_ID||"",WRK_ID:t.id,SO_ID:t.SO_ID});if(re)if(console.log("[WorkCompleteRemoval] API :",re),o)L(re.CUST_REL||""),P((re.WRK_PROC_CT||"").replace(/\\n/g,`
`)),H(re.NET_CL||""),K(re.NET_CL_NM||""),te({NET_CL:re.NET_CL||"",NET_CL_NM:re.NET_CL_NM||"",WRNG_TP:re.WRNG_TP||"",INSTL_TP:re.INSTL_TP||"",CB_WRNG_TP:re.CB_WRNG_TP||"",CB_INSTL_TP:re.CB_INSTL_TP||"",INOUT_LINE_TP:re.INOUT_LINE_TP||"",INOUT_LEN:re.INOUT_LEN||"",DVDR_YN:re.DVDR_YN||"",BFR_LINE_YN:re.BFR_LINE_YN||"",CUT_YN:re.CUT_YN||"",TERM_NO:re.TERM_NO||"",RCV_STS:re.RCV_STS||"",SUBTAP_ID:re.SUBTAP_ID||"",PORT_NUM:re.PORT_NUM||"",EXTN_TP:re.EXTN_TP||"",TAB_LBL:re.TAB_LBL||"",CVT_LBL:re.CVT_LBL||"",STB_LBL:re.STB_LBL||""}),P((re.WRK_PROC_CT||"").replace(/\\n/g,`
`)),re.WRKR_CMPL_DT&&re.WRKR_CMPL_DT.length>=8&&X(`${re.WRKR_CMPL_DT.slice(0,4)}-${re.WRKR_CMPL_DT.slice(4,6)}-${re.WRKR_CMPL_DT.slice(6,8)}`);else{const me=localStorage.getItem(v());if(me)try{const ve=JSON.parse(me);ve.installInfoData&&ve.installInfoData.NET_CL?(console.log("[WorkCompleteRemoval] localStorage  "),L(ve.custRel||""),P(ve.memo||""),H(ve.networkType||""),K(ve.networkTypeName||""),te(ve.installInfoData)):(console.log("[WorkCompleteRemoval] API   "),H(re.NET_CL||""),K(re.NET_CL_NM||""),te({NET_CL:re.NET_CL||"",NET_CL_NM:re.NET_CL_NM||"",WRNG_TP:re.WRNG_TP||"",INSTL_TP:re.INSTL_TP||"",CB_WRNG_TP:re.CB_WRNG_TP||"",CB_INSTL_TP:re.CB_INSTL_TP||"",INOUT_LINE_TP:re.INOUT_LINE_TP||"",INOUT_LEN:re.INOUT_LEN||"",DVDR_YN:re.DVDR_YN||"",BFR_LINE_YN:re.BFR_LINE_YN||"",CUT_YN:re.CUT_YN||""}),L(ve.custRel||""),P(ve.memo||""))}catch(ve){console.error("[WorkCompleteRemoval] localStorage  :",ve),H(re.NET_CL||""),K(re.NET_CL_NM||""),te({NET_CL:re.NET_CL||"",NET_CL_NM:re.NET_CL_NM||"",WRNG_TP:re.WRNG_TP||"",INSTL_TP:re.INSTL_TP||"",CB_WRNG_TP:re.CB_WRNG_TP||"",CB_INSTL_TP:re.CB_INSTL_TP||"",INOUT_LINE_TP:re.INOUT_LINE_TP||"",INOUT_LEN:re.INOUT_LEN||"",DVDR_YN:re.DVDR_YN||"",BFR_LINE_YN:re.BFR_LINE_YN||"",CUT_YN:re.CUT_YN||""})}else console.log("[WorkCompleteRemoval] localStorage  - API   "),H(re.NET_CL||""),K(re.NET_CL_NM||""),te({NET_CL:re.NET_CL||"",NET_CL_NM:re.NET_CL_NM||"",WRNG_TP:re.WRNG_TP||"",INSTL_TP:re.INSTL_TP||"",CB_WRNG_TP:re.CB_WRNG_TP||"",CB_INSTL_TP:re.CB_INSTL_TP||"",INOUT_LINE_TP:re.INOUT_LINE_TP||"",INOUT_LEN:re.INOUT_LEN||"",DVDR_YN:re.DVDR_YN||"",BFR_LINE_YN:re.BFR_LINE_YN||"",CUT_YN:re.CUT_YN||""})}else{console.log("[WorkCompleteRemoval] API   - localStorage  ");const me=localStorage.getItem(v());if(me)try{const ve=JSON.parse(me);L(ve.custRel||""),P(ve.memo||""),H(ve.networkType||""),K(ve.networkTypeName||""),te(ve.installInfoData)}catch(ve){console.error("[WorkCompleteRemoval] localStorage  :",ve)}}}catch(re){console.error("[WorkCompleteRemoval] API  :",re);const me=localStorage.getItem(v());if(me)try{const ve=JSON.parse(me);L(ve.custRel||""),P(ve.memo||""),H(ve.networkType||""),K(ve.networkTypeName||""),te(ve.installInfoData)}catch(ve){console.error("[WorkCompleteRemoval] localStorage  :",ve)}}finally{u(!0)}})()},[t.id,o]),b.useEffect(()=>{if(!c||o)return;const De={custRel:k,memo:M,networkType:J,networkTypeName:V,installInfoData:j,savedAt:new Date().toISOString()};localStorage.setItem(v(),JSON.stringify(De))},[k,M,J,V,j,c,o]),b.useEffect(()=>{(async()=>{try{const re=await po(["CMCU005"]);re.CMCU005&&$(re.CMCU005.map(me=>({value:me.COMMON_CD,label:me.COMMON_CD_NM})))}catch(re){console.error("[WorkCompleteRemoval]    :",re)}})()},[]),b.useEffect(()=>{(async()=>{try{const re=await Ac(),me=(re==null?void 0:re.output)||re||[];ie(me);const ve=t.PROD_CD||t.PROD_CD||"",et=me.some(Dt=>Dt.PROD_CD===ve);ae(et),console.log("[CompleteRemoval] LGHV :",{currentProdCd:ve,isLghv:et,prodListCount:me.length})}catch(re){console.error("[CompleteRemoval] LGHV   :",re)}})()},[t.PROD_CD]);const xe=()=>{const De=[];(!F||F.trim()==="")&&De.push(" ."),(!B||B.trim()==="")&&De.push(" ."),(!k||k==="[]")&&De.push("  ."),j!=null&&j.NET_CL||De.push("  ."),j!=null&&j.WRNG_TP||De.push("  ."),j!=null&&j.INSTL_TP||De.push("  ."),Ne||De.push(" .");const re=t.PROD_GRP||"",me=(C==null?void 0:C.removedEquipments)||[];return re!=="V"&&me.length<1&&De.push("  .   ."),De},fe=De=>{te(De),De.NET_CL&&H(De.NET_CL),De.NET_CL_NM&&K(De.NET_CL_NM),r==null||r("  .","success")},Z=()=>{var Dt,ot;if(S)return;if(((C==null?void 0:C.removedEquipments)||[]).some(At=>{var ct;return At.PROD_CMPS_CL==="23"||((ct=At.actualEquipment)==null?void 0:ct.PROD_CMPS_CL)==="23"})){r==null||r("      .  .","error");return}const me=xe();if(me.length>0){me.forEach(At=>r==null?void 0:r(At,"error"));return}const ve=t.TERM_HOPE_DT||t.HOPE_DT||"";if(ve&&Ne){const At=ve.replace(/-/g,"");Ne.replace(/-/g,"")<At&&(r==null||r("  .","warning"))}const et=((Dt=C==null?void 0:C.removedEquipments)==null?void 0:Dt.length)>0||((ot=C==null?void 0:C.installedEquipments)==null?void 0:ot.length)>0?` ?
(      .)`:" ?";U(et),R(!0)},le=async()=>{var xt,mt,Ve,it,Fe,nt,lt,Mt;console.log("[WorkCompleteRemoval]   ");const De=Ne.replace(/-/g,""),re=localStorage.getItem("userInfo"),me=re?JSON.parse(re):{},ve=me.userId||"A20130708",et=t.WRK_DTL_TCD||"";if(et==="0910"||et==="0920"){const ut=et==="0910"?"SMR06":"SMR08";try{const qe=t.PROD_GRP||"",Ee=t.VOIP_PROD_CD||"",Ye=qe==="V"&&Ee&&t.CTRT_ID||"";let pe=t.PROD_CD||"",ge="";try{const ue=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"09"}),we=ue.find(Nt=>Nt.PROD_CMPS_CL==="11");we&&(pe=we.PROD_CD||pe);const Je=et==="0910"?"10":"80",Pe=ue.filter(Nt=>Nt.BASIC_PROD_FL==="V"&&Nt.PROD_STAT_CD===Je).map(Nt=>Nt.PROD_CD);Pe.length>0&&(ge=Pe.join(","))}catch(ue){console.log("[CompleteRemoval] getProdPromotionInfo for buga signal failed:",ue)}console.log(`[CompleteRemoval]  (${ut}) :`,{wrkDtlTcd:et,bugaProdCd:pe,subProdCd:ge,voipJoinCtrtId:Ye});const Be=await _a({MSG_ID:ut,CUST_ID:((xt=t.customer)==null?void 0:xt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:"",PROD_CD:pe,WRK_ID:t.id||"",REG_UID:ve,SUB_PROD_CD:ge,VOIP_JOIN_CTRT_ID:Ye,WTIME:"99"});Be.code!=="SUCCESS"&&Be.code!=="OK"?console.log(`[CompleteRemoval]  (${ut})   ():`,Be.message):console.log(`[CompleteRemoval]  (${ut})  `)}catch(qe){console.log("[CompleteRemoval]      (  ):",qe)}}const Dt=(C==null?void 0:C.removedEquipments)||[];let ot=!1,At=!1;if(Dt.length>0){for(const ut of Dt){const qe=ut.actualEquipment||ut,Ee=qe.eqtClCd||qe.EQT_CL_CD||"";Ee==="090901"||Ee==="091001"||Ee==="091005"||(ot=!0)}if(ot)try{const ut=Dt[0],qe=ut.actualEquipment||ut,Ee=qe.PROD_CMPS_ID||ut.PROD_CMPS_ID||qe.EQT_PROD_CMPS_ID||ut.EQT_PROD_CMPS_ID||"",Ye=t.PROD_GRP||"",pe=t.VOIP_PROD_CD||"",ge=Ye==="V"&&pe&&t.CTRT_ID||"";console.log("[CompleteRemoval]  (SMR05) :",{eqtProdCmpsId:Ee,voipJoinCtrtId:ge});const Be=await _a({MSG_ID:"SMR05",CUST_ID:((mt=t.customer)==null?void 0:mt.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:Ee,PROD_CD:"",WRK_ID:t.id||"",REG_UID:ve,VOIP_JOIN_CTRT_ID:ge,WTIME:"3"});if(Be.code!=="SUCCESS"&&Be.code!=="OK"){if((((Ve=Be.O_IFSVC_RESULT)==null?void 0:Ve.substring(14,20))||"")!=="029"&&((it=Be.message)==null?void 0:it.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteRemoval]    -  :",Be.message),r==null||r("   .","error",!0);return}}else console.log("[CompleteRemoval]  (SMR05)  ");At=!0}catch(ut){console.error("[CompleteRemoval]     :",ut),r==null||r("   .","error",!0);return}}if(!ot){const ut=(C==null?void 0:C.customerEquipments)||[],qe=(C==null?void 0:C.installedEquipments)||[],Ee=!!t.ISP_PROD_CD;if(ut.length>0||qe.length>0||Ee)try{const Ye=t.PROD_GRP||"",pe=t.VOIP_PROD_CD||"",ge=Ye==="V"&&pe&&t.CTRT_ID||"";console.log("[CompleteRemoval]  (SMR05) fallback - del_signal_flag=false, eqt/ISP exists");const Be=await _a({MSG_ID:"SMR05",CUST_ID:((Fe=t.customer)==null?void 0:Fe.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:"",EQT_PROD_CMPS_ID:"",PROD_CD:"",WRK_ID:t.id||"",REG_UID:ve,VOIP_JOIN_CTRT_ID:ge,WTIME:"3"});if(Be.code!=="SUCCESS"&&Be.code!=="OK"){if((((nt=Be.O_IFSVC_RESULT)==null?void 0:nt.substring(14,20))||"")!=="029"&&((lt=Be.message)==null?void 0:lt.indexOf("PROC_VOIP_KCT-029"))===-1){console.warn("[CompleteRemoval]   fallback  -  :",Be.message),r==null||r("   .","error",!0);return}}else console.log("[CompleteRemoval]  (SMR05) fallback ");At=!0}catch(Ye){console.error("[CompleteRemoval]   fallback :",Ye),r==null||r("   .","error",!0);return}}const ct=(ut,qe=!1)=>{if(!ut||ut.length===0)return[];const Ee=(C==null?void 0:C.removalStatus)||{},Ye=(pe,ge)=>pe==="1"||pe==="Y"||ge==="1"||ge==="Y"?"1":"0";return ut.map(pe=>{var we,Je,Pe,Nt;const ge=pe.EQT_NO||pe.id||((we=pe.actualEquipment)==null?void 0:we.id)||"",Be=Ee[ge]||Ee[pe.id]||Ee[pe.EQT_NO]||Ee[(Je=pe.actualEquipment)==null?void 0:Je.id]||Ee[pe.serialNumber]||{},ue=qe?{CRR_TSK_CL:t.WRK_CD||"09",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||me.crrId||"01",WRKR_ID:ve,EQT_LOSS_YN:Ye(pe.EQT_LOSS_YN,Be.EQT_LOSS_YN),PART_LOSS_BRK_YN:Ye(pe.PART_LOSS_BRK_YN,Be.PART_LOSS_BRK_YN),EQT_BRK_YN:Ye(pe.EQT_BRK_YN,Be.EQT_BRK_YN),EQT_CABL_LOSS_YN:Ye(pe.EQT_CABL_LOSS_YN,Be.EQT_CABL_LOSS_YN),EQT_CRDL_LOSS_YN:Ye(pe.EQT_CRDL_LOSS_YN,Be.EQT_CRDL_LOSS_YN),REUSE_YN:pe.REUSE_YN==="1"||Be.REUSE_YN==="1"?"1":"0"}:{};if(pe.actualEquipment){const Oe=pe.actualEquipment,dt=pe.contractEquipment||{};return{...Oe,EQT_NO:Oe.id,EQT_SERNO:Oe.serialNumber,ITEM_MID_CD:Oe.itemMidCd,EQT_CL_CD:Oe.eqtClCd,MAC_ADDRESS:pe.macAddress||Oe.macAddress,WRK_ID:t.id,CUST_ID:(Pe=t.customer)==null?void 0:Pe.id,CTRT_ID:t.CTRT_ID,WRK_CD:t.WRK_CD,SVC_CMPS_ID:dt.id||dt.SVC_CMPS_ID||Oe.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Oe.BASIC_PROD_CMPS_ID||dt.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:Oe.EQT_PROD_CMPS_ID||dt.id,PROD_CD:Oe.PROD_CD||dt.PROD_CD||t.PROD_CD||"",SVC_CD:Oe.SVC_CD||dt.SVC_CD||"",EQT_SALE_AMT:Oe.EQT_SALE_AMT||"0",MST_SO_ID:Oe.MST_SO_ID||t.SO_ID||"",SO_ID:Oe.SO_ID||t.SO_ID||"",REG_UID:ve,OLD_LENT_YN:Oe.OLD_LENT_YN||"N",LENT:Oe.LENT||"10",ITLLMT_PRD:Oe.ITLLMT_PRD||"00",EQT_USE_STAT_CD:Oe.EQT_USE_STAT_CD||"1",EQT_CHG_GB:"1",IF_DTL_ID:Oe.IF_DTL_ID||"",...ue}}return{...pe,EQT_NO:pe.EQT_NO||pe.id||"",EQT_SERNO:pe.EQT_SERNO||pe.serialNumber||"",ITEM_MID_CD:pe.ITEM_MID_CD||pe.itemMidCd||"",EQT_CL_CD:pe.EQT_CL_CD||pe.eqtClCd||"",MAC_ADDRESS:pe.MAC_ADDRESS||pe.macAddress||"",SVC_CMPS_ID:pe.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:pe.BASIC_PROD_CMPS_ID||"",PROD_CD:pe.PROD_CD||"",SVC_CD:pe.SVC_CD||"",WRK_ID:pe.WRK_ID||t.id,CUST_ID:pe.CUST_ID||((Nt=t.customer)==null?void 0:Nt.id),CTRT_ID:pe.CTRT_ID||t.CTRT_ID,WRK_CD:pe.WRK_CD||t.WRK_CD,REG_UID:ve,...ue}})},Ge={workInfo:{WRK_ID:t.id,WRK_CD:t.WRK_CD,WRK_DTL_TCD:t.WRK_DTL_TCD,CUST_ID:(Mt=t.customer)==null?void 0:Mt.id,CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID,CRR_ID:t.CRR_ID||me.crrId||"01",WRKR_ID:ve,WRKR_CMPL_DT:De,MEMO:M||" ",STTL_YN:"Y",REG_UID:ve,CUST_REL:k,CNFM_CUST_NM:F,CNFM_CUST_TELNO:B,REUSE_YN:E?"Y":"N",INSTL_LOC:t.INSTL_LOC||t.installLocation||"",UP_CTRL_CL:"",PSN_USE_CORP:"",VOIP_USE_CORP:"",DTV_USE_CORP:"",WRK_ACT_CL:"20",NET_CL:(j==null?void 0:j.NET_CL)||"",WRNG_TP:(j==null?void 0:j.WRNG_TP)||"",INSTL_TP:(j==null?void 0:j.INSTL_TP)||"",CB_WRNG_TP:(j==null?void 0:j.CB_WRNG_TP)||"",CB_INSTL_TP:(j==null?void 0:j.CB_INSTL_TP)||"",INOUT_LINE_TP:(j==null?void 0:j.INOUT_LINE_TP)||"",INOUT_LEN:(j==null?void 0:j.INOUT_LEN)||"",DVDR_YN:(j==null?void 0:j.DVDR_YN)||"",BFR_LINE_YN:(j==null?void 0:j.BFR_LINE_YN)||"",CUT_YN:(j==null?void 0:j.CUT_YN)||"",TERM_NO:(j==null?void 0:j.TERM_NO)||"",RCV_STS:(j==null?void 0:j.RCV_STS)||"",SUBTAP_ID:(j==null?void 0:j.SUBTAP_ID)||"",PORT_NUM:(j==null?void 0:j.PORT_NUM)||"",EXTN_TP:(j==null?void 0:j.EXTN_TP)||"",TAB_LBL:(j==null?void 0:j.TAB_LBL)||"",CVT_LBL:(j==null?void 0:j.CVT_LBL)||"",STB_LBL:(j==null?void 0:j.STB_LBL)||"",KPI_PROD_GRP:"",OBS_RCPT_CD:"",OBS_RCPT_DTL_CD:"",VOIP_JOIN_CTRT_ID:"",AGREE_YN:"",ISP_YN:"",AGREE_GB:"",CUST_CLEAN_YN:"",EQT_RMV_FLAG:"",TV_TYPE:""},equipmentList:ct((C==null?void 0:C.installedEquipments)||[],!1),removeEquipmentList:ct((C==null?void 0:C.removedEquipments)||[],!0),spendItemList:(C==null?void 0:C.spendItems)||[],agreementList:(C==null?void 0:C.agreements)||[],poleList:(C==null?void 0:C.poleResults)||[]},at=async()=>{var ut;try{const qe=(C==null?void 0:C.customerEquipments)||[],Ee=(C==null?void 0:C.installedEquipments)||[],Ye=[...qe,...Ee],pe=["090901","091001","091005"];let ge=!1;for(const ke of Ye){const ft=ke.actualEquipment||ke,st=ft.eqtClCd||ft.EQT_CL_CD||"";if(pe.includes(st))continue;(ft.EQT_KND||ft.eqtKnd||"WRKER")==="WRKER"&&(ge=!0)}if(!ge&&At&&(ge=!0),!ge){console.log("[CompleteRemoval] SMR03 skip - no WRKER equipment and no SMR05 sent");return}const Be=t.PROD_GRP||"",ue=t.VOIP_PROD_CD||"";let we=Be==="V"?"SMR60":"SMR03";de&&Be!=="V"&&(we="STB_CHG");let Je=[];try{Je=await Rl({CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",PROC_CL:"",WRK_CD:"09"})}catch(ke){console.log("[CompleteRemoval] getProdPromotionInfo failed:",ke)}const Pe=Je.find(ke=>ke.PROD_CMPS_CL==="23"),Nt=(Pe==null?void 0:Pe.PROD_CMPS_ID)||"",Oe=Je.find(ke=>ke.PROD_CMPS_CL==="11"),dt=(Oe==null?void 0:Oe.PROD_CD)||"",gt=(Oe==null?void 0:Oe.PROD_GRP)||Be,It=Je.filter(ke=>ke.BASIC_PROD_FL==="V").map(ke=>ke.PROD_CD),$e=It.length>0?It.join(","):"",$t=ke=>{var st,Ft;const ft=Ye.find(_t=>{var qt,jt;return(_t.ITEM_MID_CD||_t.itemMidCd||((qt=_t.actualEquipment)==null?void 0:qt.ITEM_MID_CD)||((jt=_t.actualEquipment)==null?void 0:jt.itemMidCd))===ke});return(ft==null?void 0:ft.EQT_NO)||(ft==null?void 0:ft.id)||((st=ft==null?void 0:ft.actualEquipment)==null?void 0:st.EQT_NO)||((Ft=ft==null?void 0:ft.actualEquipment)==null?void 0:Ft.id)||""};let Ue="";ue?Ue=$t("08"):Ue=$t("05")||$t("01")||$t("03")||(gt==="I"?$t("02"):"")||$t("08")||"";let ss="";ue?ss=$t("02"):ss=$t("04");const ls=$t("07"),ds=gt==="C"?$t("02"):"";let vs="";$t("10")&&gt==="V"&&(vs=$t("10")),t.ISP_PROD_CD&&(vs=$t("21"));let Ss="";Be==="V"&&ue&&(Ss=t.CTRT_ID||""),console.log("[CompleteRemoval] SMR03 installation signal:",{msgId:we,eqtNo:Ue,eqtProdCmpsId:Nt}),await _a({MSG_ID:we,CUST_ID:((ut=t.customer)==null?void 0:ut.id)||t.CUST_ID||"",CTRT_ID:t.CTRT_ID||"",SO_ID:t.SO_ID||"",EQT_NO:Ue,EQT_PROD_CMPS_ID:Nt,PROD_CD:dt,WRK_ID:t.id||"",REG_UID:ve,ETC_1:ss,ETC_2:ls,ETC_3:ds,ETC_4:vs,SUB_PROD_CD:$e,VOIP_JOIN_CTRT_ID:Ss,WTIME:"3"}),console.log("[CompleteRemoval] SMR03 installation signal sent")}catch(qe){console.warn("[CompleteRemoval] SMR03 installation signal error (ignored):",qe)}};y(Ge,{onSuccess:ut=>{ut.code==="SUCCESS"||ut.code==="OK"?(localStorage.removeItem(v()),t.WRK_STAT_CD="3",at(),r==null||r("  .","success"),n()):r==null||r(ut.message||"   .","error",!0)},onError:ut=>{r==null||r(ut.message||"    .","error",!0)}})};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 bg-gray-50 min-h-0 relative",children:[S&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-3 shadow-xl",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-700 font-medium",children:" ..."})]})}),s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:s.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[s.jsx("input",{type:"text",value:V||"",readOnly:!0,disabled:!0,placeholder:" ",className:"flex-1 min-w-0 min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-200 rounded-lg text-sm sm:text-base text-gray-600 cursor-not-allowed truncate"}),s.jsx("button",{type:"button",onClick:()=>ee(!0),className:`px-3 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold rounded-lg transition-colors whitespace-nowrap flex-shrink-0 ${o?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:o?"":""})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!o&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:F,onChange:De=>G(De.target.value),placeholder:" ",className:`w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base ${o?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,readOnly:o,disabled:o})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!o&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"tel",value:B,onChange:De=>I(De.target.value),placeholder:" ",className:`w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base ${o?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,readOnly:o,disabled:o})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:[" ",!o&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:k,onValueChange:L,options:q,placeholder:" ",required:!0,disabled:o})]}),Q&&!o&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("input",{type:"checkbox",id:"reuseYn",checked:E,onChange:De=>A(De.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"reuseYn",className:"text-sm font-medium text-gray-700",children:" (    )"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-900 mb-1.5 sm:mb-2",children:""}),s.jsx("textarea",{value:M,onChange:De=>P(De.target.value),placeholder:"  ...",maxLength:500,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base resize-none ${o?"bg-gray-100 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,rows:4,readOnly:o,disabled:o}),!o&&s.jsxs("p",{className:`text-xs text-right mt-1 ${M.length>=500?"text-red-500":"text-gray-400"}`,children:[M.length,"/500"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:Ne,readOnly:!0,disabled:!0,className:"w-full min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 sm:py-3 bg-gray-50 border border-gray-300 rounded-lg text-sm sm:text-base text-gray-500 cursor-not-allowed"})]}),s.jsx(aN,{custId:((be=t.customer)==null?void 0:be.id)||t.CUST_ID||"",rcptId:t.RCPT_ID||"",ctrtId:t.CTRT_ID||"",soId:t.SO_ID||"",termDt:t.TERM_DT||"",wrkCd:t.WRK_CD,showToast:r}),!o&&s.jsx("div",{className:"flex gap-1.5 sm:gap-2 pt-3 sm:pt-4 mt-3 sm:mt-4 border-t border-gray-200",children:s.jsx("button",{onClick:Z,disabled:S,className:`flex-1 min-h-12 py-3 px-4 rounded-lg font-bold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${S?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:S?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),s.jsx("span",{children:""})]})})})]})})}),s.jsx(wc,{isOpen:Y,onClose:()=>ee(!1),onSave:fe,workId:t.id,initialData:j,workType:t.WRK_CD,customerId:t.customer.id,customerName:t.customer.name,contractId:t.CTRT_ID,addrOrd:t.ADDR_ORD||"",kpiProdGrpCd:(C==null?void 0:C.kpiProdGrpCd)||(C==null?void 0:C.KPI_PROD_GRP_CD)||t.KPI_PROD_GRP_CD,prodChgGb:(C==null?void 0:C.prodChgGb)||(C==null?void 0:C.PROD_CHG_GB)||t.PROD_CHG_GB,chgKpiProdGrpCd:(C==null?void 0:C.chgKpiProdGrpCd)||(C==null?void 0:C.CHG_KPI_PROD_GRP_CD)||t.CHG_KPI_PROD_GRP_CD,prodGrp:(C==null?void 0:C.prodGrp)||(C==null?void 0:C.PROD_GRP)||t.PROD_GRP,wrkDtlTcd:t.WRK_DTL_TCD,readOnly:o}),s.jsx(Ba,{isOpen:ce,onClose:()=>R(!1),onConfirm:le,title:" ",message:O,type:"confirm",confirmText:"",cancelText:"",children:s.jsx(Td,{equipmentData:C,installInfoData:j,custRel:k,custRelOptions:q,memo:M,order:t})})]})},T6=t=>{const{order:e}=t,[n,r]=b.useState(""),[i,a]=b.useState(!1);if(b.useEffect(()=>{(async()=>{try{const h=e.DTL_CTRT_ID||e.CTRT_ID||"";if(h){console.log("[CompleteLGUInstall] LDAP subscription check:",h,"(DTL_CTRT_ID:",e.DTL_CTRT_ID,", CTRT_ID:",e.CTRT_ID,")");const m=await eN(h),_=m.exists?"":"";r(_),console.log("[CompleteLGUInstall] LDAP result:",{exists:m.exists,reason:_})}}catch(h){console.log("[CompleteLGUInstall] LDAP check failed, using default:",h),r("")}a(!0)})()},[e.CTRT_ID]),!i)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-sm text-gray-500",children:"LGU+    ..."})]})});const o={certifyMode:!0,certifyReason:n};switch(e.WRK_CD){case"06":return s.jsx(VM,{...t,...o});case"07":return s.jsx($M,{...t,...o});default:return s.jsx(JC,{...t,...o})}},M6=t=>{const{order:e}=t,n={certifyMode:!0};return e.WRK_CD==="08"?s.jsx(zM,{...t,...n}):s.jsx(KM,{...t,...n})},I6=t=>s.jsx(QM,{...t,certifyMode:!0}),j6=t=>s.jsx(YM,{...t,certifyMode:!0}),Fp=t=>{const{order:e,isCertifyProd:n}=t,r=e.WRK_CD;if(n)switch(r){case"01":case"06":case"07":return s.jsx(T6,{...t});case"02":case"08":return s.jsx(M6,{...t});case"03":return s.jsx(I6,{...t});case"05":return s.jsx(j6,{...t})}switch(r){case"01":return s.jsx(JC,{...t});case"02":return s.jsx(KM,{...t});case"03":return s.jsx(QM,{...t});case"04":return s.jsx(D6,{...t});case"05":return s.jsx(YM,{...t});case"06":return s.jsx(VM,{...t});case"07":return s.jsx($M,{...t});case"08":return s.jsx(zM,{...t});case"09":return s.jsx(R6,{...t});default:return console.warn(`[WorkCompleteRouter] Unknown WRK_CD: ${r}, using default form`),s.jsx(JC,{...t})}},O6=t=>({"01":"","02":"","03":"A/S","04":"","05":"","06":"","07":"","08":"","09":""})[t]||"",w6=()=>hd().startOf("month").format("YYYY-MM-DD"),L6=()=>hd().endOf("month").format("YYYY-MM-DD"),co=D1()(R1(t=>({isDrawerOpen:!1,activeTab:"work-receipt",currentView:"today-work",workFilters:{startDate:w6(),endDate:L6(),filter:"",workTypeFilter:""},selectedWorkItem:null,selectedWorkDirection:null,fontScale:"medium",preferredNavApp:"kakao",showMapView:!1,openDrawer:()=>t({isDrawerOpen:!0}),closeDrawer:()=>t({isDrawerOpen:!1}),setActiveTab:e=>t({activeTab:e}),setCurrentView:e=>t({currentView:e,showMapView:!1}),setShowMapView:e=>t({showMapView:e}),setWorkFilters:e=>t({workFilters:e}),setSelectedWorkItem:e=>t({selectedWorkItem:e}),setSelectedWorkDirection:e=>t({selectedWorkDirection:e}),setFontScale:e=>t({fontScale:e}),setPreferredNavApp:e=>t({preferredNavApp:e})}),{name:"dlive-ui-storage",partialize:t=>({activeTab:t.activeTab,currentView:t.currentView,fontScale:t.fontScale,preferredNavApp:t.preferredNavApp,workFilters:{workTypeFilter:t.workFilters.workTypeFilter}}),merge:(t,e)=>{var u;const n=["","","",""],r=(u=t==null?void 0:t.workFilters)==null?void 0:u.workTypeFilter,i=["small","medium","large","xlarge"],a=t==null?void 0:t.fontScale,o=["kakao","tmap","naver"],c=t==null?void 0:t.preferredNavApp;return{...e,activeTab:(t==null?void 0:t.activeTab)??e.activeTab,currentView:(t==null?void 0:t.currentView)??e.currentView,fontScale:a&&i.includes(a)?a:"medium",preferredNavApp:c&&o.includes(c)?c:"kakao",workFilters:{...e.workFilters,workTypeFilter:r&&n.includes(r)?r:""}}}})),oN=()=>/iPhone|iPad|iPod/i.test(navigator.userAgent),P6=({lat:t,lng:e,name:n})=>{const r=`kakaomap://route?ep=${t},${e}&by=car`,i=`https://map.kakao.com/link/to/${encodeURIComponent(n)},${t},${e}`;cN(r,i)},A6=({lat:t,lng:e,name:n})=>{const r=`tmap://route?goaly=${t}&goalx=${e}&goalname=${encodeURIComponent(n)}`,i=oN()?"https://apps.apple.com/kr/app/tmap/id431589174":"market://details?id=com.skt.tmap.ku";cN(r,i)},k6=({lat:t,lng:e,name:n})=>{const r=`nmap://navigation?dlat=${t}&dlng=${e}&dname=${encodeURIComponent(n)}&appname=com.dlive.cona`,i=oN()?"https://apps.apple.com/kr/app/naver-map/id311867728":"market://details?id=com.nhn.android.nmap";cN(r,i)};function cN(t,e){const n=/Android/i.test(navigator.userAgent);if(oN()||n){if(n&&t.startsWith("kakaomap://")){window.location.href=`intent://route?ep=${t.split("ep=")[1]}#Intent;scheme=kakaomap;package=net.daum.android.map;S.browser_fallback_url=${encodeURIComponent(e)};end`;return}if(n&&t.startsWith("tmap://")){window.location.href=`intent://${t.replace("tmap://","")}#Intent;scheme=tmap;package=com.skt.tmap.ku;S.browser_fallback_url=${encodeURIComponent(e)};end`;return}if(n&&t.startsWith("nmap://")){window.location.href=`intent://${t.replace("nmap://","")}#Intent;scheme=nmap;package=com.nhn.android.nmap;S.browser_fallback_url=${encodeURIComponent(e)};end`;return}window.location.href=t,setTimeout(()=>{document.hidden||(window.location.href=e)},2e3)}else window.open(e,"_blank")}const HM=(t,e)=>{switch(t){case"kakao":P6(e);break;case"tmap":A6(e);break;case"naver":k6(e);break}};let ef=null;async function dN(){if(ef)return ef;try{const e=await(await fetch("/api/common/getCommonCodeList",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({CODE_IDS:"MOMP001"})})).json(),n=Array.isArray(e)?e:e.MOMP001||e.data||[],r=n.filter(o=>o.REF_CODE==="KAKAO"&&o.COMMON_CD_NM).map(o=>o.COMMON_CD_NM),i=n.filter(o=>o.REF_CODE==="VWORLD"&&o.COMMON_CD_NM).map(o=>o.COMMON_CD_NM),a=n.filter(o=>o.REF_CODE==="NGII"&&o.COMMON_CD_NM).map(o=>o.COMMON_CD_NM);return ef={kakao:r,vworld:i,ngii:a},console.log(`[MapKeys] MOMP001   - :${r.length}, :${i.length}, NGII:${a.length}`),ef}catch(t){return console.error("[MapKeys] MOMP001  :",t),ef={kakao:[],vworld:[],ngii:[]},ef}}function Pg(t){return t.length===0?"":t[Math.floor(Math.random()*t.length)]}function U6(){return new Promise(t=>{var r,i,a;if((i=(r=window.kakao)==null?void 0:r.maps)!=null&&i.services){t(!0);return}if((a=window.kakao)!=null&&a.maps){window.kakao.maps.load(()=>t(!!window.kakao.maps.services));return}let e=0;const n=setInterval(async()=>{var o;if(e++,(o=window.kakao)!=null&&o.maps){if(clearInterval(n),window.kakao.maps.services){t(!0);return}window.kakao.maps.load(()=>t(!!window.kakao.maps.services))}else if(e>25){clearInterval(n);const c=await dN(),u=Pg(c.kakao);if(!u){t(!1);return}const h=document.createElement("script");h.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=${u}&libraries=services&autoload=false`,h.onload=()=>{var m;(m=window.kakao)!=null&&m.maps?window.kakao.maps.load(()=>t(!!window.kakao.maps.services)):t(!1)},h.onerror=()=>t(!1),document.head.appendChild(h)}},200)})}function B6(t){return new Promise(e=>{var i;const n=window.kakao;if(!((i=n==null?void 0:n.maps)!=null&&i.services)){e(null);return}const r=new n.maps.services.Geocoder;r.addressSearch(t,(a,o)=>{if(o===n.maps.services.Status.OK&&a[0])e({lat:parseFloat(a[0].y),lng:parseFloat(a[0].x)});else{const c=t.replace(/\(.*?\)/g,"").replace(/\d+[]/g,"").replace(/\s{2,}/g," ").trim();c!==t?r.addressSearch(c,(u,h)=>{h===n.maps.services.Status.OK&&u[0]?e({lat:parseFloat(u[0].y),lng:parseFloat(u[0].x)}):e(null)}):e(null)}})})}async function G6(t,e){if(!await U6())return!1;const r=await B6(t);return r?(HM(e,{lat:r.lat,lng:r.lng,name:t}),!0):!1}const W6=t=>t===""||t===""?"bg-blue-50 text-blue-700":t===""?"bg-green-50 text-green-700":t===""?"bg-red-50 text-red-700":"bg-gray-50 text-gray-700",F6=t=>{switch(t){case"D":return"bg-purple-100 text-purple-700 border-purple-200";case"I":return"bg-blue-100 text-blue-700 border-blue-200";case"V":return"bg-green-100 text-green-700 border-green-200";case"C":return"bg-orange-100 text-orange-700 border-orange-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},K6=({item:t,onSelect:e,onComplete:n,onCancel:r,index:i})=>{const[a,o]=b.useState(!1),[c,u]=b.useState(""),h=co(S=>S.preferredNavApp),m=t.WRK_STAT_CD_NM||t.status||"",_=m===""||m===""||m===gn.Pending,p=t.ADDR||t.address||"",g=t.PROD_GRP||t.KPI_PROD_GRP_CD,C=async S=>{if(S.stopPropagation(),!(!p||a)){o(!0);try{await G6(p,h)||u("   .")}catch{u("  .")}finally{o(!1)}}},y=(S,v)=>{S.stopPropagation(),v==="complete"?n(t):v==="cancel"&&r(t)};return s.jsxs("div",{onClick:()=>e(t),className:`bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow-md overflow-hidden cursor-pointer transition-all duration-200 active:scale-[0.98] ${_?"":"opacity-60"}`,style:{WebkitTapHighlightColor:"transparent"},children:[s.jsxs("div",{className:"p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i!==void 0&&s.jsx("div",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500 text-white text-xs font-bold",children:i}),s.jsx("span",{className:`flex-shrink-0 px-2 py-1 text-xs font-semibold rounded-md ${W6(m)} whitespace-nowrap`,children:m})]}),s.jsxs("div",{className:"space-y-2 mb-2",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[g&&s.jsx("span",{className:`px-1.5 py-0.5 text-[0.625rem] font-bold rounded border ${F6(g)}`,children:g}),s.jsx("span",{className:"text-xs font-medium text-gray-900 truncate",children:t.WRK_DTL_TCD_NM||t.WRK_CD_NM||t.typeDisplay||"-"})]})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2 border-t border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs font-medium text-gray-900 truncate",children:t.PROD_NM||"-"})]})]}),_&&s.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-gray-100",children:[s.jsx("button",{onClick:S=>y(S,"complete"),className:"flex-1 py-2 rounded-md bg-blue-500 hover:bg-blue-600 text-white text-xs font-semibold transition-colors",children:""}),s.jsx("button",{onClick:S=>y(S,"cancel"),className:"flex-1 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs font-semibold transition-colors",children:""}),s.jsx("button",{onClick:C,disabled:!p||a,className:`flex-shrink-0 w-10 py-2 rounded-md flex items-center justify-center transition-colors ${p?"bg-orange-500 hover:bg-orange-600 text-white shadow-sm shadow-orange-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,title:"",children:a?s.jsx(On,{className:"w-4 h-4 animate-spin"}):s.jsx(Ed,{className:"w-5 h-5",fill:"currentColor"})})]})]}),s.jsx(Ba,{isOpen:!!c,onClose:()=>u(""),onConfirm:()=>u(""),message:c,type:"warning",showCancel:!1})]})},wf=({size:t="medium",color:e="cyan",message:n,fullScreen:r=!1,className:i=""})=>{const a={small:"h-4 w-4 border-2",medium:"h-8 w-8 border-2",large:"h-12 w-12 border-3"},o={blue:"border-blue-500 border-t-transparent",cyan:"border-cyan-500 border-t-transparent",gray:"border-gray-500 border-t-transparent",white:"border-white border-t-transparent"},c={small:"text-xs",medium:"text-sm",large:"text-base"},u=s.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 sm:gap-3",children:[s.jsx("div",{className:`
          ${a[t]}
          ${o[e]}
          rounded-full animate-spin
        `}),n&&s.jsx("p",{className:`${c[t]} text-gray-600 text-center`,children:n})]});return r?s.jsx("div",{className:`fixed inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-50 ${i}`,children:u}):s.jsx("div",{className:`flex items-center justify-center p-8 ${i}`,children:u})},uN=({type:t="error",message:e,onRetry:n,onClose:r,className:i=""})=>{const o={error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",iconBg:"bg-red-100",iconColor:"text-red-500",buttonBg:"bg-red-500 hover:bg-red-600"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",iconBg:"bg-yellow-100",iconColor:"text-yellow-500",buttonBg:"bg-yellow-500 hover:bg-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",iconBg:"bg-blue-100",iconColor:"text-blue-500",buttonBg:"bg-blue-500 hover:bg-blue-600"}}[t],c=()=>{switch(t){case"error":return s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"info":return s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};return s.jsx("div",{className:`
        ${o.bg}
        ${o.border}
        border rounded-lg p-4
        ${i}
      `,children:s.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[s.jsx("div",{className:`${o.iconBg} ${o.iconColor} rounded-full p-2 flex-shrink-0`,children:c()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:`${o.text} text-sm font-medium`,children:e}),n&&s.jsxs("button",{onClick:n,className:`
                mt-3
                ${o.buttonBg}
                text-white
                px-4 py-2
                rounded-lg
                text-sm
                font-medium
                transition-colors
                duration-200
                flex
                items-center
                gap-2
              `,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})," "]})]}),r&&s.jsx("button",{onClick:r,className:`${o.text} hover:opacity-70 transition-opacity flex-shrink-0`,"aria-label":"",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},qM=({direction:t,onBack:e,onNavigateToView:n,userId:r,showToast:i})=>{var I;const[a,o]=b.useState([]),[c,u]=b.useState(null),[h,m]=b.useState(null),[_,p]=b.useState(!1),[g,C]=b.useState(null),[y,S]=b.useState(!1),[v,k]=b.useState(null),L=ta(E=>E.clearPreviousWorkDraft),M=ki(E=>E.clearAllWorkStates);b.useEffect(()=>{(async()=>{var A;try{S(!0),k(null),console.log("WorkItemList - direction  :",t),console.log("WorkItemList - direction.id:",t.id),console.log("API   - WRK_DRCTN_ID:",t.id);const ee=(await qC(t.id)).sort((J,H)=>{const V=ce=>ce===""||ce===""?1:ce===""?2:3,K=V(J.WRK_STAT_CD_NM)-V(H.WRK_STAT_CD_NM);if(K!==0)return K;const j=ce=>{const R=ce.WRK_CD,O=ce.WRK_DTL_TCD;return R==="02"||R==="08"||O==="0430"},te=ce=>{const R=ce.PROD_GRP||"";if(j(ce)){if(R==="I")return 1;if(R==="D")return 2;if(R==="V")return 3}else{if(R==="V")return 1;if(R==="D")return 2;if(R==="I")return 3}return 4};return te(J)-te(H)});if(ee.length===0){console.log("[WorkItemList]   -    WorkItem ");const J=t,H=K=>K===""?"4":K===""?"3":"2",V={id:t.id,directionId:t.id,type:t.type,typeDisplay:t.typeDisplay,status:t.status===""?"":t.status===""?"":"",scheduledAt:t.scheduledAt,customer:{...t.customer},details:t.details||"",assignedEquipment:[],WRK_CD:J.WRK_CD,WRK_CD_NM:J.WRK_CD_NM,WRK_DTL_TCD:J.WRK_DTL_TCD,WRK_STAT_CD:J.MIN_WRK_STAT_CD||J.WRK_STAT_CD||H(t.status),WRK_STAT_NM:J.WRK_STAT_NM||t.status,WRK_DRCTN_ID:t.id,CTRT_ID:J.CTRT_ID,PROD_NM:J.PROD_NM,PROD_CD:J.PROD_CD,PROD_GRP:J.PROD_GRP,PROD_GRP_NM:J.PROD_GRP_NM,productName:J.PROD_NM,SO_ID:J.SO_ID,SO_NM:J.SO_NM,MST_SO_ID:J.MST_SO_ID,CRR_ID:J.CRR_ID,CRR_NM:J.CRR_NM,CUST_ID:J.CUST_ID||((A=t.customer)==null?void 0:A.id),VIP_GB:J.VIP_GB||"",OST_WORKABLE_STAT:J.OST_WORKABLE_STAT,installLocation:J.installLocation||J.INSTL_LOC,CTRT_STAT:J.CTRT_STAT,CTRT_STAT_NM:J.CTRT_STAT_NM};ee.push(V)}o(ee),console.log("Work items loaded - :",ee.length),console.log("Work items :",ee)}catch(Y){console.error("   :",Y),Y instanceof Qs||Y instanceof Error?(k(Y.message),i&&i(Y.message,"error",!0)):(k("   ."),i&&i("   .","error",!0)),o([])}finally{S(!1)}})()},[t.id,i]);const P=E=>{var J,H,V,K,j,te,ce;console.log("  :",E),console.log("  ID:",E.WRK_ID||E.id),console.log("  :",{WRK_ID:E.WRK_ID,WRK_CD_NM:E.WRK_CD_NM,CUST_NM:E.CUST_NM,PROD_NM:E.PROD_NM});const A=E.WRK_ID||E.id;L(A),Za.getState().reset(),M(),console.log("[] REQ_CTX :",E.REQ_CTX),console.log("[] REQ_CTX JSON:",JSON.stringify(E.REQ_CTX)),console.log("[VIP ] item.VIP_GB:",E.VIP_GB,"| direction.VIP_GB:",t.VIP_GB,"| direction.customer.isVip:",(J=t.customer)==null?void 0:J.isVip);let Y=E.PROD_NM;if(E.WRK_DTL_TCD==="0520"||E.WRK_DTL_TCD==="0560"){const R=E.WRK_DTL_TCD==="0520"?"0510":"0550",O=a.find(U=>U.WRK_DTL_TCD===R&&U.PROD_GRP===E.PROD_GRP);O&&(Y=O.PROD_NM)}const ee={id:E.WRK_ID||E.id,directionId:E.WRK_DRCTN_ID||E.directionId,type:E.WRK_CD_NM==="A/S"?"A/S":"Installation",typeDisplay:E.WRK_CD_NM||E.typeDisplay||"",status:E.WRK_STAT_CD==="3"?"":E.WRK_STAT_CD==="4"||E.WRK_STAT_CD==="7"?"":E.WRK_STAT_CD==="1"||E.WRK_STAT_CD==="2"?"":E.WRK_STAT_CD_NM||E.status||"",scheduledAt:E.WRK_HOPE_DTTM?`${E.WRK_HOPE_DTTM.slice(0,4)}-${E.WRK_HOPE_DTTM.slice(4,6)}-${E.WRK_HOPE_DTTM.slice(6,8)}T${E.WRK_HOPE_DTTM.slice(8,10)}:${E.WRK_HOPE_DTTM.slice(10,12)}:00`:E.scheduledAt||new Date().toISOString(),customer:{id:E.CUST_ID||((H=E.customer)==null?void 0:H.id)||"",name:E.CUST_NM||((V=E.customer)==null?void 0:V.name)||" ",phone:E.REQ_CUST_TEL_NO||((K=E.customer)==null?void 0:K.phone),address:E.ADDR||((j=E.customer)==null?void 0:j.address)||"  ",isVip:!!(E.VIP_GB&&String(E.VIP_GB).length>0)||((te=t.customer)==null?void 0:te.isVip)||!1,vipLevel:E.VIP_GB==="VIP_VVIP"?"VVIP":E.VIP_GB?"VIP":(ce=t.customer)==null?void 0:ce.vipLevel},details:E.REQ_CTX||"",assignedEquipment:E.assignedEquipment||[],WRK_CD:E.WRK_CD,WRK_DTL_TCD:E.WRK_DTL_TCD,WRK_STAT_CD:E.WRK_STAT_CD,WRK_STAT_NM:E.WRK_STAT_CD_NM||E.WRK_STAT_NM,WRK_DRCTN_ID:E.WRK_DRCTN_ID,CTRT_ID:E.CTRT_ID,DTL_CTRT_ID:E.DTL_CTRT_ID,RCPT_ID:E.RCPT_ID,productName:E.PROD_NM,PROD_NM:E.PROD_NM,OLD_PROD_CD:E.OLD_PROD_CD,OLD_PROD_NM:E.OLD_PROD_NM,OLD_CTRT_ID:E.OLD_CTRT_ID,OLD_CTRT_STAT:E.OLD_CTRT_STAT,OLD_CTRT_STAT_NM:E.OLD_CTRT_STAT_NM,OLD_PROM_CNT:E.OLD_PROM_CNT,currentProduct:E.OLD_PROD_NM||E.OLD_PROD_CD,newProduct:Y,installLocation:E.INSTL_LOC,MST_SO_ID:E.MST_SO_ID,SO_ID:E.SO_ID,PROD_CD:E.PROD_CD,ADDR_ORD:E.ADDR_ORD,CRR_ID:E.CRR_ID,BLD_ID:E.BLD_ID,CUST_ID:E.CUST_ID,WRKR_ID:E.WRKR_ID,CTRT_STAT:E.CTRT_STAT,CTRT_STAT_NM:E.CTRT_STAT_NM,SO_NM:E.SO_NM,MSO_NM:E.MSO_NM,PYM_MTHD:E.PYM_MTHD,PYM_ACNT_ID:E.PYM_ACNT_ID,APLYMONTH:E.APLYMONTH,PROM_CNT:E.PROM_CNT,CTRT_APLY_STRT_DT:E.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:E.CTRT_APLY_END_DT,VOIP_TEL_NO:E.VOIP_TEL_NO,GRP_ID:E.GRP_ID,GRP_NM:E.GRP_NM,CRR_NM:E.CRR_NM,PROD_GRP:E.PROD_GRP,PROD_GRP_NM:E.PROD_GRP_NM,WRKR_NM:E.WRKR_NM,ACNT_PYM_MTHD:E.ACNT_PYM_MTHD,KPI_PROD_GRP_CD:E.KPI_PROD_GRP_CD,PROD_CHG_GB:E.PROD_CHG_GB,CHG_KPI_PROD_GRP_CD:E.CHG_KPI_PROD_GRP_CD,VOIP_CTX:E.VOIP_CTX,VIP_GB:E.VIP_GB||t.VIP_GB||"",IS_CERTIFY_PROD:E.IS_CERTIFY_PROD,OP_LNKD_CD:E.OP_LNKD_CD,VOIP_PROD_CD:E.VOIP_PROD_CD,ISP_PROD_CD:E.ISP_PROD_CD,WRKR_CMPL_DT:E.WRKR_CMPL_DT,WRK_END_DTTM:E.WRK_END_DTTM,NET_CL:E.NET_CL,NET_CL_NM:E.NET_CL_NM,WRNG_TP:E.WRNG_TP,WRNG_TP_NM:E.WRNG_TP_NM,INSTL_TP:E.INSTL_TP,INSTL_TP_NM:E.INSTL_TP_NM,CB_WRNG_TP:E.CB_WRNG_TP,CB_INSTL_TP:E.CB_INSTL_TP,INOUT_LINE_TP:E.INOUT_LINE_TP,INOUT_LEN:E.INOUT_LEN,DVDR_YN:E.DVDR_YN,BFR_LINE_YN:E.BFR_LINE_YN,CUT_YN:E.CUT_YN,TERM_NO:E.TERM_NO,RCV_STS:E.RCV_STS,SUBTAP_ID:E.SUBTAP_ID,PORT_NUM:E.PORT_NUM,EXTN_TP:E.EXTN_TP,TAB_LBL:E.TAB_LBL,CVT_LBL:E.CVT_LBL,STB_LBL:E.STB_LBL,CUST_REL:E.CUST_REL,UP_CTRL_CL:E.UP_CTRL_CL,PSN_USE_CORP:E.PSN_USE_CORP,VOIP_USE_CORP:E.VOIP_USE_CORP,DTV_USE_CORP:E.DTV_USE_CORP,VIEW_MOD_CD:E.VIEW_MOD_CD,VIEW_MOD_NM:E.VIEW_MOD_NM,MEMO:E.MEMO,TERM_HOPE_DT:E.TERM_HOPE_DT,HOPE_DT:E.HOPE_DT,asReasonCode:E.WRK_RCPT_CL,asDetailCode:E.WRK_RCPT_CL_DTL,OST_WORKABLE_STAT:E.OST_WORKABLE_STAT,WRK_HOPE_DTTM:E.WRK_HOPE_DTTM};console.log("[WorkItemList] handleSelectItem - OST_WORKABLE_STAT:",E.OST_WORKABLE_STAT,"| WRK_CD:",E.WRK_CD),console.log("  :",ee),n?n("work-process-flow",ee):u(ee)},F=E=>{var J,H,V,K,j,te;console.log("   -  :",E);const A=E.WRK_ID||E.id;L(A),Za.getState().reset();let Y=E.PROD_NM;if(E.WRK_DTL_TCD==="0520"||E.WRK_DTL_TCD==="0560"){const ce=E.WRK_DTL_TCD==="0520"?"0510":"0550",R=a.find(O=>O.WRK_DTL_TCD===ce&&O.PROD_GRP===E.PROD_GRP);R&&(Y=R.PROD_NM)}const ee={id:E.WRK_ID||E.id,directionId:E.WRK_DRCTN_ID||E.directionId,type:E.WRK_CD_NM==="A/S"?"A/S":"Installation",typeDisplay:E.WRK_CD_NM||E.typeDisplay||"",status:E.WRK_STAT_CD==="3"?"":E.WRK_STAT_CD==="4"||E.WRK_STAT_CD==="7"?"":E.WRK_STAT_CD==="1"||E.WRK_STAT_CD==="2"?"":E.WRK_STAT_CD_NM||E.status||"",scheduledAt:E.WRK_HOPE_DTTM?`${E.WRK_HOPE_DTTM.slice(0,4)}-${E.WRK_HOPE_DTTM.slice(4,6)}-${E.WRK_HOPE_DTTM.slice(6,8)}T${E.WRK_HOPE_DTTM.slice(8,10)}:${E.WRK_HOPE_DTTM.slice(10,12)}:00`:E.scheduledAt||new Date().toISOString(),customer:{id:E.CUST_ID||((J=E.customer)==null?void 0:J.id)||"",name:E.CUST_NM||((H=E.customer)==null?void 0:H.name)||" ",phone:E.REQ_CUST_TEL_NO||((V=E.customer)==null?void 0:V.phone),address:E.ADDR||((K=E.customer)==null?void 0:K.address)||"  ",isVip:!!(E.VIP_GB&&String(E.VIP_GB).length>0)||((j=t.customer)==null?void 0:j.isVip)||!1,vipLevel:E.VIP_GB==="VIP_VVIP"?"VVIP":E.VIP_GB?"VIP":(te=t.customer)==null?void 0:te.vipLevel},details:E.REQ_CTX||"",assignedEquipment:E.assignedEquipment||[],WRK_CD:E.WRK_CD,WRK_DTL_TCD:E.WRK_DTL_TCD,WRK_STAT_CD:E.WRK_STAT_CD,WRK_STAT_NM:E.WRK_STAT_CD_NM||E.WRK_STAT_NM,WRK_DRCTN_ID:E.WRK_DRCTN_ID,CTRT_ID:E.CTRT_ID,DTL_CTRT_ID:E.DTL_CTRT_ID,RCPT_ID:E.RCPT_ID,productName:E.PROD_NM,PROD_NM:E.PROD_NM,OLD_PROD_CD:E.OLD_PROD_CD,OLD_PROD_NM:E.OLD_PROD_NM,OLD_CTRT_ID:E.OLD_CTRT_ID,OLD_CTRT_STAT:E.OLD_CTRT_STAT,OLD_CTRT_STAT_NM:E.OLD_CTRT_STAT_NM,OLD_PROM_CNT:E.OLD_PROM_CNT,currentProduct:E.OLD_PROD_NM||E.OLD_PROD_CD,newProduct:Y,installLocation:E.INSTL_LOC,MST_SO_ID:E.MST_SO_ID,SO_ID:E.SO_ID,PROD_CD:E.PROD_CD,ADDR_ORD:E.ADDR_ORD,CRR_ID:E.CRR_ID,BLD_ID:E.BLD_ID,CUST_ID:E.CUST_ID,WRKR_ID:E.WRKR_ID,CTRT_STAT:E.CTRT_STAT,CTRT_STAT_NM:E.CTRT_STAT_NM,SO_NM:E.SO_NM,MSO_NM:E.MSO_NM,PYM_MTHD:E.PYM_MTHD,PYM_ACNT_ID:E.PYM_ACNT_ID,APLYMONTH:E.APLYMONTH,PROM_CNT:E.PROM_CNT,CTRT_APLY_STRT_DT:E.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:E.CTRT_APLY_END_DT,VOIP_TEL_NO:E.VOIP_TEL_NO,GRP_ID:E.GRP_ID,GRP_NM:E.GRP_NM,CRR_NM:E.CRR_NM,PROD_GRP:E.PROD_GRP,PROD_GRP_NM:E.PROD_GRP_NM,WRKR_NM:E.WRKR_NM,ACNT_PYM_MTHD:E.ACNT_PYM_MTHD,KPI_PROD_GRP_CD:E.KPI_PROD_GRP_CD,PROD_CHG_GB:E.PROD_CHG_GB,CHG_KPI_PROD_GRP_CD:E.CHG_KPI_PROD_GRP_CD,VOIP_CTX:E.VOIP_CTX,VIP_GB:E.VIP_GB||t.VIP_GB||"",IS_CERTIFY_PROD:E.IS_CERTIFY_PROD,OP_LNKD_CD:E.OP_LNKD_CD,VOIP_PROD_CD:E.VOIP_PROD_CD,ISP_PROD_CD:E.ISP_PROD_CD,WRKR_CMPL_DT:E.WRKR_CMPL_DT,WRK_END_DTTM:E.WRK_END_DTTM,NET_CL:E.NET_CL,NET_CL_NM:E.NET_CL_NM,WRNG_TP:E.WRNG_TP,WRNG_TP_NM:E.WRNG_TP_NM,INSTL_TP:E.INSTL_TP,INSTL_TP_NM:E.INSTL_TP_NM,CB_WRNG_TP:E.CB_WRNG_TP,CB_INSTL_TP:E.CB_INSTL_TP,INOUT_LINE_TP:E.INOUT_LINE_TP,INOUT_LEN:E.INOUT_LEN,DVDR_YN:E.DVDR_YN,BFR_LINE_YN:E.BFR_LINE_YN,CUT_YN:E.CUT_YN,TERM_NO:E.TERM_NO,RCV_STS:E.RCV_STS,SUBTAP_ID:E.SUBTAP_ID,PORT_NUM:E.PORT_NUM,EXTN_TP:E.EXTN_TP,TAB_LBL:E.TAB_LBL,CVT_LBL:E.CVT_LBL,STB_LBL:E.STB_LBL,CUST_REL:E.CUST_REL,UP_CTRL_CL:E.UP_CTRL_CL,PSN_USE_CORP:E.PSN_USE_CORP,VOIP_USE_CORP:E.VOIP_USE_CORP,DTV_USE_CORP:E.DTV_USE_CORP,VIEW_MOD_CD:E.VIEW_MOD_CD,VIEW_MOD_NM:E.VIEW_MOD_NM,MEMO:E.MEMO,TERM_HOPE_DT:E.TERM_HOPE_DT,HOPE_DT:E.HOPE_DT,asReasonCode:E.WRK_RCPT_CL,asDetailCode:E.WRK_RCPT_CL_DTL,OST_WORKABLE_STAT:E.OST_WORKABLE_STAT,WRK_HOPE_DTTM:E.WRK_HOPE_DTTM};console.log("[WorkItemList] handleCompleteWork - OST_WORKABLE_STAT:",E.OST_WORKABLE_STAT,"| WRK_CD:",E.WRK_CD),console.log(" -   :",ee),n?n("work-process-flow",ee):u(ee)},G=E=>{var Y,ee;if(console.log("   -  :",E),E.WRK_CD==="08"&&a.find(H=>H.WRK_CD==="07"&&H.CTRT_ID===E.CTRT_ID&&(H.WRK_STAT_CD==="4"||H.WRK_STAT_CD==="7"))){i&&i("      .","error");return}const A={id:E.WRK_ID||E.id,directionId:E.WRK_DRCTN_ID||E.directionId,type:E.WRK_CD_NM==="A/S"?"A/S":"Installation",typeDisplay:E.WRK_CD_NM||E.typeDisplay||"",status:E.WRK_STAT_CD==="3"?"":E.WRK_STAT_CD==="4"||E.WRK_STAT_CD==="7"?"":E.WRK_STAT_CD==="1"||E.WRK_STAT_CD==="2"?"":E.WRK_STAT_CD_NM||"",scheduledAt:E.WRK_HOPE_DTTM?`${E.WRK_HOPE_DTTM.slice(0,4)}-${E.WRK_HOPE_DTTM.slice(4,6)}-${E.WRK_HOPE_DTTM.slice(6,8)}T${E.WRK_HOPE_DTTM.slice(8,10)}:${E.WRK_HOPE_DTTM.slice(10,12)}:00`:new Date().toISOString(),customer:{id:E.CUST_ID||"",name:E.CUST_NM||" ",phone:E.REQ_CUST_TEL_NO,address:E.ADDR||"  ",isVip:!!(E.VIP_GB&&String(E.VIP_GB).length>0)||((Y=t.customer)==null?void 0:Y.isVip)||!1,vipLevel:E.VIP_GB==="VIP_VVIP"?"VVIP":E.VIP_GB?"VIP":(ee=t.customer)==null?void 0:ee.vipLevel},details:E.REQ_CTX||"",assignedEquipment:[],WRK_CD:E.WRK_CD,CTRT_ID:E.CTRT_ID,WRK_STAT_CD:E.WRK_STAT_CD,RCPT_ID:E.RCPT_ID,SO_ID:E.SO_ID};console.log(" -  :",A),C(A),p(!0)},B=async E=>{if(g){console.log("  - cancelData:",E),console.log("  - cancelTarget:",g),S(!0),p(!1);try{console.log(" API  -  :",E);const A=await tN(E);if(console.log("  API :",A),A.code==="SUCCESS"||A.code==="OK"){i&&i("  .","success");const ee=(await qC(t.id)).sort((J,H)=>{const V=K=>K===""||K===""?1:K===""?2:3;return V(J.WRK_STAT_CD_NM)-V(H.WRK_STAT_CD_NM)});o(ee)}else i&&i(` : ${A.message}`,"error",!0)}catch(A){console.error(" :",A);const Y=A instanceof Qs?A.message:A.message||"   .";i&&i(Y,"error",!0)}finally{S(!1),C(null)}}};return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsxs("div",{className:"flex-shrink-0 bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-3 shadow-md z-40",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsxs("h1",{className:"text-base font-bold text-white truncate",children:[((I=a[0])==null?void 0:I.CUST_NM)||t.customer.name,t.customer.id&&s.jsxs("span",{className:"font-normal ml-1",children:["(",t.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-white/20 text-white border border-white/30 flex-shrink-0",children:t.typeDisplay})]}),s.jsxs("div",{className:"flex items-center gap-2 text-white/90 flex-shrink-0",children:[s.jsx(Z2,{customer:t.customer}),s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-3.5 h-3.5",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),s.jsx("span",{className:"text-xs font-medium",children:Up(t.scheduledAt)})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[s.jsxs("svg",{className:"w-3.5 h-3.5 text-white/70 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-xs text-white/80 truncate",children:t.customer.address})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:y?s.jsx(wf,{size:"medium",message:"   ..."}):v?s.jsx(uN,{type:"error",message:v,onRetry:()=>window.location.reload()}):a.length===0?s.jsxs("div",{className:"text-center py-10 sm:py-12 px-4 sm:px-6 bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(C1,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2 whitespace-nowrap",children:"  "})]}):s.jsx("div",{className:"space-y-3 pb-4",children:a.map((E,A)=>s.jsx(K6,{item:E,index:A+1,onSelect:P,onComplete:F,onCancel:G},E.WRK_ID||E.id||A))})}),g&&s.jsx(rN,{isOpen:_,onClose:()=>p(!1),onConfirm:B,workOrder:g,userId:r,showToast:i})]})},XM=({isOpen:t,onClose:e,smsData:n,userId:r})=>{const[i,a]=b.useState(""),[o,c]=b.useState([]),[u,h]=b.useState(""),[m,_]=b.useState(""),[p,g]=b.useState("020"),[C,y]=b.useState(""),[S,v]=b.useState(!1),[k,L]=b.useState(!1),[M,P]=b.useState(null),F=b.useMemo(()=>{let K=0;for(let j=0;j<C.length;j++){const te=C.charCodeAt(j);K+=te>127?2:1}return K},[C]),G=2e3,B=F>G,I=b.useMemo(()=>((n==null?void 0:n.WRK_CD)||"")==="03"?Nb:Nb.filter(j=>j.refCode==="WK"),[n==null?void 0:n.WRK_CD]),E=K=>K.replace(/[-\s\(\)]/g,""),A=K=>{const j=E(K);return j.length>=9&&/^\d+$/.test(j)},Y=K=>{if(!K)return"";const j=K.split(/\s*\[[A-Z]\]|\s*[,\/]\s*/);for(const te of j){const ce=te.trim();if(A(ce))return ce}return K.trim()};b.useEffect(()=>{t&&n&&(async()=>{var O;L(!0),P(null);const j=[],te=new Set,ce=(U,Q)=>{if(!Q)return;const q=Y(Q);if(!q||!A(q))return;const $=E(q);te.has($)||(te.add($),j.push({type:U,number:q}))};if(n.CUST_ID)try{const U=await TM({CUST_ID:n.CUST_ID}),Q=U.currentContract||((O=U.contracts)==null?void 0:O[0]);Q&&(ce("",n.WORK_REQ_TEL_NO||Q.WORK_REQ_TEL_NO),ce("",n.REQ_CUST_TEL_NO||Q.REQ_CUST_TEL_NO),ce("",Q.TEL_NO2||n.CUST_TEL_NO2),ce("",Q.TEL_NO1||n.CUST_TEL_NO1))}catch(U){console.error("[SMS] Failed to get phone from contract:",U)}n.SMS_RCV_TEL&&j.length===0&&ce("",n.SMS_RCV_TEL),c(j),j.length>0?(h(j[0].type),a(j[0].number)):(h(""),a(""));let R=n.SMS_SEND_TEL||"";if(!R)try{const U=localStorage.getItem("userInfo");U&&(R=JSON.parse(U).telNo2||"")}catch(U){console.error("[SMS] Failed to get telNo2 from userInfo:",U)}_(R),g("020"),J("020",n),L(!1)})()},[t,n]);const ee=K=>K?K.includes(" ")&&K.length>=16?{hour:K.substring(11,13),minute:K.substring(14,16)}:K.includes("T")&&K.length>=16?{hour:K.substring(11,13),minute:K.substring(14,16)}:K.length>=12&&!K.includes("-")?{hour:K.substring(8,10),minute:K.substring(10,12)}:{hour:"",minute:""}:{hour:"",minute:""},J=(K,j)=>{if(!j)return;const te=j.SO_ID==="328"?"[]":"[]",ce=j.WRK_HOPE_DTTM||"",{hour:R,minute:O}=ee(ce),U=j.WRKR_NM_EN||j.WRKR_NM||"",Q=j.WRK_CD_NM||"",q=j.SMS_SEND_TEL||"";let $="";if(K==="020"){const ae=["100","600","327","210"].includes(j.SO_ID)&&j.SO_ID!=="201";$=`${te} 

`,$+=`!   ''.
`,$+=`     CS  .

`,$+=` : ${Q}
`,ae?$+=` : ${R} ${O}
`:$+=` : ${R}
`,$+=`* CS    .
`,$+=` : ${U} CS ${q}

`,$+=`[]
`,$+=`*           .
`,$+=`* CS         .
`,$+=`* CS   .   .
`}else if(K==="021")$=`${te}      .`;else if(K==="027")$=`${te}  ${U}    .()`;else if(K==="028")$=`${te}  ${U}    ${Q}   .`;else if(K==="138")$=`${te} .   .`;else if(K==="139"){const de=q.replace(/-/g,"").replace(/ /g,"");$=`${te}AS    . :${de}`}else if(K==="141")$=`${te}   

`,$+=`    .

`,$+="        ,   ",$+="     .  URL  ",$+=`   .

`,$+="            . .";else if(K==="059_002")$=`${te} KB  

`,$+=`1. 
`,$+=`https://m.dlive.kr/mobile/event/JoinAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`https://m.kbcard.com/CXHIACRC0002.cms?mainCC=b&allianceCode=04345&solicitorcode=702${r}
`;else if(K==="059"){const de=(j.CUST_ID||"").slice(-5);$=`${te}     

`,$+=`1. 
`,$+=`https://m.dlive.kr/mobile/event/JoinAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`https://m.hanacard.co.kr/MPACMM101M.web?_frame=no&CD_PD_SEQ=17176&eno=${r}&${de}`}else if(K==="235")$=`${te}    

`,$+=`1. 
`,$+=`https://m.dlive.kr/mobile/event/JoinAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`https://m.hanacard.co.kr/MPACMM101M.web?_frame=no&CD_PD_SEQ=18122&eno=${r}

`,$+=" 1800-0170";else if(K==="059_005"){const de=j.CUST_ID||"";$=`${te}  LOCA X Special SE   

`,$+=`1. 
`,$+=`https://m.dlive.kr/front/join/join/DiscountAction.do?method=view
`,$+=`2.   ,  URL    . (     )
`,$+=`3.     (1644-1100)      .
`,$+=`4.      .    !

`,$+=`<   >
`,$+=`http://m.lottecard.co.kr/spa/card/booth?bId=96893&vtCdKndC=P13791-A13791&cInfo=${de}${r}
`}else K==="271"&&($="[]  1644-1100 . .");y($)},H=async()=>{if(!n){P("SMS data missing");return}if(!A(i)){P("   . (010, 011 )");return}if(!m.trim()){P(" .");return}if(!C.trim()){P("  .");return}v(!0),P(null);try{const K=Nb.find(ce=>ce.code===p),j={SMS_EML_TYPE:p.substring(0,3),SO_ID:n.SO_ID,USER_SMS:i,SEND_SMS:m,USER_ID:n.CUST_ID,USER_NAME:n.CUST_NM,MAP01:C,KKO_MSG_ID:(K==null?void 0:K.kkoMsgId)||"KKO020_003",REG_UID:r,TRANS_YN:"N",SMS_EML_CL:"20"},te=await EA(j);te.code==="SUCCESS"?(alert("  ."),e()):P(te.message||"  .")}catch(K){console.error("[SMS] Send error:",K),P(K.message||"    .")}finally{v(!1)}},V=s.jsxs("div",{className:"flex gap-2 w-full",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors",disabled:S,children:""}),s.jsx("button",{onClick:H,disabled:S||B,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:S?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(X2,{size:16}),""]})})]});return s.jsx(Ra,{isOpen:t,onClose:e,title:"",size:"medium",footer:k?void 0:V,children:k?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-4 text-gray-500 text-sm",children:"  ..."})]}):s.jsxs("div",{className:"space-y-4",children:[M&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:M}),n&&s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"font-medium",children:n.CUST_NM})]}),n.WRK_CD_NM&&s.jsxs("div",{className:"flex justify-between mt-1",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"font-medium",children:n.WRK_CD_NM})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),o.length>1?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-24 flex-shrink-0",children:s.jsx(sn,{value:u,onValueChange:K=>{h(K);const j=o.find(te=>te.type===K);j&&a(j.number)},options:o.map(K=>({value:K.type,label:K.type})),placeholder:""})}),s.jsx("input",{type:"tel",value:i,onChange:K=>a(K.target.value),className:"flex-1 px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"})]}):s.jsx("input",{type:"tel",value:i,onChange:K=>a(K.target.value),placeholder:"010-1234-5678",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{type:"tel",value:m,onChange:K=>_(K.target.value),placeholder:"010-1234-5678",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx(sn,{value:p,onValueChange:K=>{g(K),n&&J(K,n),["059_002","059","235","059_005","271"].includes(K)&&_("1644-1100")},options:I.map(K=>({value:K.code,label:K.name})),placeholder:"  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("textarea",{value:C,onChange:K=>y(K.target.value),rows:8,className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none",placeholder:"  "}),s.jsxs("div",{className:`mt-1 text-right text-sm ${B?"text-red-600 font-medium":"text-gray-500"}`,children:[F," / ",G," bytes",B&&" ()"]})]})]})})},Q6=Array.from({length:13},(t,e)=>{const n=(e+9).toString().padStart(2,"0");return{value:n,label:`${n}`}}),Y6=Array.from({length:6},(t,e)=>{const n=(e*10).toString().padStart(2,"0");return{value:n,label:`${n}`}}),Mb=t=>{if(!t)return"-";const e=t.replace(/\D/g,"");return e.length>=10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:e.length>=6?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6)}`:t},JM=({isOpen:t,onClose:e,direction:n,onSuccess:r,showToast:i,userInfo:a})=>{const[o,c]=b.useState(""),[u,h]=b.useState(null),[m,_]=b.useState([]),[p,g]=b.useState(!1),[C,y]=b.useState(!1),[S,v]=b.useState(!1),[k,L]=b.useState(""),[M,P]=b.useState(""),[F,G]=b.useState(""),[B,I]=b.useState(""),[E,A]=b.useState([]),[Y,ee]=b.useState(""),[J,H]=b.useState(""),[V,K]=b.useState(""),[j,te]=b.useState(""),[ce,R]=b.useState(""),[O,U]=b.useState(!0),Q=b.useRef(null),q=b.useRef(null),$=b.useRef(null);b.useEffect(()=>{if(t){const se=n.WRK_HOPE_DTTM||"",Re=n.scheduledAt||"";let be=new Date().toISOString().split("T")[0],De="",re="";if(se&&se.length>=8)be=`${se.substring(0,4)}-${se.substring(4,6)}-${se.substring(6,8)}`,se.length>=12&&(De=se.substring(8,10),re=se.substring(10,12));else if(Re){const me=new Date(Re);isNaN(me.getTime())||(be=me.toISOString().split("T")[0],De=String(me.getHours()).padStart(2,"0"),re=String(me.getMinutes()).padStart(2,"0"))}L(be),P(De),G(re),ee(be),H(De),K(re),c(""),h(null),_([]),I(""),te(""),R(""),U(!0),de()}},[t,n]);const de=async()=>{try{await Promise.all([_e(),ae()])}finally{U(!1)}},ae=async()=>{try{const se=n.WRK_DRCTN_ID||n.id;if(!se)return;const Re=n.CRR_NM||"",be=n.WRKR_NM||"";if(Re||be){te(Re),R(be);return}const De=await qC(se);if(De&&De.length>0){const re=De[0];te(re.CRR_NM||""),R(re.WRKR_NM||""),console.log("[]   :",{CRR_NM:re.CRR_NM,WRKR_NM:re.WRKR_NM})}}catch(se){console.error("    :",se)}},_e=async()=>{try{const se=await qa("CMWO224");A(se||[])}catch(se){console.error("   :",se)}},ie=()=>k!==Y||M!==J||F!==V;b.useEffect(()=>{const se=Re=>{Q.current&&!Q.current.contains(Re.target)&&g(!1)};if(p)return document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[p]);const Ne=se=>{c(se),h(null),q.current&&clearTimeout(q.current),se.trim().length>=2?q.current=setTimeout(()=>{X(se.trim())},300):(_([]),g(!1))},X=async se=>{y(!0),g(!0);try{const Re=await mp({USR_NM:se,SO_ID:(a==null?void 0:a.soId)||""});_(Re||[])}catch(Re){console.error("Worker search failed:",Re),_([])}finally{y(!1)}},xe=se=>{h(se),c(se.USR_NM),g(!1)},fe=async()=>{const se=k.replace(/-/g,"");if(se.length<8){i==null||i(" .","error");return}if(!M){i==null||i(" .","error");return}if(!F){i==null||i(" .","error");return}const Re=new Date,be=`${Re.getFullYear()}${String(Re.getMonth()+1).padStart(2,"0")}${String(Re.getDate()).padStart(2,"0")}${String(Re.getHours()).padStart(2,"0")}${String(Re.getMinutes()).padStart(2,"0")}`,De=`${se}${M}${F}`;if(Number(De)<Number(be)){i==null||i("   .","error");return}if(!u){i==null||i(" .","error");return}if(!n.WRK_DRCTN_ID&&!n.id){i==null||i(" ID .","error");return}if(ie()&&!B){i==null||i(" .  .","error");return}v(!0);try{const re=k.replace(/-/g,""),me=M&&F?`${re}${M}${F}`:void 0,ve=ie(),et=!0;let Dt="";ve&&et?Dt="AL":et&&(Dt="WR");const ot=n,At=new Date,ct=`${At.getFullYear()}${String(At.getMonth()+1).padStart(2,"0")}${String(At.getDate()).padStart(2,"0")}`,Ge=re===ct,at={CNTL_FG:"UPMODE",NMLEVEL:"3",WRK_DRCTN_ID:n.WRK_DRCTN_ID||n.id,WRKR_ID:u.USR_ID,CRR_ID:u.CRR_ID||(a==null?void 0:a.crrId)||"",POST_ID:u.POST_ID||"",DIV_DATE:re,DIV_DT:re,DIV_HH:M||"",DIV_MI:F||"",WRK_HOPE_DTTM:me||"",RCPT_ID:ot.RCPT_ID||"",WRK_ID:n.id||ot.WRK_ID||"",REG_UID:(a==null?void 0:a.userId)||"",CHG_UID:(a==null?void 0:a.userId)||"",HOLY_YN:"N",SMS_YN:Ge?"Y":"N",DIV_RESULT:"",O_WRK_DIV_ID:"",WRK_DIV_CL:"",...B&&{CHG_RSN:B},...Dt&&{CHG_GB:Dt}};console.log("Worker adjustment params:",at);const xt=await bA(at);console.log("Worker adjustment result:",xt);const mt=xt==null?void 0:xt.result;if(Array.isArray(mt)&&mt.length>0){const Ve=mt[0];if(Ve.MSGCODE&&Ve.MSGCODE!=="SUCCESS"&&Ve.MSGCODE!=="0"){const it=Ve.MESSAGE||Ve.MSG||"  .";i==null||i(it,"error");return}}if(xt!=null&&xt.code&&xt.code!=="SUCCESS"&&xt.code!=="0"){const Ve=xt.message||xt.MESSAGE||"  .";i==null||i(Ve,"error");return}i==null||i("  .","success"),r==null||r(),e()}catch(re){console.error("Worker adjustment failed:",re),i==null||i(re.message||"  .","error")}finally{v(!1)}},Z=()=>{var se;return s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"space-y-1.5 text-sm",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"font-mono text-gray-700",children:Mb(n.WRK_DRCTN_ID||n.id)})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"text-blue-600 font-medium",children:n.typeDisplay||n.WRK_CD_NM})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:((se=n.customer)==null?void 0:se.name)||n.CUST_NM})]})]})})},le=s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:e,disabled:S,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 whitespace-nowrap",children:""}),s.jsx("button",{type:"button",onClick:fe,disabled:S||!u,className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:S?"...":""})]});return s.jsxs(Ra,{isOpen:t,onClose:e,title:" ",size:"medium",footer:O?void 0:le,children:[O?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(wf,{size:"medium",message:"  ..."})}):s.jsxs("div",{className:"space-y-4",children:[Z(),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",ref:Q,children:[s.jsxs("div",{className:"relative",children:[s.jsx(Yu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:o,onChange:se=>Ne(se.target.value),onFocus:()=>m.length>0&&g(!0),placeholder:"  (2 )",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u&&s.jsx("button",{type:"button",onClick:()=>{h(null),c(""),_([])},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(Mi,{className:"w-4 h-4"})})]}),p&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-30",children:C?s.jsx("div",{className:"p-4 text-center",children:s.jsx(wf,{size:"small",message:"..."})}):m.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(o0,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),s.jsx("p",{className:"text-sm",children:"  ."})]}):m.map(se=>{const Re=se.CORP_NM||se.CRR_NM||"",be=se.TEL_NO3||se.TEL_NO2||se.HP_NO||se.PDATEL_NO||"";return s.jsxs("button",{type:"button",onMouseDown:De=>De.preventDefault(),onClick:()=>xe(se),className:"w-full p-3 text-left hover:bg-blue-50 transition-colors border-b border-gray-100 last:border-b-0",children:[s.jsx("div",{className:"font-medium text-gray-900",children:se.USR_NM}),s.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[se.USR_ID,Re&&`  ${Re}`,be&&`  ${Mb(be)}`]})]},se.USR_ID)})})]})]}),u&&(()=>{const se=u.CORP_NM||u.CRR_NM||"",Re=u.TEL_NO3||u.TEL_NO2||u.HP_NO||u.PDATEL_NO||"";return s.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("div",{className:"font-semibold text-gray-900 text-base mb-2",children:u.USR_NM}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:u.USR_ID})]}),se&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:se})]}),Re&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:Mb(Re)})]})]})]})})(),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[" ",s.jsx("span",{className:"font-normal text-blue-600"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",ref:$,value:k,onChange:se=>L(se.target.value),className:"absolute opacity-0 pointer-events-none h-0 w-0",tabIndex:-1}),s.jsxs("button",{type:"button",onClick:()=>{var se,Re;return(Re=(se=$.current)==null?void 0:se.showPicker)==null?void 0:Re.call(se)},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer bg-white flex items-center justify-between",children:[s.jsx("span",{className:`text-sm sm:text-base ${k?"text-gray-900":"text-gray-500"}`,children:k||" "}),s.jsx(nm,{className:"w-4 h-4 text-gray-400"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(sn,{value:M,onValueChange:P,options:[{value:"",label:" "},...Q6.map(se=>({value:se.value,label:se.label}))],placeholder:" "})}),s.jsx("div",{className:"flex-1",children:s.jsx(sn,{value:F,onValueChange:G,options:[{value:"",label:" "},...Y6.map(se=>({value:se.value,label:se.label}))],placeholder:" "})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["  ",ie()&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:B,onValueChange:I,options:[{value:"",label:" "},...E.map(se=>({value:se.code,label:se.name}))],placeholder:" "}),ie()&&s.jsx("p",{className:"mt-1 text-xs text-orange-600",children:"      ."})]}),s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 rounded-lg",children:[s.jsx(Vr,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-amber-700",children:"         ."})]})]}),S&&s.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-lg",children:s.jsx(wf,{size:"medium",message:"  ..."})})]})},V6=({onBack:t,userInfo:e,showToast:n})=>{const[r,i]=b.useState(null),[a,o]=b.useState(!1),[c,u]=b.useState(!0),[h,m]=b.useState(!1),[_,p]=b.useState(!1),[g,C]=b.useState([]);b.useEffect(()=>{y(),S()},[e]);const y=async()=>{u(!0);try{const B=await aA({SO_ID:e==null?void 0:e.soId,CRR_ID:e==null?void 0:e.crrId,WRKR_ID:e==null?void 0:e.userId});if(console.log("[SafetyCheckList] Raw API items:",B),B&&B.length>0){let I=[];e!=null&&e.userId&&(I=await RM(e.userId),console.log("[SafetyCheckList] Today results:",I),I.length>0&&p(!0));const E=new Map;I.forEach(Y=>{Y.ITEM_ID&&E.set(Y.ITEM_ID,Y.ANSWER_VALUE||"N")});const A=B.sort((Y,ee)=>(Y.DISPLAY_ORDER||0)-(ee.DISPLAY_ORDER||0)).map(Y=>({id:Y.ITEM_ID,label:Y.QUESTION_TEXT,required:Y.IS_REQUIRED==="Y",imageRequired:Y.IMAGE_REQUIRED_YN==="Y",checked:E.get(String(Y.ITEM_ID))==="Y",photo:void 0}));console.log("[SafetyCheckList] Mapped items:",A),C(A)}else console.log("[SafetyCheckList] No items from API"),n&&n("    .","warning")}catch(B){console.error("[SafetyCheckList] Failed to load checklist:",B),n&&n("   ","error",!0)}finally{u(!1)}},S=async()=>{const B=(e==null?void 0:e.soId)||"",I=(e==null?void 0:e.crrId)||"";if(!(!B||!I))try{const E=await oA({SO_ID:B,CRR_ID:I});if(E&&E.length>0){const A=E.sort((ee,J)=>J.INSP_END_DT.localeCompare(ee.INSP_END_DT))[0];i(A);const Y=new Date().toISOString().slice(0,10).replace(/-/g,"");A.INSP_END_DT<Y&&(o(!0),n&&n(" .   .","warning"))}}catch(E){console.error("  :",E)}},v=B=>{C(I=>I.map(E=>E.id===B?{...E,checked:!E.checked}:E))},k=B=>new Promise((I,E)=>{const A=new Image;A.onload=()=>{try{const Y=document.createElement("canvas"),ee=1920;let J=A.width,H=A.height;(J>ee||H>ee)&&(J>H?(H=H/J*ee,J=ee):(J=J/H*ee,H=ee)),Y.width=J,Y.height=H;const V=Y.getContext("2d");if(!V){E(new Error("Canvas context not available"));return}V.drawImage(A,0,0,J,H);const K=new Date,j=`${K.getFullYear()}-${String(K.getMonth()+1).padStart(2,"0")}-${String(K.getDate()).padStart(2,"0")} ${String(K.getHours()).padStart(2,"0")}:${String(K.getMinutes()).padStart(2,"0")}:${String(K.getSeconds()).padStart(2,"0")}`,te=Math.max(16,Math.floor(J/25));V.font=`bold ${te}px Arial`;const ce=V.measureText(j).width,R=10,O=te+R*2,U=ce+R*2;V.fillStyle="rgba(0, 0, 0, 0.6)",V.fillRect(J-U-10,H-O-10,U,O),V.fillStyle="#FFFFFF",V.fillText(j,J-ce-R-10,H-R-15);const Q=Y.toDataURL("image/jpeg",.85);I(Q)}catch(Y){E(Y)}},A.onerror=()=>E(new Error("Image load failed")),A.src=URL.createObjectURL(B)}),L=async(B,I)=>{const E=I.target.files;if(E&&E.length>0)try{const A=await k(E[0]);C(Y=>Y.map(ee=>ee.id===B?{...ee,photo:A,checked:!0}:ee)),console.log("[SafetyCheckList]    ( , Base64 )")}catch(A){console.error("[SafetyCheckList]   :",A),n&&n("  .","error")}},M=B=>{C(I=>I.map(E=>E.id===B?{...E,photo:void 0}:E))},P=()=>g.filter(E=>E.required&&!E.checked).length>0?(n&&n("    .","warning"),!1):g.filter(E=>E.imageRequired&&!E.photo).length>0?(n&&n("   .","warning"),!1):!0,F=async()=>{if(!P())return;const B=(e==null?void 0:e.userId)||"mobile_user";m(!0);try{const I=g.map(ee=>String(ee.id)).join(","),E=g.map(ee=>ee.checked?"Y":"N").join(","),A="N";console.log("   :",{USR_ID:B,ANS_ITEM_IDS:I,ANS_VALUES:E,IMG_PATHS:"(empty - image upload not implemented)"});const Y=await lA({USR_ID:B,IMG_PATHS:A,ANS_ITEM_IDS:I,ANS_VALUES:E});console.log("  :",Y),Y.code==="SUCCESS"||Y.code==="OK"?(n&&n(" .","success"),await y(),await S()):n&&n(`  : ${Y.message||"   "}`,"error",!0)}catch(I){console.error("  :",I),n&&n("  API  .","warning")}finally{m(!1)}},G=()=>{const B=g.filter(E=>E.required);if(B.length===0)return 100;const I=B.filter(E=>E.checked).length;return Math.round(I/B.length*100)};return c?s.jsxs("div",{className:"text-center p-10",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-cyan-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-gray-600",children:" ..."})]}):g.length===0?s.jsx("div",{className:"max-w-4xl mx-auto pb-6",children:s.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Vr,{className:"w-6 h-6 text-yellow-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-yellow-800 font-bold mb-1",children:"  "}),s.jsx("p",{className:"text-sm text-yellow-700",children:"DB     .  ."})]})]})})}):s.jsxs("div",{className:"max-w-4xl mx-auto pb-6",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-500 text-white p-4 sm:p-5 rounded-xl shadow-lg mb-6 relative",children:s.jsxs("div",{className:"flex items-start gap-2 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 z-10 min-w-0 flex flex-col justify-between h-36 sm:h-44",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"p-1.5 sm:p-2 bg-white/20 rounded-lg flex-shrink-0",children:s.jsx(lE,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),s.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:""})]}),s.jsx("p",{className:"text-xs sm:text-sm text-white/90",children:"  "}),s.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 text-xs",children:[s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""}),s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""}),s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""}),s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 bg-white/20 rounded-full",children:""})]})]}),s.jsx("div",{className:"flex-shrink-0 w-28 h-28 sm:w-36 sm:h-36 relative",children:s.jsx("img",{src:"/safeimage1-Photoroom.png",alt:" ",className:"absolute -right-4 -bottom-10 drop-shadow-xl !w-[170px] !h-auto !max-w-none"})})]})}),a&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Vr,{className:"w-6 h-6 text-red-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-red-800 font-bold mb-1",children:" "}),s.jsx("p",{className:"text-sm text-red-700",children:" .      ."})]})]})}),r&&!a&&s.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ea,{className:"w-6 h-6 text-green-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-green-800 font-bold mb-1",children:"  "}),s.jsxs("p",{className:"text-sm text-green-700",children:[": ",r.INSP_END_DT.slice(0,4),"-",r.INSP_END_DT.slice(4,6),"-",r.INSP_END_DT.slice(6,8)]})]})]})}),_&&s.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ea,{className:"w-6 h-6 text-blue-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-blue-800 font-bold mb-1",children:"   "}),s.jsx("p",{className:"text-sm text-blue-700",children:"   .     ."})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden mb-4",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 p-3 sm:p-4 flex items-center gap-2 sm:gap-3",children:[s.jsx(lE,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"}),s.jsx("h3",{className:"text-base sm:text-lg font-bold text-white",children:" "}),s.jsxs("span",{className:"ml-auto text-white/80 text-sm",children:[g.length," "]})]}),s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:g.map((B,I)=>{var E;return s.jsxs("div",{className:`p-3 rounded-lg border ${B.checked?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:B.checked,onChange:()=>v(B.id),className:"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-900 whitespace-pre-line",children:[I+1,". ",(E=B.label)==null?void 0:E.replace(/\r\n/g,`
`).replace(/  - /g,`
- `),B.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),B.imageRequired&&s.jsxs("span",{className:"ml-2 inline-flex items-center gap-1 px-2 py-0.5 rounded bg-orange-100 text-orange-700 text-xs",children:[s.jsx(rE,{className:"w-3 h-3"}),""]})]}),B.checked&&s.jsx(ea,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]}),B.imageRequired&&s.jsx("div",{className:"mt-3 ml-8",children:B.photo?s.jsxs("div",{className:"relative inline-block",children:[s.jsx("img",{src:B.photo,alt:" ",className:"w-24 h-24 object-cover rounded-lg border-2 border-green-300"}),s.jsx("button",{onClick:()=>M(B.id),className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:s.jsx(Mi,{className:"w-3 h-3"})})]}):s.jsxs("label",{className:"inline-flex items-center gap-2 px-4 py-2 border-2 border-dashed border-orange-300 rounded-lg hover:border-orange-500 hover:bg-orange-50 cursor-pointer transition-all",children:[s.jsx(rE,{className:"w-4 h-4 text-orange-500"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:" "}),s.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:A=>L(B.id,A),className:"hidden"})]})})]},B.id)})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("button",{onClick:F,disabled:h||G()<100,className:"w-full py-3 sm:py-4 bg-gradient-to-r from-blue-600 to-cyan-500 text-white rounded-xl font-bold text-base sm:text-lg shadow-lg hover:from-blue-700 hover:to-cyan-600 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:h?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})," ..."]}):" "}),G()<100&&s.jsx("p",{className:"text-center text-sm text-red-600 mt-2",children:"   "})]}),s.jsx("div",{className:"mt-3 p-2.5 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-xs text-blue-800",children:[s.jsx("span",{className:"text-red-500 font-bold",children:"*"}),"     "]})})]})},$6=({onBack:t})=>{const[e,n]=b.useState([]),[r,i]=b.useState(!1),[a,o]=b.useState(null),[c,u]=b.useState(new Date().toISOString().slice(0,10));b.useEffect(()=>{h()},[]);const h=async()=>{try{i(!0),o(null);const m={};c&&(m.HOPE_DT=c.replace(/-/g,""));const _=await cA(m);n(_),console.log("  :",_.length)}catch(m){console.error("  :",m),o("  .")}finally{i(!1)}};return s.jsxs("div",{children:[s.jsx("div",{className:"mb-3",children:s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"mb-3 bg-white rounded-lg shadow-sm border border-gray-200 p-3",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"date",value:c,onChange:m=>u(m.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",style:{colorScheme:"light"}})]}),s.jsx("button",{onClick:h,disabled:r,className:"w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded font-medium text-sm shadow-md transition-all disabled:opacity-50",children:""})]})}),r?s.jsxs("div",{className:"text-center p-10",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-orange-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-gray-600",children:" ..."})]}):a?s.jsxs("div",{className:"text-center p-10 bg-white rounded-lg shadow-sm border border-red-200",children:[s.jsx("p",{className:"text-red-500",children:a}),s.jsx("button",{onClick:h,className:"mt-4 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:" "})]}):s.jsx(s.Fragment,{children:e.length>0?s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:s.jsx("div",{className:"max-h-96 overflow-y-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-700 border-b",children:""})]})}),s.jsx("tbody",{children:e.map((m,_)=>s.jsxs("tr",{className:"hover:bg-orange-50 transition-colors",children:[s.jsx("td",{className:"px-2 py-2 text-xs text-gray-900 border-b",children:m.WRKR_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.WRK_CD_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.ING_CNT||0}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.CMPL_CNT||0}),s.jsx("td",{className:"px-2 py-2 text-xs text-center text-gray-900 border-b",children:m.SUM_CNT||0})]},`${m.WRK_ID}-${_}`))})]})})}):s.jsx("div",{className:"text-center py-10 bg-white rounded-lg shadow-sm border border-gray-200",children:s.jsx("p",{className:"text-gray-500 text-sm",children:"   "})})})]})},z6=({isOpen:t,onClose:e,onSelectCustomer:n})=>{const[r,i]=b.useState(""),[a,o]=b.useState(""),[c,u]=b.useState(""),[h,m]=b.useState(""),[_,p]=b.useState([]),[g,C]=b.useState(!1),[y,S]=b.useState(!1),v=()=>{i(""),o(""),u(""),m(""),p([]),S(!1)},k=async()=>{C(!0),S(!0),p([]);try{let M=[];if(a.trim())M=await VA(a.trim());else if(r.trim())M=await YA(r.trim());else if(c.trim())M=await QA(c.trim());else if(h.trim())M=await $A(h.trim());else{alert("  ."),C(!1);return}p(M)}catch(M){console.error("Customer search error:",M)}finally{C(!1)}},L=M=>{const P={...M};a.trim()&&!P.CTRT_ID&&(P.CTRT_ID=a.trim()),n(P),e()};return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12 bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[90%] max-w-md max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500 rounded-t-xl",children:[s.jsx("h3",{className:"text-white font-bold text-base",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:v,className:"px-3 py-1 text-xs bg-white/20 text-white rounded-full hover:bg-white/30",children:""}),s.jsx("button",{onClick:e,className:"text-white",children:s.jsx(Mi,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"p-4 space-y-3 border-b",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:r,onChange:M=>i(M.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:"ID ",maxLength:10})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:a,onChange:M=>o(M.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:"ID ",maxLength:15})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:""}),s.jsx("input",{type:"tel",value:c,onChange:M=>u(M.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:" ",maxLength:15})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm text-gray-600 w-16 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:h,onChange:M=>m(M.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg",placeholder:" ",maxLength:20})]}),s.jsxs("div",{className:"flex gap-2 pt-1",children:[s.jsxs("button",{onClick:k,disabled:g,className:"flex-1 flex items-center justify-center gap-1 bg-blue-500 hover:bg-blue-600 text-white py-2.5 rounded-lg font-medium text-sm disabled:opacity-50",children:[s.jsx(Yu,{className:"h-4 w-4"}),""]}),s.jsx("button",{onClick:e,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2.5 rounded-lg font-medium text-sm",children:""})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:g?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-3 border-blue-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:" ..."})]}):_.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:[" ",_.length,""]}),_.map((M,P)=>s.jsx("button",{onClick:()=>L(M),className:"w-full text-left p-3 bg-gray-50 hover:bg-blue-50 border border-gray-200 rounded-lg transition-colors",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[M.CUST_NM||"-"," ",s.jsxs("span",{className:"text-gray-400 text-xs",children:["(",M.CUST_ID,")"]})]}),M.CTRT_ID&&s.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[": ",M.CTRT_ID," | ",M.BASIC_PROD_CD_NM||M.PROD_NM||"-"]}),M.ADDR&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5 truncate",children:M.ADDR})]}),s.jsxs("div",{className:"text-right",children:[M.CTRT_STAT_NM&&s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700",children:M.CTRT_STAT_NM}),M.SO_NM&&s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:M.SO_NM})]})]})},P))]}):y?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-gray-500",children:"  ."})}):s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-gray-400",children:"     ."})})})]})}):null},ZM=({onBack:t,userInfo:e,showToast:n})=>{const[r,i]=b.useState(!1),[a,o]=b.useState(null),[c,u]=b.useState([]),[h,m]=b.useState(null),[_,p]=b.useState(!1),[g,C]=b.useState("all"),[y,S]=b.useState(""),[v,k]=b.useState(!1),[L,M]=b.useState(!1),[P,F]=b.useState("basic"),G=b.useRef([]),B=b.useRef([]),I=b.useRef([]),E=b.useRef(!1);b.useEffect(()=>{E.current||(E.current=!0,(async()=>{try{const[Ve,it,Fe]=await Promise.all([Ac().catch(()=>[]),N1().catch(()=>[]),qa("CMIF006").catch(()=>[])]);G.current=Ve||[],B.current=it||[],I.current=(Fe||[]).map(nt=>nt.code||nt.COMMON_CD)}catch(Ve){console.error("[SignalIntegration]    :",Ve)}})())},[]);const A=Ve=>{const it=Ve.BASIC_PROD_CD||Ve.PROD_CD||"",Fe=Ve.SO_ID||"";return it&&G.current.some(nt=>nt.PROD_CD===it)?"lgu":it&&B.current.includes(it)&&Fe&&I.current.includes(Fe)?"ftth":"basic"},[Y,ee]=b.useState(!1),[J,H]=b.useState(""),[V,K]=b.useState(()=>{const Ve=new Date;return Ve.setDate(Ve.getDate()-7),Ve.toISOString().slice(0,10)}),[j,te]=b.useState(new Date().toISOString().slice(0,10)),[ce,R]=b.useState(!1),[O,U]=b.useState(!1),[Q,q]=b.useState([]),[$,de]=b.useState(null),[ae,_e]=b.useState([]),[ie,Ne]=b.useState([]),[X,xe]=b.useState([]),[fe,Z]=b.useState(null),[le,se]=b.useState([]),[Re,be]=b.useState([]),De=Ve=>{if(!Ve)return"-";const it=Ve.replace(/[^0-9]/g,"");return it.length===10?`${it.slice(0,3)}-${it.slice(3,6)}-${it.slice(6)}`:Ve},re=Ve=>{if(!Ve)return"-";const it=Ve.replace(/[-: T]/g,"");return it.length>=14?`${it.slice(0,4)}-${it.slice(4,6)}-${it.slice(6,8)} ${it.slice(8,10)}:${it.slice(10,12)}:${it.slice(12,14)}`:it.length>=8?`${it.slice(0,4)}-${it.slice(4,6)}-${it.slice(6,8)}`:Ve},me=()=>{q([]),de(null),_e([]),Ne([]),xe([]),Z(null),se([]),be([])},ve=async Ve=>{if(o(Ve),u([]),m(null),me(),M(!0),Ve.CTRT_ID){const it={CTRT_ID:Ve.CTRT_ID,CUST_ID:Ve.CUST_ID,BASIC_PROD_CD_NM:Ve.BASIC_PROD_CD_NM||Ve.PROD_NM,CTRT_STAT_NM:Ve.CTRT_STAT_NM,SO_NM:Ve.SO_NM,ADDR:Ve.ADDR};m(it),H(Ve.CTRT_ID)}if(Ve.CUST_ID)try{const it=await zA(Ve.CUST_ID);if(it.length>0){u(it);const Fe=Ve.CTRT_ID;if(Fe){const nt=it.find(lt=>lt.CTRT_ID===Fe);if(nt){m(nt),H(nt.CTRT_ID);const lt=A(nt);F(lt)}else console.log("[SignalIntegration]   CTRT_ID  ,  CTRT_ID :",Fe),H(Fe)}else if(!h&&it.length===1){m(it[0]),H(it[0].CTRT_ID);const nt=A(it[0]);F(nt)}}}catch(it){console.error("Failed to load contract list:",it)}finally{M(!1)}else M(!1);Ve.CTRT_ID&&ee(!0)};b.useEffect(()=>{Y&&!L&&J&&(ee(!1),Dt())},[Y,L,J]);const et=Ve=>{if((h==null?void 0:h.CTRT_ID)===Ve.CTRT_ID&&v){k(!1);return}m(Ve),H(Ve.CTRT_ID),me();const it=A(Ve);F(it),k(!1)},Dt=async()=>{const Ve=J.trim();if(!Ve){n==null||n("ID .","warning");return}R(!0),me(),k(!0);try{const it=V.replace(/-/g,""),Fe=new Date(j);Fe.setDate(Fe.getDate()+1);const nt=Fe.toISOString().slice(0,10).replace(/-/g,"");if(P==="basic"){const Mt=await WA({CTRT_ID:Ve,STRT_DTTM1:it,STRT_DTTM2:nt,CALL_GB:"M"});q(Mt.slice(0,100))}else if(P==="lgu"){const Mt=await AA({CTRT_ID:Ve,STRT_DTTM1:it,STRT_DTTM2:nt,CALL_GB:"M"});xe(Mt.slice(0,100))}else{const Mt=await QP({CTRT_ID:Ve,STRT_DTTM1:it,STRT_DTTM2:nt});be(Mt.slice(0,100))}const lt=P==="basic"?Q.length:P==="lgu"?X.length:Re.length;n==null||n(" .","success")}catch(it){console.error("Signal history query error:",it),n==null||n("  .","error")}finally{R(!1)}},ot=async Ve=>{if(de(Ve),_e([]),Ne([]),!!Ve.IF_DTL_ID){U(!0);try{const{svcRslt:it,svcDtlRslt:Fe}=await FA(Ve.IF_DTL_ID);_e(it),Ne(Fe)}catch(it){console.error("Detail query error:",it)}finally{U(!1)}}},At=async Ve=>{if(Z(Ve),se([]),!!Ve.JOB_ID){U(!0);try{const it=await GA(Ve.JOB_ID);se(it)}catch(it){console.error("LGU detail query error:",it)}finally{U(!1)}}},ct=c.filter(Ve=>Ve.CTRT_STAT_NM===""||Ve.CTRT_STAT==="10"),Ge=g==="active"?ct:c,at=y?Ge.filter(Ve=>(Ve.CTRT_ID||"").includes(y)||(Ve.BASIC_PROD_CD_NM||Ve.PROD_NM||"").includes(y)||(Ve.ADDR||Ve.INSTL_ADDR||"").includes(y)):Ge,mt=(P==="basic"?Q.length:P==="lgu"?X.length:Re.length)>0;return s.jsxs("div",{className:"flex-1 overflow-y-auto px-3 pt-2 pb-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 w-14 flex-shrink-0",children:""}),s.jsxs("button",{onClick:()=>i(!0),className:"flex-1 flex items-center gap-2 px-3 py-2.5 border border-gray-300 rounded-lg text-left hover:bg-gray-50 transition-colors",children:[a?s.jsxs("span",{className:"text-sm text-gray-900 truncate",children:[a.CUST_NM||"-"," (",a.CUST_ID,")"]}):s.jsx("span",{className:"text-sm text-gray-400",children:", ID, ID, "}),s.jsx(Yu,{className:"h-4 w-4 text-gray-400 ml-auto flex-shrink-0"})]})]})}),L&&s.jsxs("div",{className:"text-center py-8 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-[3px] border-blue-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"   ..."})]}),c.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsxs("button",{onClick:()=>k(!v),className:"w-full px-3 py-2.5 border-b border-gray-100 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-800 flex items-center gap-1.5",children:[s.jsx("span",{className:"text-blue-500",children:"|"}),"   ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",at.length,")"]}),v&&h&&s.jsxs("span",{className:"text-xs font-normal text-gray-500 ml-1",children:["- ",De(h.CTRT_ID)," (",h.BASIC_PROD_CD_NM||h.PROD_NM||"",")"]})]}),v?s.jsx(ir,{className:"h-4 w-4 text-gray-400"}):s.jsx(kr,{className:"h-4 w-4 text-gray-400"})]}),!v&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-3 py-1.5 border-b border-gray-100 flex items-center justify-end",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsxs("button",{onClick:()=>C("all"),className:`px-2.5 py-1 text-xs rounded-full font-medium ${g==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-500"}`,children:["(",c.length,")"]}),s.jsxs("button",{onClick:()=>C("active"),className:`px-2.5 py-1 text-xs rounded-full font-medium ${g==="active"?"bg-blue-500 text-white":"bg-gray-100 text-gray-500"}`,children:["(",ct.length,")"]})]})}),s.jsx("div",{className:"px-3 py-2 border-b border-gray-50",children:s.jsxs("div",{className:"relative",children:[s.jsx(CM,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"}),s.jsx("input",{type:"text",value:y,onChange:Ve=>S(Ve.target.value),className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-200 rounded-md bg-gray-50 focus:bg-white focus:border-blue-300 focus:outline-none",placeholder:"ID, ,  "})]})}),s.jsx("div",{className:`${_?"max-h-72":"max-h-44"} overflow-y-auto`,children:at.map((Ve,it)=>s.jsx("button",{onClick:()=>et(Ve),className:`w-full text-left px-3 py-2.5 border-b border-gray-50 transition-colors ${(h==null?void 0:h.CTRT_ID)===Ve.CTRT_ID?"bg-blue-50 border-l-3 border-l-blue-500":"hover:bg-gray-50"}`,children:s.jsxs("div",{className:"flex items-start gap-2.5",children:[s.jsx("span",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${(h==null?void 0:h.CTRT_ID)===Ve.CTRT_ID?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:it+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:Ve.BASIC_PROD_CD_NM||Ve.PROD_NM||"-"}),s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full flex-shrink-0 ml-2 ${Ve.CTRT_STAT_NM===""?"bg-green-100 text-green-700":Ve.CTRT_STAT_NM===""?"bg-blue-100 text-blue-600":Ve.CTRT_STAT_NM===""?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:Ve.CTRT_STAT_NM||"-"})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[s.jsxs("span",{children:[" ID: ",De(Ve.CTRT_ID)]}),s.jsx("span",{className:"text-gray-300",children:"|"}),s.jsx("span",{children:Ve.SO_NM||"N/A"})]}),(Ve.ADDR||Ve.INSTL_ADDR)&&s.jsx("p",{className:"mt-0.5 text-xs text-gray-400 truncate",children:Ve.INSTL_ADDR||Ve.ADDR})]})]})},Ve.CTRT_ID||it))}),at.length>3&&s.jsx("button",{onClick:()=>p(!_),className:"w-full py-1.5 text-xs text-blue-500 hover:bg-blue-50 flex items-center justify-center gap-1",children:_?s.jsxs(s.Fragment,{children:[s.jsx(kr,{className:"h-3 w-3"})," "]}):s.jsxs(s.Fragment,{children:[s.jsx(ir,{className:"h-3 w-3"})," "]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:J,onChange:Ve=>H(Ve.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none",placeholder:"ID ",maxLength:15})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsx("input",{type:"date",value:V,onChange:Ve=>K(Ve.target.value),className:"flex-1 px-2 py-2 text-sm border border-gray-300 rounded-lg",style:{colorScheme:"light"}}),s.jsx("span",{className:"text-gray-400 text-sm",children:"~"}),s.jsx("input",{type:"date",value:j,onChange:Ve=>te(Ve.target.value),className:"flex-1 px-2 py-2 text-sm border border-gray-300 rounded-lg",style:{colorScheme:"light"}})]}),s.jsx("button",{onClick:Dt,disabled:ce,className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-2.5 rounded-lg font-medium text-sm shadow-sm transition-all disabled:opacity-50",children:ce?" ...":""})]}),ce?s.jsxs("div",{className:"text-center py-10 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-7 w-7 border-[3px] border-blue-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"  ..."})]}):mt?s.jsxs(s.Fragment,{children:[P==="basic"&&Q.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",Q.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full min-w-[780px]",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"(KCT)"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"SO_ID"})]})}),s.jsx("tbody",{children:Q.map((Ve,it)=>s.jsxs("tr",{onClick:()=>ot(Ve),className:`cursor-pointer transition-colors ${($==null?void 0:$.IF_DTL_ID)===Ve.IF_DTL_ID?"bg-blue-100":it%2===0?"bg-white":"bg-gray-50/50"} hover:bg-blue-50`,children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.IF_DTL_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[140px] truncate",children:Ve.PROD_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.MSG_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[120px] truncate",children:Ve.MSG_ID_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:Ve.RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:Ve.RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:Ve.PROC_RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:Ve.PROC_RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.SO_ID||"-"})]},`${Ve.IF_DTL_ID}-${it}`))})]})})})]}),P==="basic"&&$&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["ID: ",$.IF_DTL_ID]})]})}),O?s.jsx("div",{className:"text-center py-6",children:s.jsx("div",{className:"inline-block animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"})}):ae.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[700px]",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:ae.map((Ve,it)=>s.jsxs("tr",{className:it%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.REQ_SYSTEM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.IF_DTL_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:re(Ve.REG_DTTM)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.IF_TP||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:Ve.SYSTEM_RSLT_CD&&Ve.SYSTEM_RSLT_CD.startsWith("0")?"text-green-600":"text-red-600",children:Ve.SYSTEM_RSLT_CD||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.SYSTEM_RSLT_MSG||"-"})]},it))})]})}):s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-xs text-gray-400",children:"  "})}),ie.length>0&&s.jsxs("div",{className:"border-t border-gray-200",children:[s.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-100",children:s.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:" "})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[700px]",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "}),s.jsx("th",{className:"px-2 py-1.5 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "}),s.jsx("th",{className:"px-2 py-1.5 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "}),s.jsx("th",{className:"px-2 py-1.5 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:" "})]})}),s.jsx("tbody",{children:ie.map((Ve,it)=>{var Fe,nt;return s.jsxs("tr",{className:it%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.IF_DTL_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.IF_TP||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:(Fe=Ve.TMS_PROC_STATUS_NM)!=null&&Fe.includes("")?"text-green-600":"text-orange-600",children:Ve.TMS_PROC_STATUS_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:(nt=Ve.LS_PROC_STATUS_NM)!=null&&nt.includes("")?"text-green-600":"text-orange-600",children:Ve.LS_PROC_STATUS_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.TMS_ERR_MSG||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.LS_ERR_MSG||"-"})]},it)})})]})})]})]}),P==="lgu"&&X.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",X.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full min-w-[780px]",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"(KCT)"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"SO_ID"})]})}),s.jsx("tbody",{children:X.map((Ve,it)=>s.jsxs("tr",{onClick:()=>At(Ve),className:`cursor-pointer transition-colors ${(fe==null?void 0:fe.JOB_ID)===Ve.JOB_ID?"bg-blue-100":it%2===0?"bg-white":"bg-gray-50/50"} hover:bg-blue-50`,children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.JOB_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[140px] truncate",children:Ve.PROD_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.MSG_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[120px] truncate",children:Ve.MSG_ID_NM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:Ve.RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:Ve.RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:Ve.PROC_RSLT_CD_NM===""?"text-green-600":"text-orange-600",children:Ve.PROC_RSLT_CD_NM||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.SO_ID||"-"})]},`${Ve.JOB_ID}-${it}`))})]})})})]}),P==="lgu"&&fe&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:[" ",s.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["ID: ",fe.JOB_ID]})]})}),O?s.jsx("div",{className:"text-center py-6",children:s.jsx("div",{className:"inline-block animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"})}):le.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full min-w-[700px]",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:le.map((Ve,it)=>s.jsxs("tr",{className:it%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.REQ_SYSTEM||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.JOB_ID||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:re(Ve.REG_DTTM)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.RS_FCODE||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center border-b whitespace-nowrap",children:s.jsx("span",{className:Ve.RS_FCODE&&Ve.RS_FCODE.startsWith("0")?"text-green-600":"text-red-600",children:Ve.RS_FCODE||"-"})}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.RS_FMSG||"-"})]},it))})]})}):s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-xs text-gray-400",children:"  "})})]}),P==="ftth"&&Re.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800",children:["  ",s.jsxs("span",{className:"text-blue-500 font-normal",children:["(",Re.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.jsxs("table",{className:"w-full min-w-[850px]",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"ID"}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:"AP_MAC"}),s.jsx("th",{className:"px-2 py-2 text-center text-[0.6875rem] font-semibold text-gray-600 border-b whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:Re.map((Ve,it)=>s.jsxs("tr",{className:it%2===0?"bg-white":"bg-gray-50/50",children:[s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.SEQ_API||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap",children:Ve.CMD||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[120px] truncate",children:Ve.MSG_TP_DESC||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:re(Ve.REQ_DATE)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-gray-900 border-b whitespace-nowrap max-w-[140px] truncate",children:Ve.RESULT||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:re(Ve.RES_DATE)}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.MAC_ADDR||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-[0.6875rem] text-center text-gray-900 border-b whitespace-nowrap",children:Ve.SO_NM||"-"})]},`${Ve.SEQ_API}-${it}`))})]})})})]})]}):!ce&&J||ce?null:s.jsx("div",{className:"text-center py-10 bg-white rounded-lg shadow-sm border border-gray-200",children:s.jsx("p",{className:"text-sm text-gray-400",children:"  ID   "})}),s.jsx(z6,{isOpen:r,onClose:()=>i(!1),onSelectCustomer:ve})]})},eI=({onClick:t,workCount:e})=>s.jsxs("button",{onClick:t,className:"fixed bottom-24 right-4 z-40 w-14 h-14 bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-105 active:scale-95",style:{boxShadow:"0 4px 14px rgba(59, 130, 246, 0.4)"},title:" ",children:[s.jsx(BL,{className:"w-6 h-6"}),e!==void 0&&e>0&&s.jsx("span",{className:"absolute -top-1 -right-1 min-w-5 h-5 px-1.5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:e>99?"99+":e})]}),bl={ADD:"add",REMOVE:"remove"},am={PROPERTYCHANGE:"propertychange"},Mn={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class T1{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function H6(t,e,n){let r,i;n=n||yd;let a=0,o=t.length,c=!1;for(;a<o;)r=a+(o-a>>1),i=+n(t[r],e),i<0?a=r+1:(o=r,c=!i);return c?a:~a}function yd(t,e){return t>e?1:t<e?-1:0}function q6(t,e){return t<e?1:t>e?-1:0}function hN(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if(typeof n=="function"){for(let i=1;i<r;++i){const a=t[i];if(a===e)return i;if(a<e)return n(e,t[i-1],a)>0?i-1:i}return r-1}if(n>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(n<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function X6(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function fN(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let i=0;i<r;i++)t[t.length]=n[i]}function Ju(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function J6(t,e,n){const r=e||yd;return t.every(function(i,a){if(a===0)return!0;const o=r(t[a-1],i);return!(o>0||o===0)})}function Hg(){return!0}function M1(){return!1}function qg(){}function tI(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return(!n||this!==r||!Ju(i,n))&&(r=this,n=i,e=t.apply(this,arguments)),e}}function Z6(t){function e(){let n;try{n=t()}catch(r){return Promise.reject(r)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function C_(t){for(const e in t)delete t[e]}function lm(t){let e;for(e in t)return!1;return!e}class Id{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class I1 extends T1{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(n)||i.push(n)}dispatchEvent(e){const n=typeof e=="string",r=n?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const a=n?new Id(e):e;a.target||(a.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),c=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,c[r]=0),++o[r];let u;for(let h=0,m=i.length;h<m;++h)if("handleEvent"in i[h]?u=i[h].handleEvent(a):u=i[h].call(this,a),u===!1||a.propagationStopped){u=!1;break}if(--o[r]===0){let h=c[r];for(delete c[r];h--;)this.removeEventListener(r,qg);delete o[r]}return u}disposeInternal(){this.listeners_&&C_(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(n);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=qg,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}}function nr(t,e,n,r,i){if(i){const o=n;n=function(c){return t.removeEventListener(e,n),o.call(r??this,c)}}else r&&r!==t&&(n=n.bind(r));const a={target:t,type:e,listener:n};return t.addEventListener(e,n),a}function Kp(t,e,n,r){return nr(t,e,n,r,!0)}function ei(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),C_(t))}class N_ extends I1{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Mn.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let a=0;a<r;++a)i[a]=nr(this,e[a],n);return i}return nr(this,e,n)}onceInternal(e,n){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let a=0;a<i;++a)r[a]=Kp(this,e[a],n)}else r=Kp(this,e,n);return n.ol_key=r,r}unInternal(e,n){const r=n.ol_key;if(r)e8(r);else if(Array.isArray(e))for(let i=0,a=e.length;i<a;++i)this.removeEventListener(e[i],n);else this.removeEventListener(e,n)}}N_.prototype.on;N_.prototype.once;N_.prototype.un;function e8(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)ei(t[e]);else ei(t)}function sr(){throw new Error("Unimplemented abstract method.")}let t8=0;function rr(t){return t.ol_uid||(t.ol_uid=String(++t8))}class IE extends Id{constructor(e,n,r){super(e),this.key=n,this.oldValue=r}}class kc extends N_{constructor(e){super(),this.on,this.once,this.un,rr(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new IE(r,e,n)),r=am.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new IE(r,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,r){const i=this.values_||(this.values_={});if(r)i[e]=n;else{const a=i[e];i[e]=n,a!==n&&this.notify(e,a)}}setProperties(e,n){for(const r in e)this.set(r,e[r],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],lm(this.values_)&&(this.values_=null),n||this.notify(e,r)}}}const jE={LENGTH:"length"};class Px extends Id{constructor(e,n,r){super(e),this.element=n,this.index=r}}let uo=class extends kc{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,r=e.length;n<r;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)e(n[r],r,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(jE.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new Px(bl.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)if(n[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Px(bl.REMOVE,n,e)),n}setAt(e,n){const r=this.getLength();if(e>=r){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const i=this.array_[e];this.array_[e]=n,this.dispatchEvent(new Px(bl.REMOVE,i,e)),this.dispatchEvent(new Px(bl.ADD,n,e))}updateLength_(){this.set(jE.LENGTH,this.array_.length)}assertUnique_(e,n){const r=this.array_;for(let i=0,a=r.length;i<a;++i)if(r[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}};class xf extends Id{constructor(e,n,r){super(e),this.map=n,this.frameState=r!==void 0?r:null}}class Cu extends xf{constructor(e,n,r,i,a,o){super(e,n,a),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const pi={SINGLECLICK:"singleclick",CLICK:Mn.CLICK,DBLCLICK:Mn.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},zh=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",s8=zh.includes("safari")&&!zh.includes("chrom");s8&&(zh.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(zh));const n8=zh.includes("webkit")&&!zh.includes("edge"),sI=zh.includes("macintosh"),r8=typeof devicePixelRatio<"u"?devicePixelRatio:1,ho=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,nI=typeof Image<"u"&&Image.prototype.decode,rI=(function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t})(),ZC={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class i8 extends I1{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=nr(r,ZC.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nr(r,ZC.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Mn.TOUCHMOVE,this.boundHandleTouchMove_,rI?{passive:!1}:!1)}emulateClick_(e){let n=new Cu(pi.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new Cu(pi.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Cu(pi.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const n=e,r=n.pointerId;if(n.type==pi.POINTERUP||n.type==pi.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==n.target){delete this.trackedTouches_[i];break}}else(n.type==pi.POINTERDOWN||n.type==pi.POINTERMOVE)&&(this.trackedTouches_[r]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new Cu(pi.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ei),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new Cu(pi.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nr(r,pi.POINTERMOVE,this.handlePointerMove_,this),nr(r,pi.POINTERUP,this.handlePointerUp_,this),nr(this.element_,pi.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(nr(this.element_.getRootNode(),pi.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new Cu(pi.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Cu(pi.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ei(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Mn.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ei(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ei),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Nu={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Aa={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},dn={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function _r(t,e){if(!t)throw new Error(e)}const Qp=1/0;class a8{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,C_(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,r=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){_r(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=Qp?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,r=this.priorities_,i=n.length,a=n[e],o=r[e],c=e;for(;e<i>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),m=h<i&&r[h]<r[u]?h:u;n[e]=n[m],r[e]=r[m],e=m}n[e]=a,r[e]=o,this.siftDown_(c,e)}siftDown_(e,n){const r=this.elements_,i=this.priorities_,a=r[n],o=i[n];for(;n>e;){const c=this.getParentIndex_(n);if(i[c]>o)r[n]=r[c],i[n]=i[c],n=c;else break}r[n]=a,i[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,r=this.priorities_;let i=0;const a=n.length;let o,c,u;for(c=0;c<a;++c)o=n[c],u=e(o),u==Qp?delete this.queuedElements_[this.keyFunction_(o)]:(r[i]=u,n[i++]=o);n.length=i,r.length=i,this.heapify_()}}class l8 extends a8{constructor(e,n){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(Mn.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,r=n.getState();if(r===dn.LOADED||r===dn.ERROR||r===dn.EMPTY){r!==dn.ERROR&&n.removeEventListener(Mn.CHANGE,this.boundHandleTileChange_);const i=n.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let r=0;for(;this.tilesLoading_<e&&r<n&&this.getCount()>0;){const i=this.dequeue()[0],a=i.getKey();i.getState()===dn.IDLE&&!(a in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[a]=!0,++this.tilesLoading_,++r,i.load())}}}function o8(t,e,n,r,i){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return Qp;const a=t.viewState.center,o=r[0]-a[0],c=r[1]-a[1];return 65536*Math.log(i)+Math.sqrt(o*o+c*c)/i}const ka={ANIMATING:0,INTERACTING:1},Fo={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function Ur(t,e,n){return Math.min(Math.max(t,e),n)}function c8(t,e,n,r,i,a){const o=i-n,c=a-r;if(o!==0||c!==0){const u=((t-n)*o+(e-r)*c)/(o*o+c*c);u>1?(n=i,r=a):u>0&&(n+=o*u,r+=c*u)}return Lf(t,e,n,r)}function Lf(t,e,n,r){const i=n-t,a=r-e;return i*i+a*a}function d8(t){const e=t.length;for(let r=0;r<e;r++){let i=r,a=Math.abs(t[r][r]);for(let c=r+1;c<e;c++){const u=Math.abs(t[c][r]);u>a&&(a=u,i=c)}if(a===0)return null;const o=t[i];t[i]=t[r],t[r]=o;for(let c=r+1;c<e;c++){const u=-t[c][r]/t[r][r];for(let h=r;h<e+1;h++)r==h?t[c][h]=0:t[c][h]+=u*t[r][h]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}function OE(t){return t*180/Math.PI}function Wu(t){return t*Math.PI/180}function Pf(t,e){const n=t%e;return n*e<0?n+e:n}function oo(t,e,n){return t+n*(e-t)}function j1(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function Ax(t,e){return Math.floor(j1(t,e))}function kx(t,e){return Math.ceil(j1(t,e))}function e2(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}function wE(t,e,n){return(function(r,i,a,o,c){if(!r)return;if(!i&&!e)return r;const u=e?0:a[0]*i,h=e?0:a[1]*i,m=c?c[0]:0,_=c?c[1]:0;let p=t[0]+u/2+m,g=t[2]-u/2+m,C=t[1]+h/2+_,y=t[3]-h/2+_;p>g&&(p=(g+p)/2,g=p),C>y&&(C=(y+C)/2,y=C);let S=Ur(r[0],p,g),v=Ur(r[1],C,y);if(o&&n&&i){const k=30*i;S+=-k*Math.log(1+Math.max(0,p-r[0])/k)+k*Math.log(1+Math.max(0,r[0]-g)/k),v+=-k*Math.log(1+Math.max(0,C-r[1])/k)+k*Math.log(1+Math.max(0,r[1]-y)/k)}return[S,v]})}function u8(t){return t}const ha={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Yp(t){const e=yo();for(let n=0,r=t.length;n<r;++n)Ag(e,t[n]);return e}function mN(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function iI(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function aI(t,e,n){let r,i;return e<t[0]?r=t[0]-e:t[2]<e?r=e-t[2]:r=0,n<t[1]?i=t[1]-n:t[3]<n?i=n-t[3]:i=0,r*r+i*i}function om(t,e){return lI(t,e[0],e[1])}function Cg(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function lI(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function t2(t,e){const n=t[0],r=t[1],i=t[2],a=t[3],o=e[0],c=e[1];let u=ha.UNKNOWN;return o<n?u=u|ha.LEFT:o>i&&(u=u|ha.RIGHT),c<r?u=u|ha.BELOW:c>a&&(u=u|ha.ABOVE),u===ha.UNKNOWN&&(u=ha.INTERSECTING),u}function yo(){return[1/0,1/0,-1/0,-1/0]}function Vu(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function O1(t){return Vu(1/0,1/0,-1/0,-1/0,t)}function oI(t,e){const n=t[0],r=t[1];return Vu(n,r,n,r,e)}function gN(t,e,n,r,i){const a=O1(i);return cI(a,t,e,n,r)}function Xg(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function h8(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Ag(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function cI(t,e,n,r,i){for(;n<r;n+=i)f8(t,e[n],e[n+1]);return t}function f8(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function dI(t,e){let n;return n=e(w1(t)),n||(n=e(L1(t)),n)||(n=e(P1(t)),n)||(n=e(u0(t)),n)?n:!1}function s2(t){let e=0;return S_(t)||(e=hr(t)*Xa(t)),e}function w1(t){return[t[0],t[1]]}function L1(t){return[t[2],t[1]]}function Hh(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function m8(t,e){let n;if(e==="bottom-left")n=w1(t);else if(e==="bottom-right")n=L1(t);else if(e==="top-left")n=u0(t);else if(e==="top-right")n=P1(t);else throw new Error("Invalid corner");return n}function n2(t,e,n,r,i){const[a,o,c,u,h,m,_,p]=uI(t,e,n,r);return Vu(Math.min(a,c,h,_),Math.min(o,u,m,p),Math.max(a,c,h,_),Math.max(o,u,m,p),i)}function uI(t,e,n,r){const i=e*r[0]/2,a=e*r[1]/2,o=Math.cos(n),c=Math.sin(n),u=i*o,h=i*c,m=a*o,_=a*c,p=t[0],g=t[1];return[p-u+_,g-h-m,p-u-_,g-h+m,p+u-_,g+h+m,p+u+_,g+h-m,p-u+_,g-h-m]}function Xa(t){return t[3]-t[1]}function Kh(t,e,n){const r=n||yo();return Sl(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):O1(r),r}function u0(t){return[t[0],t[3]]}function P1(t){return[t[2],t[3]]}function hr(t){return t[2]-t[0]}function Sl(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function S_(t){return t[2]<t[0]||t[3]<t[1]}function g8(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function _8(t,e,n){let r=!1;const i=t2(t,e),a=t2(t,n);if(i===ha.INTERSECTING||a===ha.INTERSECTING)r=!0;else{const o=t[0],c=t[1],u=t[2],h=t[3],m=e[0],_=e[1],p=n[0],g=n[1],C=(g-_)/(p-m);let y,S;a&ha.ABOVE&&!(i&ha.ABOVE)&&(y=p-(g-h)/C,r=y>=o&&y<=u),!r&&a&ha.RIGHT&&!(i&ha.RIGHT)&&(S=g-(p-u)*C,r=S>=c&&S<=h),!r&&a&ha.BELOW&&!(i&ha.BELOW)&&(y=p-(g-c)/C,r=y>=o&&y<=u),!r&&a&ha.LEFT&&!(i&ha.LEFT)&&(S=g-(p-o)*C,r=S>=c&&S<=h)}return r}function hI(t,e){const n=e.getExtent(),r=Hh(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const i=hr(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}function fI(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];hI(t,e);const i=hr(r);if(hr(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function x8(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function Vp(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function _N(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,a=t[1]*n+t[0]*r;return t[0]=i,t[1]=a,t}function p8(t,e){return t[0]*=e,t[1]*=e,t}function mI(t,e){if(e.canWrapX()){const n=hr(e.getExtent()),r=gI(t,e,n);r&&(t[0]-=r*n)}return t}function gI(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||hr(r),i=Math.floor((t[0]-r[0])/n)),i}function y8(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),i=[(e[0]-t[0])/r,(e[1]-t[1])/r],a=[-i[1],i[0]],o=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),c=[(n[0]-t[0])/o,(n[1]-t[1])/o];let u=r===0||o===0?0:Math.acos(Ur(c[0]*i[0]+c[1]*i[1],-1,1));return u=Math.max(u,1e-5),c[0]*a[0]+c[1]*a[1]>0?u:Math.PI*2-u}function _I(t){return Math.pow(t,3)}function xm(t){return 1-_I(1-t)}function b8(t){return 3*t*t-2*t*t*t}function C8(t){return t}const N8=63710088e-1;function LE(t,e,n){n=n||N8;const r=Wu(t[1]),i=Wu(e[1]),a=(i-r)/2,o=Wu(e[0]-t[0])/2,c=Math.sin(a)*Math.sin(a)+Math.sin(o)*Math.sin(o)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))}function xI(...t){console.warn(...t)}const xN={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let A1=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||xN[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const v_=6378137,vf=Math.PI*v_,S8=[-vf,-vf,vf,vf],v8=[-180,-85,180,85],Ux=v_*Math.log(Math.tan(Math.PI/2));class tf extends A1{constructor(e){super({code:e,units:"m",extent:S8,global:!0,worldExtent:v8,getPointResolution:function(n,r){return n/Math.cosh(r[1]/v_)}})}}const PE=[new tf("EPSG:3857"),new tf("EPSG:102100"),new tf("EPSG:102113"),new tf("EPSG:900913"),new tf("http://www.opengis.net/def/crs/EPSG/0/3857"),new tf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function E8(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let a=0;a<i;a+=r){e[a]=vf*t[a]/180;let o=v_*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));o>Ux?o=Ux:o<-Ux&&(o=-Ux),e[a+1]=o}return e}function D8(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let a=0;a<i;a+=r)e[a]=180*t[a]/vf,e[a+1]=360*Math.atan(Math.exp(t[a+1]/v_))/Math.PI-90;return e}const R8=6378137,AE=[-180,-90,180,90],T8=Math.PI*R8/180;class ph extends A1{constructor(e,n){super({code:e,units:"degrees",extent:AE,axisOrientation:n,global:!0,metersPerUnit:T8,worldExtent:AE})}}const kE=[new ph("CRS:84"),new ph("EPSG:4326","neu"),new ph("urn:ogc:def:crs:OGC:1.3:CRS84"),new ph("urn:ogc:def:crs:OGC:2:84"),new ph("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ph("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ph("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let r2={};function _p(t){return r2[t]||r2[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function M8(t,e){r2[t]=e}let Af={};function qh(t,e,n){const r=t.getCode(),i=e.getCode();r in Af||(Af[r]={}),Af[r][i]=n}function xp(t,e){return t in Af&&e in Af[t]?Af[t][e]:null}const $p=.9996,_o=.00669438,k1=_o*_o,U1=k1*_o,Ih=_o/(1-_o),UE=Math.sqrt(1-_o),cm=(1-UE)/(1+UE),pI=cm*cm,pN=pI*cm,yN=pN*cm,yI=yN*cm,bI=1-_o/4-3*k1/64-5*U1/256,I8=3*_o/8+3*k1/32+45*U1/1024,j8=15*k1/256+45*U1/1024,O8=35*U1/3072,w8=3/2*cm-27/32*pN+269/512*yI,L8=21/16*pI-55/32*yN,P8=151/96*pN-417/128*yI,A8=1097/512*yN,zp=6378137;function k8(t,e,n){const r=t-5e5,o=(n.north?e:e-1e7)/$p/(zp*bI),c=o+w8*Math.sin(2*o)+L8*Math.sin(4*o)+P8*Math.sin(6*o)+A8*Math.sin(8*o),u=Math.sin(c),h=u*u,m=Math.cos(c),_=u/m,p=_*_,g=p*p,C=1-_o*h,y=Math.sqrt(1-_o*h),S=zp/y,v=(1-_o)/C,k=Ih*m**2,L=k*k,M=r/(S*$p),P=M*M,F=P*M,G=F*M,B=G*M,I=B*M,E=c-_/v*(P/2-G/24*(5+3*p+10*k-4*L-9*Ih))+I/720*(61+90*p+298*k+45*g-252*Ih-3*L);let A=(M-F/6*(1+2*p+k)+B/120*(5-2*k+28*p-3*L+8*Ih+24*g))/m;return A=e2(A+Wu(CI(n.number)),-Math.PI,Math.PI),[OE(A),OE(E)]}const BE=-80,GE=84,U8=-180,B8=180;function G8(t,e,n){t=e2(t,U8,B8),e<BE?e=BE:e>GE&&(e=GE);const r=Wu(e),i=Math.sin(r),a=Math.cos(r),o=i/a,c=o*o,u=c*c,h=Wu(t),m=CI(n.number),_=Wu(m),p=zp/Math.sqrt(1-_o*i**2),g=Ih*a**2,C=a*e2(h-_,-Math.PI,Math.PI),y=C*C,S=y*C,v=S*C,k=v*C,L=k*C,M=zp*(bI*r-I8*Math.sin(2*r)+j8*Math.sin(4*r)-O8*Math.sin(6*r)),P=$p*p*(C+S/6*(1-c+g)+k/120*(5-18*c+u+72*g-58*Ih))+5e5;let F=$p*(M+p*o*(y/2+v/24*(5-c+9*g+4*g**2)+L/720*(61-58*c+u+600*g-330*Ih)));return n.north||(F+=1e7),[P,F]}function CI(t){return(t-1)*6-180+3}const W8=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function NI(t){let e=0;for(const i of W8){const a=t.match(i);if(a){e=parseInt(a[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function WE(t,e){return function(n,r,i,a){const o=n.length;i=i>1?i:2,a=a??i,r||(i>2?r=n.slice():r=new Array(o));for(let c=0;c<o;c+=a){const u=n[c],h=n[c+1],m=t(u,h,e);r[c]=m[0],r[c+1]=m[1]}return r}}function F8(t){return NI(t)?new A1({code:t,units:"m"}):null}function K8(t){const e=NI(t.getCode());return e?{forward:WE(G8,e),inverse:WE(k8,e)}:null}const Q8=[K8],Y8=[F8];let i2=!0;function SI(t){i2=!1}function bN(t,e){if(e!==void 0){for(let n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function Hp(t){M8(t.getCode(),t),qh(t,t,bN)}function V8(t){t.forEach(Hp)}function Ta(t){if(typeof t!="string")return t;const e=_p(t);if(e)return e;for(const n of Y8){const r=n(t);if(r)return r}return null}function FE(t,e,n,r){t=Ta(t);let i;const a=t.getPointResolutionFunc();if(a)i=a(e,n);else{const o=t.getUnits();if(o=="degrees"&&!r||r=="degrees")i=e;else{const c=NN(t,Ta("EPSG:4326"));if(!c&&o!=="degrees")i=e*t.getMetersPerUnit();else{let h=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];h=c(h,h,2);const m=LE(h.slice(0,2),h.slice(2,4)),_=LE(h.slice(4,6),h.slice(6,8));i=(m+_)/2}const u=t.getMetersPerUnit();u!==void 0&&(i/=u)}}return i}function a2(t){V8(t),t.forEach(function(e){t.forEach(function(n){e!==n&&qh(e,n,bN)})})}function $8(t,e,n,r){t.forEach(function(i){e.forEach(function(a){qh(i,a,n),qh(a,i,r)})})}function CN(t,e){return t?typeof t=="string"?Ta(t):t:Ta(e)}function l2(t){return(function(e,n,r,i){const a=e.length;r=r!==void 0?r:2,i=i??r,n=n!==void 0?n:new Array(a);for(let o=0;o<a;o+=i){const c=t(e.slice(o,o+r)),u=c.length;for(let h=0,m=i;h<m;++h)n[o+h]=h>=u?e[o+h]:c[h]}return n})}function z8(t,e,n,r){const i=Ta(t),a=Ta(e);qh(i,a,l2(n)),qh(a,i,l2(r))}function da(t,e){return SI(),SN(t,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function pp(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||NN(t,e)===bN)&&n}function NN(t,e){const n=t.getCode(),r=e.getCode();let i=xp(n,r);if(i)return i;let a=null,o=null;for(const u of Q8)a||(a=u(t)),o||(o=u(e));if(!a&&!o)return null;const c="EPSG:4326";if(o)if(a)i=Ib(a.inverse,o.forward);else{const u=xp(n,c);u&&(i=Ib(u,o.forward))}else{const u=xp(c,r);u&&(i=Ib(a.inverse,u))}return i&&(Hp(t),Hp(e),qh(t,e,i)),i}function Ib(t,e){return function(n,r,i,a){return r=t(n,r,i,a),e(r,r,i,a)}}function qp(t,e){const n=Ta(t),r=Ta(e);return NN(n,r)}function SN(t,e,n){const r=qp(e,n);if(!r){const i=Ta(e).getCode(),a=Ta(n).getCode();throw new Error(`No transform available between ${i} and ${a}`)}return r(t,void 0,t.length)}function o2(t,e){return t}function ud(t,e){return i2&&!Vp(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(i2=!1,xI("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function vI(t,e){return t}function Lu(t,e){return t}function KE(t,e,n){return function(r){let i,a;if(t.canWrapX()){const o=t.getExtent(),c=hr(o);r=r.slice(0),a=gI(r,t,c),a&&(r[0]=r[0]-a*c),r[0]=Ur(r[0],o[0],o[2]),r[1]=Ur(r[1],o[1],o[3]),i=n(r)}else i=n(r);return a&&e.canWrapX()&&(i[0]+=a*hr(e.getExtent())),i}}function H8(){a2(PE),a2(kE),$8(kE,PE,E8,D8)}H8();new Array(6);function Xo(){return[1,0,0,1,0,0]}function q8(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function fa(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function Dd(t,e,n,r,i,a,o,c){const u=Math.sin(a),h=Math.cos(a);return t[0]=r*h,t[1]=i*u,t[2]=-r*u,t[3]=i*h,t[4]=o*r*h-c*r*u+e,t[5]=o*i*u+c*i*h+n,t}function EI(t,e){const n=X8(e);_r(n!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],a=e[2],o=e[3],c=e[4],u=e[5];return t[0]=o/n,t[1]=-i/n,t[2]=-a/n,t[3]=r/n,t[4]=(a*u-o*c)/n,t[5]=-(r*u-i*c)/n,t}function X8(t){return t[0]*t[3]-t[1]*t[2]}const J8=[1e5,1e5,1e5,1e5,2,2];function Z8(t){return"matrix("+t.join(", ")+")"}function c2(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function ek(t,e){const n=c2(t),r=c2(e);for(let i=0;i<6;++i)if(Math.round((n[i]-r[i])*J8[i])!==0)return!1;return!0}function Fu(t,e,n,r,i,a,o){a=a||[],o=o||2;let c=0;for(let u=e;u<n;u+=r){const h=t[u],m=t[u+1];a[c++]=i[0]*h+i[2]*m+i[4],a[c++]=i[1]*h+i[3]*m+i[5];for(let _=2;_<o;_++)a[c++]=t[u+_]}return a&&a.length!=c&&(a.length=c),a}function DI(t,e,n,r,i,a,o){o=o||[];const c=Math.cos(i),u=Math.sin(i),h=a[0],m=a[1];let _=0;for(let p=e;p<n;p+=r){const g=t[p]-h,C=t[p+1]-m;o[_++]=h+g*c-C*u,o[_++]=m+g*u+C*c;for(let y=p+2;y<p+r;++y)o[_++]=t[y]}return o&&o.length!=_&&(o.length=_),o}function tk(t,e,n,r,i,a,o,c){c=c||[];const u=o[0],h=o[1];let m=0;for(let _=e;_<n;_+=r){const p=t[_]-u,g=t[_+1]-h;c[m++]=u+i*p,c[m++]=h+a*g;for(let C=_+2;C<_+r;++C)c[m++]=t[C]}return c&&c.length!=m&&(c.length=m),c}function sk(t,e,n,r,i,a,o){o=o||[];let c=0;for(let u=e;u<n;u+=r){o[c++]=t[u]+i,o[c++]=t[u+1]+a;for(let h=u+2;h<u+r;++h)o[c++]=t[h]}return o&&o.length!=c&&(o.length=c),o}const QE=Xo(),nk=[NaN,NaN];class rk extends kc{constructor(){super(),this.extent_=yo(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=tI((e,n,r)=>{if(!r)return this.getSimplifiedGeometry(n);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return sr()}closestPointXY(e,n,r,i){return sr()}containsXY(e,n){return this.closestPointXY(e,n,nk,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return sr()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&O1(n),this.extentRevision_=this.getRevision()}return g8(this.extent_,e)}rotate(e,n){sr()}scale(e,n,r){sr()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return sr()}getType(){return sr()}applyTransform(e){sr()}intersectsExtent(e){return sr()}translate(e,n){sr()}transform(e,n){const r=Ta(e),i=r.getUnits()=="tile-pixels"?function(a,o,c){const u=r.getExtent(),h=r.getWorldExtent(),m=Xa(h)/Xa(u);Dd(QE,h[0],h[3],m,-m,0,0,0);const _=Fu(a,0,a.length,c,QE,o),p=qp(r,n);return p?p(_,_,c):_}:qp(r,n);return this.applyTransform(i),this}}class vN extends rk{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return gN(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return sr()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=YE(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){sr()}setLayout(e,n,r){let i;if(e)i=YE(e);else{for(let a=0;a<r;++a){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}i=n.length,e=ik(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();DI(r,0,r.length,i,e,n,r),this.changed()}}scale(e,n,r){n===void 0&&(n=e),r||(r=Hh(this.getExtent()));const i=this.getFlatCoordinates();if(i){const a=this.getStride();tk(i,0,i.length,a,e,n,r,i),this.changed()}}translate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();sk(r,0,r.length,i,e,n,r),this.changed()}}}function ik(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function YE(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function ak(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return Fu(r,0,r.length,i,e,n)}function RI(t,e,n,r){let i=0;const a=t[n-r],o=t[n-r+1];let c=0,u=0;for(;e<n;e+=r){const h=t[e]-a,m=t[e+1]-o;i+=u*h-c*m,c=h,u=m}return i/2}function lk(t,e,n,r){let i=0;for(let a=0,o=n.length;a<o;++a){const c=n[a];i+=RI(t,e,c,r),e=c}return i}function VE(t,e,n,r,i,a,o){const c=t[e],u=t[e+1],h=t[n]-c,m=t[n+1]-u;let _;if(h===0&&m===0)_=e;else{const p=((i-c)*h+(a-u)*m)/(h*h+m*m);if(p>1)_=n;else if(p>0){for(let g=0;g<r;++g)o[g]=oo(t[e+g],t[n+g],p);o.length=r;return}else _=e}for(let p=0;p<r;++p)o[p]=t[_+p];o.length=r}function TI(t,e,n,r,i){let a=t[e],o=t[e+1];for(e+=r;e<n;e+=r){const c=t[e],u=t[e+1],h=Lf(a,o,c,u);h>i&&(i=h),a=c,o=u}return i}function ok(t,e,n,r,i){for(let a=0,o=n.length;a<o;++a){const c=n[a];i=TI(t,e,c,r,i),e=c}return i}function MI(t,e,n,r,i,a,o,c,u,h,m){if(e==n)return h;let _,p;if(i===0){if(p=Lf(o,c,t[e],t[e+1]),p<h){for(_=0;_<r;++_)u[_]=t[e+_];return u.length=r,p}return h}m=m||[NaN,NaN];let g=e+r;for(;g<n;)if(VE(t,g-r,g,r,o,c,m),p=Lf(o,c,m[0],m[1]),p<h){for(h=p,_=0;_<r;++_)u[_]=m[_];u.length=r,g+=r}else g+=r*Math.max((Math.sqrt(p)-Math.sqrt(h))/i|0,1);if(VE(t,n-r,e,r,o,c,m),p=Lf(o,c,m[0],m[1]),p<h){for(h=p,_=0;_<r;++_)u[_]=m[_];u.length=r}return h}function ck(t,e,n,r,i,a,o,c,u,h,m){m=m||[NaN,NaN];for(let _=0,p=n.length;_<p;++_){const g=n[_];h=MI(t,e,g,r,i,a,o,c,u,h,m),e=g}return h}function dk(t,e,n,r){for(let i=0,a=n.length;i<a;++i)t[e++]=n[i];return e}function II(t,e,n,r){for(let i=0,a=n.length;i<a;++i){const o=n[i];for(let c=0;c<r;++c)t[e++]=o[c]}return e}function uk(t,e,n,r,i){i=i||[];let a=0;for(let o=0,c=n.length;o<c;++o){const u=II(t,e,n[o],r);i[a++]=u,e=u}return i.length=a,i}function Ef(t,e,n,r,i){i=i!==void 0?i:[];let a=0;for(let o=e;o<n;o+=r)i[a++]=t.slice(o,o+r);return i.length=a,i}function Xp(t,e,n,r,i){i=i!==void 0?i:[];let a=0;for(let o=0,c=n.length;o<c;++o){const u=n[o];i[a++]=Ef(t,e,u,r,i[a]),e=u}return i.length=a,i}function $E(t,e,n,r,i){i=i!==void 0?i:[];let a=0;for(let o=0,c=n.length;o<c;++o){const u=n[o];i[a++]=u.length===1&&u[0]===e?[]:Xp(t,e,u,r,i[a]),e=u[u.length-1]}return i.length=a,i}function EN(t,e,n,r,i,a,o){const c=(n-e)/r;if(c<3){for(;e<n;e+=r)a[o++]=t[e],a[o++]=t[e+1];return o}const u=new Array(c);u[0]=1,u[c-1]=1;const h=[e,n-r];let m=0;for(;h.length>0;){const _=h.pop(),p=h.pop();let g=0;const C=t[p],y=t[p+1],S=t[_],v=t[_+1];for(let k=p+r;k<_;k+=r){const L=t[k],M=t[k+1],P=c8(L,M,C,y,S,v);P>g&&(m=k,g=P)}g>i&&(u[(m-e)/r]=1,p+r<m&&h.push(p,m),m+r<_&&h.push(m,_))}for(let _=0;_<c;++_)u[_]&&(a[o++]=t[e+_*r],a[o++]=t[e+_*r+1]);return o}function hk(t,e,n,r,i,a,o,c){for(let u=0,h=n.length;u<h;++u){const m=n[u];o=EN(t,e,m,r,i,a,o),c.push(o),e=m}return o}function Nh(t,e){return e*Math.round(t/e)}function fk(t,e,n,r,i,a,o){if(e==n)return o;let c=Nh(t[e],i),u=Nh(t[e+1],i);e+=r,a[o++]=c,a[o++]=u;let h,m;do if(h=Nh(t[e],i),m=Nh(t[e+1],i),e+=r,e==n)return a[o++]=h,a[o++]=m,o;while(h==c&&m==u);for(;e<n;){const _=Nh(t[e],i),p=Nh(t[e+1],i);if(e+=r,_==h&&p==m)continue;const g=h-c,C=m-u,y=_-c,S=p-u;if(g*S==C*y&&(g<0&&y<g||g==y||g>0&&y>g)&&(C<0&&S<C||C==S||C>0&&S>C)){h=_,m=p;continue}a[o++]=h,a[o++]=m,c=h,u=m,h=_,m=p}return a[o++]=h,a[o++]=m,o}function jI(t,e,n,r,i,a,o,c){for(let u=0,h=n.length;u<h;++u){const m=n[u];o=fk(t,e,m,r,i,a,o),c.push(o),e=m}return o}class Jg extends vN{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new Jg(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,r,i){return i<aI(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(TI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),MI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,r,i))}getArea(){return RI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ef(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=EN(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new Jg(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=II(this.flatCoordinates,0,e,this.stride),this.changed()}}let Sh=class OI extends vN{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new OI(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const a=this.flatCoordinates,o=Lf(e,n,a[0],a[1]);if(o<i){const c=this.stride;for(let u=0;u<c;++u)r[u]=a[u];return r.length=c,o}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return oI(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return lI(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=dk(this.flatCoordinates,0,e,this.stride),this.changed()}};function mk(t,e,n,r,i){return!dI(i,function(o){return!jh(t,e,n,r,o[0],o[1])})}function jh(t,e,n,r,i,a){let o=0,c=t[n-r],u=t[n-r+1];for(;e<n;e+=r){const h=t[e],m=t[e+1];u<=a?m>a&&(h-c)*(a-u)-(i-c)*(m-u)>0&&o++:m<=a&&(h-c)*(a-u)-(i-c)*(m-u)<0&&o--,c=h,u=m}return o!==0}function wI(t,e,n,r,i,a){if(n.length===0||!jh(t,e,n[0],r,i,a))return!1;for(let o=1,c=n.length;o<c;++o)if(jh(t,n[o-1],n[o],r,i,a))return!1;return!0}function DN(t,e,n,r,i,a,o){let c,u,h,m,_,p,g;const C=i[a+1],y=[];for(let k=0,L=n.length;k<L;++k){const M=n[k];for(m=t[M-r],p=t[M-r+1],c=e;c<M;c+=r)_=t[c],g=t[c+1],(C<=p&&g<=C||p<=C&&C<=g)&&(h=(C-p)/(g-p)*(_-m)+m,y.push(h)),m=_,p=g}let S=NaN,v=-1/0;for(y.sort(yd),m=y[0],c=1,u=y.length;c<u;++c){_=y[c];const k=Math.abs(_-m);k>v&&(h=(m+_)/2,wI(t,e,n,r,h,C)&&(S=h,v=k)),m=_}return isNaN(S)&&(S=i[a]),o?(o.push(S,C,v),o):[S,C,v]}function gk(t,e,n,r,i){let a=[];for(let o=0,c=n.length;o<c;++o){const u=n[o];a=DN(t,e,u,r,i,2*o,a),e=u[u.length-1]}return a}function _k(t,e,n,r,i){let a;for(e+=r;e<n;e+=r)if(a=i(t.slice(e-r,e),t.slice(e,e+r)),a)return a;return!1}function LI(t,e,n,r,i,a){return a=a??cI(yo(),t,e,n,r),Sl(i,a)?a[0]>=i[0]&&a[2]<=i[2]||a[1]>=i[1]&&a[3]<=i[3]?!0:_k(t,e,n,r,function(o,c){return _8(i,o,c)}):!1}function PI(t,e,n,r,i){return!!(LI(t,e,n,r,i)||jh(t,e,n,r,i[0],i[1])||jh(t,e,n,r,i[0],i[3])||jh(t,e,n,r,i[2],i[1])||jh(t,e,n,r,i[2],i[3]))}function xk(t,e,n,r,i){if(!PI(t,e,n[0],r,i))return!1;if(n.length===1)return!0;for(let a=1,o=n.length;a<o;++a)if(mk(t,n[a-1],n[a],r,i)&&!LI(t,n[a-1],n[a],r,i))return!1;return!0}function pk(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const a=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=a}e+=r,n-=r}}function RN(t,e,n,r){let i=0,a=t[n-r],o=t[n-r+1];for(;e<n;e+=r){const c=t[e],u=t[e+1];i+=(c-a)*(u+o),a=c,o=u}return i===0?void 0:i>0}function yk(t,e,n,r,i){i=i!==void 0?i:!1;for(let a=0,o=n.length;a<o;++a){const c=n[a],u=RN(t,e,c,r);if(a===0){if(i&&u||!i&&!u)return!1}else if(i&&!u||!i&&u)return!1;e=c}return!0}function zE(t,e,n,r,i){i=i!==void 0?i:!1;for(let a=0,o=n.length;a<o;++a){const c=n[a],u=RN(t,e,c,r);(a===0?i&&u||!i&&!u:i&&!u||!i&&u)&&pk(t,e,c,r),e=c}return e}function bk(t,e){const n=[];let r=0,i=0,a;for(let o=0,c=e.length;o<c;++o){const u=e[o],h=RN(t,r,u,2);if(a===void 0&&(a=h),h===a)n.push(e.slice(i,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[i])}i=o+1,r=u}return n}class Zg extends vN{constructor(e,n,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&r?(this.setFlatCoordinates(n,e),this.ends_=r):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?fN(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Zg(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<aI(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ok(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ck(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return wI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return lk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),zE(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,Xp(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Hh(this.getExtent());this.flatInteriorPoint_=DN(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Sh(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Jg(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,r=this.ends_,i=[];let a=0;for(let o=0,c=r.length;o<c;++o){const u=r[o],h=new Jg(n.slice(a,u),e);i.push(h),a=u}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;yk(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=zE(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=jI(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,r),new Zg(n,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return xk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=uk(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function HE(t){if(S_(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],a=[e,n,e,i,r,i,r,n,e,n];return new Zg(a,"XY",[a.length])}function TN(t,e,n,r){const i=hr(e)/n[0],a=Xa(e)/n[1];return r?Math.min(t,Math.max(i,a)):Math.min(t,Math.min(i,a))}function MN(t,e,n){let r=Math.min(t,e);const i=50;return r*=Math.log(1+i*Math.max(0,t/e-1))/i+1,n&&(r=Math.max(r,n),r/=Math.log(1+i*Math.max(0,n/t-1))/i+1),Ur(r,n/2,e*2)}function Ck(t,e,n,r){return e=e!==void 0?e:!0,(function(i,a,o,c){if(i!==void 0){const u=t[0],h=t[t.length-1],m=n?TN(u,n,o,r):u;if(c)return e?MN(i,m,h):Ur(i,h,m);const _=Math.min(m,i),p=Math.floor(hN(t,_,a));return t[p]>m&&p<t.length-1?t[p+1]:t[p]}})}function Nk(t,e,n,r,i,a){return r=r!==void 0?r:!0,n=n!==void 0?n:0,(function(o,c,u,h){if(o!==void 0){const m=i?TN(e,i,u,a):e;if(h)return r?MN(o,m,n):Ur(o,n,m);const _=1e-9,p=Math.ceil(Math.log(e/m)/Math.log(t)-_),g=-c*(.5-_)+.5,C=Math.min(m,o),y=Math.floor(Math.log(e/C)/Math.log(t)+g),S=Math.max(p,y),v=e/Math.pow(t,S);return Ur(v,n,m)}})}function qE(t,e,n,r,i){return n=n!==void 0?n:!0,(function(a,o,c,u){if(a!==void 0){const h=r?TN(t,r,c,i):t;return!n||!u?Ur(a,e,h):MN(a,h,e)}})}function IN(t){if(t!==void 0)return 0}function XE(t){if(t!==void 0)return t}function Sk(t){const e=2*Math.PI/t;return(function(n,r){if(r)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n})}function vk(t){const e=Wu(5);return(function(n,r){return r||n===void 0?n:Math.abs(n)<=e?0:n})}const Ek=42,jN=256,jb=0;class zo extends kc{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=CN(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&SI(),e.center&&(e.center=ud(e.center,this.projection_)),e.extent&&(e.extent=Lu(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const c in Fo)delete n[c];this.setProperties(n,!0);const r=Rk(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=Dk(e),a=r.constraint,o=Tk(e);this.constraints_={center:i,resolution:a,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];n=n||[0,0,0,0];const a=this.getResolution(),o=a/2*(i[3]-n[3]+n[1]-i[1]),c=a/2*(i[0]-n[0]+n[2]-i[2]);this.setCenterInternal([r[0]+o,r[1]-c])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let r=0;r<n.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=ud(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=ud(i.anchor,this.getProjection())),n[r]=i}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const m=arguments[i];m.center&&this.setCenterInternal(m.center),m.zoom!==void 0?this.setZoom(m.zoom):m.resolution&&this.setResolution(m.resolution),m.rotation!==void 0&&this.setRotation(m.rotation)}if(i===n){r&&Bx(r,!0);return}let a=Date.now(),o=this.targetCenter_.slice(),c=this.targetResolution_,u=this.targetRotation_;const h=[];for(;i<n;++i){const m=arguments[i],_={start:a,complete:!1,anchor:m.anchor,duration:m.duration!==void 0?m.duration:1e3,easing:m.easing||b8,callback:r};if(m.center&&(_.sourceCenter=o,_.targetCenter=m.center.slice(),o=_.targetCenter),m.zoom!==void 0?(_.sourceResolution=c,_.targetResolution=this.getResolutionForZoom(m.zoom),c=_.targetResolution):m.resolution&&(_.sourceResolution=c,_.targetResolution=m.resolution,c=_.targetResolution),m.rotation!==void 0){_.sourceRotation=u;const p=Pf(m.rotation-u+Math.PI,2*Math.PI)-Math.PI;_.targetRotation=u+p,u=_.targetRotation}Mk(_)?_.complete=!0:a+=_.duration,h.push(_)}this.animations_.push(h),this.setHint(ka.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ka.ANIMATING]>0}getInteracting(){return this.hints_[ka.INTERACTING]>0}cancelAnimations(){this.setHint(ka.ANIMATING,-this.hints_[ka.ANIMATING]);let e;for(let n=0,r=this.animations_.length;n<r;++n){const i=this.animations_[n];if(i[0].callback&&Bx(i[0].callback,!1),!e)for(let a=0,o=i.length;a<o;++a){const c=i[a];if(!c.complete){e=c.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let a=!0;for(let o=0,c=i.length;o<c;++o){const u=i[o];if(u.complete)continue;const h=e-u.start;let m=u.duration>0?h/u.duration:1;m>=1?(u.complete=!0,m=1):a=!1;const _=u.easing(m);if(u.sourceCenter){const p=u.sourceCenter[0],g=u.sourceCenter[1],C=u.targetCenter[0],y=u.targetCenter[1];this.nextCenter_=u.targetCenter;const S=p+_*(C-p),v=g+_*(y-g);this.targetCenter_=[S,v]}if(u.sourceResolution&&u.targetResolution){const p=_===1?u.targetResolution:u.sourceResolution+_*(u.targetResolution-u.sourceResolution);if(u.anchor){const g=this.getViewportSize_(this.getRotation()),C=this.constraints_.resolution(p,0,g,!0);this.targetCenter_=this.calculateCenterZoom(C,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=p,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const p=_===1?Pf(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+_*(u.targetRotation-u.sourceRotation);if(u.anchor){const g=this.constraints_.rotation(p,!0);this.targetCenter_=this.calculateCenterRotate(g,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=p}if(this.applyTargetState_(!0),n=!0,!u.complete)break}if(a){this.animations_[r]=null,this.setHint(ka.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=i[0].callback;o&&Bx(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-n[0],i[1]-n[1]],_N(r,e-this.getRotation()),x8(r,n)),r}calculateCenterZoom(e,n){let r;const i=this.getCenterInternal(),a=this.getResolution();if(i!==void 0&&a!==void 0){const o=n[0]-e*(n[0]-i[0])/a,c=n[1]-e*(n[1]-i[1])/a;r=[o,c]}return r}getViewportSize_(e){const n=this.viewportSize_;if(e){const r=n[0],i=n[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&o2(e,this.getProjection())}getCenterInternal(){return this.get(Fo.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return vI(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();_r(n,"The view center is not defined");const r=this.getResolution();_r(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return _r(i!==void 0,"The view rotation is not defined"),n2(n,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Fo.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(Lu(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const r=hr(e)/n[0],i=Xa(e)/n[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return(function(a){return n/Math.pow(e,a*i)})}getRotation(){return this.get(Fo.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,a=Math.log(r/i)/n;return(function(o){return Math.log(r/o)/n/a})}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const a=this.padding_;if(a){const o=this.getViewportSizeMinusPadding_();i=Ob(i,this.getViewportSize_(),[o[0]/2+a[3],o[1]/2+a[0]],n,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,r,i;if(this.resolutions_){const a=hN(this.resolutions_,e,1);n=a,r=this.resolutions_[a],a==this.resolutions_.length-1?i=2:i=r/this.resolutions_[a+1]}else r=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){var n;if((n=this.resolutions_)!=null&&n.length){if(this.resolutions_.length===1)return this.resolutions_[0];const r=Ur(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[r]/this.resolutions_[r+1];return this.resolutions_[r]/Math.pow(i,Ur(e-r,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let r;if(_r(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){_r(!S_(e),"Cannot fit empty extent provided as `geometry`");const i=Lu(e,this.getProjection());r=HE(i)}else if(e.getType()==="Circle"){const i=Lu(e.getExtent(),this.getProjection());r=HE(i),r.rotate(this.getRotation(),Hh(i))}else r=e;this.fitInternal(r,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),r=Math.cos(n),i=Math.sin(-n),a=e.getFlatCoordinates(),o=e.getStride();let c=1/0,u=1/0,h=-1/0,m=-1/0;for(let _=0,p=a.length;_<p;_+=o){const g=a[_]*r-a[_+1]*i,C=a[_]*i+a[_+1]*r;c=Math.min(c,g),u=Math.min(u,C),h=Math.max(h,g),m=Math.max(m,C)}return[c,u,h,m]}fitInternal(e,n){n=n||{};let r=n.size;r||(r=this.getViewportSizeMinusPadding_());const i=n.padding!==void 0?n.padding:[0,0,0,0],a=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const c=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(c,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,a?0:1);const h=this.getRotation(),m=Math.sin(h),_=Math.cos(h),p=Hh(c);p[0]+=(i[1]-i[3])/2*u,p[1]+=(i[0]-i[2])/2*u;const g=p[0]*_-p[1]*m,C=p[1]*_+p[0]*m,y=this.getConstrainedCenter([g,C],u),S=n.callback?n.callback:qg;n.duration!==void 0?this.animateInternal({resolution:u,center:y,duration:n.duration,easing:n.easing},S):(this.targetResolution_=u,this.targetCenter_=y,this.applyTargetState_(!1,!0),Bx(S,!0))}centerOn(e,n,r){this.centerOnInternal(ud(e,this.getProjection()),n,r)}centerOnInternal(e,n,r){this.setCenterInternal(Ob(e,n,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,r,i){let a;const o=this.padding_;if(o&&e){const c=this.getViewportSizeMinusPadding_(-r),u=Ob(e,i,[c[0]/2+o[3],c[1]/2+o[0]],n,r);a=[e[0]-u[0],e[1]-u[1]]}return a}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=o2(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&ud(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*e,0,i,r);n&&(this.targetCenter_=this.calculateCenterZoom(a,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=ud(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);n&&(this.targetCenter_=this.calculateCenterRotate(i,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&ud(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const r=this.getAnimating()||this.getInteracting()||n,i=this.constraints_.rotation(this.targetRotation_,r),a=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,a,r),c=this.constraints_.center(this.targetCenter_,o,a,r,this.calculateCenterShift(this.targetCenter_,o,i,a));this.get(Fo.ROTATION)!==i&&this.set(Fo.ROTATION,i),this.get(Fo.RESOLUTION)!==o&&(this.set(Fo.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!c||!this.get(Fo.CENTER)||!Vp(this.get(Fo.CENTER),c))&&this.set(Fo.CENTER,c),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,r){e=e!==void 0?e:200;const i=n||0,a=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(a),c=this.constraints_.resolution(this.targetResolution_,i,o),u=this.constraints_.center(this.targetCenter_,c,o,!1,this.calculateCenterShift(this.targetCenter_,c,a,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=c,this.targetRotation_=a,this.targetCenter_=u,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==c||this.getRotation()!==a||!this.getCenterInternal()||!Vp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:a,center:u,resolution:c,duration:e,easing:xm,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ka.INTERACTING,1)}endInteraction(e,n,r){r=r&&ud(r,this.getProjection()),this.endInteractionInternal(e,n,r)}endInteractionInternal(e,n,r){this.getInteracting()&&(this.setHint(ka.INTERACTING,-1),this.resolveConstraints(e,n,r))}getConstrainedCenter(e,n){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),r)}getConstrainedZoom(e,n){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,n))}getConstrainedResolution(e,n){n=n||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,r)}}function Bx(t,e){setTimeout(function(){t(e)},0)}function Dk(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return wE(t.extent,t.constrainOnlyCenter,n)}const e=CN(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,wE(n,!1,!1)}return u8}function Rk(t){let e,n,r,o=t.minZoom!==void 0?t.minZoom:jb,c=t.maxZoom!==void 0?t.maxZoom:28;const u=t.zoomFactor!==void 0?t.zoomFactor:2,h=t.multiWorld!==void 0?t.multiWorld:!1,m=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,_=t.showFullExtent!==void 0?t.showFullExtent:!1,p=CN(t.projection,"EPSG:3857"),g=p.getExtent();let C=t.constrainOnlyCenter,y=t.extent;if(!h&&!y&&p.isGlobal()&&(C=!1,y=g),t.resolutions!==void 0){const S=t.resolutions;n=S[o],r=S[c]!==void 0?S[c]:S[S.length-1],t.constrainResolution?e=Ck(S,m,!C&&y,_):e=qE(n,r,m,!C&&y,_)}else{const v=(g?Math.max(hr(g),Xa(g)):360*xN.degrees/p.getMetersPerUnit())/jN/Math.pow(2,jb),k=v/Math.pow(2,28-jb);n=t.maxResolution,n!==void 0?o=0:n=v/Math.pow(u,o),r=t.minResolution,r===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?r=n/Math.pow(u,c):r=v/Math.pow(u,c):r=k),c=o+Math.floor(Math.log(n/r)/Math.log(u)),r=n/Math.pow(u,c-o),t.constrainResolution?e=Nk(u,n,r,m,!C&&y,_):e=qE(n,r,m,!C&&y,_)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:o,zoomFactor:u}}function Tk(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?vk():n===!1?XE:typeof n=="number"?Sk(n):XE}return IN}function Mk(t){return!(t.sourceCenter&&t.targetCenter&&!Vp(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function Ob(t,e,n,r,i){const a=Math.cos(-i);let o=Math.sin(-i),c=t[0]*a-t[1]*o,u=t[1]*a+t[0]*o;c+=(e[0]/2-n[0])*r,u+=(n[1]-e[1]/2)*r,o=-o;const h=c*a-u*o,m=u*a+c*o;return[h,m]}const Gx="ol-hidden",B1="ol-unselectable",ON="ol-control",JE="ol-collapsed",Ik=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),ZE=["style","variant","weight","size","lineHeight","family"],d2={normal:400,bold:700},u2=function(t){const e=t.match(Ik);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=ZE.length;r<i;++r){const a=e[r+1];a!==void 0&&(n[ZE[r]]=typeof a=="string"?a.trim():a)}return isNaN(Number(n.weight))&&n.weight in d2&&(n.weight=d2[n.weight]),n.families=n.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),n};function Ui(t,e,n,r){let i;return n&&n.length?i=n.shift():ho?i=new class extends OffscreenCanvas{constructor(){super(...arguments);dr(this,"style",{})}}(t??300,e??150):i=document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let wb;function Jp(){return wb||(wb=Ui(1,1)),wb}function G1(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function eD(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function jk(t){for(;t.lastChild;)t.lastChild.remove()}function Ok(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],a=e[r];if(!i&&!a)break;if(i!==a){if(!i){t.appendChild(a);continue}if(!a){t.removeChild(i),--r;continue}t.insertBefore(a,i)}}}function AI(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,n,r){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,r)}})}function Pu(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}class wN extends kc{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var n;this.map_&&((n=this.element)==null||n.remove());for(let r=0,i=this.listenerKeys.length;r<i;++r)ei(this.listenerKeys[r]);if(this.listenerKeys.length=0,this.map_=e,e){const r=this.target_??e.getOverlayContainerStopEvent();this.element&&r.appendChild(this.element),this.render!==qg&&this.listenerKeys.push(nr(e,Nu.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class wk extends wN{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:n+"-expand",a=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof a=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a,this.collapseLabel_.className=o):this.collapseLabel_=a;const c=e.label!==void 0?e.label:"i";typeof c=="string"?(this.label_=document.createElement("span"),this.label_.textContent=c,this.label_.className=i):this.label_=c;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Mn.CLICK,this.handleClick_.bind(this),!1);const h=n+" "+B1+" "+ON+(this.collapsed_&&this.collapsible_?" "+JE:"")+(this.collapsible_?"":" ol-uncollapsible"),m=this.element;m.className=h,m.appendChild(this.toggleButton_),m.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),r=new Set(n.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!n.some(a=>{var o;return((o=a.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(i=>Z6(()=>i))),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Ju(n,this.renderedAttributions_)){jk(this.ulElement_);for(let i=0,a=n.length;i<a;++i){const o=document.createElement("li");o.innerHTML=n[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(JE),this.collapsed_?eD(this.collapseLabel_,this.label_):eD(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class Lk extends wN{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const a=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=a,o.appendChild(this.label_),o.addEventListener(Mn.CLICK,this.handleClick_.bind(this),!1);const c=n+" "+B1+" "+ON,u=this.element;u.className=c,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Gx)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:xm}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const r=n.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const a=this.element.classList.contains(Gx);!a&&r===0?this.element.classList.add(Gx):a&&r!==0&&this.element.classList.remove(Gx)}this.label_.style.transform=i}this.rotation_=r}}class Pk extends wN{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",a=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",c=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",m=document.createElement("button");m.className=i,m.setAttribute("type","button"),m.title=u,m.appendChild(typeof o=="string"?document.createTextNode(o):o),m.addEventListener(Mn.CLICK,this.handleClick_.bind(this,r),!1);const _=document.createElement("button");_.className=a,_.setAttribute("type","button"),_.title=h,_.appendChild(typeof c=="string"?document.createTextNode(c):c),_.addEventListener(Mn.CLICK,this.handleClick_.bind(this,-r),!1);const p=n+" "+B1+" "+ON,g=this.element;g.className=p,g.appendChild(m),g.appendChild(_),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const a=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:a,duration:this.duration_,easing:xm})):r.setZoom(a)}}}function Ak(t){t=t||{};const e=new uo;return(t.zoom!==void 0?t.zoom:!0)&&e.push(new Pk(t.zoomOptions)),(t.rotate!==void 0?t.rotate:!0)&&e.push(new Lk(t.rotateOptions)),(t.attribution!==void 0?t.attribution:!0)&&e.push(new wk(t.attributionOptions)),e}class kk{constructor(e,n,r){this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let r=n-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[n+2]-this.points_[r+2];if(i<1e3/60)return!1;const a=this.points_[n]-this.points_[r],o=this.points_[n+1]-this.points_[r+1];return this.angle_=Math.atan2(o,a),this.initialVelocity_=Math.sqrt(a*a+o*o)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const tD={ACTIVE:"active"};class E_ extends kc{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(tD.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(tD.ACTIVE,e)}setMap(e){this.map_=e}}function Uk(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:C8,center:t.getConstrainedCenter(i)})}}function LN(t,e,n,r){const i=t.getZoom();if(i===void 0)return;const a=t.getConstrainedZoom(i+e),o=t.getResolutionForZoom(a);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:r!==void 0?r:250,easing:xm})}class Bk extends E_{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==pi.DBLCLICK){const r=e.originalEvent,i=e.map,a=e.coordinate,o=r.shiftKey?-this.delta_:this.delta_,c=i.getView();LN(c,o,a,this.duration_),r.preventDefault(),n=!0}return!n}}function h2(t){const e=arguments;return function(n){let r=!0;for(let i=0,a=e.length;i<a&&(r=r&&e[i](n),!!r);++i);return r}}const Gk=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Wk=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)},kI=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?Wk(t):!0},Fk=Hg,UI=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(n8&&sI&&e.ctrlKey)},BI=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Kk=function(t){const e=t.originalEvent;return sI?e.metaKey:e.ctrlKey},Qk=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},GI=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},Lb=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},Yk=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class D_ extends E_{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==pi.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==pi.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==pi.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,n=this.stopDown(r)}else e.type==pi.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function PN(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}class Vk extends D_{constructor(e){super({stopDown:M1}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:h2(BI,Yk);this.condition_=e.onFocusOnly?h2(kI,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const r=this.targetPointers,i=n.getEventPixel(PN(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const a=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],c=e.map.getView();p8(a,c.getResolution()),_N(a,c.getRotation()),c.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),a=this.kinetic_.getAngle(),o=r.getCenterInternal(),c=n.getPixelFromCoordinateInternal(o),u=n.getCoordinateFromPixelInternal([c[0]-i*Math.cos(a),c[1]-i*Math.sin(a)]);r.animateInternal({center:r.getConstrainedCenter(u),duration:500,easing:xm})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class $k extends D_{constructor(e){e=e||{},super({stopDown:M1}),this.condition_=e.condition?e.condition:Gk,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Lb(e))return;const n=e.map,r=n.getView();if(r.getConstraints().rotation===IN)return;const i=n.getSize(),a=e.pixel,o=Math.atan2(i[1]/2-a[1],a[0]-i[0]/2);if(this.lastAngle_!==void 0){const c=o-this.lastAngle_;r.adjustRotationInternal(-c)}this.lastAngle_=o}handleUpEvent(e){return Lb(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Lb(e)&&UI(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class zk extends T1{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],n[0])+r,i.top=Math.min(e[1],n[1])+r,i.width=Math.abs(n[0]-e[0])+r,i.height=Math.abs(n[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Zg([i])}getGeometry(){return this.geometry_}}const sf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class dg extends Id{constructor(e,n,r){super(e),this.coordinate=n,this.mapBrowserEvent=r}}class Hk extends D_{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new zk(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??UI,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,r){const i=r[0]-n[0],a=r[1]-n[1];return i*i+a*a>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new dg(sf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new dg(n?sf.BOXEND:sf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new dg(sf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dg(sf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dg(sf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class qk extends Hk{constructor(e){e=e||{};const n=e.condition?e.condition:Qk;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const a=r.rotatedExtentForGeometry(i),o=r.getResolutionForExtentInternal(a),c=r.getResolution()/o;i=i.clone(),i.scale(c*c)}r.fitInternal(i,{duration:this.duration_,easing:xm})}}const yh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class Xk extends E_{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return BI(n)&&GI(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==Mn.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==yh.DOWN||i==yh.LEFT||i==yh.RIGHT||i==yh.UP)){const o=e.map.getView(),c=o.getResolution()*this.pixelDelta_;let u=0,h=0;i==yh.DOWN?h=-c:i==yh.LEFT?u=-c:i==yh.RIGHT?u=c:h=c;const m=[u,h];_N(m,o.getRotation()),Uk(o,m,this.duration_),r.preventDefault(),n=!0}}return!n}}class Jk extends E_{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!Kk(n)&&GI(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==Mn.KEYDOWN||e.type==Mn.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const a=e.map,o=i==="+"?this.delta_:-this.delta_,c=a.getView();LN(c,o,void 0,this.duration_),r.preventDefault(),n=!0}}return!n}}const Zk=40,e7=300;class t7 extends E_{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:Fk;this.condition_=e.onFocusOnly?h2(kI,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Mn.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let a=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:a*=Zk;break;case WheelEvent.DOM_DELTA_PAGE:a*=e7;break}if(a===0)return!1;this.lastDelta_=a;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?"trackpad":"wheel");const c=r.getView();if(this.mode_==="trackpad"&&!(c.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(c.getAnimating()&&c.cancelAnimations(),c.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),c.adjustZoom(-a/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=a;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),u),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let r=-Ur(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),LN(n,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class s7 extends D_{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=M1),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const r=this.targetPointers[0],i=this.targetPointers[1],a=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const u=a-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=u}this.lastAngle_=a;const o=e.map,c=o.getView();c.getConstraints().rotation!==IN&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(PN(this.targetPointers))),this.rotating_&&(o.render(),c.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class n7 extends D_{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=M1),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const r=this.targetPointers[0],i=this.targetPointers[1],a=r.clientX-i.clientX,o=r.clientY-i.clientY,c=Math.sqrt(a*a+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/c),this.lastDistance_=c;const u=e.map,h=u.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(PN(this.targetPointers))),u.render(),h.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function r7(t){t=t||{};const e=new uo,n=new kk(-.005,.05,100);return(t.altShiftDragRotate!==void 0?t.altShiftDragRotate:!0)&&e.push(new $k),(t.doubleClickZoom!==void 0?t.doubleClickZoom:!0)&&e.push(new Bk({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan!==void 0?t.dragPan:!0)&&e.push(new Vk({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate!==void 0?t.pinchRotate:!0)&&e.push(new s7),(t.pinchZoom!==void 0?t.pinchZoom:!0)&&e.push(new n7({duration:t.zoomDuration})),(t.keyboard!==void 0?t.keyboard:!0)&&(e.push(new Xk),e.push(new Jk({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom!==void 0?t.mouseWheelZoom:!0)&&e.push(new t7({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom!==void 0?t.shiftDragZoom:!0)&&e.push(new qk({duration:t.zoomDuration})),e}const Cr={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class WI extends kc{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[Cr.OPACITY]=e.opacity!==void 0?e.opacity:1,_r(typeof n[Cr.OPACITY]=="number","Layer opacity must be a number"),n[Cr.VISIBLE]=e.visible!==void 0?e.visible:!0,n[Cr.Z_INDEX]=e.zIndex,n[Cr.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[Cr.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[Cr.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[Cr.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return n.opacity=Ur(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return sr()}getLayerStatesArray(e){return sr()}getExtent(){return this.get(Cr.EXTENT)}getMaxResolution(){return this.get(Cr.MAX_RESOLUTION)}getMinResolution(){return this.get(Cr.MIN_RESOLUTION)}getMinZoom(){return this.get(Cr.MIN_ZOOM)}getMaxZoom(){return this.get(Cr.MAX_ZOOM)}getOpacity(){return this.get(Cr.OPACITY)}getSourceState(){return sr()}getVisible(){return this.get(Cr.VISIBLE)}getZIndex(){return this.get(Cr.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Cr.EXTENT,e)}setMaxResolution(e){this.set(Cr.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Cr.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Cr.MAX_ZOOM,e)}setMinZoom(e){this.set(Cr.MIN_ZOOM,e)}setOpacity(e){_r(typeof e=="number","Layer opacity must be a number"),this.set(Cr.OPACITY,e)}setVisible(e){this.set(Cr.VISIBLE,e)}setZIndex(e){this.set(Cr.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const du={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Su extends Id{constructor(e,n){super(e),this.layer=n}}const Pb={LAYERS:"layers"};class pm extends WI{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let r=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Pb.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new uo(r.slice(),{unique:!0}):_r(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new uo(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ei),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nr(e,bl.ADD,this.handleLayersAdd_,this),nr(e,bl.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(ei);C_(this.listenerKeys_);const n=e.getArray();for(let r=0,i=n.length;r<i;r++){const a=n[r];this.registerLayerListeners_(a),this.dispatchEvent(new Su(du.ADDLAYER,a))}this.changed()}registerLayerListeners_(e){const n=[nr(e,am.PROPERTYCHANGE,this.handleLayerChange_,this),nr(e,Mn.CHANGE,this.handleLayerChange_,this)];e instanceof pm&&n.push(nr(e,du.ADDLAYER,this.handleLayerGroupAdd_,this),nr(e,du.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[rr(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new Su(du.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Su(du.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new Su(du.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,r=rr(n);this.listenerKeys_[r].forEach(ei),delete this.listenerKeys_[r],this.dispatchEvent(new Su(du.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(Pb.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const r=n.getArray();for(let i=0,a=r.length;i<a;++i)this.dispatchEvent(new Su(du.REMOVELAYER,r[i]))}this.set(Pb.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],r=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const i=this.getLayerState();let a=i.zIndex;!e&&i.zIndex===void 0&&(a=0);for(let o=r,c=n.length;o<c;o++){const u=n[o];u.opacity*=i.opacity,u.visible=u.visible&&i.visible,u.maxResolution=Math.min(u.maxResolution,i.maxResolution),u.minResolution=Math.max(u.minResolution,i.minResolution),u.minZoom=Math.max(u.minZoom,i.minZoom),u.maxZoom=Math.min(u.maxZoom,i.maxZoom),i.extent!==void 0&&(u.extent!==void 0?u.extent=Kh(u.extent,i.extent):u.extent=i.extent),u.zIndex===void 0&&(u.zIndex=a)}return n}getSourceState(){return"ready"}}const fo={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class W1 extends WI{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Cr.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Cr.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ei(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nr(e,Mn.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof zo?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&r&&(n.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(n.layerStatesArray){if(i=n.layerStatesArray.find(o=>o.layer===this),!i)return!1}else i=this.getLayerState();const a=this.getExtent();return AN(i,n.viewState)&&(!a||Sl(a,n.extent))}getAttributions(e){var a;if(!this.isVisible(e))return[];const n=(a=this.getSource())==null?void 0:a.getAttributions();if(!n)return[];const r=e instanceof zo?e.getViewStateAndExtent():e;let i=n(r);return Array.isArray(i)||(i=[i]),i}render(e,n){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Cr.MAP,e)}getMapInternal(){return this.get(Cr.MAP)}setMap(e){this.mapPrecomposeKey_&&(ei(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ei(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nr(e,fo.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nr(this,Mn.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);_r(!n.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}setSource(e){this.set(Cr.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function AN(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}function FI(t,e,n=0,r=t.length-1,i=i7){for(;r>n;){if(r-n>600){const u=r-n+1,h=e-n+1,m=Math.log(u),_=.5*Math.exp(2*m/3),p=.5*Math.sqrt(m*_*(u-_)/u)*(h-u/2<0?-1:1),g=Math.max(n,Math.floor(e-h*_/u+p)),C=Math.min(r,Math.floor(e+(u-h)*_/u+p));FI(t,e,g,C,i)}const a=t[e];let o=n,c=r;for(ug(t,n,e),i(t[r],a)>0&&ug(t,n,r);o<c;){for(ug(t,o,c),o++,c--;i(t[o],a)<0;)o++;for(;i(t[c],a)>0;)c--}i(t[n],a)===0?ug(t,n,c):(c++,ug(t,c,r)),c<=e&&(n=c+1),e<=c&&(r=c-1)}}function ug(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function i7(t,e){return t<e?-1:t>e?1:0}let KI=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!Fx(e,n))return r;const i=this.toBBox,a=[];for(;n;){for(let o=0;o<n.children.length;o++){const c=n.children[o],u=n.leaf?i(c):c;Fx(e,u)&&(n.leaf?r.push(c):kb(e,u)?this._all(c,r):a.push(c))}n=a.pop()}return r}collides(e){let n=this.data;if(!Fx(e,n))return!1;const r=[];for(;n;){for(let i=0;i<n.children.length;i++){const a=n.children[i],o=n.leaf?this.toBBox(a):a;if(Fx(e,o)){if(n.leaf||kb(e,o))return!0;r.push(a)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=pf([]),this}remove(e,n){if(!e)return this;let r=this.data;const i=this.toBBox(e),a=[],o=[];let c,u,h;for(;r||a.length;){if(r||(r=a.pop(),u=a[a.length-1],c=o.pop(),h=!0),r.leaf){const m=a7(e,r.children,n);if(m!==-1)return r.children.splice(m,1),a.push(r),this._condense(a),this}!h&&!r.leaf&&kb(r,i)?(a.push(r),o.push(c),c=0,u=r,r=r.children[0]):u?(c++,r=u.children[c],h=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,i){const a=r-n+1;let o=this._maxEntries,c;if(a<=o)return c=pf(e.slice(n,r+1)),nf(c,this.toBBox),c;i||(i=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,i-1))),c=pf([]),c.leaf=!1,c.height=i;const u=Math.ceil(a/o),h=u*Math.ceil(Math.sqrt(o));sD(e,n,r,h,this.compareMinX);for(let m=n;m<=r;m+=h){const _=Math.min(m+h-1,r);sD(e,m,_,u,this.compareMinY);for(let p=m;p<=_;p+=u){const g=Math.min(p+u-1,_);c.children.push(this._build(e,p,g,i-1))}}return nf(c,this.toBBox),c}_chooseSubtree(e,n,r,i){for(;i.push(n),!(n.leaf||i.length-1===r);){let a=1/0,o=1/0,c;for(let u=0;u<n.children.length;u++){const h=n.children[u],m=Ab(h),_=c7(e,h)-m;_<o?(o=_,a=m<a?m:a,c=h):_===o&&m<a&&(a=m,c=h)}n=c||n.children[0]}return n}_insert(e,n,r){const i=r?e:this.toBBox(e),a=[],o=this._chooseSubtree(i,this.data,n,a);for(o.children.push(e),Sg(o,i);n>=0&&a[n].children.length>this._maxEntries;)this._split(a,n),n--;this._adjustParentBBoxes(i,a,n)}_split(e,n){const r=e[n],i=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,i);const o=this._chooseSplitIndex(r,a,i),c=pf(r.children.splice(o,r.children.length-o));c.height=r.height,c.leaf=r.leaf,nf(r,this.toBBox),nf(c,this.toBBox),n?e[n-1].children.push(c):this._splitRoot(r,c)}_splitRoot(e,n){this.data=pf([e,n]),this.data.height=e.height+1,this.data.leaf=!1,nf(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let i,a=1/0,o=1/0;for(let c=n;c<=r-n;c++){const u=Ng(e,0,c,this.toBBox),h=Ng(e,c,r,this.toBBox),m=d7(u,h),_=Ab(u)+Ab(h);m<a?(a=m,i=c,o=_<o?_:o):m===a&&_<o&&(o=_,i=c)}return i||r-n}_chooseSplitAxis(e,n,r){const i=e.leaf?this.compareMinX:l7,a=e.leaf?this.compareMinY:o7,o=this._allDistMargin(e,n,r,i),c=this._allDistMargin(e,n,r,a);o<c&&e.children.sort(i)}_allDistMargin(e,n,r,i){e.children.sort(i);const a=this.toBBox,o=Ng(e,0,n,a),c=Ng(e,r-n,r,a);let u=Wx(o)+Wx(c);for(let h=n;h<r-n;h++){const m=e.children[h];Sg(o,e.leaf?a(m):m),u+=Wx(o)}for(let h=r-n-1;h>=n;h--){const m=e.children[h];Sg(c,e.leaf?a(m):m),u+=Wx(c)}return u}_adjustParentBBoxes(e,n,r){for(let i=r;i>=0;i--)Sg(n[i],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():nf(e[n],this.toBBox)}};function a7(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function nf(t,e){Ng(t,0,t.children.length,e,t)}function Ng(t,e,n,r,i){i||(i=pf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let a=e;a<n;a++){const o=t.children[a];Sg(i,t.leaf?r(o):o)}return i}function Sg(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l7(t,e){return t.minX-e.minX}function o7(t,e){return t.minY-e.minY}function Ab(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Wx(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c7(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d7(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),a=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,a-r)}function kb(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Fx(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function pf(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function sD(t,e,n,r,i){const a=[e,n];for(;a.length;){if(n=a.pop(),e=a.pop(),n-e<=r)continue;const o=e+Math.ceil((n-e)/r/2)*r;FI(t,o,e,n,i),a.push(e,o,o,n)}}const kN=[NaN,NaN,NaN,0];let Ub;function u7(){return Ub||(Ub=Ui(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Ub}const h7=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,f7=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,m7=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,g7=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Kx(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function kg(t){throw new Error('failed to parse "'+t+'" as color')}function QI(t){if(t.toLowerCase().startsWith("rgb")){const a=t.match(f7)||t.match(h7)||t.match(m7);if(a){const o=a[4],c=100/255;return[Ur(Kx(a[1],c)+.5|0,0,255),Ur(Kx(a[2],c)+.5|0,0,255),Ur(Kx(a[3],c)+.5|0,0,255),o!==void 0?Ur(Kx(o,100),0,1):1]}kg(t)}if(t.startsWith("#")){if(g7.test(t)){const a=t.substring(1),o=a.length<=4?1:2,c=[0,0,0,255];for(let u=0,h=a.length;u<h;u+=o){let m=parseInt(a.substring(u,u+o),16);o===1&&(m+=m<<4),c[u/o]=m}return c[3]=c[3]/255,c}kg(t)}const e=u7();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&kg(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return QI(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=j1(i[3]/255,3),i}function _7(t){return typeof t=="string"?t:BN(t)}const x7=1024,hg={};let Bb=0;function p7(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function Gb(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function Wb(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function Fb(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function Kb(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function nD(t){const e=Fb(t[0]),n=Fb(t[1]),r=Fb(t[2]),i=Kb(e*.222488403+n*.716873169+r*.06060791),a=500*(Kb(e*.452247074+n*.399439023+r*.148375274)-i),o=200*(i-Kb(e*.016863605+n*.117638439+r*.865350722)),c=Math.atan2(o,a)*(180/Math.PI);return[116*i-16,Math.sqrt(a*a+o*o),c<0?c+360:c,t[3]]}function y7(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=Wb(e),a=Wb(e+n/500*Math.cos(r)),o=Wb(e-n/200*Math.sin(r)),c=Gb(a*3.021973625-i*1.617392459-o*.404875592),u=Gb(a*-.943766287+i*1.916279586+o*.027607165),h=Gb(a*.069407491-i*.22898585+o*1.159737864);return[Ur(c+.5|0,0,255),Ur(u+.5|0,0,255),Ur(h+.5|0,0,255),t[3]]}function UN(t){if(t==="none")return kN;if(hg.hasOwnProperty(t))return hg[t];if(Bb>=x7){let n=0;for(const r in hg)(n++&3)===0&&(delete hg[r],--Bb)}const e=QI(t);e.length!==4&&kg(t);for(const n of e)isNaN(n)&&kg(t);return hg[t]=e,++Bb,e}function Xh(t){return Array.isArray(t)?t:UN(t)}function BN(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let r=t[2];r!=(r|0)&&(r=r+.5|0);const i=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+r+","+i+")"}function rD(t){return t[0]>0&&t[1]>0}function b7(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function El(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}let h0=0;const Ha=1<<h0++,Wn=1<<h0++,Cl=1<<h0++,Ho=1<<h0++,Jh=1<<h0++,vg=1<<h0++,Qx=Math.pow(2,h0)-1,GN={[Ha]:"boolean",[Wn]:"number",[Cl]:"string",[Ho]:"color",[Jh]:"number[]",[vg]:"size"},C7=Object.keys(GN).map(Number).sort(yd);function N7(t){return t in GN}function Eg(t){const e=[];for(const n of C7)Dg(t,n)&&e.push(GN[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Dg(t,e){return(t&e)===e}function uu(t,e){return t===e}class qi{constructor(e,n){if(!N7(e))throw new Error(`literal expressions must have a specific type, got ${Eg(e)}`);this.type=e,this.value=n}}class S7{constructor(e,n,...r){this.type=e,this.operator=n,this.args=r}}function YI(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Da(t,e,n){switch(typeof t){case"boolean":{if(uu(e,Cl))return new qi(Cl,t?"true":"false");if(!Dg(e,Ha))throw new Error(`got a boolean, but expected ${Eg(e)}`);return new qi(Ha,t)}case"number":{if(uu(e,vg))return new qi(vg,El(t));if(uu(e,Ha))return new qi(Ha,!!t);if(uu(e,Cl))return new qi(Cl,t.toString());if(!Dg(e,Wn))throw new Error(`got a number, but expected ${Eg(e)}`);return new qi(Wn,t)}case"string":{if(uu(e,Ho))return new qi(Ho,UN(t));if(uu(e,Ha))return new qi(Ha,!!t);if(!Dg(e,Cl))throw new Error(`got a string, but expected ${Eg(e)}`);return new qi(Cl,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return L7(t,e,n);for(const r of t)if(typeof r!="number")throw new Error("expected an array of numbers");if(uu(e,vg)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new qi(vg,t)}if(uu(e,Ho)){if(t.length===3)return new qi(Ho,[...t,1]);if(t.length===4)return new qi(Ho,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!Dg(e,Jh))throw new Error(`got an array of numbers, but expected ${Eg(e)}`);return new qi(Jh,t)}const as={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},v7={[as.Get]:pn(Tn(1,1/0),iD),[as.Var]:pn(Tn(1,1),E7),[as.Has]:pn(Tn(1,1/0),iD),[as.Id]:pn(D7,rf),[as.Concat]:pn(Tn(2,1/0),ur(Cl)),[as.GeometryType]:pn(R7,rf),[as.LineMetric]:pn(rf),[as.Resolution]:pn(Qb,rf),[as.Zoom]:pn(Qb,rf),[as.Time]:pn(Qb,rf),[as.Any]:pn(Tn(2,1/0),ur(Ha)),[as.All]:pn(Tn(2,1/0),ur(Ha)),[as.Not]:pn(Tn(1,1),ur(Ha)),[as.Equal]:pn(Tn(2,2),ur(Qx)),[as.NotEqual]:pn(Tn(2,2),ur(Qx)),[as.GreaterThan]:pn(Tn(2,2),ur(Wn)),[as.GreaterThanOrEqualTo]:pn(Tn(2,2),ur(Wn)),[as.LessThan]:pn(Tn(2,2),ur(Wn)),[as.LessThanOrEqualTo]:pn(Tn(2,2),ur(Wn)),[as.Multiply]:pn(Tn(2,1/0),aD),[as.Coalesce]:pn(Tn(2,1/0),aD),[as.Divide]:pn(Tn(2,2),ur(Wn)),[as.Add]:pn(Tn(2,1/0),ur(Wn)),[as.Subtract]:pn(Tn(2,2),ur(Wn)),[as.Clamp]:pn(Tn(3,3),ur(Wn)),[as.Mod]:pn(Tn(2,2),ur(Wn)),[as.Pow]:pn(Tn(2,2),ur(Wn)),[as.Abs]:pn(Tn(1,1),ur(Wn)),[as.Floor]:pn(Tn(1,1),ur(Wn)),[as.Ceil]:pn(Tn(1,1),ur(Wn)),[as.Round]:pn(Tn(1,1),ur(Wn)),[as.Sin]:pn(Tn(1,1),ur(Wn)),[as.Cos]:pn(Tn(1,1),ur(Wn)),[as.Atan]:pn(Tn(1,2),ur(Wn)),[as.Sqrt]:pn(Tn(1,1),ur(Wn)),[as.Match]:pn(Tn(4,1/0),lD,M7),[as.Between]:pn(Tn(3,3),ur(Wn)),[as.Interpolate]:pn(Tn(6,1/0),lD,I7),[as.Case]:pn(Tn(3,1/0),T7,j7),[as.In]:pn(Tn(2,2),O7),[as.Number]:pn(Tn(1,1/0),ur(Qx)),[as.String]:pn(Tn(1,1/0),ur(Qx)),[as.Array]:pn(Tn(1,1/0),ur(Wn)),[as.Color]:pn(Tn(1,4),ur(Wn)),[as.Band]:pn(Tn(1,3),ur(Wn)),[as.Palette]:pn(Tn(2,2),w7),[as.ToString]:pn(Tn(1,1),ur(Ha|Wn|Cl|Ho))};function iD(t,e,n){const r=t.length-1,i=new Array(r);for(let a=0;a<r;++a){const o=t[a+1];switch(typeof o){case"number":{i[a]=new qi(Wn,o);break}case"string":{i[a]=new qi(Cl,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}a===0&&n.properties.add(String(o))}return i}function E7(t,e,n){const r=t[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return n.variables.add(r),[new qi(Cl,r)]}function D7(t,e,n){n.featureId=!0}function R7(t,e,n){n.geometryType=!0}function Qb(t,e,n){n.mapState=!0}function rf(t,e,n){const r=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function Tn(t,e){return function(n,r,i){const a=n[0],o=n.length-1;if(t===e){if(o!==t){const c=t===1?"":"s";throw new Error(`expected ${t} argument${c} for ${a}, got ${o}`)}}else if(o<t||o>e){const c=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${c} arguments for ${a}, got ${o}`)}}}function aD(t,e,n){const r=t.length-1,i=new Array(r);for(let a=0;a<r;++a){const o=Da(t[a+1],e,n);i[a]=o}return i}function ur(t){return function(e,n,r){const i=e.length-1,a=new Array(i);for(let o=0;o<i;++o){const c=Da(e[o+1],t,r);a[o]=c}return a}}function T7(t,e,n){const r=t[0],i=t.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function lD(t,e,n){const r=t[0],i=t.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function M7(t,e,n){const r=t.length-1,i=Cl|Wn|Ha,a=Da(t[1],i,n),o=Da(t[t.length-1],e,n),c=new Array(r-2);for(let u=0;u<r-2;u+=2){try{const h=Da(t[u+2],a.type,n);c[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Da(t[u+3],o.type,n);c[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[a,...c,o]}function I7(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const u=r[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);i=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const a=new qi(Wn,i);let o;try{o=Da(t[2],Wn,n)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const c=new Array(t.length-3);for(let u=0;u<c.length;u+=2){try{const h=Da(t[u+3],Wn,n);c[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Da(t[u+4],e,n);c[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[a,o,...c]}function j7(t,e,n){const r=Da(t[t.length-1],e,n),i=new Array(t.length-1);for(let a=0;a<i.length-1;a+=2){try{const o=Da(t[a+1],Ha,n);i[a]=o}catch(o){throw new Error(`failed to parse argument ${a} of case expression: ${o.message}`)}try{const o=Da(t[a+2],r.type,n);i[a+1]=o}catch(o){throw new Error(`failed to parse argument ${a+1} of case expression: ${o.message}`)}}return i[i.length-1]=r,i}function O7(t,e,n){let r=t[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Cl}else i=Wn;const a=new Array(r.length);for(let c=0;c<a.length;c++)try{const u=Da(r[c],i,n);a[c]=u}catch(u){throw new Error(`failed to parse haystack item ${c} for "in" expression: ${u.message}`)}return[Da(t[1],i,n),...a]}function w7(t,e,n){let r;try{r=Da(t[1],Wn,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const a=new Array(i.length);for(let o=0;o<a.length;o++){let c;try{c=Da(i[o],Ho,n)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(c instanceof qi))throw new Error(`the palette color at index ${o} must be a literal value`);a[o]=c}return[r,...a]}function pn(...t){return function(e,n,r){const i=e[0];let a;for(let o=0;o<t.length;o++){const c=t[o](e,n,r);if(o==t.length-1){if(!c)throw new Error("expected last argument validator to return the parsed args");a=c}}return new S7(n,i,...a)}}function L7(t,e,n){const r=t[0],i=v7[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}function VI(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return VI(t.getGeometries()[0]);default:return""}}function $I(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Lc(t,e,n){const r=Da(t,e,n);return Zo(r)}function Zo(t,e){if(t instanceof qi){if(t.type===Ho&&typeof t.value=="string"){const r=UN(t.value);return function(){return r}}return function(){return t.value}}const n=t.operator;switch(n){case as.Number:case as.String:case as.Coalesce:return P7(t);case as.Get:case as.Var:case as.Has:return A7(t);case as.Id:return r=>r.featureId;case as.GeometryType:return r=>r.geometryType;case as.Concat:{const r=t.args.map(i=>Zo(i));return i=>"".concat(...r.map(a=>a(i).toString()))}case as.Resolution:return r=>r.resolution;case as.Any:case as.All:case as.Between:case as.In:case as.Not:return U7(t);case as.Equal:case as.NotEqual:case as.LessThan:case as.LessThanOrEqualTo:case as.GreaterThan:case as.GreaterThanOrEqualTo:return k7(t);case as.Multiply:case as.Divide:case as.Add:case as.Subtract:case as.Clamp:case as.Mod:case as.Pow:case as.Abs:case as.Floor:case as.Ceil:case as.Round:case as.Sin:case as.Cos:case as.Atan:case as.Sqrt:return B7(t);case as.Case:return G7(t);case as.Match:return W7(t);case as.Interpolate:return F7(t);case as.ToString:return K7(t);default:throw new Error(`Unsupported operator ${n}`)}}function P7(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let a=0;a<r;++a)i[a]=Zo(t.args[a]);switch(n){case as.Coalesce:return a=>{for(let o=0;o<r;++o){const c=i[o](a);if(typeof c<"u"&&c!==null)return c}throw new Error("Expected one of the values to be non-null")};case as.Number:case as.String:return a=>{for(let o=0;o<r;++o){const c=i[o](a);if(typeof c===n)return c}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function A7(t,e){const r=t.args[0].value;switch(t.operator){case as.Get:return i=>{const a=t.args;let o=i.properties[r];for(let c=1,u=a.length;c<u;++c){const m=a[c].value;o=o[m]}return o};case as.Var:return i=>i.variables[r];case as.Has:return i=>{const a=t.args;if(!(r in i.properties))return!1;let o=i.properties[r];for(let c=1,u=a.length;c<u;++c){const m=a[c].value;if(!o||!Object.hasOwn(o,m))return!1;o=o[m]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function k7(t,e){const n=t.operator,r=Zo(t.args[0]),i=Zo(t.args[1]);switch(n){case as.Equal:return a=>r(a)===i(a);case as.NotEqual:return a=>r(a)!==i(a);case as.LessThan:return a=>r(a)<i(a);case as.LessThanOrEqualTo:return a=>r(a)<=i(a);case as.GreaterThan:return a=>r(a)>i(a);case as.GreaterThanOrEqualTo:return a=>r(a)>=i(a);default:throw new Error(`Unsupported comparison operator ${n}`)}}function U7(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let a=0;a<r;++a)i[a]=Zo(t.args[a]);switch(n){case as.Any:return a=>{for(let o=0;o<r;++o)if(i[o](a))return!0;return!1};case as.All:return a=>{for(let o=0;o<r;++o)if(!i[o](a))return!1;return!0};case as.Between:return a=>{const o=i[0](a),c=i[1](a),u=i[2](a);return o>=c&&o<=u};case as.In:return a=>{const o=i[0](a);for(let c=1;c<r;++c)if(o===i[c](a))return!0;return!1};case as.Not:return a=>!i[0](a);default:throw new Error(`Unsupported logical operator ${n}`)}}function B7(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let a=0;a<r;++a)i[a]=Zo(t.args[a]);switch(n){case as.Multiply:return a=>{let o=1;for(let c=0;c<r;++c)o*=i[c](a);return o};case as.Divide:return a=>i[0](a)/i[1](a);case as.Add:return a=>{let o=0;for(let c=0;c<r;++c)o+=i[c](a);return o};case as.Subtract:return a=>i[0](a)-i[1](a);case as.Clamp:return a=>{const o=i[0](a),c=i[1](a);if(o<c)return c;const u=i[2](a);return o>u?u:o};case as.Mod:return a=>i[0](a)%i[1](a);case as.Pow:return a=>Math.pow(i[0](a),i[1](a));case as.Abs:return a=>Math.abs(i[0](a));case as.Floor:return a=>Math.floor(i[0](a));case as.Ceil:return a=>Math.ceil(i[0](a));case as.Round:return a=>Math.round(i[0](a));case as.Sin:return a=>Math.sin(i[0](a));case as.Cos:return a=>Math.cos(i[0](a));case as.Atan:return r===2?a=>Math.atan2(i[0](a),i[1](a)):a=>Math.atan(i[0](a));case as.Sqrt:return a=>Math.sqrt(i[0](a));default:throw new Error(`Unsupported numeric operator ${n}`)}}function G7(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Zo(t.args[i]);return i=>{for(let a=0;a<n-1;a+=2)if(r[a](i))return r[a+1](i);return r[n-1](i)}}function W7(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Zo(t.args[i]);return i=>{const a=r[0](i);for(let o=1;o<n-1;o+=2)if(a===r[o](i))return r[o+1](i);return r[n-1](i)}}function F7(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Zo(t.args[i]);return i=>{const a=r[0](i),o=r[1](i);let c,u;for(let h=2;h<n;h+=2){const m=r[h](i);let _=r[h+1](i);const p=Array.isArray(_);if(p&&(_=p7(_)),m>=o)return h===2?_:p?Q7(a,o,c,u,m,_):Rg(a,o,c,u,m,_);c=m,u=_}return u}}function K7(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let a=0;a<r;++a)i[a]=Zo(t.args[a]);switch(n){case as.ToString:return a=>{const o=i[0](a);return t.args[0].type===Ho?BN(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function Rg(t,e,n,r,i,a){const o=i-n;if(o===0)return r;const c=e-n,u=t===1?c/o:(Math.pow(t,c)-1)/(Math.pow(t,o)-1);return r+u*(a-r)}function Q7(t,e,n,r,i,a){if(i-n===0)return r;const c=nD(r),u=nD(a);let h=u[2]-c[2];h>180?h-=360:h<-180&&(h+=360);const m=[Rg(t,e,n,c[0],i,u[0]),Rg(t,e,n,c[1],i,u[1]),c[2]+Rg(t,e,n,0,i,h),Rg(t,e,n,r[3],i,a[3])];return y7(m)}const Dn={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Y7(t,e,n){const r=t;let i=!0,a=!1,o=!1;const c=[Kp(r,Mn.LOAD,function(){o=!0,a||e()})];return r.src&&nI?(a=!0,r.decode().then(function(){i&&e()}).catch(function(u){i&&(o?e():n())})):c.push(Kp(r,Mn.ERROR,n)),function(){i=!1,c.forEach(ei)}}function V7(t,e){return new Promise((n,r)=>{function i(){o(),n(t)}function a(){o(),r(new Error("Image load error"))}function o(){t.removeEventListener("load",i),t.removeEventListener("error",a)}t.addEventListener("load",i),t.addEventListener("error",a)})}function $7(t,e){return e&&(t.src=e),t.src&&nI?new Promise((n,r)=>t.decode().then(()=>n(t)).catch(i=>t.complete&&t.width?n(t):r(i))):V7(t)}class z7{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const r=this.cache_[n];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n){const r=Yb(e,n);return r in this.cache_?this.cache_[r]:null}getPattern(e,n){const r=Yb(e,n);return r in this.patternCache_?this.patternCache_[r]:null}set(e,n,r,i){const a=Yb(e,n),o=a in this.cache_;this.cache_[a]=r,i&&(r.getImageState()===Dn.IDLE&&r.load(),r.getImageState()===Dn.LOADING?r.ready().then(()=>{this.patternCache_[a]=Jp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[a]=Jp().createPattern(r.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function Yb(t,e){const n=e?Xh(e):"null";return t+":"+n}const mo=new z7;let fg=null;class zI extends I1{constructor(e,n,r,i,a){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r==null?void 0:r.crossOrigin,this.referrerPolicy_=r==null?void 0:r.referrerPolicy,this.canvas_={},this.color_=a,this.imageState_=i===void 0?Dn.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Dn.LOADED){fg||(fg=Ui(1,1,void 0,{willReadFrequently:!0})),fg.drawImage(this.image_,0,0);try{fg.getImageData(0,0,1,1),this.tainted_=!1}catch{fg=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Mn.CHANGE)}handleImageError_(){this.imageState_=Dn.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Dn.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}setImage(e){this.image_=e}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],r=Ui(e,n);r.fillRect(0,0,e,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Dn.IDLE){this.image_||this.initializeImage_(),this.imageState_=Dn.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&$7(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Dn.LOADED)return;const n=this.image_,r=Ui(Math.ceil(n.width*e),Math.ceil(n.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(n,0,0),r.globalCompositeOperation="multiply",r.fillStyle=_7(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(n,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Dn.LOADED||this.imageState_===Dn.ERROR)e();else{const n=()=>{(this.imageState_===Dn.LOADED||this.imageState_===Dn.ERROR)&&(this.removeEventListener(Mn.CHANGE,n),e())};this.addEventListener(Mn.CHANGE,n)}})),this.ready_}}function Ug(t,e,n,r,i,a){let o=e===void 0?void 0:mo.get(e,i);return o||(o=new zI(t,t&&"src"in t?t.src||void 0:e,n,r,i),mo.set(e,i,o,a)),a&&o&&!mo.getPattern(e,i)&&mo.set(e,i,o,a),o}function Mc(t){return t?Array.isArray(t)?BN(t):typeof t=="object"&&"src"in t?H7(t):t:null}function H7(t){if(!t.offset||!t.size)return mo.getPattern(t.src,t.color);const e=t.src+":"+t.offset,n=mo.getPattern(e,t.color);if(n)return n;const r=mo.get(t.src,null);if(r.getImageState()!==Dn.LOADED)return null;const i=Ui(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),Ug(i.canvas,e,void 0,Dn.LOADED,t.color,!0),mo.getPattern(e,t.color)}const HI="10px sans-serif",Nl="#000",dm="round",bd=[],Cd=0,um="round",e_=10,q7=0,t_="#000",s_="center",Zp="middle",Oh=[0,0,0,0],n_=1,yf=new kc;let mg=null,oD;const f2={},X7=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function J7(t,e,n){return`${t} ${e} 16px "${n}"`}const Z7=(function(){let e,n;async function r(a){await n.ready;const o=await n.load(a);if(o.length===0)return!1;const c=u2(a),u=c.families[0].toLowerCase(),h=c.weight;return o.some(m=>{const _=m.family.replace(/^['"]|['"]$/g,"").toLowerCase(),p=d2[m.weight]||m.weight;return _===u&&m.style===c.style&&p==h})}async function i(){await n.ready;let a=!0;const o=yf.getProperties(),c=Object.keys(o).filter(u=>o[u]<100);for(let u=c.length-1;u>=0;--u){const h=c[u];let m=o[h];m<100&&(await r(h)?(C_(f2),yf.set(h,100)):(m+=10,yf.set(h,m,!0),m<100&&(a=!1)))}e=void 0,a||(e=setTimeout(i,100))}return async function(a){n||(n=ho?self.fonts:document.fonts);const o=u2(a);if(!o)return;const c=o.families;let u=!1;for(const h of c){if(X7.has(h))continue;const m=J7(o.style,o.weight,h);yf.get(m)===void 0&&(yf.set(m,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(i,100))}})(),e9=(function(){let t;return function(e){let n=f2[e];if(n==null){if(ho){const r=u2(e),i=qI(e,"g");n=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);f2[e]=n}return n}})();function qI(t,e){return mg||(mg=Ui(1,1)),t!=oD&&(mg.font=t,oD=mg.font),mg.measureText(e)}function XI(t,e){return qI(t,e).width}function cD(t,e,n){if(e in n)return n[e];const r=e.split(`
`).reduce((i,a)=>Math.max(i,XI(t,a)),0);return n[e]=r,r}function t9(t,e){const n=[],r=[],i=[];let a=0,o=0,c=0,u=0;for(let h=0,m=e.length;h<=m;h+=2){const _=e[h];if(_===`
`||h===m){a=Math.max(a,o),i.push(o),o=0,c+=u,u=0;continue}const p=e[h+1]||t.font,g=XI(p,_);n.push(g),o+=g;const C=e9(p);r.push(C),u=Math.max(u,C)}return{width:a,height:c,widths:n,heights:r,lineWidths:i}}function s9(t,e,n,r,i,a,o,c,u,h,m){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=_=>_.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(u,h),t.scale(m[0],m[1]),n9(r,t)):m[0]<0||m[1]<0?(t.translate(u,h),t.scale(m[0],m[1]),t.drawImage(r,i,a,o,c,0,0,o,c)):t.drawImage(r,i,a,o,c,u,h,o*m[0],c*m[1]),t.restore()}function n9(t,e){const n=t.contextInstructions;for(let r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}class F1{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=El(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new F1({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return sr()}getImage(e){return sr()}getHitDetectionImage(){return sr()}getPixelRatio(e){return 1}getImageState(){return sr()}getImageSize(){return sr()}getOrigin(){return sr()}getSize(){return sr()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=El(e)}listenImageChange(e){sr()}load(){sr()}unlistenImageChange(e){sr()}ready(){return Promise.resolve()}}class K1 extends F1{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Dn.LOADING:Dn.LOADED,this.imageState_===Dn.LOADING&&this.ready().then(()=>this.imageState_=Dn.LOADED),this.render()}clone(){const e=this.getScale(),n=new K1({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-n[0]/r[0],e[1]/2+n[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var a,o;const n=(a=this.fill_)==null?void 0:a.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let i=(o=mo.get(r,null))==null?void 0:o.getImage(1);if(!i){const c=this.renderOptions_,u=Math.ceil(c.size*e),h=Ui(u,u);this.draw_(c,h,e),i=h.canvas;const m=new zI(i,void 0,null,Dn.LOADED,null);mo.set(r,null,m),createImageBitmap(i).then(_=>{m.setImage(_)})}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}setRadius(e){this.radius!==e&&(this.radius=e,this.render())}getRadius2(){return this.radius2_}setRadius2(e){this.radius2_!==e&&(this.radius2_=e,this.render())}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,r){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let i=this.radius,a=this.radius2_===void 0?i:this.radius2_;if(i<a){const F=i;i=a,a=F}const o=this.radius2_===void 0?this.points_:this.points_*2,c=2*Math.PI/o,u=a*Math.sin(c),h=Math.sqrt(a*a-u*u),m=i-h,_=Math.sqrt(u*u+m*m),p=_/u;if(e==="miter"&&p<=r)return p*n;const g=n/2/p,C=n/2*(m/_),S=Math.sqrt((i+g)*(i+g)+C*C)-i;if(this.radius2_===void 0||e==="bevel")return S*2;const v=i*Math.sin(c),k=Math.sqrt(i*i-v*v),L=a-k,P=Math.sqrt(v*v+L*L)/v;if(P<=r){const F=P*n/2-a-i;return 2*Math.max(S,F)}return S*2}createRenderOptions(){let e=dm,n=um,r=0,i=null,a=0,o,c=0;this.stroke_&&(o=Mc(this.stroke_.getColor()??t_),c=this.stroke_.getWidth()??n_,i=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??um,e=this.stroke_.getLineCap()??dm,r=this.stroke_.getMiterLimit()??e_);const u=this.calculateLineJoinSize_(n,c,r),h=Math.max(this.radius,this.radius2_||0),m=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:c,size:m,lineCap:e,lineDash:i,lineDashOffset:a,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,r){if(n.scale(r,r),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let i=this.fill_.getColor();i===null&&(i=Nl),n.fillStyle=Mc(i),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Xh(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(n=Ui(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const r=this.radius;if(n===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);const a=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let c=0;c<n;c++){const u=a+c*o,h=c%2===0?r:i;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=Nl,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Q1 extends K1{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new Q1({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}}class hm{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new hm({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=Ug(null,e.src,{crossOrigin:"anonymous"},void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===Dn.IDLE&&n.load(),n.getImageState()===Dn.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?rr(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Xh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function dD(t,e,n,r){return n!==void 0&&r!==void 0?[n/t,r/e]:n!==void 0?n/t:r!==void 0?r/e:1}class Rc extends F1{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,a=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:a,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.referrerPolicy_=e.referrerPolicy;const o=e.img!==void 0?e.img:null;let c=e.src;_r(!(c!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(c===void 0||c.length===0)&&o&&(c=o.src||rr(o)),_r(c!==void 0&&c.length>0,"A defined and non-empty `src` or `image` must be provided"),_r(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Dn.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Dn.LOADED:Dn.IDLE:u=Dn.LOADING:u=Dn.LOADED),this.color_=e.color!==void 0?Xh(e.color):null,this.iconImage_=Ug(o,c,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,m;if(e.size)[h,m]=e.size;else{const _=this.getImage(1);if(_.width&&_.height)h=_.width,m=_.height;else if(_ instanceof HTMLImageElement){this.initialOptions_=e;const p=()=>{if(this.unlistenImageChange(p),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(dD(g[0],g[1],e.width,e.height))};this.listenImageChange(p);return}}h!==void 0&&this.setScale(dD(h,m,e.width,e.height))}}clone(){let e,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Rc({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),r=this.getScaleArray();return[e[0]-n[0]/r[0],e[1]+n[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}setColor(e){const n=e?Xh(e):null;if(this.color_===n||this.color_&&n&&this.color_.length===n.length&&this.color_.every((o,c)=>o===n[c]))return;this.color_=n;const r=this.getSrc(),i=r!==void 0?null:this.getHitDetectionImage(),a=r!==void 0?Dn.IDLE:this.iconImage_.getImageState();this.iconImage_=Ug(i,r,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},a,this.color_)}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Ug(null,e,{crossOrigin:this.crossOrigin_,referrerPolicy:this.referrerPolicy_},Dn.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Dn.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Dn.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Mn.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Mn.CHANGE,e)}ready(){return this.iconImage_.ready()}}class Y1{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.offset_=e.offset,this.width_=e.width}clone(){const e=this.getColor();return new Y1({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),offset:this.getOffset(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getOffset(){return this.offset_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setOffset(e){this.offset_=e}setWidth(e){this.width_=e}}class Wl{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=uD,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Wl({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=uD,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function r9(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(_r(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let Vb=null;function JI(t,e){if(!Vb){const n=new hm({color:"rgba(255,255,255,0.4)"}),r=new Y1({color:"#3399CC",width:1.25});Vb=[new Wl({image:new Q1({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return Vb}function uD(t){return t.getGeometry()}const i9="#333";class WN{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=El(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new hm({color:i9}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new WN({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof hm?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=El(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}function a9(t){return!0}function l9(t){const e=YI(),n=o9(t,e),r=$I();return function(i,a){if(r.properties=i.getPropertiesInternal(),r.resolution=a,e.featureId){const o=i.getId();o!==void 0?r.featureId=o:r.featureId=null}return e.geometryType&&(r.geometryType=VI(i.getGeometry())),n(r)}}function hD(t){const e=YI(),n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=m2(t[o],e);const i=$I(),a=new Array(n);return function(o,c){if(i.properties=o.getPropertiesInternal(),i.resolution=c,e.featureId){const h=o.getId();h!==void 0?i.featureId=h:i.featureId=null}let u=0;for(let h=0;h<n;++h){const m=r[h](i);m&&(a[u]=m,u+=1)}return a.length=u,a}}function o9(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const a=t[i],o="filter"in a?Lc(a.filter,Ha,e):a9;let c;if(Array.isArray(a.style)){const u=a.style.length;c=new Array(u);for(let h=0;h<u;++h)c[h]=m2(a.style[h],e)}else c=[m2(a.style,e)];r[i]={filter:o,styles:c}}return function(i){const a=[];let o=!1;for(let c=0;c<n;++c){const u=r[c].filter;if(u(i)&&!(t[c].else&&o)){o=!0;for(const h of r[c].styles){const m=h(i);m&&a.push(m)}}}return a}}function m2(t,e){const n=r_(t,"",e),r=i_(t,"",e),i=c9(t,e),a=d9(t,e),o=Ea(t,"z-index",e);if(!n&&!r&&!i&&!a&&!lm(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const c=new Wl;return function(u){let h=!0;if(n){const m=n(u);m&&(h=!1),c.setFill(m)}if(r){const m=r(u);m&&(h=!1),c.setStroke(m)}if(i){const m=i(u);m&&(h=!1),c.setText(m)}if(a){const m=a(u);m&&(h=!1),c.setImage(m)}return o&&c.setZIndex(o(u)),h?null:c}}function r_(t,e,n){let r;if(e+"fill-pattern-src"in t)r=m9(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return a=>null;r=V1(t,e+"fill-color",n)}if(!r)return null;const i=new hm;return function(a){const o=r(a);return o===kN?null:(i.setColor(o),i)}}function i_(t,e,n){const r=Ea(t,e+"stroke-width",n),i=V1(t,e+"stroke-color",n);if(!r&&!i)return null;const a=fd(t,e+"stroke-line-cap",n),o=fd(t,e+"stroke-line-join",n),c=ZI(t,e+"stroke-line-dash",n),u=Ea(t,e+"stroke-line-dash-offset",n),h=Ea(t,e+"stroke-miter-limit",n),m=Ea(t,e+"stroke-offset",n),_=new Y1;return function(p){if(i){const g=i(p);if(g===kN)return null;_.setColor(g)}if(r&&_.setWidth(r(p)),a){const g=a(p);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");_.setLineCap(g)}if(o){const g=o(p);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");_.setLineJoin(g)}return c&&_.setLineDash(c(p)),u&&_.setLineDashOffset(u(p)),h&&_.setMiterLimit(h(p)),m&&_.setOffset(m(p)),_}}function c9(t,e){const n="text-",r=fd(t,n+"value",e);if(!r)return null;const i=r_(t,n,e),a=r_(t,n+"background-",e),o=i_(t,n,e),c=i_(t,n+"background-",e),u=fd(t,n+"font",e),h=Ea(t,n+"max-angle",e),m=Ea(t,n+"offset-x",e),_=Ea(t,n+"offset-y",e),p=kf(t,n+"overflow",e),g=fd(t,n+"placement",e),C=Ea(t,n+"repeat",e),y=$1(t,n+"scale",e),S=kf(t,n+"rotate-with-view",e),v=Ea(t,n+"rotation",e),k=fd(t,n+"align",e),L=fd(t,n+"justify",e),M=fd(t,n+"baseline",e),P=kf(t,n+"keep-upright",e),F=ZI(t,n+"padding",e),G=z1(t,n+"declutter-mode"),B=new WN({declutterMode:G});return function(I){if(B.setText(r(I)),i&&B.setFill(i(I)),a&&B.setBackgroundFill(a(I)),o&&B.setStroke(o(I)),c&&B.setBackgroundStroke(c(I)),u&&B.setFont(u(I)),h&&B.setMaxAngle(h(I)),m&&B.setOffsetX(m(I)),_&&B.setOffsetY(_(I)),p&&B.setOverflow(p(I)),g){const E=g(I);if(E!=="point"&&E!=="line")throw new Error("Expected point or line for text-placement");B.setPlacement(E)}if(C&&B.setRepeat(C(I)),y&&B.setScale(y(I)),S&&B.setRotateWithView(S(I)),v&&B.setRotation(v(I)),k){const E=k(I);if(E!=="left"&&E!=="center"&&E!=="right"&&E!=="end"&&E!=="start")throw new Error("Expected left, right, center, start, or end for text-align");B.setTextAlign(E)}if(L){const E=L(I);if(E!=="left"&&E!=="right"&&E!=="center")throw new Error("Expected left, right, or center for text-justify");B.setJustify(E)}if(M){const E=M(I);if(E!=="bottom"&&E!=="top"&&E!=="middle"&&E!=="alphabetic"&&E!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");B.setTextBaseline(E)}return F&&B.setPadding(F(I)),P&&B.setKeepUpright(P(I)),B}}function d9(t,e){return"icon-src"in t?u9(t,e):"shape-points"in t?h9(t,e):"circle-radius"in t?f9(t,e):null}function u9(t,e){const n="icon-",r=n+"src",i=ej(t[r],r),a=e1(t,n+"anchor",e),o=$1(t,n+"scale",e),c=Ea(t,n+"opacity",e),u=e1(t,n+"displacement",e),h=Ea(t,n+"rotation",e),m=kf(t,n+"rotate-with-view",e),_=mD(t,n+"anchor-origin"),p=gD(t,n+"anchor-x-units"),g=gD(t,n+"anchor-y-units"),C=jd(t,n+"color");let y,S=null;C!==void 0&&(Array.isArray(C)&&C.length>0&&typeof C[0]=="string"?S=V1(t,n+"color",e):y=tj(C,n+"color"));const v=_9(t,n+"cross-origin"),k=x9(t,n+"offset"),L=mD(t,n+"offset-origin"),M=g2(t,n+"width"),P=g2(t,n+"height"),F=g9(t,n+"size"),G=z1(t,n+"declutter-mode"),B={src:i,anchorOrigin:_,anchorXUnits:p,anchorYUnits:g,crossOrigin:v,offset:k,offsetOrigin:L,height:P,width:M,size:F,declutterMode:G};let I=null;return function(E){if(I)S&&I.setColor(S(E));else{const A=S?S(E):y;I=new Rc(A!==void 0?Object.assign({},B,{color:A}):Object.assign({},B))}return c&&I.setOpacity(c(E)),u&&I.setDisplacement(u(E)),h&&I.setRotation(h(E)),m&&I.setRotateWithView(m(E)),o&&I.setScale(o(E)),a&&I.setAnchor(a(E)),I}}function h9(t,e){const n="shape-",r=n+"points",i=n+"radius",a=FN(t[r],r);if(!(i in t))throw new Error(`Expected a number for ${i}`);const o=Ea(t,i,e),c=typeof t[i]=="number"?t[i]:5,u=n+"radius2",h=Ea(t,u,e),m=typeof t[u]=="number"?t[u]:void 0,_=r_(t,n,e),p=i_(t,n,e),g=$1(t,n+"scale",e),C=e1(t,n+"displacement",e),y=Ea(t,n+"rotation",e),S=kf(t,n+"rotate-with-view",e),v=g2(t,n+"angle"),k=z1(t,n+"declutter-mode"),L=new K1({points:a,radius:c,radius2:m,angle:v,declutterMode:k});return function(M){return o&&L.setRadius(o(M)),h&&L.setRadius2(h(M)),_&&L.setFill(_(M)),p&&L.setStroke(p(M)),C&&L.setDisplacement(C(M)),y&&L.setRotation(y(M)),S&&L.setRotateWithView(S(M)),g&&L.setScale(g(M)),L}}function f9(t,e){const n="circle-",r=r_(t,n,e),i=i_(t,n,e),a=Ea(t,n+"radius",e),o=$1(t,n+"scale",e),c=e1(t,n+"displacement",e),u=Ea(t,n+"rotation",e),h=kf(t,n+"rotate-with-view",e),m=z1(t,n+"declutter-mode"),_=new Q1({radius:5,declutterMode:m});return function(p){return a&&_.setRadius(a(p)),r&&_.setFill(r(p)),i&&_.setStroke(i(p)),c&&_.setDisplacement(c(p)),u&&_.setRotation(u(p)),h&&_.setRotateWithView(h(p)),o&&_.setScale(o(p)),_}}function jd(t,e){if(!(e in t))return;const n=t[e];return n===void 0?void 0:n}function Ea(t,e,n){const r=jd(t,e);if(r===void 0)return;const i=Lc(r,Wn,n);return function(a){return FN(i(a),e)}}function fd(t,e,n){const r=jd(t,e);if(r===void 0)return null;const i=Lc(r,Cl,n);return function(a){return ej(i(a),e)}}function m9(t,e,n){const r=fd(t,e+"pattern-src",n),i=fD(t,e+"pattern-offset",n),a=fD(t,e+"pattern-size",n),o=V1(t,e+"color",n);return function(c){return{src:r(c),offset:i&&i(c),size:a&&a(c),color:o&&o(c)}}}function kf(t,e,n){const r=jd(t,e);if(r===void 0)return null;const i=Lc(r,Ha,n);return function(a){const o=i(a);if(typeof o!="boolean")throw new Error(`Expected a boolean for ${e}`);return o}}function V1(t,e,n){const r=jd(t,e);if(r===void 0)return null;const i=Lc(r,Ho,n);return function(a){return tj(i(a),e)}}function ZI(t,e,n){const r=jd(t,e);if(r===void 0)return null;if(Array.isArray(r)&&(r.length===0||typeof r[0]!="string")){const a=r.map((o,c)=>{if(typeof o=="number")return()=>o;const u=Lc(o,Wn,n);return function(h){return FN(u(h),`${e}[${c}]`)}});return function(o){const c=new Array(a.length);for(let u=0;u<a.length;++u)c[u]=a[u](o);return c}}const i=Lc(r,Jh,n);return function(a){return R_(i(a),e)}}function e1(t,e,n){const r=jd(t,e);if(r===void 0)return null;const i=Lc(r,Jh,n);return function(a){const o=R_(i(a),e);if(o.length!==2)throw new Error(`Expected two numbers for ${e}`);return o}}function fD(t,e,n){const r=jd(t,e);if(r===void 0)return null;const i=Lc(r,Jh,n);return function(a){return sj(i(a),e)}}function $1(t,e,n){const r=jd(t,e);if(r===void 0)return null;const i=Lc(r,Jh|Wn,n);return function(a){return p9(i(a),e)}}function g2(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function g9(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return El(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function _9(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function mD(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function gD(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function x9(t,e){const n=t[e];if(n!==void 0)return R_(n,e)}function z1(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function R_(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if(typeof t[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function ej(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function FN(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function tj(t,e){if(typeof t=="string")return t;const n=R_(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function sj(t,e){const n=R_(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function p9(t,e){return typeof t=="number"?t:sj(t,e)}const _D={RENDER_ORDER:"renderOrder"};class nj extends W1{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(_D.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new KI(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(_D.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?JI:e;const n=y9(e);this.styleFunction_=e===null?void 0:r9(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function y9(t){if(t===void 0)return JI;if(!t)return null;if(typeof t=="function"||t instanceof Wl)return t;if(!Array.isArray(t))return hD([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof Wl){const i=new Array(e);for(let a=0;a<e;++a){const o=t[a];if(!(o instanceof Wl))throw new Error("Expected a list of style instances");i[a]=o}return i}if("style"in n){const i=new Array(e);for(let a=0;a<e;++a){const o=t[a];if(!("style"in o))throw new Error("Expected a list of rules with a style property");i[a]=o}return l9(i)}return hD(t)}class rj extends Id{constructor(e,n,r,i){super(e),this.inversePixelTransform=n,this.frameState=r,this.context=i}}class b9 extends T1{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){sr()}calculateMatrices2D(e){const n=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Dd(r,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),EI(i,r)}forEachFeatureAtCoordinate(e,n,r,i,a,o,c,u){let h;const m=n.viewState;function _(M,P,F,G){return a.call(o,P,M?F:null,G)}const p=m.projection,g=mI(e.slice(),p),C=[[0,0]];if(p.canWrapX()&&i){const M=p.getExtent(),P=hr(M);C.push([-P,0],[P,0])}const y=n.layerStatesArray,S=y.length,v=[],k=[];for(let M=0;M<C.length;M++)for(let P=S-1;P>=0;--P){const F=y[P],G=F.layer;if(G.hasRenderer()&&AN(F,m)&&c.call(u,G)){const B=G.getRenderer(),I=G.getSource();if(B&&I){const E=I.getWrapX()?g:e,A=_.bind(null,F.managed);k[0]=E[0]+C[M][0],k[1]=E[1]+C[M][1],h=B.forEachFeatureAtCoordinate(k,n,r,A,v)}if(h)return h}}if(v.length===0)return;const L=1/v.length;return v.forEach((M,P)=>M.distanceSq+=P*L),v.sort((M,P)=>M.distanceSq-P.distanceSq),v.some(M=>h=M.callback(M.feature,M.layer,M.geometry)),h}hasFeatureAtCoordinate(e,n,r,i,a,o){return this.forEachFeatureAtCoordinate(e,n,r,i,Hg,this,a,o)!==void 0}getMap(){return this.map_}renderFrame(e){sr()}scheduleExpireIconCache(e){mo.canExpireCache()&&e.postRenderFunctions.push(C9)}}function C9(t,e){mo.expire()}class N9 extends b9{constructor(e){super(e),this.fontChangeListenerKey_=nr(yf,am.PROPERTYCHANGE,e.redrawText,e),this.element_=ho?AI():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=B1+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const r=this.getMap();if(r.hasListener(e)){const i=new rj(e,void 0,n);r.dispatchEvent(i)}}disposeInternal(){ei(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(fo.PRECOMPOSE,e);const n=e.layerStatesArray.sort((h,m)=>h.zIndex-m.zIndex);n.some(h=>h.layer instanceof nj&&h.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const a=[];let o=null;for(let h=0,m=n.length;h<m;++h){const _=n[h];e.layerIndex=h;const p=_.layer,g=p.getSourceState();if(!AN(_,i)||g!="ready"&&g!="undefined"){p.unrender();continue}const C=p.render(e,o);C&&(C!==o&&(this.children_.push(C),o=C),a.push(_))}this.declutter(e,a),Ok(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Pu(u)){const h=u.getContext("2d");for(const m of this.children_){const _=m.firstElementChild||m,p=m.style.backgroundColor;if(p&&(!Pu(_)||_.width>0)&&(h.fillStyle=p,h.fillRect(0,0,u.width,u.height)),Pu(_)&&_.width>0){h.save();const g=m.style.opacity||_.style.opacity;h.globalAlpha=g===""?1:Number(g);const C=_.style.transform;if(C)h.transform(...c2(C));else{const y=parseFloat(_.style.width)/_.width,S=parseFloat(_.style.height)/_.height;h.transform(y,0,0,S,0,0)}h.drawImage(_,0,0),h.restore()}}}this.dispatchRenderEvent(fo.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let r=n.length-1;r>=0;--r){const i=n[r],a=i.layer;a.getDeclutter()&&a.renderDeclutter(e,i)}n.forEach(r=>r.layer.renderDeferred(e))}}}function ij(t){if(t instanceof W1){t.setMapInternal(null);return}t instanceof pm&&t.getLayers().forEach(ij)}function aj(t,e){if(t instanceof W1){t.setMapInternal(e);return}if(t instanceof pm){const n=t.getLayers().getArray();for(let r=0,i=n.length;r<i;++r)aj(n[r],e)}}let xD=class extends kc{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=S9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:r8,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Xo(),this.pixelToCoordinateTransform_=Xo(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ho||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ho||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(ho?new uo:Ak()),this.interactions=n.interactions||(ho?new uo:r7({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new l8(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Aa.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Aa.VIEW,this.handleViewChanged_),this.addChangeListener(Aa.SIZE,this.handleSizeChanged_),this.addChangeListener(Aa.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const r=this;e.view&&!(e.view instanceof zo)&&e.view.then(function(i){r.setView(new zo(i))}),this.controls.addEventListener(bl.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(bl.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(bl.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(bl.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(bl.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(bl.REMOVE,i=>{const a=i.element.getId();a!==void 0&&delete this.overlayIdIndex_[a.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){aj(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){var e;this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),(e=this.resizeObserver_)==null||e.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const a=r.hitTolerance!==void 0?r.hitTolerance:0,o=r.layerFilter!==void 0?r.layerFilter:Hg,c=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,a,c,n,null,o,null)}getFeaturesAtPixel(e,n){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},n),r}getAllLayers(){const e=[];function n(r){r.forEach(function(i){i instanceof pm?n(i.getLayers()):e.push(i)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const i=n.layerFilter!==void 0?n.layerFilter:Hg,a=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,a,o,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),a=r.width/i[0],o=r.height/i[1],c="changedTouches"in e?e.changedTouches[0]:e;return[(c.clientX-r.left)/a,(c.clientY-r.top)/o]}getTarget(){return this.get(Aa.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return o2(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?fa(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Aa.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof uo){n.setLayers(e);return}const r=n.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,r=e.length;n<r;++n){const i=e[n];if(!i.visible)continue;const a=i.layer.getRenderer();if(a&&!a.ready)return!0;const o=i.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=ud(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?fa(n.coordinateToPixelTransform,e.slice(0,2)):null}getPixelRatio(){return this.pixelRatio_}setPixelRatio(e){this.pixelRatio_!==e&&(this.pixelRatio_=e,this.render())}getRenderer(){return this.renderer_}getSize(){return this.get(Aa.SIZE)}getView(){return this.get(Aa.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,r,i){return o8(this.frameState_,e,n,r,i)}handleBrowserEvent(e,n){n=n||e.type;const r=new Cu(n,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,r=n.type;if(r===ZC.POINTERDOWN||r===Mn.WHEEL||r===Mn.KEYDOWN){const i=this.getOwnerDocument(),a=this.viewport_.getRootNode?this.viewport_.getRootNode():i,o=n.target,c=a instanceof ShadowRoot?a.host===o?a.host.ownerDocument:a:a===i?i.documentElement:a;if(this.overlayContainerStopEvent_.contains(o)||!c.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let a=i.length-1;a>=0;a--){const o=i[a];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let i=this.maxTilesLoading_,a=i;if(e){const o=e.viewHints;if(o[ka.ANIMATING]||o[ka.INTERACTING]){const c=Date.now()-e.time>8;i=c?0:8,a=c?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,a))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(fo.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(fo.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new xf(Nu.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new xf(Nu.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,a=r.length;i<a;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){var r,i;if(this.mapBrowserEventHandler_){for(let a=0,o=this.targetChangeHandlerKeys_.length;a<o;++a)ei(this.targetChangeHandlerKeys_[a]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Mn.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Mn.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Pu(this.targetElement_)){(r=this.resizeObserver_)==null||r.unobserve(this.targetElement_);const a=this.targetElement_.getRootNode();a instanceof ShadowRoot&&this.resizeObserver_.unobserve(a.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Pu(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new N9(this)),!Pu(n)){this.mapBrowserEventHandler_=new i8(this,this.moveTolerance_);for(const o in pi)this.mapBrowserEventHandler_.addEventListener(pi[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Mn.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Mn.WHEEL,this.boundHandleBrowserEvent_,rI?{passive:!1}:!1);let a;if(this.keyboardEventTarget_)a=this.keyboardEventTarget_;else{const o=n.getRootNode();a=o instanceof ShadowRoot?o.host:n}if(this.targetChangeHandlerKeys_=[nr(a,Mn.KEYDOWN,this.handleBrowserEvent,this),nr(a,Mn.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const o=n.getRootNode();o instanceof ShadowRoot&&this.resizeObserver_.observe(o.host),(i=this.resizeObserver_)==null||i.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ei(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ei(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nr(e,am.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nr(e,Mn.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ei),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Su("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nr(e,am.PROPERTYCHANGE,this.render,this),nr(e,Mn.CHANGE,this.render,this),nr(e,"addlayer",this.handleLayerAdd_,this),nr(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,r=e.length;n<r;++n){const i=e[n].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){ij(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),r=this.getView(),i=this.frameState_;let a=null;if(n!==void 0&&rD(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),c=r.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:n2(c.center,c.resolution,c.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:c,viewHints:o,wantedTiles:{},mapId:rr(this),renderTargets:{}},c.nextCenter&&c.nextResolution){const u=isNaN(c.nextRotation)?c.rotation:c.nextRotation;a.nextExtent=n2(c.nextCenter,c.nextResolution,u,n)}}this.frameState_=a,this.renderer_.renderFrame(a),a&&(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),i&&(!this.previousExtent_||!S_(this.previousExtent_)&&!Xg(a.extent,this.previousExtent_))&&(this.dispatchEvent(new xf(Nu.MOVESTART,this,i)),this.previousExtent_=O1(this.previousExtent_)),this.previousExtent_&&!a.viewHints[ka.ANIMATING]&&!a.viewHints[ka.INTERACTING]&&!Xg(a.extent,this.previousExtent_)&&(this.dispatchEvent(new xf(Nu.MOVEEND,this,a)),iI(a.extent,this.previousExtent_))),this.dispatchEvent(new xf(Nu.POSTRENDER,this,a)),this.renderComplete_=(this.hasListener(Nu.LOADSTART)||this.hasListener(Nu.LOADEND)||this.hasListener(fo.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new Su("removelayer",n)),this.set(Aa.LAYERGROUP,e)}setSize(e){this.set(Aa.SIZE,e)}setTarget(e){this.set(Aa.TARGET,e)}setView(e){if(!e||e instanceof zo){this.set(Aa.VIEW,e);return}this.set(Aa.VIEW,new zo);const n=this;e.then(function(r){n.setView(new zo(r))})}updateSize(){const e=this.getTargetElement();let n;if(e){let i,a;if(Pu(e)){const o=e.getContext("2d").getTransform();i=e.width/o.a,a=e.height/o.d}else{const o=getComputedStyle(e);i=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),a=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(i)&&!isNaN(a)&&(n=[Math.max(0,i),Math.max(0,a)],!rD(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&xI("No map visible because the map container's width or height are 0."))}const r=this.getSize();n&&(!r||!Ju(n,r))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function S9(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new pm({layers:t.layers});n[Aa.LAYERGROUP]=r,n[Aa.TARGET]=t.target,n[Aa.VIEW]=t.view instanceof zo?t.view:new zo;let i;t.controls!==void 0&&(Array.isArray(t.controls)?i=new uo(t.controls.slice()):(_r(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls));let a;t.interactions!==void 0&&(Array.isArray(t.interactions)?a=new uo(t.interactions.slice()):(_r(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),a=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new uo(t.overlays.slice()):(_r(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new uo,{controls:i,interactions:a,keyboardEventTarget:e,overlays:o,values:n}}class KN extends I1{constructor(e,n,r){super(),r=r||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Mn.CHANGE)}release(){this.setState(dn.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==dn.EMPTY){if(this.state!==dn.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){sr()}getAlpha(e,n){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=n,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=n-r+1e3/60;return i>=this.transition_?1:_I(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function _2(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const v9=new Error("disposed"),E9=[256,256];class pD extends KN{constructor(e){const n=dn.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=_2(this.data_);return e?[e.width,e.height]:E9}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==dn.IDLE&&this.state!==dn.ERROR)return;this.state=dn.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=dn.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=dn.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(v9),this.controller_=null),super.disposeInternal()}}class lj extends KN{constructor(e,n,r,i,a,o){super(e,n,o),this.crossOrigin_=i==null?void 0:i.crossOrigin,this.referrerPolicy_=i==null?void 0:i.referrerPolicy,this.src_=r,this.key=r,this.image_,ho?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)),this.unlisten_=null,this.tileLoadFunction_=a}getImage(){return this.image_}setImage(e){this.image_=e,this.state=dn.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}getReferrerPolicy(){return this.referrerPolicy_}handleImageError_(){this.state=dn.ERROR,this.unlistenImage_(),this.image_=D9(),this.changed()}handleImageLoad_(){if(ho)this.state=dn.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=dn.LOADED:this.state=dn.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==dn.ERROR&&(this.state=dn.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_),this.referrerPolicy_!==void 0&&(this.image_.referrerPolicy=this.referrerPolicy_)),this.state==dn.IDLE&&(this.state=dn.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Y7(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function D9(){const t=Ui(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}class QN{constructor(e,n,r,i){this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function af(t,e,n,r,i){return i!==void 0?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new QN(t,e,n,r)}let $b;const Uf=[];function yD(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function zb(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function R9(){if($b===void 0){const t=Ui(6,6,Uf);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",yD(t,4,5,4,0),yD(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;$b=zb(e,0)||zb(e,4)||zb(e,8),G1(t),Uf.push(t.canvas)}return $b}function bD(t,e,n,r){const i=SN(n,e,t);let a=FE(e,r,n);const o=e.getMetersPerUnit();o!==void 0&&(a*=o);const c=t.getMetersPerUnit();c!==void 0&&(a/=c);const u=t.getExtent();if(!u||om(u,i)){const h=FE(t,a,i)/a;isFinite(h)&&h>0&&(a/=h)}return a}function T9(t,e,n,r){const i=Hh(n);let a=bD(t,e,i,r);return(!isFinite(a)||a<=0)&&dI(n,function(o){return a=bD(t,e,o,r),isFinite(a)&&a>0}),a}function M9(t,e,n,r,i,a,o,c,u,h,m,_,p,g){const C=Ui(Math.round(n*t),Math.round(n*e),Uf);if(_||(C.imageSmoothingEnabled=!1),u.length===0)return C.canvas;C.scale(n,n);function y(P){return Math.round(P*n)/n}C.globalCompositeOperation="lighter";const S=yo();u.forEach(function(P,F,G){h8(S,P.extent)});let v;const k=n/r,L=(_?1:1+Math.pow(2,-24))/k;v=Ui(Math.round(hr(S)*k),Math.round(Xa(S)*k),Uf),_||(v.imageSmoothingEnabled=!1),u.forEach(function(P,F,G){if(P.image.width>0&&P.image.height>0){if(P.clipExtent){v.save();const Y=(P.clipExtent[0]-S[0])*k,ee=-(P.clipExtent[3]-S[3])*k,J=hr(P.clipExtent)*k,H=Xa(P.clipExtent)*k;v.rect(_?Y:Math.round(Y),_?ee:Math.round(ee),_?J:Math.round(Y+J)-Math.round(Y),_?H:Math.round(ee+H)-Math.round(ee)),v.clip()}const B=(P.extent[0]-S[0])*k,I=-(P.extent[3]-S[3])*k,E=hr(P.extent)*k,A=Xa(P.extent)*k;v.drawImage(P.image,h,h,P.image.width-2*h,P.image.height-2*h,_?B:Math.round(B),_?I:Math.round(I),_?E:Math.round(B+E)-Math.round(B),_?A:Math.round(I+A)-Math.round(I)),P.clipExtent&&v.restore()}});const M=u0(o);return c.getTriangles().forEach(function(P,F,G){const B=P.source,I=P.target;let E=B[0][0],A=B[0][1],Y=B[1][0],ee=B[1][1],J=B[2][0],H=B[2][1];const V=y((I[0][0]-M[0])/a),K=y(-(I[0][1]-M[1])/a),j=y((I[1][0]-M[0])/a),te=y(-(I[1][1]-M[1])/a),ce=y((I[2][0]-M[0])/a),R=y(-(I[2][1]-M[1])/a),O=E,U=A;E=0,A=0,Y-=O,ee-=U,J-=O,H-=U;const Q=[[Y,ee,0,0,j-V],[J,H,0,0,ce-V],[0,0,Y,ee,te-K],[0,0,J,H,R-K]],q=d8(Q);if(!q)return;if(C.save(),C.beginPath(),R9()||!_){C.moveTo(j,te);const de=4,ae=V-j,_e=K-te;for(let ie=0;ie<de;ie++)C.lineTo(j+y((ie+1)*ae/de),te+y(ie*_e/(de-1))),ie!=de-1&&C.lineTo(j+y((ie+1)*ae/de),te+y((ie+1)*_e/(de-1)));C.lineTo(ce,R)}else C.moveTo(j,te),C.lineTo(V,K),C.lineTo(ce,R);C.clip(),C.transform(q[0],q[2],q[1],q[3],V,K),C.translate(S[0]-O,S[3]-U);let $;if(v)$=v.canvas,C.scale(L,-L);else{const de=u[0],ae=de.extent;$=de.image,C.scale(hr(ae)/$.width,-Xa(ae)/$.height)}C.drawImage($,0,0),C.restore()}),v&&(G1(v),Uf.push(v.canvas)),m&&(C.save(),C.globalCompositeOperation="source-over",C.strokeStyle="black",C.lineWidth=1,c.getTriangles().forEach(function(P,F,G){const B=P.target,I=(B[0][0]-M[0])/a,E=-(B[0][1]-M[1])/a,A=(B[1][0]-M[0])/a,Y=-(B[1][1]-M[1])/a,ee=(B[2][0]-M[0])/a,J=-(B[2][1]-M[1])/a;C.beginPath(),C.moveTo(A,Y),C.lineTo(I,E),C.lineTo(ee,J),C.closePath(),C.stroke()}),C.restore()),C.canvas}const I9=10,CD=.25;class j9{constructor(e,n,r,i,a,o,c){this.sourceProj_=e,this.targetProj_=n;let u={};const h=c?l2(L=>fa(c,SN(L,this.targetProj_,this.sourceProj_))):qp(this.targetProj_,this.sourceProj_);this.transformInv_=function(L){const M=L[0]+"/"+L[1];return u[M]||(u[M]=h(L)),u[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&hr(i)>=hr(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?hr(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?hr(this.targetProj_.getExtent()):null;const m=u0(r),_=P1(r),p=L1(r),g=w1(r),C=this.transformInv_(m),y=this.transformInv_(_),S=this.transformInv_(p),v=this.transformInv_(g),k=I9+(o?Math.max(0,Math.ceil(Math.log2(s2(r)/(o*o*256*256)))):0);if(this.addQuad_(m,_,p,g,C,y,S,v,k),this.wrapsXInSource_){let L=1/0;this.triangles_.forEach(function(M,P,F){L=Math.min(L,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-L>this.sourceWorldWidth_/2){const P=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];P[0][0]-L>this.sourceWorldWidth_/2&&(P[0][0]-=this.sourceWorldWidth_),P[1][0]-L>this.sourceWorldWidth_/2&&(P[1][0]-=this.sourceWorldWidth_),P[2][0]-L>this.sourceWorldWidth_/2&&(P[2][0]-=this.sourceWorldWidth_);const F=Math.min(P[0][0],P[1][0],P[2][0]);Math.max(P[0][0],P[1][0],P[2][0])-F<this.sourceWorldWidth_/2&&(M.source=P)}})}u={}}addTriangle_(e,n,r,i,a,o){this.triangles_.push({source:[i,a,o],target:[e,n,r]})}addQuad_(e,n,r,i,a,o,c,u,h){const m=Yp([a,o,c,u]),_=this.sourceWorldWidth_?hr(m)/this.sourceWorldWidth_:null,p=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&_>.5&&_<1;let C=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const S=Yp([e,n,r,i]);C=hr(S)/this.targetWorldWidth_>CD||C}!g&&this.sourceProj_.isGlobal()&&_&&(C=_>CD||C)}if(!C&&this.maxSourceExtent_&&isFinite(m[0])&&isFinite(m[1])&&isFinite(m[2])&&isFinite(m[3])&&!Sl(m,this.maxSourceExtent_))return;let y=0;if(!C&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(c[0])||!isFinite(c[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)C=!0;else if(y=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(c[0])||!isFinite(c[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),y!=1&&y!=2&&y!=4&&y!=8)return}if(h>0){if(!C){const S=[(e[0]+r[0])/2,(e[1]+r[1])/2],v=this.transformInv_(S);let k;g?k=(Pf(a[0],p)+Pf(c[0],p))/2-Pf(v[0],p):k=(a[0]+c[0])/2-v[0];const L=(a[1]+c[1])/2-v[1];C=k*k+L*L>this.errorThresholdSquared_}if(C){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const S=[(n[0]+r[0])/2,(n[1]+r[1])/2],v=this.transformInv_(S),k=[(i[0]+e[0])/2,(i[1]+e[1])/2],L=this.transformInv_(k);this.addQuad_(e,n,S,k,a,o,v,L,h-1),this.addQuad_(k,S,r,i,L,v,c,u,h-1)}else{const S=[(e[0]+n[0])/2,(e[1]+n[1])/2],v=this.transformInv_(S),k=[(r[0]+i[0])/2,(r[1]+i[1])/2],L=this.transformInv_(k);this.addQuad_(e,S,k,i,a,v,L,u,h-1),this.addQuad_(S,n,r,k,v,o,c,L,h-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(y&11)==0&&this.addTriangle_(e,r,i,a,c,u),(y&14)==0&&this.addTriangle_(e,r,n,a,c,o),y&&((y&13)==0&&this.addTriangle_(n,i,e,o,u,a),(y&7)==0&&this.addTriangle_(n,i,r,o,u,c))}calculateSourceExtent(){const e=yo();return this.triangles_.forEach(function(n,r,i){const a=n.source;Ag(e,a[0]),Ag(e,a[1]),Ag(e,a[2])}),e}getTriangles(){return this.triangles_}}const O9=.5;class oj extends KN{constructor(e,n,r,i,a,o,c,u,h,m,_,p){super(a,dn.IDLE,p),this.renderEdges_=_!==void 0?_:!1,this.pixelRatio_=c,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=i,this.wrappedTileCoord_=o||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const g=i.getTileCoordExtent(this.wrappedTileCoord_),C=this.targetTileGrid_.getExtent();let y=this.sourceTileGrid_.getExtent();const S=C?Kh(g,C):g;if(s2(S)===0){this.state=dn.EMPTY;return}const v=e.getExtent();v&&(y?y=Kh(y,v):y=v);const k=i.getResolution(this.wrappedTileCoord_[0]),L=T9(e,r,S,k);if(!isFinite(L)||L<=0){this.state=dn.EMPTY;return}const M=m!==void 0?m:O9;if(this.triangulation_=new j9(e,r,S,y,L*M,k),this.triangulation_.getTriangles().length===0){this.state=dn.EMPTY;return}this.sourceZ_=n.getZForResolution(L);let P=this.triangulation_.calculateSourceExtent();if(y&&(e.canWrapX()?(P[1]=Ur(P[1],y[1],y[3]),P[3]=Ur(P[3],y[1],y[3])):P=Kh(P,y)),!s2(P))this.state=dn.EMPTY;else{let F=0,G=0;e.canWrapX()&&(F=hr(v),G=Math.floor((P[0]-v[0])/F)),fI(P.slice(),e,!0).forEach(I=>{const E=n.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let A=E.minX;A<=E.maxX;A++)for(let Y=E.minY;Y<=E.maxY;Y++){const ee=G*F;this.sourceTiles_.push({getTile:()=>h(this.sourceZ_,A,Y,c),offset:ee})}++G}),this.sourceTiles_.length===0&&(this.state=dn.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{var i;const r=n.tile;if(r&&r.getState()==dn.LOADED){const a=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);a[0]+=n.offset,a[2]+=n.offset;const o=(i=this.clipExtent_)==null?void 0:i.slice();o&&(o[0]+=n.offset,o[2]+=n.offset),e.push({extent:a,clipExtent:o,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=dn.ERROR;else{const n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i=typeof r=="number"?r:r[0],a=typeof r=="number"?r:r[1],o=this.targetTileGrid_.getResolution(n),c=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=M9(i,a,this.pixelRatio_,c,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=dn.LOADED}this.changed()}load(){for(const e of this.sourceTiles_)e.tile=e.getTile();if(this.state==dn.IDLE){this.state=dn.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const r=n.getState();if(r==dn.IDLE||r==dn.LOADING){e++;const i=nr(n,Mn.CHANGE,a=>{const o=n.getState();(o==dn.LOADED||o==dn.ERROR||o==dn.EMPTY)&&(ei(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},r,i){n.getState()==dn.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ei),this.sourcesListenerKeys_=null}release(){this.canvas_&&(G1(this.canvas_.getContext("2d")),Uf.push(this.canvas_),this.canvas_=null),this.sourceTiles_.length=0,super.release()}}class ND{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof T1&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const r=this.entries_[e];return _r(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const n=this.entries_[e];return _r(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.key_;return e}getValues(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var n;return(n=this.entries_[e])==null?void 0:n.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){_r(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function t1(t,e,n,r){return r!==void 0?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function w9(t,e,n){return t+"/"+e+"/"+n}function yp(t,e,n,r,i){return`${rr(t)},${e},${w9(n,r,i)}`}function L9(t){return P9(t[0],t[1],t[2])}function P9(t,e,n){return(e<<t)+n}function A9(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const a=e.getFullTileRange(n);return a?a.containsXY(r,i):!0}class cj{constructor(){dr(this,"pushMethodArgs_",(...e)=>(this.push_(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Jp(),{get:(e,n)=>{if(typeof Jp()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,r)=>(this.push_(n,r),!0)})}push_(...e){const n=this.instructions_,r=this.zIndex+this.offset_;n[r]||(n[r]=[]),n[r].push(...e)}pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let r=0,i=n.length;r<i;++r){const a=n[r];if(typeof a=="function"){a(e);continue}const o=n[++r];if(typeof e[a]=="function")e[a](...o);else{if(typeof o=="function"){e[a]=o(e);continue}e[a]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const k9=5;class U9 extends N_{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=k9}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return sr()}getData(e){return null}prepareFrame(e){return sr()}renderFrame(e,n){return sr()}forEachFeatureAtCoordinate(e,n,r,i,a){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===Dn.LOADED||n.getState()===Dn.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=Dn.LOADED&&n!=Dn.ERROR&&e.addEventListener(Mn.CHANGE,this.boundHandleImageChange_),n==Dn.IDLE&&(e.load(),n=e.getState()),n==Dn.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const SD=[];let bf=null;function B9(){bf=Ui(1,1,void 0,{willReadFrequently:!0})}class dj extends U9{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Xo(),this.pixelTransform=Xo(),this.inversePixelTransform=Xo(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,r){bf||B9(),bf.clearRect(0,0,1,1);let i;try{bf.drawImage(e,n,r,1,1,0,0,1,1),i=bf.getImageData(0,0,1,1).data}catch{return bf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,n,r){const i=this.getLayer().getClassName();let a,o;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&Ju(Xh(e.style.backgroundColor),Xh(r)))){const c=e.firstElementChild;Pu(c)&&(o=c.getContext("2d"))}if(o&&ek(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){a=ho?AI():document.createElement("div"),a.className=i;let c=a.style;c.position="absolute",c.width="100%",c.height="100%",o=Ui();const u=o.canvas;a.appendChild(u),c=u.style,c.position="absolute",c.left="0",c.transformOrigin="top left",this.container=a,this.context=o}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,n,r){const i=u0(r),a=P1(r),o=L1(r),c=w1(r);fa(n.coordinateToPixelTransform,i),fa(n.coordinateToPixelTransform,a),fa(n.coordinateToPixelTransform,o),fa(n.coordinateToPixelTransform,c);const u=this.inversePixelTransform;fa(u,i),fa(u,a),fa(u,o),fa(u,c),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(c[0]),Math.round(c[1])),e.clip()}prepareContainer(e,n){const r=e.extent,i=e.viewState.resolution,a=e.viewState.rotation,o=e.pixelRatio,c=Math.round(hr(r)/i*o),u=Math.round(Xa(r)/i*o);Dd(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,a,-c/2,-u/2),EI(this.inversePixelTransform,this.pixelTransform);const h=Z8(this.pixelTransform);if(this.useContainer(n,h,this.getBackground(e)),!this.containerReused){const m=this.context.canvas;m.width!=c||m.height!=u?(m.width=c,m.height=u):this.context.clearRect(0,0,c,u),h!==m.style.transform&&(m.style.transform=h)}}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){const a=new rj(e,this.inversePixelTransform,r,n);i.dispatchEvent(a)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(fo.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(fo.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new cj),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(fo.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(fo.POSTRENDER,this.context,e))}getRenderTransform(e,n,r,i,a,o,c){const u=a/2,h=o/2,m=i/n,_=-m,p=-e[0]+c,g=-e[1];return Dd(this.tempTransform,u,h,m,_,-r,p,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function Hb(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function G9(t,e,n){const r=t[n];return r?r.delete(e):!1}function vD(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=Kh(e,Lu(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=Kh(e,i))}return e}class W9 extends dj{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=yo(),this.tempTileRange_=new QN(0,0,0,0),this.tempTileCoord_=t1(0,0,0);const r=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new ND(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new ND(512)),this.sourceTileCache_}getOrCreateTile(e,n,r,i){const a=this.tileCache_,c=this.getLayer().getSource(),u=yp(c,c.getKey(),e,n,r);let h;if(a.containsKey(u))h=a.get(u);else{const m=i.viewState.projection,_=c.getProjection();if(h=c.getTile(e,n,r,i.pixelRatio,m,!_||pp(_,m)?void 0:this.getSourceTileCache()),!h)return null;a.set(u,h)}return h}getTile(e,n,r,i){const a=this.getOrCreateTile(e,n,r,i);return a||null}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=fa(n.pixelToCoordinateTransform,e.slice()),a=r.getExtent();if(a&&!om(a,i))return null;const o=n.viewState,c=r.getRenderSource(),u=c.getTileGridForProjection(o.projection),h=c.getTilePixelRatio(n.pixelRatio);for(let m=u.getZForResolution(o.resolution);m>=u.getMinZoom();--m){const _=u.getTileCoordForCoordAndZ(i,m),p=this.getTile(m,_[1],_[2],n);if(!p||p.getState()!==dn.LOADED)continue;const g=u.getOrigin(m),C=El(u.getTileSize(m)),y=u.getResolution(m);let S;if(p instanceof lj||p instanceof oj)S=p.getImage();else if(p instanceof pD){if(S=_2(p.getData()),!S)continue}else continue;const v=Math.floor(h*((i[0]-g[0])/y-_[1]*C[0])),k=Math.floor(h*((g[1]-i[1])/y-_[2]*C[1])),L=Math.round(h*c.getGutterForProjection(o.projection));return this.getImageData(S,v+L,k+L)}return null}prepareFrame(e){var i;this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const r=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),(i=this.sourceTileCache_)==null||i.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,r,i,a){const o=e.viewState,c=this.getLayer(),u=c.getRenderSource(),h=u.getTileGridForProjection(o.projection),m=rr(u);m in e.wantedTiles||(e.wantedTiles[m]={});const _=e.wantedTiles[m],p=c.getMapInternal(),g=Math.max(r-a,h.getMinZoom(),h.getZForResolution(Math.min(c.getMaxResolution(),p?p.getView().getResolutionForZoom(Math.max(c.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),C=o.rotation,y=C?uI(o.center,o.resolution,C,e.size):void 0;for(let S=r;S>=g;--S){const v=h.getTileRangeForExtentAndZ(n,S,this.tempTileRange_),k=h.getResolution(S);for(let L=v.minX;L<=v.maxX;++L)for(let M=v.minY;M<=v.maxY;++M){if(C&&!h.tileCoordIntersectsViewport([S,L,M],y))continue;const P=this.getTile(S,L,M,e);if(!P||!Hb(i,P,S))continue;const G=P.getKey();if(_[G]=!0,P.getState()===dn.IDLE&&!e.tileQueue.isKeyQueued(G)){const B=t1(S,L,M,this.tempTileCoord_);e.tileQueue.enqueue([P,m,h.getTileCoordCenter(B),k])}}}}findStaleTile_(e,n){const r=this.tileCache_,i=e[0],a=e[1],o=e[2],c=this.getStaleKeys();for(let u=0;u<c.length;++u){const h=yp(this.getLayer().getSource(),c[u],i,a,o);if(r.containsKey(h)){const m=r.peek(h);if(m.getState()===dn.LOADED)return m.endTransition(rr(this)),Hb(n,m,i),!0}}return!1}findAltTiles_(e,n,r,i){const a=e.getTileRangeForTileCoordAndZ(n,r,this.tempTileRange_);if(!a)return!1;let o=!0;const c=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let m=a.minX;m<=a.maxX;++m)for(let _=a.minY;_<=a.maxY;++_){const p=yp(u,h,r,m,_);let g=!1;if(c.containsKey(p)){const C=c.peek(p);C.getState()===dn.LOADED&&(Hb(i,C,r),g=!0)}g||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,a=i.projection,o=i.resolution,c=i.center,u=e.pixelRatio,h=this.getLayer(),m=h.getSource(),_=m.getTileGridForProjection(a),p=_.getZForResolution(o,m.zDirection),g=_.getResolution(p),C=m.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==C&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=C):this.renderedSourceKey_=C;let y=e.extent;const S=m.getTilePixelRatio(u);this.prepareContainer(e,n);const v=this.context.canvas.width,k=this.context.canvas.height,L=r.extent&&Lu(r.extent);L&&(y=Kh(y,Lu(r.extent)));const M=g*v/2/S,P=g*k/2/S,F=[c[0]-M,c[1]-P,c[0]+M,c[1]+P],G={};this.renderedTiles.length=0;const B=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const j=_.getZForResolution(i.nextResolution,m.zDirection),te=vD(e,e.nextExtent);this.enqueueTiles(e,te,j,G,B)}const I=vD(e,y);if(this.enqueueTiles(e,I,p,G,0),B>0&&setTimeout(()=>{this.enqueueTiles(e,I,p-1,G,B-1)},0),!(p in G))return this.container;const E=rr(this),A=e.time;for(const j of G[p]){const te=j.getState();if(te===dn.EMPTY)continue;const ce=j.tileCoord;if(te===dn.LOADED&&j.getAlpha(E,A)===1){j.endTransition(E);continue}if(te!==dn.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ce,G)){G9(G,j,p),e.animate=!0;continue}if(this.findAltTiles_(_,ce,p+1,G))continue;const U=_.getMinZoom();for(let Q=p-1;Q>=U&&!this.findAltTiles_(_,ce,Q,G);--Q);}const Y=g/o*u/S,ee=this.getRenderContext(e);Dd(this.tempTransform,v/2,k/2,Y,Y,0,-v/2,-k/2),r.extent&&this.clipUnrotated(ee,e,L),m.getInterpolate()||(ee.imageSmoothingEnabled=!1),this.preRender(ee,e);const J=Object.keys(G).map(Number);J.sort(yd);let H;const V=[],K=[];for(let j=J.length-1;j>=0;--j){const te=J[j],ce=m.getTilePixelSize(te,u,a),O=_.getResolution(te)/g,U=ce[0]*O*Y,Q=ce[1]*O*Y,q=_.getTileCoordForCoordAndZ(u0(F),te),$=_.getTileCoordExtent(q),de=fa(this.tempTransform,[S*($[0]-F[0])/g,S*(F[3]-$[3])/g]),ae=S*m.getGutterForProjection(a);for(const _e of G[te]){if(_e.getState()!==dn.LOADED)continue;const ie=_e.tileCoord,Ne=q[1]-ie[1],X=Math.round(de[0]-(Ne-1)*U),xe=q[2]-ie[2],fe=Math.round(de[1]-(xe-1)*Q),Z=Math.round(de[0]-Ne*U),le=Math.round(de[1]-xe*Q),se=X-Z,Re=fe-le,be=J.length===1;let De=!1;H=[Z,le,Z+se,le,Z+se,le+Re,Z,le+Re];for(let re=0,me=V.length;re<me;++re)if(!be&&te<K[re]){const ve=V[re];Sl([Z,le,Z+se,le+Re],[ve[0],ve[3],ve[4],ve[7]])&&(De||(ee.save(),De=!0),ee.beginPath(),ee.moveTo(H[0],H[1]),ee.lineTo(H[2],H[3]),ee.lineTo(H[4],H[5]),ee.lineTo(H[6],H[7]),ee.moveTo(ve[6],ve[7]),ee.lineTo(ve[4],ve[5]),ee.lineTo(ve[2],ve[3]),ee.lineTo(ve[0],ve[1]),ee.clip())}V.push(H),K.push(te),this.drawTile(_e,e,Z,le,se,Re,ae,be),De&&ee.restore(),this.renderedTiles.unshift(_e),this.updateUsedTiles(e.usedTiles,m,_e)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Xg(this.renderedExtent_,F),this.renderedExtent_=F,this.renderedPixelRatio=u,this.postRender(this.context,e),r.extent&&ee.restore(),ee.imageSmoothingEnabled=!0,this.renderComplete){const j=(te,ce)=>{var Q;const R=rr(m),O=ce.wantedTiles[R],U=O?Object.keys(O).length:0;this.updateCacheSize(U),this.tileCache_.expireCache(),(Q=this.sourceTileCache_)==null||Q.expireCache()};e.postRenderFunctions.push(j)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,r,i,a,o,c,u){let h;if(e instanceof pD){if(h=_2(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const m=this.getRenderContext(n),_=rr(this),p=n.layerStatesArray[n.layerIndex],g=p.opacity*(u?e.getAlpha(_,n.time):1),C=g!==m.globalAlpha;C&&(m.save(),m.globalAlpha=g),m.drawImage(h,c,c,h.width-2*c,h.height-2*c,r,i,a,o),C&&m.restore(),g!==p.opacity?n.animate=!0:u&&e.endTransition(_)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,r){const i=rr(n);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Yx={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class F9 extends W1{constructor(e){e=e||{};const n=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Yx.PRELOAD)}setPreload(e){this.set(Yx.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Yx.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Yx.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class ED extends F9{constructor(e){super(e)}createRenderer(){return new W9(this,{cacheSize:this.getCacheSize()})}}class uj{drawCustom(e,n,r,i,a){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,r){}drawFeature(e,n,r){}drawGeometryCollection(e,n,r){}drawLineString(e,n,r){}drawMultiLineString(e,n,r){}drawMultiPoint(e,n,r){}drawMultiPolygon(e,n,r){}drawPoint(e,n,r){}drawPolygon(e,n,r){}drawText(e,n,r){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const cn={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Vx=[cn.FILL],Au=[cn.STROKE],wh=[cn.BEGIN_PATH],DD=[cn.CLOSE_PATH];class T_ extends uj{constructor(e,n,r,i){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(r){return r*n})}appendFlatPointCoordinates(e,n){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,a=this.coordinates;let o=a.length;for(let c=0,u=e.length;c<u;c+=n)i[0]=e[c],i[1]=e[c+1],om(r,i)&&(a[o++]=i[0],a[o++]=i[1]);return o}appendFlatLineCoordinates(e,n,r,i,a,o){const c=this.coordinates;let u=c.length;const h=this.getBufferedMaxExtent();o&&(n+=i);let m=e[n],_=e[n+1];const p=this.tmpCoordinate_;let g=!0,C,y,S;for(C=n+i;C<r;C+=i)p[0]=e[C],p[1]=e[C+1],S=t2(h,p),S!==y?(g&&(c[u++]=m,c[u++]=_,g=!1),c[u++]=p[0],c[u++]=p[1]):S===ha.INTERSECTING?(c[u++]=p[0],c[u++]=p[1],g=!1):g=!0,m=p[0],_=p[1],y=S;return(a&&g||C===n+i)&&(c[u++]=m,c[u++]=_),u}drawCustomCoordinates_(e,n,r,i,a){for(let o=0,c=r.length;o<c;++o){const u=r[o],h=this.appendFlatLineCoordinates(e,n,u,i,!1,!1);a.push(h),n=u}return n}drawCustom(e,n,r,i,a){this.beginGeometry(e,n,a);const o=e.getType(),c=e.getStride(),u=this.coordinates.length;let h,m,_,p,g;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),p=[];const C=e.getEndss();g=0;for(let y=0,S=C.length;y<S;++y){const v=[];g=this.drawCustomCoordinates_(h,g,C[y],c,v),p.push(v)}this.instructions.push([cn.CUSTOM,u,p,e,r,$E,a]),this.hitDetectionInstructions.push([cn.CUSTOM,u,p,e,i||r,$E,a]);break;case"Polygon":case"MultiLineString":_=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),g=this.drawCustomCoordinates_(h,0,e.getEnds(),c,_),this.instructions.push([cn.CUSTOM,u,_,e,r,Xp,a]),this.hitDetectionInstructions.push([cn.CUSTOM,u,_,e,i||r,Xp,a]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),m=this.appendFlatLineCoordinates(h,0,h.length,c,!1,!1),this.instructions.push([cn.CUSTOM,u,m,e,r,Ef,a]),this.hitDetectionInstructions.push([cn.CUSTOM,u,m,e,i||r,Ef,a]);break;case"MultiPoint":h=e.getFlatCoordinates(),m=this.appendFlatPointCoordinates(h,c),m>u&&(this.instructions.push([cn.CUSTOM,u,m,e,r,Ef,a]),this.hitDetectionInstructions.push([cn.CUSTOM,u,m,e,i||r,Ef,a]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),m=this.coordinates.length,this.instructions.push([cn.CUSTOM,u,m,e,r,void 0,a]),this.hitDetectionInstructions.push([cn.CUSTOM,u,m,e,i||r,void 0,a]);break}this.endGeometry(n)}beginGeometry(e,n,r){this.beginGeometryInstruction1_=[cn.BEGIN_GEOMETRY,n,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[cn.BEGIN_GEOMETRY,n,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const r=e.length;let i,a,o=-1;for(n=0;n<r;++n)i=e[n],a=i[0],a==cn.END_GEOMETRY?o=n:a==cn.BEGIN_GEOMETRY&&(i[2]=n,X6(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const r=e.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=Mc(r||Nl)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const r=e.getColor();n.strokeStyle=Mc(r||t_);const i=e.getLineCap();n.lineCap=i!==void 0?i:dm;const a=e.getLineDash();n.lineDash=a?a.slice():bd;const o=e.getLineDashOffset();n.lineDashOffset=o||Cd;const c=e.getLineJoin();n.lineJoin=c!==void 0?c:um;const u=e.getWidth();n.lineWidth=u!==void 0?u:n_;const h=e.getMiterLimit();n.miterLimit=h!==void 0?h:e_;const m=e.getOffset();n.strokeOffset=m??q7,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0,n.strokeOffset=void 0;return n}setFillStrokeStyle(e,n){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(n,r)}createFill(e){const n=e.fillStyle,r=[cn.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[cn.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,n){const r=e.strokeStyle,i=e.lineCap,a=e.lineDash,o=e.lineDashOffset,c=e.lineJoin,u=e.lineWidth,h=e.miterLimit,m=e.strokeOffset;(e.currentStrokeStyle!=r||e.currentLineCap!=i||a!=e.currentLineDash&&!Ju(e.currentLineDash,a)||e.currentLineDashOffset!=o||e.currentLineJoin!=c||e.currentLineWidth!=u||e.currentMiterLimit!=h||e.currentStrokeOffset!=m)&&(n.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=a,e.currentLineDashOffset=o,e.currentLineJoin=c,e.currentLineWidth=u,e.currentMiterLimit=h,e.currentStrokeOffset=m)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[cn.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=iI(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;mN(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class K9 extends T_{constructor(e,n,r,i){super(e,n,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,r){if(!this.image_||this.maxExtent&&!om(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),a=e.getStride(),o=this.coordinates.length,c=this.appendFlatPointCoordinates(i,a);this.instructions.push([cn.DRAW_IMAGE,o,c,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([cn.DRAW_IMAGE,o,c,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,r){if(!this.image_)return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),a=[];for(let u=0,h=i.length;u<h;u+=e.getStride())(!this.maxExtent||om(this.maxExtent,i.slice(u,u+2)))&&a.push(i[u],i[u+1]);const o=this.coordinates.length,c=this.appendFlatPointCoordinates(a,2);this.instructions.push([cn.DRAW_IMAGE,o,c,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([cn.DRAW_IMAGE,o,c,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const r=e.getAnchor(),i=e.getSize(),a=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class Q9 extends T_{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinates_(e,n,r,i,a){const o=this.coordinates.length,c=this.appendFlatLineCoordinates(e,n,r,i,!1,!1);return this.instructions.push([cn.MOVE_TO_LINE_TO,o,c,a*this.pixelRatio]),this.hitDetectionInstructions.push([cn.MOVE_TO_LINE_TO,o,c,a]),r}drawLineString(e,n,r){const i=this.state,a=i.strokeStyle,o=i.lineWidth,c=i.strokeOffset;if(a===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([cn.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,bd,Cd],wh);const u=e.getFlatCoordinates(),h=e.getStride();this.drawFlatCoordinates_(u,0,u.length,h,c),this.hitDetectionInstructions.push(Au),this.endGeometry(n)}drawMultiLineString(e,n,r){const i=this.state,a=i.strokeStyle,o=i.lineWidth,c=i.strokeOffset;if(a===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([cn.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,bd,Cd],wh);const u=e.getEnds(),h=e.getFlatCoordinates(),m=e.getStride();let _=0;for(let p=0,g=u.length;p<g;++p)_=this.drawFlatCoordinates_(h,_,u[p],m,c);this.hitDetectionInstructions.push(Au),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Au),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Au),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(wh)}}class RD extends T_{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinatess_(e,n,r,i,a){const o=this.state,c=o.fillStyle!==void 0,u=o.strokeStyle!==void 0,h=r.length;this.instructions.push(wh),this.hitDetectionInstructions.push(wh);for(let m=0;m<h;++m){const _=r[m],p=this.coordinates.length,g=this.appendFlatLineCoordinates(e,n,_,i,!0,!u);this.instructions.push([cn.MOVE_TO_LINE_TO,p,g,a*this.pixelRatio,!0]),this.hitDetectionInstructions.push([cn.MOVE_TO_LINE_TO,p,g,a,!0]),u&&(this.instructions.push(DD),this.hitDetectionInstructions.push(DD)),n=_}return c&&(this.instructions.push(Vx),this.hitDetectionInstructions.push(Vx)),u&&(this.instructions.push(Au),this.hitDetectionInstructions.push(Au)),n}drawCircle(e,n,r){const i=this.state,a=i.fillStyle,o=i.strokeStyle,c=i.strokeOffset;if(a===void 0&&o===void 0||this.handleStrokeOffset_(()=>this.drawCircle(e,n,r)))return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([cn.SET_FILL_STYLE,Nl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([cn.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,bd,Cd]);const u=e.getFlatCoordinates(),h=e.getStride(),m=this.coordinates.length;this.appendFlatLineCoordinates(u,0,u.length,h,!1,!1);const _=[cn.CIRCLE,m,c];this.instructions.push(wh,_),this.hitDetectionInstructions.push(wh,_),i.fillStyle!==void 0&&(this.instructions.push(Vx),this.hitDetectionInstructions.push(Vx)),i.strokeStyle!==void 0&&(this.instructions.push(Au),this.hitDetectionInstructions.push(Au)),this.endGeometry(n)}drawPolygon(e,n,r){const i=this.state,a=i.fillStyle,o=i.strokeStyle,c=i.strokeOffset;if(a===void 0&&o===void 0||this.handleStrokeOffset_(()=>this.drawPolygon(e,n,r)))return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([cn.SET_FILL_STYLE,Nl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([cn.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,bd,Cd]);const u=e.getEnds(),h=e.getOrientedFlatCoordinates(),m=e.getStride();this.drawFlatCoordinatess_(h,0,u,m,c),this.endGeometry(n)}drawMultiPolygon(e,n,r){const i=this.state,a=i.fillStyle,o=i.strokeStyle,c=i.strokeOffset;if(a===void 0&&o===void 0||this.handleStrokeOffset_(()=>this.drawMultiPolygon(e,n,r)))return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([cn.SET_FILL_STYLE,Nl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([cn.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,bd,Cd]);const u=e.getEndss(),h=e.getOrientedFlatCoordinates(),m=e.getStride();let _=0;for(let p=0,g=u.length;p<g;++p)_=this.drawFlatCoordinatess_(h,_,u[p],m,c);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let r=0,i=n.length;r<i;++r)n[r]=Nh(n[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}handleStrokeOffset_(e){const n=this.state,r=n.fillStyle,i=n.strokeStyle,a=n.strokeOffset;return Math.abs(a)>0&&r!==void 0&&i!==void 0?(n.strokeStyle=void 0,n.strokeOffset=0,e(),n.fillStyle=void 0,n.strokeStyle=i,n.strokeOffset=a,e(),n.fillStyle=r,!0):!1}}function Y9(t,e,n,r,i){const a=[];let o=n,c=0,u=e.slice(n,2);for(;c<t&&o+i<r;){const[h,m]=u.slice(-2),_=e[o+i],p=e[o+i+1],g=Math.sqrt((_-h)*(_-h)+(p-m)*(p-m));if(c+=g,c>=t){const C=(t-c+g)/g,y=oo(h,_,C),S=oo(m,p,C);u.push(y,S),a.push(u),u=[y,S],c==t&&(o+=i),c=0}else if(c<t)u.push(e[o+i],e[o+i+1]),o+=i;else{const C=g-c,y=oo(h,_,C/g),S=oo(m,p,C/g);u.push(y,S),a.push(u),u=[y,S],c=0,o+=i}}return c>0&&a.push(u),a}function V9(t,e,n,r,i){let a=n,o=n,c=0,u=0,h=n,m,_,p,g,C,y,S,v,k,L;for(_=n;_<r;_+=i){const M=e[_],P=e[_+1];C!==void 0&&(k=M-C,L=P-y,g=Math.sqrt(k*k+L*L),S!==void 0&&(u+=p,m=Math.acos((S*k+v*L)/(p*g)),m>t&&(u>c&&(c=u,a=h,o=_),u=0,h=_-i)),p=g,S=k,v=L),C=M,y=P}return u+=g,u>c?[h,_]:[a,o]}const s1={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class $9 extends T_{constructor(e,n,r,i){super(e,n,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Nl]={fillStyle:Nl},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,r){const i=this.textFillState_,a=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!i&&!a)return;const c=this.coordinates;let u=c.length;const h=e.getType();let m=null,_=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Sl(this.maxExtent,e.getExtent()))return;let p;if(m=e.getFlatCoordinates(),h=="LineString")p=[m.length];else if(h=="MultiLineString")p=e.getEnds();else if(h=="Polygon")p=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const S=e.getEndss();p=[];for(let v=0,k=S.length;v<k;++v)p.push(S[v][0])}this.beginGeometry(e,n,r);const g=o.repeat,C=g?void 0:o.textAlign;let y=0;for(let S=0,v=p.length;S<v;++S){let k;g?k=Y9(g*this.resolution,m,y,p[S],_):k=[m.slice(y,p[S])];for(let L=0,M=k.length;L<M;++L){const P=k[L];let F=0,G=P.length;if(C==null){const I=V9(o.maxAngle,P,0,P.length,2);F=I[0],G=I[1]}for(let I=F;I<G;I+=_)c.push(P[I],P[I+1]);const B=c.length;y=p[S],this.drawChars_(u,B),u=B}}this.endGeometry(n)}else{let p=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":m=e.getFlatCoordinates();break;case"LineString":m=e.getFlatMidpoint();break;case"Circle":m=e.getCenter();break;case"MultiLineString":m=e.getFlatMidpoints(),_=2;break;case"Polygon":m=e.getFlatInteriorPoint(),o.overflow||p.push(m[2]/this.resolution),_=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();m=[];for(let P=0,F=M.length;P<F;P+=3)o.overflow||p.push(M[P+2]/this.resolution),m.push(M[P],M[P+1]);if(m.length===0)return;_=2;break}const g=this.appendFlatPointCoordinates(m,_);if(g===u)return;if(p&&(g-u)/2!==m.length/_){let M=u/2;p=p.filter((P,F)=>{const G=c[(M+F)*2]===m[F*_]&&c[(M+F)*2+1]===m[F*_+1];return G||--M,G})}this.saveTextStates_();const C=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,y=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,r);let S=o.padding;if(S!=Oh&&(o.scale[0]<0||o.scale[1]<0)){let M=o.padding[0],P=o.padding[1],F=o.padding[2],G=o.padding[3];o.scale[0]<0&&(P=-P,G=-G),o.scale[1]<0&&(M=-M,F=-F),S=[M,P,F,G]}const v=this.pixelRatio;this.instructions.push([cn.DRAW_IMAGE,u,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,S==Oh?Oh:S.map(function(M){return M*v}),C,y,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,p]);const k=1/v,L=C?C.slice(0):null;L&&(L[1]=Nl),this.hitDetectionInstructions.push([cn.DRAW_IMAGE,u,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[k,k],NaN,this.declutterMode_,this.declutterImageWithText_,S,L,y,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Nl:this.fillKey_,this.textOffsetX_,this.textOffsetY_,p]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const a=this.textKey_;a in this.textStates||(this.textStates[a]={font:n.font,textAlign:n.textAlign||s_,justify:n.justify,textBaseline:n.textBaseline||Zp,scale:n.scale});const o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))}drawChars_(e,n){const r=this.textStrokeState_,i=this.textState_,a=this.strokeKey_,o=this.textKey_,c=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=s1[i.textBaseline],m=this.textOffsetY_*u,_=this.text_,p=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([cn.DRAW_CHARS,e,n,h,i.overflow,c,i.maxAngle,u,m,a,p*u,_,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([cn.DRAW_CHARS,e,n,h,i.overflow,c&&Nl,i.maxAngle,u,m,a,p*u,_,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let r,i,a;if(!e)this.text_="";else{const o=e.getFill();o?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Mc(o.getColor()||Nl)):(i=null,this.textFillState_=i);const c=e.getStroke();if(!c)a=null,this.textStrokeState_=a;else{a=this.textStrokeState_,a||(a={},this.textStrokeState_=a);const y=c.getLineDash(),S=c.getLineDashOffset(),v=c.getWidth(),k=c.getMiterLimit();a.lineCap=c.getLineCap()||dm,a.lineDash=y?y.slice():bd,a.lineDashOffset=S===void 0?Cd:S,a.lineJoin=c.getLineJoin()||um,a.lineWidth=v===void 0?n_:v,a.miterLimit=k===void 0?e_:k,a.strokeStyle=Mc(c.getColor()||t_)}r=this.textState_;const u=e.getFont()||HI;Z7(u);const h=e.getScaleArray();r.overflow=e.getOverflow(),r.font=u,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||Zp,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||Oh,r.scale=h===void 0?[1,1]:h;const m=e.getOffsetX(),_=e.getOffsetY(),p=e.getRotateWithView(),g=e.getKeepUpright(),C=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=m===void 0?0:m,this.textOffsetY_=_===void 0?0:_,this.textRotateWithView_=p===void 0?!1:p,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=C===void 0?0:C,this.strokeKey_=a?(typeof a.strokeStyle=="string"?a.strokeStyle:rr(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+rr(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const z9={Circle:RD,Default:T_,Image:K9,LineString:Q9,Polygon:RD,Text:$9};class H9{constructor(e,n,r,i){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const r=this.buildersByZIndex_[n];for(const i in r){const a=r[i].finish();e[n][i]=a}}return e}getBuilder(e,n){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let a=i[n];if(a===void 0){const o=z9[n];a=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[n]=a}return a}}function q9(t,e,n,r){let i=t[e],a=t[e+1],o=0;for(let c=e+r;c<n;c+=r){const u=t[c],h=t[c+1];o+=Math.sqrt((u-i)*(u-i)+(h-a)*(h-a)),i=u,a=h}return o}function X9(t,e,n,r,i,a){i=i??[],a=a??e;const o=t[0],c=t[1],u=t[t.length-4],h=t[t.length-3];let m,_,p,g,C,y,S,v,k=0;for(let L=0;L<t.length;L+=e){p=m,g=_,C=void 0,y=void 0,L+e<t.length&&(C=t[L+e],y=t[L+e+1]),r&&L===0&&(p=u,g=h),r&&L===t.length-2&&(C=o,y=c),m=t[L],_=t[L+1],[S,v]=bp(m,_,p,g,C,y,n),i[k++]=S,i[k++]=v;for(let M=2;M<a;M++)i[k++]=t[L+M]}return i.length!=k&&(i.length=k),i}function bp(t,e,n,r,i,a,o){let c,u;n!==void 0&&r!==void 0?(c=t-n,u=e-r):i!==void 0&&a!==void 0?(c=i-t,u=a-e):(c=1,u=0);const h=Math.hypot(c,u),m=c/h,_=u/h;if(c=-_,u=m,n===void 0||r===void 0)return[t+c*o,e+u*o];if(i===void 0||a===void 0)return[t+c*o,e+u*o];const p=y8([t,e],[n,r],[i,a]);if(Math.cos(p)>.998)return[t+m*o,e+_*o];const g=Math.cos(p/2),C=Math.sin(p/2),y=C*c+g*u,S=-g*c+C*u,v=y*(1/C),k=S*(1/C);return[t+v*o,e+k*o]}function J9(t,e,n,r,i,a,o,c,u,h,m,_,p=!0){let g=t[e],C=t[e+1],y=0,S=0,v=0,k=0;function L(){y=g,S=C,e+=r,g=t[e],C=t[e+1],k+=v,v=Math.sqrt((g-y)*(g-y)+(C-S)*(C-S))}do L();while(e<n-r&&k+v<a);let M=v===0?0:(a-k)/v;const P=oo(y,g,M),F=oo(S,C,M),G=e-r,B=k,I=a+c*u(h,i,m);for(;e<n-r&&k+v<I;)L();M=v===0?0:(I-k)/v;const E=oo(y,g,M),A=oo(S,C,M);let Y=!1;if(p)if(_){const K=[P,F,E,A];DI(K,0,4,2,_,K,K),Y=K[0]>K[2]}else Y=P>E;const ee=Math.PI,J=[],H=G+r===e;e=G,v=0,k=B,g=t[e],C=t[e+1];let V;if(H){L(),V=Math.atan2(C-S,g-y),Y&&(V+=V>0?-ee:ee);const K=(E+P)/2,j=(A+F)/2;return J[0]=[K,j,(I-a)/2,V,i],J}i=i.replace(/\n/g," ");for(let K=0,j=i.length;K<j;){L();let te=Math.atan2(C-S,g-y);if(Y&&(te+=te>0?-ee:ee),V!==void 0){let q=te-V;if(q+=q>ee?-2*ee:q<-ee?2*ee:0,Math.abs(q)>o)return null}V=te;const ce=K;let R=0;for(;K<j;++K){const q=Y?j-K-1:K,$=c*u(h,i[q],m);if(e+r<n&&k+v<a+R+$/2)break;R+=$}if(K===ce)continue;const O=Y?i.substring(j-ce,j-K):i.substring(ce,K);M=v===0?0:(a+R/2-k)/v;const U=oo(y,g,M),Q=oo(S,C,M);J.push([U,Q,R/2,te,O]),a+=R}return J}const lf=yo(),hu=[],id=[],ad=[],fu=[];function TD(t){return t[3].declutterBox}const MD=new RegExp("[-----]");function qb(t,e){return e==="start"?e=MD.test(t)?"right":"left":e==="end"&&(e=MD.test(t)?"left":"right"),s1[e]}function Z9(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function eU(t,e,n){return n%2===0&&(t+=e),t}class tU{constructor(e,n,r,i,a){this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Xo(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=a?new cj:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,r,i){const a=e+n+r+i;if(this.labels_[a])return this.labels_[a];const o=i?this.strokeStates[i]:null,c=r?this.fillStates[r]:null,u=this.textStates[n],h=this.pixelRatio,m=[u.scale[0]*h,u.scale[1]*h],_=u.justify?s1[u.justify]:qb(Array.isArray(e)?e[0]:e,u.textAlign||s_),p=i&&o.lineWidth?o.lineWidth:0,g=Array.isArray(e)?e:String(e).split(`
`).reduce(Z9,[]),{width:C,height:y,widths:S,heights:v,lineWidths:k}=t9(u,g),L=C+p,M=[],P=(L+2)*m[0],F=(y+p)*m[1],G={width:P<0?Math.floor(P):Math.ceil(P),height:F<0?Math.floor(F):Math.ceil(F),contextInstructions:M};(m[0]!=1||m[1]!=1)&&M.push("scale",m),i&&(M.push("strokeStyle",o.strokeStyle),M.push("lineWidth",p),M.push("lineCap",o.lineCap),M.push("lineJoin",o.lineJoin),M.push("miterLimit",o.miterLimit),M.push("setLineDash",[o.lineDash]),M.push("lineDashOffset",o.lineDashOffset)),r&&M.push("fillStyle",c.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const B=.5-_;let I=_*L+B*p;const E=[],A=[];let Y=0,ee=0,J=0,H=0,V;for(let K=0,j=g.length;K<j;K+=2){const te=g[K];if(te===`
`){ee+=Y,Y=0,I=_*L+B*p,++H;continue}const ce=g[K+1]||u.font;ce!==V&&(i&&E.push("font",ce),r&&A.push("font",ce),V=ce),Y=Math.max(Y,v[J]);const R=[te,I+B*S[J]+_*(S[J]-k[H]),.5*(p+Y)+ee];I+=S[J],i&&E.push("strokeText",R),r&&A.push("fillText",R),++J}return Array.prototype.push.apply(M,E),Array.prototype.push.apply(M,A),this.labels_[a]=G,G}replayTextBackground_(e,n,r,i,a,o,c){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,a),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),c&&(this.setStrokeStyle_(e,c),e.stroke())}calculateImageOrLabelDimensions_(e,n,r,i,a,o,c,u,h,m,_,p,g,C,y,S){c*=p[0],u*=p[1];let v=r-c,k=i-u;const L=a+h>e?e-h:a,M=o+m>n?n-m:o,P=C[3]+L*p[0]+C[1],F=C[0]+M*p[1]+C[2],G=v-C[3],B=k-C[0];(y||_!==0)&&(hu[0]=G,fu[0]=G,hu[1]=B,id[1]=B,id[0]=G+P,ad[0]=id[0],ad[1]=B+F,fu[1]=ad[1]);let I;return _!==0?(I=Dd(Xo(),r,i,1,1,_,-r,-i),fa(I,hu),fa(I,id),fa(I,ad),fa(I,fu),Vu(Math.min(hu[0],id[0],ad[0],fu[0]),Math.min(hu[1],id[1],ad[1],fu[1]),Math.max(hu[0],id[0],ad[0],fu[0]),Math.max(hu[1],id[1],ad[1],fu[1]),lf)):Vu(Math.min(G,G+P),Math.min(B,B+F),Math.max(G,G+P),Math.max(B,B+F),lf),g&&(v=Math.round(v),k=Math.round(k)),{drawImageX:v,drawImageY:k,drawImageW:L,drawImageH:M,originX:h,originY:m,declutterBox:{minX:lf[0],minY:lf[1],maxX:lf[2],maxY:lf[3],value:S},canvasTransform:I,scale:p}}replayImageOrLabel_(e,n,r,i,a,o,c){const u=!!(o||c),h=i.declutterBox,m=c?c[2]*i.scale[0]/2:0;return h.minX-m<=n[0]&&h.maxX+m>=0&&h.minY-m<=n[1]&&h.maxY+m>=0&&(u&&this.replayTextBackground_(e,hu,id,ad,fu,o,c),s9(e,i.canvasTransform,a,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const r=fa(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),n!==1&&e.scale(n,n)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,r,i){const a=this.textStates[n],o=this.createLabel(e,n,i,r),c=this.strokeStates[r],u=this.pixelRatio,h=qb(Array.isArray(e)?e[0]:e,a.textAlign||s_),m=s1[a.textBaseline||Zp],_=c&&c.lineWidth?c.lineWidth:0,p=o.width/u-2*a.scale[0],g=h*p+2*(.5-h)*_,C=m*o.height/u+2*(.5-m)*_;return{label:o,anchorX:g,anchorY:C}}execute_(e,n,r,i,a,o,c,u){const h=this.zIndexContext_;let m;this.pixelCoordinates_&&Ju(r,this.renderedTransform_)?m=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),m=Fu(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),q8(this.renderedTransform_,r));let _=0;const p=i.length;let g=0,C,y,S,v,k,L,M,P,F,G,B,I,E,A,Y,ee,J=0,H=0;const V=this.coordinateCache_,K=this.viewRotation_,j=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,te={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:K},ce=this.instructions!=i||this.overlaps?0:200;let R,O,U,Q;for(;_<p;){const q=i[_];switch(q[0]){case cn.BEGIN_GEOMETRY:R=q[1],Q=q[3],R.getGeometry()?c!==void 0&&!Sl(c,Q.getExtent())?_=q[2]+1:++_:_=q[2],h&&(h.zIndex=q[4]);break;case cn.BEGIN_PATH:J>ce&&(this.fill_(e),J=0),H>ce&&(e.stroke(),H=0),!J&&!H&&(e.beginPath(),P=NaN,F=NaN),++_;break;case cn.CIRCLE:g=q[1],v=q[2]??0;const de=m[g],ae=m[g+1],_e=m[g+2]-v,ie=m[g+3]-v,Ne=_e-de,X=ie-ae,xe=Math.sqrt(Ne*Ne+X*X);e.moveTo(de+xe,ae),e.arc(de,ae,xe,0,2*Math.PI,!0),++_;break;case cn.CLOSE_PATH:e.closePath(),++_;break;case cn.CUSTOM:g=q[1],C=q[2];const fe=q[3],Z=q[4],le=q[5];te.geometry=fe,te.feature=R,_ in V||(V[_]=[]);const se=V[_];le?le(m,g,C,2,se):(se[0]=m[g],se[1]=m[g+1],se.length=2),h&&(h.zIndex=q[6]),Z(se,te),++_;break;case cn.DRAW_IMAGE:g=q[1],C=q[2],I=q[3],y=q[4],S=q[5];let Re=q[6];const be=q[7],De=q[8],re=q[9],me=q[10];let ve=q[11];const et=q[12];let Dt=q[13];M=q[14]||"declutter";const ot=q[15];if(!I&&q.length>=20){E=q[19],A=q[20],Y=q[21],ee=q[22];const Je=this.drawLabelWithPointPlacement_(E,A,Y,ee);I=Je.label,q[3]=I;const Pe=q[23];y=(Je.anchorX-Pe)*this.pixelRatio,q[4]=y;const Nt=q[24];S=(Je.anchorY-Nt)*this.pixelRatio,q[5]=S,Re=I.height,q[6]=Re,Dt=I.width,q[13]=Dt}let At;q.length>25&&(At=q[25]);let ct,Ge,at;q.length>17?(ct=q[16],Ge=q[17],at=q[18]):(ct=Oh,Ge=null,at=null),me&&j?ve+=K:!me&&!j&&(ve-=K);let xt=0;for(;g<C;g+=2){if(At&&At[xt++]<Dt/this.pixelRatio)continue;const Je=this.calculateImageOrLabelDimensions_(I.width,I.height,m[g],m[g+1],Dt,Re,y,S,De,re,ve,et,a,ct,!!Ge||!!at,R),Pe=[e,n,I,Je,be,Ge,at];if(u){let Nt,Oe,dt;if(ot){const $e=C-g;if(!ot[$e]){ot[$e]={args:Pe,declutterMode:M};continue}const $t=ot[$e];Nt=$t.args,Oe=$t.declutterMode,delete ot[$e],dt=TD(Nt)}let gt,It;if(Nt&&(Oe!=="declutter"||!u.collides(dt))&&(gt=!0),(M!=="declutter"||!u.collides(Je.declutterBox))&&(It=!0),Oe==="declutter"&&M==="declutter"){const $e=gt&&It;gt=$e,It=$e}gt&&(Oe!=="none"&&u.insert(dt),this.replayImageOrLabel_.apply(this,Nt)),It&&(M!=="none"&&u.insert(Je.declutterBox),this.replayImageOrLabel_.apply(this,Pe))}else this.replayImageOrLabel_.apply(this,Pe)}++_;break;case cn.DRAW_CHARS:const mt=q[1],Ve=q[2],it=q[3],Fe=q[4];ee=q[5];const nt=q[6],lt=q[7],Mt=q[8];Y=q[9];const ut=q[10];E=q[11],Array.isArray(E)&&(E=E.reduce(eU,"")),A=q[12];const qe=[q[13],q[13]];M=q[14]||"declutter";const Ee=q[15],Ye=this.textStates[A],pe=Ye.font,ge=[Ye.scale[0]*lt,Ye.scale[1]*lt];let Be;pe in this.widths_?Be=this.widths_[pe]:(Be={},this.widths_[pe]=Be);const ue=q9(m,mt,Ve,2),we=Math.abs(ge[0])*cD(pe,E,Be);if(Fe||we<=ue){const Je=this.textStates[A].textAlign,Pe=(ue-we)*qb(E,Je),Nt=J9(m,mt,Ve,2,E,Pe,nt,Math.abs(ge[0]),cD,pe,Be,j?0:this.viewRotation_,Ee);e:if(Nt){const Oe=[];let dt,gt,It,$e,$t;if(Y)for(dt=0,gt=Nt.length;dt<gt;++dt){$t=Nt[dt],It=$t[4],$e=this.createLabel(It,A,"",Y),y=$t[2]+(ge[0]<0?-ut:ut),S=it*$e.height+(.5-it)*2*ut*ge[1]/ge[0]-Mt;const Ue=this.calculateImageOrLabelDimensions_($e.width,$e.height,$t[0],$t[1],$e.width,$e.height,y,S,0,0,$t[3],qe,!1,Oh,!1,R);if(u&&M==="declutter"&&u.collides(Ue.declutterBox))break e;Oe.push([e,n,$e,Ue,1,null,null])}if(ee)for(dt=0,gt=Nt.length;dt<gt;++dt){$t=Nt[dt],It=$t[4],$e=this.createLabel(It,A,ee,""),y=$t[2],S=it*$e.height-Mt;const Ue=this.calculateImageOrLabelDimensions_($e.width,$e.height,$t[0],$t[1],$e.width,$e.height,y,S,0,0,$t[3],qe,!1,Oh,!1,R);if(u&&M==="declutter"&&u.collides(Ue.declutterBox))break e;Oe.push([e,n,$e,Ue,1,null,null])}u&&M!=="none"&&u.load(Oe.map(TD));for(let Ue=0,ss=Oe.length;Ue<ss;++Ue)this.replayImageOrLabel_.apply(this,Oe[Ue])}}++_;break;case cn.END_GEOMETRY:if(o!==void 0){R=q[1];const Je=o(R,Q,M);if(Je)return Je}++_;break;case cn.FILL:ce?J++:this.fill_(e),++_;break;case cn.MOVE_TO_LINE_TO:for(g=q[1],C=q[2],v=q[3],k=q[4]??!1,O=m[g],U=m[g+1],v&&(L=g,[O,U]=bp(O,U,k?m[C-4]:void 0,k?m[C-3]:void 0,m[g+2],m[g+3],v)),e.moveTo(O,U),P=O+.5|0,F=U+.5|0,g+=2;g<C;g+=2)O=m[g],U=m[g+1],G=O+.5|0,B=U+.5|0,(g==C-2||G!==P||B!==F)&&(v&&(g==C-2?[O,U]=bp(O,U,m[g-2],m[g-1],k?m[L+2]:void 0,k?m[L+3]:void 0,v):[O,U]=bp(O,U,m[g-2],m[g-1],m[g+2],m[g+3],v)),e.lineTo(O,U),P=G,F=B);++_;break;case cn.SET_FILL_STYLE:this.alignAndScaleFill_=q[2],J&&(this.fill_(e),J=0,H&&(e.stroke(),H=0)),e.fillStyle=q[1],++_;break;case cn.SET_STROKE_STYLE:H&&(e.stroke(),H=0),this.setStrokeStyle_(e,q),++_;break;case cn.STROKE:ce?H++:e.stroke(),++_;break;default:++_;break}}J&&this.fill_(e),H&&e.stroke()}execute(e,n,r,i,a,o){this.viewRotation_=i,this.execute_(e,n,r,this.instructions,a,void 0,void 0,o)}executeHitDetection(e,n,r,i,a){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,i,a)}}const Rh=["Polygon","Circle","LineString","Image","Text","Default"],hj=["Image","Text"],sU=Rh.filter(t=>!hj.includes(t));let fj=!1,mj=!1;function nU(){let t=0;const e=r=>{const i=Ui(1,1,null,{willReadFrequently:r});let a=0;const o=performance.now();for(;performance.now()-o<50;++a)i.fillStyle=`rgba(255,0,${a%256},1)`,i.fillRect(0,0,1,1),i.getImageData(0,0,1,1);return t=a>t?a:t,a};fj={[e(!0)]:!0,[e(!1)]:!1,[e(void 0)]:void 0}[t],mj=!0}class rU{constructor(e,n,r,i,a,o,c){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Xo(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(a,c)}clip(e,n){const r=this.getClipCoords(n);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,n){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const a=e[r];for(const o in a){const c=a[o];i[o]=new tU(this.resolution_,this.pixelRatio_,this.overlaps_,c,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const r=this.executorsByZIndex_[n];for(let i=0,a=e.length;i<a;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,n,r,i,a,o){mj===!1&&nU(),i=Math.round(i);const c=i*2+1,u=Dd(this.hitDetectionTransform_,i+.5,i+.5,1/n,-1/n,-r,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Ui(c,c,null,{willReadFrequently:fj}));const m=this.hitDetectionContext_;m.canvas.width!==c||m.canvas.height!==c?(m.canvas.width=c,m.canvas.height=c):h||m.clearRect(0,0,c,c);let _;this.renderBuffer_!==void 0&&(_=yo(),Ag(_,e),mN(_,n*(this.renderBuffer_+i),_));const p=iU(i);let g;function C(P,F,G){const B=m.getImageData(0,0,c,c).data;for(let I=0,E=p.length;I<E;I++)if(B[p[I]]>0){if(!o||G==="none"||g!=="Image"&&g!=="Text"||o.includes(P)){const A=(p[I]-3)/4,Y=i-A%c,ee=i-(A/c|0),J=a(P,F,Y*Y+ee*ee);if(J)return J}m.clearRect(0,0,c,c);break}}const y=Object.keys(this.executorsByZIndex_).map(Number);y.sort(yd);let S,v,k,L,M;for(S=y.length-1;S>=0;--S){const P=y[S].toString();for(k=this.executorsByZIndex_[P],v=Rh.length-1;v>=0;--v)if(g=Rh[v],L=k[g],L!==void 0&&(M=L.executeHitDetection(m,u,r,C,_),M))return M}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const r=n[0],i=n[1],a=n[2],o=n[3],c=[r,i,r,o,a,o,a,i];return Fu(c,0,8,2,e,c),c}isEmpty(){return lm(this.executorsByZIndex_)}execute(e,n,r,i,a,o,c){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(c?q6:yd),o=o||Rh;const h=Rh.length;for(let m=0,_=u.length;m<_;++m){const p=u[m].toString(),g=this.executorsByZIndex_[p];for(let C=0,y=o.length;C<y;++C){const S=o[C],v=g[S];if(v!==void 0){const k=c===null?void 0:v.getZIndexContext(),L=k?k.getContext():e,M=this.maxExtent_&&S!=="Image"&&S!=="Text";if(M&&(L.save(),this.clip(L,r)),!k||S==="Text"||S==="Image"?v.execute(L,n,r,i,a,c):k.pushFunction(P=>v.execute(P,n,r,i,a,c)),M&&L.restore(),k){k.offset();const P=u[m]*h+Rh.indexOf(S);this.deferredZIndexContexts_[P]||(this.deferredZIndexContexts_[P]=[]),this.deferredZIndexContexts_[P].push(k)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(yd);for(let r=0,i=n.length;r<i;++r)e[n[r]].forEach(a=>{a.draw(this.renderedContext_),a.clear()}),e[n[r]].length=0}}const Xb={};function iU(t){if(Xb[t]!==void 0)return Xb[t];const e=t*2+1,n=t*t,r=new Array(n+1);for(let a=0;a<=t;++a)for(let o=0;o<=t;++o){const c=a*a+o*o;if(c>n)break;let u=r[c];u||(u=[],r[c]=u),u.push(((t+a)*e+(t+o))*4+3),a>0&&u.push(((t-a)*e+(t+o))*4+3),o>0&&(u.push(((t+a)*e+(t-o))*4+3),a>0&&u.push(((t-a)*e+(t-o))*4+3))}const i=[];for(let a=0,o=r.length;a<o;++a)r[a]&&i.push(...r[a]);return Xb[t]=i,i}class aU extends uj{constructor(e,n,r,i,a,o,c){super(),this.context_=e,this.pixelRatio_=n,this.extent_=r,this.transform_=i,this.transformRotation_=i?j1(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=a,this.squaredTolerance_=o,this.userTransform_=c,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Xo()}drawImages_(e,n,r,i){if(!this.image_)return;const a=Fu(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_,c=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let m=0,_=a.length;m<_;m+=2){const p=a[m]-this.imageAnchorX_,g=a[m+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const C=p+this.imageAnchorX_,y=g+this.imageAnchorY_;Dd(c,C,y,1,1,h,-C,-y),o.save(),o.transform.apply(o,c),o.translate(C,y),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,p,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,n,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const a=Fu(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_;let c=this.textRotation_;for(this.transformRotation_===0&&(c-=this.viewRotation_),this.textRotateWithView_&&(c+=this.viewRotation_);n<r;n+=i){const u=a[n]+this.textOffsetX_,h=a[n+1]+this.textOffsetY_;c!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(c),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,n,r,i,a,o){const c=this.context_;let u=Fu(e,n,r,i,this.transform_,this.pixelCoordinates_);Math.abs(o)>0&&(u=X9(u,i,o,a,u)),c.moveTo(u[0],u[1]);let h=u.length;a&&(h-=2);for(let m=2;m<h;m+=2)c.lineTo(u[m],u[m+1]);return a&&c.closePath(),r}drawRings_(e,n,r,i,a){for(let o=0,c=r.length;o<c;++o)n=this.moveToLineTo_(e,n,r[o],i,!0,a);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Sl(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=ak(e,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],i=n[3]-n[1],a=Math.sqrt(r*r+i*i),o=this.context_;o.beginPath(),o.arc(n[0],n[1],a,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const r=n.getGeometryFunction()(e);r&&(this.setStyle(n),this.drawGeometry(r))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let r=0,i=n.length;r<i;++r)this.drawGeometry(n[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Sl(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1,this.strokeState_.strokeOffset),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(Sl(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let a=0;const o=e.getEnds(),c=e.getStride();r.beginPath();for(let u=0,h=o.length;u<h;++u)a=this.moveToLineTo_(i,a,o[u],c,!1,this.strokeState_.strokeOffset);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){var n;if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Sl(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=this.context_;r.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride(),(n=this.strokeState_)==null?void 0:n.strokeOffset),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}if(this.text_!==""){const r=e.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}}drawMultiPolygon(e){var n;if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Sl(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getOrientedFlatCoordinates();let a=0;const o=e.getEndss(),c=e.getStride();r.beginPath();for(let u=0,h=o.length;u<h;++u){const m=o[u];a=this.drawRings_(i,a,m,c,(n=this.strokeState_)==null?void 0:n.strokeOffset)}this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}if(this.text_!==""){const r=e.getFlatInteriorPoints();this.drawText_(r,0,r.length,2)}}}setContextFillState_(e){const n=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,n.lineCap=e.lineCap),Ju(r.lineDash,e.lineDash)||n.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:s_;r?(r.font!=e.font&&(r.font=e.font,n.font=e.font),r.textAlign!=i&&(r.textAlign=i,n.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=i,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Mc(r||Nl)}}if(!n)this.strokeState_=null;else{const r=n.getColor(),i=n.getLineCap(),a=n.getLineDash(),o=n.getLineDashOffset(),c=n.getLineJoin(),u=n.getWidth(),h=n.getMiterLimit(),m=a||bd,_=n.getOffset();this.strokeState_={lineCap:i!==void 0?i:dm,lineDash:this.pixelRatio_===1?m:m.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Cd)*this.pixelRatio_,lineJoin:c!==void 0?c:um,lineWidth:(u!==void 0?u:n_)*this.pixelRatio_,miterLimit:h!==void 0?h:e_,strokeStyle:Mc(r||t_),strokeOffset:(_??0)*this.pixelRatio_}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),a=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=n[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/r,o[1]*this.pixelRatio_/r],this.imageWidth_=n[0]*r}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const g=n.getColor();this.textFillState_={fillStyle:Mc(g||Nl)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const g=r.getColor(),C=r.getLineCap(),y=r.getLineDash(),S=r.getLineDashOffset(),v=r.getLineJoin(),k=r.getWidth(),L=r.getMiterLimit();this.textStrokeState_={lineCap:C!==void 0?C:dm,lineDash:y||bd,lineDashOffset:S||Cd,lineJoin:v!==void 0?v:um,lineWidth:k!==void 0?k:n_,miterLimit:L!==void 0?L:e_,strokeStyle:Mc(g||t_)}}const i=e.getFont(),a=e.getOffsetX(),o=e.getOffsetY(),c=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),m=e.getText(),_=e.getTextAlign(),p=e.getTextBaseline();this.textState_={font:i!==void 0?i:HI,textAlign:_!==void 0?_:s_,textBaseline:p!==void 0?p:Zp},this.text_=m!==void 0?Array.isArray(m)?m.reduce((g,C,y)=>g+=y%2?" ":C,""):m:"",this.textOffsetX_=a!==void 0?this.pixelRatio_*a:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=c!==void 0?c:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const Tc=.5;function lU(t,e,n,r,i,a,o,c,u){const h=i,m=t[0]*Tc,_=t[1]*Tc,p=Ui(m,_);p.imageSmoothingEnabled=!1;const g=p.canvas,C=new aU(p,Tc,i,null,o,c,null),y=n.length,S=Math.floor((256*256*256-1)/y),v={};for(let L=1;L<=y;++L){const M=n[L-1],P=M.getStyleFunction()||r;if(!P)continue;let F=P(M,a);if(!F)continue;Array.isArray(F)||(F=[F]);const B=(L*S).toString(16).padStart(7,"#00000");for(let I=0,E=F.length;I<E;++I){const A=F[I],Y=A.getGeometryFunction()(M);if(!Y||!Sl(h,Y.getExtent()))continue;const ee=A.clone(),J=ee.getFill();J&&J.setColor(B);const H=ee.getStroke();H&&(H.setColor(B),H.setLineDash(null)),ee.setText(void 0);const V=A.getImage();if(V){const ce=V.getImageSize();if(!ce)continue;const R=Ui(ce[0],ce[1],void 0,{alpha:!1}),O=R.canvas;R.fillStyle=B,R.fillRect(0,0,O.width,O.height),ee.setImage(new Rc({img:O,anchor:V.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:V.getOrigin(),opacity:1,size:V.getSize(),scale:V.getScale(),rotation:V.getRotation(),rotateWithView:V.getRotateWithView()}))}const K=ee.getZIndex()||0;let j=v[K];j||(j={},v[K]=j,j.Polygon=[],j.Circle=[],j.LineString=[],j.Point=[]);const te=Y.getType();if(te==="GeometryCollection"){const ce=Y.getGeometriesArrayRecursive();for(let R=0,O=ce.length;R<O;++R){const U=ce[R];j[U.getType().replace("Multi","")].push(U,ee)}}else j[te.replace("Multi","")].push(Y,ee)}}const k=Object.keys(v).map(Number).sort(yd);for(let L=0,M=k.length;L<M;++L){const P=v[k[L]];for(const F in P){const G=P[F];for(let B=0,I=G.length;B<I;B+=2){C.setStyle(G[B+1]);for(let E=0,A=e.length;E<A;++E)C.setTransform(e[E]),C.drawGeometry(G[B])}}}return p.getImageData(0,0,g.width,g.height)}function oU(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*Tc),a=Math.floor(Math.round(t[1])*Tc),o=(Ur(i,0,n.width-1)+Ur(a,0,n.height-1)*n.width)*4,c=n.data[o],u=n.data[o+1],m=n.data[o+2]+256*(u+256*c),_=Math.floor((256*256*256-1)/e.length);m&&m%_===0&&r.push(e[m/_-1])}return r}const cU=.5,gj={Point:xU,LineString:mU,Polygon:yU,MultiPoint:pU,MultiLineString:gU,MultiPolygon:_U,GeometryCollection:fU,Circle:uU};function dU(t,e){return parseInt(rr(t),10)-parseInt(rr(e),10)}function ID(t,e){const n=_j(t,e);return n*n}function _j(t,e){return cU*t/e}function uU(t,e,n,r,i){const a=n.getFill(),o=n.getStroke();if(a||o){const u=t.getBuilder(n.getZIndex(),"Circle");u.setFillStrokeStyle(a,o),u.drawCircle(e,r,i)}const c=n.getText();if(c&&c.getText()){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(c),u.drawText(e,r)}}function jD(t,e,n,r,i,a,o,c){const u=[],h=n.getImage();if(h){let p=!0;const g=h.getImageState();g==Dn.LOADED||g==Dn.ERROR?p=!1:g==Dn.IDLE&&h.load(),p&&u.push(h.ready())}const m=n.getFill();m&&m.loading()&&u.push(m.ready());const _=u.length>0;return _&&Promise.all(u).then(()=>i(null)),hU(t,e,n,r,a,o,c),_}function hU(t,e,n,r,i,a,o){const c=n.getGeometryFunction()(e);if(!c)return;const u=c.simplifyTransformed(r,i);if(n.getRenderer())xj(t,u,n,e,o);else{const m=gj[u.getType()];m(t,u,n,e,o,a)}}function xj(t,e,n,r,i){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let c=0,u=o.length;c<u;++c)xj(t,o[c],n,r,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i)}function fU(t,e,n,r,i,a){const o=e.getGeometriesArray();let c,u;for(c=0,u=o.length;c<u;++c){const h=gj[o[c].getType()];h(t,o[c],n,r,i,a)}}function mU(t,e,n,r,i){const a=n.getStroke();if(a){const c=t.getBuilder(n.getZIndex(),"LineString");c.setFillStrokeStyle(null,a),c.drawLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const c=t.getBuilder(n.getZIndex(),"Text");c.setTextStyle(o),c.drawText(e,r,i)}}function gU(t,e,n,r,i){const a=n.getStroke();if(a){const c=t.getBuilder(n.getZIndex(),"LineString");c.setFillStrokeStyle(null,a),c.drawMultiLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const c=t.getBuilder(n.getZIndex(),"Text");c.setTextStyle(o),c.drawText(e,r,i)}}function _U(t,e,n,r,i){const a=n.getFill(),o=n.getStroke();if(o||a){const u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(a,o),u.drawMultiPolygon(e,r,i)}const c=n.getText();if(c&&c.getText()){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(c),u.drawText(e,r,i)}}function xU(t,e,n,r,i,a){const o=n.getImage(),c=n.getText(),u=c&&c.getText(),h=a&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Dn.LOADED)return;const m=t.getBuilder(n.getZIndex(),"Image");m.setImageStyle(o,h),m.drawPoint(e,r,i)}if(u){const m=t.getBuilder(n.getZIndex(),"Text");m.setTextStyle(c,h),m.drawText(e,r,i)}}function pU(t,e,n,r,i,a){const o=n.getImage(),c=o&&o.getOpacity()!==0,u=n.getText(),h=u&&u.getText(),m=a&&c&&h?{}:void 0;if(c){if(o.getImageState()!=Dn.LOADED)return;const _=t.getBuilder(n.getZIndex(),"Image");_.setImageStyle(o,m),_.drawMultiPoint(e,r,i)}if(h){const _=t.getBuilder(n.getZIndex(),"Text");_.setTextStyle(u,m),_.drawText(e,r,i)}}function yU(t,e,n,r,i){const a=n.getFill(),o=n.getStroke();if(a||o){const u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(a,o),u.drawPolygon(e,r,i)}const c=n.getText();if(c&&c.getText()){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(c),u.drawText(e,r,i)}}class bU extends dj{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipExtent_=null,this.extendX_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=yo(),this.wrappedRenderedExtent_=yo(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,r){const i=n.extent,a=n.viewState,o=a.center,c=a.resolution,u=a.projection,h=a.rotation,m=u.getExtent(),_=this.getLayer().getSource(),p=this.getLayer().getDeclutter(),g=n.pixelRatio,C=n.viewHints,y=!(C[ka.ANIMATING]||C[ka.INTERACTING]),S=this.context,v=Math.round(hr(i)/c*g),k=Math.round(Xa(i)/c*g),L=_.getWrapX()&&u.canWrapX(),M=L?hr(m):null,P=L?Math.ceil((i[2]-m[2])/M)+(this.extendX_?2:1):1;let F=L?Math.floor((i[0]-m[0])/M)-(this.extendX_?1:0):0;do{let G=this.getRenderTransform(o,c,0,g,v,k,F*M);n.declutter&&(G=G.slice(0)),e.execute(S,[S.canvas.width,S.canvas.height],G,h,y,r===void 0?Rh:r?hj:sU,r?p&&n.declutter[p]:void 0)}while(++F<P)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Ui(this.context.canvas.width,this.context.canvas.height,SD))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,G1(this.context),SD.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.clipExtent_&&this.clipUnrotated(this.context,e,this.clipExtent_),this.replayGroup_.renderDeferred(),this.clipExtent_&&(this.context.restore(),this.clipExtent_=null),this.resetDrawContext_())}renderFrame(e,n){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,n);const a=this.context,o=this.replayGroup_;let c=o&&!o.isEmpty();if(!c&&!(this.getLayer().hasListener(fo.PRERENDER)||this.getLayer().hasListener(fo.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(a,e),i.projection,this.clipExtent_=null;let u=!1;if(c&&r.extent&&this.clipping){const h=Lu(r.extent);c=Sl(h,e.extent),c&&!Cg(h,e.extent)&&(e.declutter?this.clipExtent_=h:(this.clipUnrotated(a,e,h),u=!0))}return c&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),u&&a.restore(),this.postRender(a,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,a=this.renderedResolution_,o=this.renderedRotation_,c=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),m=[],_=r[0]*Tc,p=r[1]*Tc;m.push(this.getRenderTransform(i,a,o,Tc,_,p,0).slice());const g=h.getSource(),C=c.getExtent();if(g.getWrapX()&&c.canWrapX()&&!Cg(C,u)){let y=u[0];const S=hr(C);let v=0,k;for(;y<C[0];)--v,k=S*v,m.push(this.getRenderTransform(i,a,o,Tc,_,p,k).slice()),y+=S;for(v=0,y=u[2];y>C[2];)++v,k=S*v,m.push(this.getRenderTransform(i,a,o,Tc,_,p,k).slice()),y-=S}this.hitDetectionImageData_=lU(r,m,this.renderedFeatures_,h.getStyleFunction(),u,a,o,ID(a,this.renderedPixelRatio_))}n(oU(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,r,i,a){var p,g;if(!this.replayGroup_)return;const o=n.viewState.resolution,c=n.viewState.rotation,u=this.getLayer(),h={},m=function(C,y,S){const v=rr(C),k=h[v];if(k){if(k!==!0&&S<k.distanceSq){if(S===0)return h[v]=!0,a.splice(a.lastIndexOf(k),1),i(C,u,y);k.geometry=y,k.distanceSq=S}}else{if(S===0)return h[v]=!0,i(C,u,y);a.push(h[v]={feature:C,layer:u,geometry:y,distanceSq:S,callback:i})}},_=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,c,r,m,_?(g=(p=n.declutter)==null?void 0:p[_])==null?void 0:g.all().map(C=>C.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),r=n.getSource();if(!r)return!1;const i=e.viewHints[ka.ANIMATING],a=e.viewHints[ka.INTERACTING],o=n.getUpdateWhileAnimating(),c=n.getUpdateWhileInteracting();if(this.ready&&!o&&i||!c&&a)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,m=h.projection,_=h.resolution,p=e.pixelRatio,g=n.getRevision(),C=n.getRenderBuffer();let y=n.getRenderOrder();y===void 0&&(y=dU);const S=h.center.slice(),v=mN(u,C*_),k=v.slice(),L=[v.slice()],M=m.getExtent(),P=r.getWrapX()&&m.canWrapX();if(this.extendX_=!1,P){const H=r.getExtent();H&&!S_(H)&&(this.extendX_=H[0]<M[0]||H[2]>M[2])}if(P&&(!Cg(M,e.extent)||this.extendX_)){const H=hr(M),V=Math.max(hr(v)/2,H);let K=M[0],j=M[2];this.extendX_&&(K-=H,j+=H),v[0]=K-V,v[2]=j+V,mI(S,m);const te=hI(L[0],m);te[0]<M[0]&&te[2]<M[2]?L.push([te[0]+H,te[1],te[2]+H,te[3]]):te[0]>M[0]&&te[2]>M[2]&&L.push([te[0]-H,te[1],te[2]-H,te[3]])}if(this.ready&&this.renderedResolution_==_&&this.renderedPixelRatio_===p&&this.renderedRevision_==g&&this.renderedRenderOrder_==y&&this.renderedFrameDeclutter_===!!e.declutter&&Cg(this.wrappedRenderedExtent_,v))return Ju(this.renderedExtent_,k)||(this.hitDetectionImageData_=null,this.renderedExtent_=k),this.renderedCenter_=S,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new H9(_j(_,p),v,_,p);let G;for(let H=0,V=L.length;H<V;++H)r.loadFeatures(L[H],_,m);const B=ID(_,p);let I=!0;const E=(H,V)=>{let K;const j=H.getStyleFunction()||n.getStyleFunction();if(j&&(K=j(H,_)),K){const te=this.renderFeature(H,B,K,F,G,this.getLayer().getDeclutter(),V);I=I&&!te}},A=vI(v),Y=r.getFeaturesInExtent(A);y&&Y.sort(y);for(let H=0,V=Y.length;H<V;++H)E(Y[H],H);this.renderedFeatures_=Y,this.ready=I;const ee=F.finish(),J=new rU(v,_,p,r.getOverlaps(),ee,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=_,this.renderedRevision_=g,this.renderedRenderOrder_=y,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=k,this.wrappedRenderedExtent_=v,this.renderedCenter_=S,this.renderedProjection_=m,this.renderedPixelRatio_=p,this.replayGroup_=J,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,r,i,a,o,c){if(!r)return!1;let u=!1;if(Array.isArray(r))for(let h=0,m=r.length;h<m;++h)u=jD(i,e,r[h],n,this.boundHandleStyleImageChange_,a,o,c)||u;else u=jD(i,e,r,n,this.boundHandleStyleImageChange_,a,o,c);return u}}class OD extends nj{constructor(e){super(e)}createRenderer(){return new bU(this)}}let CU=!1;function NU(t,e,n,r,i,a,o){const c=new XMLHttpRequest;c.open("GET",typeof t=="function"?t(n,r,i):t,!0),e.getType()=="arraybuffer"&&(c.responseType="arraybuffer"),c.withCredentials=CU,c.onload=function(u){if(!c.status||c.status>=200&&c.status<300){const h=e.getType();try{let m;h=="text"||h=="json"?m=c.responseText:h=="xml"?m=c.responseXML||c.responseText:h=="arraybuffer"&&(m=c.response),m?a(e.readFeatures(m,{extent:n,featureProjection:i}),e.readProjection(m)):o()}catch{o()}}else o()},c.onerror=o,c.send()}function wD(t,e){return function(n,r,i,a,o){NU(t,e,n,r,i,(c,u)=>{this.addFeatures(c),a!==void 0&&a(c)},()=>{this.changed(),o!==void 0&&o()})}}function SU(t,e){return[[-1/0,-1/0,1/0,1/0]]}class vu extends kc{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new vu(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ei(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nr(e,Mn.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?vU(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function vU(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(_r(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}function EU(t,e,n,r){const i=[];let a=yo();for(let o=0,c=n.length;o<c;++o){const u=n[o];a=gN(t,e,u[0],r),i.push((a[0]+a[2])/2,(a[1]+a[3])/2),e=u[u.length-1]}return i}function LD(t,e,n,r,i,a,o){let c,u;const h=(n-e)/r;if(h===1)c=e;else if(h===2)c=e,u=i;else if(h!==0){let m=t[e],_=t[e+1],p=0;const g=[0];for(let S=e+r;S<n;S+=r){const v=t[S],k=t[S+1];p+=Math.sqrt((v-m)*(v-m)+(k-_)*(k-_)),g.push(p),m=v,_=k}const C=i*p,y=H6(g,C);y<0?(u=(C-g[-y-2])/(g[-y-1]-g[-y-2]),c=e+(-y-2)*r):c=e+y*r}o=o>1?o:2,a=a||new Array(o);for(let m=0;m<o;++m)a[m]=c===void 0?NaN:u===void 0?t[c+m]:oo(t[c+m],t[c+r+m],u);return a}const PD=Xo();class $o{constructor(e,n,r,i,a,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=a,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?oI(this.flatCoordinates_):gN(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Hh(this.getExtent());this.flatInteriorPoints_=DN(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=bk(this.flatCoordinates_,this.ends_),n=EU(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=gk(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=LD(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const r=this.ends_;for(let i=0,a=r.length;i<a;++i){const o=r[i],c=LD(e,n,o,2,.5);fN(this.flatMidpoints_,c),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Ta(e);const n=e.getExtent(),r=e.getWorldExtent();if(n&&r){const i=Xa(r)/Xa(n);Dd(PD,r[0],r[3],i,-i,0,0,0),Fu(this.flatCoordinates_,0,this.flatCoordinates_.length,2,PD,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new $o(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=tI((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=EN(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=hk(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=jI(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new $o(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}$o.prototype.getFlatCoordinates=$o.prototype.getOrientedFlatCoordinates;class AD{constructor(e){this.rbush_=new KI(e),this.items_={}}insert(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[rr(n)]=r}load(e,n){const r=new Array(n.length);for(let i=0,a=n.length;i<a;i++){const o=e[i],c=n[i],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:c};r[i]=u,this.items_[rr(c)]=u}this.rbush_.load(r)}remove(e){const n=rr(e),r=this.items_[n];return delete this.items_[n],this.rbush_.remove(r)!==null}update(e,n){const r=this.items_[rr(n)],i=[r.minX,r.minY,r.maxX,r.maxY];Xg(i,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let r;for(let i=0,a=e.length;i<a;i++)if(r=n(e[i]),r)return r;return r}isEmpty(){return lm(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return Vu(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class pj extends kc{constructor(e){super(),this.projection=Ta(e.projection),this.attributions_=kD(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(r,i){n.viewResolver=r,n.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=kD(e),this.changed()}setState(e){this.state_=e,this.changed()}}function kD(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const no={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class mu extends Id{constructor(e,n,r){super(e),this.feature=n,this.features=r}}class UD extends pj{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=qg,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(_r(this.format_,"`format` must be set when `url` is set"),this.loader_=wD(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:SU;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new AD:null,this.loadedExtentsRtree_=new AD,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!n&&r===void 0&&(r=new uo(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=rr(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new mu(no.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof $o||(this.featureChangeKeys_[e]=[nr(n,Mn.CHANGE,this.handleFeatureChange_,this),nr(n,am.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let r=!0;if(n.getId()!==void 0){const i=String(n.getId());if(!(i in this.idIndex_))this.idIndex_[i]=n;else if(n instanceof $o){const a=this.idIndex_[i];a instanceof $o?Array.isArray(a)?a.push(n):this.idIndex_[i]=[a,n]:r=!1}else r=!1}return r&&(_r(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],r=[],i=[];for(let a=0,o=e.length;a<o;a++){const c=e[a],u=rr(c);this.addToIndex_(u,c)&&r.push(c)}for(let a=0,o=r.length;a<o;a++){const c=r[a],u=rr(c);this.setupChangeEvents_(u,c);const h=c.getGeometry();if(h){const m=h.getExtent();n.push(m),i.push(c)}else this.nullGeometryFeatures_[u]=c}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(no.ADDFEATURE))for(let a=0,o=r.length;a<o;a++)this.dispatchEvent(new mu(no.ADDFEATURE,r[a]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(no.ADDFEATURE,function(r){n||(n=!0,e.push(r.feature),n=!1)}),this.addEventListener(no.REMOVEFEATURE,function(r){n||(n=!0,e.remove(r.feature),n=!1)}),e.addEventListener(bl.ADD,r=>{n||(n=!0,this.addFeature(r.element),n=!1)}),e.addEventListener(bl.REMOVE,r=>{n||(n=!0,this.removeFeature(r.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(ei);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new mu(no.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const a=i.getGeometry();if(a instanceof $o||a.intersectsCoordinate(e))return n(i)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof $o||i.intersectsExtent(e)){const a=n(r);if(a)return a}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),lm(this.nullGeometryFeatures_)||fN(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){n.push(r)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=fI(e,n);return[].concat(...i.map(a=>this.featuresRtree_.getInExtent(a)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const r=e[0],i=e[1];let a=null;const o=[NaN,NaN];let c=1/0;const u=[-1/0,-1/0,1/0,1/0];return n=n||Hg,this.featuresRtree_.forEachInExtent(u,function(h){if(n(h)){const m=h.getGeometry(),_=c;if(c=m instanceof $o?0:m.closestPointXY(r,i,o,c),c<_){a=h;const p=Math.sqrt(c);u[0]=r-p,u[1]=i-p,u[2]=r+p,u[3]=i+p}}}),a}getExtent(e){var n;return((n=this.featuresRtree_)==null?void 0:n.getExtent(e))??null}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,r=rr(n),i=n.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{const o=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const a=n.getId();if(a!==void 0){const o=a.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new mu(no.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:rr(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&lm(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,r){const i=this.loadedExtentsRtree_,a=this.strategy_(e,n,r);for(let o=0,c=a.length;o<c;++o){const u=a[o];i.forEachInExtent(u,function(m){return Cg(m.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new mu(no.FEATURESLOADSTART)),this.loader_.call(this,u,n,r,m=>{--this.loadingExtentsCount_,this.dispatchEvent(new mu(no.FEATURESLOADEND,void 0,m))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new mu(no.FEATURESLOADERROR))}),i.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,r=n.forEachInExtent(e,function(i){if(Xg(i.extent,e))return i});r&&n.remove(r)}removeFeatures(e){let n=!1;for(let r=0,i=e.length;r<i;++r)n=this.removeFeatureInternal(e[r])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=rr(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e);const r=this.featureChangeKeys_[n];r==null||r.forEach(ei),delete this.featureChangeKeys_[n];const i=e.getId();if(i!==void 0){const a=i.toString(),o=this.idIndex_[a];o===e?delete this.idIndex_[a]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[a]=o[0]))}return delete this.uidIndex_[n],this.hasListener(no.REMOVEFEATURE)&&this.dispatchEvent(new mu(no.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){_r(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(wD(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}const of=[0,0,0],gu=5;class YN{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,_r(J6(this.resolutions_,(i,a)=>a-i),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let i=0,a=this.resolutions_.length-1;i<a;++i)if(!n)n=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,_r(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=u0(r)),_r(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,_r(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:jN,_r(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,a)=>{const o=new QN(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const c=this.getTileRangeForExtentAndZ(r,a);o.minX=Math.max(c.minX,o.minX),o.maxX=Math.min(c.maxX,o.maxX),o.minY=Math.max(c.minY,o.minY),o.maxY=Math.min(c.maxY,o.maxY)}return o}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,n,r){const i=this.getTileRangeForExtentAndZ(e,n);for(let a=i.minX,o=i.maxX;a<=o;++a)for(let c=i.minY,u=i.maxY;c<=u;++c)r([n,a,c])}forEachTileCoordParentTileRange(e,n,r,i){let a,o,c,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],c=e[2]):u=this.getTileCoordExtent(e,i);h>=this.minZoom;){if(o!==void 0&&c!==void 0?(o=Math.floor(o/2),c=Math.floor(c/2),a=af(o,o,c,c,r)):a=this.getTileRangeForExtentAndZ(u,h,r),n(h,a))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getOrigins(){return this.origins_}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const a=e[1]*2,o=e[2]*2;return af(a,a+1,o,o+1,n)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,r){if(n>this.maxZoom||n<this.minZoom)return null;const i=e[0],a=e[1],o=e[2];if(n===i)return af(a,o,a,o,r);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,n-i),h=Math.floor(a*u),m=Math.floor(o*u);if(n<i)return af(h,h,m,m,r);const _=Math.floor(u*(a+1))-1,p=Math.floor(u*(o+1))-1;return af(h,_,m,p,r)}const c=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(c,n,r)}getTileRangeForExtentAndZ(e,n,r){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,of);const i=of[1],a=of[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,of);const o=of[1],c=of[2];return af(i,o,a,c,r)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=El(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*i[0]*r,n[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,n){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),a=El(this.getTileSize(e[0]),this.tmpSize_),o=r[0]+e[1]*a[0]*i,c=r[1]-(e[2]+1)*a[1]*i,u=o+a[0]*i,h=c+a[1]*i;return Vu(o,c,u,h,n)}getTileCoordForCoordAndResolution(e,n,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,r)}getTileCoordForXYAndResolution_(e,n,r,i,a){const o=this.getZForResolution(r),c=r/this.getResolution(o),u=this.getOrigin(o),h=El(this.getTileSize(o),this.tmpSize_);let m=c*(e-u[0])/r/h[0],_=c*(u[1]-n)/r/h[1];return i?(m=kx(m,gu)-1,_=kx(_,gu)-1):(m=Ax(m,gu),_=Ax(_,gu)),t1(o,m,_,a)}getTileCoordForXYAndZ_(e,n,r,i,a){const o=this.getOrigin(r),c=this.getResolution(r),u=El(this.getTileSize(r),this.tmpSize_);let h=(e-o[0])/c/u[0],m=(o[1]-n)/c/u[1];return i?(h=kx(h,gu)-1,m=kx(m,gu)-1):(h=Ax(h,gu),m=Ax(m,gu)),t1(r,h,m,a)}getTileCoordForCoordAndZ(e,n,r){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const r=hN(this.resolutions_,e,n||0);return Ur(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return PI(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,r=new Array(n);for(let i=this.minZoom;i<n;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}class DU extends YN{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}}function yj(t){let e=t.getDefaultTileGrid();return e||(e=IU(t),t.setDefaultTileGrid(e)),e}function RU(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),a=VN(n);if(!om(a,i)){const o=hr(a),c=Math.ceil((a[0]-i[0])/o);return i[0]+=o*c,t.getTileCoordForCoordAndZ(i,r)}return e}function TU(t,e,n,r){r=r!==void 0?r:"top-left";const i=bj(t,e,n);return new YN({extent:t,origin:m8(t,r),resolutions:i,tileSize:n})}function MU(t){const e=t||{},n=e.extent||Ta("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:bj(n,e.maxZoom,e.tileSize,e.maxResolution)};return new YN(r)}function bj(t,e,n,r){e=e!==void 0?e:Ek,n=El(n!==void 0?n:jN);const i=Xa(t),a=hr(t);r=r>0?r:Math.max(a/n[0],i/n[1]);const o=e+1,c=new Array(o);for(let u=0;u<o;++u)c[u]=r/Math.pow(2,u);return c}function IU(t,e,n,r){const i=VN(t);return TU(i,e,n,r)}function VN(t){t=Ta(t);let e=t.getExtent();if(!e){const n=180*xN.degrees/t.getMetersPerUnit();e=Vu(-n,-n,n,n)}return e}function BD(t,e){const n=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&n.push(i+"="+encodeURIComponent(e[i]))});const r=n.join("&");return t=t.replace(/[?&]$/,""),t+=t.includes("?")?"&":"?",t+r}const jU=/\{z\}/g,OU=/\{x\}/g,wU=/\{y\}/g,LU=/\{-y\}/g;function PU(t,e,n,r,i){return t.replace(jU,e.toString()).replace(OU,n.toString()).replace(wU,r.toString()).replace(LU,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function Cj(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let a;for(a=r;a<=i;++a)e.push(t.replace(n[0],String.fromCharCode(a)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}function AU(t,e){return(function(n,r,i){if(!n)return;let a;const o=n[0];if(e){const c=e.getFullTileRange(o);c&&(a=c.getHeight()-1)}return PU(t,o,n[1],n[2],a)})}function kU(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=AU(t[i],e);return x2(r)}function x2(t){return t.length===1?t[0]:(function(e,n,r){if(!e)return;const i=L9(e),a=Pf(i,t.length);return t[a](e,n,r)})}class UU extends pj{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&El(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||rr(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,r,i,a,o){return sr()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:yj(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),a=this.getTilePixelRatio(n),o=El(i.getTileSize(e),this.tmpSize);return a==1?o:b7(o,a,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const r=n!==void 0?n:this.getProjection(),i=n!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=RU(i,e,r)),A9(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class BU extends Id{constructor(e,n){super(e),this.tile=n}}const Jb={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class $N extends UU{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===$N.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,r=rr(n),i=n.getState();let a;i==dn.LOADING?(this.tileLoadingKeys_[r]=!0,a=Jb.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],a=i==dn.ERROR?Jb.TILELOADERROR:i==dn.LOADED?Jb.TILELOADEND:void 0),a!=null&&this.dispatchEvent(new BU(a,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=Cj(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(kU(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,r){}}class Nj extends $N{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:GU,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.referrerPolicy=e.referrerPolicy,this.tileClass=e.tileClass!==void 0?e.tileClass:lj,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!pp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||pp(n,e)))return this.tileGrid;const r=rr(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=yj(e)),this.tileGridForProjection[r]}createTile_(e,n,r,i,a,o){const c=[e,n,r],u=this.getTileCoordForTileUrlFunction(c,a),h=u?this.tileUrlFunction(u,i,a):void 0,m=new this.tileClass(c,h!==void 0?dn.IDLE:dn.EMPTY,h!==void 0?h:"",{crossOrigin:this.crossOrigin,referrerPolicy:this.referrerPolicy},this.tileLoadFunction,this.tileOptions);return m.key=o,m.addEventListener(Mn.CHANGE,this.handleTileChange.bind(this)),m}getTile(e,n,r,i,a,o){const c=this.getProjection();if(!c||!a||pp(c,a))return this.getTileInternal(e,n,r,i,c||a);const u=[e,n,r],h=this.getKey(),m=this.getTileGridForProjection(c),_=this.getTileGridForProjection(a),p=this.getTileCoordForTileUrlFunction(u,a),g=new oj(c,m,a,_,u,p,this.getTilePixelRatio(i),this.getGutter(),(C,y,S,v)=>this.getTileInternal(C,y,S,v,c,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=h,g}getTileInternal(e,n,r,i,a,o){const c=this.getKey(),u=yp(this,c,e,n,r);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,n,r,i,a,c);return o==null||o.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const r=Ta(e);if(r){const i=rr(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=n)}}}function GU(t,e){if(ho){const n=t.getCrossOrigin();let r="same-origin",i="same-origin";n==="anonymous"||n===""?(r="cors",i="omit"):n==="use-credentials"&&(r="cors",i="include");const a={mode:r,credentials:i,referrerPolicy:t.getReferrerPolicy()};fetch(e,a).then(o=>{if(!o.ok)throw new Error(`HTTP ${o.status}`);return o.blob()}).then(o=>createImageBitmap(o)).then(o=>{var h;const c=t.getImage();c.width=o.width,c.height=o.height,c.getContext("2d").drawImage(o,0,0),(h=o.close)==null||h.call(o),c.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class WU extends Nj{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:MU({extent:VN(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,referrerPolicy:e.referrerPolicy,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}function FU(t){const e=Object.keys(t.defs),n=e.length;let r,i;for(r=0;r<n;++r){const a=e[r];if(!_p(a)){const o=t.defs(a);let c=o.units;!c&&o.projName==="longlat"&&(c="degrees"),Hp(new A1({code:a,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:c}))}}for(r=0;r<n;++r){const a=e[r],o=_p(a);for(i=0;i<n;++i){const c=e[i],u=_p(c);if(!xp(a,c))if(t.defs[a]===t.defs[c])a2([o,u]);else{const h=t(a,c);z8(o,u,KE(o,u,h.forward),KE(u,o,h.inverse))}}}}class KU extends Nj{constructor(e){const n=e.requestEncoding!==void 0?e.requestEncoding:"KVP",r=e.tileGrid;let i=e.urls;i===void 0&&e.url!==void 0&&(i=Cj(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,referrerPolicy:e.referrerPolicy,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:i,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=n,this.setKey(this.getKeyForDimensions_()),i&&i.length>0&&(this.tileUrlFunction=x2(i.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const n=e.join(`
`);this.setTileUrlFunction(x2(e.map(this.createFromWMTSTemplate.bind(this))),n)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const n in this.dimensions_)e.push(n+"-"+this.dimensions_[n]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const n=this.requestEncoding_,r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};n=="KVP"&&Object.assign(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=n=="KVP"?BD(e,r):e.replace(/\{(\w+?)\}/g,function(o,c){return c.toLowerCase()in r?r[c.toLowerCase()]:o});const i=this.tileGrid,a=this.dimensions_;return(function(o,c,u){if(!o)return;const h={TileMatrix:i.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(h,a);let m=e;return n=="KVP"?m=BD(m,h):m=m.replace(/\{(\w+?)\}/g,function(_,p){return encodeURIComponent(h[p])}),m})}}function QU(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Zh=1,e0=2,Bf=3,YU=4,p2=5,GD=6378137,VU=6356752314e-3,WD=.0066943799901413165,Bg=484813681109536e-20,ps=Math.PI/2,$U=.16666666666666666,zU=.04722222222222222,HU=.022156084656084655,Ms=1e-10,yi=.017453292519943295,Dl=57.29577951308232,mr=Math.PI/4,a_=Math.PI*2,vi=3.14159265359,Tl={};Tl.greenwich=0;Tl.lisbon=-9.131906111111;Tl.paris=2.337229166667;Tl.bogota=-74.080916666667;Tl.madrid=-3.687938888889;Tl.rome=12.452333333333;Tl.bern=7.439583333333;Tl.jakarta=106.807719444444;Tl.ferro=-17.666666666667;Tl.brussels=4.367975;Tl.stockholm=18.058277777778;Tl.athens=23.7163375;Tl.oslo=10.722916666667;const qU={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var FD=/[\s_\-\/\(\)]/g;function $u(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(FD,""),i=-1,a,o;++i<n.length;)if(a=n[i],o=a.toLowerCase().replace(FD,""),o===r)return t[a]}function y2(t){var e={},n=t.split("+").map(function(c){return c.trim()}).filter(function(c){return c}).reduce(function(c,u){var h=u.split("=");return h.push(!0),c[h[0].toLowerCase()]=h[1],c},{}),r,i,a,o={proj:"projName",datum:"datumCode",rf:function(c){e.rf=parseFloat(c)},lat_0:function(c){e.lat0=c*yi},lat_1:function(c){e.lat1=c*yi},lat_2:function(c){e.lat2=c*yi},lat_ts:function(c){e.lat_ts=c*yi},lon_0:function(c){e.long0=c*yi},lon_1:function(c){e.long1=c*yi},lon_2:function(c){e.long2=c*yi},alpha:function(c){e.alpha=parseFloat(c)*yi},gamma:function(c){e.rectified_grid_angle=parseFloat(c)*yi},lonc:function(c){e.longc=c*yi},x_0:function(c){e.x0=parseFloat(c)},y_0:function(c){e.y0=parseFloat(c)},k_0:function(c){e.k0=parseFloat(c)},k:function(c){e.k0=parseFloat(c)},a:function(c){e.a=parseFloat(c)},b:function(c){e.b=parseFloat(c)},r:function(c){e.a=e.b=parseFloat(c)},r_a:function(){e.R_A=!0},zone:function(c){e.zone=parseInt(c,10)},south:function(){e.utmSouth=!0},towgs84:function(c){e.datum_params=c.split(",").map(function(u){return parseFloat(u)})},to_meter:function(c){e.to_meter=parseFloat(c)},units:function(c){e.units=c;var u=$u(qU,c);u&&(e.to_meter=u.to_meter)},from_greenwich:function(c){e.from_greenwich=c*yi},pm:function(c){var u=$u(Tl,c);e.from_greenwich=(u||parseFloat(c))*yi},nadgrids:function(c){c==="@null"?e.datumCode="none":e.nadgrids=c},axis:function(c){var u="ewnsud";c.length===3&&u.indexOf(c.substr(0,1))!==-1&&u.indexOf(c.substr(1,1))!==-1&&u.indexOf(c.substr(2,1))!==-1&&(e.axis=c)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in n)i=n[r],r in o?(a=o[r],typeof a=="function"?a(i):e[a]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=t,e}class Sj{static getId(e){const n=e.find(r=>Array.isArray(r)&&r[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(e,n="unit"){if(!e||e.length<3)return{type:n,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,a=e.find(c=>Array.isArray(c)&&c[0]==="ID"),o=a?{authority:a[1],code:parseInt(a[2],10)}:null;return{type:n,name:r,conversion_factor:i,id:o}}static convertAxis(e){const n=e[1]||"Unknown";let r;const i=n.match(/^\((.)\)$/);if(i){const h=i[1].toUpperCase();if(h==="E")r="east";else if(h==="N")r="north";else if(h==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else r=e[2]?e[2].toLowerCase():"unknown";const a=e.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=a?parseInt(a[1],10):null,c=e.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),u=this.convertUnit(c);return{name:n,direction:r,unit:u,order:o}}static extractAxes(e){return e.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,r)=>(n.order||0)-(r.order||0))}static convert(e,n={}){switch(e[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=e[1],n.base_crs=e.find(p=>Array.isArray(p)&&p[0]==="BASEGEOGCRS")?this.convert(e.find(p=>Array.isArray(p)&&p[0]==="BASEGEOGCRS")):null,n.conversion=e.find(p=>Array.isArray(p)&&p[0]==="CONVERSION")?this.convert(e.find(p=>Array.isArray(p)&&p[0]==="CONVERSION")):null;const r=e.find(p=>Array.isArray(p)&&p[0]==="CS");r&&(n.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(p=>Array.isArray(p)&&p[0]==="LENGTHUNIT");if(i){const p=this.convertUnit(i);n.coordinate_system.unit=p}n.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=e[1];const a=e.find(p=>Array.isArray(p)&&(p[0]==="DATUM"||p[0]==="ENSEMBLE"));if(a){const p=this.convert(a);a[0]==="ENSEMBLE"?n.datum_ensemble=p:n.datum=p;const g=e.find(C=>Array.isArray(C)&&C[0]==="PRIMEM");g&&g[1]!=="Greenwich"&&(p.prime_meridian={name:g[1],longitude:parseFloat(g[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},n.id=this.getId(e);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=e[1],n.ellipsoid=e.find(p=>Array.isArray(p)&&p[0]==="ELLIPSOID")?this.convert(e.find(p=>Array.isArray(p)&&p[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=e[1],n.members=e.filter(p=>Array.isArray(p)&&p[0]==="MEMBER").map(p=>({type:"DatumEnsembleMember",name:p[1],id:this.getId(p)}));const o=e.find(p=>Array.isArray(p)&&p[0]==="ENSEMBLEACCURACY");o&&(n.accuracy=parseFloat(o[1]));const c=e.find(p=>Array.isArray(p)&&p[0]==="ELLIPSOID");c&&(n.ellipsoid=this.convert(c)),n.id=this.getId(e);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=e[1],n.semi_major_axis=parseFloat(e[2]),n.inverse_flattening=parseFloat(e[3]),e.find(p=>Array.isArray(p)&&p[0]==="LENGTHUNIT")&&this.convert(e.find(p=>Array.isArray(p)&&p[0]==="LENGTHUNIT"),n);break;case"CONVERSION":n.type="Conversion",n.name=e[1],n.method=e.find(p=>Array.isArray(p)&&p[0]==="METHOD")?this.convert(e.find(p=>Array.isArray(p)&&p[0]==="METHOD")):null,n.parameters=e.filter(p=>Array.isArray(p)&&p[0]==="PARAMETER").map(p=>this.convert(p));break;case"METHOD":n.type="Method",n.name=e[1],n.id=this.getId(e);break;case"PARAMETER":n.type="Parameter",n.name=e[1],n.value=parseFloat(e[2]),n.unit=this.convertUnit(e.find(p=>Array.isArray(p)&&(p[0]==="LENGTHUNIT"||p[0]==="ANGLEUNIT"||p[0]==="SCALEUNIT"))),n.id=this.getId(e);break;case"BOUNDCRS":n.type="BoundCRS";const u=e.find(p=>Array.isArray(p)&&p[0]==="SOURCECRS");if(u){const p=u.find(g=>Array.isArray(g));n.source_crs=p?this.convert(p):null}const h=e.find(p=>Array.isArray(p)&&p[0]==="TARGETCRS");if(h){const p=h.find(g=>Array.isArray(g));n.target_crs=p?this.convert(p):null}const m=e.find(p=>Array.isArray(p)&&p[0]==="ABRIDGEDTRANSFORMATION");m?n.transformation=this.convert(m):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=e[1],n.method=e.find(p=>Array.isArray(p)&&p[0]==="METHOD")?this.convert(e.find(p=>Array.isArray(p)&&p[0]==="METHOD")):null,n.parameters=e.filter(p=>Array.isArray(p)&&(p[0]==="PARAMETER"||p[0]==="PARAMETERFILE")).map(p=>{if(p[0]==="PARAMETER")return this.convert(p);if(p[0]==="PARAMETERFILE")return{name:p[1],value:p[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){const p=n.parameters[6];p.name==="Scale difference"&&(p.value=Math.round((p.value-1)*1e12)/1e6)}n.id=this.getId(e);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const _=this.convertUnit(e,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(p=>{p.unit||(p.unit=_)}),_.conversion_factor&&_.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:_});break;default:n.keyword=e[0];break}return n}}class XU extends Sj{static convert(e,n={}){return super.convert(e,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}}class JU extends Sj{static convert(e,n={}){super.convert(e,n);const r=e.find(a=>Array.isArray(a)&&a[0]==="CS");r&&(n.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(a=>Array.isArray(a)&&a[0]==="USAGE");if(i){const a=i.find(u=>Array.isArray(u)&&u[0]==="SCOPE"),o=i.find(u=>Array.isArray(u)&&u[0]==="AREA"),c=i.find(u=>Array.isArray(u)&&u[0]==="BBOX");n.usage={},a&&(n.usage.scope=a[1]),o&&(n.usage.area=o[1]),c&&(n.usage.bbox=c.slice(1))}return n}}function ZU(t){return t.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(t.find(e=>Array.isArray(e)&&e[0]==="CS")||t[0]==="BOUNDCRS"||t[0]==="PROJCRS"||t[0]==="GEOGCRS","2015")}function eB(t){return(ZU(t)==="2019"?JU:XU).convert(t)}function tB(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var l_=1,vj=2,Ej=3,n1=4,Dj=5,zN=-1,sB=/\s/,nB=/[A-Za-z]/,rB=/[A-Za-z84_]/,H1=/[,\]]/,Rj=/[\d\.E\-\+]/;function Od(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=l_}Od.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==n1)for(;sB.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case l_:return this.neutral(t);case vj:return this.keyword(t);case n1:return this.quoted(t);case Dj:return this.afterquote(t);case Ej:return this.number(t);case zN:return}};Od.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=n1;return}if(H1.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};Od.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=l_;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=l_,this.currentObject=this.stack.pop(),this.currentObject||(this.state=zN);return}};Od.prototype.number=function(t){if(Rj.test(t)){this.word+=t;return}if(H1.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};Od.prototype.quoted=function(t){if(t==='"'){this.state=Dj;return}this.word+=t};Od.prototype.keyword=function(t){if(rB.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=l_;return}if(H1.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};Od.prototype.neutral=function(t){if(nB.test(t)){this.word=t,this.state=vj;return}if(t==='"'){this.word="",this.state=n1;return}if(Rj.test(t)){this.word=t,this.state=Ej;return}if(H1.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};Od.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===zN)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function iB(t){var e=new Od(t);return e.output()}function Zb(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce(function(a,o){return Df(o,a),a},r);e&&(t[e]=i)}function Df(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},Df(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&Df(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&Df(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],Zb(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],Zb(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Df(t,e[n]);return Zb(e,n,t)}}var aB=.017453292519943295;function Qo(t){return t*aB}function Tj(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");!t.long0&&t.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(t.lat0=Qo(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1):!t.lat_ts&&t.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(t.lat_ts=t.lat0,t.lat0=Qo(t.lat0>0?90:-90),delete t.lat1)}function KD(t){let e={units:null,to_meter:void 0};return typeof t=="string"?(e.units=t.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function QD(t){return typeof t=="object"?t.value*t.unit.conversion_factor:t}function YD(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=QD(t.ellipsoid.semi_major_axis),t.ellipsoid.inverse_flattening!==void 0?e.rf=t.ellipsoid.inverse_flattening:t.ellipsoid.semi_major_axis!==void 0&&t.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-QD(t.ellipsoid.semi_minor_axis))))}function r1(t,e={}){return!t||typeof t!="object"?t:t.type==="BoundCRS"?(r1(t.source_crs,e),t.transformation&&(t.transformation.method&&t.transformation.method.name==="NTv2"?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(n=>n.value)),e):(Object.keys(t).forEach(n=>{const r=t[n];if(r!==null)switch(n){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,YD(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,YD(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const a=i.direction;if(a==="east")return"e";if(a==="north")return"n";if(a==="west")return"w";if(a==="south")return"s";throw new Error(`Unknown axis direction: ${a}`)}).join("")+"u",r.unit){const{units:i,to_meter:a}=KD(r.unit);e.units=i,e.to_meter=a}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:a}=KD(r.axis[0].unit);e.units=i,e.to_meter=a}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const a=i.name.toLowerCase().replace(/\s+/g,"_"),o=i.value;i.unit&&i.unit.conversion_factor?e[a]=o*i.unit.conversion_factor:i.unit==="degree"?e[a]=o*Math.PI/180:e[a]=o});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":r1(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),Tj(e),e)}var lB=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function oB(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function Mj(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var i=e[n];lB.indexOf(i)!==-1&&cB(t[i]),typeof t[i]=="object"&&Mj(t[i])}}function cB(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,i=t.AXIS.length;r<i;++r){var a=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];a[0].indexOf("north")!==-1||(a[0]==="y"||a[0]==="lat")&&a[1]==="north"?n+="n":a[0].indexOf("south")!==-1||(a[0]==="y"||a[0]==="lat")&&a[1]==="south"?n+="s":a[0].indexOf("east")!==-1||(a[0]==="x"||a[0]==="lon")&&a[1]==="east"?n+="e":(a[0].indexOf("west")!==-1||(a[0]==="x"||a[0]==="lon")&&a[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;t.type==="GEOGCS"&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=Qo(t.rectified_grid_angle));function c(m){var _=t.to_meter||1;return m*_}var u=function(m){return oB(t,m)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Qo],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Qo],["x0","false_easting",c],["y0","false_northing",c],["long0","central_meridian",Qo],["lat0","latitude_of_origin",Qo],["lat0","standard_parallel_1",Qo],["lat1","standard_parallel_1",Qo],["lat2","standard_parallel_2",Qo],["azimuth","Azimuth"],["alpha","azimuth",Qo],["srsCode","name"]];h.forEach(u),Tj(t)}function i1(t){if(typeof t=="object")return r1(t);const e=tB(t);var n=iB(t);if(e==="WKT2"){const a=eB(n);return r1(a)}var r=n[0],i={};return Df(n,i),Mj(i),i[r]}function va(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?va[t]=y2(arguments[1]):va[t]=i1(arguments[1]):n&&typeof n=="object"&&!("projName"in n)?va[t]=i1(arguments[1]):(va[t]=n,n||delete va[t])}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){return Array.isArray(r)?va.apply(e,r):va(r)});if(typeof t=="string"){if(t in va)return va[t]}else"EPSG"in t?va["EPSG:"+t.EPSG]=t:"ESRI"in t?va["ESRI:"+t.ESRI]=t:"IAU2000"in t?va["IAU2000:"+t.IAU2000]=t:console.log(t);return}}QU(va);function dB(t){return typeof t=="string"}function uB(t){return t in va}function hB(t){return t.indexOf("+")!==0&&t.indexOf("[")!==-1||typeof t=="object"&&!("srsCode"in t)}var fB=["3857","900913","3785","102113"];function mB(t){var e=$u(t,"authority");if(e){var n=$u(e,"epsg");return n&&fB.indexOf(n)>-1}}function gB(t){var e=$u(t,"extension");if(e)return $u(e,"proj4")}function _B(t){return t[0]==="+"}function xB(t){if(dB(t)){if(uB(t))return va[t];if(hB(t)){var e=i1(t);if(mB(e))return va["EPSG:3857"];var n=gB(e);return n?y2(n):e}if(_B(t))return y2(t)}else return"projName"in t?t:i1(t)}function VD(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Pc(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function M_(t){return t<0?-1:1}function As(t,e){return e||Math.abs(t)<=vi?t:t-M_(t)*a_}function Jo(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(ps-e))/r}function o_(t,e){for(var n=.5*t,r,i,a=ps-2*Math.atan(e),o=0;o<=15;o++)if(r=t*Math.sin(a),i=ps-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-a,a+=i,Math.abs(i)<=1e-10)return a;return-9999}function pB(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Pc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function yB(t){var e=t.x,n=t.y;if(n*Dl>90&&n*Dl<-90&&e*Dl>180&&e*Dl<-180)return null;var r,i;if(Math.abs(Math.abs(n)-ps)<=Ms)return null;if(this.sphere)r=this.x0+this.a*this.k0*As(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(mr+.5*n));else{var a=Math.sin(n),o=Jo(this.e,n,a);r=this.x0+this.a*this.k0*As(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=r,t.y=i,t}function bB(t){var e=t.x-this.x0,n=t.y-this.y0,r,i;if(this.sphere)i=ps-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var a=Math.exp(-n/(this.a*this.k0));if(i=o_(this.e,a),i===-9999)return null}return r=As(this.long0+e/(this.a*this.k0),this.over),t.x=r,t.y=i,t}var CB=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const NB={init:pB,forward:yB,inverse:bB,names:CB};function SB(){}function $D(t){return t}var Ij=["longlat","identity"];const vB={init:SB,forward:$D,inverse:$D,names:Ij};var EB=[NB,vB],vh={},Rf=[];function jj(t,e){var n=Rf.length;return t.names?(Rf[n]=t,t.names.forEach(function(r){vh[r.toLowerCase()]=n}),this):(console.log(e),!0)}function Oj(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function DB(t){if(!t)return!1;var e=t.toLowerCase();if(typeof vh[e]<"u"&&Rf[vh[e]]||(e=Oj(e),e in vh&&Rf[vh[e]]))return Rf[vh[e]]}function RB(){EB.forEach(jj)}const TB={start:RB,add:jj,get:DB};var wj={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const MB=wj.WGS84;function IB(t,e,n,r){var i=t*t,a=e*e,o=(i-a)/i,c=0;r?(t*=1-o*($U+o*(zU+o*HU)),i=t*t,o=0):c=Math.sqrt(o);var u=(i-a)/a;return{es:o,e:c,ep2:u}}function jB(t,e,n,r,i){if(!t){var a=$u(wj,r);a||(a=MB),t=a.a,e=a.b,n=a.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<Ms)&&(i=!0,e=t),{a:t,b:e,rf:n,sphere:i}}var Cp={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var OB in Cp){var eC=Cp[OB];eC.datumName&&(Cp[eC.datumName]=eC)}function wB(t,e,n,r,i,a,o){var c={};return t===void 0||t==="none"?c.datum_type=p2:c.datum_type=YU,e&&(c.datum_params=e.map(parseFloat),(c.datum_params[0]!==0||c.datum_params[1]!==0||c.datum_params[2]!==0)&&(c.datum_type=Zh),c.datum_params.length>3&&(c.datum_params[3]!==0||c.datum_params[4]!==0||c.datum_params[5]!==0||c.datum_params[6]!==0)&&(c.datum_type=e0,c.datum_params[3]*=Bg,c.datum_params[4]*=Bg,c.datum_params[5]*=Bg,c.datum_params[6]=c.datum_params[6]/1e6+1)),o&&(c.datum_type=Bf,c.grids=o),c.a=n,c.b=r,c.es=i,c.ep2=a,c}var HN={};function LB(t,e,n){return e instanceof ArrayBuffer?PB(t,e,n):{ready:AB(t,e)}}function PB(t,e,n){var r=!0;n!==void 0&&n.includeErrorFields===!1&&(r=!1);var i=new DataView(e),a=BB(i),o=GB(i,a),c=WB(i,o,a,r),u={header:o,subgrids:c};return HN[t]=u,u}async function AB(t,e){for(var n=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var a=await e.getImage(i),o=await a.readRasters(),c=o,u=[a.getWidth(),a.getHeight()],h=a.getBoundingBox().map(zD),m=[a.fileDirectory.ModelPixelScale[0],a.fileDirectory.ModelPixelScale[1]].map(zD),_=h[0]+(u[0]-1)*m[0],p=h[3]-(u[1]-1)*m[1],g=c[0],C=c[1],y=[];for(let k=u[1]-1;k>=0;k--)for(let L=u[0]-1;L>=0;L--){var S=k*u[0]+L;y.push([-ku(C[S]),ku(g[S])])}n.push({del:m,lim:u,ll:[-_,p],cvs:y})}var v={header:{nSubgrids:r},subgrids:n};return HN[t]=v,v}function kB(t){if(t===void 0)return null;var e=t.split(",");return e.map(UB)}function UB(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:HN[t]||null,isNull:!1}}function zD(t){return t*Math.PI/180}function ku(t){return t/3600*Math.PI/180}function BB(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function GB(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:b2(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function b2(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function WB(t,e,n,r){for(var i=176,a=[],o=0;o<e.nSubgrids;o++){var c=KB(t,i,n),u=QB(t,i,c,n,r),h=Math.round(1+(c.upperLongitude-c.lowerLongitude)/c.longitudeInterval),m=Math.round(1+(c.upperLatitude-c.lowerLatitude)/c.latitudeInterval);a.push({ll:[ku(c.lowerLongitude),ku(c.lowerLatitude)],del:[ku(c.longitudeInterval),ku(c.latitudeInterval)],lim:[h,m],count:c.gridNodeCount,cvs:FB(u)});var _=16;r===!1&&(_=8),i+=176+c.gridNodeCount*_}return a}function FB(t){return t.map(function(e){return[ku(e.longitudeShift),ku(e.latitudeShift)]})}function KB(t,e,n){return{name:b2(t,e+8,e+16).trim(),parent:b2(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function QB(t,e,n,r,i){var a=e+176,o=16;i===!1&&(o=8);for(var c=[],u=0;u<n.gridNodeCount;u++){var h={latitudeShift:t.getFloat32(a+u*o,r),longitudeShift:t.getFloat32(a+u*o+4,r)};i!==!1&&(h.latitudeAccuracy=t.getFloat32(a+u*o+8,r),h.longitudeAccuracy=t.getFloat32(a+u*o+12,r)),c.push(h)}return c}function xo(t,e){if(!(this instanceof xo))return new xo(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(h){if(h)throw h};var n=xB(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=xo.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var i=$u(Cp,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var a=jB(n.a,n.b,n.rf,n.ellps,n.sphere),o=IB(a.a,a.b,a.rf,n.R_A),c=kB(n.nadgrids),u=n.datum||wB(n.datumCode,n.datum_params,a.a,a.b,o.es,o.ep2,c);VD(this,n),VD(this,r),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=u,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}xo.projections=TB;xo.projections.start();function YB(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Zh?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===e0?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function Lj(t,e,n){var r=t.x,i=t.y,a=t.z?t.z:0,o,c,u,h;if(i<-ps&&i>-1.001*ps)i=-ps;else if(i>ps&&i<1.001*ps)i=ps;else{if(i<-ps)return{x:-1/0,y:-1/0,z:t.z};if(i>ps)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),c=Math.sin(i),h=Math.cos(i),u=c*c,o=n/Math.sqrt(1-e*u),{x:(o+a)*h*Math.cos(r),y:(o+a)*h*Math.sin(r),z:(o*(1-e)+a)*c}}function Pj(t,e,n,r){var i=1e-12,a=i*i,o=30,c,u,h,m,_,p,g,C,y,S,v,k,L,M=t.x,P=t.y,F=t.z?t.z:0,G,B,I;if(c=Math.sqrt(M*M+P*P),u=Math.sqrt(M*M+P*P+F*F),c/n<i){if(G=0,u/n<i)return B=ps,I=-r,{x:t.x,y:t.y,z:t.z}}else G=Math.atan2(P,M);h=F/u,m=c/u,_=1/Math.sqrt(1-e*(2-e)*m*m),C=m*(1-e)*_,y=h*_,L=0;do L++,g=n/Math.sqrt(1-e*y*y),I=c*C+F*y-g*(1-e*y*y),p=e*g/(g+I),_=1/Math.sqrt(1-p*(2-p)*m*m),S=m*(1-p)*_,v=h*_,k=v*C-S*y,C=S,y=v;while(k*k>a&&L<o);return B=Math.atan(v/Math.abs(S)),{x:G,y:B,z:I}}function VB(t,e,n){if(e===Zh)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===e0){var r=n[0],i=n[1],a=n[2],o=n[3],c=n[4],u=n[5],h=n[6];return{x:h*(t.x-u*t.y+c*t.z)+r,y:h*(u*t.x+t.y-o*t.z)+i,z:h*(-c*t.x+o*t.y+t.z)+a}}}function $B(t,e,n){if(e===Zh)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===e0){var r=n[0],i=n[1],a=n[2],o=n[3],c=n[4],u=n[5],h=n[6],m=(t.x-r)/h,_=(t.y-i)/h,p=(t.z-a)/h;return{x:m+u*_-c*p,y:-u*m+_+o*p,z:c*m-o*_+p}}}function $x(t){return t===Zh||t===e0}function zB(t,e,n){if(YB(t,e)||t.datum_type===p2||e.datum_type===p2)return n;var r=t.a,i=t.es;if(t.datum_type===Bf){var a=HD(t,!1,n);if(a!==0)return;r=GD,i=WD}var o=e.a,c=e.b,u=e.es;if(e.datum_type===Bf&&(o=GD,c=VU,u=WD),i===u&&r===o&&!$x(t.datum_type)&&!$x(e.datum_type))return n;if(n=Lj(n,i,r),$x(t.datum_type)&&(n=VB(n,t.datum_type,t.datum_params)),$x(e.datum_type)&&(n=$B(n,e.datum_type,e.datum_params)),n=Pj(n,u,o,c),e.datum_type===Bf){var h=HD(e,!0,n);if(h!==0)return}return n}function HD(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},a=[];e:for(var o=0;o<t.grids.length;o++){var c=t.grids[o];if(a.push(c.name),c.isNull){i=r;break}if(c.grid===null){if(c.mandatory)return console.log("Unable to find mandatory grid '"+c.name+"'"),-1;continue}for(var u=c.grid.subgrids,h=0,m=u.length;h<m;h++){var _=u[h],p=(Math.abs(_.del[1])+Math.abs(_.del[0]))/1e4,g=_.ll[0]-p,C=_.ll[1]-p,y=_.ll[0]+(_.lim[0]-1)*_.del[0]+p,S=_.ll[1]+(_.lim[1]-1)*_.del[1]+p;if(!(C>r.y||g>r.x||S<r.y||y<r.x)&&(i=HB(r,e,_),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Dl+" "+r.y*Dl+" tried: '"+a+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function HB(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var i={x:t.x,y:t.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=As(i.x-Math.PI)+Math.PI;var a=qD(i,n);if(e){if(isNaN(a.x))return r;a.x=i.x-a.x,a.y=i.y-a.y;var o=9,c=1e-12,u,h;do{if(h=qD(a,n),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}u={x:i.x-(h.x+a.x),y:i.y-(h.y+a.y)},a.x+=u.x,a.y+=u.y}while(o--&&Math.abs(u.x)>c&&Math.abs(u.y)>c);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=As(a.x+n.ll[0]),r.y=a.y+n.ll[1]}else isNaN(a.x)||(r.x=t.x+a.x,r.y=t.y+a.y);return r}function qD(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},a={x:Number.NaN,y:Number.NaN},o;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return a;o=r.y*e.lim[0]+r.x;var c={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var u={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var h={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var m={x:e.cvs[o][0],y:e.cvs[o][1]},_=i.x*i.y,p=i.x*(1-i.y),g=(1-i.x)*(1-i.y),C=(1-i.x)*i.y;return a.x=g*c.x+p*u.x+C*m.x+_*h.x,a.y=g*c.y+p*u.y+C*m.y+_*h.y,a}function XD(t,e,n){var r=n.x,i=n.y,a=n.z||0,o,c,u,h={};for(u=0;u<3;u++)if(!(e&&u===2&&n.z===void 0))switch(u===0?(o=r,"ew".indexOf(t.axis[u])!==-1?c="x":c="y"):u===1?(o=i,"ns".indexOf(t.axis[u])!==-1?c="y":c="x"):(o=a,c="z"),t.axis[u]){case"e":h[c]=o;break;case"w":h[c]=-o;break;case"n":h[c]=o;break;case"s":h[c]=-o;break;case"u":n[c]!==void 0&&(h.z=o);break;case"d":n[c]!==void 0&&(h.z=-o);break;default:return null}return h}function Aj(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function qB(t){JD(t.x),JD(t.y)}function JD(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function XB(t,e){return(t.datum.datum_type===Zh||t.datum.datum_type===e0||t.datum.datum_type===Bf)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Zh||e.datum.datum_type===e0||e.datum.datum_type===Bf)&&t.datumCode!=="WGS84"}function a1(t,e,n,r){var i;Array.isArray(n)?n=Aj(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var a=n.z!==void 0;if(qB(n),t.datum&&e.datum&&XB(t,e)&&(i=new xo("WGS84"),n=a1(t,i,n,r),t=i),r&&t.axis!=="enu"&&(n=XD(t,!1,n)),t.projName==="longlat")n={x:n.x*yi,y:n.y*yi,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=zB(t.datum,e.datum,n),!!n)return n=n,e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*Dl,y:n.y*Dl,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?XD(e,!0,n):(n&&!a&&delete n.z,n)}var ZD=xo("WGS84");function tC(t,e,n,r){var i,a,o;return Array.isArray(n)?(i=a1(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(a=a1(t,e,n,r),o=Object.keys(n),o.length===2||o.forEach(function(c){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(c==="x"||c==="y"||c==="z")return}else if(c==="x"||c==="y")return;a[c]=n[c]}),a)}function zx(t){return t instanceof xo?t:typeof t=="object"&&"oProj"in t?t.oProj:xo(t)}function JB(t,e,n){var r,i,a=!1,o;return typeof e>"u"?(i=zx(t),r=ZD,a=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,i=zx(t),r=ZD,a=!0),r||(r=zx(t)),i||(i=zx(e)),n?tC(r,i,n):(o={forward:function(c,u){return tC(r,i,c,u)},inverse:function(c,u){return tC(i,r,c,u)}},a&&(o.oProj=i),o)}var eR=6,kj="AJSAJS",Uj="AFAFAF",Tf=65,xl=73,ro=79,Tg=86,Mg=90;const ZB={forward:Bj,inverse:eG,toPoint:Gj};function Bj(t,e){return e=e||5,nG(tG({lat:t[1],lon:t[0]}),e)}function eG(t){var e=qN(Fj(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function Gj(t){var e=qN(Fj(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function sC(t){return t*(Math.PI/180)}function tR(t){return 180*(t/Math.PI)}function tG(t){var e=t.lat,n=t.lon,r=6378137,i=.00669438,a=.9996,o,c,u,h,m,_,p,g=sC(e),C=sC(n),y,S;S=Math.floor((n+180)/6)+1,n===180&&(S=60),e>=56&&e<64&&n>=3&&n<12&&(S=32),e>=72&&e<84&&(n>=0&&n<9?S=31:n>=9&&n<21?S=33:n>=21&&n<33?S=35:n>=33&&n<42&&(S=37)),o=(S-1)*6-180+3,y=sC(o),c=i/(1-i),u=r/Math.sqrt(1-i*Math.sin(g)*Math.sin(g)),h=Math.tan(g)*Math.tan(g),m=c*Math.cos(g)*Math.cos(g),_=Math.cos(g)*(C-y),p=r*((1-i/4-3*i*i/64-5*i*i*i/256)*g-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*g)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*g)-35*i*i*i/3072*Math.sin(6*g));var v=a*u*(_+(1-h+m)*_*_*_/6+(5-18*h+h*h+72*m-58*c)*_*_*_*_*_/120)+5e5,k=a*(p+u*Math.tan(g)*(_*_/2+(5-h+9*m+4*m*m)*_*_*_*_/24+(61-58*h+h*h+600*m-330*c)*_*_*_*_*_*_/720));return e<0&&(k+=1e7),{northing:Math.round(k),easting:Math.round(v),zoneNumber:S,zoneLetter:sG(e)}}function qN(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var a=.9996,o=6378137,c=.00669438,u,h=(1-Math.sqrt(1-c))/(1+Math.sqrt(1-c)),m,_,p,g,C,y,S,v,k,L=n-5e5,M=e;r<"N"&&(M-=1e7),S=(i-1)*6-180+3,u=c/(1-c),y=M/a,v=y/(o*(1-c/4-3*c*c/64-5*c*c*c/256)),k=v+(3*h/2-27*h*h*h/32)*Math.sin(2*v)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*v)+151*h*h*h/96*Math.sin(6*v),m=o/Math.sqrt(1-c*Math.sin(k)*Math.sin(k)),_=Math.tan(k)*Math.tan(k),p=u*Math.cos(k)*Math.cos(k),g=o*(1-c)/Math.pow(1-c*Math.sin(k)*Math.sin(k),1.5),C=L/(m*a);var P=k-m*Math.tan(k)/g*(C*C/2-(5+3*_+10*p-4*p*p-9*u)*C*C*C*C/24+(61+90*_+298*p+45*_*_-252*u-3*p*p)*C*C*C*C*C*C/720);P=tR(P);var F=(C-(1+2*_+p)*C*C*C/6+(5-2*p+28*_-3*p*p+8*u+24*_*_)*C*C*C*C*C/120)/Math.cos(k);F=S+tR(F);var G;if(t.accuracy){var B=qN({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});G={top:B.lat,right:B.lon,bottom:P,left:F}}else G={lat:P,lon:F};return G}function sG(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function nG(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+rG(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function rG(t,e,n){var r=Wj(n),i=Math.floor(t/1e5),a=Math.floor(e/1e5)%20;return iG(i,a,r)}function Wj(t){var e=t%eR;return e===0&&(e=eR),e}function iG(t,e,n){var r=n-1,i=kj.charCodeAt(r),a=Uj.charCodeAt(r),o=i+t-1,c=a+e,u=!1;o>Mg&&(o=o-Mg+Tf-1,u=!0),(o===xl||i<xl&&o>xl||(o>xl||i<xl)&&u)&&o++,(o===ro||i<ro&&o>ro||(o>ro||i<ro)&&u)&&(o++,o===xl&&o++),o>Mg&&(o=o-Mg+Tf-1),c>Tg?(c=c-Tg+Tf-1,u=!0):u=!1,(c===xl||a<xl&&c>xl||(c>xl||a<xl)&&u)&&c++,(c===ro||a<ro&&c>ro||(c>ro||a<ro)&&u)&&(c++,c===xl&&c++),c>Tg&&(c=c-Tg+Tf-1);var h=String.fromCharCode(o)+String.fromCharCode(c);return h}function Fj(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",i,a=0;!/[A-Z]/.test(i=t.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+t;r+=i,a++}var o=parseInt(r,10);if(a===0||a+3>e)throw"MGRSPoint bad conversion from: "+t;var c=t.charAt(a++);if(c<="A"||c==="B"||c==="Y"||c>="Z"||c==="I"||c==="O")throw"MGRSPoint zone letter "+c+" not handled: "+t;n=t.substring(a,a+=2);for(var u=Wj(o),h=aG(n.charAt(0),u),m=lG(n.charAt(1),u);m<oG(c);)m+=2e6;var _=e-a;if(_%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var p=_/2,g=0,C=0,y,S,v,k,L;return p>0&&(y=1e5/Math.pow(10,p),S=t.substring(a,a+p),g=parseFloat(S)*y,v=t.substring(a+p),C=parseFloat(v)*y),k=g+h,L=C+m,{easting:k,northing:L,zoneLetter:c,zoneNumber:o,accuracy:y}}function aG(t,e){for(var n=kj.charCodeAt(e-1),r=1e5,i=!1;n!==t.charCodeAt(0);){if(n++,n===xl&&n++,n===ro&&n++,n>Mg){if(i)throw"Bad character: "+t;n=Tf,i=!0}r+=1e5}return r}function lG(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=Uj.charCodeAt(e-1),r=0,i=!1;n!==t.charCodeAt(0);){if(n++,n===xl&&n++,n===ro&&n++,n>Tg){if(i)throw"Bad character: "+t;n=Tf,i=!0}r+=1e5}return r}function oG(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function fm(t,e,n){if(!(this instanceof fm))return new fm(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}fm.fromMGRS=function(t){return new fm(Gj(t))};fm.prototype.toMGRS=function(t){return Bj([this.x,this.y],t)};var cG=1,dG=.25,sR=.046875,nR=.01953125,rR=.01068115234375,uG=.75,hG=.46875,fG=.013020833333333334,mG=.007120768229166667,gG=.3645833333333333,_G=.005696614583333333,xG=.3076171875;function XN(t){var e=[];e[0]=cG-t*(dG+t*(sR+t*(nR+t*rR))),e[1]=t*(uG-t*(sR+t*(nR+t*rR)));var n=t*t;return e[2]=n*(hG-t*(fG+t*mG)),n*=t,e[3]=n*(gG-t*_G),e[4]=n*t*xG,e}function ym(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var pG=20;function JN(t,e,n){for(var r=1/(1-e),i=t,a=pG;a;--a){var o=Math.sin(i),c=1-e*o*o;if(c=(ym(i,o,Math.cos(i),n)-t)*(c*Math.sqrt(c))*r,i-=c,Math.abs(c)<Ms)return i}return i}function yG(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=XN(this.es),this.ml0=ym(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function bG(t){var e=t.x,n=t.y,r=As(e-this.long0,this.over),i,a,o,c=Math.sin(n),u=Math.cos(n);if(this.es){var m=u*r,_=Math.pow(m,2),p=this.ep2*Math.pow(u,2),g=Math.pow(p,2),C=Math.abs(u)>Ms?Math.tan(n):0,y=Math.pow(C,2),S=Math.pow(y,2);i=1-this.es*Math.pow(c,2),m=m/Math.sqrt(i);var v=ym(n,c,u,this.en);a=this.a*(this.k0*m*(1+_/6*(1-y+p+_/20*(5-18*y+S+14*p-58*y*p+_/42*(61+179*S-S*y-479*y)))))+this.x0,o=this.a*(this.k0*(v-this.ml0+c*r*m/2*(1+_/12*(5-y+9*p+4*g+_/30*(61+S-58*y+270*p-330*y*p+_/56*(1385+543*S-S*y-3111*y))))))+this.y0}else{var h=u*Math.sin(r);if(Math.abs(Math.abs(h)-1)<Ms)return 93;if(a=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=u*Math.cos(r)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>Ms)return 93;o=0}else o=Math.acos(o);n<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return t.x=a,t.y=o,t}function CG(t){var e,n,r,i,a=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,n=JN(e,this.es,this.en),Math.abs(n)<ps){var _=Math.sin(n),p=Math.cos(n),g=Math.abs(p)>Ms?Math.tan(n):0,C=this.ep2*Math.pow(p,2),y=Math.pow(C,2),S=Math.pow(g,2),v=Math.pow(S,2);e=1-this.es*Math.pow(_,2);var k=a*Math.sqrt(e)/this.k0,L=Math.pow(k,2);e=e*g,r=n-e*L/(1-this.es)*.5*(1-L/12*(5+3*S-9*C*S+C-4*y-L/30*(61+90*S-252*C*S+45*v+46*C-L/56*(1385+3633*S+4095*v+1574*v*S)))),i=As(this.long0+k*(1-L/6*(1+2*S+C-L/20*(5+28*S+24*v+8*C*S+6*C-L/42*(61+662*S+1320*v+720*v*S))))/p,this.over)}else r=ps*M_(o),i=0;else{var c=Math.exp(a/this.k0),u=.5*(c-1/c),h=this.lat0+o/this.k0,m=Math.cos(h);e=Math.sqrt((1-Math.pow(m,2))/(1+Math.pow(u,2))),r=Math.asin(e),o<0&&(r=-r),u===0&&m===0?i=0:i=As(Math.atan2(u,m)+this.long0,this.over)}return t.x=i,t.y=r,t}var NG=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Np={init:yG,forward:bG,inverse:CG,names:NG};function Kj(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function vl(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function SG(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function vG(t){var e=Math.abs(t);return e=SG(e*(1+e/(vl(1,e)+1))),t<0?-e:e}function ZN(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,i=t[r],a=0,o;--r>=0;)o=-a+n*i+t[r],a=i,i=o;return e+o*Math.sin(2*e)}function EG(t,e){for(var n=2*Math.cos(e),r=t.length-1,i=t[r],a=0,o;--r>=0;)o=-a+n*i+t[r],a=i,i=o;return Math.sin(e)*o}function DG(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function Qj(t,e,n){for(var r=Math.sin(e),i=Math.cos(e),a=Kj(n),o=DG(n),c=2*i*o,u=-2*r*a,h=t.length-1,m=t[h],_=0,p=0,g=0,C,y;--h>=0;)C=p,y=_,p=m,_=g,m=-C+c*p-u*_+t[h],g=-y+u*p+c*_;return c=r*o,u=i*a,[c*m-u*g,c*g+u*m]}function RG(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Np.init.apply(this),this.forward=Np.forward,this.inverse=Np.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=ZN(this.cbg,this.lat0);this.Zb=-this.Qn*(r+EG(this.gtu,2*r))}function TG(t){var e=As(t.x-this.long0,this.over),n=t.y;n=ZN(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),a=Math.sin(e),o=Math.cos(e);n=Math.atan2(r,o*i),e=Math.atan2(a*i,vl(r,i*o)),e=vG(Math.tan(e));var c=Qj(this.gtu,2*n,2*e);n=n+c[0],e=e+c[1];var u,h;return Math.abs(e)<=2.623395162778?(u=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*n+this.Zb)+this.y0):(u=1/0,h=1/0),t.x=u,t.y=h,t}function MG(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var a=Qj(this.utg,2*n,2*e);n=n+a[0],e=e+a[1],e=Math.atan(Kj(e));var o=Math.sin(n),c=Math.cos(n),u=Math.sin(e),h=Math.cos(e);n=Math.atan2(o*h,vl(u,h*c)),e=Math.atan2(u,h*c),r=As(e+this.long0,this.over),i=ZN(this.cgb,n)}else r=1/0,i=1/0;return t.x=r,t.y=i,t}var IG=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Sp={init:RG,forward:TG,inverse:MG,names:IG};function jG(t,e){if(t===void 0){if(t=Math.floor((As(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var OG="etmerc";function wG(){var t=jG(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*yi,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Sp.init.apply(this),this.forward=Sp.forward,this.inverse=Sp.inverse}var LG=["Universal Transverse Mercator System","utm"];const PG={init:wG,names:LG,dependsOn:OG};function eS(t,e){return Math.pow((1-t)/(1+t),e)}var AG=20;function kG(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+mr)/(Math.pow(Math.tan(.5*this.lat0+mr),this.C)*eS(this.e*t,this.ratexp))}function UG(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+mr),this.C)*eS(this.e*Math.sin(n),this.ratexp))-ps,t.x=this.C*e,t}function BG(t){for(var e=1e-14,n=t.x/this.C,r=t.y,i=Math.pow(Math.tan(.5*r+mr)/this.K,1/this.C),a=AG;a>0&&(r=2*Math.atan(i*eS(this.e*Math.sin(t.y),-.5*this.e))-ps,!(Math.abs(r-t.y)<e));--a)t.y=r;return a?(t.x=n,t.y=r,t):null}const tS={init:kG,forward:UG,inverse:BG};function GG(){tS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function WG(t){var e,n,r,i;return t.x=As(t.x-this.long0,this.over),tS.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function FG(t){var e,n,r,i,a;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,a=vl(t.x,t.y)){var o=2*Math.atan2(a,this.R2);e=Math.sin(o),n=Math.cos(o),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/a),r=Math.atan2(t.x*e,a*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,tS.inverse.apply(this,[t]),t.x=As(t.x+this.long0,this.over),t}var KG=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const QG={init:GG,forward:WG,inverse:FG,names:KG};function sS(t,e,n){return e*=n,Math.tan(.5*(ps+t))*Math.pow((1-e)/(1+e),.5*n)}function YG(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ms&&(this.k0=.5*(1+M_(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Ms&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ms&&Math.abs(Math.cos(this.lat_ts))>Ms&&(this.k0=.5*this.cons*Pc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Jo(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Pc(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(sS(this.lat0,this.sinlat0,this.e))-ps,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function VG(t){var e=t.x,n=t.y,r=Math.sin(n),i=Math.cos(n),a,o,c,u,h,m,_=As(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=Ms&&Math.abs(n+this.lat0)<=Ms?(t.x=NaN,t.y=NaN,t):this.sphere?(a=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(_)),t.x=this.a*a*i*Math.sin(_)+this.x0,t.y=this.a*a*(this.coslat0*r-this.sinlat0*i*Math.cos(_))+this.y0,t):(o=2*Math.atan(sS(n,r,this.e))-ps,u=Math.cos(o),c=Math.sin(o),Math.abs(this.coslat0)<=Ms?(h=Jo(this.e,n*this.con,this.con*r),m=2*this.a*this.k0*h/this.cons,t.x=this.x0+m*Math.sin(e-this.long0),t.y=this.y0-this.con*m*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<Ms?(a=2*this.a*this.k0/(1+u*Math.cos(_)),t.y=a*c):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*c+this.cosX0*u*Math.cos(_))),t.y=a*(this.cosX0*c-this.sinX0*u*Math.cos(_))+this.y0),t.x=a*u*Math.sin(_)+this.x0,t))}function $G(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,a,o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var c=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,n=this.lat0,o<=Ms?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(c)*this.sinlat0+t.y*Math.sin(c)*this.coslat0/o),Math.abs(this.coslat0)<Ms?this.lat0>0?e=As(this.long0+Math.atan2(t.x,-1*t.y),this.over):e=As(this.long0+Math.atan2(t.x,t.y),this.over):e=As(this.long0+Math.atan2(t.x*Math.sin(c),o*this.coslat0*Math.cos(c)-t.y*this.sinlat0*Math.sin(c)),this.over),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=Ms){if(o<=Ms)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=o*this.cons/(2*this.a*this.k0),n=this.con*o_(this.e,r),e=this.con*As(this.con*this.long0+Math.atan2(t.x,-1*t.y),this.over)}else i=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=Ms?a=this.X0:(a=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/o),e=As(this.long0+Math.atan2(t.x*Math.sin(i),o*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)),this.over)),n=-1*o_(this.e,Math.tan(.5*(ps+a)));return t.x=e,t.y=n,t}var zG=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const HG={init:YG,forward:VG,inverse:$G,names:zG,ssfn_:sS};function qG(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,i=1/r,a=2*i-Math.pow(i,2),o=this.e=Math.sqrt(a);this.R=this.k0*n*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var c=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+o*e)/(1-o*e));this.K=c-this.alpha*u+this.alpha*o/2*h}function XG(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),a=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(a))),c=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(a));return t.y=this.R/2*Math.log((1+Math.sin(c))/(1-Math.sin(c)))+this.y0,t.x=this.R*o+this.x0,t}function JG(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),c=this.lambda0+o/this.alpha,u=0,h=a,m=-1e3,_=0;Math.abs(h-m)>1e-7;){if(++_>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),m=h,h=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=c,t.y=h,t}var ZG=["somerc"];const eW={init:qG,forward:XG,inverse:JG,names:ZG};var Cf=1e-7;function tW(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.projName=="object"?Object.keys(t.projName)[0]:t.projName;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1||e.indexOf(Oj(n))!==-1}function sW(){var t,e,n,r,i,a,o,c,u,h,m=0,_,p=0,g=0,C=0,y=0,S=0,v=0;this.no_off=tW(this),this.no_rot="no_rot"in this;var k=!1;"alpha"in this&&(k=!0);var L=!1;if("rectified_grid_angle"in this&&(L=!0),k&&(v=this.alpha),L&&(m=this.rectified_grid_angle),k||L)p=this.longc;else if(g=this.long1,y=this.lat1,C=this.long2,S=this.lat2,Math.abs(y-S)<=Cf||(t=Math.abs(y))<=Cf||Math.abs(t-ps)<=Cf||Math.abs(Math.abs(this.lat0)-ps)<=Cf||Math.abs(Math.abs(S)-ps)<=Cf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>Ms?(c=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*c*c,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Jo(this.e,this.lat0,c),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),k||L?(k?(_=Math.asin(Math.sin(v)/r),L||(m=v)):(_=m,v=Math.asin(r*Math.sin(_))),this.lam0=p-Math.asin(.5*(i-1/i)*Math.tan(_))/this.B):(a=Math.pow(Jo(this.e,y,Math.sin(y)),this.B),o=Math.pow(Jo(this.e,S,Math.sin(S)),this.B),i=this.E/a,u=(o-a)/(o+a),h=this.E*this.E,h=(h-o*a)/(h+o*a),t=g-C,t<-Math.PI?C-=a_:t>Math.PI&&(C+=a_),this.lam0=As(.5*(g+C)-Math.atan(h*Math.tan(.5*this.B*(g-C))/u)/this.B,this.over),_=Math.atan(2*Math.sin(this.B*As(g-this.lam0,this.over))/(i-1/i)),m=v=Math.asin(r*Math.sin(_))),this.singam=Math.sin(_),this.cosgam=Math.cos(_),this.sinrot=Math.sin(m),this.cosrot=Math.cos(m),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*_,this.v_pole_n=this.ArB*Math.log(Math.tan(mr-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(mr+i))}function nW(t){var e={},n,r,i,a,o,c,u,h;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-ps)>Ms){if(o=this.E/Math.pow(Jo(this.e,t.y,Math.sin(t.y)),this.B),c=1/o,n=.5*(o-c),r=.5*(o+c),a=Math.sin(this.B*t.x),i=(n*this.singam-a*this.cosgam)/r,Math.abs(Math.abs(i)-1)<Ms)throw new Error;h=.5*this.ArB*Math.log((1-i)/(1+i)),c=Math.cos(this.B*t.x),Math.abs(c)<Cf?u=this.A*t.x:u=this.ArB*Math.atan2(n*this.cosgam+a*this.singam,c)}else h=t.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*t.y;return this.no_rot?(e.x=u,e.y=h):(u-=this.u_0,e.x=h*this.cosrot+u*this.sinrot,e.y=u*this.cosrot-h*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function rW(t){var e,n,r,i,a,o,c,u={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),a=.5*(r+1/r),o=Math.sin(this.BrA*e),c=(o*this.cosgam+i*this.singam)/a,Math.abs(Math.abs(c)-1)<Ms)u.x=0,u.y=c<0?-ps:ps;else{if(u.y=this.E/Math.sqrt((1+c)/(1-c)),u.y=o_(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw new Error;u.x=-this.rB*Math.atan2(i*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return u.x+=this.lam0,u}var iW=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const aW={init:sW,forward:nW,inverse:rW,names:iW};function lW(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Ms)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Pc(this.e,e,n),i=Jo(this.e,this.lat1,e),a=Math.sin(this.lat2),o=Math.cos(this.lat2),c=Pc(this.e,a,o),u=Jo(this.e,this.lat2,a),h=Math.abs(Math.abs(this.lat0)-ps)<Ms?0:Jo(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Ms?this.ns=Math.log(r/c)/Math.log(i/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function oW(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=Ms&&(n=M_(n)*(ps-2*Ms));var r=Math.abs(Math.abs(n)-ps),i,a;if(r>Ms)i=Jo(this.e,n,Math.sin(n)),a=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;a=0}var o=this.ns*As(e-this.long0,this.over);return t.x=this.k0*(a*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-a*Math.cos(o))+this.y0,t}function cW(t){var e,n,r,i,a,o=(t.x-this.x0)/this.k0,c=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+c*c),n=1):(e=-Math.sqrt(o*o+c*c),n=-1);var u=0;if(e!==0&&(u=Math.atan2(n*o,n*c)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),i=o_(this.e,r),i===-9999)return null}else i=-ps;return a=As(u/this.ns+this.long0,this.over),t.x=a,t.y=i,t}var dW=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const uW={init:lW,forward:oW,inverse:cW,names:dW};function hW(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function fW(t){var e,n,r,i,a,o,c,u=t.x,h=t.y,m=As(u-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),r=-m*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),a=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),o=this.n*a,c=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=c*Math.cos(o)/1,t.x=c*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t}function mW(t){var e,n,r,i,a,o,c,u,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),a=Math.atan2(t.y,t.x),i=a/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,c=e,u=0;var m=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.e/2))-this.s45),Math.abs(c-t.y)<1e-10&&(u=1),c=t.y,m+=1;while(u===0&&m<15);return m>=15?null:t}var gW=["Krovak","krovak"];const _W={init:hW,forward:fW,inverse:mW,names:gW};function Ja(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function I_(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function j_(t){return .375*t*(1+.25*t*(1+.46875*t))}function O_(t){return .05859375*t*t*(1+.75*t)}function w_(t){return t*t*t*(35/3072)}function nS(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function Zu(t){return Math.abs(t)<ps?t:t-M_(t)*Math.PI}function l1(t,e,n,r,i){var a,o;a=t/e;for(var c=0;c<15;c++)if(o=(t-(e*a-n*Math.sin(2*a)+r*Math.sin(4*a)-i*Math.sin(6*a)))/(e-2*n*Math.cos(2*a)+4*r*Math.cos(4*a)-6*i*Math.cos(6*a)),a+=o,Math.abs(o)<=1e-10)return a;return NaN}function xW(){this.sphere||(this.e0=I_(this.es),this.e1=j_(this.es),this.e2=O_(this.es),this.e3=w_(this.es),this.ml0=this.a*Ja(this.e0,this.e1,this.e2,this.e3,this.lat0))}function pW(t){var e,n,r=t.x,i=t.y;if(r=As(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var a=Math.sin(i),o=Math.cos(i),c=nS(this.a,this.e,a),u=Math.tan(i)*Math.tan(i),h=r*Math.cos(i),m=h*h,_=this.es*o*o/(1-this.es),p=this.a*Ja(this.e0,this.e1,this.e2,this.e3,i);e=c*h*(1-m*u*(1/6-(8-u+8*_)*m/120)),n=p-this.ml0+c*a/o*m*(.5+(5-u+6*_)*m/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function yW(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i;if(this.sphere){var a=n+this.lat0;r=Math.asin(Math.sin(a)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(a))}else{var o=this.ml0/this.a+n,c=l1(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(c)-ps)<=Ms)return t.x=this.long0,t.y=ps,n<0&&(t.y*=-1),t;var u=nS(this.a,this.e,Math.sin(c)),h=u*u*u/this.a/this.a*(1-this.es),m=Math.pow(Math.tan(c),2),_=e*this.a/u,p=_*_;r=c-u*Math.tan(c)/h*_*_*(.5-(1+3*m)*_*_/24),i=_*(1-p*(m/3+(1+3*m)*m*p/15))/Math.cos(c)}return t.x=As(i+this.long0,this.over),t.y=Zu(r),t}var bW=["Cassini","Cassini_Soldner","cass"];const CW={init:xW,forward:pW,inverse:yW,names:bW};function Ku(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var C2=1,N2=2,S2=3,vp=4;function NW(){var t=Math.abs(this.lat0);if(Math.abs(t-ps)<Ms?this.mode=this.lat0<0?C2:N2:Math.abs(t)<Ms?this.mode=S2:this.mode=vp,this.es>0){var e;switch(this.qp=Ku(this.e,1),this.mmf=.5/(1-this.es),this.apa=jW(this.es),this.mode){case N2:this.dd=1;break;case C2:this.dd=1;break;case S2:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case vp:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Ku(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===vp&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function SW(t){var e,n,r,i,a,o,c,u,h,m,_=t.x,p=t.y;if(_=As(_-this.long0,this.over),this.sphere){if(a=Math.sin(p),m=Math.cos(p),r=Math.cos(_),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+m*r:1+this.sinph0*a+this.cosph0*m*r,n<=Ms)return null;n=Math.sqrt(2/n),e=n*m*Math.sin(_),n*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*m*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(p+this.lat0)<Ms)return null;n=mr-p*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(_),n*=r}}else{switch(c=0,u=0,h=0,r=Math.cos(_),i=Math.sin(_),a=Math.sin(p),o=Ku(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=o/this.qp,u=Math.sqrt(1-c*c)),this.mode){case this.OBLIQ:h=1+this.sinb1*c+this.cosb1*u*r;break;case this.EQUIT:h=1+u*r;break;case this.N_POLE:h=ps+p,o=this.qp-o;break;case this.S_POLE:h=p-ps,o=this.qp+o;break}if(Math.abs(h)<Ms)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?n=this.ymf*h*(this.cosb1*c-this.sinb1*u*r):n=(h=Math.sqrt(2/(1+u*r)))*c*this.ymf,e=this.xmf*h*u*i;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*i,n=r*(this.mode===this.S_POLE?h:-h)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function vW(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i,a,o,c,u,h;if(this.sphere){var m=0,_,p=0;if(_=Math.sqrt(e*e+n*n),i=_*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(i),m=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(_)<=Ms?0:Math.asin(n*p/_),e*=p,n=m*_;break;case this.OBLIQ:i=Math.abs(_)<=Ms?this.lat0:Math.asin(m*this.sinph0+n*p*this.cosph0/_),e*=p*this.cosph0,n=(m-Math.sin(i)*this.sinph0)*_;break;case this.N_POLE:n=-n,i=ps-i;break;case this.S_POLE:i-=ps;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,u=Math.sqrt(e*e+n*n),u<Ms)return t.x=this.long0,t.y=this.lat0,t;o=2*Math.asin(.5*u/this.rq),a=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(h=a*this.sinb1+n*o*this.cosb1/u,c=this.qp*h,n=u*this.cosb1*a-n*this.sinb1*o):(h=n*o/u,c=this.qp*h,n=u*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),c=e*e+n*n,!c)return t.x=this.long0,t.y=this.lat0,t;h=1-c/this.qp,this.mode===this.S_POLE&&(h=-h)}r=Math.atan2(e,n),i=OW(Math.asin(h),this.apa)}return t.x=As(this.long0+r,this.over),t.y=i,t}var EW=.3333333333333333,DW=.17222222222222222,RW=.10257936507936508,TW=.06388888888888888,MW=.0664021164021164,IW=.016415012942191543;function jW(t){var e,n=[];return n[0]=t*EW,e=t*t,n[0]+=e*DW,n[1]=e*TW,e*=t,n[0]+=e*RW,n[1]+=e*MW,n[2]=e*IW,n}function OW(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var wW=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const LW={init:NW,forward:SW,inverse:vW,names:wW,S_POLE:C2,N_POLE:N2,EQUIT:S2,OBLIQ:vp};function zu(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function PW(){Math.abs(this.lat1+this.lat2)<Ms||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Pc(this.e3,this.sin_po,this.cos_po),this.qs1=Ku(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Pc(this.e3,this.sin_po,this.cos_po),this.qs2=Ku(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ku(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Ms?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function AW(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Ku(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,a=this.ns0*As(e-this.long0,this.over),o=i*Math.sin(a)+this.x0,c=this.rh-i*Math.cos(a)+this.y0;return t.x=o,t.y=c,t}function kW(t){var e,n,r,i,a,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,o=this.phi1z(this.e3,n)),a=As(i/this.ns0+this.long0,this.over),t.x=a,t.y=o,t}function UW(t,e){var n,r,i,a,o,c=zu(.5*e);if(t<Ms)return c;for(var u=t*t,h=1;h<=25;h++)if(n=Math.sin(c),r=Math.cos(c),i=t*n,a=1-i*i,o=.5*a*a/r*(e/(1-u)-n/a+.5/t*Math.log((1-i)/(1+i))),c=c+o,Math.abs(o)<=1e-7)return c;return null}var BW=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const GW={init:PW,forward:AW,inverse:kW,names:BW,phi1z:UW};function WW(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function FW(t){var e,n,r,i,a,o,c,u,h=t.x,m=t.y;return r=As(h-this.long0,this.over),e=Math.sin(m),n=Math.cos(m),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,a=1,o>0||Math.abs(o)<=Ms?(c=this.x0+this.a*a*n*Math.sin(r)/o,u=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*n*i)/o):(c=this.x0+this.infinity_dist*n*Math.sin(r),u=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=c,t.y=u,t}function KW(t){var e,n,r,i,a,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),o=zu(r*this.sin_p14+t.y*n*this.cos_p14/e),a=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),a=As(this.long0+a,this.over)):(o=this.phic0,a=0),t.x=a,t.y=o,t}var QW=["gnom"];const YW={init:WW,forward:FW,inverse:KW,names:QW};function VW(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*ps:ps;for(var r=Math.asin(.5*e),i,a,o,c,u=0;u<30;u++)if(a=Math.sin(r),o=Math.cos(r),c=t*a,i=Math.pow(1-c*c,2)/(2*o)*(e/(1-t*t)-a/(1-c*c)+.5/t*Math.log((1-c)/(1+c))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function $W(){this.sphere||(this.k0=Pc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function zW(t){var e=t.x,n=t.y,r,i,a=As(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*a*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var o=Ku(this.e,Math.sin(n));r=this.x0+this.a*this.k0*a,i=this.y0+this.a*o*.5/this.k0}return t.x=r,t.y=i,t}function HW(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=As(this.long0+t.x/this.a/Math.cos(this.lat_ts),this.over),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=VW(this.e,2*t.y*this.k0/this.a),e=As(this.long0+t.x/(this.a*this.k0),this.over)),t.x=e,t.y=n,t}var qW=["cea"];const XW={init:$W,forward:zW,inverse:HW,names:qW};function JW(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function ZW(t){var e=t.x,n=t.y,r=As(e-this.long0,this.over),i=Zu(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t}function eF(t){var e=t.x,n=t.y;return t.x=As(this.long0+(e-this.x0)/(this.a*this.rc),this.over),t.y=Zu(this.lat0+(n-this.y0)/this.a),t}var tF=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const sF={init:JW,forward:ZW,inverse:eF,names:tF};var iR=20;function nF(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=I_(this.es),this.e1=j_(this.es),this.e2=O_(this.es),this.e3=w_(this.es),this.ml0=this.a*Ja(this.e0,this.e1,this.e2,this.e3,this.lat0)}function rF(t){var e=t.x,n=t.y,r,i,a,o=As(e-this.long0,this.over);if(a=o*Math.sin(n),this.sphere)Math.abs(n)<=Ms?(r=this.a*o,i=-1*this.a*this.lat0):(r=this.a*Math.sin(a)/Math.tan(n),i=this.a*(Zu(n-this.lat0)+(1-Math.cos(a))/Math.tan(n)));else if(Math.abs(n)<=Ms)r=this.a*o,i=-1*this.ml0;else{var c=nS(this.a,this.e,Math.sin(n))/Math.tan(n);r=c*Math.sin(a),i=this.a*Ja(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+c*(1-Math.cos(a))}return t.x=r+this.x0,t.y=i+this.y0,t}function iF(t){var e,n,r,i,a,o,c,u,h;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=Ms)e=As(r/this.a+this.long0,this.over),n=0;else{o=this.lat0+i/this.a,c=r*r/this.a/this.a+o*o,u=o;var m;for(a=iR;a;--a)if(m=Math.tan(u),h=-1*(o*(u*m+1)-u-.5*(u*u+c)*m)/((u-o)/m-1),u+=h,Math.abs(h)<=Ms){n=u;break}e=As(this.long0+Math.asin(r*Math.tan(u)/this.a)/Math.sin(n),this.over)}else if(Math.abs(i+this.ml0)<=Ms)n=0,e=As(this.long0+r/this.a,this.over);else{o=(this.ml0+i)/this.a,c=r*r/this.a/this.a+o*o,u=o;var _,p,g,C,y;for(a=iR;a;--a)if(y=this.e*Math.sin(u),_=Math.sqrt(1-y*y)*Math.tan(u),p=this.a*Ja(this.e0,this.e1,this.e2,this.e3,u),g=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),C=p/this.a,h=(o*(_*C+1)-C-.5*_*(C*C+c))/(this.es*Math.sin(2*u)*(C*C+c-2*o*C)/(4*_)+(o-C)*(_*g-2/Math.sin(2*u))-g),u-=h,Math.abs(h)<=Ms){n=u;break}_=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=As(this.long0+Math.asin(r*_/this.a)/Math.sin(n),this.over)}return t.x=e,t.y=n,t}var aF=["Polyconic","American_Polyconic","poly"];const lF={init:nF,forward:rF,inverse:iF,names:aF};function oF(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function cF(t){var e,n=t.x,r=t.y,i=r-this.lat0,a=n-this.long0,o=i/Bg*1e-5,c=a,u=1,h=0;for(e=1;e<=10;e++)u=u*o,h=h+this.A[e]*u;var m=h,_=c,p=1,g=0,C,y,S=0,v=0;for(e=1;e<=6;e++)C=p*m-g*_,y=g*m+p*_,p=C,g=y,S=S+this.B_re[e]*p-this.B_im[e]*g,v=v+this.B_im[e]*p+this.B_re[e]*g;return t.x=v*this.a+this.x0,t.y=S*this.a+this.y0,t}function dF(t){var e,n=t.x,r=t.y,i=n-this.x0,a=r-this.y0,o=a/this.a,c=i/this.a,u=1,h=0,m,_,p=0,g=0;for(e=1;e<=6;e++)m=u*o-h*c,_=h*o+u*c,u=m,h=_,p=p+this.C_re[e]*u-this.C_im[e]*h,g=g+this.C_im[e]*u+this.C_re[e]*h;for(var C=0;C<this.iterations;C++){var y=p,S=g,v,k,L=o,M=c;for(e=2;e<=6;e++)v=y*p-S*g,k=S*p+y*g,y=v,S=k,L=L+(e-1)*(this.B_re[e]*y-this.B_im[e]*S),M=M+(e-1)*(this.B_im[e]*y+this.B_re[e]*S);y=1,S=0;var P=this.B_re[1],F=this.B_im[1];for(e=2;e<=6;e++)v=y*p-S*g,k=S*p+y*g,y=v,S=k,P=P+e*(this.B_re[e]*y-this.B_im[e]*S),F=F+e*(this.B_im[e]*y+this.B_re[e]*S);var G=P*P+F*F;p=(L*P+M*F)/G,g=(M*P-L*F)/G}var B=p,I=g,E=1,A=0;for(e=1;e<=9;e++)E=E*B,A=A+this.D[e]*E;var Y=this.lat0+A*Bg*1e5,ee=this.long0+I;return t.x=ee,t.y=Y,t}var uF=["New_Zealand_Map_Grid","nzmg"];const hF={init:oF,forward:cF,inverse:dF,names:uF};function fF(){}function mF(t){var e=t.x,n=t.y,r=As(e-this.long0,this.over),i=this.x0+this.a*r,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=a,t}function gF(t){t.x-=this.x0,t.y-=this.y0;var e=As(this.long0+t.x/this.a,this.over),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var _F=["Miller_Cylindrical","mill"];const xF={init:fF,forward:mF,inverse:gF,names:_F};var pF=20;function yF(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=XN(this.es)}function bF(t){var e,n,r=t.x,i=t.y;if(r=As(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var a=this.n*Math.sin(i),o=pF;o;--o){var c=(this.m*i+Math.sin(i)-a)/(this.m+Math.cos(i));if(i-=c,Math.abs(c)<Ms)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var u=Math.sin(i),h=Math.cos(i);n=this.a*ym(i,u,h,this.en),e=this.a*r*h/Math.sqrt(1-this.es*u*u)}return t.x=e,t.y=n,t}function CF(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=zu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=zu(Math.sin(e)/this.n)),r=As(r+this.long0,this.over),e=Zu(e)):(e=JN(t.y/this.a,this.es,this.en),i=Math.abs(e),i<ps?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=As(n,this.over)):i-Ms<ps&&(r=this.long0)),t.x=r,t.y=e,t}var NF=["Sinusoidal","sinu"];const SF={init:yF,forward:bF,inverse:CF,names:NF};function vF(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function EF(t){for(var e=t.x,n=t.y,r=As(e-this.long0,this.over),i=n,a=Math.PI*Math.sin(n);;){var o=-(i+Math.sin(i)-a)/(1+Math.cos(i));if(i+=o,Math.abs(o)<Ms)break}i/=2,Math.PI/2-Math.abs(n)<Ms&&(r=0);var c=.900316316158*this.a*r*Math.cos(i)+this.x0,u=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=c,t.y=u,t}function DF(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=As(this.long0+t.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t}var RF=["Mollweide","moll"];const TF={init:vF,forward:EF,inverse:DF,names:RF};function MF(){Math.abs(this.lat1+this.lat2)<Ms||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=I_(this.es),this.e1=j_(this.es),this.e2=O_(this.es),this.e3=w_(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Pc(this.e,this.sin_phi,this.cos_phi),this.ml1=Ja(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Ms?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Pc(this.e,this.sin_phi,this.cos_phi),this.ml2=Ja(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ja(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function IF(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=Ja(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var a=this.ns*As(e-this.long0,this.over),o=this.x0+r*Math.sin(a),c=this.y0+this.rh-r*Math.cos(a);return t.x=o,t.y=c,t}function jF(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,i;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var a=0;if(n!==0&&(a=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=As(this.long0+a/this.ns,this.over),r=Zu(this.g-n/this.a),t.x=i,t.y=r,t;var o=this.g-n/this.a;return r=l1(o,this.e0,this.e1,this.e2,this.e3),i=As(this.long0+a/this.ns,this.over),t.x=i,t.y=r,t}var OF=["Equidistant_Conic","eqdc"];const wF={init:MF,forward:IF,inverse:jF,names:OF};function LF(){this.R=this.a}function PF(t){var e=t.x,n=t.y,r=As(e-this.long0,this.over),i,a;Math.abs(n)<=Ms&&(i=this.x0+this.R*r,a=this.y0);var o=zu(2*Math.abs(n/Math.PI));(Math.abs(r)<=Ms||Math.abs(Math.abs(n)-ps)<=Ms)&&(i=this.x0,n>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*o):a=this.y0+Math.PI*this.R*-Math.tan(.5*o));var c=.5*Math.abs(Math.PI/r-r/Math.PI),u=c*c,h=Math.sin(o),m=Math.cos(o),_=m/(h+m-1),p=_*_,g=_*(2/h-1),C=g*g,y=Math.PI*this.R*(c*(_-C)+Math.sqrt(u*(_-C)*(_-C)-(C+u)*(p-C)))/(C+u);r<0&&(y=-y),i=this.x0+y;var S=u+_;return y=Math.PI*this.R*(g*S-c*Math.sqrt((C+u)*(u+1)-S*S))/(C+u),n>=0?a=this.y0+y:a=this.y0-y,t.x=i,t.y=a,t}function AF(t){var e,n,r,i,a,o,c,u,h,m,_,p,g;return t.x-=this.x0,t.y-=this.y0,_=Math.PI*this.R,r=t.x/_,i=t.y/_,a=r*r+i*i,o=-Math.abs(i)*(1+a),c=o-2*i*i+r*r,u=-2*o+1+2*i*i+a*a,g=i*i/u+(2*c*c*c/u/u/u-9*o*c/u/u)/27,h=(o-c*c/3/u)/u,m=2*Math.sqrt(-h/3),_=3*g/h/m,Math.abs(_)>1&&(_>=0?_=1:_=-1),p=Math.acos(_)/3,t.y>=0?n=(-m*Math.cos(p+Math.PI/3)-c/3/u)*Math.PI:n=-(-m*Math.cos(p+Math.PI/3)-c/3/u)*Math.PI,Math.abs(r)<Ms?e=this.long0:e=As(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(r*r-i*i)+a*a))/2/r,this.over),t.x=e,t.y=n,t}var kF=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const UF={init:LF,forward:PF,inverse:AF,names:kF};function BF(t,e,n,r,i,a){const o=r-e,c=Math.atan((1-a)*Math.tan(t)),u=Math.atan((1-a)*Math.tan(n)),h=Math.sin(c),m=Math.cos(c),_=Math.sin(u),p=Math.cos(u);let g=o,C,y=100,S,v,k,L,M,P,F,G,B,I,E,A,Y,ee;do{if(S=Math.sin(g),v=Math.cos(g),k=Math.sqrt(p*S*(p*S)+(m*_-h*p*v)*(m*_-h*p*v)),k===0)return{azi1:0,s12:0};L=h*_+m*p*v,M=Math.atan2(k,L),P=m*p*S/k,F=1-P*P,G=F!==0?L-2*h*_/F:0,B=a/16*F*(4+a*(4-3*F)),C=g,g=o+(1-B)*a*P*(M+B*k*(G+B*L*(-1+2*G*G)))}while(Math.abs(g-C)>1e-12&&--y>0);return y===0?{azi1:NaN,s12:NaN}:(I=F*(i*i-i*(1-a)*(i*(1-a)))/(i*(1-a)*(i*(1-a))),E=1+I/16384*(4096+I*(-768+I*(320-175*I))),A=I/1024*(256+I*(-128+I*(74-47*I))),Y=A*k*(G+A/4*(L*(-1+2*G*G)-A/6*G*(-3+4*k*k)*(-3+4*G*G))),ee=i*(1-a)*E*(M-Y),{azi1:Math.atan2(p*S,m*_-h*p*v),s12:ee})}function GF(t,e,n,r,i,a){const o=Math.atan((1-a)*Math.tan(t)),c=Math.sin(o),u=Math.cos(o),h=Math.sin(n),m=Math.cos(n),_=Math.atan2(c,u*m),p=u*h,g=1-p*p,C=g*(i*i-i*(1-a)*(i*(1-a)))/(i*(1-a)*(i*(1-a))),y=1+C/16384*(4096+C*(-768+C*(320-175*C))),S=C/1024*(256+C*(-128+C*(74-47*C)));let v=r/(i*(1-a)*y),k,L=100,M,P,F,G;do M=Math.cos(2*_+v),P=Math.sin(v),F=Math.cos(v),G=S*P*(M+S/4*(F*(-1+2*M*M)-S/6*M*(-3+4*P*P)*(-3+4*M*M))),k=v,v=r/(i*(1-a)*y)+G;while(Math.abs(v-k)>1e-12&&--L>0);if(L===0)return{lat2:NaN,lon2:NaN};const B=c*P-u*F*m,I=Math.atan2(c*F+u*P*m,(1-a)*Math.sqrt(p*p+B*B)),E=Math.atan2(P*h,u*F-c*P*m),A=a/16*g*(4+a*(4-3*g)),Y=E-(1-A)*a*p*(v+A*P*(M+A*F*(-1+2*M*M))),ee=e+Y;return{lat2:I,lon2:ee}}function WF(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function FF(t){var e=t.x,n=t.y,r=Math.sin(t.y),i=Math.cos(t.y),a=As(e-this.long0,this.over),o,c,u,h,m,_,p,g,C,y,S;return this.sphere?Math.abs(this.sin_p12-1)<=Ms?(t.x=this.x0+this.a*(ps-n)*Math.sin(a),t.y=this.y0-this.a*(ps-n)*Math.cos(a),t):Math.abs(this.sin_p12+1)<=Ms?(t.x=this.x0+this.a*(ps+n)*Math.sin(a),t.y=this.y0+this.a*(ps+n)*Math.cos(a),t):(C=this.sin_p12*r+this.cos_p12*i*Math.cos(a),p=Math.acos(C),g=p?p/Math.sin(p):1,t.x=this.x0+this.a*g*i*Math.sin(a),t.y=this.y0+this.a*g*(this.cos_p12*r-this.sin_p12*i*Math.cos(a)),t):(o=I_(this.es),c=j_(this.es),u=O_(this.es),h=w_(this.es),Math.abs(this.sin_p12-1)<=Ms?(m=this.a*Ja(o,c,u,h,ps),_=this.a*Ja(o,c,u,h,n),t.x=this.x0+(m-_)*Math.sin(a),t.y=this.y0-(m-_)*Math.cos(a),t):Math.abs(this.sin_p12+1)<=Ms?(m=this.a*Ja(o,c,u,h,ps),_=this.a*Ja(o,c,u,h,n),t.x=this.x0+(m+_)*Math.sin(a),t.y=this.y0+(m+_)*Math.cos(a),t):Math.abs(e)<Ms&&Math.abs(n-this.lat0)<Ms?(t.x=t.y=0,t):(y=BF(this.lat0,this.long0,n,e,this.a,this.f),S=y.azi1,t.x=y.s12*Math.sin(S),t.y=y.s12*Math.cos(S),t))}function KF(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,a,o,c,u,h,m,_,p,g,C,y,S;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*ps*this.a?void 0:(n=e/this.a,r=Math.sin(n),i=Math.cos(n),a=this.long0,Math.abs(e)<=Ms?o=this.lat0:(o=zu(i*this.sin_p12+t.y*r*this.cos_p12/e),c=Math.abs(this.lat0)-ps,Math.abs(c)<=Ms?this.lat0>=0?a=As(this.long0+Math.atan2(t.x,-t.y),this.over):a=As(this.long0-Math.atan2(-t.x,t.y),this.over):a=As(this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r),this.over)),t.x=a,t.y=o,t)):(u=I_(this.es),h=j_(this.es),m=O_(this.es),_=w_(this.es),Math.abs(this.sin_p12-1)<=Ms?(p=this.a*Ja(u,h,m,_,ps),e=Math.sqrt(t.x*t.x+t.y*t.y),g=p-e,o=l1(g/this.a,u,h,m,_),a=As(this.long0+Math.atan2(t.x,-1*t.y),this.over),t.x=a,t.y=o,t):Math.abs(this.sin_p12+1)<=Ms?(p=this.a*Ja(u,h,m,_,ps),e=Math.sqrt(t.x*t.x+t.y*t.y),g=e-p,o=l1(g/this.a,u,h,m,_),a=As(this.long0+Math.atan2(t.x,t.y),this.over),t.x=a,t.y=o,t):(C=Math.atan2(t.x,t.y),y=Math.sqrt(t.x*t.x+t.y*t.y),S=GF(this.lat0,this.long0,C,y,this.a,this.f),t.x=S.lon2,t.y=S.lat2,t))}var QF=["Azimuthal_Equidistant","aeqd"];const YF={init:WF,forward:FF,inverse:KF,names:QF};function VF(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function $F(t){var e,n,r,i,a,o,c,u,h=t.x,m=t.y;return r=As(h-this.long0,this.over),e=Math.sin(m),n=Math.cos(m),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,a=1,(o>0||Math.abs(o)<=Ms)&&(c=this.a*a*n*Math.sin(r),u=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*n*i)),t.x=c,t.y=u,t}function zF(t){var e,n,r,i,a,o,c;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=zu(e/this.a),r=Math.sin(n),i=Math.cos(n),o=this.long0,Math.abs(e)<=Ms?(c=this.lat0,t.x=o,t.y=c,t):(c=zu(i*this.sin_p14+t.y*r*this.cos_p14/e),a=Math.abs(this.lat0)-ps,Math.abs(a)<=Ms?(this.lat0>=0?o=As(this.long0+Math.atan2(t.x,-t.y),this.over):o=As(this.long0-Math.atan2(-t.x,t.y),this.over),t.x=o,t.y=c,t):(o=As(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r),this.over),t.x=o,t.y=c,t))}var HF=["ortho"];const qF={init:VF,forward:$F,inverse:zF,names:HF};var oi={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},gr={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function XF(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=ps-mr/2?this.face=oi.TOP:this.lat0<=-(ps-mr/2)?this.face=oi.BOTTOM:Math.abs(this.long0)<=mr?this.face=oi.FRONT:Math.abs(this.long0)<=ps+mr?this.face=this.long0>0?oi.RIGHT:oi.LEFT:this.face=oi.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function JF(t){var e={x:0,y:0},n,r,i,a,o,c,u={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===oi.TOP)a=ps-n,r>=mr&&r<=ps+mr?(u.value=gr.AREA_0,i=r-ps):r>ps+mr||r<=-(ps+mr)?(u.value=gr.AREA_1,i=r>0?r-vi:r+vi):r>-(ps+mr)&&r<=-mr?(u.value=gr.AREA_2,i=r+ps):(u.value=gr.AREA_3,i=r);else if(this.face===oi.BOTTOM)a=ps+n,r>=mr&&r<=ps+mr?(u.value=gr.AREA_0,i=-r+ps):r<mr&&r>=-mr?(u.value=gr.AREA_1,i=-r):r<-mr&&r>=-(ps+mr)?(u.value=gr.AREA_2,i=-r-ps):(u.value=gr.AREA_3,i=r>0?-r+vi:-r-vi);else{var h,m,_,p,g,C,y;this.face===oi.RIGHT?r=Gf(r,+ps):this.face===oi.BACK?r=Gf(r,+vi):this.face===oi.LEFT&&(r=Gf(r,-ps)),p=Math.sin(n),g=Math.cos(n),C=Math.sin(r),y=Math.cos(r),h=g*y,m=g*C,_=p,this.face===oi.FRONT?(a=Math.acos(h),i=Hx(a,_,m,u)):this.face===oi.RIGHT?(a=Math.acos(m),i=Hx(a,_,-h,u)):this.face===oi.BACK?(a=Math.acos(-h),i=Hx(a,_,-m,u)):this.face===oi.LEFT?(a=Math.acos(-m),i=Hx(a,_,h,u)):(a=i=0,u.value=gr.AREA_0)}return c=Math.atan(12/vi*(i+Math.acos(Math.sin(i)*Math.cos(mr))-ps)),o=Math.sqrt((1-Math.cos(a))/(Math.cos(c)*Math.cos(c))/(1-Math.cos(Math.atan(1/Math.cos(i))))),u.value===gr.AREA_1?c+=ps:u.value===gr.AREA_2?c+=vi:u.value===gr.AREA_3&&(c+=1.5*vi),e.x=o*Math.cos(c),e.y=o*Math.sin(c),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function ZF(t){var e={lam:0,phi:0},n,r,i,a,o,c,u,h,m,_={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?_.value=gr.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(_.value=gr.AREA_1,n-=ps):t.x<0&&-t.x>=Math.abs(t.y)?(_.value=gr.AREA_2,n=n<0?n+vi:n-vi):(_.value=gr.AREA_3,n+=ps),m=vi/12*Math.tan(n),o=Math.sin(m)/(Math.cos(m)-1/Math.sqrt(2)),c=Math.atan(o),i=Math.cos(n),a=Math.tan(r),u=1-i*i*a*a*(1-Math.cos(Math.atan(1/Math.cos(c)))),u<-1?u=-1:u>1&&(u=1),this.face===oi.TOP)h=Math.acos(u),e.phi=ps-h,_.value===gr.AREA_0?e.lam=c+ps:_.value===gr.AREA_1?e.lam=c<0?c+vi:c-vi:_.value===gr.AREA_2?e.lam=c-ps:e.lam=c;else if(this.face===oi.BOTTOM)h=Math.acos(u),e.phi=h-ps,_.value===gr.AREA_0?e.lam=-c+ps:_.value===gr.AREA_1?e.lam=-c:_.value===gr.AREA_2?e.lam=-c-ps:e.lam=c<0?-c-vi:-c+vi;else{var p,g,C;p=u,m=p*p,m>=1?C=0:C=Math.sqrt(1-m)*Math.sin(c),m+=C*C,m>=1?g=0:g=Math.sqrt(1-m),_.value===gr.AREA_1?(m=g,g=-C,C=m):_.value===gr.AREA_2?(g=-g,C=-C):_.value===gr.AREA_3&&(m=g,g=C,C=-m),this.face===oi.RIGHT?(m=p,p=-g,g=m):this.face===oi.BACK?(p=-p,g=-g):this.face===oi.LEFT&&(m=p,p=g,g=-m),e.phi=Math.acos(-C)-ps,e.lam=Math.atan2(g,p),this.face===oi.RIGHT?e.lam=Gf(e.lam,-ps):this.face===oi.BACK?e.lam=Gf(e.lam,-vi):this.face===oi.LEFT&&(e.lam=Gf(e.lam,+ps))}if(this.es!==0){var y,S,v;y=e.phi<0?1:0,S=Math.tan(e.phi),v=this.b/Math.sqrt(S*S+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-v*v)/(this.one_minus_f*v)),y&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function Hx(t,e,n,r){var i;return t<Ms?(r.value=gr.AREA_0,i=0):(i=Math.atan2(e,n),Math.abs(i)<=mr?r.value=gr.AREA_0:i>mr&&i<=ps+mr?(r.value=gr.AREA_1,i-=ps):i>ps+mr||i<=-(ps+mr)?(r.value=gr.AREA_2,i=i>=0?i-vi:i+vi):(r.value=gr.AREA_3,i+=ps)),i}function Gf(t,e){var n=t+e;return n<-vi?n+=a_:n>+vi&&(n-=a_),n}var eK=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const tK={init:XF,forward:JF,inverse:ZF,names:eK};var v2=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Ig=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Yj=.8487,Vj=1.3523,$j=Dl/5,sK=1/$j,Mf=18,o1=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},nK=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function rK(t,e,n,r){for(var i=e;r;--r){var a=t(i);if(i-=a,Math.abs(a)<n)break}return i}function iK(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function aK(t){var e=As(t.x-this.long0,this.over),n=Math.abs(t.y),r=Math.floor(n*$j);r<0?r=0:r>=Mf&&(r=Mf-1),n=Dl*(n-sK*r);var i={x:o1(v2[r],n)*e,y:o1(Ig[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*Yj+this.x0,i.y=i.y*this.a*Vj+this.y0,i}function lK(t){var e={x:(t.x-this.x0)/(this.a*Yj),y:Math.abs(t.y-this.y0)/(this.a*Vj)};if(e.y>=1)e.x/=v2[Mf][0],e.y=t.y<0?-ps:ps;else{var n=Math.floor(e.y*Mf);for(n<0?n=0:n>=Mf&&(n=Mf-1);;)if(Ig[n][0]>e.y)--n;else if(Ig[n+1][0]<=e.y)++n;else break;var r=Ig[n],i=5*(e.y-r[0])/(Ig[n+1][0]-r[0]);i=rK(function(a){return(o1(r,a)-e.y)/nK(r,a)},i,Ms,100),e.x/=o1(v2[n],i),e.y=(5*n+i)*yi,t.y<0&&(e.y=-e.y)}return e.x=As(e.x+this.long0,this.over),e}var oK=["Robinson","robin"];const cK={init:iK,forward:aK,inverse:lK,names:oK};function dK(){this.name="geocent"}function uK(t){var e=Lj(t,this.es,this.a);return e}function hK(t){var e=Pj(t,this.es,this.a,this.b);return e}var fK=["Geocentric","geocentric","geocent","Geocent"];const mK={init:dK,forward:uK,inverse:hK,names:fK};var Ua={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},gg={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function gK(){if(Object.keys(gg).forEach((function(n){if(typeof this[n]>"u")this[n]=gg[n].def;else{if(gg[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);gg[n].num&&(this[n]=parseFloat(this[n]))}gg[n].degrees&&(this[n]=this[n]*yi)}).bind(this)),Math.abs(Math.abs(this.lat0)-ps)<Ms?this.mode=this.lat0<0?Ua.S_POLE:Ua.N_POLE:Math.abs(this.lat0)<Ms?this.mode=Ua.EQUIT:(this.mode=Ua.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function _K(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i,a;switch(this.mode){case Ua.OBLIQ:a=this.sinph0*e+this.cosph0*n*r;break;case Ua.EQUIT:a=n*r;break;case Ua.S_POLE:a=-e;break;case Ua.N_POLE:a=e;break}switch(a=this.pn1/(this.p-a),i=a*n*Math.sin(t.x),this.mode){case Ua.OBLIQ:a*=this.cosph0*e-this.sinph0*n*r;break;case Ua.EQUIT:a*=e;break;case Ua.N_POLE:a*=-(n*r);break;case Ua.S_POLE:a*=n*r;break}var o,c;return o=a*this.cg+i*this.sg,c=1/(o*this.sw*this.h1+this.cw),i=(i*this.cg-a*this.sg)*this.cw*c,a=o*c,t.x=i*this.a,t.y=a*this.a,t}function xK(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,i;i=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*i,r=this.pn1*t.y*this.cw*i,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var a=vl(t.x,t.y);if(Math.abs(a)<Ms)e.x=0,e.y=t.y;else{var o,c;switch(c=1-a*a*this.pfact,c=(this.p-Math.sqrt(c))/(this.pn1/a+a/this.pn1),o=Math.sqrt(1-c*c),this.mode){case Ua.OBLIQ:e.y=Math.asin(o*this.sinph0+t.y*c*this.cosph0/a),t.y=(o-this.sinph0*Math.sin(e.y))*a,t.x*=c*this.cosph0;break;case Ua.EQUIT:e.y=Math.asin(t.y*c/a),t.y=o*a,t.x*=c;break;case Ua.N_POLE:e.y=Math.asin(o),t.y=-t.y;break;case Ua.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var pK=["Tilted_Perspective","tpers"];const yK={init:gK,forward:_K,inverse:xK,names:pK};function bK(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function CK(t){var e=t.x,n=t.y,r,i,a,o;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var c=this.radius_p/vl(this.radius_p*Math.cos(n),Math.sin(n));if(i=c*Math.cos(e)*Math.cos(n),a=c*Math.sin(e)*Math.cos(n),o=c*Math.sin(n),(this.radius_g-i)*i-a*a-o*o*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(a/vl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(a/r),t.y=this.radius_g_1*Math.atan(o/vl(a,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(e)*r,a=Math.sin(e)*r,o=Math.sin(n),r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(a/vl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(a/r),t.y=this.radius_g_1*Math.atan(o/vl(a,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function NK(t){var e=-1,n=0,r=0,i,a,o,c;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*vl(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*vl(1,n));var u=r/this.radius_p;if(i=n*n+u*u+e*e,a=2*this.radius_g*e,o=a*a-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;c=(-a-Math.sqrt(o))/(2*i),e=this.radius_g+c*e,n*=c,r*=c,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+e*e,a=2*this.radius_g*e,o=a*a-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;c=(-a-Math.sqrt(o))/(2*i),e=this.radius_g+c*e,n*=c,r*=c,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var SK=["Geostationary Satellite View","Geostationary_Satellite","geos"];const vK={init:bK,forward:CK,inverse:NK,names:SK};var Gg=1.340264,Wg=-.081106,Fg=893e-6,Kg=.003796,c1=Math.sqrt(3)/2;function EK(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function DK(t){var e=As(t.x-this.long0,this.over),n=t.y,r=Math.asin(c1*Math.sin(n)),i=r*r,a=i*i*i;return t.x=e*Math.cos(r)/(c1*(Gg+3*Wg*i+a*(7*Fg+9*Kg*i))),t.y=r*(Gg+Wg*i+a*(Fg+Kg*i)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function RK(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,i,a,o,c,u,h;for(h=0;h<n&&(i=r*r,a=i*i*i,o=r*(Gg+Wg*i+a*(Fg+Kg*i))-t.y,c=Gg+3*Wg*i+a*(7*Fg+9*Kg*i),r-=u=o/c,!(Math.abs(u)<e));++h);return i=r*r,a=i*i*i,t.x=c1*t.x*(Gg+3*Wg*i+a*(7*Fg+9*Kg*i))/Math.cos(r),t.y=Math.asin(Math.sin(r)/c1),t.x=As(t.x+this.long0,this.over),t}var TK=["eqearth","Equal Earth","Equal_Earth"];const MK={init:EK,forward:DK,inverse:RK,names:TK};var c_=1e-10;function IK(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<c_)throw new Error;this.es?(this.en=XN(this.es),this.m1=ym(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=OK,this.forward=jK):(Math.abs(this.phi1)+c_>=ps?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=LK,this.forward=wK)}function jK(t){var e=As(t.x-(this.long0||0),this.over),n=t.y,r,i,a;return r=this.am1+this.m1-ym(n,i=Math.sin(n),a=Math.cos(n),this.en),i=a*e/(r*Math.sqrt(1-this.es*i*i)),t.x=r*Math.sin(i),t.y=this.am1-r*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function OK(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,i;if(n=vl(t.x,t.y=this.am1-t.y),i=JN(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(i))<ps)e=Math.sin(i),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-ps)<=c_)r=0;else throw new Error;return t.x=As(r+(this.long0||0),this.over),t.y=Zu(i),t}function wK(t){var e=As(t.x-(this.long0||0),this.over),n=t.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>c_?(t.x=i*Math.sin(r=e*Math.cos(n)/i),t.y=this.cphi1-i*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function LK(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=vl(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>ps)throw new Error;return Math.abs(Math.abs(n)-ps)<=c_?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=As(e+(this.long0||0),this.over),t.y=Zu(n),t}var PK=["bonne","Bonne (Werner lat_1=90)"];const AK={init:IK,names:PK},aR={OBLIQUE:{forward:WK,inverse:KK},TRANSVERSE:{forward:FK,inverse:QK}},d1={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function kK(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=Ij.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const t=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=xo(t);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let n;const r=Object.keys(d1),i=c=>{if(typeof this[c]>"u")return;const u=parseFloat(this[c])*yi;if(isNaN(u))throw new Error("Invalid value for "+c+": "+this[c]);return u};for(let c=0;c<r.length;c++){const u=r[c],h=d1[u],m=Object.entries(h);if(m.some(([p])=>typeof this[p]<"u")){n=h;for(let p=0;p<m.length;p++){const[g,C]=m[p],y=i(g);if(typeof y>"u")throw new Error("Missing parameter: "+g+".");this[C]=y}break}}if(!n)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:a,phip:o}=GK(this,n);this.lamp=a,Math.abs(o)>Ms?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=aR.OBLIQUE):this.projectionType=aR.TRANSVERSE}function UK(t){return this.projectionType.forward(this,t)}function BK(t){return this.projectionType.inverse(this,t)}function GK(t,e){let n,r;if(e===d1.ROTATE){let i=t.oLongC,a=t.oLatC,o=t.oAlpha;if(Math.abs(Math.abs(a)-ps)<=Ms)throw new Error("Invalid value for o_lat_c: "+t.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(a)),n=Math.asin(Math.cos(a)*Math.sin(o))}else if(e===d1.NEW_POLE)r=t.oLongP,n=t.oLatP;else{let i=t.oLong1,a=t.oLat1,o=t.oLong2,c=t.oLat2,u=Math.abs(a);if(Math.abs(a)>ps-Ms)throw new Error("Invalid value for o_lat_1: "+t.o_lat_1+" should be < 90");if(Math.abs(c)>ps-Ms)throw new Error("Invalid value for o_lat_2: "+t.o_lat_2+" should be < 90");if(Math.abs(a-c)<Ms)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(u<Ms)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(a)*Math.sin(c)*Math.cos(i)-Math.sin(a)*Math.cos(c)*Math.cos(o),Math.sin(a)*Math.cos(c)*Math.sin(o)-Math.cos(a)*Math.sin(c)*Math.sin(i)),n=Math.atan(-1*Math.cos(r-i)/Math.tan(a))}return{lamp:r,phip:n}}function WK(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(n),a=Math.sin(r),o=Math.cos(r);e.x=As(Math.atan2(o*Math.sin(n),t.sphip*o*i+t.cphip*a)+t.lamp),e.y=Math.asin(t.sphip*a-t.cphip*o*i);const c=t.obliqueProjection.forward(e);return t.isIdentity&&(c.x*=Dl,c.y*=Dl),c}function FK(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(r),a=Math.cos(n);e.x=As(Math.atan2(i*Math.sin(n),Math.sin(r))+t.lamp),e.y=Math.asin(-1*i*a);const o=t.obliqueProjection.forward(e);return t.isIdentity&&(o.x*=Dl,o.y*=Dl),o}function KK(t,e){t.isIdentity&&(e.x*=yi,e.y*=yi);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){r-=t.lamp;const a=Math.cos(r),o=Math.sin(i),c=Math.cos(i);e.x=Math.atan2(c*Math.sin(r),t.sphip*c*a-t.cphip*o),e.y=Math.asin(t.sphip*o+t.cphip*c*a)}return e.x=As(e.x+t.long0),e}function QK(t,e){t.isIdentity&&(e.x*=yi,e.y*=yi);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){const a=Math.cos(i);r-=t.lamp,e.x=Math.atan2(a*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(a*Math.cos(r))}return e.x=As(e.x+t.long0),e}var YK=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const VK={init:kK,forward:UK,inverse:BK,names:YK};function $K(t){t.Proj.projections.add(Np),t.Proj.projections.add(Sp),t.Proj.projections.add(PG),t.Proj.projections.add(QG),t.Proj.projections.add(HG),t.Proj.projections.add(eW),t.Proj.projections.add(aW),t.Proj.projections.add(uW),t.Proj.projections.add(_W),t.Proj.projections.add(CW),t.Proj.projections.add(LW),t.Proj.projections.add(GW),t.Proj.projections.add(YW),t.Proj.projections.add(XW),t.Proj.projections.add(sF),t.Proj.projections.add(lF),t.Proj.projections.add(hF),t.Proj.projections.add(xF),t.Proj.projections.add(SF),t.Proj.projections.add(TF),t.Proj.projections.add(wF),t.Proj.projections.add(UF),t.Proj.projections.add(YF),t.Proj.projections.add(qF),t.Proj.projections.add(tK),t.Proj.projections.add(cK),t.Proj.projections.add(mK),t.Proj.projections.add(yK),t.Proj.projections.add(vK),t.Proj.projections.add(MK),t.Proj.projections.add(AK),t.Proj.projections.add(VK)}const E2=Object.assign(JB,{defaultDatum:"WGS84",Proj:xo,WGS84:new xo("WGS84"),Point:fm,toPoint:Aj,defs:va,nadgrid:LB,transform:a1,mgrs:ZB,version:"__VERSION__"});$K(E2);const cf={:"#DC2626",:"#16A34A",:"#9CA3AF",default:"#EF4444"},zK="A4EED0C3-BED4-315A-AF7B-B47F94357975";function HK(t,e){const n=e+1,r=n>=100?9:n>=10?11:13,i=`<svg xmlns="http://www.w3.org/2000/svg" width="36" height="48" viewBox="0 0 36 48">
    <path fill="${t}" stroke="#fff" stroke-width="2" d="M18 2C9.163 2 2 9.163 2 18c0 12 16 28 16 28s16-16 16-28c0-8.837-7.163-16-16-16z"/>
    <circle fill="#fff" cx="18" cy="18" r="10"/>
    <text x="18" y="22" text-anchor="middle" font-size="${r}" font-weight="bold" fill="${t}" font-family="Arial,sans-serif">${n}</text>
  </svg>`;return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(i)}function qx(){return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <circle cx="20" cy="20" r="18" fill="#3B82F6" fill-opacity="0.15" stroke="#3B82F6" stroke-width="1.5" stroke-opacity="0.4"/>
    <circle cx="20" cy="20" r="9" fill="#3B82F6" stroke="#fff" stroke-width="3"/>
  </svg>`)}function qK(){return new Promise(t=>{var r,i,a;if((i=(r=window.kakao)==null?void 0:r.maps)!=null&&i.services){t(!0);return}if((a=window.kakao)!=null&&a.maps){window.kakao.maps.load(()=>t(!!window.kakao.maps.services));return}let e=0;const n=setInterval(async()=>{var o;if(e++,(o=window.kakao)!=null&&o.maps){if(clearInterval(n),window.kakao.maps.services){t(!0);return}window.kakao.maps.load(()=>t(!!window.kakao.maps.services))}else if(e>25){clearInterval(n);const c=await dN(),u=Pg(c.kakao);if(!u){t(!1);return}const h=document.createElement("script");h.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=${u}&libraries=services&autoload=false`,h.onload=()=>{var m;(m=window.kakao)!=null&&m.maps?window.kakao.maps.load(()=>t(!!window.kakao.maps.services)):t(!1)},h.onerror=()=>t(!1),document.head.appendChild(h)}},200)})}function XK(t){return new Promise(e=>{var r,i;if(!((i=(r=window.kakao)==null?void 0:r.maps)!=null&&i.services)){e(null);return}const n=new window.kakao.maps.services.Geocoder;n.addressSearch(t,(a,o)=>{if(o===window.kakao.maps.services.Status.OK&&a[0])e({lat:parseFloat(a[0].y),lng:parseFloat(a[0].x)});else{const c=t.replace(/\(.*?\)/g,"").replace(/\d+[]/g,"").replace(/\s{2,}/g," ").trim();c!==t?n.addressSearch(c,(u,h)=>{h===window.kakao.maps.services.Status.OK&&u[0]?e({lat:parseFloat(u[0].y),lng:parseFloat(u[0].x)}):e(null)}):e(null)}})})}const zj=({workOrders:t,onBack:e,onSelectWork:n})=>{var q,$;const r=b.useRef(null),i=b.useRef(null),a=b.useRef(null),o=b.useRef(null),c=b.useRef(null),u=b.useRef(null),h=b.useRef(null),m=b.useRef([]),_=b.useRef(null),p=b.useRef(null),g=b.useRef(null),C=b.useRef(null),y=b.useRef([]),S=b.useRef(null),[v,k]=b.useState("vworld"),[L,M]=b.useState(!0),[P,F]=b.useState(null),G=b.useRef(!0),B=b.useRef(!0),I=b.useRef(!0),[E,A]=b.useState(0),[Y,ee]=b.useState(0),[J,H]=b.useState(null),[V,K]=b.useState(null),[j,te]=b.useState("");b.useEffect(()=>{let de=!1;return(async()=>{var Dt,ot,At,ct,Ge;const ae=await dN(),_e=Pg(ae.vworld)||zK,ie=Pg(ae.ngii);if(console.log(`[Map] VWorld  : ${_e.substring(0,8)}...`),ie?console.log(`[Map] NGII  : ${ie.substring(0,8)}...`):console.warn("[Map] MOMP001 NGII  "),de)return;const Ne=new UD;c.current=Ne;const X=new WU({url:`https://api.vworld.kr/req/wmts/1.0.0/${_e}/Base/{z}/{y}/{x}.png`,maxZoom:19,attributions:" VWorld"});let xe=0;X.on("tileloaderror",()=>{xe++,xe>=3&&G.current&&(G.current=!1,console.warn("[Map] VWorld   ,    "),B.current?k("kakao"):I.current?k("ngii"):F("    .   ."))});const fe=new xD({target:r.current,layers:[new ED({source:X}),new OD({source:Ne})],view:new zo({center:da([126.978,37.5665]),zoom:8,maxZoom:19,minZoom:6})});o.current=fe,fe.on("click",at=>{const xt=fe.forEachFeatureAtPixel(at.pixel,mt=>mt);if(xt){const mt=xt.get("workId"),Ve=y.current.find(it=>it.work.id===mt);Ve&&(H(Ve.work),K(Ve.coords),fe.getView().animate({center:da([Ve.coords.lng,Ve.coords.lat]),zoom:Math.max(fe.getView().getZoom()||14,14),duration:300}))}else H(null),K(null)}),fe.on("pointermove",at=>{const xt=fe.forEachFeatureAtPixel(at.pixel,()=>!0);fe.getTargetElement().style.cursor=xt?"pointer":""});let Z=null;const le=()=>{var at,xt;try{if(!((xt=(at=window.kakao)==null?void 0:at.maps)!=null&&xt.Map)||!i.current)return null;const mt=new window.kakao.maps.Map(i.current,{center:new window.kakao.maps.LatLng(37.5665,126.978),level:8});return h.current=mt,window.kakao.maps.event.addListener(mt,"click",()=>{H(null),K(null)}),B.current=!0,console.log("[Map]   "),mt}catch(mt){return console.warn("[Map]   :",mt),B.current=!1,G.current?k("vworld"):I.current?k("ngii"):F("    .   ."),null}};if(!((Dt=window.kakao)!=null&&Dt.maps)){const at=Pg(ae.kakao);at?(console.log(`[Map]  SDK    (: ${at.substring(0,8)}...)`),await new Promise(xt=>{const mt=document.createElement("script");mt.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=${at}&libraries=services&autoload=false`,mt.onload=()=>{var Ve;console.log("[Map]  SDK   "),(Ve=window.kakao)!=null&&Ve.maps?window.kakao.maps.load(()=>{console.log("[Map]  maps.load() "),xt()}):xt()},mt.onerror=()=>{console.error("[Map]  SDK   "),xt()},document.head.appendChild(mt)})):console.warn("[Map] MOMP001   ")}if(de)return;(ot=window.kakao)!=null&&ot.maps?window.kakao.maps.Map?Z=le():window.kakao.maps.load(()=>{Z=le()}):(B.current=!1,console.warn("[Map]  SDK  "));let se=null,Re=null;if(ie&&a.current)try{E2.defs("EPSG:5179","+proj=tmerc +lat_0=38 +lon_0=127.5 +k=0.9996 +x_0=1000000 +y_0=2000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),FU(E2);const at=Ta("EPSG:5179");at&&at.setExtent([-2e5,-2802412362e-2,3182412362e-2,4e6]);const xt=[],mt=[];for(let lt=0;lt<14;lt++)xt.push(2088.96/Math.pow(2,lt)),mt.push("L"+String(lt+5).padStart(2,"0"));const Ve=new DU({origin:[-2e5,4e6],resolutions:xt,matrixIds:mt,tileSize:256}),it=new KU({url:"/api/ngii-tile",layer:"korean_map",matrixSet:"korean",format:"image/png",projection:"EPSG:5179",tileGrid:Ve,style:"korean",requestEncoding:"KVP",tileLoadFunction:(lt,Mt)=>{const ut=new URL(Mt,window.location.origin),qe=ut.searchParams.get("TILEMATRIX")||"",Ee=ut.searchParams.get("TILEROW")||"",Ye=ut.searchParams.get("TILECOL")||"",pe=`/api/ngii-tile?apikey=${ie}&tilematrix=${qe}&tilerow=${Ee}&tilecol=${Ye}`;console.log(`[NGII] tile: ${qe}/${Ee}/${Ye}`),lt.getImage().src=pe},attributions:" NGII"});let Fe=0;it.on("tileloaderror",()=>{Fe++,Fe>=3&&I.current&&(I.current=!1,console.warn("[Map] NGII   ,   "),G.current?k("vworld"):B.current?k("kakao"):F("    .   ."))}),Re=new UD,g.current=Re;const nt=at?da([126.978,37.5665],"EPSG:5179"):[1e6,2e6];se=new xD({target:a.current,layers:[new ED({source:it}),new OD({source:Re})],view:new zo({projection:"EPSG:5179",center:nt,zoom:3,maxZoom:13,minZoom:0})}),p.current=se,se.on("click",lt=>{const Mt=se.forEachFeatureAtPixel(lt.pixel,ut=>ut);if(Mt){const ut=Mt.get("workId"),qe=y.current.find(Ee=>Ee.work.id===ut);qe&&(H(qe.work),K(qe.coords),se.getView().animate({center:da([qe.coords.lng,qe.coords.lat],"EPSG:5179"),zoom:Math.max(se.getView().getZoom()||9,9),duration:300}))}else H(null),K(null)}),se.on("pointermove",lt=>{const Mt=se.forEachFeatureAtPixel(lt.pixel,()=>!0);se.getTargetElement().style.cursor=Mt?"pointer":""}),I.current=!0,console.log("[Map] NGII   ")}catch(at){console.warn("[Map] NGII   :",at),I.current=!1}else I.current=!1;const be=(at,xt)=>{S.current={lat:at,lng:xt};const mt=qx(),Ve=new vu({geometry:new Sh(da([xt,at]))});if(Ve.set("isMyLocation",!0),Ve.setStyle(new Wl({image:new Rc({src:mt,anchor:[.5,.5],scale:1})})),Ne.addFeature(Ve),u.current=Ve,Re){const it=new vu({geometry:new Sh(da([xt,at],"EPSG:5179"))});it.set("isMyLocation",!0),it.setStyle(new Wl({image:new Rc({src:mt,anchor:[.5,.5],scale:1})})),Re.addFeature(it),C.current=it}if(Z){const it=new window.kakao.maps.MarkerImage(mt,new window.kakao.maps.Size(40,40),{offset:new window.kakao.maps.Point(20,20)}),Fe=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(at,xt),image:it,map:Z,zIndex:10});_.current=Fe}console.log(`[Map]   : ${at}, ${xt}`)};if(navigator.geolocation&&navigator.geolocation.getCurrentPosition(at=>{de||be(at.coords.latitude,at.coords.longitude)},at=>console.warn("[Map]   :",at.message),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}),!await qK()){F("     ."),M(!1);return}!Z&&((ct=(At=window.kakao)==null?void 0:At.maps)!=null&&ct.Map)&&(Z=le()),console.log(`[Map] Geocoding : ${t.length}`);const re=[],me=[];let ve=0;for(let at=0;at<t.length;at++){if(de)return;const xt=t[at],mt=(Ge=xt.customer)==null?void 0:Ge.address;if(mt){at>0&&await new Promise(it=>setTimeout(it,80));const Ve=await XK(mt);if(Ve){const it=cf[xt.status]||cf.default,Fe=HK(it,at),nt=new vu({geometry:new Sh(da([Ve.lng,Ve.lat]))});if(nt.set("workId",xt.id),nt.setStyle(new Wl({image:new Rc({src:Fe,anchor:[.5,1],scale:1})})),Ne.addFeature(nt),me.push(da([Ve.lng,Ve.lat])),Z){const lt=new window.kakao.maps.MarkerImage(Fe,new window.kakao.maps.Size(36,48),{offset:new window.kakao.maps.Point(18,48)}),Mt=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(Ve.lat,Ve.lng),image:lt,map:Z}),ut=xt,qe=Ve;window.kakao.maps.event.addListener(Mt,"click",()=>{H(ut),K(qe),Z.panTo(new window.kakao.maps.LatLng(qe.lat,qe.lng))}),m.current.push(Mt)}if(Re){const lt=new vu({geometry:new Sh(da([Ve.lng,Ve.lat],"EPSG:5179"))});lt.set("workId",xt.id),lt.setStyle(new Wl({image:new Rc({src:Fe,anchor:[.5,1],scale:1})})),Re.addFeature(lt)}re.push({work:xt,coords:Ve}),ve++,console.log(`[Map] ${at+1}/${t.length} : "${mt}"  ${Ve.lat},${Ve.lng}`)}else console.warn(`[Map] ${at+1}/${t.length} : "${mt}"`)}A(at+1),ee(ve)}y.current=re,console.log(`[Map] Geocoding : ${ve}/${t.length} `);const et=S.current;if(et&&me.push(da([et.lng,et.lat])),me.length>0&&(me.length===1?fe.getView().animate({center:me[0],zoom:15,duration:300}):fe.getView().fit(Yp(me),{padding:[60,60,60,60],maxZoom:16,duration:300})),Z&&(re.length>0||et)){const at=new window.kakao.maps.LatLngBounds;re.forEach(xt=>{at.extend(new window.kakao.maps.LatLng(xt.coords.lat,xt.coords.lng))}),et&&at.extend(new window.kakao.maps.LatLng(et.lat,et.lng)),Z.setBounds(at)}if(se&&Re){const at=re.map(xt=>da([xt.coords.lng,xt.coords.lat],"EPSG:5179"));et&&at.push(da([et.lng,et.lat],"EPSG:5179")),at.length>0&&(at.length===1?se.getView().animate({center:at[0],zoom:10,duration:300}):se.getView().fit(Yp(at),{padding:[60,60,60,60],maxZoom:11,duration:300}))}M(!1)})(),()=>{de=!0,o.current&&(o.current.setTarget(void 0),o.current=null),c.current=null,u.current=null,p.current&&(p.current.setTarget(void 0),p.current=null),g.current=null,C.current=null,m.current.forEach(ae=>ae.setMap(null)),m.current=[],_.current&&_.current.setMap(null),_.current=null,h.current=null,S.current=null}},[t]),b.useEffect(()=>{const de=setTimeout(()=>{if(v==="vworld"&&o.current)o.current.updateSize();else if(v==="kakao"&&h.current){if(h.current.relayout(),y.current.length>0){const ae=new window.kakao.maps.LatLngBounds;y.current.forEach(_e=>{ae.extend(new window.kakao.maps.LatLng(_e.coords.lat,_e.coords.lng))}),h.current.setBounds(ae)}}else v==="ngii"&&p.current&&p.current.updateSize()},150);return()=>clearTimeout(de)},[v]);const ce=b.useCallback(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(de=>{const{latitude:ae,longitude:_e}=de.coords;if(S.current={lat:ae,lng:_e},u.current)u.current.getGeometry().setCoordinates(da([_e,ae]));else if(c.current){const ie=new vu({geometry:new Sh(da([_e,ae]))});ie.set("isMyLocation",!0),ie.setStyle(new Wl({image:new Rc({src:qx(),anchor:[.5,.5],scale:1})})),c.current.addFeature(ie),u.current=ie}if(C.current)C.current.getGeometry().setCoordinates(da([_e,ae],"EPSG:5179"));else if(g.current){const ie=new vu({geometry:new Sh(da([_e,ae],"EPSG:5179"))});ie.set("isMyLocation",!0),ie.setStyle(new Wl({image:new Rc({src:qx(),anchor:[.5,.5],scale:1})})),g.current.addFeature(ie),C.current=ie}if(_.current)_.current.setPosition(new window.kakao.maps.LatLng(ae,_e));else if(h.current){const ie=new window.kakao.maps.MarkerImage(qx(),new window.kakao.maps.Size(40,40),{offset:new window.kakao.maps.Point(20,20)});_.current=new window.kakao.maps.Marker({position:new window.kakao.maps.LatLng(ae,_e),image:ie,map:h.current,zIndex:10})}v==="vworld"&&o.current?o.current.getView().animate({center:da([_e,ae]),zoom:15,duration:500}):v==="kakao"&&h.current?(h.current.panTo(new window.kakao.maps.LatLng(ae,_e)),h.current.setLevel(3)):v==="ngii"&&p.current&&p.current.getView().animate({center:da([_e,ae],"EPSG:5179"),zoom:10,duration:500})},()=>te("    ."),{enableHighAccuracy:!0,timeout:1e4})},[v]),R=co(de=>de.preferredNavApp),O=b.useCallback(()=>{var de;!V||!J||HM(R,{lat:V.lat,lng:V.lng,name:((de=J.customer)==null?void 0:de.address)||""})},[V,J,R]),U=b.useCallback(()=>{H(null),K(null)},[]),Q=b.useCallback(()=>{k(de=>{const ae=["kakao","vworld","ngii"],_e={kakao:B,vworld:G,ngii:I},ie=ae.indexOf(de);for(let Ne=1;Ne<=ae.length-1;Ne++){const X=ae[(ie+Ne)%ae.length];if(_e[X].current)return X}return te("     ."),de}),U()},[U]);return s.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col",style:{zIndex:200},children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b border-gray-200",children:[s.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-gray-700",children:[s.jsx(H2,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:""})]}),s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:" "}),s.jsxs("button",{onClick:Q,className:"flex items-center gap-1 px-3 py-1.5 rounded-full text-xs font-semibold border",style:{background:v==="vworld"?"#EFF6FF":v==="kakao"?"#FEF9C3":"#ECFDF5",color:v==="vworld"?"#1D4ED8":v==="kakao"?"#92400E":"#065F46",borderColor:v==="vworld"?"#BFDBFE":v==="kakao"?"#FDE68A":"#A7F3D0"},children:[s.jsx(OL,{className:"w-3.5 h-3.5"}),v==="vworld"?"":v==="kakao"?"":"NGII"]})]}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("div",{ref:r,className:"absolute inset-0",style:{visibility:v==="vworld"?"visible":"hidden",zIndex:v==="vworld"?1:0}}),s.jsx("div",{ref:i,className:"absolute inset-0",style:{visibility:v==="kakao"?"visible":"hidden",zIndex:v==="kakao"?1:0}}),s.jsx("div",{ref:a,className:"absolute inset-0",style:{visibility:v==="ngii"?"visible":"hidden",zIndex:v==="ngii"?1:0}}),L&&!P&&s.jsxs("div",{className:"absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-10",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),s.jsxs("p",{className:"text-gray-600",children:["  ... (",E,"/",t.length,")"]}),Y>0&&s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[Y,"  "]})]}),P&&s.jsxs("div",{className:"absolute inset-0 bg-white flex flex-col items-center justify-center z-10 p-6",children:[s.jsx("p",{className:"text-gray-700 text-center mb-4",children:P}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg",children:""})]}),!L&&!P&&s.jsx("div",{className:"absolute top-3 left-3 bg-white/90 backdrop-blur rounded-lg shadow p-2.5 z-20",children:s.jsxs("div",{className:"flex gap-3 text-[11px]",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full border-2 border-blue-500",style:{background:"#3B82F6"}}),s.jsx("span",{className:"text-gray-600 font-semibold",children:" "})]}),[["#DC2626",""],["#16A34A",""],["#EF4444",""],["#9CA3AF",""]].map(([de,ae])=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:de}}),s.jsx("span",{className:"text-gray-600",children:ae})]},ae))]})}),s.jsx("button",{onClick:ce,title:" ",className:"absolute bottom-20 right-4 w-11 h-11 bg-white rounded-full shadow-lg flex items-center justify-center z-20",style:{bottom:J?"220px":"80px"},children:s.jsx(VL,{className:"w-5 h-5 text-blue-500"})}),s.jsxs("button",{onClick:e,className:"absolute left-4 px-4 py-2.5 bg-white rounded-full shadow-lg flex items-center gap-2 z-20",style:{bottom:J?"220px":"80px"},children:[s.jsx(q2,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]}),J&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-30 px-3 pb-3",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-100 p-4 max-w-lg mx-auto relative",children:[s.jsx("button",{onClick:U,className:"absolute top-3 right-3 p-1",children:s.jsx(Mi,{size:16,className:"text-gray-400"})}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold",style:{background:`${cf[J.status]||cf.default}15`,color:cf[J.status]||cf.default},children:J.typeDisplay||J.type}),s.jsx("span",{className:"px-2 py-0.5 rounded bg-gray-100 text-gray-500 text-xs",children:J.status})]}),s.jsx("div",{className:"font-semibold text-[15px] text-gray-900 mb-1 pr-6",children:((q=J.customer)==null?void 0:q.name)||" "}),s.jsx("div",{className:"text-[13px] text-gray-500 mb-3 leading-snug",children:(($=J.customer)==null?void 0:$.address)||" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{var de;(de=J.customer)!=null&&de.phone&&(window.location.href=`tel:${J.customer.phone}`)},className:"flex-1 py-2.5 rounded-lg bg-blue-500 text-white text-xs font-medium active:bg-blue-600",children:""}),s.jsx("button",{onClick:O,className:"flex-1 py-2.5 rounded-lg bg-purple-500 text-white text-xs font-medium active:bg-purple-600",children:""}),s.jsx("button",{onClick:()=>n(J),className:"flex-1 py-2.5 rounded-lg bg-emerald-500 text-white text-xs font-medium active:bg-emerald-600",children:""})]})]})})]}),s.jsx("div",{className:"px-4 py-2.5 bg-white border-t border-gray-200",children:s.jsxs("div",{className:"text-center text-sm text-gray-500",children:[" ",t.length," ",Y>0&&!L&&`(${Y} )`]})}),s.jsx(Ba,{isOpen:!!j,onClose:()=>te(""),onConfirm:()=>te(""),message:j,type:"warning",showCancel:!1})]})};function Nd(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function rS(t,e=[]){let n=[];function r(a,o){const c=b.createContext(o),u=n.length;n=[...n,o];const h=_=>{var v;const{scope:p,children:g,...C}=_,y=((v=p==null?void 0:p[t])==null?void 0:v[u])||c,S=b.useMemo(()=>C,Object.values(C));return s.jsx(y.Provider,{value:S,children:g})};h.displayName=a+"Provider";function m(_,p){var y;const g=((y=p==null?void 0:p[t])==null?void 0:y[u])||c,C=b.useContext(g);if(C)return C;if(o!==void 0)return o;throw new Error(`\`${_}\` must be used within \`${a}\``)}return[h,m]}const i=()=>{const a=n.map(o=>b.createContext(o));return function(c){const u=(c==null?void 0:c[t])||a;return b.useMemo(()=>({[`__scope${t}`]:{...c,[t]:u}}),[c,u])}};return i.scopeName=t,[r,JK(i,...e)]}function JK(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const o=r.reduce((c,{useScope:u,scopeName:h})=>{const _=u(a)[`__scope${h}`];return{...c,..._}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function lR(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Hj(...t){return e=>{let n=!1;const r=t.map(i=>{const a=lR(i,e);return!n&&typeof a=="function"&&(n=!0),a});if(n)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():lR(t[i],null)}}}}function u1(...t){return b.useCallback(Hj(...t),t)}function D2(t){const e=ZK(t),n=b.forwardRef((r,i)=>{const{children:a,...o}=r,c=b.Children.toArray(a),u=c.find(tQ);if(u){const h=u.props.children,m=c.map(_=>_===u?b.Children.count(h)>1?b.Children.only(null):b.isValidElement(h)?h.props.children:null:_);return s.jsx(e,{...o,ref:i,children:b.isValidElement(h)?b.cloneElement(h,void 0,m):null})}return s.jsx(e,{...o,ref:i,children:a})});return n.displayName=`${t}.Slot`,n}function ZK(t){const e=b.forwardRef((n,r)=>{const{children:i,...a}=n;if(b.isValidElement(i)){const o=nQ(i),c=sQ(a,i.props);return i.type!==b.Fragment&&(c.ref=r?Hj(r,o):o),b.cloneElement(i,c)}return b.Children.count(i)>1?b.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var eQ=Symbol("radix.slottable");function tQ(t){return b.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===eQ}function sQ(t,e){const n={...e};for(const r in e){const i=t[r],a=e[r];/^on[A-Z]/.test(r)?i&&a?n[r]=(...c)=>{const u=a(...c);return i(...c),u}:i&&(n[r]=i):r==="style"?n[r]={...i,...a}:r==="className"&&(n[r]=[i,a].filter(Boolean).join(" "))}return{...t,...n}}function nQ(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function rQ(t){const e=t+"CollectionProvider",[n,r]=rS(e),[i,a]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=y=>{const{scope:S,children:v}=y,k=Ji.useRef(null),L=Ji.useRef(new Map).current;return s.jsx(i,{scope:S,itemMap:L,collectionRef:k,children:v})};o.displayName=e;const c=t+"CollectionSlot",u=D2(c),h=Ji.forwardRef((y,S)=>{const{scope:v,children:k}=y,L=a(c,v),M=u1(S,L.collectionRef);return s.jsx(u,{ref:M,children:k})});h.displayName=c;const m=t+"CollectionItemSlot",_="data-radix-collection-item",p=D2(m),g=Ji.forwardRef((y,S)=>{const{scope:v,children:k,...L}=y,M=Ji.useRef(null),P=u1(S,M),F=a(m,v);return Ji.useEffect(()=>(F.itemMap.set(M,{ref:M,...L}),()=>void F.itemMap.delete(M))),s.jsx(p,{[_]:"",ref:P,children:k})});g.displayName=m;function C(y){const S=a(t+"CollectionConsumer",y);return Ji.useCallback(()=>{const k=S.collectionRef.current;if(!k)return[];const L=Array.from(k.querySelectorAll(`[${_}]`));return Array.from(S.itemMap.values()).sort((F,G)=>L.indexOf(F.ref.current)-L.indexOf(G.ref.current))},[S.collectionRef,S.itemMap])}return[{Provider:o,Slot:h,ItemSlot:g},C,r]}var h1=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},iQ=nM[" useId ".trim().toString()]||(()=>{}),aQ=0;function qj(t){const[e,n]=b.useState(iQ());return h1(()=>{n(r=>r??String(aQ++))},[t]),e?`radix-${e}`:""}var lQ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],bm=lQ.reduce((t,e)=>{const n=D2(`Primitive.${e}`),r=b.forwardRef((i,a)=>{const{asChild:o,...c}=i,u=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(u,{...c,ref:a})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function oQ(t){const e=b.useRef(t);return b.useEffect(()=>{e.current=t}),b.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}var cQ=nM[" useInsertionEffect ".trim().toString()]||h1;function Xj({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[i,a,o]=dQ({defaultProp:e,onChange:n}),c=t!==void 0,u=c?t:i;{const m=b.useRef(t!==void 0);b.useEffect(()=>{const _=m.current;_!==c&&console.warn(`${r} is changing from ${_?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=c},[c,r])}const h=b.useCallback(m=>{var _;if(c){const p=uQ(m)?m(t):m;p!==t&&((_=o.current)==null||_.call(o,p))}else a(m)},[c,t,a,o]);return[u,h]}function dQ({defaultProp:t,onChange:e}){const[n,r]=b.useState(t),i=b.useRef(n),a=b.useRef(e);return cQ(()=>{a.current=e},[e]),b.useEffect(()=>{var o;i.current!==n&&((o=a.current)==null||o.call(a,n),i.current=n)},[n,i]),[n,r,a]}function uQ(t){return typeof t=="function"}var hQ=b.createContext(void 0);function Jj(t){const e=b.useContext(hQ);return t||e||"ltr"}var nC="rovingFocusGroup.onEntryFocus",fQ={bubbles:!1,cancelable:!0},L_="RovingFocusGroup",[R2,Zj,mQ]=rQ(L_),[gQ,e4]=rS(L_,[mQ]),[_Q,xQ]=gQ(L_),t4=b.forwardRef((t,e)=>s.jsx(R2.Provider,{scope:t.__scopeRovingFocusGroup,children:s.jsx(R2.Slot,{scope:t.__scopeRovingFocusGroup,children:s.jsx(pQ,{...t,ref:e})})}));t4.displayName=L_;var pQ=b.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:h,preventScrollOnEntryFocus:m=!1,..._}=t,p=b.useRef(null),g=u1(e,p),C=Jj(a),[y,S]=Xj({prop:o,defaultProp:c??null,onChange:u,caller:L_}),[v,k]=b.useState(!1),L=oQ(h),M=Zj(n),P=b.useRef(!1),[F,G]=b.useState(0);return b.useEffect(()=>{const B=p.current;if(B)return B.addEventListener(nC,L),()=>B.removeEventListener(nC,L)},[L]),s.jsx(_Q,{scope:n,orientation:r,dir:C,loop:i,currentTabStopId:y,onItemFocus:b.useCallback(B=>S(B),[S]),onItemShiftTab:b.useCallback(()=>k(!0),[]),onFocusableItemAdd:b.useCallback(()=>G(B=>B+1),[]),onFocusableItemRemove:b.useCallback(()=>G(B=>B-1),[]),children:s.jsx(bm.div,{tabIndex:v||F===0?-1:0,"data-orientation":r,..._,ref:g,style:{outline:"none",...t.style},onMouseDown:Nd(t.onMouseDown,()=>{P.current=!0}),onFocus:Nd(t.onFocus,B=>{const I=!P.current;if(B.target===B.currentTarget&&I&&!v){const E=new CustomEvent(nC,fQ);if(B.currentTarget.dispatchEvent(E),!E.defaultPrevented){const A=M().filter(V=>V.focusable),Y=A.find(V=>V.active),ee=A.find(V=>V.id===y),H=[Y,ee,...A].filter(Boolean).map(V=>V.ref.current);r4(H,m)}}P.current=!1}),onBlur:Nd(t.onBlur,()=>k(!1))})})}),s4="RovingFocusGroupItem",n4=b.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:a,children:o,...c}=t,u=qj(),h=a||u,m=xQ(s4,n),_=m.currentTabStopId===h,p=Zj(n),{onFocusableItemAdd:g,onFocusableItemRemove:C,currentTabStopId:y}=m;return b.useEffect(()=>{if(r)return g(),()=>C()},[r,g,C]),s.jsx(R2.ItemSlot,{scope:n,id:h,focusable:r,active:i,children:s.jsx(bm.span,{tabIndex:_?0:-1,"data-orientation":m.orientation,...c,ref:e,onMouseDown:Nd(t.onMouseDown,S=>{r?m.onItemFocus(h):S.preventDefault()}),onFocus:Nd(t.onFocus,()=>m.onItemFocus(h)),onKeyDown:Nd(t.onKeyDown,S=>{if(S.key==="Tab"&&S.shiftKey){m.onItemShiftTab();return}if(S.target!==S.currentTarget)return;const v=CQ(S,m.orientation,m.dir);if(v!==void 0){if(S.metaKey||S.ctrlKey||S.altKey||S.shiftKey)return;S.preventDefault();let L=p().filter(M=>M.focusable).map(M=>M.ref.current);if(v==="last")L.reverse();else if(v==="prev"||v==="next"){v==="prev"&&L.reverse();const M=L.indexOf(S.currentTarget);L=m.loop?NQ(L,M+1):L.slice(M+1)}setTimeout(()=>r4(L))}}),children:typeof o=="function"?o({isCurrentTabStop:_,hasTabStop:y!=null}):o})})});n4.displayName=s4;var yQ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function bQ(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function CQ(t,e,n){const r=bQ(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return yQ[r]}function r4(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function NQ(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var SQ=t4,vQ=n4;function EQ(t,e){return b.useReducer((n,r)=>e[n][r]??n,t)}var i4=t=>{const{present:e,children:n}=t,r=DQ(e),i=typeof n=="function"?n({present:r.isPresent}):b.Children.only(n),a=u1(r.ref,RQ(i));return typeof n=="function"||r.isPresent?b.cloneElement(i,{ref:a}):null};i4.displayName="Presence";function DQ(t){const[e,n]=b.useState(),r=b.useRef(null),i=b.useRef(t),a=b.useRef("none"),o=t?"mounted":"unmounted",[c,u]=EQ(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const h=Xx(r.current);a.current=c==="mounted"?h:"none"},[c]),h1(()=>{const h=r.current,m=i.current;if(m!==t){const p=a.current,g=Xx(h);t?u("MOUNT"):g==="none"||(h==null?void 0:h.display)==="none"?u("UNMOUNT"):u(m&&p!==g?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,u]),h1(()=>{if(e){let h;const m=e.ownerDocument.defaultView??window,_=g=>{const y=Xx(r.current).includes(CSS.escape(g.animationName));if(g.target===e&&y&&(u("ANIMATION_END"),!i.current)){const S=e.style.animationFillMode;e.style.animationFillMode="forwards",h=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=S)})}},p=g=>{g.target===e&&(a.current=Xx(r.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",_),e.addEventListener("animationend",_),()=>{m.clearTimeout(h),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",_),e.removeEventListener("animationend",_)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:b.useCallback(h=>{r.current=h?getComputedStyle(h):null,n(h)},[])}}function Xx(t){return(t==null?void 0:t.animationName)||"none"}function RQ(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var q1="Tabs",[TQ]=rS(q1,[e4]),a4=e4(),[MQ,iS]=TQ(q1),l4=b.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:a,orientation:o="horizontal",dir:c,activationMode:u="automatic",...h}=t,m=Jj(c),[_,p]=Xj({prop:r,onChange:i,defaultProp:a??"",caller:q1});return s.jsx(MQ,{scope:n,baseId:qj(),value:_,onValueChange:p,orientation:o,dir:m,activationMode:u,children:s.jsx(bm.div,{dir:m,"data-orientation":o,...h,ref:e})})});l4.displayName=q1;var o4="TabsList",c4=b.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,a=iS(o4,n),o=a4(n);return s.jsx(SQ,{asChild:!0,...o,orientation:a.orientation,dir:a.dir,loop:r,children:s.jsx(bm.div,{role:"tablist","aria-orientation":a.orientation,...i,ref:e})})});c4.displayName=o4;var d4="TabsTrigger",u4=b.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...a}=t,o=iS(d4,n),c=a4(n),u=m4(o.baseId,r),h=g4(o.baseId,r),m=r===o.value;return s.jsx(vQ,{asChild:!0,...c,focusable:!i,active:m,children:s.jsx(bm.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":h,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...a,ref:e,onMouseDown:Nd(t.onMouseDown,_=>{!i&&_.button===0&&_.ctrlKey===!1?o.onValueChange(r):_.preventDefault()}),onKeyDown:Nd(t.onKeyDown,_=>{[" ","Enter"].includes(_.key)&&o.onValueChange(r)}),onFocus:Nd(t.onFocus,()=>{const _=o.activationMode!=="manual";!m&&!i&&_&&o.onValueChange(r)})})})});u4.displayName=d4;var h4="TabsContent",f4=b.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:a,...o}=t,c=iS(h4,n),u=m4(c.baseId,r),h=g4(c.baseId,r),m=r===c.value,_=b.useRef(m);return b.useEffect(()=>{const p=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(p)},[]),s.jsx(i4,{present:i||m,children:({present:p})=>s.jsx(bm.div,{"data-state":m?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!p,id:h,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:_.current?"0s":void 0},children:p&&a})})});f4.displayName=h4;function m4(t,e){return`${t}-trigger-${e}`}function g4(t,e){return`${t}-content-${e}`}var IQ=l4,_4=c4,x4=u4,p4=f4;function y4(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=y4(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function jQ(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=y4(t))&&(r&&(r+=" "),r+=e);return r}const OQ=(t,e)=>{const n=new Array(t.length+e.length);for(let r=0;r<t.length;r++)n[r]=t[r];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n},wQ=(t,e)=>({classGroupId:t,validator:e}),b4=(t=new Map,e=null,n)=>({nextPart:t,validators:e,classGroupId:n}),f1="-",oR=[],LQ="arbitrary..",PQ=t=>{const e=kQ(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return AQ(o);const c=o.split(f1),u=c[0]===""&&c.length>1?1:0;return C4(c,u,e)},getConflictingClassGroupIds:(o,c)=>{if(c){const u=r[o],h=n[o];return u?h?OQ(h,u):u:h||oR}return n[o]||oR}}},C4=(t,e,n)=>{if(t.length-e===0)return n.classGroupId;const i=t[e],a=n.nextPart.get(i);if(a){const h=C4(t,e+1,a);if(h)return h}const o=n.validators;if(o===null)return;const c=e===0?t.join(f1):t.slice(e).join(f1),u=o.length;for(let h=0;h<u;h++){const m=o[h];if(m.validator(c))return m.classGroupId}},AQ=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=t.slice(1,-1),n=e.indexOf(":"),r=e.slice(0,n);return r?LQ+r:void 0})(),kQ=t=>{const{theme:e,classGroups:n}=t;return UQ(n,e)},UQ=(t,e)=>{const n=b4();for(const r in t){const i=t[r];aS(i,n,r,e)}return n},aS=(t,e,n,r)=>{const i=t.length;for(let a=0;a<i;a++){const o=t[a];BQ(o,e,n,r)}},BQ=(t,e,n,r)=>{if(typeof t=="string"){GQ(t,e,n);return}if(typeof t=="function"){WQ(t,e,n,r);return}FQ(t,e,n,r)},GQ=(t,e,n)=>{const r=t===""?e:N4(e,t);r.classGroupId=n},WQ=(t,e,n,r)=>{if(KQ(t)){aS(t(r),e,n,r);return}e.validators===null&&(e.validators=[]),e.validators.push(wQ(n,t))},FQ=(t,e,n,r)=>{const i=Object.entries(t),a=i.length;for(let o=0;o<a;o++){const[c,u]=i[o];aS(u,N4(e,c),n,r)}},N4=(t,e)=>{let n=t;const r=e.split(f1),i=r.length;for(let a=0;a<i;a++){const o=r[a];let c=n.nextPart.get(o);c||(c=b4(),n.nextPart.set(o,c)),n=c}return n},KQ=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,QQ=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=Object.create(null),r=Object.create(null);const i=(a,o)=>{n[a]=o,e++,e>t&&(e=0,r=n,n=Object.create(null))};return{get(a){let o=n[a];if(o!==void 0)return o;if((o=r[a])!==void 0)return i(a,o),o},set(a,o){a in n?n[a]=o:i(a,o)}}},T2="!",cR=":",YQ=[],dR=(t,e,n,r,i)=>({modifiers:t,hasImportantModifier:e,baseClassName:n,maybePostfixModifierPosition:r,isExternal:i}),VQ=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=i=>{const a=[];let o=0,c=0,u=0,h;const m=i.length;for(let y=0;y<m;y++){const S=i[y];if(o===0&&c===0){if(S===cR){a.push(i.slice(u,y)),u=y+1;continue}if(S==="/"){h=y;continue}}S==="["?o++:S==="]"?o--:S==="("?c++:S===")"&&c--}const _=a.length===0?i:i.slice(u);let p=_,g=!1;_.endsWith(T2)?(p=_.slice(0,-1),g=!0):_.startsWith(T2)&&(p=_.slice(1),g=!0);const C=h&&h>u?h-u:void 0;return dR(a,g,p,C)};if(e){const i=e+cR,a=r;r=o=>o.startsWith(i)?a(o.slice(i.length)):dR(YQ,!1,o,void 0,!0)}if(n){const i=r;r=a=>n({className:a,parseClassName:i})}return r},$Q=t=>{const e=new Map;return t.orderSensitiveModifiers.forEach((n,r)=>{e.set(n,1e6+r)}),n=>{const r=[];let i=[];for(let a=0;a<n.length;a++){const o=n[a],c=o[0]==="[",u=e.has(o);c||u?(i.length>0&&(i.sort(),r.push(...i),i=[]),r.push(o)):i.push(o)}return i.length>0&&(i.sort(),r.push(...i)),r}},zQ=t=>({cache:QQ(t.cacheSize),parseClassName:VQ(t),sortModifiers:$Q(t),...PQ(t)}),HQ=/\s+/,qQ=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:a}=e,o=[],c=t.trim().split(HQ);let u="";for(let h=c.length-1;h>=0;h-=1){const m=c[h],{isExternal:_,modifiers:p,hasImportantModifier:g,baseClassName:C,maybePostfixModifierPosition:y}=n(m);if(_){u=m+(u.length>0?" "+u:u);continue}let S=!!y,v=r(S?C.substring(0,y):C);if(!v){if(!S){u=m+(u.length>0?" "+u:u);continue}if(v=r(C),!v){u=m+(u.length>0?" "+u:u);continue}S=!1}const k=p.length===0?"":p.length===1?p[0]:a(p).join(":"),L=g?k+T2:k,M=L+v;if(o.indexOf(M)>-1)continue;o.push(M);const P=i(v,S);for(let F=0;F<P.length;++F){const G=P[F];o.push(L+G)}u=m+(u.length>0?" "+u:u)}return u},XQ=(...t)=>{let e=0,n,r,i="";for(;e<t.length;)(n=t[e++])&&(r=S4(n))&&(i&&(i+=" "),i+=r);return i},S4=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=S4(t[r]))&&(n&&(n+=" "),n+=e);return n},JQ=(t,...e)=>{let n,r,i,a;const o=u=>{const h=e.reduce((m,_)=>_(m),t());return n=zQ(h),r=n.cache.get,i=n.cache.set,a=c,c(u)},c=u=>{const h=r(u);if(h)return h;const m=qQ(u,n);return i(u,m),m};return a=o,(...u)=>a(XQ(...u))},ZQ=[],Hi=t=>{const e=n=>n[t]||ZQ;return e.isThemeGetter=!0,e},v4=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,E4=/^\((?:(\w[\w-]*):)?(.+)\)$/i,eY=/^\d+\/\d+$/,tY=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sY=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,nY=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,rY=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,iY=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,df=t=>eY.test(t),wn=t=>!!t&&!Number.isNaN(Number(t)),_u=t=>!!t&&Number.isInteger(Number(t)),rC=t=>t.endsWith("%")&&wn(t.slice(0,-1)),ld=t=>tY.test(t),aY=()=>!0,lY=t=>sY.test(t)&&!nY.test(t),D4=()=>!1,oY=t=>rY.test(t),cY=t=>iY.test(t),dY=t=>!Xs(t)&&!Js(t),uY=t=>Cm(t,M4,D4),Xs=t=>v4.test(t),bh=t=>Cm(t,I4,lY),iC=t=>Cm(t,_Y,wn),uR=t=>Cm(t,R4,D4),hY=t=>Cm(t,T4,cY),Jx=t=>Cm(t,j4,oY),Js=t=>E4.test(t),_g=t=>Nm(t,I4),fY=t=>Nm(t,xY),hR=t=>Nm(t,R4),mY=t=>Nm(t,M4),gY=t=>Nm(t,T4),Zx=t=>Nm(t,j4,!0),Cm=(t,e,n)=>{const r=v4.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Nm=(t,e,n=!1)=>{const r=E4.exec(t);return r?r[1]?e(r[1]):n:!1},R4=t=>t==="position"||t==="percentage",T4=t=>t==="image"||t==="url",M4=t=>t==="length"||t==="size"||t==="bg-size",I4=t=>t==="length",_Y=t=>t==="number",xY=t=>t==="family-name",j4=t=>t==="shadow",pY=()=>{const t=Hi("color"),e=Hi("font"),n=Hi("text"),r=Hi("font-weight"),i=Hi("tracking"),a=Hi("leading"),o=Hi("breakpoint"),c=Hi("container"),u=Hi("spacing"),h=Hi("radius"),m=Hi("shadow"),_=Hi("inset-shadow"),p=Hi("text-shadow"),g=Hi("drop-shadow"),C=Hi("blur"),y=Hi("perspective"),S=Hi("aspect"),v=Hi("ease"),k=Hi("animate"),L=()=>["auto","avoid","all","avoid-page","page","left","right","column"],M=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...M(),Js,Xs],F=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto","contain","none"],B=()=>[Js,Xs,u],I=()=>[df,"full","auto",...B()],E=()=>[_u,"none","subgrid",Js,Xs],A=()=>["auto",{span:["full",_u,Js,Xs]},_u,Js,Xs],Y=()=>[_u,"auto",Js,Xs],ee=()=>["auto","min","max","fr",Js,Xs],J=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],H=()=>["start","end","center","stretch","center-safe","end-safe"],V=()=>["auto",...B()],K=()=>[df,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...B()],j=()=>[t,Js,Xs],te=()=>[...M(),hR,uR,{position:[Js,Xs]}],ce=()=>["no-repeat",{repeat:["","x","y","space","round"]}],R=()=>["auto","cover","contain",mY,uY,{size:[Js,Xs]}],O=()=>[rC,_g,bh],U=()=>["","none","full",h,Js,Xs],Q=()=>["",wn,_g,bh],q=()=>["solid","dashed","dotted","double"],$=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],de=()=>[wn,rC,hR,uR],ae=()=>["","none",C,Js,Xs],_e=()=>["none",wn,Js,Xs],ie=()=>["none",wn,Js,Xs],Ne=()=>[wn,Js,Xs],X=()=>[df,"full",...B()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ld],breakpoint:[ld],color:[aY],container:[ld],"drop-shadow":[ld],ease:["in","out","in-out"],font:[dY],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ld],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ld],shadow:[ld],spacing:["px",wn],text:[ld],"text-shadow":[ld],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",df,Xs,Js,S]}],container:["container"],columns:[{columns:[wn,Xs,Js,c]}],"break-after":[{"break-after":L()}],"break-before":[{"break-before":L()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:G()}],"overscroll-x":[{"overscroll-x":G()}],"overscroll-y":[{"overscroll-y":G()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[_u,"auto",Js,Xs]}],basis:[{basis:[df,"full","auto",c,...B()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[wn,df,"auto","initial","none",Xs]}],grow:[{grow:["",wn,Js,Xs]}],shrink:[{shrink:["",wn,Js,Xs]}],order:[{order:[_u,"first","last","none",Js,Xs]}],"grid-cols":[{"grid-cols":E()}],"col-start-end":[{col:A()}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":E()}],"row-start-end":[{row:A()}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ee()}],"auto-rows":[{"auto-rows":ee()}],gap:[{gap:B()}],"gap-x":[{"gap-x":B()}],"gap-y":[{"gap-y":B()}],"justify-content":[{justify:[...J(),"normal"]}],"justify-items":[{"justify-items":[...H(),"normal"]}],"justify-self":[{"justify-self":["auto",...H()]}],"align-content":[{content:["normal",...J()]}],"align-items":[{items:[...H(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...H(),{baseline:["","last"]}]}],"place-content":[{"place-content":J()}],"place-items":[{"place-items":[...H(),"baseline"]}],"place-self":[{"place-self":["auto",...H()]}],p:[{p:B()}],px:[{px:B()}],py:[{py:B()}],ps:[{ps:B()}],pe:[{pe:B()}],pt:[{pt:B()}],pr:[{pr:B()}],pb:[{pb:B()}],pl:[{pl:B()}],m:[{m:V()}],mx:[{mx:V()}],my:[{my:V()}],ms:[{ms:V()}],me:[{me:V()}],mt:[{mt:V()}],mr:[{mr:V()}],mb:[{mb:V()}],ml:[{ml:V()}],"space-x":[{"space-x":B()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":B()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[c,"screen",...K()]}],"min-w":[{"min-w":[c,"screen","none",...K()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...K()]}],h:[{h:["screen","lh",...K()]}],"min-h":[{"min-h":["screen","lh","none",...K()]}],"max-h":[{"max-h":["screen","lh",...K()]}],"font-size":[{text:["base",n,_g,bh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Js,iC]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",rC,Xs]}],"font-family":[{font:[fY,Xs,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Js,Xs]}],"line-clamp":[{"line-clamp":[wn,"none",Js,iC]}],leading:[{leading:[a,...B()]}],"list-image":[{"list-image":["none",Js,Xs]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Js,Xs]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[wn,"from-font","auto",Js,bh]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[wn,"auto",Js,Xs]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Js,Xs]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Js,Xs]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:te()}],"bg-repeat":[{bg:ce()}],"bg-size":[{bg:R()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},_u,Js,Xs],radial:["",Js,Xs],conic:[_u,Js,Xs]},gY,hY]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:O()}],"gradient-via-pos":[{via:O()}],"gradient-to-pos":[{to:O()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:U()}],"rounded-s":[{"rounded-s":U()}],"rounded-e":[{"rounded-e":U()}],"rounded-t":[{"rounded-t":U()}],"rounded-r":[{"rounded-r":U()}],"rounded-b":[{"rounded-b":U()}],"rounded-l":[{"rounded-l":U()}],"rounded-ss":[{"rounded-ss":U()}],"rounded-se":[{"rounded-se":U()}],"rounded-ee":[{"rounded-ee":U()}],"rounded-es":[{"rounded-es":U()}],"rounded-tl":[{"rounded-tl":U()}],"rounded-tr":[{"rounded-tr":U()}],"rounded-br":[{"rounded-br":U()}],"rounded-bl":[{"rounded-bl":U()}],"border-w":[{border:Q()}],"border-w-x":[{"border-x":Q()}],"border-w-y":[{"border-y":Q()}],"border-w-s":[{"border-s":Q()}],"border-w-e":[{"border-e":Q()}],"border-w-t":[{"border-t":Q()}],"border-w-r":[{"border-r":Q()}],"border-w-b":[{"border-b":Q()}],"border-w-l":[{"border-l":Q()}],"divide-x":[{"divide-x":Q()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Q()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[wn,Js,Xs]}],"outline-w":[{outline:["",wn,_g,bh]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",m,Zx,Jx]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",_,Zx,Jx]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[wn,bh]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":Q()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",p,Zx,Jx]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[wn,Js,Xs]}],"mix-blend":[{"mix-blend":[...$(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":$()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[wn]}],"mask-image-linear-from-pos":[{"mask-linear-from":de()}],"mask-image-linear-to-pos":[{"mask-linear-to":de()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":de()}],"mask-image-t-to-pos":[{"mask-t-to":de()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":de()}],"mask-image-r-to-pos":[{"mask-r-to":de()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":de()}],"mask-image-b-to-pos":[{"mask-b-to":de()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":de()}],"mask-image-l-to-pos":[{"mask-l-to":de()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":de()}],"mask-image-x-to-pos":[{"mask-x-to":de()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":de()}],"mask-image-y-to-pos":[{"mask-y-to":de()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[Js,Xs]}],"mask-image-radial-from-pos":[{"mask-radial-from":de()}],"mask-image-radial-to-pos":[{"mask-radial-to":de()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":M()}],"mask-image-conic-pos":[{"mask-conic":[wn]}],"mask-image-conic-from-pos":[{"mask-conic-from":de()}],"mask-image-conic-to-pos":[{"mask-conic-to":de()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:te()}],"mask-repeat":[{mask:ce()}],"mask-size":[{mask:R()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Js,Xs]}],filter:[{filter:["","none",Js,Xs]}],blur:[{blur:ae()}],brightness:[{brightness:[wn,Js,Xs]}],contrast:[{contrast:[wn,Js,Xs]}],"drop-shadow":[{"drop-shadow":["","none",g,Zx,Jx]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",wn,Js,Xs]}],"hue-rotate":[{"hue-rotate":[wn,Js,Xs]}],invert:[{invert:["",wn,Js,Xs]}],saturate:[{saturate:[wn,Js,Xs]}],sepia:[{sepia:["",wn,Js,Xs]}],"backdrop-filter":[{"backdrop-filter":["","none",Js,Xs]}],"backdrop-blur":[{"backdrop-blur":ae()}],"backdrop-brightness":[{"backdrop-brightness":[wn,Js,Xs]}],"backdrop-contrast":[{"backdrop-contrast":[wn,Js,Xs]}],"backdrop-grayscale":[{"backdrop-grayscale":["",wn,Js,Xs]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[wn,Js,Xs]}],"backdrop-invert":[{"backdrop-invert":["",wn,Js,Xs]}],"backdrop-opacity":[{"backdrop-opacity":[wn,Js,Xs]}],"backdrop-saturate":[{"backdrop-saturate":[wn,Js,Xs]}],"backdrop-sepia":[{"backdrop-sepia":["",wn,Js,Xs]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":B()}],"border-spacing-x":[{"border-spacing-x":B()}],"border-spacing-y":[{"border-spacing-y":B()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Js,Xs]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[wn,"initial",Js,Xs]}],ease:[{ease:["linear","initial",v,Js,Xs]}],delay:[{delay:[wn,Js,Xs]}],animate:[{animate:["none",k,Js,Xs]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,Js,Xs]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:_e()}],"rotate-x":[{"rotate-x":_e()}],"rotate-y":[{"rotate-y":_e()}],"rotate-z":[{"rotate-z":_e()}],scale:[{scale:ie()}],"scale-x":[{"scale-x":ie()}],"scale-y":[{"scale-y":ie()}],"scale-z":[{"scale-z":ie()}],"scale-3d":["scale-3d"],skew:[{skew:Ne()}],"skew-x":[{"skew-x":Ne()}],"skew-y":[{"skew-y":Ne()}],transform:[{transform:[Js,Xs,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:X()}],"translate-x":[{"translate-x":X()}],"translate-y":[{"translate-y":X()}],"translate-z":[{"translate-z":X()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Js,Xs]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Js,Xs]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[wn,_g,bh,iC]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},yY=JQ(pY);function lS(...t){return yY(jQ(t))}const O4=IQ,oS=b.forwardRef(({className:t,...e},n)=>s.jsx(_4,{ref:n,className:lS("inline-flex h-10 items-center justify-start rounded-md bg-muted p-1 text-muted-foreground overflow-x-auto scrollbar-hide",t),...e}));oS.displayName=_4.displayName;const cS=b.forwardRef(({className:t,...e},n)=>s.jsx(x4,{ref:n,className:lS("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));cS.displayName=x4.displayName;const lo=b.forwardRef(({className:t,...e},n)=>s.jsx(p4,{ref:n,className:lS("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));lo.displayName=p4.displayName;const w4=t=>Lw({queryKey:["workOrders",t.startDate,t.endDate],queryFn:()=>iA(t),enabled:!!t.startDate&&!!t.endDate,staleTime:120*1e3,gcTime:300*1e3}),bY=({onNavigateToMenu:t,onNavigateToView:e,onNavigateToComingSoon:n,userInfo:r,showToast:i})=>{const{setSelectedWorkItem:a,setSelectedWorkDirection:o}=co(),[c,u]=b.useState(null),[h,m]=b.useState(null),[_,p]=b.useState(null),[g,C]=b.useState(!1),[y,S]=b.useState(null),[v,k]=b.useState(!1),[L,M]=b.useState(null),[P,F]=b.useState(!1),[G,B]=b.useState(null),[I,E]=b.useState({}),[A,Y]=b.useState(!1),{activeTab:ee,setActiveTab:J,workFilters:H,setWorkFilters:V}=co(),[K,j]=b.useState(!1),[te,ce]=b.useState(!0),R=b.useRef(null),O=b.useRef([]),U=b.useRef(null),Q=b.useRef(0),[q,$]=b.useState(!1),[de,ae]=b.useState(()=>{const ge=localStorage.getItem("safety_warning_dismissed");if(ge){const Be=new Date(ge).toDateString(),ue=new Date().toDateString();return Be===ue}return!1}),{showMapView:_e,setShowMapView:ie}=co(),Ne=[{id:"safety-check",title:""},{id:"work-receipt",title:""},{id:"work-result-signal",title:""},{id:"signal-interlock",title:""}],X="YYYY-MM-DD",{startDate:xe,endDate:fe,filter:Z,workTypeFilter:le=""}=H;b.useEffect(()=>{const ge=setTimeout(()=>{if(ee==="work-receipt"){const Be=co.getState().workFilters;co.getState().setWorkFilters({...Be,filter:""})}},100);return()=>clearTimeout(ge)},[ee]);const{data:se=[],isLoading:Re,error:be,refetch:De}=w4({startDate:xe,endDate:fe}),re=(be==null?void 0:be.message)||null,me=ge=>{V({...H,...ge})},ve=ge=>{const Be=hd(ge);me({startDate:Be.startOf("month").format(X),endDate:Be.endOf("month").format(X)})},et=ge=>{const Be=hd(ge);me({startDate:Be.startOf("month").format(X),endDate:Be.endOf("month").format(X)})},Dt=()=>{const ge=hd(xe).subtract(1,"month");me({startDate:ge.startOf("month").format(X),endDate:ge.endOf("month").format(X)})},ot=()=>{const ge=hd(xe).add(1,"month");me({startDate:ge.startOf("month").format(X),endDate:ge.endOf("month").format(X)})};b.useEffect(()=>{if(!qn()&&se.length>0){Y(!0);const ge={};se.forEach(Be=>{const ue=eA(Be.PROD_GRPS,Be.WRK_STATS);ue&&ue.total>0?ge[Be.id]=ue:ge[Be.id]={total:1,pending:1,completed:0,cancelled:0,pendingByProdGrp:{},completedByProdGrp:{}}}),E(ge),Y(!1)}else se.length===0&&Y(!1)},[se]),b.useEffect(()=>{if(ee==="work-receipt"){const ge=hd(xe),Be=hd(fe),ue=ge.date()===1,we=Be.date()===Be.endOf("month").date();if(!ue||!we){const Je=hd();me({startDate:Je.startOf("month").format(X),endDate:Je.endOf("month").format(X)})}}},[ee]),b.useEffect(()=>{ee==="work-receipt"&&(async()=>{if(r!=null&&r.userId)try{const Be=await RM(r.userId),ue=Be&&Be.length>0;$(!ue)}catch(Be){console.error("  :",Be),$(!1)}})()},[r,ee]),b.useEffect(()=>{const ge=U.current;if(!ge)return;let Be=!1,ue=null;const we=Nt=>{ue&&clearTimeout(ue),ue=setTimeout(()=>{ce(Oe=>Oe===Nt?Oe:Nt)},50)},Je=()=>{const Nt=ge.scrollTop,Oe=Nt-Q.current,dt=ge.scrollHeight-ge.clientHeight;if(dt<=30){we(!0),Q.current=Nt,Be=!1;return}const gt=Nt>=dt-10,It=Nt<=10;if(gt||It){Q.current=Nt,Be=!1;return}if(Math.abs(Oe)<15){Be=!1;return}Oe>0&&Nt>80?we(!1):Oe<-5&&we(!0),Q.current=Nt,Be=!1},Pe=()=>{Be||(requestAnimationFrame(Je),Be=!0)};return ge.addEventListener("scroll",Pe,{passive:!0}),()=>{ge.removeEventListener("scroll",Pe),ue&&clearTimeout(ue)}},[]);const At=async(ge,Be)=>{await De(),c&&c.id===ge&&u(null)},ct=ge=>{o(ge),e?e("work-item-list"):m(ge)},Ge=ge=>{var we,Je,Pe;const Be=Nt=>Nt?Nt.includes("T")||Nt.includes("-")?Nt.replace(/[-:T]/g,"").substring(0,12):Nt:"",ue={SO_ID:ge.SO_ID||"",CUST_ID:ge.CUST_ID||((we=ge.customer)==null?void 0:we.id)||"",CUST_NM:((Je=ge.customer)==null?void 0:Je.name)||"",SMS_RCV_TEL:((Pe=ge.customer)==null?void 0:Pe.phone)||ge.REQ_CUST_TEL_NO||"",SMS_SEND_TEL:"",WRK_HOPE_DTTM:Be(ge.scheduledAt),WRKR_NM:(r==null?void 0:r.userName)||"",WRKR_NM_EN:(r==null?void 0:r.userNameEn)||(r==null?void 0:r.userName)||"",WRK_CD:ge.WRK_CD||"",WRK_CD_NM:ge.typeDisplay||"",WRK_DRCTN_ID:ge.WRK_DRCTN_ID||ge.id||"",RCPT_ID:ge.RCPT_ID||""};M(ue),k(!0)},at=ge=>{B(ge),F(!0)},xt=()=>{De()},mt=async ge=>{if(y){setIsLoading(!0),C(!1);try{const Be=await tN(ge);Be.code==="SUCCESS"||Be.code==="OK"?(i&&i("  .","success"),await At(y.id,gn.Cancelled)):i&&i(` : ${Be.message}`,"error",!0)}catch(Be){console.error(" :",Be);const ue=Be instanceof Qs?Be.message:Be.message||"   .";i&&i(ue,"error",!0)}finally{setIsLoading(!1),S(null)}}},Ve=ge=>{a(ge),e?e("work-complete-form"):p(ge)},it=async()=>{p(null),u(null),await De(),i&&i("  .","success")};if(!e){if(_)return s.jsx(Fp,{order:_,onBack:()=>p(null),onSuccess:it,showToast:i});if(h)return s.jsx(qM,{direction:h,onBack:()=>m(null)});if(c)return s.jsx(BM,{order:c,onBack:()=>u(null),onUpdateStatus:At,onComplete:Ve},c.id)}const Fe=se.filter(ge=>{if(Z!==""){const Be=I[ge.id],ue=(Be==null?void 0:Be.isEmpty)===!0;if(Z===gn.Cancelled){if(ge.status!==gn.Cancelled&&!ue)return!1}else if(ue||ge.status!==Z)return!1}return!(le&&le!==""&&ge.WRK_CD_NM!==le)}),nt=()=>{let ge=0;return Z!==""&&ge++,le!==""&&ge++,ge},lt=()=>{me({filter:"",workTypeFilter:""})},Mt=Fe,ut=ge=>ge===""?se.length:se.filter(Be=>{const ue=I[Be.id],we=(ue==null?void 0:ue.isEmpty)===!0;return ge===gn.Cancelled?Be.status===gn.Cancelled||we:we?!1:Be.status===ge}).length,qe=ge=>{J(ge);const Be=()=>{const we=R.current;if(!we)return;const Je=Ne.findIndex(dt=>dt.id===ge),Pe=O.current[Je];if(!Pe)return;const Nt=we.getBoundingClientRect().width,Oe=Pe.offsetLeft-Nt/2+Pe.offsetWidth/2;we.scrollTo({left:Oe,behavior:"smooth"})};if(typeof window<"u"&&("requestAnimationFrame"in window?requestAnimationFrame(Be):setTimeout(Be,50)),!["work-receipt","safety-check","signal-interlock","work-result-signal","lgu-construction","lgu-network-fault"].includes(ge)){const we=Ne.find(Je=>Je.id===ge);we&&n&&n(we.title)}},Ee={:1,:2,"A/S":3,:4,:5,:6,:7,:8,:9},Ye=b.useMemo(()=>{const ge=new Set;se.forEach(ue=>{ue.WRK_CD_NM&&ge.add(ue.WRK_CD_NM)});const Be=Array.from(ge).sort((ue,we)=>{const Je=Ee[ue]??99,Pe=Ee[we]??99;return Je-Pe});return[{value:"",label:""},...Be.map(ue=>({value:ue,label:ue}))]},[se]);b.useEffect(()=>{const ge=Ye.map(Be=>Be.value);le&&!ge.includes(le)&&me({workTypeFilter:""})},[Ye,le]);const pe=b.useMemo(()=>[{value:"",label:` (${ut("")})`,shortLabel:""},{value:gn.Pending,label:` (${ut(gn.Pending)})`,shortLabel:""},{value:gn.Completed,label:` (${ut(gn.Completed)})`,shortLabel:""},{value:gn.Cancelled,label:` (${ut(gn.Cancelled)})`,shortLabel:""}],[se]);return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col overflow-hidden",children:[s.jsxs(O4,{value:ee,onValueChange:qe,className:"w-full flex flex-col h-full overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200",children:s.jsx(oS,{ref:R,className:"w-full justify-start bg-white rounded-none h-auto py-2 px-3 overflow-x-auto border-none",children:Ne.map((ge,Be)=>s.jsx(cS,{value:ge.id,ref:ue=>O.current[Be]=ue,className:"data-[state=active]:bg-blue-500 data-[state=active]:text-white data-[state=inactive]:text-gray-600 rounded-full px-4 py-2 text-sm font-medium flex-shrink-0 mx-1 transition-colors",children:ge.title},ge.id))})}),s.jsxs(lo,{value:"work-receipt",className:"flex-1 data-[state=active]:flex flex-col overflow-hidden",children:[s.jsx("div",{className:`flex-shrink-0 bg-gray-50 grid transition-[grid-template-rows] duration-300 ease-out ${te?"grid-rows-[1fr]":"grid-rows-[0fr]"}`,style:{willChange:"grid-template-rows"},children:s.jsxs("div",{className:`min-h-0 overflow-hidden px-3 pt-1 transition-opacity duration-200 ${te?"opacity-100":"opacity-0"}`,children:[q&&!de&&s.jsx("div",{className:"mb-3 bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-lg shadow-sm",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(go,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsx("div",{children:s.jsx("h3",{className:"text-sm font-semibold text-yellow-800",children:"   ."})})]}),s.jsx("button",{onClick:()=>{ae(!0),localStorage.setItem("safety_warning_dismissed",new Date().toISOString())},className:"text-yellow-600 hover:text-yellow-800 transition-colors",title:"",children:s.jsx(Mi,{className:"w-4 h-4"})})]})}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 mb-3 overflow-hidden",children:[s.jsx("div",{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{onClick:Dt,className:"p-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors",children:s.jsx(pM,{className:"w-5 h-5 text-gray-500"})}),s.jsxs("div",{className:"flex-1 flex items-center justify-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:xe,onChange:ge=>ve(ge.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",style:{colorScheme:"light"}}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:new Date(xe).toLocaleDateString("ko-KR",{month:"short",day:"numeric"})})]}),s.jsx("span",{className:"text-gray-300",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"date",value:fe,onChange:ge=>et(ge.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",style:{colorScheme:"light"}}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:new Date(fe).toLocaleDateString("ko-KR",{month:"short",day:"numeric"})})]})]}),s.jsx("button",{onClick:ot,className:"p-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors",children:s.jsx(cL,{className:"w-5 h-5 text-gray-500"})})]})}),s.jsxs("button",{onClick:()=>j(!K),className:"w-full px-4 py-2.5 flex items-center justify-between border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"text-sm text-gray-600",children:""}),nt()>0&&s.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500 text-white text-xs font-medium rounded-full",children:nt()})]}),s.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${K?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),K&&s.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:""}),s.jsx(sn,{value:Z,onValueChange:ge=>me({filter:ge}),options:pe})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:""}),s.jsx(sn,{value:le,onValueChange:ge=>me({workTypeFilter:ge}),options:Ye})]}),s.jsx("button",{onClick:lt,className:`p-2 rounded-lg transition-colors flex-shrink-0 ${nt()>0?"text-blue-600 bg-blue-50 hover:bg-blue-100":"text-gray-400 bg-gray-100"}`,title:" ",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),s.jsxs("div",{ref:U,className:"flex-1 overflow-y-auto px-3 pb-4",children:[Re||A?s.jsx(wf,{size:"medium",message:Re?"   ...":"   ..."}):re?s.jsx(uN,{type:"error",message:re,onRetry:()=>De()}):s.jsx("div",{children:Fe.length>0?s.jsx("div",{className:"space-y-3",children:Mt.map((ge,Be)=>s.jsx(WP,{direction:ge,index:Be+1,onSelect:ct,onSms:Ge,onWorkerAdjust:at,workStatusCounts:I[ge.id]},ge.id))}):s.jsxs("div",{className:"text-center py-10 sm:py-12 px-4 sm:px-6 bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(C1,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2 whitespace-nowrap",children:"   "})]})}),y&&s.jsx(rN,{isOpen:g,onClose:()=>{C(!1),S(null)},onConfirm:mt,workOrder:y,userId:r==null?void 0:r.userId,showToast:i}),s.jsx(XM,{isOpen:v,onClose:()=>k(!1),smsData:L,userId:(r==null?void 0:r.userId)||""}),G&&s.jsx(JM,{isOpen:P,onClose:()=>{F(!1),B(null)},direction:G,onSuccess:xt,showToast:i,userInfo:r})]})]}),s.jsx(lo,{value:"safety-check",className:"px-3 pt-1 overflow-y-auto",children:s.jsx(V6,{onBack:t,userInfo:r,showToast:i})}),s.jsx(lo,{value:"work-result-signal",className:"px-3 pt-1 overflow-y-auto",children:s.jsx($6,{onBack:t})}),s.jsx(lo,{value:"signal-interlock",className:"mt-0 flex-1 data-[state=active]:flex flex-col overflow-hidden",children:s.jsx(ZM,{onBack:t,userInfo:r,showToast:i})})]}),ee==="work-receipt"&&!Re&&!re&&Fe.length>0&&s.jsx(eI,{onClick:()=>ie(!0),workCount:Fe.length}),_e&&s.jsx(zj,{workOrders:Fe,onBack:()=>ie(!1),onSelectWork:ge=>{ie(!1),ct(ge)}})]})},CY=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.286zm0 13.036h.008v.008h-.008v-.008z"})}),NY=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 00-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H4.5a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})}),SY=t=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),vY=t=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})}),EY=({onLogin:t})=>{const[e,n]=b.useState("A20117965"),[r,i]=b.useState("dlive12!@#$"),[a,o]=b.useState(!1),[c,u]=b.useState(!1),[h,m]=b.useState(null),[_,p]=b.useState(!1),g=async(S,v=!1)=>{if(S.preventDefault(),!(!e||!r)){u(!0),m(null),p(!1);try{const k=await _E(e,r,v?"Y":"N");if(console.log("[Login] API :",k),console.log("[Login] telNo2:",k.telNo2),k.LOGIN_DUP_YN==="Y"||k.code==="LOGIN_DUP"){p(!0),u(!1);return}k.ok?(localStorage.removeItem("demoMode"),t(k.userId,k.userName,k.userNameEn,k.userRole,k.crrId,k.soId,k.mstSoId,k.telNo2,k.AUTH_SO_List)):m(" .")}catch(k){k.message&&k.message.includes("401")?m("   ."):k.message&&k.message.includes("400")?m("   ."):m("   ."),console.error(" :",k)}finally{u(!1)}}},C=async()=>{u(!0),p(!1);try{const S=await _E(e,r,"Y");console.log("[Login]   :",S),S.ok?(localStorage.removeItem("demoMode"),t(S.userId,S.userName,S.userNameEn,S.userRole,S.crrId,S.soId,S.mstSoId,S.telNo2,S.AUTH_SO_List)):m(" .")}catch(S){m("   ."),console.error("  :",S)}finally{u(!1)}},y="w-full py-3 bg-white border border-gray-200 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition";return s.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 font-sans bg-gray-100",children:[s.jsxs("div",{className:"w-full max-w-sm mx-auto bg-white rounded-2xl shadow-xl p-8 space-y-8",children:[s.jsx("div",{className:"text-center space-y-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h1",{className:"text-4xl font-bold tracking-wider text-blue-600",children:"D'LIVE"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"CONA"})]})}),s.jsxs("form",{onSubmit:g,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"username",className:"sr-only",children:" ID"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:s.jsx(CY,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:`${y} pl-10 pr-3`,placeholder:" ID",value:e,onChange:S=>n(S.target.value)})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:s.jsx(NY,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{id:"password",name:"password",type:a?"text":"password",required:!0,className:`${y} pl-10 pr-10`,placeholder:"",value:r,onChange:S=>i(S.target.value)}),s.jsx("div",{className:"absolute inset-y-0 right-0 pr-3.5 flex items-center",children:s.jsx("button",{type:"button",onClick:()=>o(!a),className:"text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":a?" ":" ",children:a?s.jsx(vY,{className:"h-5 w-5"}):s.jsx(SY,{className:"h-5 w-5"})})})]})]}),h&&s.jsx("div",{className:"text-red-500 text-sm text-center bg-red-50 p-3 rounded-lg",children:h}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("button",{type:"submit",disabled:c,className:"w-full flex justify-center py-3 px-4 border border-transparent text-base font-bold rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:c?" ...":""}),s.jsxs("button",{type:"button",onClick:()=>{localStorage.setItem("demoMode","true"),t("demo","demo","demo")},className:"w-full flex items-center justify-center gap-2 py-2 px-4 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors shadow-sm",children:[s.jsx(yP,{className:"w-4 h-4"}),"UI  "]})]})]}),s.jsxs("div",{className:"mt-8 text-center",children:[s.jsx("div",{className:"mb-3",children:s.jsx("p",{className:"text-sm font-medium tracking-wide text-blue-600",children:"Smart Life Coordinator"})}),s.jsx("p",{className:"text-xs font-semibold text-blue-600",children:"COPYRIGHT 2025. D'LIVE CO. LTD"})]})]}),_&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"   "}),s.jsxs("p",{className:"text-sm text-gray-600",children:["     .",s.jsx("br",{}),"     ."]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>p(!1),className:"flex-1 py-2.5 px-4 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition",children:""}),s.jsx("button",{onClick:C,disabled:c,className:"flex-1 py-2.5 px-4 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:c?" ...":" "})]})]})})]})},DY=[{id:"work-management",title:" ",description:"   ",icon:s.jsx(Gu,{className:"h-10 w-10 text-white"})},{id:"customer-management",title:" ",description:"    ",icon:s.jsx(SM,{className:"h-10 w-10 text-white"})},{id:"equipment-management",title:" ",description:" , ,  ",icon:s.jsx(rm,{className:"h-10 w-10 text-white"})},{id:"other-management",title:" ",description:"     ",icon:s.jsx(J2,{className:"h-10 w-10 text-white"})}],fR=({onSelectMenu:t})=>{const e=n=>{switch(n){case"work-management":t("work-management");break;case"customer-management":t("customer-management");break;case"equipment-management":t("equipment-management");break;case"other-management":t("other-management");break;default:t("coming-soon")}};return s.jsx("div",{className:"px-4 pt-8",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:DY.map((n,r)=>s.jsxs("button",{onClick:()=>e(n.id),className:"group text-left p-6 bg-white rounded-xl shadow-lg hover:shadow-cyan-500/30 transition-all duration-300 transform hover:-translate-y-1 flex items-center space-x-6",style:{animationDelay:`${r*100}ms`},children:[s.jsx("div",{className:"bg-gradient-to-br from-cyan-400 to-cyan-500 rounded-lg p-4 group-hover:scale-110 transition-transform",children:n.icon}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800 group-hover:text-cyan-500 transition-colors",children:n.title}),s.jsx("p",{className:"text-gray-500 mt-1",children:n.description})]})]},n.id))})})},dS=({tabs:t,activeTab:e,onTabChange:n,className:r=""})=>{const i=b.useRef(null),a=b.useRef([]);return s.jsx("div",{className:`
        bg-white border-b border-gray-200
        ${r}
      `,children:s.jsx("div",{ref:i,className:"w-full justify-start bg-white rounded-none h-auto py-2 px-3 overflow-x-auto border-none",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:s.jsx("div",{className:"flex",children:t.map((o,c)=>s.jsx("button",{ref:u=>a.current[c]=u,onClick:()=>n(o.id),className:`
                rounded-full px-4 py-2 text-sm font-medium flex-shrink-0 mx-1 transition-colors
                ${e===o.id?"bg-blue-500 text-white":"text-gray-600"}
              `,children:o.title},o.id))})})})},jg=({onNavigateToMenu:t,title:e="  .",description:n="    .  !",category:r})=>{const[i,a]=b.useState(""),c=(()=>{switch(r){case"customer-management":return[{id:"customer-info",title:"",description:"    "},{id:"business-bot",title:"",description:"   "}];case"equipment-management":return[{id:"equipment-assignment",title:"/",description:"    "},{id:"equipment-status",title:"",description:"  "},{id:"equipment-movement",title:" ",description:"    "},{id:"equipment-recovery",title:"  ",description:"   "}];case"other-management":return[{id:"overtime-application",title:"",description:"  "},{id:"overtime-input",title:"",description:"   "},{id:"announcements",title:"",description:" "}];default:return[]}})(),u=c.length>0;Ji.useEffect(()=>{u&&!i&&a(c[0].id)},[u,i,c]);const h=m=>{a(m)};return s.jsxs("div",{className:"",children:[u&&s.jsx(dS,{tabs:c,activeTab:i,onTabChange:h}),s.jsxs("div",{className:"text-center p-10 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e}),s.jsx("p",{className:"text-gray-600 mb-8",children:n}),s.jsx("button",{onClick:t,className:"px-6 py-2 bg-cyan-500 text-white font-bold rounded-md hover:bg-cyan-600 transition-colors",children:"  "})]})]})},RY=({currentView:t,onNavigate:e,onSelectMenu:n})=>{const r=a=>{n(a),e==null||e(a)},i=[{id:"work-management",label:"",icon:C1},{id:"customer-management",label:"",icon:DP},{id:"equipment-management",label:"",icon:Jw},{id:"other-management",label:"",icon:bM}];return s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-200 z-50",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex h-[52px]",children:i.map(a=>{const o=t===a.id,c=a.icon;return s.jsxs("button",{onClick:()=>r(a.id),className:"flex-1 flex flex-col items-center justify-center gap-0.5 px-2 py-1 transition-all duration-200 active:scale-95 touch-manipulation",children:[s.jsx(c,{className:`
                    transition-all duration-200
                    ${o?"h-5 w-5 text-blue-600":"h-5 w-5 text-gray-500"}
                  `,strokeWidth:o?2.5:2}),s.jsx("span",{className:`
                    text-[10px] transition-all duration-200
                    ${o?"text-blue-600 font-bold":"text-gray-500 font-medium"}
                  `,children:a.label})]},a.id)})})})})},Cc=({label:t,value:e,children:n})=>s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("td",{className:"px-2 py-2 text-xs sm:text-sm font-medium text-gray-700 bg-blue-100 border-r border-gray-200 w-1/3",children:t}),s.jsx("td",{className:"px-2 py-2 text-xs sm:text-sm text-gray-900 w-2/3",children:n||e||"-"})]}),TY=t=>({1:"",2:"",3:"",4:"",7:"",9:""})[t||""]||t||"-",MY=t=>{if(!t)return new Date().toLocaleString("ko-KR");if(t.length>=8){const e=t.slice(0,4),n=t.slice(4,6),r=t.slice(6,8);if(t.length>=14){const i=t.slice(8,10),a=t.slice(10,12);return`${e}-${n}-${r} ${i}:${a}`}return`${e}-${n}-${r}`}return t},IY=({order:t,onBack:e})=>{var a,o,c,u;const n=localStorage.getItem("userInfo"),r=n?JSON.parse(n):{},i=r.userName||r.userId||"";return s.jsx("div",{className:"h-full overflow-y-auto max-w-4xl mx-auto p-2 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"bg-blue-600 text-white px-3 py-2 text-sm sm:text-base font-semibold",children:[t6(t.WRK_CD)," [1.]"]}),s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden",children:s.jsx("table",{className:"w-full",children:s.jsxs("tbody",{children:[s.jsx(Cc,{label:"",value:t.PROD_NM||t.productName||"-"}),s.jsx(Cc,{label:"",value:t.WRK_CD?`${t.WRK_CD} (${t.WRK_CD_NM||t.typeDisplay||""})`:"-"}),s.jsx(Cc,{label:"",value:((a=t.customer)==null?void 0:a.id)||t.CUST_ID||"-"}),s.jsx(Cc,{label:"",value:((o=t.customer)==null?void 0:o.name)||"-"}),s.jsx(Cc,{label:"",value:((c=t.customer)==null?void 0:c.phone)||"-"}),s.jsx(Cc,{label:"",value:t.CTRT_ID||"-"}),s.jsx(Cc,{label:"",value:t.installLocation||"-"}),s.jsx(Cc,{label:"CELL NO",value:t.cellNo||"-"}),s.jsx(Cc,{label:"",value:((u=t.customer)==null?void 0:u.address)||"-"}),s.jsx(Cc,{label:"",value:t.SO_NM||"-"})]})})}),s.jsxs("div",{className:"mt-4",children:[gf(t.WRK_CD)&&s.jsxs("div",{className:"bg-green-50 border border-green-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-green-800 mb-2 flex items-center gap-1",children:[s.jsx(ea,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-green-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    ( )"})]})]}),_f(t.WRK_CD)&&s.jsxs("div",{className:"bg-orange-50 border border-orange-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-orange-800 mb-2 flex items-center gap-1",children:[s.jsx(Gu,{size:16}),"A/S   "]}),s.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[s.jsx("li",{children:" /    "}),s.jsx("li",{children:" A/S      "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "})]})]}),(wg(t.WRK_CD)||Lg(t.WRK_CD))&&s.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-red-800 mb-2 flex items-center gap-1",children:[s.jsx(rm,{size:16}),"/  "]}),s.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsxs("li",{children:[" ",wg(t.WRK_CD)?"()    ":"  "]}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "})]})]}),gp(t.WRK_CD)&&s.jsxs("div",{className:"bg-purple-50 border border-purple-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-purple-800 mb-2 flex items-center gap-1",children:[s.jsx(Oc,{size:16}),"  "]}),s.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"     ( )"}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),Lg(t.WRK_CD)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-blue-800 mb-2 flex items-center gap-1",children:[s.jsx(Ed,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),kM(t.WRK_CD,t.WRK_DTL_TCD)&&s.jsxs("div",{className:"bg-orange-50 border border-orange-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-orange-800 mb-2 flex items-center gap-1",children:[s.jsx(HL,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    (:20)"}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"     "})]})]}),UM(t.WRK_CD,t.WRK_DTL_TCD)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-3 mb-3",children:[s.jsxs("h4",{className:"text-xs sm:text-sm font-semibold text-blue-800 mb-2 flex items-center gap-1",children:[s.jsx(ea,{size:16}),"   "]}),s.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    (:30/37)"}),s.jsx("li",{children:"   "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]}),t.WRK_CD==="06"&&s.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[s.jsx("li",{children:"    "}),s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "})]})]}),t.WRK_CD==="04"&&s.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[s.jsxs("li",{children:[" ",t.WRK_DTL_TCD==="0430"?" ":t.WRK_DTL_TCD==="0440"?" ":"  "]}),s.jsx("li",{children:"   "}),s.jsx("li",{children:"   "})]})]}),t.WRK_CD==="09"&&s.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-800 mb-2",children:"   "}),s.jsxs("ul",{className:"text-xs text-gray-700 space-y-1",children:[s.jsx("li",{children:"     "}),s.jsx("li",{children:"    "}),s.jsx("li",{children:"    "})]})]})]}),t.MEMO&&s.jsxs("div",{className:"mt-4 bg-gray-50 p-3 rounded-lg",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 whitespace-pre-wrap",children:t.MEMO})]}),s.jsxs("div",{className:"mt-4 bg-green-50 border border-green-300 rounded-lg p-3",children:[s.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-green-800 mb-2",children:" "}),s.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-green-700",children:[s.jsxs("div",{children:[": ",MY(t.WRKR_CMPL_DT||t.WRK_END_DTTM)]}),s.jsxs("div",{children:[": ",i]}),s.jsxs("div",{children:[" ID: ",t.id]}),t.WRK_CD&&s.jsxs("div",{children:[" : ",t.WRK_CD," (",t.WRK_CD_NM||t.typeDisplay,")"]}),t.CTRT_ID&&s.jsxs("div",{children:[" ID: ",t.CTRT_ID]}),s.jsxs("div",{children:[": ",TY(t.WRK_STAT_CD)]})]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:e,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors text-sm sm:text-base",children:""})})]})]})})},jY=({onNavigateToView:t,onNavigateToComingSoon:e,userInfo:n,showToast:r})=>{const{setSelectedWorkItem:i,setSelectedWorkDirection:a}=co(),[o,c]=b.useState(!1),[u,h]=b.useState(!1),[m,_]=b.useState(null),[p,g]=b.useState(!1),[C,y]=b.useState(null),{workFilters:S}=co(),{startDate:v,endDate:k}=S,L=new Date,M=L.toISOString().split("T")[0],{data:P=[],isLoading:F,error:G,refetch:B}=w4({startDate:v,endDate:k}),I=P.filter(R=>R.scheduledAt?R.scheduledAt.split("T")[0]===M:!1),E=(G==null?void 0:G.message)||null,Y=(R=>{const O=["","","","","","",""],U=R.getFullYear(),Q=R.getMonth()+1,q=R.getDate(),$=O[R.getDay()];return{full:`${U} ${Q} ${q} (${$})`,short:`${Q} ${q}`}})(L),ee={pending:I.filter(R=>R.status===gn.Pending),completed:I.filter(R=>R.status===gn.Completed),cancelled:I.filter(R=>R.status===gn.Cancelled)},J=R=>{a(R),t&&t("work-item-list")},H=(R,O)=>{R.stopPropagation(),O?window.location.href=`tel:${O}`:r&&r(" .","warning")},V=(R,O)=>{R.stopPropagation(),y(O),g(!0)},K=(R,O)=>{R.stopPropagation();const U=q=>q?q.includes("T")||q.includes("-")?q.replace(/[-:T]/g,"").substring(0,12):q:"",Q={SO_ID:O.SO_ID||"328",CUST_ID:O.CUST_ID||O.customer.id||"",CUST_NM:O.customer.name||"",SMS_RCV_TEL:O.customer.phone||"",SMS_SEND_TEL:"",WRK_HOPE_DTTM:U(O.scheduledAt),WRKR_NM:(n==null?void 0:n.userName)||"",WRKR_NM_EN:(n==null?void 0:n.userNameEn)||(n==null?void 0:n.userName)||"",WRK_CD:O.WRK_CD||"",WRK_CD_NM:O.typeDisplay||"",WRK_DRCTN_ID:O.WRK_DRCTN_ID||O.id||"",RCPT_ID:O.RCPT_ID||""};_(Q),h(!0)},j=R=>{switch(R){case gn.Pending:return"bg-blue-100 text-blue-800 border-blue-300";case gn.Completed:return"bg-green-100 text-green-800 border-green-300";case gn.Cancelled:return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-700 border-gray-300"}},te=(R,O)=>s.jsx("div",{onClick:()=>J(R),className:"bg-white rounded-xl shadow-sm hover:shadow-md border border-gray-100 transition-all duration-200 cursor-pointer active:scale-[0.99] mb-3 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[O!==void 0&&s.jsx("div",{className:"flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full bg-blue-500 text-white text-sm font-bold",children:O}),s.jsxs("h3",{className:"font-bold text-gray-900 text-base truncate",children:[R.customer.name,R.customer.id&&s.jsxs("span",{className:"text-gray-400 font-normal ml-1",children:["(",R.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),s.jsx(Z2,{customer:R.customer})]}),s.jsx("div",{className:"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end",children:s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${j(R.status)}`,children:R.status})})]}),s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-blue-50 text-blue-700 border border-blue-200",children:R.typeDisplay}),R.WRK_CD==="04"&&R.WRK_DTL_TCD==="0440"&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-cyan-50 text-cyan-700 border border-cyan-200",children:""})]}),s.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:R.scheduledAt?new Date(R.scheduledAt).toLocaleString("ko-KR",{month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):" "})]})]}),s.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[s.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:R.customer.address||"  "})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("button",{onClick:U=>H(U,R.customer.phone),className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),""]}),s.jsxs("button",{onClick:U=>K(U,R),className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),""]}),s.jsxs("button",{onClick:U=>V(U,R),className:"flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-sm font-medium flex-1",children:[s.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"whitespace-nowrap",children:""})]})]})]})},R.id),ce=(R,O,U,Q,q)=>O.length===0?null:s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:`flex items-center justify-between mb-3 px-4 py-2 rounded-lg ${U} shadow-sm`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[q,s.jsx("h3",{className:`font-bold text-base ${Q}`,children:R})]}),s.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full bg-white ${Q} font-bold text-sm shadow-sm`,children:O.length})]}),s.jsx("div",{className:"space-y-3",children:O.map(($,de)=>te($,de+1))})]});return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-blue-600 text-white shadow-lg z-30",children:s.jsx("div",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(nm,{className:"w-5 h-5"}),s.jsx("h1",{className:"text-xl font-bold",children:" "})]}),s.jsx("p",{className:"text-blue-100 text-sm",children:Y.full})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-3xl font-bold",children:I.length}),s.jsx("div",{className:"text-xs text-blue-100",children:" "})]})]})})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-3 py-4",children:F?s.jsx(wf,{size:"medium",message:"   ..."}):E?s.jsx(uN,{type:"error",message:E,onRetry:()=>window.location.reload()}):I.length===0?s.jsx("div",{className:"text-center py-16 px-6",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8 mx-auto max-w-sm border border-gray-200",children:[s.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(nm,{className:"w-10 h-10 text-blue-600"})}),s.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-800 mb-2 whitespace-nowrap",children:"   "}),s.jsx("p",{className:"text-gray-500",children:"  !"})]})}):s.jsxs("div",{children:[ce("",ee.pending,"bg-blue-100","text-blue-700",s.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:s.jsx(wp,{className:"w-4 h-4 text-white"})})),ce("",ee.completed,"bg-green-100","text-green-700",s.jsx("div",{className:"w-6 h-6 rounded-full bg-green-600 flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})),ce("",ee.cancelled,"bg-red-100","text-red-700",s.jsx("div",{className:"w-6 h-6 rounded-full bg-red-600 flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}))]})}),!F&&!E&&I.length>0&&s.jsx("div",{className:"flex-shrink-0 bg-white border-t border-gray-200 shadow-lg px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-around text-center max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:ee.pending.length}),s.jsx("div",{className:"text-xs text-gray-600",children:""})]}),s.jsx("div",{className:"w-px h-10 bg-gray-300"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:ee.completed.length}),s.jsx("div",{className:"text-xs text-gray-600",children:""})]}),s.jsx("div",{className:"w-px h-10 bg-gray-300"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:ee.cancelled.length}),s.jsx("div",{className:"text-xs text-gray-600",children:""})]})]})}),!F&&!E&&I.length>0&&s.jsx(eI,{onClick:()=>c(!0),workCount:I.length}),o&&s.jsx(zj,{workOrders:I,onBack:()=>c(!1),onSelectWork:R=>{c(!1),J(R)}}),s.jsx(XM,{isOpen:u,onClose:()=>h(!1),smsData:m,userId:(n==null?void 0:n.userId)||""}),C&&s.jsx(JM,{isOpen:p,onClose:()=>{g(!1),y(null)},direction:C,onSuccess:()=>{B()},showToast:r,userInfo:n})]})},OY=({workItem:t,onNext:e,onBack:n})=>{var ce,R,O,U,Q;const[r,i]=b.useState(null),[a,o]=b.useState(!1),[c,u]=b.useState(null),[h,m]=b.useState(null),[_,p]=b.useState(!1),[g,C]=b.useState([]),y=t.WRK_CD==="05",S=t.WRK_CD==="07",v=t.WRK_CD==="08",k=S||v,[L,M]=b.useState(null),[P,F]=b.useState(!1),[G,B]=b.useState(null);b.useEffect(()=>{(async()=>{const $=y&&t.DTL_CTRT_ID?t.DTL_CTRT_ID:t.CTRT_ID;if(!$){console.log("[ContractInfo] CTRT_ID  - getCtrtDetailInfo ");return}o(!0),u(null);try{console.log("[ContractInfo] getCtrtDetailInfo  :",{CTRT_ID:$,CUST_ID:t.CUST_ID,isProductChange:y,DTL_CTRT_ID:t.DTL_CTRT_ID});const de=await OM($,t.CUST_ID);if(de&&(console.log("[ContractInfo] getCtrtDetailInfo :",de),i({PROM_CNT:de.PROM_CNT,CTRT_APLY_STRT_DT:de.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:de.CTRT_APLY_END_DT,GRP_ID:de.GRP_ID,GRP_NM:de.GRP_NM,IP_CNT:de.IP_CNT,SO_NM:de.SO_NM,BASIC_PROD_CD_NM:de.BASIC_PROD_CD_NM})),y&&t.CUST_ID){console.log("[ContractInfo]  - getFullContractInfo  ");const ae=await TM({CUST_ID:t.CUST_ID,CTRT_ID:t.CTRT_ID});console.log("[ContractInfo] getFullContractInfo :",ae),C(ae.contracts||[])}}catch(de){console.error("[ContractInfo]    :",de),u(de.message||"   .")}finally{o(!1)}})()},[y,t.CUST_ID,t.CTRT_ID,t.DTL_CTRT_ID]),b.useEffect(()=>{(async()=>{if(!t.CUST_ID){console.log("[ContractInfo] CUST_ID  -    ");return}p(!0);try{console.log("[ContractInfo]    :",{CUST_ID:t.CUST_ID,WRK_DRCTN_ID:t.WRK_DRCTN_ID});const $=await DA(t.CUST_ID,t.WRK_DRCTN_ID);console.log("[ContractInfo]    :",$),m($)}catch($){console.error("[ContractInfo]    :",$)}finally{p(!1)}})()},[t.CUST_ID,t.WRK_DRCTN_ID]),b.useEffect(()=>{(async()=>{if(t.WRK_DRCTN_ID)try{const $=await wM(t.WRK_DRCTN_ID);$&&(console.log("[ContractInfo] getAfterProcInfo :",$),B($))}catch($){console.error("[ContractInfo] getAfterProcInfo :",$)}})()},[t.WRK_DRCTN_ID]),b.useEffect(()=>{(async()=>{const $=t.WRK_ID||t.id;if(!k||!$){console.log("[ContractInfo]     (WRK_CD:",t.WRK_CD,", WRK_ID:",$,")");return}F(!0);try{console.log("[ContractInfo]    :",{WRK_CD:t.WRK_CD,WRK_ID:$,RCPT_ID:t.RCPT_ID});const de=await x_({WRK_CD:t.WRK_CD||"",WRK_ID:$,RCPT_ID:t.RCPT_ID});console.log("[ContractInfo]    :",de),M(de)}catch(de){console.error("[ContractInfo]    :",de)}finally{F(!1)}})()},[k,t.WRK_CD,t.WRK_ID,t.id,t.RCPT_ID]);const[I,E]=b.useState([]),[A,Y]=b.useState(null),[ee,J]=b.useState(!1),[H,V]=b.useState(null),[K,j]=b.useState(!1);b.useEffect(()=>{var $,de,ae;if(console.log("[ContractInfo] VIP :",{"customer.isVip":($=t.customer)==null?void 0:$.isVip,VIP_GB:t.VIP_GB,customer:t.customer}),((de=t.customer)==null?void 0:de.isVip)||t.VIP_GB&&String(t.VIP_GB).length>0){const _e=((ae=t.customer)==null?void 0:ae.vipLevel)||(t.VIP_GB==="VIP_VVIP"?"VVIP":"VIP");Y({label:"VIP",value:`${_e} .`})}else Y(null)},[(ce=t.customer)==null?void 0:ce.isVip,(R=t.customer)==null?void 0:R.vipLevel,t.VIP_GB]),b.useEffect(()=>{(async()=>{var de;if(!(((de=t.customer)==null?void 0:de.isVip)||t.VIP_GB&&String(t.VIP_GB).length>0)){V(null);return}j(!0);try{console.log("[ContractInfo] VIP  DB  ");const ae=await zg({COMMON_GRP:"MOWO001",COMMON_CD:"AL1"});console.log("[ContractInfo] VIP  DB  :",ae),ae&&ae.length>0&&ae[0].REF_CODE?V(ae[0].REF_CODE):V(null)}catch(ae){console.error("[ContractInfo] VIP  DB  :",ae),V(null)}finally{j(!1)}})()},[(O=t.customer)==null?void 0:O.isVip,t.VIP_GB]),b.useEffect(()=>{var ae,_e,ie,Ne,X;const q=[],$=t.WRK_CD||((ae=h==null?void 0:h.workAlarm)==null?void 0:ae.WRK_CD);if(_||!h){E([]);return}G&&(G.CLOSE_DANGER==="Y"?q.push({label:"",value:" "}):q.push({label:"",value:"  "})),h.workAlarm&&(h.workAlarm.OTT_SALE_DESC&&q.push({label:"OTT",value:h.workAlarm.OTT_SALE_DESC}),h.workAlarm.BUNDLE_ISP_TG==="Y"&&q.push({label:"",value:" "}),["01","05","07"].includes($||"")&&h.workAlarm.PYM_MTHD==="01"&&h.workAlarm.ATMT_YN==="Y"&&q.push({label:"",value:"/Email"}),["01","05","06","07"].includes($||"")&&h.workAlarm.RLNM_AUTH_YN_NM&&q.push({label:"",value:h.workAlarm.RLNM_AUTH_YN_NM}),h.workAlarm.COUPON_VAL&&h.workAlarm.COUPON_VAL!=="0"&&Number(h.workAlarm.COUPON_VAL)>0&&q.push({label:"VOD",value:` ${Number(h.workAlarm.COUPON_VAL).toLocaleString()}`}));const de=((_e=h.vodLastDate)==null?void 0:_e.max_dt)||((ie=h.vodLastDate)==null?void 0:ie.MAX_DT);if(de&&String(de).trim().length>7&&q.push({label:"VOD",value:`(6M)VOD: ${LY(String(de))}`}),(Ne=h.specialVod5k)!=null&&Ne.BIGO&&q.push({label:"",value:h.specialVod5k.BIGO}),(X=h.custBasicInfo)!=null&&X.SMS_RCV_YN){const xe=String(h.custBasicInfo.SMS_RCV_YN);xe==="Y"?q.push({label:"",value:""}):xe==="N"&&q.push({label:"",value:""})}if(h.specialBigo&&h.specialBigo.length>0){const xe=h.specialBigo.find(fe=>fe.SPECIAL_GB==="G"&&fe.BIGO);xe&&q.push({label:"",value:xe.BIGO||""})}q.length>0&&console.log("[ContractInfo]  :",q),E(q)},[h,_,t.WRK_CD,G]);const te={PROM_CNT:(r==null?void 0:r.PROM_CNT)||t.PROM_CNT,CTRT_APLY_STRT_DT:(r==null?void 0:r.CTRT_APLY_STRT_DT)||t.CTRT_APLY_STRT_DT,CTRT_APLY_END_DT:(r==null?void 0:r.CTRT_APLY_END_DT)||t.CTRT_APLY_END_DT,GRP_ID:(r==null?void 0:r.GRP_ID)||t.GRP_ID,GRP_NM:(r==null?void 0:r.GRP_NM)||t.GRP_NM,IP_CNT:(r==null?void 0:r.IP_CNT)||t.IP_CNT,SO_NM:(r==null?void 0:r.SO_NM)||t.SO_NM,MSO_NM:t.MSO_NM};return s.jsxs("div",{className:"px-3 sm:px-4 py-4 sm:py-6 pb-4 space-y-3 sm:space-y-4 overflow-x-hidden",children:[a&&s.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-3 sm:p-4",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"animate-spin w-4 h-4 sm:w-5 sm:h-5 border-2 border-blue-500 border-t-transparent rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-xs sm:text-sm text-blue-700",children:"    ..."})]})}),c&&!a&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-100 rounded-xl p-3 sm:p-4",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-xs sm:text-sm text-yellow-700",children:c})]})}),!a&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:" "}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0",children:[s.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:[t.customer.name,t.customer.id&&s.jsxs("span",{className:"text-gray-400 font-normal ml-1",children:["(",t.customer.id.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"),")"]})]}),t.customer.isVip&&s.jsx("span",{className:`
                  px-1.5 sm:px-2 py-0.5 rounded-full text-[0.625rem] sm:text-xs font-semibold flex-shrink-0
                  ${t.customer.vipLevel==="VVIP"?"bg-purple-100 text-purple-700":"bg-yellow-100 text-yellow-700"}
                `,children:t.customer.vipLevel})]})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.customer.phone||"-"})]}),s.jsxs("div",{className:"flex items-start pt-1 border-t border-gray-100",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-16 sm:w-20 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 leading-relaxed flex-1 break-words",children:t.customer.address})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-all",children:Xi(t.PYM_ACNT_ID)||"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.PYM_MTHD||"-"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:te.PROM_CNT?`${te.PROM_CNT}`:"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:te.CTRT_APLY_STRT_DT?mR(te.CTRT_APLY_STRT_DT):"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:te.CTRT_APLY_END_DT?mR(te.CTRT_APLY_END_DT):"-"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:te.GRP_ID||"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:te.GRP_NM||"-"})]})]})]}),A&&s.jsxs("div",{className:"bg-amber-50 border border-amber-300 rounded-lg overflow-hidden",children:[s.jsxs("button",{onClick:()=>J(!ee),className:"w-full flex items-center justify-between px-3 py-2 hover:bg-amber-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-xs sm:text-sm font-bold text-amber-600 w-20 sm:w-24 flex-shrink-0",children:"VIP"}),s.jsx("span",{className:"text-xs sm:text-sm font-bold text-amber-700",children:A.value})]}),s.jsx("svg",{className:`w-4 h-4 text-amber-600 transition-transform duration-200 ${ee?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ee&&s.jsx("div",{className:"px-3 py-3 border-t border-amber-200 bg-amber-50",children:s.jsx("div",{className:"text-xs sm:text-sm text-amber-800",children:K?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-amber-500 border-t-transparent rounded-full"}),s.jsx("span",{children:"VIP   ..."})]}):H?s.jsx("p",{className:"whitespace-pre-wrap",children:H}):s.jsx("p",{className:"text-amber-600",children:"VIP .   ."})})})]}),I.length>0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsx("div",{className:"space-y-2 sm:space-y-3",children:I.map((q,$)=>s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:q.label}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words flex-1",children:q.value})]},$))})]}),y?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 pb-2 border-b border-gray-200",children:" "}),s.jsx("div",{className:"space-y-2",children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:t.OLD_PROD_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:"ID"}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-700",children:Xi(t.OLD_CTRT_ID||t.CTRT_ID)})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-700",children:t.OLD_CTRT_STAT_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-700",children:t.OLD_PROM_CNT?`${t.OLD_PROM_CNT}`:"-"})]})]})})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[s.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-2 pb-2 border-b border-blue-200",children:" "}),s.jsx("div",{className:"space-y-2",children:(()=>{const q=g.find(de=>de.CTRT_ID===t.DTL_CTRT_ID),$=(r==null?void 0:r.BASIC_PROD_CD_NM)||(q==null?void 0:q.BASIC_PROD_CD_NM);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-700 break-words",children:$||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:"ID"}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-600",children:Xi(t.DTL_CTRT_ID||(q==null?void 0:q.CTRT_ID))})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-600",children:(q==null?void 0:q.CTRT_STAT_NM)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-400",children:""}),s.jsx("div",{className:"text-xs sm:text-sm font-medium text-blue-600",children:q!=null&&q.PROM_CNT?`${q.PROM_CNT}`:"-"})]})]})})()})]})]})]}):k?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),P?s.jsxs("div",{className:"flex items-center justify-center gap-2 py-4",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full"}),s.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"   ..."})]}):s.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[s.jsxs("div",{className:`rounded-lg p-3 ${v?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[s.jsx("div",{className:`text-xs font-semibold mb-2 pb-2 border-b ${v?"text-blue-600 border-blue-200":"text-gray-500 border-gray-200"}`,children:""}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${v?"text-blue-700":"text-gray-900"}`,children:v?(r==null?void 0:r.BASIC_PROD_CD_NM)||"-":(L==null?void 0:L.PROD_NM)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:"ID"}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${v?"text-blue-600":"text-gray-700"}`,children:Xi(v?t.CTRT_ID:(L==null?void 0:L.OLD_CTRT_ID)||(L==null?void 0:L.CTRT_ID))})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${v?"text-blue-600":"text-gray-700"}`,children:v?((U=t.customer)==null?void 0:U.address)||"-":(L==null?void 0:L.ADDR_ORD)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${v?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${v?"text-blue-600":"text-gray-700"}`,children:v?t.WRK_STAT_NM||"-":(L==null?void 0:L.WRK_STAT_NM)||"-"})]})]})]}),s.jsxs("div",{className:`rounded-lg p-3 ${S?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[s.jsx("div",{className:`text-xs font-semibold mb-2 pb-2 border-b ${S?"text-blue-600 border-blue-200":"text-gray-500 border-gray-200"}`,children:""}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${S?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${S?"text-blue-700":"text-gray-900"}`,children:S?(r==null?void 0:r.BASIC_PROD_CD_NM)||"-":(L==null?void 0:L.PROD_NM)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${S?"text-blue-400":"text-gray-400"}`,children:"ID"}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${S?"text-blue-600":"text-gray-700"}`,children:Xi(S?t.CTRT_ID:L==null?void 0:L.CTRT_ID)})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${S?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium break-words ${S?"text-blue-600":"text-gray-700"}`,children:S?((Q=t.customer)==null?void 0:Q.address)||"-":(L==null?void 0:L.ADDR_ORD)||"-"})]}),s.jsxs("div",{children:[s.jsx("div",{className:`text-[0.625rem] sm:text-xs ${S?"text-blue-400":"text-gray-400"}`,children:""}),s.jsx("div",{className:`text-xs sm:text-sm font-medium ${S?"text-blue-600":"text-gray-700"}`,children:S?t.WRK_STAT_NM||"-":(L==null?void 0:L.WRK_STAT_NM)||"-"})]})]})]})]})]}):s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:""}),s.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:"ID"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:Xi(t.CTRT_ID)})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.CTRT_STAT_NM||wY(t.CTRT_STAT)})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words flex-1",children:(r==null?void 0:r.BASIC_PROD_CD_NM)||t.productName||"-"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-xs sm:text-sm text-gray-500 w-20 sm:w-24 flex-shrink-0",children:"IP"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:te.IP_CNT||"-"})]})]})]})]})]})},wY=t=>({10:"",20:"",30:"",37:"()",90:""})[t||""]||"  ",mR=t=>{if(!t)return"-";const e=String(t),n=e.replace(/\D/g,"");return n.length>=8?`${n.slice(0,4)}-${n.slice(4,6)}-${n.slice(6,8)}`:e||"-"},LY=t=>!t||t.length<8?"-":`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`,PY=({workItem:t,onNext:e,onBack:n,showToast:r})=>{var G,B,I;const[i,a]=b.useState(!1),[o,c]=b.useState([]),[u,h]=b.useState(!1),[m,_]=b.useState(!1),[p,g]=b.useState(!1),[C,y]=b.useState([]),[S,v]=b.useState(!1),[k,L]=b.useState(!1);b.useEffect(()=>{(async()=>{var A;if((A=t.customer)!=null&&A.id&&!m){h(!0);try{const Y=await CA(t.customer.id);c(Y),_(!0)}catch(Y){console.error("  :",Y),c([]),_(!0)}finally{h(!1)}}})()},[(G=t.customer)==null?void 0:G.id]),b.useEffect(()=>{(async()=>{var A;if((A=t.customer)!=null&&A.id&&!k){v(!0);try{const Y=await NA(t.customer.id);y(Y),L(!0)}catch(Y){console.error("  :",Y),y([]),L(!0)}finally{v(!1)}}})()},[(B=t.customer)==null?void 0:B.id]);const M=()=>{a(!i)},P=()=>{g(!p)},F=()=>{r&&r("   .","info")};return s.jsxs("div",{className:"px-3 sm:px-4 py-4 sm:py-6 pb-3 sm:pb-4 space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-3 sm:mb-4",children:"  "}),s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:"ID"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:Xi(t.RCPT_ID)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:"ID"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:Xi(t.id)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-blue-600 whitespace-nowrap",children:t.typeDisplay})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:kY(t.WRK_STAT_CD)})]}),s.jsxs("div",{className:"flex items-center justify-between pt-1.5 sm:pt-2 mt-1.5 sm:mt-2 border-t border-gray-100",children:[s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-blue-600 whitespace-nowrap",children:UY(t.scheduledAt)})]})]})]}),AY(t),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2.5 sm:mb-3",children:"  "}),s.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 rounded-lg text-xs sm:text-sm text-gray-700 leading-relaxed min-h-20 whitespace-pre-line",children:(I=t.details)==null?void 0:I.replace(/  /g,`
`)})]}),t.installLocation&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2.5 sm:mb-3",children:" "}),s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 p-2.5 sm:p-3 bg-gray-50 rounded-lg",children:[s.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.installLocation})]})]}),t.cellNo&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-5",children:[s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2.5 sm:mb-3",children:" "}),s.jsxs("div",{className:"flex items-center justify-between gap-2 p-2.5 sm:p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:t.cellNo}),s.jsxs("button",{className:"min-h-10 sm:min-h-12 px-3 sm:px-4 py-2 bg-green-500 hover:bg-green-600 text-white text-xs sm:text-sm font-medium rounded-lg transition-colors flex items-center gap-1.5 sm:gap-2 whitespace-nowrap flex-shrink-0",children:[s.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"})})," "]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsxs("button",{onClick:M,className:"w-full p-3 sm:p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:""}),u?s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-500 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:"..."}):m&&s.jsxs("span",{className:"px-1.5 sm:px-2 py-0.5 bg-blue-100 text-blue-700 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:[o.length,""]})]}),s.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 text-gray-400 transition-transform flex-shrink-0 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&s.jsx("div",{className:"border-t border-gray-100 p-3 sm:p-5",children:u?s.jsxs("div",{className:"flex items-center justify-center py-6 sm:py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-blue-500"}),s.jsx("span",{className:"ml-2 sm:ml-3 text-xs sm:text-sm text-gray-500",children:" ..."})]}):o.length===0?s.jsx("div",{className:"text-center py-6 sm:py-8 text-gray-500 text-xs sm:text-sm",children:" 7  ."}):s.jsx("div",{className:"space-y-2.5 sm:space-y-3 max-h-64 sm:max-h-80 overflow-y-auto",children:o.map((E,A)=>s.jsxs("div",{className:"p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5 sm:mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0",children:[s.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-medium rounded whitespace-nowrap ${E.MSG_TYP==="KKO"?"bg-yellow-100 text-yellow-700":E.MSG_TYP==="LMS"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:E.MSG_TYP||"SMS"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:E.EML_SMS_SND_TP_NM||"-"})]}),s.jsx("span",{className:`text-[0.625rem] sm:text-xs font-medium whitespace-nowrap ${E.RESULT===""?"text-green-600":E.RESULT===""?"text-red-600":"text-gray-500"}`,children:E.RESULT||"-"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2 text-[0.625rem] sm:text-xs text-gray-500 mb-1.5 sm:mb-2",children:[s.jsxs("div",{className:"truncate",children:[": ",E.CELL_PHN||"-"]}),s.jsxs("div",{className:"truncate",children:[": ",E.SMS_RCV_NO||"-"]}),E.SEND_TIME&&s.jsxs("div",{className:"col-span-2",children:[": ",E.SEND_TIME]}),E.REG_NM&&s.jsxs("div",{className:"col-span-2",children:[": ",E.REG_NM]})]}),E.MESSAGE&&s.jsx("div",{className:"mt-1.5 sm:mt-2 p-2 bg-white rounded border border-gray-200 text-xs sm:text-sm text-gray-700 whitespace-pre-wrap",children:E.MESSAGE})]},A))})})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:s.jsxs("button",{onClick:F,className:"w-full p-3 sm:p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:""})]}),s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsxs("button",{onClick:P,className:"w-full p-3 sm:p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),s.jsx("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:""}),S?s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-500 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:"..."}):k&&s.jsxs("span",{className:"px-1.5 sm:px-2 py-0.5 bg-green-100 text-green-700 text-[0.625rem] sm:text-xs font-medium rounded-full whitespace-nowrap",children:[C.length,""]})]}),s.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 text-gray-400 transition-transform flex-shrink-0 ${p?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&s.jsx("div",{className:"border-t border-gray-100 p-3 sm:p-5",children:S?s.jsxs("div",{className:"flex items-center justify-center py-6 sm:py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 sm:h-6 sm:w-6 border-b-2 border-green-500"}),s.jsx("span",{className:"ml-2 sm:ml-3 text-xs sm:text-sm text-gray-500",children:" ..."})]}):C.length===0?s.jsx("div",{className:"text-center py-6 sm:py-8 text-gray-500 text-xs sm:text-sm",children:" ."}):s.jsx("div",{className:"space-y-2.5 sm:space-y-3 max-h-64 sm:max-h-80 overflow-y-auto",children:C.map((E,A)=>s.jsxs("div",{className:"p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5 sm:mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0",children:[s.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-medium rounded whitespace-nowrap bg-green-100 text-green-700",children:E.RCPT_TP_NM||""}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:E.CNSL_MST_CL_NM||"-"})]}),s.jsx("span",{className:"text-[0.625rem] sm:text-xs text-gray-500 whitespace-nowrap",children:E.START_DD||"-"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2 text-[0.625rem] sm:text-xs text-gray-500 mb-1.5 sm:mb-2",children:[E.CNSL_MID_CL_NM&&s.jsxs("div",{className:"truncate",children:[": ",E.CNSL_MID_CL_NM]}),E.CNSL_SLV_CL_NM&&s.jsxs("div",{className:"truncate",children:[": ",E.CNSL_SLV_CL_NM]}),E.CNSL_RSLT_NM&&s.jsxs("div",{className:"truncate",children:[": ",E.CNSL_RSLT_NM]}),E.RCPT_PSN_NM&&s.jsxs("div",{className:"truncate",children:[": ",E.RCPT_PSN_NM]})]}),E.REQ_CTX&&s.jsxs("div",{className:"mt-1.5 sm:mt-2 p-2 bg-white rounded border border-gray-200 text-xs sm:text-sm text-gray-700",children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"whitespace-pre-wrap",children:E.REQ_CTX})]}),E.PROC_CT&&s.jsxs("div",{className:"mt-1.5 sm:mt-2 p-2 bg-blue-50 rounded border border-blue-100 text-xs sm:text-sm text-gray-700",children:[s.jsx("div",{className:"text-[0.625rem] sm:text-xs text-blue-600 mb-1",children:""}),s.jsx("div",{className:"whitespace-pre-wrap",children:E.PROC_CT})]})]},A))})})]})]})},AY=t=>{const e=t.WRK_CD;return e==="0410"||e==="06"?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-5",children:[s.jsx("h4",{className:"text-base font-bold text-gray-900 mb-4",children:"  "}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.mmtSusCd&&s.jsxs("div",{className:"space-y-1 col-span-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"  "}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.mmtSusCd})]}),t.susHopeDd&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:" "}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:gR(t.susHopeDd)})]}),t.mmtSusHopeDd&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:" "}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:gR(t.mmtSusHopeDd)})]}),t.termDays&&s.jsxs("div",{className:"space-y-1 col-span-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"  "}),s.jsxs("p",{className:"text-sm font-medium text-blue-600",children:[t.termDays,""]})]})]})]}):null},kY=t=>({1:"",2:"",3:"",4:"",7:"",9:""})[t||""]||"  ",UY=t=>{try{const e=new Date(t),n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0");return`${n}-${r}-${i} ${a}:${o}`}catch{return t}},gR=t=>t&&t.length===8?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t,f0=({isOpen:t,onClose:e,prodCd:n,ctrtId:r,prodGrp:i,prodNm:a,wrkCdNm:o,onSave:c,showToast:u,customerEquipmentCount:h=0,installedEquipmentCount:m=0})=>{const[_,p]=b.useState([]),[g,C]=b.useState([]),[y,S]=b.useState({}),[v,k]=b.useState([]),[L,M]=b.useState([]),[P,F]=b.useState([]),[G,B]=b.useState([]),[I,E]=b.useState(""),[A,Y]=b.useState([]),[ee,J]=b.useState(!1),[H,V]=b.useState(!1),[K,j]=b.useState(""),[te,ce]=b.useState("1");b.useEffect(()=>{t&&R()},[t,n,r]);const R=async()=>{J(!0);try{console.log("[Modal]     "),console.log("  PROD_CD:",n),console.log("  CTRT_ID:",r);const le=await uA(n,r);console.log("[Modal]   :",le);const se=await hA("LENT,EQT_USE_STAT,ITLLMT_PRD");console.log("[Modal]  :",se);let Re=[],be=[],De=[];const re=ct=>Array.isArray(ct)?ct.map(Ge=>{if(typeof Ge=="string"||typeof Ge=="number"){const nt=String(Ge);return{COMMON_CD:nt,COMMON_CD_NM:nt}}const at=(Ge==null?void 0:Ge.COMMON_CD)??(Ge==null?void 0:Ge.CODE)??(Ge==null?void 0:Ge.CD)??(Ge==null?void 0:Ge.value)??(Ge==null?void 0:Ge.COMMONCODE)??(Ge==null?void 0:Ge.code),xt=(Ge==null?void 0:Ge.COMMON_CD_NM)??(Ge==null?void 0:Ge.CD_NM)??(Ge==null?void 0:Ge.NAME)??(Ge==null?void 0:Ge.label)??(Ge==null?void 0:Ge.text)??(Ge==null?void 0:Ge.COMMONCDNM)??(Ge==null?void 0:Ge.name),mt=(Ge==null?void 0:Ge.REF_CODE)??(Ge==null?void 0:Ge.REF)??(Ge==null?void 0:Ge.refCode)??(Ge==null?void 0:Ge.ref),Ve=(Ge==null?void 0:Ge.COMMON_GRP)??(Ge==null?void 0:Ge.GROUP)??(Ge==null?void 0:Ge.group),it=(Ge==null?void 0:Ge.SORT_NO)??(Ge==null?void 0:Ge.SORT)??(Ge==null?void 0:Ge.order)??void 0,Fe=(Ge==null?void 0:Ge.DEFAULT_YN)??(Ge==null?void 0:Ge.DEFAULT)??(Ge==null?void 0:Ge.default)??void 0;return{COMMON_CD:typeof at=="string"?at:at!=null?String(at):"",COMMON_CD_NM:typeof xt=="string"?xt:xt!=null?String(xt):"",REF_CODE:typeof mt=="string"?mt:mt!=null?String(mt):void 0,COMMON_GRP:Ve!=null?String(Ve):void 0,SORT_NO:typeof it=="number"?it:it!=null?Number(it):void 0,DEFAULT_YN:Fe!=null?String(Fe):void 0}}).filter(Ge=>Ge.COMMON_CD):[];if(se&&!Array.isArray(se)&&typeof se=="object"){const ct=(Array.isArray(se.LENT)?se.LENT:void 0)??(Array.isArray(se.CMCU027)?se.CMCU027:[]),Ge=(Array.isArray(se.EQT_USE_STAT)?se.EQT_USE_STAT:void 0)??(Array.isArray(se.CMEP314)?se.CMEP314:[]),at=(Array.isArray(se.ITLLMT_PRD)?se.ITLLMT_PRD:void 0)??(Array.isArray(se.CMCU064)?se.CMCU064:[]),xt=(Fe,nt)=>Array.isArray(Fe)?Fe.length>0&&!("COMMON_GRP_NM"in(Fe[0]||{})||"GROUP_NM"in(Fe[0]||{}))?Fe:Fe.filter(lt=>{const Mt=String((lt==null?void 0:lt.COMMON_GRP_NM)||(lt==null?void 0:lt.GROUP_NM)||"");return nt.some(ut=>Mt.indexOf(ut)>=0)}):[],mt=xt(ct,[""]),Ve=xt(Ge,["",""]),it=xt(at,["","",""]);Re=re(mt.length?mt:ct),be=re(Ve.length?Ve:Ge),De=re(it.length?it:at)}else{let ct=[];Array.isArray(se)?ct=re(se):se!=null&&se.codes&&Array.isArray(se.codes)&&(ct=re(se.codes)),ct.length>0&&(Re=ct.filter(Ge=>Ge.COMMON_GRP==="LENT"||Ge.COMMON_GRP==="CMCU027"),be=ct.filter(Ge=>Ge.COMMON_GRP==="EQT_USE_STAT"||Ge.COMMON_GRP==="CMEP314"),De=ct.filter(Ge=>Ge.COMMON_GRP==="ITLLMT_PRD"||Ge.COMMON_GRP==="CMCU064"))}console.log("   :",(Re==null?void 0:Re.length)||0,""),console.log("   :",(be==null?void 0:be.length)||0,""),console.log("   :",(De==null?void 0:De.length)||0,""),k(Re||[]),M(be||[]),F(De||[]);try{const Ge=(await zg({COMMON_GRP:"LGCT001"})).map(at=>at.COMMON_CD).filter(Boolean);Y(Ge),console.log("  LG   (LGCT001):",Ge.length,"")}catch(ct){console.warn("  LGCT001  , AP  :",ct),Y([])}const me=le.output2||[];console.log("   :",me.length),console.log("    ( ):",me[0]);const ve=i==="V"?"09":"10",et=me.filter(ct=>(!ct.SEL||ct.SEL==="0")&&ct.EQT===ve);C(et),console.log("    :",et.length,"(PROD_GRP:",i,",  EQT:",ve,")");const Dt=me.map((ct,Ge)=>(console.log(`  [${Ge}]:`,{EQT:ct.EQT,PROD_TYP:ct.PROD_TYP,EQUIP_SEQ:ct.EQUIP_SEQ,SVC_CMPS_ID:ct.SVC_CMPS_ID,SEL:ct.SEL}),{...ct,SEL:ct.SEL||"0",LENT:ct.LENT||"10",EQT_USE_STAT_CD:ct.EQT_USE_STAT_CD||"1",ITLLMT_PRD:ct.ITLLMT_PRD||"00",PROD_TYP:ct.PROD_TYP||"2",EQUIP_SEQ:ct.EQUIP_SEQ||ct.SVC_CMPS_ID||String(Ge+1)}));if(p(Dt),le.output1&&le.output1.length>0){const ct=le.output1[0];console.log("[Modal]   :",ct);const Ge=ct.ITEM_MID_CDS||"",at=ct.EQT_CLS||"",xt=(ct.LENTS||"").replace(/\[|\]/g,""),mt=ct.EQT_USE_STATS||"",Ve=ct.ITLLMT_PRDS||"",it=ct.EQT_SALE_AMTS||"",Fe=ct.PROD_CMPS_CLS||"",nt=ct.PROD_GRPS||"",lt=ct.PROD_CDS||"",Mt=ct.SVC_CDS||"";console.log("[Modal] PROD_CMPS_CLS :",Fe,"(:",Fe.length,")");const ut=Math.floor(Ge.length/10),qe=[...Dt],Ye=(pe=>{const ge=[];let Be=0;for(;Be<pe.length;){const ue=pe.charAt(Be);Be++;let we="";for(;Be<pe.length&&/\d/.test(pe.charAt(Be))&&(we+=pe.charAt(Be),Be++,!(we.length>=2)););(ue||we)&&ge.push({prodTyp:ue,equipSeq:we})}return ge})(Fe);console.log("[Modal] PROD_CMPS_CLS :",Ye);for(let pe=0;pe<ut;pe++){const ge=Ge.substr(pe*10,10).trim(),Be=at.substr(pe*10,10).trim(),ue=xt.substr(pe*2,2).trim(),we=mt.substr(pe*1,1).trim(),Je=Ve.substr(pe*2,2).trim(),Pe=it.substr(pe*10,10).trim(),Nt=nt.charAt(pe)||"D",Oe=lt.substr(pe*10,10).trim(),dt=Mt.substr(pe*10,10).trim(),gt=Ye[pe]||{prodTyp:"2",equipSeq:String(pe+1)},It=qe.findIndex($e=>$e.SEL!=="1"&&$e.EQT===ge);It>-1&&(qe[It]={...qe[It],SEL:"1",EQT_CL:Be,LENT:ue||"10",EQT_USE_STAT_CD:we||"1",ITLLMT_PRD:Je||"00",EQT_SALE_AMT:parseInt(Pe)||0,PROD_TYP:qe[It].PROD_TYP,EQUIP_SEQ:qe[It].EQUIP_SEQ,PROD_GRP:Nt||qe[It].PROD_GRP,PROD_CD:Oe||qe[It].PROD_CD,SVC_CD:dt||qe[It].SVC_CD},console.log(`  [${It}]  (output2   ):`,{EQT:qe[It].EQT,PROD_TYP:qe[It].PROD_TYP,EQUIP_SEQ:qe[It].EQUIP_SEQ,SEL:"1"}))}console.log("[Modal]   :",qe.filter(pe=>pe.SEL==="1")),p(qe)}B(le.output3||[]);const ot=await dA(n,r),At={};ot.forEach(ct=>{At[ct.EQT_CD]||(At[ct.EQT_CD]=[]),At[ct.EQT_CD].some(Ge=>Ge.EQT_CL_CD===ct.EQT_CL_CD)||At[ct.EQT_CD].push({EQT_CL_CD:ct.EQT_CL_CD,EQT_CL_NM:ct.EQT_CL_NM,SUB_EQT_1:ct.SUB_EQT_1,SUB_EQT_2:ct.SUB_EQT_2,SUB_EQT_3:ct.SUB_EQT_3,DEL_EQT_1:ct.DEL_EQT_1,DEL_EQT_2:ct.DEL_EQT_2,DEL_EQT_3:ct.DEL_EQT_3})}),me.forEach(ct=>{const Ge=ct.EQT_CD||ct.EQT;if(!Ge)return;At[Ge]||(At[Ge]=[]),!At[Ge].some(xt=>xt.EQT_CL_CD===ct.EQT_CL)&&ct.EQT_CL&&ct.EQT_CL_NM&&At[Ge].push({EQT_CL_CD:ct.EQT_CL,EQT_CL_NM:ct.EQT_CL_NM,SUB_EQT_1:ct.SUB_EQT_1,SUB_EQT_2:ct.SUB_EQT_2,SUB_EQT_3:ct.SUB_EQT_3,DEL_EQT_1:ct.DEL_EQT_1,DEL_EQT_2:ct.DEL_EQT_2,DEL_EQT_3:ct.DEL_EQT_3})}),S(At),console.log("   (API ):",At),console.log("[Modal]   ")}catch(le){console.error("[Modal]   :",le),u==null||u("   .","error",!0)}finally{J(!1)}},O=le=>{const se=[..._],Re=se[le],be=Re.SEL,De=be==="1"?"0":"1";se[le].SEL=De,console.log(`[Modal]  : [${le}] ${Re.EQT} - SEL: ${be}  ${De}`);const re=[];if(Re.EQT_CL){const ve=(y[Re.EQT_CD]||[]).find(et=>et.EQT_CL_CD===Re.EQT_CL);ve&&(ve.SUB_EQT_1&&re.push(ve.SUB_EQT_1),ve.SUB_EQT_2&&re.push(ve.SUB_EQT_2),ve.SUB_EQT_3&&re.push(ve.SUB_EQT_3))}if(De==="0"&&re.length>0){let me=0;se.forEach((ve,et)=>{if(et!==le){const Dt=U(ve.EQT);re.includes(Dt)&&ve.SEL==="1"&&(ve.SEL="0",me++,console.log(`[Modal]   - SUB_EQT  : ${ve.EQT_NM||ve.EQT}`))}}),me>0&&(u==null||u(`${me}    .`,"info"))}if(De==="1"&&re.length>0&&Re.EQT_CL){let me=0;se.forEach((ve,et)=>{if(et!==le){const Dt=U(ve.EQT);re.includes(Dt)&&ve.SEL!=="1"&&(ve.SEL="1",me++,console.log(`[Modal]   - SUB_EQT  : ${ve.EQT_NM||ve.EQT}`))}}),me>0&&(u==null||u(`${me}    .`,"info"))}p(se),console.log(`      : ${se.filter(me=>me.SEL==="1").length}`)},U=le=>(le==null?"":String(le).trim()).padStart(2,"0"),Q=(le,se,Re)=>{const be=[..._];if(be[le][se]=Re,se==="EQT_CL"){const De=be[le],me=(y[De.EQT_CD]||[]).find(ve=>ve.EQT_CL_CD===Re);if(me){be[le].EQT_CL_NM=me.EQT_CL_NM,console.log("[Modal]  :",{index:le,EQT_CL_CD:Re,EQT_CL_NM:me.EQT_CL_NM});const ve=[],et=[];me.SUB_EQT_1&&ve.push(me.SUB_EQT_1),me.SUB_EQT_2&&ve.push(me.SUB_EQT_2),me.SUB_EQT_3&&ve.push(me.SUB_EQT_3),me.DEL_EQT_1&&et.push(me.DEL_EQT_1),me.DEL_EQT_2&&et.push(me.DEL_EQT_2),me.DEL_EQT_3&&et.push(me.DEL_EQT_3),console.log("[Modal]   :",{EQT:De.EQT,model:Re,modelName:me.EQT_CL_NM,SUB_EQTs:ve,DEL_EQTs:et});let Dt=0,ot=0;if(ve.length>0&&be.forEach((Ge,at)=>{if(at!==le){const xt=U(Ge.EQT);ve.includes(xt)&&Ge.SEL!=="1"&&(Ge.SEL="1",Dt++,console.log(`[Modal] SUB_EQT  : ${Ge.EQT_NM||Ge.EQT} (EQT: ${xt})`))}}),et.length>0&&be.forEach((Ge,at)=>{if(at!==le){const xt=U(Ge.EQT);et.includes(xt)&&Ge.SEL==="1"&&(Ge.SEL="0",ot++,console.log(`[Modal] DEL_EQT  : ${Ge.EQT_NM||Ge.EQT} (EQT: ${xt})`))}}),Dt>0||ot>0){const Ge=[];Dt>0&&Ge.push(`${Dt}   `),ot>0&&Ge.push(`${ot}   `),u==null||u(Ge.join(", "),"info")}const At=Re==="090491",ct=De.EQT==="21"||De.EQT==="22";(At||ct)&&(be[le].LENT="40",console.log(`[Modal]   LENT=40  : ${At?"XCAS":"EQT="+De.EQT}`))}}se==="LENT"&&(Re!=="31"&&(be[le].ITLLMT_PRD="00"),["30","31","60"].includes(Re)||(be[le].EQT_USE_STAT_CD="1")),p(be)},q=()=>{if(!K){u==null||u("  .","warning");return}const le=parseInt(te);if(isNaN(le)||le<1){u==null||u("  .","warning");return}const se=g.find(be=>be.EQT===K);if(!se)return;const Re=[..._];for(let be=0;be<le;be++)Re.push({...se,SEL:"1",LENT:"10",EQT_USE_STAT_CD:"1",ITLLMT_PRD:"00",PROD_TYP:se.PROD_TYP||"2",EQUIP_SEQ:se.EQUIP_SEQ||se.SVC_CMPS_ID||String(Re.length+1)});p(Re),ce("1")},$=async()=>{if(console.log(`
 [Modal]    `),m>0){u==null||u("      .   .","error");return}console.log("  equipmentList :",_.length,""),console.log("    SEL :"),_.forEach((me,ve)=>{console.log(`    [${ve}] ${me.EQT} - SEL: "${me.SEL}" (: ${me.SEL==="1"?"O":"X"})`)});const le=_.filter(me=>me.SEL==="1");if(console.log(" :",le.length,""),le.forEach((me,ve)=>{console.log(`  [${ve}] ${me.EQT} - PROD_TYP: ${me.PROD_TYP}, EQUIP_SEQ: ${me.EQUIP_SEQ}`)}),le.length===0){u==null||u("  .","warning");return}const se=me=>(me==null?"":String(me).trim()).padStart(2,"0"),Re=me=>{const ve=se(me.EQT),et=se(me.ITEM_MID_CD),Dt=se(me.ITM_MID_CD),ot=se(me.EQT_CD);return ve==="04"||et==="04"||Dt==="04"||ot==="04"};le.filter(Re);const be=le.filter(me=>me.EQT==="10").length,De=le[0];if(De&&De.CMPS_QTY_FROM==="2"){if(be!==2){u==null||u("   2 .","warning");return}}else if(A.includes(n)&&be>1){u==null||u("    1 .","warning");return}const re=le.filter(me=>me.EQT==="09").length;if(re>180){u==null||u(` 180  . HANDY : ${re}`,"warning");return}if(be>180){u==null||u(` 180  . (AP) : ${be}`,"warning");return}V(!0);try{console.log(" [Modal] onSave  - selectedEquipments:",le.length,""),console.log("    :"),le.forEach((me,ve)=>{console.log(`    [${ve}]`,{EQT:me.EQT,SEL:me.SEL,PROD_TYP:me.PROD_TYP,EQUIP_SEQ:me.EQUIP_SEQ,PROD_GRP:me.PROD_GRP,PROD_CD:me.PROD_CD,SVC_CD:me.SVC_CD,EQT_CL:me.EQT_CL,LENT:me.LENT,EQT_USE_STAT_CD:me.EQT_USE_STAT_CD,ITLLMT_PRD:me.ITLLMT_PRD})}),await c(le,I),e()}catch(me){console.error("[Modal]  :",me)}finally{V(!1)}},de=le=>G.filter(se=>se.PRED==="1"&&se.EQT_USE_STAT_CD===le.EQT_USE_STAT_CD&&se.EQT_CL_CD===le.EQT_CL),ae=le=>{const se=v.find(Re=>Re.COMMON_CD===le);return se?se.COMMON_CD_NM:le},_e=(le,se)=>{const Re=le.LENT_YN,be=le.EQT_CL;if(!Re||typeof Re!="string"||!se||se.length===0)return console.log("[] LENT_YN    ",{lentYn:Re,allLentCodesCount:se.length}),[];const De=Re.split("|").map(ve=>ve.trim()).filter(Boolean);if(!De.length)return console.log("[] LENT_YN     ",{lentYn:Re}),[];const re=new Set;if(De.forEach(ve=>{if(ve.length>=7){const et=ve.substring(0,6),Dt=ve.charAt(6);be&&et===be&&re.add(Dt)}}),console.log("[]  ",{eqtCl:be,lentYn:Re,tokens:De,allowedRefCodes:Array.from(re),allLentCodes:se.map(ve=>({code:ve.COMMON_CD,name:ve.COMMON_CD_NM,refCode:ve.REF_CODE}))}),re.size===0)return console.log("[]  REF_CODE    "),[];const me=se.filter(ve=>{const et=ve.REF_CODE,Dt=et&&re.has(et);return console.log(`  - ${ve.COMMON_CD} (${ve.COMMON_CD_NM}): REF_CODE=${et}  ${Dt?"":""}`),Dt}).map(ve=>ve.COMMON_CD);return console.log("[]  :",me),me},ie=le=>{const se=L.find(Re=>Re.COMMON_CD===le);return se?se.COMMON_CD_NM:le},Ne=b.useMemo(()=>(v||[]).map(se=>({value:se.COMMON_CD,label:se.COMMON_CD_NM||se.COMMON_CD,SORT_NO:se.SORT_NO,DEFAULT_YN:se.DEFAULT_YN,REF_CODE:se.REF_CODE})),[v]);b.useMemo(()=>(L||[]).map(se=>({value:se.COMMON_CD,label:se.COMMON_CD_NM||se.COMMON_CD})),[L]);const X=b.useMemo(()=>(P||[]).map(se=>({value:se.COMMON_CD,label:se.COMMON_CD_NM||se.COMMON_CD})),[P]),xe=b.useMemo(()=>(g||[]).map(le=>({value:le.EQT,label:le.EQT_NM})),[g]),fe=ee?null:s.jsxs("div",{className:"modal-subheader",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("span",{className:"info-value",title:r,children:r||"-"})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("span",{className:"info-value",title:o,children:o||"-"})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("span",{className:"info-value",title:a,children:a||"-"})]}),i==="V"&&X.length>0&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:""}),s.jsx("div",{className:"info-select",children:s.jsx(sn,{value:I||"",onValueChange:E,options:X,placeholder:""})})]})]}),Z=s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:e,disabled:H,children:""}),s.jsx("button",{className:"btn btn-primary btn-sm",onClick:$,disabled:H||ee,children:H?" ...":""})]});return s.jsx(Ra,{isOpen:t,onClose:e,title:"  ",size:"large",subHeader:fe,footer:Z,children:s.jsx("div",{className:"equipment-model-change-modal-content",children:ee?s.jsxs("div",{className:"loading-message",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"   ..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"add-equipment-section",children:[s.jsx("h3",{children:" "}),s.jsxs("div",{className:"add-equipment-form",children:[s.jsx("div",{className:"flex-1",children:s.jsx(sn,{value:K,onValueChange:j,options:xe,placeholder:"  "})}),s.jsx("input",{type:"number",className:"count-input",value:te,onChange:le=>ce(le.target.value),min:"1",max:"99"}),s.jsx("span",{className:"unit",children:""}),s.jsx("button",{className:"add-btn",onClick:q,children:""})]})]}),s.jsxs("div",{className:"equipment-section",children:[s.jsxs("h3",{children:["  (",_.filter(le=>le.SEL==="1").length," )"]}),_.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:"  ."})}):s.jsx("div",{className:"equipment-list",children:_.map((le,se)=>{const Re=y[le.EQT_CD]||[],be=le.SEL==="1";be&&["30","31","60"].includes(le.LENT);const De=be&&le.LENT==="31",re=de(le);return s.jsxs("div",{className:`equipment-item ${be?"selected":""}`,children:[s.jsx("div",{className:"equipment-header",children:s.jsxs("label",{className:"checkbox-wrapper",children:[s.jsx("input",{type:"checkbox",checked:be,onChange:()=>O(se)}),s.jsxs("span",{className:"equipment-title",children:[le.EQT_NM,le.EQT_BASIC_YN==="Y"&&s.jsx("span",{className:"badge",children:""})]})]})}),be&&s.jsxs("div",{className:"equipment-details",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsx("div",{style:{flex:1},children:s.jsx(sn,{value:le.EQT_CL||"",onValueChange:me=>Q(se,"EQT_CL",me),options:(()=>{const me=(Re||[]).map(ve=>({value:ve.EQT_CL_CD,label:ve.EQT_CL_NM}));return me.length===0&&console.warn("  .",{eqtCd:le.EQT_CD,models:Re}),me})(),placeholder:""})})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsx("div",{style:{flex:1},children:s.jsx(sn,{value:le.LENT||"10",onValueChange:me=>Q(se,"LENT",me),options:(()=>{let me=_e(le,v||[]);me.includes("31")&&(de(le).some(Dt=>Dt.PRED==="1")||(me=me.filter(Dt=>Dt!=="31")));const ve=Ne.filter(et=>me.includes(et.value));return ve.length===0&&console.warn("   .",{eq:le,allowed:me}),ve.map(et=>({value:et.value,label:et.label}))})(),placeholder:""})})]}),De&&s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsx("div",{style:{flex:1},children:s.jsx(sn,{value:le.ITLLMT_PRD||"00",onValueChange:me=>Q(se,"ITLLMT_PRD",me),options:(()=>{const me=[{value:"00",label:""},...re.map(ve=>({value:ve.INSTL_PERD,label:`${ve.INSTL_PERD}`}))];return re.length===0&&console.warn("  .",{eq:le,installmentPeriods:re}),me})(),placeholder:""})})]}),le.EQT_SALE_AMT>0&&s.jsxs("div",{className:"detail-row",children:[s.jsx("label",{children:""}),s.jsxs("span",{className:"price",children:[le.EQT_SALE_AMT.toLocaleString(),""]})]})]}),!be&&s.jsxs("div",{className:"equipment-summary",children:[s.jsx("span",{className:"tag",children:ae(le.LENT)}),s.jsx("span",{className:"tag",children:ie(le.EQT_USE_STAT_CD)})]})]},se)})})]})]})})})},m0=({isOpen:t,onClose:e,ctrtId:n})=>{const[r,i]=b.useState([]),[a,o]=b.useState(!1),[c,u]=b.useState(null),h=async()=>{if(!n){console.error("[LDAP] ID ");return}o(!0),u(null);try{console.log("[LDAP]   CTRT_ID:",n);const p=await eN(n);console.log("[LDAP]  :",p),i(p.data||[])}catch(p){console.error("[LDAP]  :",p),u(p instanceof Error?p.message:"   ")}finally{o(!1)}};b.useEffect(()=>{t&&n&&h()},[t,n]);const m=s.jsxs("div",{className:"text-xs text-gray-700 space-y-0.5",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-600",children:"ID:"})," ",s.jsx("span",{className:"font-medium text-blue-700",children:Xi(n)})]}),s.jsx("div",{className:"text-gray-600",children:"LGU+ LDAP  "})]}),_=s.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:""});return s.jsx(Ra,{isOpen:t,onClose:e,title:"LDAP",size:"medium",subHeader:m,footer:_,children:s.jsxs("div",{children:[a&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:" ..."})}),c&&s.jsx("div",{className:"flex items-center justify-center py-8 px-4",children:s.jsx("div",{className:"text-red-500 text-xs text-center",children:c})}),!a&&!c&&r.length===0&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500 text-xs",children:"LDAP  "})}),!a&&!c&&r.length>0&&s.jsx("div",{className:"space-y-2.5 p-2.5",children:r.map((p,g)=>s.jsx("div",{className:`rounded-lg border shadow-sm p-2.5 ${g%2===0?"bg-white border-gray-200":"bg-gray-50 border-gray-200"}`,children:s.jsxs("div",{className:"space-y-1.5",children:[p.ONT_EQT_NO&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"ONT :"})," ",p.ONT_EQT_NO]})}),p.ONT_MAC_ADDR&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"ONT MAC:"})," ",p.ONT_MAC_ADDR]})}),p.AP_EQT_NO&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"AP :"})," ",p.AP_EQT_NO]})}),p.AP_MAC_ADDR&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:"AP MAC:"})," ",p.AP_MAC_ADDR]})}),p.PROC_DV_CD&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",p.PROC_DV_CD]})}),p.PRSS_RSLT_CD&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",s.jsx("span",{className:p.PRSS_RSLT_CD==="0000"?"text-green-600":"text-red-600",children:p.PRSS_RSLT_CD})]})}),p.PRSS_RSLT_MSG&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",p.PRSS_RSLT_MSG]})}),p.REG_DTTM&&s.jsx("div",{className:"bg-white rounded px-2.5 py-1.5 border border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:[s.jsx("span",{className:"text-gray-600 font-normal",children:":"})," ",p.REG_DTTM]})})]})},g))})]})})},g0=t=>({"01":"","02":"","03":"A/S","04":"","05":"","06":"","07":"","08":"","09":""})[t||""]||"",Qu=t=>({10:"",20:"",30:"",40:"",90:""})[t||""]||"",BY=["091001","091005","091006","091401","092401","090251"],P_=t=>!t||["01","05","06","07","09"].includes(t)?"01":["02","08"].includes(t)?"02":t==="03"?"03":t==="04"?"04":"01",uS=t=>t.LENT_YN==="40"||t.VOIP_CUSTOWN_EQT==="Y"||t.eqtClCd==="090852",_R=t=>`equipment_draft_${t}`,xR=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var ct;const g=t.id,C=o||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:y}=ta(),{initWorkState:S,setApiData:v,setDataLoaded:k,addInstalledEquipment:L,removeInstalledEquipment:M,setInstalledEquipments:P,clearInstalledEquipments:F,setSelectedContract:G,setSelectedStock:B,setSignalStatus:I,setSignalResult:E}=ki(),{contractEquipments:A,technicianEquipments:Y,installedEquipments:ee,selectedContract:J,selectedStock:H,signalStatus:V,signalResult:K,filteringData:j,isReady:te}=xa(g),[ce,R]=b.useState(!1),[O,U]=b.useState(!1),[Q,q]=b.useState(!1),[$,de]=b.useState(!1),[ae,_e]=b.useState(!1),[ie,Ne]=b.useState(!1),[X,xe]=b.useState(!1),[fe,Z]=b.useState(0);b.useEffect(()=>{if(te&&(ee.length>0||A.length>0)){console.log("[-]    -   ");return}S(g),le()},[t.id]);const le=async(Ge=!1)=>{var at,xt,mt,Ve,it,Fe;try{let nt;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Ge)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),nt=i;else{Ge?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const ge=localStorage.getItem("userInfo");if(!ge){console.error("  .");return}const Be=JSON.parse(ge),ue=t.WRK_CD||"",we=t.WRK_DTL_TCD||"",Je={WRKR_ID:t.WRKR_ID||Be.userId||Be.workerId||"",SO_ID:t.SO_ID||Be.soId,WRK_ID:t.id,CUST_ID:(at=t.customer)==null?void 0:at.id,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ue,WRK_DTL_TCD:we,WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-]    (API )"),console.log("[-] :",Je),nt=await Co(Je),Ge&&a&&(console.log("[-]   preloadedData "),a(nt))}console.log("[-] :"),console.log("  -  (output2):",((xt=nt.contractEquipments)==null?void 0:xt.length)||0,""),console.log("  -  (output3):",((mt=nt.technicianEquipments)==null?void 0:mt.length)||0,""),console.log("  -  (output4):",((Ve=nt.customerEquipments)==null?void 0:Ve.length)||0,"");const Mt={kpiProdGrpCd:nt.kpiProdGrpCd,prodChgGb:nt.prodChgGb,chgKpiProdGrpCd:nt.chgKpiProdGrpCd,prodGrp:nt.prodGrp};y(Mt),window.__equipmentFilterData=Mt;const ut=(nt.contractEquipments||[]).map(ge=>({id:ge.SVC_CMPS_ID||ge.PROD_CMPS_ID,type:ge.ITEM_MID_NM||ge.EQT_NM,model:ge.EQT_CL_NM,serialNumber:"N/A",itemMidCd:ge.ITEM_MID_CD,eqtClCd:ge.EQT_CL_CD||ge.EQT_CL,SVC_CMPS_ID:ge.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ge.BASIC_PROD_CMPS_ID,PROD_CD:ge.PROD_CD,SVC_CD:ge.SVC_CD})),qe=(nt.technicianEquipments||[]).map(ge=>({id:ge.EQT_NO,type:ge.ITEM_MID_NM,model:ge.EQT_CL_NM,serialNumber:ge.EQT_SERNO,itemMidCd:ge.ITEM_MID_CD,eqtClCd:ge.EQT_CL_CD||ge.EQT_CL,macAddress:ge.MAC_ADDRESS,SVC_CMPS_ID:ge.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ge.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:ge.EQT_PROD_CMPS_ID,PROD_CD:ge.PROD_CD,SVC_CD:ge.SVC_CD,EQT_SALE_AMT:ge.EQT_SALE_AMT,MST_SO_ID:ge.MST_SO_ID,SO_ID:ge.SO_ID,OLD_LENT_YN:ge.OLD_LENT_YN,LENT:ge.LENT,ITLLMT_PRD:ge.ITLLMT_PRD,EQT_USE_STAT_CD:ge.EQT_USE_STAT_CD})),Ee=new Set,Ye=(nt.customerEquipments||[]).map(ge=>{const Be=ut.find(ue=>ue.itemMidCd===ge.ITEM_MID_CD&&!Ee.has(ue.id));return Be&&Ee.add(Be.id),{contractEquipment:Be||{id:"unknown",type:ge.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:ge.ITEM_MID_CD},actualEquipment:{id:ge.EQT_NO,type:ge.ITEM_MID_NM,model:ge.EQT_CL_NM,serialNumber:ge.EQT_SERNO,itemMidCd:ge.ITEM_MID_CD,macAddress:ge.MAC_ADDRESS||ge.MAC_ADDR,EQT_KND:ge.EQT_KND,EQT_CL_CD:ge.EQT_CL_CD},macAddress:ge.MAC_ADDRESS||ge.MAC_ADDR,installLocation:ge.INSTL_LCTN}});console.log("[-]  :"),console.log("  -  :",ut.length,""),console.log("  -  :",qe.length,""),console.log("  -  :",Ye.length,""),v(g,{contractEquipments:ut,technicianEquipments:qe,filteringData:Mt}),Z(Ye.length);const pe=ki.getState().getWorkState(g);Ye.length>0&&!((it=pe==null?void 0:pe.installedEquipments)!=null&&it.length)?(console.log("[-] API     :",Ye.length,""),P(g,Ye)):(Fe=pe==null?void 0:pe.installedEquipments)!=null&&Fe.length,requestAnimationFrame(()=>k(g,!0))}catch(nt){console.error("[-]    :",nt),v(g,{contractEquipments:[],technicianEquipments:[]}),P(g,[]),requestAnimationFrame(()=>k(g,!0))}},se=b.useCallback(Ge=>{const at=ee.find(xt=>xt.contractEquipment.id===Ge.id);(J==null?void 0:J.id)===Ge.id?(G(g,null),B(g,null)):(G(g,Ge),at?B(g,at.actualEquipment):B(g,null))},[g,ee,J]),Re=b.useCallback(Ge=>{(H==null?void 0:H.id)===Ge.id?B(g,null):B(g,Ge)},[g,H]),be=b.useCallback(()=>{if(!J||!H)return;if(J.itemMidCd!==H.itemMidCd||J.model!==H.model){r==null||r("      .","warning");return}console.log("[-]  :",{:J.type,:`${H.type} (S/N: ${H.serialNumber})`});const Ge={contractEquipment:J,actualEquipment:H,macAddress:H.macAddress||"",installLocation:""};L(g,Ge),I(g,"idle"),B(g,null)},[g,J,H]),De=async(Ge,at)=>{try{const xt=localStorage.getItem("userInfo");if(!xt){r==null||r("  .","error");return}const mt=JSON.parse(xt),Ve=Ge.map((Fe,nt)=>{let lt=Fe.ITEM_MID_CD||Fe.ITM_MID_CD||Fe.EQT||Fe.EQT_CD||"",Mt=Fe.EQT_CL||Fe.EQT_CL_CD||"",ut=Fe.SVC_CMPS_ID||Fe.PROD_CMPS_ID||Fe.SVC_CMPS_SEQ||Fe.EQUIP_SEQ||"";return lt=String(lt).trim().padStart(2,"0"),Mt=String(Mt).trim().padStart(6,"0"),ut=String(ut||nt+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||mt.crrId||"",WRKR_ID:t.WRKR_ID||mt.userId||mt.workerId||"",REG_UID:mt.userId||mt.workerId||"A20130708",ITEM_MID_CD:lt,EQT_CL:Mt,SVC_CMPS_ID:ut,EQT:lt,EQT_CD:lt,LENT:String(Fe.LENT||"10"),EQT_USE_STAT_CD:String(Fe.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Fe.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Fe.EQT_SALE_AMT||0),PROD_GRP:String(Fe.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Fe.PROD_CD||t.PROD_CD||""),SVC_CD:String(Fe.SVC_CD||""),PROM_CNT:at||"",SEL:"1",EQT_BASIC_YN:String(Fe.EQT_BASIC_YN||"N"),PROD_TYP:Fe.PROD_TYP,EQUIP_SEQ:Fe.EQUIP_SEQ}}),it=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:at||"",equipments:Ve});if(it.MSGCODE==="SUCCESS"||it.MSGCODE==="0"||it.code==="SUCCESS")r==null||r("  .","success"),F(g),B(g,null),await le(!0);else throw new Error(it.MESSAGE||it.message||"   .")}catch(xt){throw console.error("[-]    :",xt),r==null||r(xt.message||"     .","error",!0),xt}},re=Ge=>ee.find(at=>{var mt,Ve;return(((mt=at.actualEquipment)==null?void 0:mt.itemMidCd)||((Ve=at.actualEquipment)==null?void 0:Ve.ITEM_MID_CD)||"")===Ge}),me=()=>{var nt,lt,Mt,ut,qe,Ee,Ye,pe,ge,Be,ue,we,Je,Pe;const Ge=t.PROD_GRP||"";if(t.VOIP_PROD_CD||""){const Nt=re("08");return Nt?{eqtNo:((nt=Nt.actualEquipment)==null?void 0:nt.id)||((lt=Nt.actualEquipment)==null?void 0:lt.EQT_NO)||"",itemMidCd:"08"}:null}const xt=re("05");if(xt)return{eqtNo:((Mt=xt.actualEquipment)==null?void 0:Mt.id)||((ut=xt.actualEquipment)==null?void 0:ut.EQT_NO)||"",itemMidCd:"05"};const mt=re("01");if(mt)return{eqtNo:((qe=mt.actualEquipment)==null?void 0:qe.id)||((Ee=mt.actualEquipment)==null?void 0:Ee.EQT_NO)||"",itemMidCd:"01"};const Ve=re("03");if(Ve)return{eqtNo:((Ye=Ve.actualEquipment)==null?void 0:Ye.id)||((pe=Ve.actualEquipment)==null?void 0:pe.EQT_NO)||"",itemMidCd:"03"};if(Ge==="I"){const Nt=re("02");if(Nt)return{eqtNo:((ge=Nt.actualEquipment)==null?void 0:ge.id)||((Be=Nt.actualEquipment)==null?void 0:Be.EQT_NO)||"",itemMidCd:"02"}}const it=re("08");if(it)return{eqtNo:((ue=it.actualEquipment)==null?void 0:ue.id)||((we=it.actualEquipment)==null?void 0:we.EQT_NO)||"",itemMidCd:"08"};const Fe=re("04");return Fe?{eqtNo:((Je=Fe.actualEquipment)==null?void 0:Je.id)||((Pe=Fe.actualEquipment)==null?void 0:Pe.EQT_NO)||"",itemMidCd:"04"}:null},ve=()=>(t.PROD_GRP||"")==="V"?"SMR60":"SMR03",et=async()=>{var lt,Mt;const Ge=ut=>{var pe,ge,Be;const qe=((pe=ut.actualEquipment)==null?void 0:pe.eqtClCd)||ut.eqtClCd||"",Ee=((ge=ut.actualEquipment)==null?void 0:ge.itemMidCd)||ut.itemMidCd||"",Ye=(((Be=ut.actualEquipment)==null?void 0:Be.type)||ut.type||"").toLowerCase();return!!(qe.startsWith("0904")||Ee==="05"||Ye.includes("stb")||Ye.includes("")||Ye.includes(""))},at=ut=>{var pe,ge,Be;const qe=((pe=ut.actualEquipment)==null?void 0:pe.eqtClCd)||ut.eqtClCd||"",Ee=((ge=ut.actualEquipment)==null?void 0:ge.itemMidCd)||ut.itemMidCd||"",Ye=(((Be=ut.actualEquipment)==null?void 0:Be.type)||ut.type||"").toLowerCase();return!!(qe.startsWith("0902")||Ee==="04"||Ye.includes("modem")||Ye.includes("")||Ye.includes(""))};if(ee.length===0){r==null||r("    . STB    .","warning"),I(g,"fail");return}const xt=t.PROD_GRP||"",mt=t.VOIP_PROD_CD||"";if(xt==="V"&&!mt&&!t.CTRT_JOIN_ID){r==null||r("VoIP   .","warning"),I(g,"fail");return}const Ve=t.ISP_PROD_CD||"";if(xt==="I"&&Ve&&!t.CTRT_JOIN_ID){r==null||r("  ISP .   .","warning"),I(g,"fail");return}const it=me(),Fe=ee.some(Ge),nt=ee.some(at);if(!Fe&&!nt&&!it){r==null||r("  STB    .","warning"),I(g,"fail");return}try{_e(!0),de(!0),E(g," ...");const ut=localStorage.getItem("userInfo");if(!ut){E(g,"    ."),I(g,"fail"),_e(!1);return}const qe=JSON.parse(ut),Ee=qe.userId||qe.id||"UNKNOWN",Ye=(it==null?void 0:it.eqtNo)||"",pe=ee.find(Ge),ge=ee.find(at),Be=((lt=pe==null?void 0:pe.actualEquipment)==null?void 0:lt.id)||"",ue=((Mt=ge==null?void 0:ge.actualEquipment)==null?void 0:Mt.id)||"",we=ve(),Je=await qu(Ee,t.CTRT_ID||"",t.id,we,Be||Ye,ue||"");Je.O_IFSVC_RESULT&&Je.O_IFSVC_RESULT.startsWith("TRUE")?(E(g,` 

: ${Je.O_IFSVC_RESULT||""}`),I(g,"success")):(E(g,` 

${Je.MESSAGE||"   "}`),I(g,"fail"))}catch(ut){E(g,` 

${ut.message||"   "}`),I(g,"fail")}finally{_e(!1)}},Dt=b.useMemo(()=>{const Ge=new Set(ee.map(xt=>xt.actualEquipment.id));let at=Y.filter(xt=>!Ge.has(xt.id));return J&&(at=at.filter(xt=>xt.itemMidCd===J.itemMidCd&&xt.model===J.model)),at},[Y,ee,J]),ot=()=>{Ne(!0),setTimeout(()=>{Ne(!1),r==null||r("    .","info")},500)},At=async()=>{if(!(X||C)){xe(!0);try{await le(!0),r==null||r("  .","success")}catch(Ge){console.error("[-]  :",Ge),r==null||r("   .","error")}finally{xe(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4 relative",children:[X&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-20 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsx("button",{onClick:At,disabled:X||C,className:`p-1.5 rounded-lg transition-all ${X||C?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:s.jsx(Ai,{className:`w-4 h-4 ${X?"animate-spin":""}`})})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[A.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{C||R(!0)},disabled:C,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||C,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C||t.PROD_GRP==="V"?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-50":V==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":V==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>{if(t.PROD_GRP==="V"){r==null||r("VOIP    .","info");return}!C&&!ae&&et()},children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-orange-200 bg-orange-50 text-orange-600 hover:bg-orange-100 hover:border-orange-300 transition-all active:scale-95 min-h-[56px] opacity-50 cursor-not-allowed",disabled:!0,title:"     ",children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300 transition-all active:scale-95 min-h-[56px]",onClick:()=>q(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${t.PROD_GRP==="V"?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-50":"border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300"}`,onClick:()=>{if(t.PROD_GRP==="V"){r==null||r("VOIP    .","info");return}U(!0)},children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:""})]})]})]}),te?A.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:A.map(Ge=>{const at=ee.find(mt=>mt.contractEquipment.id===Ge.id),xt=(J==null?void 0:J.id)===Ge.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${C?at?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":xt?"border-blue-500 bg-blue-50 cursor-pointer":at?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!C&&se(Ge),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ge.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ge.model})]}),at&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",at.actualEquipment.model]})}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",at.actualEquipment.serialNumber]}),at.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",at.macAddress]})]})]})},Ge.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!C&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!J||!ee.some(Ge=>Ge.contractEquipment.id===(J==null?void 0:J.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-red-500 bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer active:scale-95"}`,onClick:()=>{J&&(M(g,J.id),I(g,"idle"),B(g,null),r==null||r("  .","info"))},disabled:!J||!ee.some(Ge=>Ge.contractEquipment.id===(J==null?void 0:J.id)),title:"   ",children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!J||!H||ee.some(Ge=>Ge.actualEquipment.id===H.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:be,disabled:!J||!H||ee.some(Ge=>Ge.actualEquipment.id===H.id),title:"   ",children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!C&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 sm:p-4 border-b border-gray-100 gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",J&&s.jsxs("span",{className:"text-blue-600",children:[" (",J.type,")"]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[J?Dt.length:0,""]})]}),J?Dt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:Dt.map(Ge=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(H==null?void 0:H.id)===Ge.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Re(Ge),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ge.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ge.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Ge.serialNumber]}),Ge.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Ge.macAddress]})]})]}),(H==null?void 0:H.id)===Ge.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Ge.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})]}),(()=>{var mt;const Ge=t.WRK_CD_NM||g0(t.WRK_CD)||t.workType||"-",at=t.PROD_NM||t.productName||((mt=t.customer)==null?void 0:mt.productName)||"-",xt=t.CTRT_STAT_NM||Qu(t.CTRT_STAT)||"-";return s.jsx(f0,{isOpen:ce,onClose:()=>R(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:xt,prodGrp:t.PROD_GRP||"",prodNm:at,wrkCdNm:Ge,onSave:De,showToast:r,installedEquipmentCount:ee.length})})(),!C&&s.jsx("button",{onClick:ot,disabled:ie,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${ie?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:O,onClose:()=>U(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((ct=t.customer)==null?void 0:ct.id)}),s.jsx(m0,{isOpen:Q,onClose:()=>q(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),$&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!ae&&de(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Ge=>Ge.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:ae?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):V==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:K})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:K})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${V==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>de(!1),disabled:ae,children:ae?" ...":""})})]})}),document.body)]})},GY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1})=>{const c=t.id,u=o||t.WRK_STAT_CD==="4"||t.status==="",{initWorkState:h,setApiData:m,setDataLoaded:_,toggleRemovalStatus:p,setFullRemovalStatus:g}=ki(),{removeEquipments:C,removalStatus:y,isReady:S}=xa(c),[v,k]=b.useState(!1);b.useEffect(()=>{if(S&&C.length>0){console.log("[-]    -   ");return}h(c),L()},[t.id]);const L=async(F=!1)=>{var G,B,I;try{console.log("[-]    - isWorkCompleted:",u,"WRK_STAT_CD:",t.WRK_STAT_CD);let E;if(i&&!F)console.log("[-] Pre-loaded   - API  "),E=i;else{const Y=localStorage.getItem("userInfo");if(!Y){console.error("  .");return}const ee=JSON.parse(Y),J={WRKR_ID:t.WRKR_ID||ee.userId||ee.workerId||"",SO_ID:t.SO_ID||ee.soId,WRK_ID:t.id,CUST_ID:((G=t.customer)==null?void 0:G.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"02",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-]    (API )"),console.log("[-] :",J),E=await Co(J)}console.log("[-] :"),console.log("  -  (output5):",((B=E.removedEquipments)==null?void 0:B.length)||0,""),((I=E.removedEquipments)==null?void 0:I.length)>0&&console.log("[-]  API [0]:",E.removedEquipments[0]);const A=(E.removedEquipments||[]).map(Y=>({...Y,id:Y.EQT_NO,type:Y.ITEM_MID_NM,model:Y.EQT_CL_NM,serialNumber:Y.EQT_SERNO,itemMidCd:Y.ITEM_MID_CD,eqtClCd:Y.EQT_CL_CD||Y.EQT_CL,macAddress:Y.MAC_ADDRESS||Y.MAC_ADDR,installLocation:Y.INSTL_LCTN}));console.log("[-]  :"),console.log("  -  :",A.length,""),m(c,{removeEquipments:A}),requestAnimationFrame(()=>_(c,!0))}catch(E){console.error("[-]    :",E),r==null||r("   .","error",!0),m(c,{removeEquipments:[]}),requestAnimationFrame(()=>_(c,!0))}},M=(F,G)=>{p(c,F,G)},P=async()=>{if(!(v||u)){k(!0);try{await L(!0),r==null||r("  .","success")}catch(F){console.error("[-]  :",F),r==null||r("   .","error")}finally{k(!1)}}};return s.jsx("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[v&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Oc,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Ai,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-500"}),""]}),s.jsxs("button",{onClick:P,disabled:v||u,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${v||u?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Oc,{className:`w-3.5 h-3.5 ${v?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2 sm:px-2.5 py-0.5 sm:py-1 bg-orange-100 text-orange-700 text-[0.625rem] sm:text-xs font-semibold rounded-full",children:[C.length,""]})]}),C.length===0?s.jsx("div",{className:"py-12 text-center",children:s.jsx("div",{className:"text-sm text-gray-500",children:"   "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:C.map(F=>{const G=F.id,B=y[G]||{},I=uS(F);return s.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:F.model||F.type}),s.jsxs("div",{className:"text-xs text-gray-600",children:["S/N: ",F.serialNumber]}),F.macAddress&&s.jsxs("div",{className:"text-xs text-gray-500",children:["MAC: ",F.macAddress]})]}),s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:F.EQT_LOC_TP_NM||""})]}),!u&&!o&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${I?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_LOSS_YN==="1",onChange:()=>!I&&M(G,"EQT_LOSS_YN"),disabled:I,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${I?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.PART_LOSS_BRK_YN==="1",onChange:()=>!I&&M(G,"PART_LOSS_BRK_YN"),disabled:I,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${I?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_BRK_YN==="1",onChange:()=>!I&&M(G,"EQT_BRK_YN"),disabled:I,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${I?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_CABL_LOSS_YN==="1",onChange:()=>!I&&M(G,"EQT_CABL_LOSS_YN"),disabled:I,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg active:bg-gray-100 whitespace-nowrap ${I?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsx("input",{type:"checkbox",checked:B.EQT_CRDL_LOSS_YN==="1",onChange:()=>!I&&M(G,"EQT_CRDL_LOSS_YN"),disabled:I,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]})]}),I&&!u&&s.jsx("div",{className:"mt-2 text-xs text-orange-600 bg-orange-50 p-2 rounded",children:"   "})]},F.id)})})]})})},WY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var Ye;const g=t.id,C=o||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:y}=ta(),{initWorkState:S,setApiData:v,setDataLoaded:k,addInstalledEquipment:L,removeInstalledEquipment:M,setInstalledEquipments:P,clearInstalledEquipments:F,setSelectedContract:G,setSelectedStock:B,clearSelection:I,toggleRemovalStatus:E,addMarkedForRemoval:A,removeMarkedForRemoval:Y,setMarkedForRemoval:ee,setPendingLossStatusList:J,setSignalStatus:H,setSignalResult:V,setFullRemovalStatus:K}=ki(),{contractEquipments:j,technicianEquipments:te,removeEquipments:ce,installedEquipments:R,removalStatus:O,markedForRemoval:U,pendingLossStatusList:Q,selectedContract:q,selectedStock:$,signalStatus:de,signalResult:ae,filteringData:_e,isReady:ie}=xa(g),[Ne,X]=b.useState(0),[xe,fe]=b.useState("removal"),[Z,le]=b.useState(!1),[se,Re]=b.useState(!1),[be,De]=b.useState(!1),[re,me]=b.useState(!1),[ve,et]=b.useState(!1),[Dt,ot]=b.useState(!1),[At,ct]=b.useState(!1);b.useEffect(()=>{if(ie&&(R.length>0||U.length>0||j.length>0)){console.log("[-AS]    -   ");return}S(g),Ge()},[t.id]);const Ge=async(pe=!1)=>{var ge,Be,ue,we,Je;try{let Pe;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!pe)console.log("[-AS] Pre-loaded   -",i.contractEquipments.length," "),Pe=i;else{pe?console.log("[-AS]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-AS] preloadedApiData   - API ");const Ue=localStorage.getItem("userInfo");if(!Ue){console.error("  .");return}const ss=JSON.parse(Ue),ls=P_(t.WRK_CD),ds={WRKR_ID:t.WRKR_ID||ss.userId||ss.workerId||"",SO_ID:t.SO_ID||ss.soId,WRK_ID:t.id,CUST_ID:((ge=t.customer)==null?void 0:ge.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ls,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-AS] API :",ds),Pe=await Co(ds),pe&&a&&(console.log("[-AS]   preloadedData "),a(Pe))}console.log("[-AS] API :",{contractEquipments:((Be=Pe.contractEquipments)==null?void 0:Be.length)||0,technicianEquipments:((ue=Pe.technicianEquipments)==null?void 0:ue.length)||0,customerEquipments:((we=Pe.customerEquipments)==null?void 0:we.length)||0,removedEquipments:((Je=Pe.removedEquipments)==null?void 0:Je.length)||0});const Oe={kpiProdGrpCd:Pe.kpiProdGrpCd,prodChgGb:Pe.prodChgGb,chgKpiProdGrpCd:Pe.chgKpiProdGrpCd,prodGrp:Pe.prodGrp};y(Oe),window.__equipmentFilterData=Oe;const dt=(Pe.contractEquipments||[]).map(Ue=>({id:Ue.SVC_CMPS_ID||Ue.PROD_CMPS_ID,type:Ue.ITEM_MID_NM||Ue.EQT_NM,model:Ue.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD})),gt=(Pe.technicianEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ue.EQT_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD,EQT_SALE_AMT:Ue.EQT_SALE_AMT,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,OLD_LENT_YN:Ue.OLD_LENT_YN,LENT:Ue.LENT,LENT_YN:Ue.LENT_YN,ITLLMT_PRD:Ue.ITLLMT_PRD,EQT_USE_STAT_CD:Ue.EQT_USE_STAT_CD})),It=new Set,$e=(Pe.customerEquipments||[]).map(Ue=>{const ss=dt.find(ls=>ls.itemMidCd===Ue.ITEM_MID_CD&&!It.has(ls.id));return ss&&It.add(ss.id),{contractEquipment:ss||{id:"unknown",type:Ue.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD},actualEquipment:{id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT},macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN}}),$t=(Pe.removedEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT}));if(v(g,{contractEquipments:dt,technicianEquipments:gt,removeEquipments:$t}),X($e.length),$e.length>0){const Ue=new Set(U.map(Ss=>Ss.id)),ss=$e.filter(Ss=>!Ue.has(Ss.actualEquipment.id)),ls=[],ds=[];if(ss.forEach(Ss=>{const ke=dt.find(ft=>ft.itemMidCd===Ss.actualEquipment.itemMidCd);ke&&ke.eqtClCd===Ss.actualEquipment.eqtClCd?ls.push(Ss):ds.push(Ss.actualEquipment)}),ds.length>0){const Ss=[...U,...ds.filter(ke=>!U.some(ft=>ft.id===ke.id))];ee(g,Ss),console.log("[-AS]     :",ds.length,"")}console.log("[-AS] API    :",$e.length,"   :",ls.length,",  :",ds.length,""),P(g,ls);const vs=localStorage.getItem(_R(t.id));if(vs)try{const Ss=JSON.parse(vs);Ss.lastSignalStatus&&H(g,Ss.lastSignalStatus),Ss.removalStatus&&Object.keys(Ss.removalStatus).length>0&&K(g,Ss.removalStatus),Ss.pendingLossStatusList&&Ss.pendingLossStatusList.length>0&&J(g,Ss.pendingLossStatusList)}catch{}}else{const Ue=localStorage.getItem(_R(t.id));if(Ue)try{const ss=JSON.parse(Ue);ss.installedEquipments&&ss.installedEquipments.length>0&&(console.log("[-AS] localStorage  :",ss.installedEquipments.length,""),P(g,ss.installedEquipments)),ss.markedForRemoval&&ss.markedForRemoval.length>0&&ee(g,ss.markedForRemoval),ss.removalStatus&&Object.keys(ss.removalStatus).length>0&&K(g,ss.removalStatus),ss.pendingLossStatusList&&ss.pendingLossStatusList.length>0&&J(g,ss.pendingLossStatusList),ss.lastSignalStatus&&H(g,ss.lastSignalStatus)}catch(ss){console.warn("[-AS] localStorage   :",ss)}}requestAnimationFrame(()=>k(g,!0))}catch(Pe){console.error("[-AS]    :",Pe),requestAnimationFrame(()=>k(g,!0))}},at=pe=>{const ge=R.find(Be=>Be.contractEquipment.id===pe.id&&Be.actualEquipment.eqtClCd===pe.eqtClCd);(q==null?void 0:q.id)===pe.id?(G(g,null),B(g,null)):(G(g,pe),ge?B(g,ge.actualEquipment):B(g,null))},xt=pe=>{($==null?void 0:$.id)===pe.id?B(g,null):B(g,pe)},mt=()=>{if(!q||!$)return;if(q.itemMidCd!==$.itemMidCd||q.model!==$.model){r==null||r("      .","warning");return}const pe=t.CTRT_STAT;if(pe&&pe!=="20"){const Be=Qu(pe);r==null||r(` ${Be}     .`,"error");return}const ge=R.findIndex(Be=>Be.contractEquipment.id===q.id);if(ge>=0){const Be=[...R];Be[ge]={contractEquipment:q,actualEquipment:$,macAddress:$.macAddress||"",installLocation:""},P(g,Be)}else{const Be={contractEquipment:q,actualEquipment:$,macAddress:$.macAddress||"",installLocation:""};P(g,[...R,Be])}H(g,"idle"),B(g,null)},Ve=()=>{if(!$)return;const pe=t.CTRT_STAT;if(pe&&pe!=="20"){const we=Qu(pe);r==null||r(` ${we}     .`,"error");return}const ge=R.findIndex(we=>we.actualEquipment.id===$.id);if(ge>=0){const we=[...R],Je=we.splice(ge,1)[0];P(g,we);const Pe=Je.actualEquipment;U.some(Oe=>Oe.id===Pe.id)||ee(g,[...U,Pe]),H(g,"idle"),B(g,null);return}if(U.some(we=>we.id===$.id))return;ce.some(we=>we.id===$.id)&&ee(g,[...U,$])},it=async(pe,ge)=>{try{const Be=localStorage.getItem("userInfo");if(!Be){r==null||r("  .","error");return}const ue=JSON.parse(Be),we=pe.map((Pe,Nt)=>{let Oe=Pe.ITEM_MID_CD||Pe.ITM_MID_CD||Pe.EQT||Pe.EQT_CD||"",dt=Pe.EQT_CL||Pe.EQT_CL_CD||"",gt=Pe.SVC_CMPS_ID||Pe.PROD_CMPS_ID||Pe.SVC_CMPS_SEQ||Pe.EQUIP_SEQ||"";return Oe=String(Oe).trim().padStart(2,"0"),dt=String(dt).trim().padStart(6,"0"),gt=String(gt||Nt+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||ue.crrId||"",WRKR_ID:t.WRKR_ID||ue.userId||ue.workerId||"",REG_UID:ue.userId||ue.workerId||"A20130708",ITEM_MID_CD:Oe,EQT_CL:dt,SVC_CMPS_ID:gt,EQT:Oe,EQT_CD:Oe,LENT:String(Pe.LENT||"10"),EQT_USE_STAT_CD:String(Pe.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Pe.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Pe.EQT_SALE_AMT||0),PROD_GRP:String(Pe.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Pe.PROD_CD||t.PROD_CD||""),SVC_CD:String(Pe.SVC_CD||""),PROM_CNT:ge||"",SEL:"1",EQT_BASIC_YN:String(Pe.EQT_BASIC_YN||"N"),PROD_TYP:Pe.PROD_TYP,EQUIP_SEQ:Pe.EQUIP_SEQ}}),Je=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:ge||"",equipments:we});if(Je.MSGCODE==="SUCCESS"||Je.MSGCODE==="0"||Je.code==="SUCCESS"){r==null||r("  .","success");const Pe=R.filter(Nt=>!te.some(Oe=>Oe.id===Nt.actualEquipment.id));if(Pe.length>0){const Nt=Pe.map(dt=>dt.actualEquipment),Oe=[...U,...Nt.filter(dt=>!U.some(gt=>gt.id===dt.id))];ee(g,Oe),console.log("[]    :",Nt.length,"")}F(g),B(g,null),await Ge(!0)}else throw new Error(Je.MESSAGE||Je.message||"   .")}catch(Be){throw console.error("[] :",Be),r==null||r(Be.message||"     .","error",!0),Be}},Fe=async()=>{var pe,ge,Be,ue;if(R.length===0){r==null||r("    .","warning"),H(g,"fail");return}try{et(!0),me(!0),V(g," ...");const we=localStorage.getItem("userInfo");if(!we){V(g,"    ."),H(g,"fail"),et(!1);return}const Je=JSON.parse(we),Pe=Je.userId||Je.id||"UNKNOWN",Nt=Ue=>{var vs,Ss,ke,ft,st;const ss=((vs=Ue.actualEquipment)==null?void 0:vs.eqtClCd)||Ue.eqtClCd||((Ss=Ue.actualEquipment)==null?void 0:Ss.EQT_CL_CD)||"",ls=((ke=Ue.actualEquipment)==null?void 0:ke.itemMidCd)||Ue.itemMidCd||((ft=Ue.actualEquipment)==null?void 0:ft.ITEM_MID_CD)||"",ds=(((st=Ue.actualEquipment)==null?void 0:st.type)||Ue.type||"").toLowerCase();return!!(ss.startsWith("0904")||ls==="02"||ds.includes("stb")||ds.includes(""))},Oe=Ue=>{var vs,Ss,ke,ft,st;const ss=((vs=Ue.actualEquipment)==null?void 0:vs.eqtClCd)||Ue.eqtClCd||((Ss=Ue.actualEquipment)==null?void 0:Ss.EQT_CL_CD)||"",ls=((ke=Ue.actualEquipment)==null?void 0:ke.itemMidCd)||Ue.itemMidCd||((ft=Ue.actualEquipment)==null?void 0:ft.ITEM_MID_CD)||"",ds=(((st=Ue.actualEquipment)==null?void 0:st.type)||Ue.type||"").toLowerCase();return!!(ss.startsWith("0902")||ls==="03"||ds.includes("modem")||ds.includes(""))},dt=R.find(Nt),gt=R.find(Oe),It=((pe=dt==null?void 0:dt.actualEquipment)==null?void 0:pe.id)||"",$e=((ge=gt==null?void 0:gt.actualEquipment)==null?void 0:ge.id)||"",$t=await qu(Pe,t.CTRT_ID||"",t.id,"SMR03",It||((ue=(Be=R[0])==null?void 0:Be.actualEquipment)==null?void 0:ue.id)||"",$e||"");$t.O_IFSVC_RESULT&&$t.O_IFSVC_RESULT.startsWith("TRUE")?(V(g,` 

: ${$t.O_IFSVC_RESULT||""}`),H(g,"success")):(V(g,` 

${$t.MESSAGE||"   "}`),H(g,"fail"))}catch(we){V(g,` 

${we.message||"   "}`),H(g,"fail")}finally{et(!1)}},nt=(pe,ge,Be)=>{const ue={...O,[pe]:{...O[pe]||{},[ge]:Be==="1"?"0":"1"}};K(g,ue)},lt=()=>{const pe=new Set(R.map(Be=>Be.actualEquipment.id));let ge=te.filter(Be=>!pe.has(Be.id));return q&&(ge=ge.filter(Be=>Be.itemMidCd===q.itemMidCd&&Be.model===q.model)),ge},Mt=()=>{const pe=new Set(R.map(Be=>Be.actualEquipment.id));let ge=U.filter(Be=>!pe.has(Be.id));return q&&(ge=ge.filter(Be=>Be.itemMidCd===q.itemMidCd&&Be.model===q.model)),ge},ut=()=>{ot(!0),setTimeout(()=>{ot(!1),r==null||r("    .","info")},500)},qe=async()=>{if(!(At||C)){ct(!0);try{await Ge(!0),r==null||r("  .","success")}catch(pe){console.error("[-AS]  :",pe),r==null||r("   .","error")}finally{ct(!1)}}},Ee=lt();return Mt(),s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[At&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsxs("button",{onClick:qe,disabled:At||C,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${At||C?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ai,{className:`w-3.5 h-3.5 ${At?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[j.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{if(C)return;const pe=t.CTRT_STAT;if(pe&&pe!=="20"){r==null||r("A/S   (20)   .","warning");return}le(!0)},disabled:C,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||C,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":de==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":de==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!C&&!ve&&Fe(),disabled:C||ve,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300 transition-all active:scale-95 min-h-[56px]",onClick:()=>c?De(!0):Re(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:c?"LDAP":""})]})]})]}),ie?j.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:j.map(pe=>{const ge=R.find(ue=>ue.contractEquipment.id===pe.id&&ue.actualEquipment.eqtClCd===pe.eqtClCd),Be=(q==null?void 0:q.id)===pe.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${C?ge?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Be?"border-blue-500 bg-blue-50 cursor-pointer":ge?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!C&&at(pe),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:pe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:pe.model})]}),ge&&(()=>{const ue=te.some(we=>we.id===ge.actualEquipment.id);return s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",ge.actualEquipment.model]}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ue?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:ue?"":""})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",ge.actualEquipment.serialNumber]}),ge.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",ge.macAddress]})]})})()]})},pe.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!C&&s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!$||!R.some(pe=>pe.actualEquipment.id===($==null?void 0:$.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!$)return;if(te.some(we=>we.id===$.id)){if(xe!=="stock"){r==null||r("  .   .","warning");return}const we=R.findIndex(Je=>Je.actualEquipment.id===$.id);if(we>=0){const Je=[...R];Je.splice(we,1),P(g,Je),B(g,null),console.log("=== [-]     ==="),console.log(":",Je.map(Pe=>({type:Pe.actualEquipment.type,model:Pe.actualEquipment.model,serialNumber:Pe.actualEquipment.serialNumber,id:Pe.actualEquipment.id}))),console.log(":",U.map(Pe=>({type:Pe.type,model:Pe.model,serialNumber:Pe.serialNumber,id:Pe.id,removalStatus:O[Pe.id]||{}}))),r==null||r("  .","success")}return}const ge=R.findIndex(we=>we.actualEquipment.id===$.id);let Be=[...R],ue=[...U];if(ge>=0){const Je=Be.splice(ge,1)[0].actualEquipment;ue.some(Nt=>Nt.id===Je.id)||(ue=[...ue,Je])}console.log("=== [-]     ==="),console.log(":",Be.map(we=>({type:we.actualEquipment.type,model:we.actualEquipment.model,serialNumber:we.actualEquipment.serialNumber,id:we.actualEquipment.id}))),console.log(":",ue.map(we=>({type:we.type,model:we.model,serialNumber:we.serialNumber,id:we.id,removalStatus:O[we.id]||{}}))),Ve(),fe("removal")},disabled:!$||!R.some(pe=>pe.actualEquipment.id===($==null?void 0:$.id)),children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!$||R.some(pe=>pe.actualEquipment.id===($==null?void 0:$.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!$)return;if(U.some(Pe=>Pe.id===$.id)){if(q&&(q.itemMidCd!==$.itemMidCd||q.eqtClCd!==$.eqtClCd)){r==null||r("      .","warning");return}const Pe=q||j.find(Oe=>Oe.itemMidCd===$.itemMidCd&&Oe.eqtClCd===$.eqtClCd);if(!Pe){r==null||r("      .   .","warning");return}if(R.find(Oe=>Oe.contractEquipment.id===Pe.id&&!te.some(dt=>dt.id===Oe.actualEquipment.id))){r==null||r("   .","warning");return}if(Pe){const Oe={contractEquipment:Pe,actualEquipment:$,macAddress:$.macAddress},dt=[...R,Oe],gt=U.filter($e=>$e.id!==$.id);P(g,dt),ee(g,gt);const It={...O};delete It[$.id],K(g,It),B(g,null),console.log("=== [-]     ==="),console.log(":",dt.map($e=>({type:$e.actualEquipment.type,model:$e.actualEquipment.model,serialNumber:$e.actualEquipment.serialNumber,id:$e.actualEquipment.id}))),console.log(":",gt.map($e=>({type:$e.type,model:$e.model,serialNumber:$e.serialNumber,id:$e.id,removalStatus:It[$e.id]||{}}))),r==null||r("   .","success")}else r==null||r("    .","error");return}if(!q){r==null||r("   .","warning");return}const ge=R.find(Pe=>Pe.contractEquipment.itemMidCd===q.itemMidCd&&!te.some(Nt=>Nt.id===Pe.actualEquipment.id)),Be=ge&&U.some(Pe=>Pe.id===ge.actualEquipment.id);if(ge&&!Be){r==null||r("   .","warning");return}const ue={contractEquipment:q,actualEquipment:$,macAddress:$.macAddress||""},we=R.findIndex(Pe=>Pe.contractEquipment.id===q.id);let Je;we>=0?(Je=[...R],Je[we]=ue):Je=[...R,ue],console.log("=== [-]     ==="),console.log(":",Je.map(Pe=>({type:Pe.actualEquipment.type,model:Pe.actualEquipment.model,serialNumber:Pe.actualEquipment.serialNumber,id:Pe.actualEquipment.id}))),console.log(":",U.map(Pe=>({type:Pe.type,model:Pe.model,serialNumber:Pe.serialNumber,id:Pe.id,removalStatus:O[Pe.id]||{}}))),mt()},disabled:!$||R.some(pe=>pe.actualEquipment.id===($==null?void 0:$.id)),children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!C&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${xe==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>fe("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),U.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${xe==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:U.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${xe==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>fe("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),q&&Ee.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${xe==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:Ee.length})]})})]}),xe==="removal"?s.jsx(s.Fragment,{children:U.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:U.map((pe,ge)=>{const Be=pe.id,ue=O[Be]||{},we=ue.EQT_LOSS_YN==="1"||ue.PART_LOSS_BRK_YN==="1"||ue.EQT_BRK_YN==="1"||ue.EQT_CABL_LOSS_YN==="1"||ue.EQT_CRDL_LOSS_YN==="1",Je=($==null?void 0:$.id)===pe.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Je?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>xt(pe),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:pe.type}),s.jsx("div",{className:"text-xs text-gray-600",children:pe.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",pe.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${we?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:we?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(Pe=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${ue[Pe.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Nt=>{Nt.stopPropagation(),nt(Be,Pe.key,ue[Pe.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:ue[Pe.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:Pe.label})]},Pe.key))})]},Be||ge)})})}):s.jsx(s.Fragment,{children:q?Ee.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:Ee.map(pe=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${($==null?void 0:$.id)===pe.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>xt(pe),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:pe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:pe.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",pe.serialNumber]}),pe.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",pe.macAddress]})]})]}),($==null?void 0:$.id)===pe.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},pe.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var ue;const pe=t.WRK_CD_NM||g0(t.WRK_CD)||t.workType||"-",ge=t.PROD_NM||t.productName||((ue=t.customer)==null?void 0:ue.productName)||"-",Be=t.CTRT_STAT_NM||Qu(t.CTRT_STAT)||"-";return s.jsx(f0,{isOpen:Z,onClose:()=>le(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:Be,prodGrp:t.PROD_GRP||"",prodNm:ge,wrkCdNm:pe,onSave:it,showToast:r,installedEquipmentCount:R.length})})(),!C&&s.jsx("button",{onClick:ut,disabled:Dt,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${Dt?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:se,onClose:()=>Re(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((Ye=t.customer)==null?void 0:Ye.id)}),s.jsx(m0,{isOpen:be,onClose:()=>De(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),re&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!ve&&me(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:pe=>pe.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:ve?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):de==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:ae})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:ae})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${de==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>me(!1),disabled:ve,children:ve?" ...":""})})]})}),document.body)]})},FY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var qe;const g=t.id,C=o||t.WRK_STAT_CD==="4"||t.status==="",y=t.WRK_DTL_TCD==="0440",{setFilteringData:S}=ta(),{initWorkState:v,setApiData:k,setDataLoaded:L,addInstalledEquipment:M,removeInstalledEquipment:P,setInstalledEquipments:F,setSelectedContract:G,setSelectedStock:B,clearSelection:I,toggleRemovalStatus:E,setFullRemovalStatus:A,addMarkedForRemoval:Y,removeMarkedForRemoval:ee,setMarkedForRemoval:J,setSignalStatus:H,setSignalResult:V}=ki(),{contractEquipments:K,technicianEquipments:j,removeEquipments:te,installedEquipments:ce,markedForRemoval:R,removalStatus:O,selectedContract:U,selectedStock:Q,signalStatus:q,signalResult:$,filteringData:de,isReady:ae}=xa(g),[_e,ie]=b.useState(0),[Ne,X]=b.useState("removal"),[xe,fe]=b.useState(!1),[Z,le]=b.useState(!1),[se,Re]=b.useState(!1),[be,De]=b.useState(!1),[re,me]=b.useState(!1),[ve,et]=b.useState(!1),[Dt,ot]=b.useState(!1);b.useEffect(()=>{if(ae&&(ce.length>0||R.length>0||K.length>0)){console.log("[-]    -   ");return}v(g),At()},[t.id]);const At=async(Ee=!1)=>{var Ye,pe,ge,Be,ue;try{let we;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Ee)console.log("[-Suspension] Pre-loaded   -",i.contractEquipments.length," "),we=i;else{Ee?console.log("[-Suspension]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-Suspension] preloadedApiData   - API ");const Ue=localStorage.getItem("userInfo");if(!Ue){console.error("  .");return}const ss=JSON.parse(Ue),ls=P_(t.WRK_CD),ds={WRKR_ID:t.WRKR_ID||ss.userId||ss.workerId||"",SO_ID:t.SO_ID||ss.soId,WRK_ID:t.id,CUST_ID:((Ye=t.customer)==null?void 0:Ye.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:ls,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-Suspension] API :",ds),we=await Co(ds),Ee&&a&&(console.log("[-Suspension]   preloadedData "),a(we))}console.log("[-Suspension] API :",{contractEquipments:((pe=we.contractEquipments)==null?void 0:pe.length)||0,technicianEquipments:((ge=we.technicianEquipments)==null?void 0:ge.length)||0,customerEquipments:((Be=we.customerEquipments)==null?void 0:Be.length)||0,removedEquipments:((ue=we.removedEquipments)==null?void 0:ue.length)||0});const Pe={kpiProdGrpCd:we.kpiProdGrpCd,prodChgGb:we.prodChgGb,chgKpiProdGrpCd:we.chgKpiProdGrpCd,prodGrp:we.prodGrp};S(Pe),window.__equipmentFilterData=Pe;const Nt=(we.contractEquipments||[]).map(Ue=>({id:Ue.SVC_CMPS_ID||Ue.PROD_CMPS_ID,type:Ue.ITEM_MID_NM||Ue.EQT_NM,model:Ue.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD})),Oe=(we.technicianEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ue.EQT_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD,EQT_SALE_AMT:Ue.EQT_SALE_AMT,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,OLD_LENT_YN:Ue.OLD_LENT_YN,LENT:Ue.LENT,LENT_YN:Ue.LENT_YN,ITLLMT_PRD:Ue.ITLLMT_PRD,EQT_USE_STAT_CD:Ue.EQT_USE_STAT_CD})),dt=new Set,gt=(we.customerEquipments||[]).map(Ue=>{const ss=Nt.find(ls=>ls.itemMidCd===Ue.ITEM_MID_CD&&!dt.has(ls.id));return ss&&dt.add(ss.id),{contractEquipment:ss||{id:"unknown",type:Ue.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD},actualEquipment:{id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT},macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN}}),It=(we.removedEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT}));k(g,{contractEquipments:Nt,technicianEquipments:Oe,removeEquipments:It,filteringData:Pe}),ie(gt.length);const $e=R||[],$t=ce||[];if(gt.length>0)if(console.log("[-Suspension] API    :",gt.length,""),$e.length>0){console.log("[-Suspension] Zustand  :",$e.length,"");const Ue=new Set($e.map(ls=>ls.id)),ss=gt.filter(ls=>!Ue.has(ls.actualEquipment.id));console.log("[-Suspension]     :",ss.length,""),F(g,ss)}else{const Ue=new Set(Nt.map(ds=>ds.SVC_CMPS_ID).filter(Boolean)),ss=[],ls=[];gt.forEach(ds=>{const vs=ds.actualEquipment.SVC_CMPS_ID,Ss=ds.actualEquipment.EQT_KND;vs&&!Ue.has(vs)&&Ss==="CUST"?ss.push(ds.actualEquipment):ls.push(ds)}),ss.length>0?(console.log("[-Suspension]  :      :",ss.length,""),J(g,ss),F(g,ls)):F(g,gt)}else $t.length>0&&console.log("[-Suspension] Zustand  :",$t.length,"");requestAnimationFrame(()=>L(g,!0))}catch(we){console.error("[-Suspension]    :",we),requestAnimationFrame(()=>L(g,!0))}},ct=async(Ee,Ye)=>{try{const pe=localStorage.getItem("userInfo");if(!pe){r==null||r("  .","error");return}const ge=JSON.parse(pe),Be=Ee.map((we,Je)=>{let Pe=we.ITEM_MID_CD||we.ITM_MID_CD||we.EQT||we.EQT_CD||"",Nt=we.EQT_CL||we.EQT_CL_CD||"",Oe=we.SVC_CMPS_ID||we.PROD_CMPS_ID||we.SVC_CMPS_SEQ||we.EQUIP_SEQ||"";return Pe=String(Pe).trim().padStart(2,"0"),Nt=String(Nt).trim().padStart(6,"0"),Oe=String(Oe||Je+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||ge.crrId||"",WRKR_ID:t.WRKR_ID||ge.userId||ge.workerId||"",REG_UID:ge.userId||ge.workerId||"A20130708",ITEM_MID_CD:Pe,EQT_CL:Nt,SVC_CMPS_ID:Oe,EQT:Pe,EQT_CD:Pe,LENT:String(we.LENT||"10"),EQT_USE_STAT_CD:String(we.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(we.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(we.EQT_SALE_AMT||0),PROD_GRP:String(we.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(we.PROD_CD||t.PROD_CD||""),SVC_CD:String(we.SVC_CD||""),PROM_CNT:Ye||"",SEL:"1",EQT_BASIC_YN:String(we.EQT_BASIC_YN||"N"),PROD_TYP:we.PROD_TYP,EQUIP_SEQ:we.EQUIP_SEQ}}),ue=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:Ye||"",equipments:Be});if(ue.MSGCODE==="SUCCESS"||ue.MSGCODE==="0"||ue.code==="SUCCESS")r==null||r("  .","success"),F(g,[]),J(g,[]),I(g),await At(!0);else throw new Error(ue.MESSAGE||ue.message||"   .")}catch(pe){throw console.error("[-]    :",pe),r==null||r(pe.message||"     .","error",!0),pe}},Ge=Ee=>{const Ye=ce.find(pe=>pe.contractEquipment.id===Ee.id);(U==null?void 0:U.id)===Ee.id?(G(g,null),B(g,null)):(G(g,Ee),Ye?B(g,Ye.actualEquipment):B(g,null))},at=()=>{if(!U||!Q)return;if(U.itemMidCd!==Q.itemMidCd||U.model!==Q.model){r==null||r("      .","warning");return}if(R.some(Be=>Be.id===Q.id)){mt(Q);return}const Ye=ce.find(Be=>Be.contractEquipment.id===U.id&&!j.some(ue=>ue.id===Be.actualEquipment.id)),pe=Ye&&R.some(Be=>Be.id===Ye.actualEquipment.id);if(Ye&&!pe){r==null||r("   .","warning");return}const ge=ce.findIndex(Be=>Be.contractEquipment.id===U.id);if(ge>=0){const Be=[...ce];Be[ge]={contractEquipment:U,actualEquipment:Q,macAddress:Q.macAddress||"",installLocation:""},F(g,Be)}else{const Be={contractEquipment:U,actualEquipment:Q,macAddress:Q.macAddress||"",installLocation:""};F(g,[...ce,Be])}H(g,"idle"),B(g,null)},xt=()=>{if(!Q)return;const Ee=ce.findIndex(ge=>ge.actualEquipment.id===Q.id);if(Ee>=0){const ge=[...ce],Be=ge.splice(Ee,1)[0];F(g,ge);const ue=Be.actualEquipment;R.some(Je=>Je.id===ue.id)||Y(g,ue),H(g,"idle"),B(g,null);return}if(R.some(ge=>ge.id===Q.id))return;te.some(ge=>ge.id===Q.id)&&Y(g,Q)},mt=Ee=>{if(R.findIndex(ue=>ue.id===Ee.id)===-1){r==null||r("       .","error");return}if(U&&(U.itemMidCd!==Ee.itemMidCd||U.model!==Ee.model)){r==null||r("      .","warning");return}const pe=U||K.find(ue=>ue.itemMidCd===Ee.itemMidCd&&ue.model===Ee.model);if(!pe){r==null||r("      .","warning");return}if(pe&&ce.find(we=>we.contractEquipment.id===pe.id&&!j.some(Je=>Je.id===we.actualEquipment.id))){r==null||r("   .","warning");return}const ge={contractEquipment:pe,actualEquipment:{...Ee,EQT_CHG_GB:"3"},macAddress:Ee.macAddress};F(g,[...ce,ge]),ee(g,Ee.id);const Be={...O};delete Be[Ee.id],A(g,Be),B(g,null),console.log("[-Suspension]  :",Ee.model||Ee.type),r==null||r(" .","success")},Ve=async()=>{var Ee,Ye,pe,ge;if(ce.length===0){r==null||r("    .","warning"),H(g,"fail");return}try{et(!0),me(!0),V(g," ...");const Be=localStorage.getItem("userInfo");if(!Be){V(g,"    ."),H(g,"fail"),et(!1);return}const ue=JSON.parse(Be),we=ue.userId||ue.id||"UNKNOWN",Je=$e=>{var ls,ds,vs,Ss,ke;const $t=((ls=$e.actualEquipment)==null?void 0:ls.eqtClCd)||$e.eqtClCd||((ds=$e.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((vs=$e.actualEquipment)==null?void 0:vs.itemMidCd)||$e.itemMidCd||((Ss=$e.actualEquipment)==null?void 0:Ss.ITEM_MID_CD)||"",ss=(((ke=$e.actualEquipment)==null?void 0:ke.type)||$e.type||"").toLowerCase();return!!($t.startsWith("0904")||Ue==="02"||ss.includes("stb")||ss.includes(""))},Pe=$e=>{var ls,ds,vs,Ss,ke;const $t=((ls=$e.actualEquipment)==null?void 0:ls.eqtClCd)||$e.eqtClCd||((ds=$e.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((vs=$e.actualEquipment)==null?void 0:vs.itemMidCd)||$e.itemMidCd||((Ss=$e.actualEquipment)==null?void 0:Ss.ITEM_MID_CD)||"",ss=(((ke=$e.actualEquipment)==null?void 0:ke.type)||$e.type||"").toLowerCase();return!!($t.startsWith("0902")||Ue==="03"||ss.includes("modem")||ss.includes(""))},Nt=ce.find(Je),Oe=ce.find(Pe),dt=((Ee=Nt==null?void 0:Nt.actualEquipment)==null?void 0:Ee.id)||"",gt=((Ye=Oe==null?void 0:Oe.actualEquipment)==null?void 0:Ye.id)||"",It=await qu(we,t.CTRT_ID||"",t.id,"SMR03",dt||((ge=(pe=ce[0])==null?void 0:pe.actualEquipment)==null?void 0:ge.id)||"",gt||"");It.O_IFSVC_RESULT&&It.O_IFSVC_RESULT.startsWith("TRUE")?(V(g,` 

: ${It.O_IFSVC_RESULT||""}`),H(g,"success")):(V(g,` 

${It.MESSAGE||"   "}`),H(g,"fail"))}catch(Be){V(g,` 

${Be.message||"   "}`),H(g,"fail")}finally{et(!1)}},it=(Ee,Ye,pe)=>{const ge={...O,[Ee]:{...O[Ee]||{},[Ye]:pe==="1"?"0":"1"}};A(g,ge)},Fe=Ee=>{(Q==null?void 0:Q.id)===Ee.id?B(g,null):B(g,Ee)},nt=()=>{const Ee=new Set(ce.map(pe=>pe.actualEquipment.id));let Ye=j.filter(pe=>!Ee.has(pe.id));return U&&(Ye=Ye.filter(pe=>pe.itemMidCd===U.itemMidCd&&pe.model===U.model)),Ye},lt=()=>{De(!0),setTimeout(()=>{De(!1),r==null||r("    .","info")},500)},Mt=async()=>{if(!(Dt||C)){ot(!0);try{await At(!0),r==null||r("  .","success")}catch(Ee){console.error("[-]  :",Ee),r==null||r("   .","error")}finally{ot(!1)}}},ut=nt();return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[Dt&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsxs("button",{onClick:Mt,disabled:Dt||C,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${Dt||C?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ai,{className:`w-3.5 h-3.5 ${Dt?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[K.length,""]})]}),s.jsxs("div",{className:`grid gap-2 ${y?"grid-cols-3":"grid-cols-1"}`,children:[y&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{C||Re(!0)},disabled:C,children:[s.jsx(J2,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||C,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":q==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":q==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!C&&!ve&&Ve(),disabled:C||ve,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>c?le(!0):fe(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:c?"LDAP":""})]})]})]}),ae?K.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:K.map(Ee=>{const Ye=ce.find(ge=>ge.contractEquipment.id===Ee.id),pe=(U==null?void 0:U.id)===Ee.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${C?Ye?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":y?pe?"border-blue-500 bg-blue-50 cursor-pointer":Ye?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer":Ye?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default"}`,onClick:()=>!C&&Ge(Ee),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ee.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ee.model})]}),Ye&&(()=>{const ge=j.some(Be=>Be.id===Ye.actualEquipment.id);return s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",Ye.actualEquipment.model]}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ge?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:ge?"":""})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",Ye.actualEquipment.serialNumber]}),Ye.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",Ye.macAddress]})]})})()]})},Ee.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!C&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!Q||!ce.some(Ee=>Ee.actualEquipment.id===Q.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!Q)return;if(j.some(Ye=>Ye.id===Q.id)){const Ye=ce.findIndex(pe=>pe.actualEquipment.id===Q.id);if(Ye>=0){const pe=[...ce];pe.splice(Ye,1),F(g,pe),B(g,null),r==null||r("  .","success")}return}xt(),X("removal")},disabled:!Q||!ce.some(Ee=>Ee.actualEquipment.id===Q.id),children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),y&&s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!U||!Q||ce.some(Ee=>Ee.actualEquipment.id===Q.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:at,disabled:!U||!Q||ce.some(Ee=>Ee.actualEquipment.id===Q.id),children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!C&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${Ne==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>X("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),R.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${Ne==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:R.length})]})}),y&&s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${Ne==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>X("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),U&&ut.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${Ne==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:ut.length})]})})]}),Ne==="removal"?s.jsx(s.Fragment,{children:R.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:R.map((Ee,Ye)=>{const pe=Ee.id,ge=O[pe]||{},Be=ge.EQT_LOSS_YN==="1"||ge.PART_LOSS_BRK_YN==="1"||ge.EQT_BRK_YN==="1"||ge.EQT_CABL_LOSS_YN==="1"||ge.EQT_CRDL_LOSS_YN==="1",ue=(Q==null?void 0:Q.id)===Ee.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${ue?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>Fe(Ee),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ee.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Ee.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Ee.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${Be?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:Be?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(we=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${ge[we.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Je=>{Je.stopPropagation(),it(pe,we.key,ge[we.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:ge[we.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:we.label})]},we.key))})]},pe||Ye)})})}):s.jsx(s.Fragment,{children:U?ut.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:ut.map(Ee=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(Q==null?void 0:Q.id)===Ee.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Fe(Ee),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Ee.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Ee.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Ee.serialNumber]}),Ee.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Ee.macAddress]})]})]}),(Q==null?void 0:Q.id)===Ee.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Ee.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),!C&&y&&s.jsx("button",{onClick:lt,disabled:be,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${be?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:xe,onClose:()=>fe(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((qe=t.customer)==null?void 0:qe.id)}),s.jsx(m0,{isOpen:Z,onClose:()=>le(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),y&&(()=>{const Ee=t.PROD_NM||t.details||"-",Ye=t.WRK_CD_NM||g0(t.WRK_CD)||"-";return s.jsx(f0,{isOpen:se,onClose:()=>Re(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",prodGrp:t.PROD_GRP||"",prodNm:Ee,wrkCdNm:Ye,onSave:ct,showToast:r,installedEquipmentCount:ce.length})})(),re&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!ve&&me(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Ee=>Ee.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:ve?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):q==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:$})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:$})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${q==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>me(!1),disabled:ve,children:ve?" ...":""})})]})}),document.body)]})},KY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var ut;const g=t.id,C=o||t.WRK_STAT_CD==="4"||t.status==="",[y,S]=b.useState(""),{setFilteringData:v}=ta(),{initWorkState:k,setApiData:L,setDataLoaded:M,setInstalledEquipments:P,setSelectedContract:F,setSelectedStock:G,toggleRemovalStatus:B,setFullRemovalStatus:I,addMarkedForRemoval:E,removeMarkedForRemoval:A,setMarkedForRemoval:Y,setSignalStatus:ee,setSignalResult:J}=ki(),{contractEquipments:H,technicianEquipments:V,removeEquipments:K,installedEquipments:j,markedForRemoval:te,removalStatus:ce,pendingLossStatusList:R,selectedContract:O,selectedStock:U,signalStatus:Q,signalResult:q,filteringData:$,isReady:de}=xa(g),[ae,_e]=b.useState(0),[ie,Ne]=b.useState("removal"),[X,xe]=b.useState(!1),[fe,Z]=b.useState(!1),[le,se]=b.useState(!1),[Re,be]=b.useState(!1),[De,re]=b.useState(!1),[me,ve]=b.useState(!1),[et,Dt]=b.useState(!1),[ot,At]=b.useState("");b.useEffect(()=>{const qe=t.DTL_CTRT_ID||t.CTRT_ID;qe&&OM(qe,t.CUST_ID).then(Ee=>{Ee!=null&&Ee.BASIC_PROD_CD_NM&&At(Ee.BASIC_PROD_CD_NM)})},[t.DTL_CTRT_ID,t.CTRT_ID,t.CUST_ID]),b.useEffect(()=>{if(de&&(j.length>0||te.length>0||H.length>0)){console.log("[-]    -   ");return}k(g),ct()},[t.id]);const ct=async(qe=!1)=>{var Ee,Ye,pe,ge,Be;try{let ue;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!qe)console.log("[Equipment-ProductChange] Using preloadedApiData with",i.contractEquipments.length,"contract equipments"),ue=i;else{qe?console.log("[Equipment-ProductChange] Force refresh - calling API"):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[Equipment-ProductChange] preloadedApiData has no contract equipments, calling API fresh");const Ue=localStorage.getItem("userInfo");if(!Ue){console.error("User info not found");return}const ss=JSON.parse(Ue),ls=t.DTL_CTRT_ID||t.CTRT_ID,ds={WRKR_ID:t.WRKR_ID||ss.userId||ss.workerId||"",SO_ID:t.SO_ID||ss.soId,WRK_ID:t.id,CUST_ID:((Ee=t.customer)==null?void 0:Ee.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:ls,OLD_CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"05",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[Equipment-ProductChange] API call (DTL_CTRT_ID ):",ds),ue=await Co(ds),qe&&a&&(console.log("[Equipment-ProductChange] Updating parent preloadedData"),a(ue))}console.log("[Equipment-ProductChange] API response:",{contractEquipments:((Ye=ue.contractEquipments)==null?void 0:Ye.length)||0,technicianEquipments:((pe=ue.technicianEquipments)==null?void 0:pe.length)||0,customerEquipments:((ge=ue.customerEquipments)==null?void 0:ge.length)||0,removedEquipments:((Be=ue.removedEquipments)==null?void 0:Be.length)||0});const Je={kpiProdGrpCd:ue.kpiProdGrpCd,prodChgGb:ue.prodChgGb,chgKpiProdGrpCd:ue.chgKpiProdGrpCd,prodGrp:ue.prodGrp};v(Je),window.__equipmentFilterData=Je;const Pe=(ue.contractEquipments||[]).map(Ue=>({id:Ue.SVC_CMPS_ID||Ue.PROD_CMPS_ID,type:Ue.ITEM_MID_NM||Ue.EQT_NM,model:Ue.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD})),Nt=ue.chgResnCd||t.CHG_RESN_CD||"";S(Nt);let Oe=(ue.technicianEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Ue.EQT_PROD_CMPS_ID,PROD_CD:Ue.PROD_CD,SVC_CD:Ue.SVC_CD,EQT_SALE_AMT:Ue.EQT_SALE_AMT,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,OLD_LENT_YN:Ue.OLD_LENT_YN,LENT:Ue.LENT,LENT_YN:Ue.LENT_YN,ITLLMT_PRD:Ue.ITLLMT_PRD,EQT_USE_STAT_CD:Ue.EQT_USE_STAT_CD,BAR_CD:Ue.BAR_CD,CHG_RESN_CD:Ue.CHG_RESN_CD}));Nt==="H08"&&(Oe=Oe.filter(Ue=>(Ue.itemMidCd!=="04",!0)),console.log("[Equipment-ProductChange] CHG_RESN_CD=H08 (ARPU) - STB BAR_CD  "));const dt=new Set,gt=(ue.customerEquipments||[]).map(Ue=>{const ss=Pe.find(ls=>ls.itemMidCd===Ue.ITEM_MID_CD&&!dt.has(ls.id));return ss&&dt.add(ss.id),{contractEquipment:ss||{id:"unknown",type:Ue.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Ue.ITEM_MID_CD},actualEquipment:{id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT},macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN}}),It=(ue.removedEquipments||[]).map(Ue=>({id:Ue.EQT_NO,type:Ue.ITEM_MID_NM,model:Ue.EQT_CL_NM,serialNumber:Ue.EQT_SERNO,itemMidCd:Ue.ITEM_MID_CD,eqtClCd:Ue.EQT_CL_CD||Ue.EQT_CL,macAddress:Ue.MAC_ADDRESS||Ue.MAC_ADDR,installLocation:Ue.INSTL_LCTN,SVC_CMPS_ID:Ue.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Ue.BASIC_PROD_CMPS_ID,MST_SO_ID:Ue.MST_SO_ID,SO_ID:Ue.SO_ID,LENT_YN:Ue.LENT_YN,VOIP_CUSTOWN_EQT:Ue.VOIP_CUSTOWN_EQT}));L(g,{contractEquipments:Pe,technicianEquipments:Oe,removeEquipments:It,filteringData:Je}),_e(gt.length),console.log("[Equipment-ProductChange] ====== Equipment Initialization Started ======");const $e=j||[],$t=te||[];if(gt.length>0?(console.log("[Equipment-ProductChange] Using customer equipment from API:",gt.length,"items"),P(g,gt)):$e.length>0&&console.log("[Equipment-ProductChange] Zustand  :",$e.length,""),It.length>0&&$t.length===0)console.log("[Equipment-ProductChange] API output5  markedForRemoval :",It.length,""),Y(g,It);else if(It.length>0){const Ue=new Set($t.map(ls=>ls.id)),ss=It.filter(ls=>!Ue.has(ls.id));ss.length>0&&(console.log("[Equipment-ProductChange] API output5  :",ss.length," "),Y(g,[...$t,...ss]))}console.log("[Equipment-ProductChange] ====== Equipment Initialization Complete ======"),requestAnimationFrame(()=>M(g,!0))}catch(ue){console.error("[Equipment-ProductChange] Failed to load equipment data:",ue),requestAnimationFrame(()=>M(g,!0))}},Ge=qe=>{const Ee=j.find(Ye=>Ye.contractEquipment.id===qe.id);(O==null?void 0:O.id)===qe.id?(F(g,null),G(g,null)):(F(g,qe),Ee?G(g,Ee.actualEquipment):G(g,null))},at=qe=>{(U==null?void 0:U.id)===qe.id?G(g,null):G(g,qe)},xt=()=>{if(!O||!U)return;if(O.itemMidCd!==U.itemMidCd||O.model!==U.model){r==null||r("      .","warning");return}const qe=K.some(pe=>pe.id===U.id);console.log("[Equipment-ProductChange] Registering equipment:",{contractEquipment:O.type,stockEquipment:`${U.type} (S/N: ${U.serialNumber})`,isReuse:qe});const Ee=j.findIndex(pe=>pe.contractEquipment.id===O.id),Ye={...U,EQT_CHG_GB:qe?"3":U.EQT_CHG_GB||"1"};if(Ee>=0){const pe=[...j];pe[Ee]={contractEquipment:O,actualEquipment:Ye,macAddress:U.macAddress||"",installLocation:""},P(g,pe)}else{const pe={contractEquipment:O,actualEquipment:Ye,macAddress:U.macAddress||"",installLocation:""};P(g,[...j,pe])}qe&&A(g,U.id),ee(g,"idle"),G(g,null)},mt=()=>{if(!U)return;const qe=j.findIndex(pe=>pe.actualEquipment.id===U.id);if(qe>=0){const pe=[...j],ge=pe.splice(qe,1)[0];P(g,pe);const Be=ge.actualEquipment;te.some(we=>we.id===Be.id)||E(g,Be),ee(g,"idle"),G(g,null);return}if(te.some(pe=>pe.id===U.id))return;K.some(pe=>pe.id===U.id)&&E(g,U)},Ve=async(qe,Ee)=>{try{const Ye=localStorage.getItem("userInfo");if(!Ye){r==null||r("  .","error");return}const pe=JSON.parse(Ye),ge=t.DTL_CTRT_ID||t.CTRT_ID,Be=qe.map((we,Je)=>{let Pe=we.ITEM_MID_CD||we.ITM_MID_CD||we.EQT||we.EQT_CD||"",Nt=we.EQT_CL||we.EQT_CL_CD||"",Oe=we.SVC_CMPS_ID||we.PROD_CMPS_ID||we.SVC_CMPS_SEQ||we.EQUIP_SEQ||"";return Pe=String(Pe).trim().padStart(2,"0"),Nt=String(Nt).trim().padStart(6,"0"),Oe=String(Oe||Je+1),{CTRT_ID:ge,RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||pe.crrId||"",WRKR_ID:t.WRKR_ID||pe.userId||pe.workerId||"",REG_UID:pe.userId||pe.workerId||"A20130708",ITEM_MID_CD:Pe,EQT_CL:Nt,SVC_CMPS_ID:Oe,EQT:Pe,EQT_CD:Pe,LENT:String(we.LENT||"10"),EQT_USE_STAT_CD:String(we.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(we.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(we.EQT_SALE_AMT||0),PROD_GRP:String(we.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(we.PROD_CD||t.PROD_CD||""),SVC_CD:String(we.SVC_CD||""),PROM_CNT:Ee||"",SEL:"1",EQT_BASIC_YN:String(we.EQT_BASIC_YN||"N"),PROD_TYP:we.PROD_TYP,EQUIP_SEQ:we.EQUIP_SEQ}}),ue=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:ge,CRR_ID:t.CRR_ID||"",PROM_CNT:Ee||"",equipments:Be});if(ue.MSGCODE==="SUCCESS"||ue.MSGCODE==="0"||ue.code==="SUCCESS")r==null||r("  .","success"),await ct(!0);else throw new Error(ue.MESSAGE||ue.message||"   .")}catch(Ye){throw console.error("[] :",Ye),r==null||r(Ye.message||"     .","error",!0),Ye}},it=async()=>{var qe,Ee,Ye,pe;if(j.length===0){r==null||r("    .","warning"),ee(g,"fail");return}try{re(!0),be(!0),J(g," ...");const ge=localStorage.getItem("userInfo");if(!ge){J(g,"    ."),ee(g,"fail"),re(!1);return}const Be=JSON.parse(ge),ue=Be.userId||Be.id||"UNKNOWN",we=$e=>{var ls,ds,vs,Ss,ke;const $t=((ls=$e.actualEquipment)==null?void 0:ls.eqtClCd)||$e.eqtClCd||((ds=$e.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((vs=$e.actualEquipment)==null?void 0:vs.itemMidCd)||$e.itemMidCd||((Ss=$e.actualEquipment)==null?void 0:Ss.ITEM_MID_CD)||"",ss=(((ke=$e.actualEquipment)==null?void 0:ke.type)||$e.type||"").toLowerCase();return!!($t.startsWith("0904")||Ue==="02"||ss.includes("stb")||ss.includes(""))},Je=$e=>{var ls,ds,vs,Ss,ke;const $t=((ls=$e.actualEquipment)==null?void 0:ls.eqtClCd)||$e.eqtClCd||((ds=$e.actualEquipment)==null?void 0:ds.EQT_CL_CD)||"",Ue=((vs=$e.actualEquipment)==null?void 0:vs.itemMidCd)||$e.itemMidCd||((Ss=$e.actualEquipment)==null?void 0:Ss.ITEM_MID_CD)||"",ss=(((ke=$e.actualEquipment)==null?void 0:ke.type)||$e.type||"").toLowerCase();return!!($t.startsWith("0902")||Ue==="03"||ss.includes("modem")||ss.includes(""))},Pe=j.find(we),Nt=j.find(Je),Oe=((qe=Pe==null?void 0:Pe.actualEquipment)==null?void 0:qe.id)||"",dt=((Ee=Nt==null?void 0:Nt.actualEquipment)==null?void 0:Ee.id)||"",gt=t.DTL_CTRT_ID||t.CTRT_ID,It=await qu(ue,gt,t.id,"SMR03",Oe||((pe=(Ye=j[0])==null?void 0:Ye.actualEquipment)==null?void 0:pe.id)||"",dt||"");It.O_IFSVC_RESULT&&It.O_IFSVC_RESULT.startsWith("TRUE")?(J(g,` 

: ${It.O_IFSVC_RESULT||""}`),ee(g,"success")):(J(g,` 

${It.MESSAGE||"   "}`),ee(g,"fail"))}catch(ge){J(g,` 

${ge.message||"   "}`),ee(g,"fail")}finally{re(!1)}},Fe=(qe,Ee)=>{B(g,qe,Ee)},nt=b.useMemo(()=>{const qe=new Set(j.map(Ye=>Ye.actualEquipment.id));let Ee=V.filter(Ye=>!qe.has(Ye.id));return O&&(Ee=Ee.filter(Ye=>Ye.itemMidCd===O.itemMidCd&&Ye.model===O.model)),Ee},[j,V,O]);b.useMemo(()=>{const qe=new Set(j.map(Ye=>Ye.actualEquipment.id));let Ee=te.filter(Ye=>!qe.has(Ye.id));return O&&(Ee=Ee.filter(Ye=>Ye.itemMidCd===O.itemMidCd&&Ye.model===O.model)),Ee},[j,te,O]);const lt=()=>{ve(!0),setTimeout(()=>{ve(!1),r==null||r("    .","info")},500)},Mt=async()=>{if(!(et||C)){Dt(!0);try{await ct(!0),r==null||r("  .","success")}catch(qe){console.error("[-]  :",qe),r==null||r("   .","error")}finally{Dt(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[et&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 gap-1",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900 truncate",children:["  ",ot&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",ot,")"]})]}),s.jsxs("button",{onClick:Mt,disabled:et||C,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${et||C?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ai,{className:`w-3.5 h-3.5 ${et?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[H.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{C||xe(!0)},disabled:C,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||C,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${C?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":Q==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":Q==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!C&&!De&&it(),disabled:C||De,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300 transition-all active:scale-95 min-h-[56px]",onClick:()=>c?se(!0):Z(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:c?"LDAP":""})]})]})]}),de?H.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:H.map(qe=>{const Ee=j.find(pe=>pe.contractEquipment.id===qe.id),Ye=(O==null?void 0:O.id)===qe.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${C?Ee?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Ye?"border-blue-500 bg-blue-50 cursor-pointer":Ee?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!C&&Ge(qe),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:qe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:qe.model})]}),Ee&&(()=>{const pe=V.some(ge=>ge.id===Ee.actualEquipment.id);return s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",Ee.actualEquipment.model]}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${pe?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:pe?"":""})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",Ee.actualEquipment.serialNumber]}),Ee.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",Ee.macAddress]})]})})()]})},qe.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"  ..."})]})})]}),!C&&s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${t.WRK_DTL_TCD==="0510"||!U||!j.some(qe=>qe.actualEquipment.id===(U==null?void 0:U.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(t.WRK_DTL_TCD==="0510"||!U)return;if(V.some(ge=>ge.id===U.id)){if(ie!=="stock"){r==null||r("  .   .","warning");return}const ge=j.findIndex(Be=>Be.actualEquipment.id===U.id);if(ge>=0){const Be=[...j];Be.splice(ge,1),P(g,Be),G(g,null),console.log("=== [-]     ==="),console.log(":",Be.map(ue=>({type:ue.actualEquipment.type,model:ue.actualEquipment.model,serialNumber:ue.actualEquipment.serialNumber,id:ue.actualEquipment.id}))),console.log(":",te.map(ue=>({type:ue.type,model:ue.model,serialNumber:ue.serialNumber,id:ue.id,removalStatus:ce[ue.id]||{}}))),r==null||r("  .","success")}return}const Ee=j.findIndex(ge=>ge.actualEquipment.id===U.id);let Ye=[...j],pe=[...te];if(Ee>=0){const Be=Ye.splice(Ee,1)[0].actualEquipment;pe.some(we=>we.id===Be.id)||(pe=[...pe,Be])}console.log("=== [-]     ==="),console.log(":",Ye.map(ge=>({type:ge.actualEquipment.type,model:ge.actualEquipment.model,serialNumber:ge.actualEquipment.serialNumber,id:ge.actualEquipment.id}))),console.log(":",pe.map(ge=>({type:ge.type,model:ge.model,serialNumber:ge.serialNumber,id:ge.id,removalStatus:ce[ge.id]||{}}))),mt(),Ne("removal")},disabled:t.WRK_DTL_TCD==="0510"||!U||!j.some(qe=>qe.actualEquipment.id===(U==null?void 0:U.id)),children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!U||j.some(qe=>qe.actualEquipment.id===(U==null?void 0:U.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!U)return;if(te.some(Be=>Be.id===U.id)){if(O&&(O.itemMidCd!==U.itemMidCd||O.eqtClCd!==U.eqtClCd)){r==null||r("      .","warning");return}const Be=O||H.find(Oe=>Oe.itemMidCd===U.itemMidCd&&Oe.eqtClCd===U.eqtClCd);if(!Be){r==null||r("      .   .","warning");return}if(j.find(Oe=>Oe.contractEquipment.id===Be.id)){r==null||r("   .","warning");return}const we={contractEquipment:Be,actualEquipment:U,macAddress:U.macAddress},Je=[...j,we],Pe=te.filter(Oe=>Oe.id!==U.id);P(g,Je),Y(g,Pe);const Nt={...ce};delete Nt[U.id],I(g,Nt),G(g,null),console.log("=== [-]     ==="),console.log(":",Je.map(Oe=>({type:Oe.actualEquipment.type,model:Oe.actualEquipment.model,serialNumber:Oe.actualEquipment.serialNumber,id:Oe.actualEquipment.id}))),console.log(":",Pe.map(Oe=>({type:Oe.type,model:Oe.model,serialNumber:Oe.serialNumber,id:Oe.id,removalStatus:Nt[Oe.id]||{}}))),r==null||r("   .","success");return}if(!O){r==null||r("   .","warning");return}if(j.find(Be=>Be.contractEquipment.id===O.id)){r==null||r("   .","warning");return}const Ye={contractEquipment:O,actualEquipment:U,macAddress:U.macAddress||""},pe=j.findIndex(Be=>Be.contractEquipment.id===O.id);let ge;pe>=0?(ge=[...j],ge[pe]=Ye):ge=[...j,Ye],console.log("=== [-]     ==="),console.log(":",ge.map(Be=>({type:Be.actualEquipment.type,model:Be.actualEquipment.model,serialNumber:Be.actualEquipment.serialNumber,id:Be.actualEquipment.id}))),console.log(":",te.map(Be=>({type:Be.type,model:Be.model,serialNumber:Be.serialNumber,id:Be.id,removalStatus:ce[Be.id]||{}}))),xt()},disabled:!U||j.some(qe=>qe.actualEquipment.id===(U==null?void 0:U.id)),children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!C&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ie==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>Ne("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),te.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ie==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:te.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ie==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>Ne("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),O&&nt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ie==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:nt.length})]})})]}),ie==="removal"?s.jsx(s.Fragment,{children:te.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:te.map((qe,Ee)=>{const Ye=qe.id,pe=ce[Ye]||{},ge=pe.EQT_LOSS_YN==="1"||pe.PART_LOSS_BRK_YN==="1"||pe.EQT_BRK_YN==="1"||pe.EQT_CABL_LOSS_YN==="1"||pe.EQT_CRDL_LOSS_YN==="1",Be=(U==null?void 0:U.id)===qe.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Be?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>at(qe),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:qe.type}),s.jsx("div",{className:"text-xs text-gray-600",children:qe.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",qe.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${ge?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:ge?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(ue=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${pe[ue.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:we=>{we.stopPropagation(),Fe(Ye,ue.key)},children:[s.jsx("input",{type:"checkbox",checked:pe[ue.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:ue.label})]},ue.key))})]},Ye||Ee)})})}):s.jsx(s.Fragment,{children:O?nt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:nt.map(qe=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(U==null?void 0:U.id)===qe.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>at(qe),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:qe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:qe.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",qe.serialNumber]}),qe.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",qe.macAddress]})]})]}),(U==null?void 0:U.id)===qe.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},qe.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var pe;const qe=t.WRK_CD_NM||g0(t.WRK_CD)||t.workType||"-",Ee=t.PROD_NM||t.productName||((pe=t.customer)==null?void 0:pe.productName)||"-",Ye=t.CTRT_STAT_NM||Qu(t.CTRT_STAT)||"-";return s.jsx(f0,{isOpen:X,onClose:()=>xe(!1),prodCd:t.PROD_CD||"",ctrtId:t.DTL_CTRT_ID||t.CTRT_ID||"",ctrtStatNm:Ye,prodGrp:t.PROD_GRP||"",prodNm:Ee,wrkCdNm:qe,onSave:Ve,showToast:r,installedEquipmentCount:j.length,customerEquipmentCount:ae})})(),!C&&s.jsx("button",{onClick:lt,disabled:me,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${me?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:"Barcode Scan",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:fe,onClose:()=>Z(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID,custId:t.CUST_ID||((ut=t.customer)==null?void 0:ut.id)}),s.jsx(m0,{isOpen:le,onClose:()=>se(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),Re&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!De&&be(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:qe=>qe.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:De?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):Q==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:q})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:q})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${Q==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>be(!1),disabled:De,children:De?" ...":""})})]})}),document.body)]})},QY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var it;const g=o||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:C}=ta(),y=t.id,{initWorkState:S,setApiData:v,setDataLoaded:k,setInstalledEquipments:L,setMarkedForRemoval:M,addMarkedForRemoval:P,removeMarkedForRemoval:F,setSelectedContract:G,setSelectedStock:B,setSignalStatus:I,setSignalResult:E,setPendingLossStatusList:A,setRemovalStatus:Y}=ki(),{contractEquipments:ee,technicianEquipments:J,customerEquipments:H,removeEquipments:V,installedEquipments:K,markedForRemoval:j,removalStatus:te,pendingLossStatusList:ce,selectedContract:R,selectedStock:O,signalStatus:U,signalResult:Q,isReady:q}=xa(y);H.length;const[$,de]=b.useState(!1),[ae,_e]=b.useState(!1),[ie,Ne]=b.useState(!1),[X,xe]=b.useState(!1),[fe,Z]=b.useState(!1),[le,se]=b.useState(!1),[Re,be]=b.useState(!1),[De,re]=b.useState("stock");b.useEffect(()=>{if(q&&(K.length>0||j.length>0||ee.length>0)){console.log("[-]    -   ");return}S(y),me()},[t.id]);const me=async(Fe=!1)=>{var nt,lt,Mt,ut,qe;try{let Ee;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Fe)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),Ee=i;else{Fe?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const Oe=localStorage.getItem("userInfo");if(!Oe){console.error("  .");return}const dt=JSON.parse(Oe),gt=P_(t.WRK_CD),It={WRKR_ID:t.WRKR_ID||dt.userId||dt.workerId||"",SO_ID:t.SO_ID||dt.soId,WRK_ID:t.id,CUST_ID:((nt=t.customer)==null?void 0:nt.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:gt,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-] API :",It),Ee=await Co(It),Fe&&a&&(console.log("[-]   preloadedData "),a(Ee))}console.log("[-] API :",{contractEquipments:((lt=Ee.contractEquipments)==null?void 0:lt.length)||0,technicianEquipments:((Mt=Ee.technicianEquipments)==null?void 0:Mt.length)||0,customerEquipments:((ut=Ee.customerEquipments)==null?void 0:ut.length)||0,removedEquipments:((qe=Ee.removedEquipments)==null?void 0:qe.length)||0});const pe={kpiProdGrpCd:Ee.kpiProdGrpCd,prodChgGb:Ee.prodChgGb,chgKpiProdGrpCd:Ee.chgKpiProdGrpCd,prodGrp:Ee.prodGrp};C(pe),window.__equipmentFilterData=pe;const ge=(Ee.contractEquipments||[]).map(Oe=>({id:Oe.SVC_CMPS_ID||Oe.PROD_CMPS_ID,type:Oe.ITEM_MID_NM||Oe.EQT_NM,model:Oe.EQT_CL_NM,serialNumber:"N/A",itemMidCd:Oe.ITEM_MID_CD,eqtClCd:Oe.EQT_CL_CD||Oe.EQT_CL,SVC_CMPS_ID:Oe.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Oe.BASIC_PROD_CMPS_ID,PROD_CD:Oe.PROD_CD,SVC_CD:Oe.SVC_CD})),Be=(Ee.technicianEquipments||[]).map(Oe=>({id:Oe.EQT_NO,type:Oe.ITEM_MID_NM,model:Oe.EQT_CL_NM,serialNumber:Oe.EQT_SERNO,itemMidCd:Oe.ITEM_MID_CD,eqtClCd:Oe.EQT_CL_CD||Oe.EQT_CL,macAddress:Oe.MAC_ADDRESS,SVC_CMPS_ID:Oe.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Oe.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:Oe.EQT_PROD_CMPS_ID,PROD_CD:Oe.PROD_CD,SVC_CD:Oe.SVC_CD,EQT_SALE_AMT:Oe.EQT_SALE_AMT,MST_SO_ID:Oe.MST_SO_ID,SO_ID:Oe.SO_ID,OLD_LENT_YN:Oe.OLD_LENT_YN,LENT:Oe.LENT,LENT_YN:Oe.LENT_YN,ITLLMT_PRD:Oe.ITLLMT_PRD,EQT_USE_STAT_CD:Oe.EQT_USE_STAT_CD})),ue=new Set,we=(Ee.customerEquipments||[]).map(Oe=>{const dt=ge.find(gt=>gt.itemMidCd===Oe.ITEM_MID_CD&&!ue.has(gt.id));return dt&&ue.add(dt.id),{contractEquipment:dt||{id:"unknown",type:Oe.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:Oe.ITEM_MID_CD},actualEquipment:{id:Oe.EQT_NO,type:Oe.ITEM_MID_NM,model:Oe.EQT_CL_NM,serialNumber:Oe.EQT_SERNO,itemMidCd:Oe.ITEM_MID_CD,eqtClCd:Oe.EQT_CL_CD||Oe.EQT_CL,macAddress:Oe.MAC_ADDRESS||Oe.MAC_ADDR,LENT_YN:Oe.LENT_YN,VOIP_CUSTOWN_EQT:Oe.VOIP_CUSTOWN_EQT},macAddress:Oe.MAC_ADDRESS||Oe.MAC_ADDR,installLocation:Oe.INSTL_LCTN}}),Je=(Ee.customerEquipments||[]).map(Oe=>({id:Oe.EQT_NO,type:Oe.ITEM_MID_NM,model:Oe.EQT_CL_NM,serialNumber:Oe.EQT_SERNO,itemMidCd:Oe.ITEM_MID_CD,eqtClCd:Oe.EQT_CL_CD||Oe.EQT_CL,macAddress:Oe.MAC_ADDRESS||Oe.MAC_ADDR,SVC_CMPS_ID:Oe.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Oe.BASIC_PROD_CMPS_ID,LENT_YN:Oe.LENT_YN,VOIP_CUSTOWN_EQT:Oe.VOIP_CUSTOWN_EQT})),Pe=(Ee.removedEquipments||[]).map(Oe=>({id:Oe.EQT_NO,type:Oe.ITEM_MID_NM,model:Oe.EQT_CL_NM,serialNumber:Oe.EQT_SERNO,itemMidCd:Oe.ITEM_MID_CD,eqtClCd:Oe.EQT_CL_CD||Oe.EQT_CL,macAddress:Oe.MAC_ADDRESS||Oe.MAC_ADDR,installLocation:Oe.INSTL_LCTN,SVC_CMPS_ID:Oe.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:Oe.BASIC_PROD_CMPS_ID,MST_SO_ID:Oe.MST_SO_ID,SO_ID:Oe.SO_ID,LENT_YN:Oe.LENT_YN,VOIP_CUSTOWN_EQT:Oe.VOIP_CUSTOWN_EQT}));v(y,{contractEquipments:ge,technicianEquipments:Be,customerEquipments:Je,removeEquipments:Pe,filteringData:pe});const Nt=j||[];if(we.length>0)if(console.log("[-] API     :",we.length,""),Nt.length>0){const Oe=new Set(Nt.map(gt=>gt.id)),dt=we.filter(gt=>!Oe.has(gt.actualEquipment.id));L(y,dt)}else L(y,we);requestAnimationFrame(()=>k(y,!0))}catch(Ee){console.error("[-]    :",Ee),requestAnimationFrame(()=>k(y,!0))}},ve=Fe=>Fe?BY.includes(Fe):!1,et=Fe=>{const nt=K.find(lt=>lt.contractEquipment.id===Fe.id);(R==null?void 0:R.id)===Fe.id?(G(y,null),B(y,null)):(G(y,Fe),nt?B(y,nt.actualEquipment):B(y,null))},Dt=Fe=>{(O==null?void 0:O.id)===Fe.id?B(y,null):B(y,Fe)},ot=()=>{if(!R||!O)return;if(R.itemMidCd!==O.itemMidCd||R.model!==O.model){r==null||r("      .","warning");return}const Fe=O.eqtClCd||O.EQT_CL_CD;if(!ve(Fe)){r==null||r(`     .
`,"error");return}const nt=K.findIndex(lt=>lt.contractEquipment.id===R.id);if(nt>=0){const lt=[...K];lt[nt]={contractEquipment:R,actualEquipment:O,macAddress:O.macAddress||"",installLocation:""},L(y,lt)}else{const lt={contractEquipment:R,actualEquipment:O,macAddress:O.macAddress||"",installLocation:""};L(y,[...K,lt])}I(y,"idle"),B(y,null)},At=()=>{if(!O)return;const Fe=O.eqtClCd||O.EQT_CL_CD;if(!ve(Fe)){r==null||r(`     .
`,"error");return}const nt=K.findIndex(ut=>ut.actualEquipment.id===O.id);if(nt>=0){const ut=[...K],qe=ut.splice(nt,1)[0];L(y,ut);const Ee=qe.actualEquipment;j.some(pe=>pe.id===Ee.id)||P(y,Ee),I(y,"idle"),B(y,null),re("removal");return}if(j.some(ut=>ut.id===O.id))return;V.some(ut=>ut.id===O.id)&&(P(y,O),re("removal"))},ct=async(Fe,nt)=>{try{const lt=localStorage.getItem("userInfo");if(!lt){r==null||r("  .","error");return}const Mt=JSON.parse(lt),ut=Fe.map((Ee,Ye)=>{let pe=Ee.ITEM_MID_CD||Ee.ITM_MID_CD||Ee.EQT||Ee.EQT_CD||"",ge=Ee.EQT_CL||Ee.EQT_CL_CD||"",Be=Ee.SVC_CMPS_ID||Ee.PROD_CMPS_ID||Ee.SVC_CMPS_SEQ||Ee.EQUIP_SEQ||"";return pe=String(pe).trim().padStart(2,"0"),ge=String(ge).trim().padStart(6,"0"),Be=String(Be||Ye+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Mt.crrId||"",WRKR_ID:t.WRKR_ID||Mt.userId||Mt.workerId||"",REG_UID:Mt.userId||Mt.workerId||"A20130708",ITEM_MID_CD:pe,EQT_CL:ge,SVC_CMPS_ID:Be,EQT:pe,EQT_CD:pe,LENT:String(Ee.LENT||"10"),EQT_USE_STAT_CD:String(Ee.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Ee.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Ee.EQT_SALE_AMT||0),PROD_GRP:String(Ee.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Ee.PROD_CD||t.PROD_CD||""),SVC_CD:String(Ee.SVC_CD||""),PROM_CNT:nt||"",SEL:"1",EQT_BASIC_YN:String(Ee.EQT_BASIC_YN||"N"),PROD_TYP:Ee.PROD_TYP,EQUIP_SEQ:Ee.EQUIP_SEQ}}),qe=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:nt||"",equipments:ut});if(qe.MSGCODE==="SUCCESS"||qe.MSGCODE==="0"||qe.code==="SUCCESS")r==null||r("  .","success"),await me(!0);else throw new Error(qe.MESSAGE||qe.message||"   .")}catch(lt){throw console.error("[] :",lt),r==null||r(lt.message||"     .","error",!0),lt}},Ge=async()=>{var Fe,nt,lt,Mt;if(K.length===0){r==null||r("    .","warning"),I(y,"fail");return}try{Z(!0),xe(!0),E(y," ...");const ut=localStorage.getItem("userInfo");if(!ut){E(y,"    ."),I(y,"fail"),Z(!1);return}const qe=JSON.parse(ut),Ee=qe.userId||qe.id||"UNKNOWN",Ye=Pe=>{var gt,It,$e,$t,Ue;const Nt=((gt=Pe.actualEquipment)==null?void 0:gt.eqtClCd)||Pe.eqtClCd||((It=Pe.actualEquipment)==null?void 0:It.EQT_CL_CD)||"",Oe=(($e=Pe.actualEquipment)==null?void 0:$e.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",dt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Nt.startsWith("0904")||Oe==="02"||dt.includes("stb")||dt.includes(""))},pe=Pe=>{var gt,It,$e,$t,Ue;const Nt=((gt=Pe.actualEquipment)==null?void 0:gt.eqtClCd)||Pe.eqtClCd||((It=Pe.actualEquipment)==null?void 0:It.EQT_CL_CD)||"",Oe=(($e=Pe.actualEquipment)==null?void 0:$e.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",dt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Nt.startsWith("0902")||Oe==="03"||dt.includes("modem")||dt.includes(""))},ge=K.find(Ye),Be=K.find(pe),ue=((Fe=ge==null?void 0:ge.actualEquipment)==null?void 0:Fe.id)||"",we=((nt=Be==null?void 0:Be.actualEquipment)==null?void 0:nt.id)||"",Je=await qu(Ee,t.CTRT_ID||"",t.id,"SMR03",ue||((Mt=(lt=K[0])==null?void 0:lt.actualEquipment)==null?void 0:Mt.id)||"",we||"");Je.O_IFSVC_RESULT&&Je.O_IFSVC_RESULT.startsWith("TRUE")?(E(y,` 

: ${Je.O_IFSVC_RESULT||""}`),I(y,"success")):(E(y,` 

${Je.MESSAGE||"   "}`),I(y,"fail"))}catch(ut){E(y,` 

${ut.message||"   "}`),I(y,"fail")}finally{Z(!1)}},at=(Fe,nt,lt)=>{Y(y,Fe,nt,lt==="1"?"0":"1")},xt=b.useMemo(()=>{const Fe=new Set(K.map(lt=>lt.actualEquipment.id));let nt=J.filter(lt=>!Fe.has(lt.id));return R&&(nt=nt.filter(lt=>lt.itemMidCd===R.itemMidCd&&lt.model===R.model)),nt},[K,J,R]);b.useMemo(()=>{const Fe=new Set(K.map(lt=>lt.actualEquipment.id));let nt=j.filter(lt=>!Fe.has(lt.id));return R&&(nt=nt.filter(lt=>lt.itemMidCd===R.itemMidCd&&lt.model===R.model)),nt},[K,j,R]);const mt=()=>{se(!0),setTimeout(()=>{se(!1),r==null||r("    .","info")},500)},Ve=async()=>{if(!(Re||g)){be(!0);try{await me(!0),r==null||r("  .","success")}catch(Fe){console.error("[-]  :",Fe),r==null||r("   .","error")}finally{be(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[Re&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsx("button",{onClick:Ve,disabled:Re||g,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${Re||g?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:s.jsx(Ai,{className:`w-4 h-4 ${Re?"animate-spin":""}`})})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[ee.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>!g&&de(!0),disabled:g,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||g,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":U==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":U==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!g&&!fe&&Ge(),disabled:g||fe,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>c?Ne(!0):_e(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:c?"LDAP":""})]})]})]}),q?ee.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:ee.map(Fe=>{const nt=K.find(Mt=>Mt.contractEquipment.id===Fe.id),lt=(R==null?void 0:R.id)===Fe.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${g?nt?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":lt?"border-blue-500 bg-blue-50 cursor-pointer":nt?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!g&&et(Fe),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Fe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Fe.model})]}),nt&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",nt.actualEquipment.model]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",nt.actualEquipment.serialNumber]}),nt.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",nt.macAddress]})]})]})},Fe.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!g&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!O||!(K.some(Fe=>Fe.actualEquipment.id===O.id)||V.some(Fe=>Fe.id===O.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-red-500 bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer active:scale-95"}`,onClick:At,disabled:!O||!(K.some(Fe=>Fe.actualEquipment.id===O.id)||V.some(Fe=>Fe.id===O.id)),children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!R||!O||K.some(Fe=>Fe.actualEquipment.id===O.id)?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:ot,disabled:!R||!O||K.some(Fe=>Fe.actualEquipment.id===O.id),children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!g&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${De==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>re("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),j.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${De==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:j.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${De==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>re("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),R&&xt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${De==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:xt.length})]})})]}),De==="removal"?s.jsx(s.Fragment,{children:j.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:j.map((Fe,nt)=>{const lt=Fe.id,Mt=te[lt]||{},ut=Mt.EQT_LOSS_YN==="1"||Mt.PART_LOSS_BRK_YN==="1"||Mt.EQT_BRK_YN==="1"||Mt.EQT_CABL_LOSS_YN==="1"||Mt.EQT_CRDL_LOSS_YN==="1",qe=(O==null?void 0:O.id)===Fe.id;return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${qe?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>Dt(Fe),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Fe.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Fe.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Fe.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${ut?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:ut?"":""})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(Ee=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${Mt[Ee.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:Ye=>{Ye.stopPropagation(),at(lt,Ee.key,Mt[Ee.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:Mt[Ee.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:Ee.label})]},Ee.key))})]},lt||nt)})})}):s.jsx(s.Fragment,{children:R?xt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:xt.map(Fe=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(O==null?void 0:O.id)===Fe.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>Dt(Fe),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Fe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Fe.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Fe.serialNumber]}),Fe.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Fe.macAddress]})]})]}),(O==null?void 0:O.id)===Fe.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Fe.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Mt;const Fe=t.WRK_CD_NM||g0(t.WRK_CD)||t.workType||"-",nt=t.PROD_NM||t.productName||((Mt=t.customer)==null?void 0:Mt.productName)||"-",lt=t.CTRT_STAT_NM||Qu(t.CTRT_STAT)||"-";return s.jsx(f0,{isOpen:$,onClose:()=>de(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:lt,prodGrp:t.PROD_GRP||"",prodNm:nt,wrkCdNm:Fe,onSave:ct,showToast:r,installedEquipmentCount:K.length})})(),!g&&s.jsx("button",{onClick:mt,disabled:le,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${le?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:ae,onClose:()=>_e(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((it=t.customer)==null?void 0:it.id)}),s.jsx(m0,{isOpen:ie,onClose:()=>Ne(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),X&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!fe&&xe(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Fe=>Fe.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:fe?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):U==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:Q})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:Q})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${U==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>xe(!1),disabled:fe,children:fe?" ...":""})})]})}),document.body)]})},YY=t=>{switch(t){case"10":return"";case"20":return"";case"40":return"";default:return t||"-"}},VY=({isOpen:t,onClose:e,removedEquipmentsData:n=[],custId:r,rcptId:i,wrkId:a,ctrtId:o,mstSoId:c="",soId:u="",crrId:h="",wrkrId:m="",chgUid:_="",wrkCd:p="07",hideTransfer:g=!1,deferLossProcessing:C=!1,showToast:y,onSuccess:S,onSaveLossStatus:v,alreadyProcessedSerials:k=new Set})=>{const[L,M]=b.useState(!0),[P,F]=b.useState(!1),[G,B]=b.useState([]),[I,E]=b.useState([]),[A,Y]=b.useState(new Set),[ee,J]=b.useState(null),[H,V]=b.useState(!1),[K,j]=b.useState(new Map),[te,ce]=b.useState({}),[R,O]=b.useState([]),[U,Q]=b.useState(new Set),[q,$]=b.useState(!1);b.useEffect(()=>{t&&r&&i&&(M(!0),$(!1),J(null),B([]),E([]),Y(new Set),ce({}),Q(new Set),de())},[t,r,i,a]);const de=async()=>{M(!0),J(null);try{const[se,Re,be]=await Promise.all([LM({CUST_ID:r,RCPT_ID:i}),PM({WRK_ID:a}),Co({WRK_ID:a,WRKR_ID:m,SO_ID:u,CUST_ID:r,CTRT_ID:o,RCPT_ID:i})]);E(Re);const De=se.length>0?se.map(me=>({...me,ITEM_MID_CD:me.ITEM_MID_CD||(me.ITEM_CD?me.ITEM_CD.substring(2,4):void 0)})):n.map(me=>({EQT_NO:me.EQT_NO,EQT_SERNO:me.EQT_SERNO,EQT_CL_CD:me.EQT_CL_CD||me.EQT_CL,EQT_CL:me.EQT_CL||me.EQT_CL_CD,EQT_CL_NM:me.EQT_CL_NM||"",ITEM_MID_CD:me.ITEM_MID_CD,ITEM_MID_NM:me.ITEM_MID_NM||"",ITEM_NM:me.ITEM_MID_NM||"",MAC_ADDRESS:me.MAC_ADDRESS||"",SVC_CMPS_ID:me.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:me.BASIC_PROD_CMPS_ID,LENT_YN:me.LENT_YN,LENT_YN_NM:me.LENT_YN_NM||YY(me.LENT_YN),VOIP_CUSTOWN_EQT:me.VOIP_CUSTOWN_EQT}));if(console.log("[]   :",De.length,"",se.length>0?"(API )":"(  )"),B(De),De&&De.length>0){console.log("[]   ():",JSON.stringify(De[0],null,2));const me=De.map(ve=>({EQT_NO:ve.EQT_NO,EQT_SERNO:ve.EQT_SERNO,EQT_CL_CD:ve.EQT_CL_CD||ve.EQT_CL,EQT_CL:ve.EQT_CL||ve.EQT_CL_CD,ITEM_MID_CD:ve.ITEM_MID_CD,SVC_CMPS_ID:ve.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:ve.BASIC_PROD_CMPS_ID,LENT_YN:ve.LENT_YN}));O(me),console.log("[] EQT_NO :",me.length,""),me.forEach((ve,et)=>{console.log(`[] ${et+1}: EQT_SERNO=${ve.EQT_SERNO}, EQT_NO=${ve.EQT_NO}, EQT_CL_CD=${ve.EQT_CL_CD}`)})}const re=new Map;De.forEach(me=>{me.EQT_SERNO&&re.set(me.EQT_SERNO,me.EQT_CL_NM||me.ITEM_NM||"-")}),j(me=>new Map([...me,...re])),De.length===0&&J("      .")}catch(se){console.error("   :",se),J(se.message||"   .")}finally{M(!1),requestAnimationFrame(()=>{$(!0)})}},ae=se=>{Y(Re=>{const be=new Set(Re);return be.has(se)?(be.delete(se),ce(De=>{const re={...De};return delete re[se],re})):be.add(se),be})},_e=()=>{if(A.size===G.length)Y(new Set),ce({});else{const se=G.filter(Re=>Re.EQT_SERNO).map(Re=>Re.EQT_SERNO);Y(new Set(se))}},ie=(se,Re)=>{ce(be=>{var De;return{...be,[se]:{...be[se],[Re]:((De=be[se])==null?void 0:De[Re])==="1"?"0":"1"}}})},Ne=se=>{const Re=te[se];return Re?Re.EQT_LOSS_YN==="1"||Re.PART_LOSS_BRK_YN==="1"||Re.EQT_BRK_YN==="1"||Re.EQT_CABL_LOSS_YN==="1"||Re.EQT_CRDL_LOSS_YN==="1":!1},X=()=>{if(A.size===0){y==null||y("  .","error");return}if(g){const se=[];if(A.forEach(Re=>{Ne(Re)||se.push(Re)}),se.length>0){y==null||y(" (,  ) .","error");return}}V(!0)},xe=async()=>{V(!1),F(!0);try{const se=new Map(K);A.forEach(ct=>{const Ge=G.find(at=>at.EQT_SERNO===ct);Ge&&Ge.EQT_SERNO&&se.set(Ge.EQT_SERNO,Ge.EQT_CL_NM||Ge.ITEM_NM||"-")}),j(se);let Re=0,be=0,De=0,re=0;const me=[],ve=[],et=[],Dt=[];for(const ct of A){const Ge=G.find(mt=>mt.EQT_SERNO===ct),at=te[ct]||{};if(Ne(ct)&&Ge){console.log(`[]   - ${ct}`,at);const mt=R.find(Ee=>Ee.EQT_SERNO===ct)||n.find(Ee=>Ee.EQT_SERNO===ct),Ve=(mt==null?void 0:mt.EQT_NO)||Ge.EQT_NO||"",it=(mt==null?void 0:mt.ITEM_MID_CD)||Ge.ITEM_MID_CD||"",Fe=(mt==null?void 0:mt.EQT_CL_CD)||(mt==null?void 0:mt.EQT_CL)||Ge.EQT_CL_CD||Ge.EQT_CL||"",nt=(mt==null?void 0:mt.EQT_CL_NM)||Ge.EQT_CL_NM||"",lt=(mt==null?void 0:mt.SVC_CMPS_ID)||Ge.SVC_CMPS_ID||"",Mt=(mt==null?void 0:mt.BASIC_PROD_CMPS_ID)||Ge.BASIC_PROD_CMPS_ID||"",ut=(mt==null?void 0:mt.LENT_YN)||Ge.LENT_YN||"";if(C&&v){console.log(`[]   defer - ${ct}`),Dt.push({EQT_NO:Ve,EQT_SERNO:ct,EQT_CL_CD:Fe,EQT_CL:Fe,EQT_CL_NM:nt,ITEM_MID_CD:it,SVC_CMPS_ID:lt,BASIC_PROD_CMPS_ID:Mt,LENT_YN:ut,EQT_LOSS_YN:at.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:at.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:at.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:at.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:at.EQT_CRDL_LOSS_YN||"0"}),De++,et.push(ct);continue}if(!Ve){console.error(`[] EQT_NO  - ${ct}`),re++;continue}const qe=await TA({WRK_ID:a,CUST_ID:r,CTRT_ID:o,MST_SO_ID:c,SO_ID:u,EQT_NO:Ve,ITEM_MID_CD:it,EQT_CL_CD:Fe,EQT_CL:Fe,EQT_CL_NM:nt,REG_UID:_,WRK_CD:p,CRR_ID:h,WRKR_ID:m,RCPT_ID:i,SVC_CMPS_ID:lt,BASIC_PROD_CMPS_ID:Mt,OLD_LENT_YN:ut,EQT_CHG_GB:"02",REUSE_YN:"0",EQT_LOSS_YN:at.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:at.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:at.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:at.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:at.EQT_CRDL_LOSS_YN||"0"});if((qe==null?void 0:qe.MSGCODE)==="SUCCESS"){De++,et.push(ct),Q(Ee=>new Set([...Ee,ct]));try{await qu(_||m||"",o,a,"SMR05",Ve,"")}catch(Ee){console.log("[]    ():",Ee)}}else re++,console.error(`[]    - ${ct}:`,qe==null?void 0:qe.MESSAGE)}else{if(g){console.log(`[] hideTransfer=true,   - ${ct} `);continue}const mt=await RA({MST_SO_ID:c,SO_ID:u,CUST_ID:r,CTRT_ID:o,RCPT_ID:i,WRK_ID:a,WRK_CD:p,CRR_ID:h,WRKR_ID:m,EQT_SERNO:ct,CHG_UID:_});if((mt==null?void 0:mt.MSGCODE)==="SUCCESS")Re++,et.push(ct);else if((mt==null?void 0:mt.MSGCODE)==="CHARGE")me.push(ct);else{be++;const Ve=(mt==null?void 0:mt.message)||(mt==null?void 0:mt.MESSAGE);Ve&&ve.push(Ve)}}}Dt.length>0&&v&&(console.log("[EquipmentMoveModal]    (  ):",Dt.length,""),v(Dt)),await de(),Y(new Set),ce({});const ot=Re+De,At=be+re;if(me.length>0)y==null||y(` [${me.join(", ")}]   .`,"error");else if(At>0){const ct=ve.length>0?ve.join(`
`):`  (: ${Re}, : ${De}, : ${At})`;y==null||y(ct,"error")}else De>0&&Re>0?y==null||y(` ${Re},  ${De} `,"success"):De>0?y==null||y(` ${De} `,"success"):y==null||y("  .","success");ot>0&&(S==null||S(et))}catch(se){console.error("  :",se),y==null||y(se.message||"  .","error",!0)}finally{F(!1)}},fe=se=>I.some(Re=>Re.EQT_SERNO===se&&Re.SUCCESS_GUBN==="SUCCESS")||U.has(se)||k.has(se),Z=se=>U.has(se)||k.has(se),le=s.jsxs(s.Fragment,{children:[!g&&s.jsx("button",{onClick:X,disabled:P||A.size===0,className:"flex-1 px-3 sm:px-4 py-2 sm:py-2.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg text-sm sm:text-base font-semibold transition-colors flex items-center justify-center gap-2",children:P?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:" ..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),s.jsxs("span",{children:[" (",A.size,")"]})]})}),s.jsx("button",{onClick:()=>{if(g&&C&&v&&A.size>0){const se=[];for(const Re of A){const be=G.find(re=>re.EQT_SERNO===Re),De=te[Re]||{};if(be){const re=R.find(me=>me.EQT_SERNO===Re)||n.find(me=>me.EQT_SERNO===Re);se.push({EQT_NO:(re==null?void 0:re.EQT_NO)||be.EQT_NO||"",EQT_SERNO:Re,EQT_CL_CD:(re==null?void 0:re.EQT_CL_CD)||(re==null?void 0:re.EQT_CL)||be.EQT_CL_CD||be.EQT_CL||"",EQT_CL:(re==null?void 0:re.EQT_CL)||(re==null?void 0:re.EQT_CL_CD)||be.EQT_CL||be.EQT_CL_CD||"",EQT_CL_NM:(re==null?void 0:re.EQT_CL_NM)||be.EQT_CL_NM||"",ITEM_MID_CD:(re==null?void 0:re.ITEM_MID_CD)||be.ITEM_MID_CD||"",SVC_CMPS_ID:(re==null?void 0:re.SVC_CMPS_ID)||be.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:(re==null?void 0:re.BASIC_PROD_CMPS_ID)||be.BASIC_PROD_CMPS_ID||"",LENT_YN:(re==null?void 0:re.LENT_YN)||be.LENT_YN||"",EQT_LOSS_YN:De.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:De.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:De.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:De.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:De.EQT_CRDL_LOSS_YN||"0"})}}se.length>0&&(console.log("[EquipmentMoveModal]    :",se.length,""),v(se),y==null||y(` ${se.length} .`,"success"))}e()},disabled:P,className:`${g?"flex-1":""} px-3 sm:px-4 py-2 sm:py-2.5 ${g?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"} rounded-lg text-sm sm:text-base font-semibold transition-colors disabled:opacity-50`,children:g?"":""})]});return s.jsxs(s.Fragment,{children:[s.jsx(Ra,{isOpen:t,onClose:P?()=>{}:e,title:g?"":"  ",size:"large",footer:le,children:L||!q?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"   ..."})]}):ee&&G.length===0&&I.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-red-500 mb-2",children:ee}),s.jsx("button",{onClick:()=>{$(!1),de()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700",children:" "})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:" "}),s.jsx("button",{onClick:_e,className:"text-xs text-blue-600 hover:underline",children:A.size===G.length?"":""})]}),G.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg",children:I.some(se=>se.SUCCESS_GUBN==="SUCCESS")?"   .":"    ."}):s.jsx("div",{className:"space-y-2",children:G.map((se,Re)=>{const be=se.EQT_SERNO||"",De=be?fe(be):!1,re=be?A.has(be):!1,me=te[be]||{},ve=Ne(be);return s.jsx("div",{className:`p-3 rounded-lg border ${De?"bg-green-50 border-green-200":ve?"bg-orange-50 border-orange-300":re?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:re,onChange:()=>be&&ae(be),disabled:De||P,className:"mt-1 w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500 disabled:opacity-50"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-900",children:se.EQT_CL_NM||se.ITEM_NM||""}),De&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full",children:Z(be)?"":""}),ve&&!De&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-orange-100 text-orange-700 rounded-full",children:""}),re&&!ve&&!De&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded-full",children:""})]}),s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[s.jsxs("div",{children:["S/N: ",se.EQT_SERNO||"-"]}),s.jsxs("div",{className:"flex gap-4 mt-1",children:[s.jsx("span",{children:se.LENT_YN_NM||"-"}),s.jsx("span",{children:se.NOTRECEV||"-"}),s.jsx("span",{children:se.EQT_STAT_CD||"-"})]}),se.MAC_ADDRESS&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["MAC: ",se.MAC_ADDRESS]})]}),re&&!De&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 mt-3 border-t border-gray-200",children:[s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:me.EQT_LOSS_YN==="1",onChange:()=>ie(be,"EQT_LOSS_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:me.PART_LOSS_BRK_YN==="1",onChange:()=>ie(be,"PART_LOSS_BRK_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:me.EQT_BRK_YN==="1",onChange:()=>ie(be,"EQT_BRK_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:me.EQT_CABL_LOSS_YN==="1",onChange:()=>ie(be,"EQT_CABL_LOSS_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg active:bg-gray-100 whitespace-nowrap cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:me.EQT_CRDL_LOSS_YN==="1",onChange:()=>ie(be,"EQT_CRDL_LOSS_YN"),disabled:P,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]})]})]})]})},se.EQT_SERNO||Re)})})]}),I.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsx("div",{className:"max-h-48 overflow-auto space-y-2",children:I.map((se,Re)=>s.jsxs("div",{className:`p-3 rounded-lg border ${se.SUCCESS_GUBN==="SUCCESS"?"bg-green-50 border-green-200":se.SUCCESS_GUBN==="CHARGE"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsxs("span",{className:"text-xs text-gray-500 shrink-0",children:["#",Re+1]}),s.jsx("span",{className:"font-medium text-gray-900 text-sm truncate",children:K.get(se.EQT_SERNO||"")||se.EQT_CL_NM||se.ITEM_NM||"-"})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full whitespace-nowrap shrink-0 ${se.SUCCESS_GUBN==="SUCCESS"?"bg-green-500 text-white":se.SUCCESS_GUBN==="CHARGE"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:se.SUCCESS_GUBN==="SUCCESS"?"":se.SUCCESS_GUBN==="CHARGE"?"":se.SUCCESS_GUBN||"-"})]}),s.jsxs("div",{className:"mt-1.5 text-xs text-gray-600 font-mono",children:["S/N: ",se.EQT_SERNO||"-"]})]},se.EQT_SERNO||Re))})]})]})}),!g&&s.jsx(Ba,{isOpen:H,onClose:()=>V(!1),onConfirm:xe,title:"",message:" ?     .",type:"confirm",confirmText:"",cancelText:""})]})},$Y=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var ge,Be;const g=o||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:C}=ta(),y=t.id,{initWorkState:S,setApiData:v,setDataLoaded:k,setInstalledEquipments:L,setMarkedForRemoval:M,addMarkedForRemoval:P,removeMarkedForRemoval:F,setSelectedContract:G,setSelectedStock:B,setSignalStatus:I,setSignalResult:E,setPendingLossStatusList:A,setRemovalStatus:Y}=ki(),{contractEquipments:ee,technicianEquipments:J,customerEquipments:H,removeEquipments:V,installedEquipments:K,markedForRemoval:j,removalStatus:te,pendingLossStatusList:ce,selectedContract:R,selectedStock:O,signalStatus:U,signalResult:Q,isReady:q}=xa(y),$=H.length,[de,ae]=b.useState(!1),[_e,ie]=b.useState(!1),[Ne,X]=b.useState(!1),[xe,fe]=b.useState(!1),[Z,le]=b.useState(!1),[se,Re]=b.useState(!1),[be,De]=b.useState(!1),[re,me]=b.useState(!1),[ve,et]=b.useState("stock"),[Dt,ot]=b.useState([]),[At,ct]=b.useState(new Set),[Ge,at]=b.useState(new Set),xt=t.WRK_CD==="07"&&H.length===0?Dt.filter(ue=>!At.has(ue.EQT_SERNO||"")).length:0;b.useEffect(()=>{if(q&&(K.length>0||j.length>0||ee.length>0)){console.log("[-]    -   ");return}S(y),mt()},[t.id]);const mt=async(ue=!1)=>{var we,Je,Pe,Nt,Oe,dt;try{let gt;const It=localStorage.getItem("userInfo"),$e=It?JSON.parse(It):null;if(console.log("[-] WRKR_ID :",{"workItem.WRKR_ID":t.WRKR_ID,"user.userId":$e==null?void 0:$e.userId,"user.workerId":$e==null?void 0:$e.workerId," WRKR_ID":t.WRKR_ID||($e==null?void 0:$e.userId)||($e==null?void 0:$e.workerId)||"",forceRefresh:ue}),i&&i.contractEquipments&&i.contractEquipments.length>0&&!ue)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),console.log('[-]  preloaded    -    " "  '),gt=i;else{ue?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const _t=localStorage.getItem("userInfo");if(!_t){console.error("  .");return}const qt=JSON.parse(_t),jt=P_(t.WRK_CD),he={WRKR_ID:t.WRKR_ID||qt.userId||qt.workerId||"",SO_ID:t.SO_ID||qt.soId,WRK_ID:t.id,CUST_ID:((we=t.customer)==null?void 0:we.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:jt,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-] API :",he),gt=await Co(he),ue&&a&&(console.log("[-]   preloadedData "),a(gt))}console.log("[-] API :",{contractEquipments:((Je=gt.contractEquipments)==null?void 0:Je.length)||0,technicianEquipments:((Pe=gt.technicianEquipments)==null?void 0:Pe.length)||0,customerEquipments:((Nt=gt.customerEquipments)==null?void 0:Nt.length)||0,removedEquipments:((Oe=gt.removedEquipments)==null?void 0:Oe.length)||0});const Ue=((dt=t.customer)==null?void 0:dt.id)||t.CUST_ID||"",ss=t.RCPT_ID||"";if(Ue&&ss)try{const _t=await LM({CUST_ID:Ue,RCPT_ID:ss});console.log("[-]  :",_t.length,""),ot(_t)}catch(_t){console.error("[-]    :",_t)}const ls={kpiProdGrpCd:gt.kpiProdGrpCd,prodChgGb:gt.prodChgGb,chgKpiProdGrpCd:gt.chgKpiProdGrpCd,prodGrp:gt.prodGrp};C(ls),window.__equipmentFilterData=ls;const ds=(gt.contractEquipments||[]).map(_t=>({id:_t.SVC_CMPS_ID||_t.PROD_CMPS_ID,type:_t.ITEM_MID_NM||_t.EQT_NM,model:_t.EQT_CL_NM,serialNumber:"N/A",itemMidCd:_t.ITEM_MID_CD,eqtClCd:_t.EQT_CL_CD||_t.EQT_CL,SVC_CMPS_ID:_t.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:_t.BASIC_PROD_CMPS_ID,PROD_CD:_t.PROD_CD,SVC_CD:_t.SVC_CD})),vs=(gt.technicianEquipments||[]).map(_t=>({id:_t.EQT_NO,type:_t.ITEM_MID_NM,model:_t.EQT_CL_NM,serialNumber:_t.EQT_SERNO,itemMidCd:_t.ITEM_MID_CD,eqtClCd:_t.EQT_CL_CD||_t.EQT_CL,macAddress:_t.MAC_ADDRESS,SVC_CMPS_ID:_t.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:_t.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:_t.EQT_PROD_CMPS_ID,PROD_CD:_t.PROD_CD,SVC_CD:_t.SVC_CD,EQT_SALE_AMT:_t.EQT_SALE_AMT,MST_SO_ID:_t.MST_SO_ID,SO_ID:_t.SO_ID,OLD_LENT_YN:_t.OLD_LENT_YN,LENT:_t.LENT,LENT_YN:_t.LENT_YN,ITLLMT_PRD:_t.ITLLMT_PRD,EQT_USE_STAT_CD:_t.EQT_USE_STAT_CD})),Ss=new Set,ke=(gt.customerEquipments||[]).map(_t=>{const qt=ds.find(jt=>jt.itemMidCd===_t.ITEM_MID_CD&&!Ss.has(jt.id));return qt&&Ss.add(qt.id),{contractEquipment:qt||{id:"unknown",type:_t.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:_t.ITEM_MID_CD},actualEquipment:{id:_t.EQT_NO,type:_t.ITEM_MID_NM,model:_t.EQT_CL_NM,serialNumber:_t.EQT_SERNO,itemMidCd:_t.ITEM_MID_CD,eqtClCd:_t.EQT_CL_CD||_t.EQT_CL,macAddress:_t.MAC_ADDRESS||_t.MAC_ADDR,LENT_YN:_t.LENT_YN,VOIP_CUSTOWN_EQT:_t.VOIP_CUSTOWN_EQT},macAddress:_t.MAC_ADDRESS||_t.MAC_ADDR,installLocation:_t.INSTL_LCTN}}),ft=(gt.customerEquipments||[]).map(_t=>({id:_t.EQT_NO,type:_t.ITEM_MID_NM,model:_t.EQT_CL_NM,serialNumber:_t.EQT_SERNO,itemMidCd:_t.ITEM_MID_CD,eqtClCd:_t.EQT_CL_CD||_t.EQT_CL,macAddress:_t.MAC_ADDRESS||_t.MAC_ADDR,SVC_CMPS_ID:_t.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:_t.BASIC_PROD_CMPS_ID,LENT_YN:_t.LENT_YN,VOIP_CUSTOWN_EQT:_t.VOIP_CUSTOWN_EQT})),st=(gt.removedEquipments||[]).map(_t=>({id:_t.EQT_NO,type:_t.ITEM_MID_NM,model:_t.EQT_CL_NM,serialNumber:_t.EQT_SERNO,itemMidCd:_t.ITEM_MID_CD,eqtClCd:_t.EQT_CL_CD||_t.EQT_CL,macAddress:_t.MAC_ADDRESS||_t.MAC_ADDR,installLocation:_t.INSTL_LCTN,SVC_CMPS_ID:_t.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:_t.BASIC_PROD_CMPS_ID,MST_SO_ID:_t.MST_SO_ID,SO_ID:_t.SO_ID,LENT_YN:_t.LENT_YN,VOIP_CUSTOWN_EQT:_t.VOIP_CUSTOWN_EQT}));v(y,{contractEquipments:ds,technicianEquipments:vs,customerEquipments:ft,removeEquipments:st,filteringData:ls}),t.WRK_CD==="07"&&t.id&&PM({WRK_ID:t.id}).then(_t=>{const qt=new Set(_t.filter(jt=>jt.SUCCESS_GUBN==="SUCCESS").map(jt=>jt.EQT_SERNO).filter(Boolean));qt.size>0&&ct(qt)}).catch(()=>{});const Ft=j||[];if(ke.length>0)if(console.log("[-] API     :",ke.length,""),Ft.length>0){const _t=new Set(Ft.map(jt=>jt.id)),qt=ke.filter(jt=>!_t.has(jt.actualEquipment.id));L(y,qt)}else L(y,ke);requestAnimationFrame(()=>k(y,!0))}catch(gt){console.error("[-]    :",gt),requestAnimationFrame(()=>k(y,!0))}},Ve=ue=>{const we=K.find(Je=>Je.contractEquipment.id===ue.id);(R==null?void 0:R.id)===ue.id?(G(y,null),B(y,null)):(G(y,ue),we?B(y,we.actualEquipment):B(y,null))},it=ue=>{(O==null?void 0:O.id)===ue.id?B(y,null):B(y,ue)},Fe=()=>{if(!R||!O)return;if(R.itemMidCd!==O.itemMidCd||R.model!==O.model){r==null||r("      .","warning");return}const ue=K.findIndex(we=>we.contractEquipment.id===R.id);if(ue>=0){const we=[...K];we[ue]={contractEquipment:R,actualEquipment:O,macAddress:O.macAddress||"",installLocation:""},L(y,we)}else{const we={contractEquipment:R,actualEquipment:O,macAddress:O.macAddress||"",installLocation:""};L(y,[...K,we])}I(y,"idle"),B(y,null)},nt=()=>{if(!O)return;const ue=K.findIndex(Pe=>Pe.actualEquipment.id===O.id);if(ue>=0){const Pe=[...K],Nt=Pe.splice(ue,1)[0];L(y,Pe);const Oe=Nt.actualEquipment;j.some(gt=>gt.id===Oe.id)||P(y,Oe),I(y,"idle"),B(y,null),et("removal");return}if(j.some(Pe=>Pe.id===O.id))return;V.some(Pe=>Pe.id===O.id)&&(P(y,O),et("removal"))},lt=async(ue,we)=>{try{const Je=localStorage.getItem("userInfo");if(!Je){r==null||r("  .","error");return}const Pe=JSON.parse(Je),Nt=ue.map((dt,gt)=>{let It=dt.ITEM_MID_CD||dt.ITM_MID_CD||dt.EQT||dt.EQT_CD||"",$e=dt.EQT_CL||dt.EQT_CL_CD||"",$t=dt.SVC_CMPS_ID||dt.PROD_CMPS_ID||dt.SVC_CMPS_SEQ||dt.EQUIP_SEQ||"";return It=String(It).trim().padStart(2,"0"),$e=String($e).trim().padStart(6,"0"),$t=String($t||gt+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Pe.crrId||"",WRKR_ID:t.WRKR_ID||Pe.userId||Pe.workerId||"",REG_UID:Pe.userId||Pe.workerId||"A20130708",ITEM_MID_CD:It,EQT_CL:$e,SVC_CMPS_ID:$t,EQT:It,EQT_CD:It,LENT:String(dt.LENT||"10"),EQT_USE_STAT_CD:String(dt.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(dt.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(dt.EQT_SALE_AMT||0),PROD_GRP:String(dt.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(dt.PROD_CD||t.PROD_CD||""),SVC_CD:String(dt.SVC_CD||""),PROM_CNT:we||"",SEL:"1",EQT_BASIC_YN:String(dt.EQT_BASIC_YN||"N"),PROD_TYP:dt.PROD_TYP,EQUIP_SEQ:dt.EQUIP_SEQ}}),Oe=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:we||"",equipments:Nt});if(Oe.MSGCODE==="SUCCESS"||Oe.MSGCODE==="0"||Oe.code==="SUCCESS")r==null||r("  .","success"),await mt(!0);else throw new Error(Oe.MESSAGE||Oe.message||"   .")}catch(Je){throw console.error("[] :",Je),r==null||r(Je.message||"     .","error",!0),Je}},Mt=async()=>{var ue,we,Je,Pe;if(K.length===0){r==null||r("    .","warning"),I(y,"fail");return}try{Re(!0),le(!0),E(y," ...");const Nt=localStorage.getItem("userInfo");if(!Nt){E(y,"    ."),I(y,"fail"),Re(!1);return}const Oe=JSON.parse(Nt),dt=Oe.userId||Oe.id||"UNKNOWN",gt=ds=>{var ft,st,Ft,_t,qt;const vs=((ft=ds.actualEquipment)==null?void 0:ft.eqtClCd)||ds.eqtClCd||((st=ds.actualEquipment)==null?void 0:st.EQT_CL_CD)||"",Ss=((Ft=ds.actualEquipment)==null?void 0:Ft.itemMidCd)||ds.itemMidCd||((_t=ds.actualEquipment)==null?void 0:_t.ITEM_MID_CD)||"",ke=(((qt=ds.actualEquipment)==null?void 0:qt.type)||ds.type||"").toLowerCase();return!!(vs.startsWith("0904")||Ss==="02"||ke.includes("stb")||ke.includes(""))},It=ds=>{var ft,st,Ft,_t,qt;const vs=((ft=ds.actualEquipment)==null?void 0:ft.eqtClCd)||ds.eqtClCd||((st=ds.actualEquipment)==null?void 0:st.EQT_CL_CD)||"",Ss=((Ft=ds.actualEquipment)==null?void 0:Ft.itemMidCd)||ds.itemMidCd||((_t=ds.actualEquipment)==null?void 0:_t.ITEM_MID_CD)||"",ke=(((qt=ds.actualEquipment)==null?void 0:qt.type)||ds.type||"").toLowerCase();return!!(vs.startsWith("0902")||Ss==="03"||ke.includes("modem")||ke.includes(""))},$e=K.find(gt),$t=K.find(It),Ue=((ue=$e==null?void 0:$e.actualEquipment)==null?void 0:ue.id)||"",ss=((we=$t==null?void 0:$t.actualEquipment)==null?void 0:we.id)||"",ls=await qu(dt,t.CTRT_ID||"",t.id,"SMR03",Ue||((Pe=(Je=K[0])==null?void 0:Je.actualEquipment)==null?void 0:Pe.id)||"",ss||"");ls.O_IFSVC_RESULT&&ls.O_IFSVC_RESULT.startsWith("TRUE")?(E(y,` 

: ${ls.O_IFSVC_RESULT||""}`),I(y,"success")):(E(y,` 

${ls.MESSAGE||"   "}`),I(y,"fail"))}catch(Nt){E(y,` 

${Nt.message||"   "}`),I(y,"fail")}finally{Re(!1)}},ut=ue=>{console.log("[-]    (  API  ):",ue.length,"");const we=new Set(ue.map(Pe=>Pe.EQT_SERNO)),Je=ce.filter(Pe=>!we.has(Pe.EQT_SERNO));A(y,[...Je,...ue])},qe=b.useMemo(()=>{const ue=new Set(K.map(Pe=>Pe.actualEquipment.id));let we=J.filter(Pe=>!ue.has(Pe.id));return R&&(we=we.filter(Pe=>Pe.itemMidCd===R.itemMidCd&&Pe.model===R.model)),(At.size>0||Ge.size>0)&&we.sort((Pe,Nt)=>{const Oe=Pe.serialNumber||"",dt=Nt.serialNumber||"",gt=Ge.has(Oe),It=Ge.has(dt),$e=At.has(Oe),$t=At.has(dt);return gt&&!It?-1:!gt&&It?1:$e&&!$t?-1:!$e&&$t?1:0}),we},[K,J,R,At,Ge]);b.useMemo(()=>{const ue=new Set(K.map(Je=>Je.actualEquipment.id));let we=j.filter(Je=>!ue.has(Je.id));return R&&(we=we.filter(Je=>Je.itemMidCd===R.itemMidCd&&Je.model===R.model)),we},[K,j,R]);const Ee=b.useMemo(()=>{const ue=new Set(K.map(Je=>Je.actualEquipment.id));return[...j,...V.filter(Je=>!ue.has(Je.id)&&!j.some(Pe=>Pe.id===Je.id))]},[j,V,K]),Ye=()=>{De(!0),setTimeout(()=>{De(!1),r==null||r("    .","info")},500)},pe=async()=>{if(!(re||g)){me(!0);try{await mt(!0),r==null||r("  .","success")}catch(ue){console.error("[-]  :",ue),r==null||r("   .","error")}finally{me(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[re&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsx("button",{onClick:pe,disabled:re||g,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${re||g?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:s.jsx(Ai,{className:`w-4 h-4 ${re?"animate-spin":""}`})})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[ee.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>!g&&ae(!0),disabled:g,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||g,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":U==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":U==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!g&&!se&&Mt(),disabled:g||se,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:`relative flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g||H.length>0?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-indigo-200 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:border-indigo-300"}`,onClick:()=>!g&&H.length===0&&fe(!0),disabled:g||H.length>0,children:[xt>0&&s.jsx("span",{className:"absolute -top-1.5 -right-1.5 min-w-[20px] h-5 px-1.5 flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full shadow-sm",children:xt}),s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>c?X(!0):ie(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:c?"LDAP":""})]})]})]}),q?ee.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:ee.map(ue=>{const we=K.find(Pe=>Pe.contractEquipment.id===ue.id),Je=(R==null?void 0:R.id)===ue.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${g?we?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":Je?"border-blue-500 bg-blue-50 cursor-pointer":we?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!g&&Ve(ue),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:ue.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:ue.model})]}),we&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",we.actualEquipment.model]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",we.actualEquipment.serialNumber]}),we.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",we.macAddress]})]})]})},ue.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!g&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!O||!K.some(ue=>ue.actualEquipment.id===(O==null?void 0:O.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-red-500 bg-red-50 text-red-600 hover:bg-red-100 cursor-pointer active:scale-95"}`,onClick:nt,disabled:!O||!K.some(ue=>ue.actualEquipment.id===(O==null?void 0:O.id)),children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!O||K.some(ue=>ue.actualEquipment.id===(O==null?void 0:O.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!O)return;if(j.some(Je=>Je.id===O.id)){if(R&&(R.itemMidCd!==O.itemMidCd||R.model!==O.model)){r==null||r("      .","warning");return}const Je=R||ee.find(Oe=>Oe.itemMidCd===O.itemMidCd&&Oe.model===O.model);if(!Je){r==null||r("  .","warning");return}if(K.find(Oe=>Oe.contractEquipment.id===Je.id)){r==null||r("   .","warning");return}const Nt={contractEquipment:Je,actualEquipment:O,macAddress:O.macAddress||""};L(y,[...K,Nt]),F(y,O.id),B(y,null),r==null||r(" .","success");return}if(!R){r==null||r("   .","warning");return}if(K.find(Je=>Je.contractEquipment.id===R.id)){r==null||r("   .","warning");return}Fe()},disabled:!O||K.some(ue=>ue.actualEquipment.id===(O==null?void 0:O.id)),children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!g&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[re&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),H.length>0?s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ve==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>et("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ve==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:Ee.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${ve==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>et("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),R&&qe.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${ve==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:qe.length})]})})]}):s.jsx("div",{className:"py-3 px-4 border-b-2 border-blue-500",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-sm font-semibold text-blue-600",children:""}),R&&qe.length>0&&s.jsx("span",{className:"px-2 py-0.5 text-xs font-bold rounded-full bg-blue-500 text-white",children:qe.length})]})}),H.length>0&&ve==="removal"?s.jsx("div",{className:"p-3 sm:p-4 space-y-3 max-h-80 overflow-y-auto",children:Ee.map((ue,we)=>{const Je=ue.id,Pe=(O==null?void 0:O.id)===Je,Nt=j.some(Oe=>Oe.id===Je);return s.jsx("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${Pe?"border-blue-500 bg-blue-50":Nt?"border-red-200 bg-red-50 hover:border-red-300":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>it(ue),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold ${Nt?"bg-red-500 text-white":"bg-orange-500 text-white"}`,children:Nt?"":we+1}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:ue.type}),s.jsx("div",{className:"text-xs text-gray-600",children:ue.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",ue.serialNumber]}),ue.macAddress&&s.jsxs("div",{className:"text-xs text-gray-500",children:["MAC: ",ue.macAddress]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${Nt?"bg-red-500 text-white":"bg-orange-500 text-white"}`,children:Nt?"":""})]})},`removal-${Je||we}`)})}):s.jsx(s.Fragment,{children:R?qe.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:qe.map(ue=>{const we=ue.serialNumber||"",Je=Ge.has(we),Pe=At.has(we),Nt=Je||Pe;return s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(O==null?void 0:O.id)===ue.id?"border-blue-500 bg-blue-50":Je?"border-purple-500 bg-purple-50 ring-2 ring-purple-300 ring-opacity-50 animate-pulse":Pe?"border-purple-400 bg-purple-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>it(ue),children:[Nt&&s.jsx("div",{className:`absolute -top-2 left-3 px-2 py-0.5 text-white text-[0.625rem] sm:text-xs font-bold rounded-full shadow-sm ${Je?"bg-purple-600":"bg-purple-500"}`,children:Je?" ":""}),s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:ue.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:ue.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",ue.serialNumber]}),ue.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",ue.macAddress]})]})]}),(O==null?void 0:O.id)===ue.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},ue.id)})}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Pe;const ue=t.WRK_CD_NM||g0(t.WRK_CD)||t.workType||"-",we=t.PROD_NM||t.productName||((Pe=t.customer)==null?void 0:Pe.productName)||"-",Je=t.CTRT_STAT_NM||Qu(t.CTRT_STAT)||"-";return s.jsx(f0,{isOpen:de,onClose:()=>ae(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:Je,prodGrp:t.PROD_GRP||"",prodNm:we,wrkCdNm:ue,onSave:lt,showToast:r,installedEquipmentCount:K.length,customerEquipmentCount:$})})(),!g&&s.jsx("button",{onClick:Ye,disabled:be,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${be?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:_e,onClose:()=>ie(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((ge=t.customer)==null?void 0:ge.id)}),s.jsx(m0,{isOpen:Ne,onClose:()=>X(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),s.jsx(VY,{isOpen:xe,onClose:()=>{fe(!1),mt(!0)},removedEquipmentsData:(V.length>0?V:H).map(ue=>({EQT_NO:ue.id||ue.EQT_NO||"",EQT_SERNO:ue.serialNumber||ue.EQT_SERNO||"",EQT_CL_CD:ue.eqtClCd||ue.EQT_CL_CD||ue.EQT_CL||"",EQT_CL_NM:ue.model||ue.EQT_CL_NM||"",ITEM_MID_CD:ue.itemMidCd||ue.ITEM_MID_CD||"",ITEM_MID_NM:ue.type||ue.ITEM_MID_NM||"",MAC_ADDRESS:ue.macAddress||ue.MAC_ADDRESS||"",SVC_CMPS_ID:ue.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:ue.BASIC_PROD_CMPS_ID||"",LENT_YN:ue.LENT_YN||"",VOIP_CUSTOWN_EQT:ue.VOIP_CUSTOWN_EQT||""})),custId:t.CUST_ID||((Be=t.customer)==null?void 0:Be.id)||"",rcptId:t.RCPT_ID||"",wrkId:t.id,ctrtId:t.CTRT_ID||"",hideTransfer:!1,mstSoId:t.MST_SO_ID||"",soId:t.SO_ID||"",crrId:t.CRR_ID||"",wrkrId:t.WRKR_ID||"",chgUid:t.REG_UID||t.WRKR_ID||"",showToast:r,deferLossProcessing:!1,onSaveLossStatus:ut,alreadyProcessedSerials:At,onSuccess:ue=>{console.log("[EquipmentMoveRemoval]   -  :",ue),ct(new Set([...At,...ue])),at(new Set(ue)),setTimeout(()=>{at(new Set)},1e4)}}),Z&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!se&&le(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:ue=>ue.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:se?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):U==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:Q})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:Q})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${U==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>le(!1),disabled:se,children:se?" ...":""})})]})}),document.body)]})},zY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1})=>{const c=t.id,u=o||t.WRK_STAT_CD==="4"||t.status==="",{initWorkState:h,setApiData:m,setDataLoaded:_,toggleRemovalStatus:p,setFullRemovalStatus:g,setRemovalStatus:C,setReuseAll:y}=ki(),{removeEquipments:S,removalStatus:v,isReady:k}=xa(c),[L,M]=b.useState(!1),[P,F]=b.useState(!1),G=ki(J=>{var H;return((H=J.workStates[c])==null?void 0:H.reuseAll)??!1}),B=J=>{y(c,J)},I=async J=>{var H;try{const V=localStorage.getItem("userInfo"),K=V?JSON.parse(V):{},j=await x_({RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",CRR_ID:t.CRR_ID||"",WRKR_ID:t.WRKR_ID||K.userId||"",PROD_CD:t.PROD_CD||"",CRR_TSK_CL:"02",WRK_ID:t.id||"",ADDR_ORD:t.ADDR_ORD||((H=t.customer)==null?void 0:H.ADDR_ORD)||"",WRK_CD:t.WRK_CD||"08",WRK_STAT_CD:t.WRK_STAT_CD||""}),te=(j==null?void 0:j.MVM_TP)||"",ce=(j==null?void 0:j.WRK_STAT_CD)||"",R=(j==null?void 0:j.CTRT_ID)||"",O=(j==null?void 0:j.OLD_CTRT_ID)||"",U=ce==="2";F(U),console.log("[-]  :",{WRK_STAT_CD:ce,CTRT_ID:R,OLD_CTRT_ID:O,:U}),J&&(U?(y(c,!0),console.log("[-]   : true")):y(c,!1))}catch(V){console.error("[-]   :",V),F(!1),J&&y(c,!1)}};b.useEffect(()=>{const J=!k||S.length===0;if(I(J),!J){console.log("[-]    -   , reuseAll:",G);return}h(c),E()},[t.id]);const E=async(J=!1)=>{var H,V;try{console.log("[-]    - isWorkCompleted:",u,"WRK_STAT_CD:",t.WRK_STAT_CD);let K;if(i&&!J)console.log("[-] Pre-loaded   - API  "),K=i;else{const te=localStorage.getItem("userInfo");if(!te){console.error("  .");return}const ce=JSON.parse(te),R={WRKR_ID:t.WRKR_ID||ce.userId||ce.workerId||"",SO_ID:t.SO_ID||ce.soId,WRK_ID:t.id,CUST_ID:((H=t.customer)==null?void 0:H.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"08",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-]    (API )"),console.log("[-] :",R),K=await Co(R)}console.log("[-] :"),console.log("  -  (output5):",((V=K.removedEquipments)==null?void 0:V.length)||0,"");const j=(K.removedEquipments||[]).map(te=>({...te,id:te.EQT_NO,type:te.ITEM_MID_NM,model:te.EQT_CL_NM,serialNumber:te.EQT_SERNO,itemMidCd:te.ITEM_MID_CD,eqtClCd:te.EQT_CL_CD||te.EQT_CL,macAddress:te.MAC_ADDRESS||te.MAC_ADDR,installLocation:te.INSTL_LCTN}));console.log("[-]  :"),console.log("  -  :",j.length,""),m(c,{removeEquipments:j}),requestAnimationFrame(()=>_(c,!0))}catch(K){console.error("[-]    :",K),r==null||r("   .","error",!0),m(c,{removeEquipments:[]}),requestAnimationFrame(()=>_(c,!0))}},A=()=>{const J=!G;B(J),S.forEach(H=>{C(c,H.id,"REUSE_YN",J?"1":"0"),J&&(C(c,H.id,"EQT_LOSS_YN","0"),C(c,H.id,"PART_LOSS_BRK_YN","0"),C(c,H.id,"EQT_BRK_YN","0"),C(c,H.id,"EQT_CABL_LOSS_YN","0"),C(c,H.id,"EQT_CRDL_LOSS_YN","0"))}),J&&(r==null||r("   .   .","info"))},Y=(J,H)=>{var K;p(c,J,H),(((K=v[J])==null?void 0:K[H])||"0")==="0"&&G&&(B(!1),S.forEach(j=>{C(c,j.id,"REUSE_YN","0")}),r==null||r("    .","warning"))},ee=async()=>{if(!(L||u)){M(!0);try{await E(!0),r==null||r("  .","success")}catch(J){console.error("[-]  :",J),r==null||r("   .","error")}finally{M(!1)}}};return s.jsx("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[L&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Oc,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Ai,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-500"}),""]}),s.jsxs("button",{onClick:ee,disabled:L||u,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${L||u?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Oc,{className:`w-3.5 h-3.5 ${L?"animate-spin":""}`}),s.jsx("span",{children:" "})]}),P&&!u&&!o&&S.length>0&&s.jsxs("label",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg cursor-pointer hover:bg-blue-50 active:bg-blue-100",children:[s.jsx("input",{type:"checkbox",checked:G,onChange:A,className:"w-4 h-4 rounded border-blue-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-xs text-blue-700 font-medium",children:""})]})]}),s.jsxs("span",{className:"px-2 sm:px-2.5 py-0.5 sm:py-1 bg-orange-100 text-orange-700 text-[0.625rem] sm:text-xs font-semibold rounded-full",children:[S.length,""]})]}),S.length===0?s.jsx("div",{className:"py-12 text-center",children:s.jsx("div",{className:"text-sm text-gray-500",children:"   "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:S.map(J=>{const H=J.id,V=v[H]||{},K=uS(J);return s.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:J.model||J.type}),s.jsxs("div",{className:"text-xs text-gray-600",children:["S/N: ",J.serialNumber]}),J.macAddress&&s.jsxs("div",{className:"text-xs text-gray-500",children:["MAC: ",J.macAddress]})]}),s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:J.EQT_LOC_TP_NM||""})]}),!u&&!o&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-gray-100",children:[s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${K?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_LOSS_YN==="1",onChange:()=>Y(H,"EQT_LOSS_YN"),disabled:K,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${K?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.PART_LOSS_BRK_YN==="1",onChange:()=>Y(H,"PART_LOSS_BRK_YN"),disabled:K,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${K?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_BRK_YN==="1",onChange:()=>Y(H,"EQT_BRK_YN"),disabled:K,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${K?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_CABL_LOSS_YN==="1",onChange:()=>Y(H,"EQT_CABL_LOSS_YN"),disabled:K,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]}),s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg whitespace-nowrap ${K?"opacity-50 cursor-not-allowed":"cursor-pointer active:bg-gray-100"}`,children:[s.jsx("input",{type:"checkbox",checked:V.EQT_CRDL_LOSS_YN==="1",onChange:()=>Y(H,"EQT_CRDL_LOSS_YN"),disabled:K,className:"w-4 h-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500"}),s.jsx("span",{className:"text-xs text-gray-700 font-medium",children:""})]})]}),K&&!u&&s.jsx("div",{className:"mt-2 text-xs text-orange-600 bg-orange-50 p-2 rounded",children:"   "})]},J.id)})})]})})},HY=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u="",onLdapConnect:h,isLdapDone:m=!1,ldapLoading:_=!1,ldapBlocked:p=!1})=>{var it;const g=o||t.WRK_STAT_CD==="4"||t.status==="",{setFilteringData:C}=ta(),y=t.id,{initWorkState:S,setApiData:v,setDataLoaded:k,setInstalledEquipments:L,addMarkedForRemoval:M,setMarkedForRemoval:P,toggleRemovalStatus:F,setFullRemovalStatus:G,setSelectedContract:B,setSelectedStock:I,setSignalStatus:E,setSignalResult:A,clearSelection:Y}=ki(),{contractEquipments:ee,technicianEquipments:J,customerEquipments:H,removeEquipments:V,installedEquipments:K,markedForRemoval:j,removalStatus:te,selectedContract:ce,selectedStock:R,signalStatus:O,signalResult:U,isReady:Q}=xa(y),q=H.length,[$,de]=b.useState(!1),[ae,_e]=b.useState(!1),[ie,Ne]=b.useState(!1),[X,xe]=b.useState(!1),[fe,Z]=b.useState(!1),[le,se]=b.useState(!1),[Re,be]=b.useState(!1),[De,re]=b.useState("stock");b.useEffect(()=>{if(Q&&(K.length>0||j.length>0||ee.length>0)){console.log("[-]    -   ");return}S(y),me()},[t.id]);const me=async(Fe=!1)=>{var nt,lt,Mt,ut,qe,Ee,Ye,pe;try{let ge;if(i&&i.contractEquipments&&i.contractEquipments.length>0&&!Fe)console.log("[-] Pre-loaded   -",i.contractEquipments.length," "),ge=i;else{Fe?console.log("[-]   - API "):i&&(!i.contractEquipments||i.contractEquipments.length===0)&&console.log("[-] preloadedApiData   - API ");const $e=localStorage.getItem("userInfo");if(!$e){console.error("  .");return}const $t=JSON.parse($e),Ue=P_(t.WRK_CD),ss={WRKR_ID:t.WRKR_ID||$t.userId||$t.workerId||"",SO_ID:t.SO_ID||$t.soId,WRK_ID:t.id,CUST_ID:((nt=t.customer)==null?void 0:nt.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:t.CTRT_ID||null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:Ue,WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null};console.log("[-] API :",ss),ge=await Co(ss),Fe&&a&&(console.log("[-]   preloadedData "),a(ge))}console.log("=== [-] API Output  ==="),console.log("  output1 ():",ge.productInfo||"N/A"),console.log("  output2 ():",((lt=ge.contractEquipments)==null?void 0:lt.length)||0,""),((Mt=ge.contractEquipments)==null?void 0:Mt.length)>0&&ge.contractEquipments.forEach(($e,$t)=>{console.log(`    [${$t}] ${$e.ITEM_MID_NM} / ${$e.EQT_CL_NM} / SVC_CMPS_ID: ${$e.SVC_CMPS_ID}`)}),console.log("  output3 ():",((ut=ge.technicianEquipments)==null?void 0:ut.length)||0,""),console.log("  output4 ():",((qe=ge.customerEquipments)==null?void 0:qe.length)||0,""),((Ee=ge.customerEquipments)==null?void 0:Ee.length)>0&&ge.customerEquipments.forEach(($e,$t)=>{console.log(`    [${$t}] ${$e.ITEM_MID_NM} / ${$e.EQT_CL_NM} / EQT_NO: ${$e.EQT_NO} / S/N: ${$e.EQT_SERNO}`)}),console.log("  output5 ():",((Ye=ge.removedEquipments)==null?void 0:Ye.length)||0,""),((pe=ge.removedEquipments)==null?void 0:pe.length)>0&&ge.removedEquipments.forEach(($e,$t)=>{console.log(`    [${$t}] ${$e.ITEM_MID_NM} / ${$e.EQT_CL_NM} / EQT_NO: ${$e.EQT_NO} / S/N: ${$e.EQT_SERNO}`)}),console.log("==========================================");const ue={kpiProdGrpCd:ge.kpiProdGrpCd,prodChgGb:ge.prodChgGb,chgKpiProdGrpCd:ge.chgKpiProdGrpCd,prodGrp:ge.prodGrp};C(ue),window.__equipmentFilterData=ue;const we=(ge.contractEquipments||[]).map($e=>({id:$e.SVC_CMPS_ID||$e.PROD_CMPS_ID,type:$e.ITEM_MID_NM||$e.EQT_NM,model:$e.EQT_CL_NM,serialNumber:"N/A",itemMidCd:$e.ITEM_MID_CD,eqtClCd:$e.EQT_CL_CD||$e.EQT_CL,SVC_CMPS_ID:$e.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:$e.BASIC_PROD_CMPS_ID,PROD_CD:$e.PROD_CD,SVC_CD:$e.SVC_CD})),Je=(ge.technicianEquipments||[]).map($e=>({id:$e.EQT_NO,type:$e.ITEM_MID_NM,model:$e.EQT_CL_NM,serialNumber:$e.EQT_SERNO,itemMidCd:$e.ITEM_MID_CD,eqtClCd:$e.EQT_CL_CD||$e.EQT_CL,macAddress:$e.MAC_ADDRESS,SVC_CMPS_ID:$e.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:$e.BASIC_PROD_CMPS_ID,EQT_PROD_CMPS_ID:$e.EQT_PROD_CMPS_ID,PROD_CD:$e.PROD_CD,SVC_CD:$e.SVC_CD,EQT_SALE_AMT:$e.EQT_SALE_AMT,MST_SO_ID:$e.MST_SO_ID,SO_ID:$e.SO_ID,OLD_LENT_YN:$e.OLD_LENT_YN,LENT:$e.LENT,LENT_YN:$e.LENT_YN,ITLLMT_PRD:$e.ITLLMT_PRD,EQT_USE_STAT_CD:$e.EQT_USE_STAT_CD})),Pe=new Set,Nt=(ge.customerEquipments||[]).map($e=>{const $t=we.find(Ue=>Ue.itemMidCd===$e.ITEM_MID_CD&&!Pe.has(Ue.id));return $t&&Pe.add($t.id),{contractEquipment:$t||{id:"unknown",type:$e.ITEM_MID_NM,model:"",serialNumber:"N/A",itemMidCd:$e.ITEM_MID_CD},actualEquipment:{id:$e.EQT_NO,type:$e.ITEM_MID_NM,model:$e.EQT_CL_NM,serialNumber:$e.EQT_SERNO,itemMidCd:$e.ITEM_MID_CD,eqtClCd:$e.EQT_CL_CD||$e.EQT_CL,macAddress:$e.MAC_ADDRESS||$e.MAC_ADDR,LENT_YN:$e.LENT_YN,VOIP_CUSTOWN_EQT:$e.VOIP_CUSTOWN_EQT},macAddress:$e.MAC_ADDRESS||$e.MAC_ADDR,installLocation:$e.INSTL_LCTN}}),Oe=(ge.removedEquipments||[]).map($e=>({id:$e.EQT_NO,type:$e.ITEM_MID_NM,model:$e.EQT_CL_NM,serialNumber:$e.EQT_SERNO,itemMidCd:$e.ITEM_MID_CD,eqtClCd:$e.EQT_CL_CD||$e.EQT_CL,macAddress:$e.MAC_ADDRESS||$e.MAC_ADDR,installLocation:$e.INSTL_LCTN,SVC_CMPS_ID:$e.SVC_CMPS_ID,BASIC_PROD_CMPS_ID:$e.BASIC_PROD_CMPS_ID,MST_SO_ID:$e.MST_SO_ID,SO_ID:$e.SO_ID,LENT_YN:$e.LENT_YN,VOIP_CUSTOWN_EQT:$e.VOIP_CUSTOWN_EQT}));v(y,{contractEquipments:we,technicianEquipments:Je,removeEquipments:Oe,filteringData:ue});const dt=j||[],gt=K||[];if(console.log("[-]   :",{existingMarkedForRemoval:dt.length,existingInstalledEquipments:gt.length,apiInstalled:Nt.length,apiRemoved:Oe.length}),dt.length===0&&gt.length===0)console.log("[-]   - API  "),Nt.length>0&&(console.log("[-]   :",Nt.length,""),L(y,Nt)),Oe.length>0&&(console.log("[-]  markedForRemoval :",Oe.length,""),P(y,Oe));else if(console.log("[-]  -   "),Nt.length>0){const $e=new Set(dt.map(Ue=>Ue.id)),$t=Nt.filter(Ue=>!$e.has(Ue.actualEquipment.id));L(y,$t)}requestAnimationFrame(()=>k(y,!0))}catch(ge){console.error("[-]    :",ge),requestAnimationFrame(()=>k(y,!0))}},ve=Fe=>{const nt=K.find(lt=>lt.contractEquipment.id===Fe.id);(ce==null?void 0:ce.id)===Fe.id?(B(y,null),I(y,null)):(B(y,Fe),nt?I(y,nt.actualEquipment):I(y,null))},et=Fe=>{(R==null?void 0:R.id)===Fe.id?I(y,null):I(y,Fe)},Dt=()=>{if(!ce||!R)return;if(ce.itemMidCd!==R.itemMidCd||ce.model!==R.model){r==null||r("      .","warning");return}const Fe=K.findIndex(nt=>nt.contractEquipment.id===ce.id);if(Fe>=0){const nt=[...K];nt[Fe]={contractEquipment:ce,actualEquipment:R,macAddress:R.macAddress||"",installLocation:""},L(y,nt)}else{const nt={contractEquipment:ce,actualEquipment:R,macAddress:R.macAddress||"",installLocation:""};L(y,[...K,nt])}E(y,"idle"),I(y,null)},ot=()=>{if(!R)return;const Fe=K.findIndex(Mt=>Mt.actualEquipment.id===R.id);if(Fe>=0){const Mt=[...K],ut=Mt.splice(Fe,1)[0];L(y,Mt);const qe=ut.actualEquipment;j.some(Ye=>Ye.id===qe.id)||M(y,qe),E(y,"idle"),I(y,null);return}if(j.some(Mt=>Mt.id===R.id))return;V.some(Mt=>Mt.id===R.id)&&M(y,R)},At=async(Fe,nt)=>{try{const lt=localStorage.getItem("userInfo");if(!lt){r==null||r("  .","error");return}const Mt=JSON.parse(lt),ut=Fe.map((Ee,Ye)=>{let pe=Ee.ITEM_MID_CD||Ee.ITM_MID_CD||Ee.EQT||Ee.EQT_CD||"",ge=Ee.EQT_CL||Ee.EQT_CL_CD||"",Be=Ee.SVC_CMPS_ID||Ee.PROD_CMPS_ID||Ee.SVC_CMPS_SEQ||Ee.EQUIP_SEQ||"";return pe=String(pe).trim().padStart(2,"0"),ge=String(ge).trim().padStart(6,"0"),Be=String(Be||Ye+1),{CTRT_ID:t.CTRT_ID||"",RCPT_ID:t.RCPT_ID||"",CRR_ID:t.CRR_ID||Mt.crrId||"",WRKR_ID:t.WRKR_ID||Mt.userId||Mt.workerId||"",REG_UID:Mt.userId||Mt.workerId||"A20130708",ITEM_MID_CD:pe,EQT_CL:ge,SVC_CMPS_ID:Be,EQT:pe,EQT_CD:pe,LENT:String(Ee.LENT||"10"),EQT_USE_STAT_CD:String(Ee.EQT_USE_STAT_CD||"1"),ITLLMT_PRD:String(Ee.ITLLMT_PRD||"00"),EQT_SALE_AMT:Number(Ee.EQT_SALE_AMT||0),PROD_GRP:String(Ee.PROD_GRP||t.PROD_GRP||""),PROD_CD:String(Ee.PROD_CD||t.PROD_CD||""),SVC_CD:String(Ee.SVC_CD||""),PROM_CNT:nt||"",SEL:"1",EQT_BASIC_YN:String(Ee.EQT_BASIC_YN||"N"),PROD_TYP:Ee.PROD_TYP,EQUIP_SEQ:Ee.EQUIP_SEQ}}),qe=await c0({WRK_ID:t.id,RCPT_ID:t.RCPT_ID||"",CTRT_ID:t.CTRT_ID||"",PROM_CNT:nt||"",equipments:ut});if(qe.MSGCODE==="SUCCESS"||qe.MSGCODE==="0"||qe.code==="SUCCESS")r==null||r("  .","success"),await me(!0);else throw new Error(qe.MESSAGE||qe.message||"   .")}catch(lt){throw console.error("[] :",lt),r==null||r(lt.message||"     .","error",!0),lt}},ct=async()=>{var Fe,nt,lt,Mt;if(K.length===0){r==null||r("    .","warning"),E(y,"fail");return}try{Z(!0),xe(!0),A(y," ...");const ut=localStorage.getItem("userInfo");if(!ut){A(y,"    ."),E(y,"fail"),Z(!1);return}const qe=JSON.parse(ut),Ee=qe.userId||qe.id||"UNKNOWN",Ye=Pe=>{var gt,It,$e,$t,Ue;const Nt=((gt=Pe.actualEquipment)==null?void 0:gt.eqtClCd)||Pe.eqtClCd||((It=Pe.actualEquipment)==null?void 0:It.EQT_CL_CD)||"",Oe=(($e=Pe.actualEquipment)==null?void 0:$e.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",dt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Nt.startsWith("0904")||Oe==="02"||dt.includes("stb")||dt.includes(""))},pe=Pe=>{var gt,It,$e,$t,Ue;const Nt=((gt=Pe.actualEquipment)==null?void 0:gt.eqtClCd)||Pe.eqtClCd||((It=Pe.actualEquipment)==null?void 0:It.EQT_CL_CD)||"",Oe=(($e=Pe.actualEquipment)==null?void 0:$e.itemMidCd)||Pe.itemMidCd||(($t=Pe.actualEquipment)==null?void 0:$t.ITEM_MID_CD)||"",dt=(((Ue=Pe.actualEquipment)==null?void 0:Ue.type)||Pe.type||"").toLowerCase();return!!(Nt.startsWith("0902")||Oe==="03"||dt.includes("modem")||dt.includes(""))},ge=K.find(Ye),Be=K.find(pe),ue=((Fe=ge==null?void 0:ge.actualEquipment)==null?void 0:Fe.id)||"",we=((nt=Be==null?void 0:Be.actualEquipment)==null?void 0:nt.id)||"",Je=await qu(Ee,t.CTRT_ID||"",t.id,"SMR03",ue||((Mt=(lt=K[0])==null?void 0:lt.actualEquipment)==null?void 0:Mt.id)||"",we||"");Je.O_IFSVC_RESULT&&Je.O_IFSVC_RESULT.startsWith("TRUE")?(A(y,` 

: ${Je.O_IFSVC_RESULT||""}`),E(y,"success")):(A(y,` 

${Je.MESSAGE||"   "}`),E(y,"fail"))}catch(ut){A(y,` 

${ut.message||"   "}`),E(y,"fail")}finally{Z(!1)}},Ge=(Fe,nt,lt)=>{const Mt={...te,[Fe]:{...te[Fe]||{},[nt]:lt==="1"?"0":"1"}};G(y,Mt)},at=()=>{if(!R||!j.some(Ye=>Ye.id===R.id))return;if(ce&&(ce.itemMidCd!==R.itemMidCd||ce.model!==R.model)){r==null||r("      .","warning");return}const nt=ce||ee.find(Ye=>Ye.itemMidCd===R.itemMidCd&&Ye.model===R.model);if(!nt){r==null||r("      .","warning");return}if(K.find(Ye=>Ye.contractEquipment.id===nt.id)){r==null||r("   .","warning");return}const Mt={contractEquipment:nt,actualEquipment:R,macAddress:R.macAddress||"",installLocation:""},ut=[...K,Mt],qe=j.filter(Ye=>Ye.id!==R.id);L(y,ut),P(y,qe);const Ee={...te};delete Ee[R.id],G(y,Ee),I(y,null),console.log("[-]  :",{:ut.length,:qe.length}),r==null||r("   .","success")},xt=b.useMemo(()=>{const Fe=new Set(K.map(lt=>lt.actualEquipment.id));let nt=J.filter(lt=>!Fe.has(lt.id));return ce&&(nt=nt.filter(lt=>lt.itemMidCd===ce.itemMidCd&&lt.model===ce.model)),nt},[K,J,ce]),mt=()=>{se(!0),setTimeout(()=>{se(!1),r==null||r("    .","info")},500)},Ve=async()=>{if(!(Re||g)){be(!0);try{await me(!0),r==null||r("  .","success")}catch(Fe){console.error("[-]  :",Fe),r==null||r("   .","error")}finally{be(!1)}}};return s.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-3 sm:space-y-4 bg-gray-50 pb-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 relative",children:[Re&&s.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-xl",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(Ai,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"   ..."})]})}),s.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h4",{className:"text-sm sm:text-base font-bold text-gray-900",children:["  ",(t.productName||t.PROD_NM)&&s.jsxs("span",{className:"font-normal text-blue-600 ml-1",children:["(",t.productName||t.PROD_NM,")"]})]}),s.jsxs("button",{onClick:Ve,disabled:Re||g,className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all text-xs font-medium ${Re||g?"text-gray-300 cursor-not-allowed":"text-blue-500 hover:text-blue-600 hover:bg-blue-50 active:scale-95"}`,title:"  ",children:[s.jsx(Ai,{className:`w-3.5 h-3.5 ${Re?"animate-spin":""}`}),s.jsx("span",{children:" "})]})]}),s.jsxs("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-semibold rounded-full",children:[ee.length,""]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-100 hover:border-blue-300"}`,onClick:()=>{g||de(!0)},disabled:g,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),c?s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${m?"border-green-300 bg-green-100 text-green-700":_?"border-yellow-300 bg-yellow-100 text-yellow-700":p?"border-gray-300 bg-gray-100 text-gray-400":"border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 hover:border-blue-400"}`,onClick:()=>h==null?void 0:h(),disabled:_||g,children:[_?s.jsx(On,{className:"w-5 h-5 mb-1 animate-spin"}):s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.858 15.355-5.858 21.213 0"})}),s.jsx("span",{className:"text-xs font-semibold",children:m?"LDAP":"LDAP"})]}):s.jsxs("button",{className:`flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] ${g?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":O==="success"?"border-green-300 bg-green-100 text-green-700 hover:bg-green-200 hover:border-green-400":O==="fail"?"border-red-500 bg-red-200 text-red-800 hover:bg-red-300 hover:border-red-600":"border-red-300 bg-red-100 text-red-700 hover:bg-red-200 hover:border-red-400"}`,onClick:()=>!g&&!fe&&ct(),disabled:g||fe,children:[s.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-xs font-semibold",children:""})]}),s.jsxs("button",{className:"flex flex-col items-center justify-center py-2.5 px-1 rounded-lg border-2 transition-all active:scale-95 min-h-[56px] border-purple-200 bg-purple-50 text-purple-600 hover:bg-purple-100 hover:border-purple-300",onClick:()=>c?Ne(!0):_e(!0),children:[s.jsx(vd,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-semibold",children:c?"LDAP":""})]})]})]}),Q?ee.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400",children:"    []  "})]}):s.jsx("div",{className:"p-4 space-y-2",children:ee.map(Fe=>{const nt=K.find(Mt=>Mt.contractEquipment.id===Fe.id),lt=(ce==null?void 0:ce.id)===Fe.id;return s.jsx("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all active:scale-[0.98] ${g?nt?"border-green-200 bg-green-50 cursor-default":"border-gray-200 bg-white cursor-default":lt?"border-blue-500 bg-blue-50 cursor-pointer":nt?"border-green-200 bg-green-50 cursor-pointer":"border-gray-200 bg-white hover:border-gray-300 cursor-pointer"}`,onClick:()=>!g&&ve(Fe),children:s.jsxs("div",{className:"space-y-2.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Fe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Fe.model})]}),nt&&s.jsxs("div",{className:"pt-2.5 border-t border-gray-200 space-y-1.5",children:[s.jsxs("div",{className:"text-sm text-green-700 font-medium",children:[" : ",nt.actualEquipment.model]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["S/N: ",nt.actualEquipment.serialNumber]}),nt.macAddress&&s.jsxs("div",{className:"text-sm text-gray-600",children:["MAC: ",nt.macAddress]})]})]})},Fe.id)})}):s.jsx("div",{className:"py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("div",{className:"text-sm text-gray-500",children:"   ..."})]})})]}),!g&&s.jsxs("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:[s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!R||!K.some(Fe=>Fe.actualEquipment.id===(R==null?void 0:R.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-orange-500 bg-orange-50 text-orange-600 hover:bg-orange-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!R)return;if(J.some(nt=>nt.id===R.id)){if(De!=="stock"){r==null||r("  .   .","warning");return}const nt=K.findIndex(lt=>lt.actualEquipment.id===R.id);if(nt>=0){const lt=[...K];lt.splice(nt,1),L(y,lt),I(y,null),r==null||r("  .","success")}return}ot(),re("removal")},disabled:!R||!K.some(Fe=>Fe.actualEquipment.id===(R==null?void 0:R.id)),children:s.jsx(r0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})}),s.jsx("button",{className:`flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl border-2 transition-all ${!R||K.some(Fe=>Fe.actualEquipment.id===(R==null?void 0:R.id))?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed":"border-blue-500 bg-blue-50 text-blue-600 hover:bg-blue-100 cursor-pointer active:scale-95"}`,onClick:()=>{if(!R)return;if(j.some(Mt=>Mt.id===R.id)){at();return}if(!ce){r==null||r("   .","warning");return}const nt=K.find(Mt=>Mt.contractEquipment.id===ce.id&&!J.some(ut=>ut.id===Mt.actualEquipment.id)),lt=nt&&j.some(Mt=>Mt.id===nt.actualEquipment.id);if(nt&&!lt){r==null||r("   .","warning");return}Dt()},disabled:!R||K.some(Fe=>Fe.actualEquipment.id===(R==null?void 0:R.id)),children:s.jsx(i0,{size:32,className:"sm:w-10 sm:h-10",strokeWidth:2.5})})]}),!g&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex border-b-2 border-gray-200",children:[s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${De==="removal"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>re("removal"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),j.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${De==="removal"?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:j.length})]})}),s.jsx("button",{className:`flex-1 py-3 px-4 text-sm font-semibold transition-all border-b-2 -mb-[2px] ${De==="stock"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>re("stock"),children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),ce&&xt.length>0&&s.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${De==="stock"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:xt.length})]})})]}),De==="removal"?s.jsx(s.Fragment,{children:j.length===0?s.jsxs("div",{className:"py-8 sm:py-12 text-center",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"  "}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"        "})]}):s.jsx("div",{className:"p-3 sm:p-4 space-y-3",children:j.map((Fe,nt)=>{const lt=Fe.id,Mt=te[lt]||{},ut=Mt.EQT_LOSS_YN==="1"||Mt.PART_LOSS_BRK_YN==="1"||Mt.EQT_BRK_YN==="1"||Mt.EQT_CABL_LOSS_YN==="1"||Mt.EQT_CRDL_LOSS_YN==="1",qe=(R==null?void 0:R.id)===Fe.id,Ee=uS(Fe);return s.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${qe?"border-blue-500 bg-blue-50":"border-orange-200 bg-orange-50 hover:border-orange-300"}`,onClick:()=>et(Fe),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 text-white flex items-center justify-center text-sm font-bold",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Fe.type}),s.jsx("div",{className:"text-xs text-gray-600",children:Fe.model}),s.jsxs("div",{className:"text-xs text-gray-500",children:["S/N: ",Fe.serialNumber]})]})]}),s.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full ${ut?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:ut?"":""})]}),!Ee&&s.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{key:"EQT_LOSS_YN",label:""},{key:"PART_LOSS_BRK_YN",label:""},{key:"EQT_BRK_YN",label:""},{key:"EQT_CABL_LOSS_YN",label:""},{key:"EQT_CRDL_LOSS_YN",label:""}].map(Ye=>s.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 rounded-lg border cursor-pointer transition-all ${Mt[Ye.key]==="1"?"border-red-300 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,onClick:pe=>{pe.stopPropagation(),Ge(lt,Ye.key,Mt[Ye.key]||"0")},children:[s.jsx("input",{type:"checkbox",checked:Mt[Ye.key]==="1",onChange:()=>{},className:"w-3.5 h-3.5 rounded border-gray-300 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-xs font-medium",children:Ye.label})]},Ye.key))}),Ee&&s.jsx("div",{className:"mt-2 text-xs text-orange-600 bg-orange-100 p-2 rounded",children:"   "})]},lt||nt)})})}):s.jsx(s.Fragment,{children:ce?xt.length===0?s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})}):s.jsx("div",{className:"p-3 sm:p-4 space-y-2.5 max-h-72 overflow-y-auto",children:xt.map(Fe=>s.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border-2 transition-all cursor-pointer relative active:scale-[0.98] ${(R==null?void 0:R.id)===Fe.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>et(Fe),children:[s.jsxs("div",{className:"space-y-2 sm:space-y-2.5",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:Fe.type}),s.jsx("span",{className:"text-sm sm:text-base font-medium text-gray-600",children:Fe.model})]}),s.jsxs("div",{className:"space-y-1 sm:space-y-1.5",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["S/N: ",Fe.serialNumber]}),Fe.macAddress&&s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["MAC: ",Fe.macAddress]})]})]}),(R==null?void 0:R.id)===Fe.id&&s.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm sm:text-base font-bold",children:""})]},Fe.id))}):s.jsx("div",{className:"py-8 sm:py-12 text-center",children:s.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"     "})})})]}),(()=>{var Mt;const Fe=t.WRK_CD_NM||g0(t.WRK_CD)||t.workType||"-",nt=t.PROD_NM||t.productName||((Mt=t.customer)==null?void 0:Mt.productName)||"-",lt=t.CTRT_STAT_NM||Qu(t.CTRT_STAT)||"-";return s.jsx(f0,{isOpen:$,onClose:()=>de(!1),prodCd:t.PROD_CD||"",ctrtId:t.CTRT_ID||"",ctrtStatNm:lt,prodGrp:t.PROD_GRP||"",prodNm:nt,wrkCdNm:Fe,onSave:At,showToast:r,installedEquipmentCount:K.length,customerEquipmentCount:q})})(),!g&&s.jsx("button",{onClick:mt,disabled:le,className:`fixed bottom-24 right-4 z-40 w-14 h-14 sm:w-16 sm:h-16 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${le?"bg-blue-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,title:" ",children:s.jsx(l0,{className:"w-7 h-7 sm:w-8 sm:h-8"})}),s.jsx(el,{isOpen:ae,onClose:()=>_e(!1),ctrtId:t.CTRT_ID,custId:t.CUST_ID||((it=t.customer)==null?void 0:it.id)}),s.jsx(m0,{isOpen:ie,onClose:()=>Ne(!1),ctrtId:t.DTL_CTRT_ID||t.CTRT_ID}),X&&Xu.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[9999] p-4",onClick:()=>!fe&&xe(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full overflow-hidden",onClick:Fe=>Fe.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:""})}),s.jsx("div",{className:"px-6 py-8",children:fe?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-blue-500",children:s.jsx(On,{className:"animate-spin",size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" ..."}),s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}):O==="success"?s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-green-500",children:s.jsx(a0,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" !"}),s.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-lg border border-gray-200",children:s.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:U})})]}):s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"text-red-500",children:s.jsx(tc,{size:64})}),s.jsx("p",{className:"text-base font-semibold text-gray-900",children:" "}),s.jsx("div",{className:"w-full p-4 bg-red-50 rounded-lg border border-red-200",children:s.jsx("pre",{className:"text-xs text-red-700 whitespace-pre-wrap font-mono",children:U})})]})}),s.jsx("div",{className:"px-6 py-4 border-t border-gray-100",children:s.jsx("button",{className:`w-full py-3 rounded-lg font-semibold transition-colors ${O==="success"?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,onClick:()=>xe(!1),disabled:fe,children:fe?" ...":""})})]})}),document.body)]})},qY=t=>{const{workItem:e}=t,n=e.WRK_CD;switch(n){case"01":return s.jsx(xR,{...t});case"02":return s.jsx(GY,{...t});case"03":return s.jsx(WY,{...t});case"04":return s.jsx(FY,{...t});case"05":return s.jsx(KY,{...t});case"06":return s.jsx(QY,{...t});case"07":return s.jsx($Y,{...t});case"08":return s.jsx(zY,{...t});case"09":return s.jsx(HY,{...t});default:return console.warn(`[EquipmentRouter] Unknown WRK_CD: ${n}, using default (Install)`),s.jsx(xR,{...t})}},XY=({ctrtId:t,certifyOpLnkdCd:e,installedEquipments:n,showToast:r})=>{const[i,a]=b.useState(!1),{ldapResult:o,setLdapResult:c}=Za();return{handleLdapConnect:async(m=!1)=>{const _=["F","FG","Z","ZG"].includes(e),p=["N","NG"].includes(e),g=n.some(y=>{var v,k,L,M;const S=((v=y.actualEquipment)==null?void 0:v.ITEM_MID_CD)||((k=y.actualEquipment)==null?void 0:k.itemMidCd)||((L=y.contractEquipment)==null?void 0:L.ITEM_MID_CD)||((M=y.contractEquipment)==null?void 0:M.itemMidCd)||y.ITEM_MID_CD||y.itemMidCd||"";return S==="02"||S==="31"}),C=n.some(y=>{var v,k,L,M;const S=((v=y.actualEquipment)==null?void 0:v.ITEM_MID_CD)||((k=y.actualEquipment)==null?void 0:k.itemMidCd)||((L=y.contractEquipment)==null?void 0:L.ITEM_MID_CD)||((M=y.contractEquipment)==null?void 0:M.itemMidCd)||y.ITEM_MID_CD||y.itemMidCd||"";return S==="10"||S==="32"});if(_){if(!g){r==null||r("FTTH  ONT  .","warning");return}if(!C){r==null||r("FTTH  AP  .","warning");return}}else if(p&&!C){r==null||r("  AP  .","warning");return}if(n.length<1){r==null||r(" .","warning");return}if(!t){r==null||r(" ID .","error");return}a(!0);try{console.log("[useLdapConnect]  :",{ctrtId:t,opLnkdCd:e});const y=await eN(t);if(console.log("[useLdapConnect]  :",y),y.exists&&y.data.length>0){const S=y.data[0];c(S),r==null||r("LDAP  .","success")}else c({_empty:!0}),r==null||r("LDAP  . (  )","info")}catch(y){console.error("[useLdapConnect]  :",y),r==null||r(y.message||"LDAP  .","error")}finally{a(!1)}},ldapLoading:i,ldapResult:o,isLdapDone:!!o}},JY=["01","05","06","07"],ZY=({equipList:t,portList:e,isFtth:n,onEquipChange:r,selectedEqipId:i,onClose:a,showToast:o,entrNo:c,entrRqstNo:u,workItem:h})=>{const m=t.find(H=>H.EQIP_ID===i),_=b.useMemo(()=>t.map(H=>({value:H.EQIP_ID,label:`${H.EQIP_ID} - ${H.ESTB_PLC_NM||H.EQIP_NM||""}`})),[t]),[p,g]=b.useState(!1),[C,y]=b.useState([]),[S,v]=b.useState(!1),[k,L]=b.useState(!1),[M,P]=b.useState([]),[F,G]=b.useState(""),[B,I]=b.useState(""),[E,A]=b.useState(!1),Y=async()=>{if(g(!0),!(C.length>0)){v(!0);try{const H=await zg({COMMON_GRP:"LGCT015"});y(H||[])}catch(H){console.error("[PortStatusModal] LGCT015  :",H)}finally{v(!1)}}},ee=async()=>{if(L(!0),!(M.length>0))try{const H=await po(["LGWO001"]),V=(H==null?void 0:H.LGWO001)||(H==null?void 0:H.output13)||[];P(Array.isArray(V)?V:[])}catch(H){console.error("[PortStatusModal] LGWO001  :",H)}},J=async(H,V)=>{if(!F){o==null||o(" .","warning");return}if(!B.trim()){o==null||o("  .","warning");return}A(!0);try{const K=await zP({ENTR_RQST_NO:H.entrRqstNo||"",CONS_REQ_RSN_CD:F,HSVC_INCR_RSN_CNTN:B,HSVC_CONS_RQMN_DIVS_CD:"2",SBGN_DEAL_NM:V.crrNm||V.name||"",SBGN_DEAL_TLNO:"",SBGN_EGNR_NM:V.name||V.userName||"",SBGN_EGNR_HPHN_TLNO:V.phone||V.hpNo||"",CTRT_ID:H.ctrtId||"",RCPT_ID:H.rcptId||"",WRK_ID:H.wrkId||"",ENTR_NO:c||""});K.RESULT_CD&&!K.RESULT_CD.startsWith("N")?(o==null||o(" .","success"),L(!1),G(""),I("")):o==null||o(K.RESULT_MSG||"  .","error")}catch(K){console.error("[PortStatusModal] Port :",K),o==null||o(K.message||"  .","error")}finally{A(!1)}};return p?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"LGU+ L2  "}),s.jsx("button",{onClick:()=>g(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(Mi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"flex-1 overflow-auto p-3",children:S?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})}):C.length===0?s.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:" ."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-xs",style:{minWidth:"400px"},children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100",children:[s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:C.map((H,V)=>s.jsxs("tr",{className:`border-b border-gray-50 ${V%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("td",{className:"px-2 py-2 text-gray-900 whitespace-nowrap",children:H.COMMON_CD_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:H.REF_CODE||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:H.REF_CODE2||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:H.REF_CODE3||"-"})]},V))})]})})}),s.jsx("div",{className:"p-3 border-t border-gray-200 flex justify-end",children:s.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700",children:""})})]})}):k?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Port  "}),s.jsx("button",{onClick:()=>L(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(Mi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:""}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-800 font-mono",children:c||"-"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:""}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-800",children:(()=>{try{const H=JSON.parse(localStorage.getItem("userInfo")||"{}");return H.name||H.userName||"-"}catch{return"-"}})()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:""}),s.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-800 font-mono",children:(()=>{try{const H=JSON.parse(localStorage.getItem("userInfo")||"{}");return H.phone||H.hpNo||"-"}catch{return"-"}})()})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:[" ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(sn,{value:F,onChange:H=>G(H),placeholder:"",options:M.map((H,V)=>({value:H.COMMON_CD||H.code||"",label:H.COMMON_CD_NM||H.name||H.COMMON_CD||""}))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:B,onChange:H=>I(H.target.value.slice(0,512)),placeholder:"     ",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg resize-none focus:border-orange-400 focus:outline-none"}),s.jsxs("div",{className:"text-right text-xs text-gray-400 mt-0.5",children:[B.length,"/512"]})]})]}),s.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[s.jsx("button",{onClick:()=>{const H=(()=>{try{return JSON.parse(localStorage.getItem("userInfo")||"{}")}catch{return{}}})(),V={entrRqstNo:u||"",ctrtId:(h==null?void 0:h.CTRT_ID)||(h==null?void 0:h.ctrtId)||"",rcptId:(h==null?void 0:h.RCPT_ID)||(h==null?void 0:h.rcptId)||(h==null?void 0:h.receiptId)||"",wrkId:(h==null?void 0:h.id)||(h==null?void 0:h.WRK_ID)||"",crrNm:(h==null?void 0:h.CRR_NM)||""};J({...V,crrNm:V.crrNm},{...H,crrNm:V.crrNm})},disabled:E,className:`w-full py-3 rounded-lg text-sm font-semibold transition-colors ${E?"bg-gray-300 text-gray-500":"bg-orange-500 text-white hover:bg-orange-600"}`,children:E?" ...":" "}),s.jsx("button",{onClick:()=>L(!1),className:"w-full py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700",children:""})]})]})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[85vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-900 whitespace-nowrap",children:["LGU+ ",n?"RN":"L2"," "]}),s.jsx("button",{onClick:a,className:"p-1 rounded-full hover:bg-gray-100",children:s.jsx(Mi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length===0?s.jsx("div",{className:"text-center text-gray-500 py-8",children:"  ."}):s.jsxs(s.Fragment,{children:[n&&c&&s.jsxs("div",{className:"bg-purple-50 rounded-lg px-3 py-2 flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-purple-600 font-semibold whitespace-nowrap",children:"LGU+ "}),s.jsx("span",{className:"text-xs font-mono font-bold text-purple-900 whitespace-nowrap",children:c})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 whitespace-nowrap",children:" "}),s.jsx(sn,{value:i,onValueChange:r,options:_,placeholder:" "})]}),m&&s.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:n?s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-semibold truncate",children:m.MDL_NM||"-"})]}),s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"truncate",children:m.EQIP_ESTB_FLOO_NM||"-"})]})]}):s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-semibold truncate",children:m.ESTB_PLC_NM||"-"})]}),s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-semibold truncate",children:m.MDL_NM||"-"})]}),s.jsxs("div",{className:"whitespace-nowrap",children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"truncate",children:m.EQIP_ESTB_FLOO_NM||"-"})]})]})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"text-xs font-semibold text-gray-600 whitespace-nowrap",children:" "}),s.jsxs("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:[e.length,""]})]}),s.jsxs("div",{className:"border rounded-lg overflow-hidden overflow-x-auto",children:[s.jsxs("div",{className:"grid grid-cols-4 bg-gray-100 text-xs font-semibold text-gray-600 px-2 py-2 border-b min-w-[320px]",children:[s.jsx("div",{className:"whitespace-nowrap",children:""}),s.jsx("div",{className:"whitespace-nowrap",children:"U+"}),s.jsx("div",{className:"whitespace-nowrap",children:""}),s.jsx("div",{className:"text-center whitespace-nowrap",children:""})]}),e.length===0?s.jsx("div",{className:"text-center text-gray-400 text-xs py-4",children:" "}):s.jsx("div",{className:"max-h-64 overflow-y-auto divide-y",children:e.map((H,V)=>s.jsxs("div",{className:`grid grid-cols-4 text-xs px-2 py-2 hover:bg-gray-50 min-w-[320px] ${H.PT_USE==="Y"?"bg-red-50/50":""}`,children:[s.jsx("div",{className:"font-mono whitespace-nowrap",children:H.PORT_NO||"-"}),s.jsx("div",{className:"font-mono text-gray-600 whitespace-nowrap truncate",children:H.ENTR_NO||"-"}),s.jsx("div",{className:"font-mono text-gray-600 whitespace-nowrap truncate",children:H.CTRT_ID||"-"}),s.jsx("div",{className:"text-center whitespace-nowrap",children:s.jsx("span",{className:`px-1.5 py-0.5 rounded text-[0.625rem] font-medium whitespace-nowrap ${H.PT_USE==="Y"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:H.PT_USE==="Y"?"":""})})]},V))})]})]})]})}),s.jsxs("div",{className:"p-4 border-t space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[!n&&s.jsxs("button",{onClick:Y,className:"flex-1 py-2 bg-purple-500 text-white rounded-lg font-semibold text-sm flex items-center justify-center gap-1.5 hover:bg-purple-600 transition-colors whitespace-nowrap",children:[s.jsx(yM,{className:"w-4 h-4 flex-shrink-0"}),"L2 "]}),s.jsx("button",{onClick:ee,className:"flex-1 py-2 bg-orange-500 text-white rounded-lg font-semibold text-sm hover:bg-orange-600 transition-colors whitespace-nowrap",children:"Port"})]}),s.jsx("button",{onClick:a,className:"w-full py-2 bg-gray-600 text-white rounded-lg font-semibold",children:""})]})]})})},eV=({workItem:t,onSave:e,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o=!1,isCertifyProd:c=!1,certifyOpLnkdCd:u=""})=>{const{setEquipmentData:h}=ta(),{entrNo:m,entrRqstNo:_,setEntrNo:p,lguMarketCd:g,lguOperatorId:C,lguJobType:y,lguJobTypeConf:S,setLguCommonCd:v,cl02PortData:k,setCl02PortData:L,isSubscriptionDone:M,setIsSubscriptionDone:P}=Za(),F=t.id||t.WRK_ID||"",G=ki(Re=>{var be;return((be=Re.workStates[F])==null?void 0:be.installedEquipments)||[]}),{handleLdapConnect:B,ldapLoading:I,ldapResult:E,isLdapDone:A}=XY({ctrtId:t.DTL_CTRT_ID||t.CTRT_ID||"",certifyOpLnkdCd:u,installedEquipments:G,showToast:r}),[Y,ee]=b.useState(!1),[J,H]=b.useState(!1),[V,K]=b.useState(!1),[j,te]=b.useState([]),[ce,R]=b.useState([]),[O,U]=b.useState(""),Q=["F","FG","Z","ZG"].includes(u),[q,$]=b.useState({isOpen:!1,message:"",onConfirm:()=>{}}),de=t.WRK_CD||"",ae=t.DTL_CTRT_ID||t.CTRT_ID||"",_e=JY.includes(de),ie=_e&&!M,Ne=b.useCallback(()=>{if(_e&&!M){r==null||r("  .","warning");return}$({isOpen:!0,title:"LDAP ",message:"LDAP  ?",type:"confirm",onConfirm:()=>B(!0)})},[B,_e,M,k,r]),X=b.useCallback(()=>{try{const Re=localStorage.getItem("userInfo");if(Re)return JSON.parse(Re)}catch{}return{}},[]);b.useEffect(()=>{if(!c||g)return;(async()=>{try{const be=await po(["LGCT002"]),De=(be==null?void 0:be.LGCT002)||(be==null?void 0:be.output13);if(De&&Array.isArray(De)&&De.length>0){const re=De[0];v(re.REF_CODE||"",re.REF_CODE2||"",re.REF_CODE4||"",re.REF_CODE5||""),console.log("[LGU+]  : MRKT_CD=",re.REF_CODE,"OPERATOR_ID=",re.REF_CODE2,"JOB_TYPE=",re.REF_CODE4,"JOB_TYPE_CONF=",re.REF_CODE5)}}catch(be){console.error("[LGU+]   :",be)}})()},[c,g,v]),b.useEffect(()=>{if(!c||!_e||!ae||m||M)return;(async()=>{var be;try{const De=await zC({CTRT_ID:ae}),re=((be=De==null?void 0:De[0])==null?void 0:be.ENTR_NO)||"";re&&(console.log("[LGU+]   :",re),p(re,null),P(!0))}catch(De){console.error("[LGU+]   :",De)}})()},[c,_e,ae,m,M]);const xe=async Re=>{var re,me,ve;const be=X(),De=be.userId||be.id||"";ee(!0);try{if(Re){const Dt=t.CRR_ID||"",ot=t.SO_ID||"",At=t.CUST_ID||((re=t.customer)==null?void 0:re.id)||"";(!Dt||!ot)&&console.warn("[LGU+]    - CRR_ID:",Dt,"SO_ID:",ot),await EM({CTRT_ID:ae,CUST_ID:At,WRK_ID:F,CRR_ID:Dt,SO_ID:ot,REG_UID:De,CANCEL_TYPE:"SUBSCRIPTION",MRKT_CD:g,OPERATOR_ID:C}),console.log("[LGU+]    ")}const et=await VP({WRK_ID:F,CTRT_ID:ae,MRKT_CD:g,OPERATOR_ID:C,REG_UID:De});if(et.RESULT_CD==="Y"){if(r==null||r("  .","success"),p(et.ENTR_NO||null,et.ENTR_RQST_NO||null),P(!0),E&&!E._empty){const Dt=t.SO_ID||"";Dt||console.warn("[LGU+] LDAP   - SO_ID ");try{(E.AP_MAC_ADDR||E.AP_EQT_NO)&&(await mE({MSG_ID:"SMR05",EVNT_CD:"",CUST_ID:t.CUST_ID||((me=t.customer)==null?void 0:me.id)||"",CTRT_ID:ae,SO_ID:Dt,AP_MAC:E.AP_MAC_ADDR||"",AP_EQT_NO:E.AP_EQT_NO||"",ONT_MAC:"",ONT_EQT_NO:"",REG_UID:De,JOB_TYPE:y,JOB_TYPE_CONF:S,ENTR_NO:et.ENTR_NO||""}),console.log("[LGU+] AP   ")),(E.ONT_MAC_ADDR||E.ONT_EQT_NO)&&(await mE({MSG_ID:"SMR05",EVNT_CD:"FM",CUST_ID:t.CUST_ID||((ve=t.customer)==null?void 0:ve.id)||"",CTRT_ID:ae,SO_ID:Dt,AP_MAC:"000000000000",AP_EQT_NO:"",ONT_MAC:"",ONT_EQT_NO:"",REG_UID:De,JOB_TYPE:y,JOB_TYPE_CONF:S,ENTR_NO:et.ENTR_NO||""}),console.log("[LGU+] ONT   "))}catch(ot){console.warn("[LGU+] LDAP    ():",ot)}}}else r==null||r(et.RESULT_MSG||"  .","error")}catch(et){console.error("[LGU+]  :",et),r==null||r(et.message||" .","error")}finally{ee(!1)}},fe=async()=>{var Re;if(!ae){r==null||r(" ID .","error");return}if(!g||!C){r==null||r("LGU+    .    .","error"),console.error("[LGU+]   - lguMarketCd:",g,"lguOperatorId:",C);return}ee(!0);try{const be=await zC({CTRT_ID:ae}),De=((Re=be==null?void 0:be[0])==null?void 0:Re.ENTR_NO)||"";ee(!1),$(De?{isOpen:!0,title:"U+  ",message:`  .
 ?`,type:"warning",onConfirm:()=>xe(De)}:{isOpen:!0,title:"U+  ",message:"U+  ?",type:"confirm",onConfirm:()=>xe("")})}catch(be){ee(!1),console.error("[LGU+]  :",be),r==null||r(be.message||" .","error")}},Z=async()=>{var re;if(j.length>0){H(!0);return}if(!m){r==null||r("(ENTR_NO) .   .","error");return}const Re=_?"01":"02",be=_||"null",De=Q?"ftthEqipList":"opticEqipList";K(!0);try{const me=await vM({COMMAND:De,ENTR_NO:m,ENTR_RQST_NO:be,BIZ_TYPE:Re,CTRT_ID:ae});if(!me||me.length===0){r==null||r("  .","info"),K(!1);return}if((re=me[0])!=null&&re.RESULT_CD&&me[0].RESULT_CD.startsWith("N")){r==null||r(` : ${me[0].RESULT_MSG||""}`,"error"),K(!1);return}te(me);const ve=me[0].EQIP_ID;U(ve);const Dt=await HC({COMMAND:Q?"ftthEqipPortList":"opticEqipPortList",EQIP_ID:ve,CTRT_ID:ae});R(Dt||[]),H(!0)}catch(me){console.error("[LGU+]  :",me),r==null||r(me.message||" .","error")}finally{K(!1)}},le=async Re=>{U(Re);const be=Q?"ftthEqipPortList":"opticEqipPortList";try{const De=await HC({COMMAND:be,EQIP_ID:Re,CTRT_ID:ae});R(De||[])}catch(De){console.error("[LGU+]   :",De),R([])}},se=Re=>{console.log("[WorkEquipmentManagement]  :",Re),h(Re),e(Re)};return s.jsxs("div",{className:"work-equipment-management",children:[c&&!o&&_e&&s.jsx("div",{className:"mx-3 mt-2 mb-1",children:s.jsx("div",{className:`rounded-lg border p-3 ${M?"bg-green-50 border-green-200":"bg-orange-50 border-orange-200"}`,children:s.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx($h,{className:`w-5 h-5 flex-shrink-0 ${M?"text-green-600":"text-orange-600"}`}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:`text-sm font-semibold whitespace-nowrap ${M?"text-green-800":"text-orange-800"}`,children:"U+ "}),m&&s.jsxs("div",{className:"text-xs text-gray-600 truncate",children:[": ",s.jsx("span",{className:"font-mono font-semibold",children:m})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.jsx("button",{onClick:fe,disabled:Y,className:`px-4 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition-colors bg-orange-500 text-white hover:bg-orange-600 ${Y?"opacity-50":""}`,children:Y?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(On,{className:"w-4 h-4 animate-spin"}),"..."]}):""}),s.jsx("button",{onClick:Z,disabled:V,className:"px-3 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200",children:V?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(On,{className:"w-3 h-3 animate-spin"}),""]}):s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Yu,{className:"w-3 h-3"}),""]})})]})]})})}),c&&o&&m&&s.jsx("div",{className:"mx-3 mt-2 mb-1",children:s.jsx("div",{className:"rounded-lg border p-3 bg-green-50 border-green-200",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ea,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-semibold text-green-800",children:""}),s.jsx("span",{className:"text-xs text-gray-600 font-mono",children:m})]})})}),s.jsx(qY,{workItem:t,onSave:se,onBack:n,showToast:r,preloadedApiData:i,onPreloadedDataUpdate:a,readOnly:o,isCertifyProd:c,certifyOpLnkdCd:u,onLdapConnect:Ne,isLdapDone:A,ldapLoading:I,ldapBlocked:ie}),J&&s.jsx(ZY,{equipList:j,portList:ce,isFtth:Q,onEquipChange:le,selectedEqipId:O,onClose:()=>H(!1),showToast:r,entrNo:m||"",entrRqstNo:_||"",workItem:t}),s.jsx(Ba,{isOpen:q.isOpen,onClose:()=>$(Re=>({...Re,isOpen:!1})),onConfirm:q.onConfirm,title:q.title,message:q.message,type:q.type})]})},tV=[],sV=({workItem:t,showToast:e,readOnly:n=!1})=>{const[r,i]=b.useState(!1),[a,o]=b.useState(null),[c,u]=b.useState(null),[h,m]=b.useState(!1),[_,p]=b.useState(0),[g,C]=b.useState(null),[y,S]=b.useState(!1),[v,k]=b.useState(!1),[L,M]=b.useState(null),[P,F]=b.useState(null),[G,B]=b.useState([]),[I,E]=b.useState(""),[A,Y]=b.useState([]),[ee,J]=b.useState(-1),[H,V]=b.useState(!1),[K,j]=b.useState(!1),[te,ce]=b.useState(""),[R,O]=b.useState(""),[U,Q]=b.useState(!1),[q,$]=b.useState(!1),[de,ae]=b.useState([]),[_e,ie]=b.useState(!1),[Ne,X]=b.useState(!1),{certifyRegconfInfo:xe,setCertifyRegconfInfo:fe,certifyOpLnkdCd:Z,isLineRegistrationDone:le,setIsLineRegistrationDone:se,entrNo:Re,lguMarketCd:be}=Za(),De=["F","FG","Z","ZG"].includes(Z),re=()=>["F","FG","Z","ZG"].includes(Z)?"ftthEqipList":["V","VG"].includes(Z)?"vdslEqipList":"opticEqipList",me=()=>["F","FG","Z","ZG"].includes(Z)?"ftthEqipPortList":["V","VG"].includes(Z)?"vdslEqipPortList":"opticEqipPortList",ve=t.id,et=ki(Ee=>{var Ye;return((Ye=Ee.workStates[ve])==null?void 0:Ye.installedEquipments)??tV}),Dt=b.useMemo(()=>et.map(Ee=>{var Ye;return((Ye=Ee.actualEquipment)==null?void 0:Ye.id)||""}).sort().join(","),[et]),ot=b.useRef(Dt);b.useEffect(()=>{if(xe){const Ee=xe._equipmentFingerprint;if(Ee&&Ee!==Dt){fe(null);return}o(xe),m(!0)}},[]),b.useEffect(()=>{(async()=>{const Ye=t.CTRT_ID||"";if(Ye){Q(!0);try{const pe=await zC({CTRT_ID:Ye});if(pe&&pe.length>0){const ge=pe[0];ce(ge.ENTR_NO||""),O(ge.ENTR_RQST_NO||"")}}catch(pe){console.error("[] ENTR_NO  :",pe)}finally{Q(!1)}}})()},[t.CTRT_ID]),b.useEffect(()=>{ot.current!==Dt&&(ot.current=Dt,h&&(o(null),fe(null),m(!1),p(0),se(!1)))},[Dt]),b.useEffect(()=>{ot.current===Dt&&h&&(o(null),fe(null),m(!1),se(!1))},[_]);const{ontMac:At,apMac:ct,ontSerial:Ge,apList:at}=b.useMemo(()=>{var Be;let Ee="",Ye="";const pe=[];for(const ue of et){const we=ue.actualEquipment||{},Je=ue.contractEquipment||{},Pe=we.itemMidCd||we.ITEM_MID_CD||Je.itemMidCd||Je.ITEM_MID_CD||"",Nt=we.macAddress||we.MAC_ADDRESS||ue.macAddress||"",Oe=we.serialNumber||we.EQT_SERNO||"";(Pe==="02"||Pe==="31")&&(Ee=Nt||Oe,Ye=Oe),(Pe==="10"||Pe==="32")&&pe.push({mac:Nt||Oe,serialNumber:Oe,model:we.model||we.EQT_CL_NM||"",type:Je.type||we.type||"AP"})}const ge=pe.length>0?((Be=pe[_])==null?void 0:Be.mac)||pe[0].mac:"";return{ontMac:Ee,apMac:ge,ontSerial:Ye,apList:pe}},[et,_]),xt=b.useCallback(async()=>{if(!n){if(!te){M("ENTR_NO . LGU+  ."),e==null||e("ENTR_NO .","error");return}S(!0),M(null);try{const Ee=t.CTRT_ID||"",Ye=await hE({ENTR_NO:te,CTRT_ID:Ee});if(!Ye||(Ye.RESULT_CD||"").startsWith("N")){const gt=(Ye==null?void 0:Ye.RESULT_MSG)||"L2  ";M(`LGU    (${Ee})
${gt}`),e==null||e(`L2  : ${gt}`,"error");return}const pe=Ye.MDL_NM||"",ge=Ye.EQIP_ID||"",Be=Ye.PRT_INDX_NM||"",ue=Ye.ESTB_PLC_NM||"";try{await fE({ENTR_NO:te,ENTR_RQST_NO:R||"null",BIZ_TYPE:"01",CTRT_ID:Ee})}catch(gt){console.warn("[L2] getUplsEntrEqipDtl error (non-critical):",gt)}let we="",Je="",Pe="",Nt="";if(pe)try{const gt=await zg({COMMON_GRP:"LGCT015"});if(gt){const It=gt.find($e=>$e.COMMON_CD===pe);It&&(we=It.COMMON_CD_NM||"",Je=It.REF_CODE||"",Pe=It.REF_CODE2||"",Nt=It.REF_CODE3||"")}}catch(gt){console.warn("[L2] LGCT015 lookup error:",gt)}C({autoYn:"Y",buildingName:ue,portNo:Be,equipId:ge,modelNm:we,maxSpeed:Je,manufacturer:Pe,remarks:Nt,mdlNmRaw:pe}),k(!0),fe({...xe||{},EQIP_ID:ge,EQIP_PORT_NO:Be,EQIP_DIVS:"L2",DEL_YN:"N"}),e==null||e("L2  .","success")}catch{M("L2    ."),e==null||e("L2    .","error")}finally{S(!1)}}},[te,R,t.CTRT_ID,n,xe,fe,e]),mt=b.useCallback(async()=>{var Ee;if(!(n||!te)){V(!0),M(null);try{const Ye=t.CTRT_ID||"",pe=await hE({ENTR_NO:te,CTRT_ID:Ye});if(!pe||(pe.RESULT_CD||"").startsWith("N")){const Je=(pe==null?void 0:pe.RESULT_MSG)||"OLT  ";M(`LGU OLT    (${Ye})
${Je}`),e==null||e(`OLT  : ${Je}`,"error");return}const ge={OLT_ID:pe.EQIP_ID||"",OLT_MDL_NM:pe.MDL_NM||"",OLT_PORT_NO:pe.PRT_INDX_NM||"",ESTB_PLC_NM:pe.ESTB_PLC_NM||""};F(ge);try{await fE({ENTR_NO:te,ENTR_RQST_NO:R||"null",BIZ_TYPE:"01",CTRT_ID:Ye})}catch(Je){console.warn("[FTTH] getUplsEntrEqipDtl error:",Je)}const Be=await vM({COMMAND:re(),ENTR_NO:te,ENTR_RQST_NO:R||"null",BIZ_TYPE:"01",CTRT_ID:Ye});if(!Be||Be.length===0){M("RN   ."),e==null||e("RN   .","warning");return}const ue=Be.map(Je=>{const Pe={};for(const Nt of Object.keys(Je))Pe[Nt.toUpperCase()]=Je[Nt];return Pe});B(ue);const we=((Ee=ue[0])==null?void 0:Ee.EQIP_ID)||"";E(we),we&&await it(we,Ye),e==null||e("FTTH  ","success")}catch(Ye){console.error("[FTTH]  :",Ye),M("FTTH    ."),e==null||e("FTTH  ","error")}finally{V(!1)}}},[te,R,t.CTRT_ID,n,Z,e]),Ve=b.useRef(!1);b.useEffect(()=>{Ve.current||n||!te||U||(Ve.current=!0,De?mt():xt())},[te,U,n,De,xt,mt]);const it=async(Ee,Ye)=>{j(!0),J(-1);try{const ge=(await HC({COMMAND:me(),EQIP_ID:Ee,CTRT_ID:Ye})||[]).map(Be=>{const ue={};for(const we of Object.keys(Be))ue[we.toUpperCase()]=Be[we];return ue});Y(ge)}catch(pe){console.error("[FTTH]   :",pe),Y([])}finally{j(!1)}},Fe=async Ee=>{E(Ee),J(-1);const Ye=t.CTRT_ID||"";Ee&&await it(Ee,Ye)},nt=Ee=>{J(Ee);const Ye=A[Ee];if(!Ye||!P)return;fe({...xe||{},OLT_ID:P.OLT_ID,OLT_PORT:P.OLT_PORT_NO,EQIP_ID:I,EQIP_PORT_NO:Ye.PORT_NO,EQIP_PORT_USE:Ye.PT_USE,PORT_ENTR_NO:Ye.ENTR_NO,EQIP_DIVS:"OLT",DEL_YN:"N"})},lt=b.useCallback(async()=>{if($(!0),!(de.length>0)){ie(!0);try{const Ee=await zg({COMMON_GRP:"LGCT015"});ae(Ee||[])}catch(Ee){console.error("[L2] LGCT015  :",Ee)}finally{ie(!1)}}},[de.length]),Mt=async()=>{if(n)return;const Ee=xe;if(!(Ee!=null&&Ee.EQIP_PORT_NO)){e==null||e(" .    .","warning");return}X(!0),u(null);try{if(De&&Ee.EQIP_PORT_USE==="Y"&&Ee.PORT_ENTR_NO!==(Re||te)){e==null||e("  .    .","error"),X(!1);return}if(!De&&(Z==="N"||Z==="NG")){const Ye=(Ee.EQIP_PORT_NO||"").replace(/\//g,"__"),pe=await $P({ENTR_NO:Re||te,EQIP_ID:Ee.EQIP_ID||"",PORT_NM:Ye,CTRT_ID:t.CTRT_ID||""});if(!pe.success){e==null||e(`LGU+   
${pe.RESULT_MSG}`,"error"),X(!1);return}if(pe.ENTR_EXIST==="Y"){e==null||e("LGU+  .   .","error"),fe(null),X(!1);return}}se(!0),e==null||e("LGU+  .","success")}catch(Ye){console.error("[]  :",Ye),u("    ."),e==null||e("  ","error")}finally{X(!1)}},ut=({label:Ee,value:Ye})=>s.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-gray-100 last:border-b-0",children:[s.jsx("span",{className:"text-xs text-gray-500",children:Ee}),s.jsx("span",{className:"text-xs font-medium text-gray-900 text-right max-w-[60%] truncate",children:Ye||"-"})]}),qe=G.find(Ee=>Ee.EQIP_ID===I);return s.jsxs("div",{className:"px-3 sm:px-4 py-4 sm:py-6 pb-3 sm:pb-4 space-y-3 sm:space-y-4",children:[at.length>1&&!n&&s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 sm:p-4",children:[s.jsxs("h5",{className:"text-xs sm:text-sm font-semibold text-amber-800 mb-2 flex items-center gap-1.5",children:[s.jsx(kp,{className:"w-4 h-4"}),"AP  (",at.length," )"]}),s.jsx("div",{className:"space-y-2",children:at.map((Ee,Ye)=>s.jsxs("label",{className:`flex items-center gap-3 p-2.5 rounded-lg border cursor-pointer transition-colors ${_===Ye?"border-amber-400 bg-amber-100":"border-gray-200 bg-white hover:border-amber-300"}`,onClick:()=>p(Ye),children:[s.jsx("input",{type:"radio",name:"apSelect",checked:_===Ye,onChange:()=>p(Ye),className:"w-4 h-4 text-amber-600"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:[Ee.type," ",Ee.model&&`(${Ee.model})`]}),s.jsxs("div",{className:"text-xs text-gray-500 font-mono truncate",children:["MAC: ",Ee.mac||"-"]})]})]},Ye))})]}),!De&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("h5",{className:"text-xs sm:text-sm font-bold text-gray-900 flex items-center gap-1.5",children:[s.jsx(oE,{className:"w-4 h-4 text-purple-500"}),"()",v&&s.jsx(ea,{className:"w-3.5 h-3.5 text-green-500 ml-1"}),y&&s.jsx("div",{className:"w-3.5 h-3.5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin ml-1"})]})}),L&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mb-2 flex items-start gap-1.5",children:[s.jsx(Vr,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-red-700",children:L})]}),s.jsxs("div",{className:"space-y-0",children:[s.jsx(ut,{label:"",value:"L2"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.autoYn)||"-"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.buildingName)||"-"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.portNo)||"-"}),s.jsx(ut,{label:"ID",value:(g==null?void 0:g.equipId)||"-"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.modelNm)||"-"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.maxSpeed)||"-"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.manufacturer)||"-"}),s.jsx(ut,{label:"",value:(g==null?void 0:g.remarks)||"-"})]}),s.jsx("div",{className:"mt-2 flex justify-end",children:s.jsxs("button",{onClick:lt,className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-1 transition-colors",children:[s.jsx(yM,{className:"w-3 h-3"})," L2 "]})})]}),De&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("h5",{className:"text-xs sm:text-sm font-bold text-gray-900 flex items-center gap-1.5",children:[s.jsx(oE,{className:"w-4 h-4 text-orange-500"}),"(OLT)",P&&s.jsx(ea,{className:"w-3.5 h-3.5 text-green-500 ml-1"}),H&&s.jsx("div",{className:"w-3.5 h-3.5 border-2 border-orange-500 border-t-transparent rounded-full animate-spin ml-1"})]})}),L&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mb-2 flex items-start gap-1.5",children:[s.jsx(Vr,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs text-red-700",children:L})]}),s.jsxs("div",{className:"space-y-0",children:[s.jsx(ut,{label:"",value:"OLT"}),s.jsx(ut,{label:"",value:(P==null?void 0:P.OLT_MDL_NM)||"-"}),s.jsx(ut,{label:"",value:(P==null?void 0:P.OLT_PORT_NO)||"-"}),s.jsx(ut,{label:"",value:(P==null?void 0:P.ESTB_PLC_NM)||"-"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-3 sm:p-4",children:[s.jsxs("h5",{className:"text-xs sm:text-sm font-bold text-gray-900 mb-2 flex items-center gap-1.5",children:[s.jsx(aE,{className:"w-4 h-4 text-orange-500"}),"RN  "]}),G.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-1.5",children:"RN  "}),s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:I,onChange:Ee=>Fe(Ee.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg bg-white appearance-none pr-8 focus:border-orange-400 focus:outline-none",children:G.map(Ee=>s.jsxs("option",{value:Ee.EQIP_ID,children:[Ee.EQIP_ID," - ",Ee.MDL_NM||Ee.EQIP_NM||""]},Ee.EQIP_ID))}),s.jsx(ir,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),qe&&s.jsxs("div",{className:"mt-1.5 grid grid-cols-2 gap-x-4 gap-y-1",children:[s.jsx(ut,{label:"",value:qe.MDL_NM||"-"}),s.jsx(ut,{label:"",value:qe.EQIP_ESTB_FLOO_NM||"-"})]})]}),A.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-xs font-semibold text-gray-700 mb-1.5",children:["  (",A.length,")"]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsx("div",{className:"max-h-48 overflow-y-auto",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600 border-b",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-center font-semibold text-gray-600 border-b",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600 border-b",children:"ID"})]})}),s.jsx("tbody",{children:A.map((Ee,Ye)=>s.jsxs("tr",{onClick:()=>!n&&nt(Ye),className:`cursor-pointer transition-colors ${ee===Ye?"bg-orange-100 border-l-2 border-l-orange-500":Ee.PT_USE==="Y"?"bg-red-50/50":Ye%2===0?"bg-white":"bg-gray-50/50"} hover:bg-orange-50`,children:[s.jsx("td",{className:"px-2 py-1.5 font-mono border-b",children:Ee.PORT_NO||"-"}),s.jsx("td",{className:"px-2 py-1.5 text-center border-b",children:s.jsx("span",{className:`px-1.5 py-0.5 rounded text-[0.625rem] font-medium ${Ee.PT_USE==="Y"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:Ee.PT_USE==="Y"?"":""})}),s.jsx("td",{className:"px-2 py-1.5 font-mono text-gray-600 border-b",children:Ee.ENTR_NO||"-"})]},`${Ee.EQIP_ID}-${Ee.PORT_NO}-${Ye}`))})]})})})]}),K&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"inline-block w-5 h-5 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"   ..."})]})]})]}),!n&&s.jsx("button",{onClick:Mt,disabled:Ne||le,className:`w-full py-3 sm:py-4 rounded-xl font-semibold text-sm sm:text-base flex items-center justify-center gap-2 transition-colors ${le?"bg-green-500 text-white cursor-default":Ne?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600 text-white"}`,children:le?s.jsxs(s.Fragment,{children:[s.jsx(ea,{className:"w-4 h-4 sm:w-5 sm:h-5"})," "]}):Ne?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(aE,{className:"w-4 h-4 sm:w-5 sm:h-5"}),""]})}),c&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 sm:p-4 flex items-start gap-2",children:[s.jsx(Vr,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-xs sm:text-sm text-red-700",children:c})]}),le&&!n&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 sm:p-4",children:s.jsx("p",{className:"text-xs sm:text-sm text-green-700",children:" .       ."})}),q&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"LGU+ L2  "}),s.jsx("button",{onClick:()=>$(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(Mi,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"flex-1 overflow-auto p-3",children:_e?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})}):de.length===0?s.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:" ."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-xs",style:{minWidth:"400px"},children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-100",children:[s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""}),s.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:""})]})}),s.jsx("tbody",{children:de.map((Ee,Ye)=>s.jsxs("tr",{className:`border-b border-gray-50 ${Ye%2===0?"bg-white":"bg-gray-50"}`,children:[s.jsx("td",{className:"px-2 py-2 text-gray-900 whitespace-nowrap",children:Ee.COMMON_CD_NM||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:Ee.REF_CODE||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:Ee.REF_CODE2||"-"}),s.jsx("td",{className:"px-2 py-2 text-gray-700 whitespace-nowrap",children:Ee.REF_CODE3||"-"})]},Ye))})]})})}),s.jsx("div",{className:"p-3 border-t border-gray-200 flex justify-end",children:s.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium text-gray-700",children:""})})]})})]})},pR=({order:t,onBack:e,onComplete:n,showToast:r})=>{var P,F;const[i,a]=b.useState(!1),[o,c]=b.useState(!0),[u,h]=b.useState(!0),[m,_]=b.useState(!0),[p,g]=b.useState(""),C=t.WRK_CD||"",y=["01","03","05","07"].includes(C);b.useEffect(()=>{const G=t.PYM_MTHD||"",B=t.ATMT_YN||"";["01","05","07"].includes(C)&&G==="01"&&B==="Y"?(_(!1),g("/Email")):(_(!0),g(""))},[C,t]),b.useEffect(()=>{(async()=>{var I,E;const B=t.WRK_DRCTN_ID;if(!B){console.log("[PostProcess] WRK_DRCTN_ID ,    ");const A=t.SIGN_TYP||"",Y=t.CUST_CL||((I=t.customer)==null?void 0:I.CUST_CL)||"",ee=t.PDA_CLICK_YN||"";c(A==="NN"||Y==="H"||ee==="Y");return}try{console.log("[PostProcess] getAfterProcInfo :",B);const A=await wM(B);if(A)console.log("[PostProcess] getAfterProcInfo :",A),c(A.WRK_DRCTN_PRNT_YN!=="Y"),h(A.CLOSE_DANGER!=="Y"),A.AUTO_PAYMENTS_YN==="Y"&&(_(!1),g("/Email"));else{const Y=t.SIGN_TYP||"",ee=t.CUST_CL||((E=t.customer)==null?void 0:E.CUST_CL)||"",J=t.PDA_CLICK_YN||"";c(Y==="NN"||ee==="H"||J==="Y")}}catch(A){console.error("[PostProcess] getAfterProcInfo :",A)}})()},[t]);const S=()=>{r==null||r("     .","info")},v=()=>{r==null||r("AS     .","info")},k=()=>{if(o){r==null||r("  .","warning");return}r==null||r("()   ","info")},L=()=>{if(u){r==null||r("  .","warning");return}r==null||r("()   ","info")},M=()=>{if(m){r==null||r("  .","warning");return}r==null||r("   ","info")};return s.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-slate-600 to-slate-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:" "})}),s.jsxs("div",{className:"p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:((P=t.customer)==null?void 0:P.name)||t.CUST_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-sm font-medium text-gray-800",children:t.typeDisplay||t.WRK_CD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-gray-100",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("span",{className:"text-sm font-medium text-gray-800 text-right max-w-[60%] truncate",children:t.PROD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-start py-1.5",children:[s.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:""}),s.jsx("span",{className:"text-xs text-gray-700 text-right ml-2",children:((F=t.customer)==null?void 0:F.address)||t.ST_ADDR||"-"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:" "})}),s.jsx("div",{className:"p-4 space-y-3",children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("button",{type:"button",onClick:S,className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-50 hover:bg-blue-100 active:bg-blue-200 text-blue-700 rounded-lg font-semibold transition-all text-sm border border-blue-200",children:[s.jsx("span",{children:""}),s.jsx(og,{className:"w-3.5 h-3.5"})]}),s.jsxs("button",{type:"button",onClick:v,className:"flex items-center justify-center gap-2 px-4 py-3 bg-orange-50 hover:bg-orange-100 active:bg-orange-200 text-orange-700 rounded-lg font-semibold transition-all text-sm border border-orange-200",children:[s.jsx("span",{children:"AS"}),s.jsx(og,{className:"w-3.5 h-3.5"})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:""})}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("button",{type:"button",onClick:k,disabled:o,className:`w-full flex items-center justify-center gap-2 px-4 py-3.5 rounded-lg font-semibold transition-all text-sm ${o?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white shadow-sm"}`,children:[s.jsx("span",{children:" ()"}),!o&&s.jsx(og,{className:"w-3.5 h-3.5"})]}),s.jsxs("button",{type:"button",onClick:L,disabled:u,className:`w-full flex items-center justify-center gap-2 px-4 py-3.5 rounded-lg font-semibold transition-all text-sm ${u?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-500 hover:bg-green-600 active:bg-green-700 text-white shadow-sm"}`,children:[s.jsx("span",{children:" ()"}),!u&&s.jsx(og,{className:"w-3.5 h-3.5"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-cyan-600 to-cyan-700 px-4 py-3",children:s.jsx("h3",{className:"text-sm font-bold text-white",children:"/"})}),s.jsx("div",{className:"p-4",children:s.jsxs("button",{type:"button",onClick:M,disabled:m,className:`w-full flex items-center justify-center gap-2 px-4 py-3.5 rounded-lg font-semibold transition-all text-sm ${m?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-cyan-500 hover:bg-cyan-600 active:bg-cyan-700 text-white shadow-sm"}`,children:[s.jsx("span",{children:p}),!m&&s.jsx(og,{className:"w-3.5 h-3.5"})]})})]}),y&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsxs("button",{type:"button",onClick:()=>a(!i),className:"w-full flex items-center justify-between px-4 py-3.5 bg-amber-50 hover:bg-amber-100 transition-colors",children:[s.jsx("span",{className:"text-sm font-semibold text-amber-800",children:" "}),i?s.jsx(kr,{className:"w-5 h-5 text-amber-600"}):s.jsx(ir,{className:"w-5 h-5 text-amber-600"})]}),i&&s.jsx("div",{className:"p-4 bg-white border-t border-amber-100",children:s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"  ."})})]}),s.jsx("div",{className:"pt-2 pb-4",children:s.jsx("button",{type:"button",onClick:n,className:"w-full px-4 py-4 bg-gradient-to-r from-slate-700 to-slate-800 hover:from-slate-800 hover:to-slate-900 active:from-slate-900 active:to-black text-white rounded-xl font-bold text-base shadow-lg transition-all",children:""})})]})},nV=({prodCd:t,soId:e,isCertifyProdField:n})=>{const[r,i]=b.useState([]),[a,o]=b.useState(!1),[c,u]=b.useState([]),[h,m]=b.useState(!1),[_,p]=b.useState([]),[g,C]=b.useState(!1),y=a&&h&&g;b.useEffect(()=>{(async()=>{try{const M=(await qa("CMIF006")).map(P=>P.code||P.COMMON_CD);i(M),console.log("[useCertifyDetection] CMIF006 SO :",M.length,"")}catch(L){console.error("[useCertifyDetection] CMIF006  :",L)}o(!0)})()},[]),b.useEffect(()=>{(async()=>{try{const L=await N1();u(L),console.log("[useCertifyDetection] CertifyProdMap:",L.length,"")}catch(L){console.error("[useCertifyDetection] CertifyProdMap  :",L)}m(!0)})()},[]),b.useEffect(()=>{(async()=>{try{const M=(await qa("LGCT001")).map(P=>({code:P.code||P.COMMON_CD,opLnkdCd:P.ref_code8||""}));p(M),console.log("[useCertifyDetection] LGCT001 UPLS :",M.length,"")}catch(L){console.error("[useCertifyDetection] LGCT001  :",L)}C(!0)})()},[]);const S=b.useMemo(()=>{const k=_.find(M=>M.code===t),L=!!k;return console.log("[useCertifyDetection] PROD_CD:",t,"| SO_ID:",e,"| LGCT001:",k?k.opLnkdCd:"N/A","| result:",L),L},[t,e,_]),v=b.useMemo(()=>{const k=_.find(L=>L.code===t);return(k==null?void 0:k.opLnkdCd)||""},[t,_]);return{isCertifyProd:S,certifyOpLnkdCd:v,isLoaded:y,certifyProdList:c,certifySoList:r,uplsProdList:_}},rV=({workItem:t,onComplete:e,onBack:n,showToast:r})=>{var V;const i=t.WRK_STAT_CD==="3"||t.WRK_STAT_CD==="4"||t.WRK_STAT_CD==="7"||t.status==="";t.WRK_STAT_CD==="1"||t.WRK_STAT_CD;const{currentStep:a,setCurrentStep:o,setCurrentWorkId:c,equipmentData:u,setEquipmentData:h,filteringData:m,setFilteringData:_}=ta(),[p,g]=b.useState(null),{isCertifyProd:C,certifyOpLnkdCd:y,isLoaded:S}=nV({prodCd:t.PROD_CD||"",soId:t.SO_ID||"",isCertifyProdField:t.IS_CERTIFY_PROD});b.useEffect(()=>{c(t.id);const K=()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),document.documentElement.scrollTop=0,document.body.scrollTop=0};K(),requestAnimationFrame(()=>{K()}),setTimeout(()=>{K()},50)},[t.id,c]),b.useEffect(()=>{(async()=>{var j;if(!(t.WRK_CD!=="01"&&t.WRK_CD!=="02")&&!i)try{const te=await S1({WRK_ID:t.id,RCPT_ID:t.RCPT_ID,CUST_ID:((j=t.customer)==null?void 0:j.id)||t.CUST_ID});if(te){const ce=te.OST_WORKABLE_STAT||"";if(ce==="0"||ce==="1"||ce==="4"){const R=t.WRK_CD==="01"?"    .":"    .";r==null||r(R,"warning",!0)}}}catch(te){console.error("[WorkProcessFlow] OST   :",te)}})()},[t.id,t.WRK_CD,t.RCPT_ID,(V=t.customer)==null?void 0:V.id,t.CUST_ID,i,r]),b.useEffect(()=>{(async()=>{var te;const j=t.WRK_CD==="05"&&t.DTL_CTRT_ID||t.CTRT_ID;try{const ce=localStorage.getItem("userInfo"),R=ce?JSON.parse(ce):{};console.log("[WorkProcessFlow]   - WRK_CD:",t.WRK_CD,"CTRT_ID:",j||"()");const O=await Co({WRKR_ID:R.workerId||"A20130708",SO_ID:t.SO_ID||R.soId,WRK_ID:t.id,CUST_ID:((te=t.customer)==null?void 0:te.id)||t.CUST_ID,RCPT_ID:t.RCPT_ID||null,CTRT_ID:j||"",OLD_CTRT_ID:t.WRK_CD==="05"?t.CTRT_ID:null,CRR_ID:t.CRR_ID||null,ADDR_ORD:t.ADDR_ORD||null,CRR_TSK_CL:t.WRK_CD||"",WRK_DTL_TCD:t.WRK_DTL_TCD||"",WRK_CD:t.WRK_CD||null,WRK_STAT_CD:t.WRK_STAT_CD||null,WRK_DRCTN_ID:t.WRK_DRCTN_ID||t.directionId||null,BLD_ID:t.BLD_ID||null,PROD_CD:t.PROD_CD||null}),U={kpiProdGrpCd:O.kpiProdGrpCd,prodChgGb:O.prodChgGb,chgKpiProdGrpCd:O.chgKpiProdGrpCd,prodGrp:O.prodGrp,upCtrlCl:O.upCtrlCl,prodPromoInfo:O.prodPromoInfo||[]};if(g(O),_(U),["02","08","09"].includes(t.WRK_CD||"")||(h({installedEquipments:[],removedEquipments:[],prodPromoInfo:O.prodPromoInfo||[],...U}),console.log("[WorkProcessFlow]   - prodPromoInfo :",(O.prodPromoInfo||[]).length,"")),["02","08","09"].includes(t.WRK_CD||"")){const $=localStorage.getItem("userInfo"),de=$?JSON.parse($):{},ae=(O.removedEquipments||[]).map(_e=>{var ie;return{id:_e.EQT_NO,type:_e.ITEM_MID_NM,model:_e.EQT_CL_NM,serialNumber:_e.EQT_SERNO,itemMidCd:_e.ITEM_MID_CD,eqtClCd:_e.EQT_CL_CD||_e.EQT_CL,macAddress:_e.MAC_ADDRESS||_e.MAC_ADDR,CUST_ID:((ie=t.customer)==null?void 0:ie.id)||t.CUST_ID,CTRT_ID:t.CTRT_ID,EQT_NO:_e.EQT_NO,ITEM_CD:_e.ITEM_CD||"",EQT_SERNO:_e.EQT_SERNO,WRK_ID:t.id,WRK_CD:t.WRK_CD,EQT_CL:_e.EQT_CL||_e.EQT_CL_CD||"",EQT_CL_CD:_e.EQT_CL_CD||_e.EQT_CL||"",ITEM_MID_CD:_e.ITEM_MID_CD||"",SVC_CMPS_ID:_e.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:_e.BASIC_PROD_CMPS_ID||"",MST_SO_ID:_e.MST_SO_ID||t.SO_ID||de.soId,SO_ID:_e.SO_ID||t.SO_ID||de.soId,REG_UID:de.userId||de.workerId||"A20230019",EQT_LOSS_YN:"0",PART_LOSS_BRK_YN:"0",EQT_BRK_YN:"0",EQT_CABL_LOSS_YN:"0",EQT_CRDL_LOSS_YN:"0"}});h({installedEquipments:[],removedEquipments:ae,prodPromoInfo:O.prodPromoInfo||[],...U}),console.log("[WorkProcessFlow]    :",ae.length,", prodPromoInfo:",(O.prodPromoInfo||[]).length,"")}}catch(ce){console.error(" API Pre-loading :",ce)}})()},[t.id]);const v=()=>{var te,ce,R,O,U,Q;if(((te=u==null?void 0:u.installedEquipments)==null?void 0:te.length)>0||((ce=u==null?void 0:u.removedEquipments)==null?void 0:ce.length)>0)return console.log("[WorkProcessFlow] Store     - "),u;const K=`equipment_draft_${t.id}`,j=localStorage.getItem(K);if(j)try{const q=JSON.parse(j),$=q.installedEquipments&&q.installedEquipments.length>0,de=q.markedForRemoval&&q.markedForRemoval.length>0;if($||de){const ae=localStorage.getItem("userInfo"),_e=ae?JSON.parse(ae):{},ie=t.DTL_CTRT_ID||t.CTRT_ID,Ne=(q.markedForRemoval||[]).map(fe=>{var le,se;const Z=((le=q.removalStatus)==null?void 0:le[fe.id])||{};return{...fe,id:fe.id,type:fe.type,model:fe.model,serialNumber:fe.serialNumber,itemMidCd:fe.itemMidCd,EQT_NO:fe.id,EQT_SERNO:fe.serialNumber,ITEM_MID_CD:fe.itemMidCd,EQT_CL_CD:fe.eqtClCd,MAC_ADDRESS:fe.macAddress,WRK_ID:t.id,CUST_ID:((se=t.customer)==null?void 0:se.id)||t.CUST_ID,CTRT_ID:ie,WRK_CD:t.WRK_CD,CHG_YN:t.WRK_CD==="05"?"Y":void 0,SVC_CMPS_ID:fe.SVC_CMPS_ID||"",BASIC_PROD_CMPS_ID:fe.BASIC_PROD_CMPS_ID||"",MST_SO_ID:fe.MST_SO_ID||t.SO_ID||_e.soId,SO_ID:fe.SO_ID||t.SO_ID||_e.soId,REG_UID:_e.userId||_e.workerId||"A20230019",EQT_LOSS_YN:Z.EQT_LOSS_YN||"0",PART_LOSS_BRK_YN:Z.PART_LOSS_BRK_YN||"0",EQT_BRK_YN:Z.EQT_BRK_YN||"0",EQT_CABL_LOSS_YN:Z.EQT_CABL_LOSS_YN||"0",EQT_CRDL_LOSS_YN:Z.EQT_CRDL_LOSS_YN||"0"}}),X=(q.installedEquipments||[]).map(fe=>{const Z=fe.actualEquipment||{},le=fe.contractEquipment||{};return{actualEquipment:{...Z,id:Z.id,type:Z.type,model:Z.model,serialNumber:Z.serialNumber,itemMidCd:Z.itemMidCd,eqtClCd:Z.eqtClCd,macAddress:fe.macAddress||Z.macAddress,BASIC_PROD_CMPS_ID:Z.BASIC_PROD_CMPS_ID||le.BASIC_PROD_CMPS_ID||"",EQT_PROD_CMPS_ID:Z.EQT_PROD_CMPS_ID||le.SVC_CMPS_ID||le.id,PROD_CD:Z.PROD_CD||le.PROD_CD||t.PROD_CD,SVC_CD:Z.SVC_CD||le.SVC_CD||"",SVC_CMPS_ID:Z.SVC_CMPS_ID||le.SVC_CMPS_ID||le.id,EQT_SALE_AMT:Z.EQT_SALE_AMT||"0",MST_SO_ID:Z.MST_SO_ID||t.SO_ID||_e.soId,SO_ID:Z.SO_ID||t.SO_ID||_e.soId,OLD_LENT_YN:Z.OLD_LENT_YN||"N",LENT:Z.LENT||"10",ITLLMT_PRD:Z.ITLLMT_PRD||"00",EQT_USE_STAT_CD:Z.EQT_USE_STAT_CD||"1",EQT_CHG_GB:Z.EQT_CHG_GB||"1",IF_DTL_ID:Z.IF_DTL_ID||""},contractEquipment:{...le,id:le.id,SVC_CMPS_ID:le.SVC_CMPS_ID||le.id,BASIC_PROD_CMPS_ID:le.BASIC_PROD_CMPS_ID||"",PROD_CD:le.PROD_CD||"",SVC_CD:le.SVC_CD||""},macAddress:fe.macAddress||Z.macAddress}}),xe={installedEquipments:X,removedEquipments:Ne,kpiProdGrpCd:(m==null?void 0:m.kpiProdGrpCd)||q.kpiProdGrpCd,prodChgGb:(m==null?void 0:m.prodChgGb)||q.prodChgGb,chgKpiProdGrpCd:(m==null?void 0:m.chgKpiProdGrpCd)||q.chgKpiProdGrpCd,prodGrp:(m==null?void 0:m.prodGrp)||q.prodGrp,upCtrlCl:(m==null?void 0:m.upCtrlCl)||q.upCtrlCl};return console.log("[WorkProcessFlow] localStorage   :",{installed:xe.installedEquipments.length,removed:xe.removedEquipments.length,_PROD_CD:(O=(R=X[0])==null?void 0:R.actualEquipment)==null?void 0:O.PROD_CD,_SVC_CMPS_ID:(Q=(U=X[0])==null?void 0:U.actualEquipment)==null?void 0:Q.SVC_CMPS_ID}),xe}}catch(q){console.error("   :",q)}return null};O6(t.WRK_CD||"");const k=t.WRK_CD||"",L=C&&!i&&k!=="08"&&k!=="02",M=L?6:5,P=b.useMemo(()=>L?[{id:1,title:" ",completed:i||a>1},{id:2,title:" ",completed:i||a>2},{id:3,title:" ",completed:i||a>3},{id:4,title:" ",completed:i||a>4},{id:5,title:" ",completed:i||a>5},{id:6,title:"",completed:a>6}]:[{id:1,title:" ",completed:i||a>1},{id:2,title:" ",completed:i||a>2},{id:3,title:" ",completed:i||a>3},{id:4,title:" ",completed:i||a>4},{id:5,title:"",completed:a>5}],[L,i,a]);b.useEffect(()=>{a>M&&o(M)},[a,M]);const F=()=>{window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0},G=()=>{if(!C)return!0;const K=ki.getState().getWorkState(t.id),j=(K==null?void 0:K.installedEquipments)||[],te=(K==null?void 0:K.contractEquipments)||[];if(console.log("[FTTH ] :",te.length," | :",j.length,""),j.length===0)return r==null||r("  .","error"),!1;for(const ce of te)if(!j.some(O=>{var U;return((U=O.contractEquipment)==null?void 0:U.id)===ce.id})){const O=ce.type||ce.EQT_CL_NM||"ONT-PON";return r==null||r(` ${O}  .`,"error"),!1}return console.log("[FTTH ]  -   "),!0},B=K=>{if(!L)return!0;const j=Za.getState(),te=["N","NG"].includes(y);return K>=4&&te&&!j.ldapResult?(r==null||r("LDAP   .","warning"),!1):K>=5&&!j.certifyRegconfInfo?(r==null||r("  .","warning"),!1):!0},I=(K=!1)=>{var j,te,ce,R,O;if(a<M){const U=a+1;if(L&&U>=4&&(!G()||!B(U)))return;if(a===3&&!K){const Q=v();Q&&h(Q)}if(a===3){const Q=ki.getState().getWorkState(t.id),q=ae=>ae?ae.EQT_LOSS_YN==="Y"||ae.EQT_LOSS_YN==="1"||ae.PART_LOSS_BRK_YN==="Y"||ae.PART_LOSS_BRK_YN==="1"||ae.EQT_BRK_YN==="Y"||ae.EQT_BRK_YN==="1"||ae.EQT_CABL_LOSS_YN==="Y"||ae.EQT_CABL_LOSS_YN==="1"||ae.EQT_CRDL_LOSS_YN==="Y"||ae.EQT_CRDL_LOSS_YN==="1":!1,$=ae=>{if(!ae)return"";const _e=[];return(ae.EQT_LOSS_YN==="Y"||ae.EQT_LOSS_YN==="1")&&_e.push(""),(ae.PART_LOSS_BRK_YN==="Y"||ae.PART_LOSS_BRK_YN==="1")&&_e.push(""),(ae.EQT_BRK_YN==="Y"||ae.EQT_BRK_YN==="1")&&_e.push(""),(ae.EQT_CABL_LOSS_YN==="Y"||ae.EQT_CABL_LOSS_YN==="1")&&_e.push(""),(ae.EQT_CRDL_LOSS_YN==="Y"||ae.EQT_CRDL_LOSS_YN==="1")&&_e.push(""),_e.length>0?_e.join(", "):""};console.log(""),console.log(" [Step 34]    (workEquipmentStore)"),console.log(""),console.log("  (installedEquipments):",((j=Q==null?void 0:Q.installedEquipments)==null?void 0:j.length)||0,""),(te=Q==null?void 0:Q.installedEquipments)==null||te.forEach((ae,_e)=>{const ie=ae.actualEquipment||{},Ne=ae.contractEquipment||{};console.log(`  [${_e}] ${Ne.type||ie.type||""} | : ${ie.model||"-"} | S/N: ${ie.serialNumber||"-"}`)}),console.log(""),console.log("  (markedForRemoval):",((ce=Q==null?void 0:Q.markedForRemoval)==null?void 0:ce.length)||0,""),(R=Q==null?void 0:Q.markedForRemoval)==null||R.forEach((ae,_e)=>{var Z;const ie=ae.id||ae.EQT_NO,Ne=((Z=Q==null?void 0:Q.removalStatus)==null?void 0:Z[ie])||{},X=q(Ne),xe=$(Ne),fe=X?`  (${xe})`:" ";console.log(`  [${_e}] ${ae.type||ae.ITEM_MID_NM||""} | : ${ae.model||"-"} | S/N: ${ae.serialNumber||"-"}  ${fe}`)}),console.log(""),console.log("  (removeEquipments - API):",((O=Q==null?void 0:Q.removeEquipments)==null?void 0:O.length)||0,""),console.log(""),console.log(" removalStatus  :");const de=Object.keys((Q==null?void 0:Q.removalStatus)||{});de.length>0?de.forEach(ae=>{var Ne;const _e=(Ne=Q==null?void 0:Q.removalStatus)==null?void 0:Ne[ae],ie=q(_e);console.log(`  "${ae}"  ${ie?"":""}`,_e)}):console.log("  ( -  )"),console.log("")}o(Q=>Q+1),requestAnimationFrame(()=>F())}},E=()=>{a>1&&(o(K=>K-1),requestAnimationFrame(()=>F()))},A=K=>{var j,te,ce,R,O;if(!(L&&K>=4&&(!G()||!B(K)))){if(a===3&&K!==3){const U=v();if(U&&h(U),K>3){const Q=ki.getState().getWorkState(t.id),q=ae=>ae?ae.EQT_LOSS_YN==="Y"||ae.EQT_LOSS_YN==="1"||ae.PART_LOSS_BRK_YN==="Y"||ae.PART_LOSS_BRK_YN==="1"||ae.EQT_BRK_YN==="Y"||ae.EQT_BRK_YN==="1"||ae.EQT_CABL_LOSS_YN==="Y"||ae.EQT_CABL_LOSS_YN==="1"||ae.EQT_CRDL_LOSS_YN==="Y"||ae.EQT_CRDL_LOSS_YN==="1":!1,$=ae=>{if(!ae)return"";const _e=[];return(ae.EQT_LOSS_YN==="Y"||ae.EQT_LOSS_YN==="1")&&_e.push(""),(ae.PART_LOSS_BRK_YN==="Y"||ae.PART_LOSS_BRK_YN==="1")&&_e.push(""),(ae.EQT_BRK_YN==="Y"||ae.EQT_BRK_YN==="1")&&_e.push(""),(ae.EQT_CABL_LOSS_YN==="Y"||ae.EQT_CABL_LOSS_YN==="1")&&_e.push(""),(ae.EQT_CRDL_LOSS_YN==="Y"||ae.EQT_CRDL_LOSS_YN==="1")&&_e.push(""),_e.length>0?_e.join(", "):""};console.log(""),console.log(` [Step 3${K}]    (workEquipmentStore)`),console.log(""),console.log("  (installedEquipments):",((j=Q==null?void 0:Q.installedEquipments)==null?void 0:j.length)||0,""),(te=Q==null?void 0:Q.installedEquipments)==null||te.forEach((ae,_e)=>{const ie=ae.actualEquipment||{},Ne=ae.contractEquipment||{};console.log(`  [${_e}] ${Ne.type||ie.type||""} | : ${ie.model||"-"} | S/N: ${ie.serialNumber||"-"}`)}),console.log(""),console.log("  (markedForRemoval):",((ce=Q==null?void 0:Q.markedForRemoval)==null?void 0:ce.length)||0,""),(R=Q==null?void 0:Q.markedForRemoval)==null||R.forEach((ae,_e)=>{var Z;const ie=ae.id||ae.EQT_NO,Ne=((Z=Q==null?void 0:Q.removalStatus)==null?void 0:Z[ie])||{},X=q(Ne),xe=$(Ne),fe=X?`  (${xe})`:" ";console.log(`  [${_e}] ${ae.type||ae.ITEM_MID_NM||""} | : ${ae.model||"-"} | S/N: ${ae.serialNumber||"-"}  ${fe}`)}),console.log(""),console.log("  (removeEquipments - API):",((O=Q==null?void 0:Q.removeEquipments)==null?void 0:O.length)||0,""),console.log(""),console.log(" removalStatus  :");const de=Object.keys((Q==null?void 0:Q.removalStatus)||{});de.length>0?de.forEach(ae=>{var Ne;const _e=(Ne=Q==null?void 0:Q.removalStatus)==null?void 0:Ne[ae],ie=q(_e);console.log(`  "${ae}"  ${ie?"":""}`,_e)}):console.log("  ( -  )"),console.log("")}}o(K),requestAnimationFrame(()=>F())}},Y=K=>{h({...K,prodPromoInfo:K.prodPromoInfo||(u==null?void 0:u.prodPromoInfo)||[],kpiProdGrpCd:K.kpiProdGrpCd||(u==null?void 0:u.kpiProdGrpCd),prodChgGb:K.prodChgGb||(u==null?void 0:u.prodChgGb),chgKpiProdGrpCd:K.chgKpiProdGrpCd||(u==null?void 0:u.chgKpiProdGrpCd),prodGrp:K.prodGrp||(u==null?void 0:u.prodGrp),upCtrlCl:K.upCtrlCl||(u==null?void 0:u.upCtrlCl)}),I(!0)},ee=()=>{I()},J=()=>s.jsxs("div",{className:"flex items-center px-2 pt-3 sm:pt-4 pb-2 sm:pb-3 bg-white w-full",children:[s.jsx("button",{onClick:E,disabled:a<=1,className:`
          w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center rounded-full transition-all flex-shrink-0
          ${a<=1?"text-gray-300 cursor-not-allowed":"text-blue-600 hover:bg-blue-50 active:bg-blue-100"}
        `,style:{marginBottom:"18px"},children:s.jsx(H2,{className:"w-6 h-6 sm:w-7 sm:h-7",strokeWidth:2.5})}),s.jsx("div",{className:"flex items-center justify-between flex-1 mx-1",children:P.map((K,j)=>s.jsxs(Ji.Fragment,{children:[s.jsxs("div",{className:"flex flex-col items-center gap-0.5 sm:gap-1 cursor-pointer transition-all",onClick:()=>A(K.id),children:[s.jsx("div",{className:`
                  w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center font-bold text-xs sm:text-sm transition-all
                  ${a===K.id?"bg-blue-500 text-white shadow-lg scale-110":K.completed?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}
                `,children:K.completed?s.jsx(jc,{className:"w-4 h-4 sm:w-5 sm:h-5"}):K.id}),s.jsx("div",{className:`
                  text-[0.5625rem] sm:text-[0.625rem] font-medium text-center transition-all whitespace-nowrap
                  ${a===K.id?"text-blue-600 font-bold":K.completed?"text-green-600":"text-gray-500"}
                `,children:K.title})]}),j<P.length-1&&s.jsx("div",{className:`flex-1 h-0.5 mx-1 rounded-full ${K.completed?"bg-green-400":"bg-gray-200"}`,style:{marginBottom:"18px",maxWidth:"24px"}})]},K.id))}),s.jsx("button",{onClick:I,disabled:a>=M,className:`
          w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center rounded-full transition-all flex-shrink-0
          ${a>=M?"text-gray-300 cursor-not-allowed":"text-blue-600 hover:bg-blue-50 active:bg-blue-100"}
        `,style:{marginBottom:"18px"},children:s.jsx(Hw,{className:"w-6 h-6 sm:w-7 sm:h-7",strokeWidth:2.5})})]}),H=()=>{switch(a){case 1:return s.jsx(OY,{workItem:t,onNext:I,onBack:E});case 2:return s.jsx(PY,{workItem:t,onNext:I,onBack:E,showToast:r});case 3:return s.jsx(eV,{workItem:t,onSave:Y,onBack:E,showToast:r,preloadedApiData:p,onPreloadedDataUpdate:g,readOnly:i,isCertifyProd:C,certifyOpLnkdCd:y});case 4:return L?s.jsx(sV,{workItem:t,onNext:I,onBack:E,showToast:r,readOnly:i}):s.jsx(Fp,{order:t,onBack:E,onSuccess:ee,showToast:r,equipmentData:u||m,readOnly:i,isCertifyProd:C,onEquipmentRefreshNeeded:()=>{console.log("[WorkProcessFlow]   -   "),g(null)}});case 5:return L?s.jsx(Fp,{order:t,onBack:E,onSuccess:ee,showToast:r,equipmentData:u||m,readOnly:i,isCertifyProd:C,onEquipmentRefreshNeeded:()=>{console.log("[WorkProcessFlow]   -   "),g(null)}}):s.jsx(pR,{order:t,onBack:E,onComplete:e,showToast:r});case 6:return s.jsx(pR,{order:t,onBack:E,onComplete:e,showToast:r});default:return null}};return S?s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden",children:[s.jsxs("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 shadow-sm",children:[i&&s.jsx("div",{className:"bg-green-50 border-b border-green-200 px-3 sm:px-4 py-1.5 sm:py-2",children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 sm:gap-2",children:[s.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-green-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-[0.625rem] sm:text-xs font-medium text-green-800 whitespace-nowrap",children:"  ( )"})]})}),J()]}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:H()})]}):s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-gray-50",children:[s.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"   ..."})]})},iV=({message:t,type:e="info",onClose:n})=>{const r=()=>{switch(e){case"success":return s.jsx(ea,{className:"w-8 h-8 text-green-500"});case"error":return s.jsx(tc,{className:"w-8 h-8 text-red-500"});case"warning":return s.jsx(Vr,{className:"w-8 h-8 text-yellow-500"});default:return s.jsx(NM,{className:"w-8 h-8 text-blue-500"})}},i=()=>{switch(e){case"success":return"bg-green-500 hover:bg-green-600 active:bg-green-700";case"error":return"bg-red-500 hover:bg-red-600 active:bg-red-700";case"warning":return"bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700";default:return"bg-blue-500 hover:bg-blue-600 active:bg-blue-700"}},a=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";default:return""}};return s.jsxs("div",{className:"fixed inset-0 flex items-center justify-center",style:{zIndex:9999},children:[s.jsx("div",{className:"fixed inset-0 bg-black/40",onClick:n}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-[85vw] max-w-[320px] overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col items-center px-6 pt-6 pb-4",children:[r(),s.jsx("h3",{className:"mt-3 text-base font-bold text-gray-900",children:a()}),s.jsx("p",{className:"mt-2 text-sm text-gray-600 text-center leading-relaxed whitespace-pre-line",children:t})]}),s.jsx("div",{className:"px-6 pb-6",children:s.jsx("button",{onClick:n,className:`w-full py-3 text-sm font-semibold text-white rounded-xl transition-colors ${i()}`,children:""})})]})]})},aV=({isOpen:t,onClose:e,userName:n="",userId:r="",stats:i={todayInProgress:0,todayCompleted:0,weekTotal:0,monthTotal:0},onLogout:a,onNavigate:o})=>{const{fontScale:c,setFontScale:u,preferredNavApp:h,setPreferredNavApp:m}=co(),_=[{key:"small",label:"",size:"14px"},{key:"medium",label:"",size:"16px"},{key:"large",label:"",size:"18px"},{key:"xlarge",label:" ",size:"20px"}],p=[{key:"kakao",label:"",letter:"K",color:"bg-yellow-400 text-yellow-900"},{key:"tmap",label:"T",letter:"T",color:"bg-blue-500 text-white"},{key:"naver",label:"",letter:"N",color:"bg-green-500 text-white"}],g=()=>{a&&(a(),e())},C=y=>{o&&o(y),e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:e,"aria-hidden":"true",style:{zIndex:9998}}),s.jsx("div",{className:`fixed top-0 left-0 h-full w-80 bg-white shadow-2xl transform transition-transform duration-300 ease-out ${t?"translate-x-0":"-translate-x-full"}`,style:{touchAction:"pan-y",zIndex:9999},children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"bg-blue-600 p-6 relative",children:[s.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white hover:bg-white/20 rounded-full p-2 transition-colors","aria-label":"",children:s.jsx(Mi,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[s.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(o0,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"text-white",children:[s.jsx("p",{className:"text-xl font-bold",children:n}),s.jsx("p",{className:"text-sm text-white/90",children:r})]})]})]}),s.jsxs("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:" "}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-600",children:" "}),s.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.todayInProgress})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-xs text-gray-500",children:""}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.todayCompleted})]})]})]})}),s.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-600",children:" "}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.weekTotal})]})}),s.jsx("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-600",children:" "}),s.jsx("p",{className:"text-sm font-bold text-blue-600",children:i.monthTotal})]})})]})]}),s.jsxs("nav",{className:"flex-1 p-4 overflow-y-auto",children:[s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>C("today-work"),children:[s.jsx(nm,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:" "})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>C("work-management"),children:[s.jsx(C1,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>C("customer-management"),children:[s.jsx(SM,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>C("equipment-management"),children:[s.jsx(rm,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})}),s.jsx("li",{children:s.jsxs("button",{className:"w-full flex items-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 text-gray-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>C("other-management"),children:[s.jsx(bM,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm sm:text-base",children:""})]})})]}),s.jsxs("div",{className:"mt-4 px-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:_.map(y=>s.jsxs("button",{onClick:()=>u(y.key),className:`flex flex-col items-center py-2 rounded-lg border-2 transition-all ${c===y.key?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("span",{className:`font-bold ${c===y.key?"text-blue-600":"text-gray-700"}`,style:{fontSize:y.size},children:""}),s.jsx("span",{className:`text-[0.625rem] mt-0.5 ${c===y.key?"text-blue-600 font-semibold":"text-gray-500"}`,children:y.label})]},y.key))})]}),s.jsxs("div",{className:"mt-4 px-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 mb-2",children:" "}),s.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:p.map(y=>s.jsxs("button",{onClick:()=>m(y.key),className:`flex flex-col items-center py-2 rounded-lg border-2 transition-all ${h===y.key?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold ${y.color}`,children:y.letter}),s.jsx("span",{className:`text-[0.625rem] mt-1 ${h===y.key?"text-blue-600 font-semibold":"text-gray-500"}`,children:y.label})]},y.key))})]})]}),s.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200",children:s.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 sm:gap-3 px-3 sm:px-4 py-2.5 sm:py-3 bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors font-medium text-sm sm:text-base",children:[s.jsx(AL,{className:"w-5 h-5"}),s.jsx("span",{children:""})]})})]})})]})};class lV extends b.Component{constructor(e){super(e),this.handleReload=()=>{window.location.reload()},this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n),this.setState({error:e,errorInfo:n}),console.error("Production Error:",{error:e.toString(),componentStack:n.componentStack})}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg p-8",children:[s.jsx("div",{className:"flex items-center justify-center mb-6",children:s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:" "}),s.jsx("p",{className:"text-gray-600",children:"  .      ."})]}),!1,s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("button",{onClick:this.handleReload,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})," "]}),!1]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center text-sm text-gray-500",children:"   ."})]})}):this.props.children}}const oV="/api",cV=(t,e)=>{const n=t.replace(/[-\s]/g,"");if(!n)return" .";if(n.length<9)return"  .";let r="",i="";if(n.slice(-4),n.startsWith("02")?(r=n.substring(0,2),i=n.substring(2,n.length-4)):n.startsWith("0130")?(r=n.substring(0,4),i=n.substring(4,n.length-4)):(r=n.substring(0,3),i=n.substring(3,n.length-4)),i.length<3||i==="111"||i==="1111")return"  .";if(r==="010"&&i.length<4)return"  .";if(e==="hp"&&!["010","011","016","017","018","019"].includes(r))return"  .";if(r!=="0130"&&i.startsWith("0"))return"  .";let a=0;for(let o=0;o<n.length-1;o++)if(n[o]===n[o+1]){if(a++,a>=6)return"  ."}else a=0;return null},dV=t=>{const e=t.replace(/[^0-9]/g,"");let n="",r="";const i=e.slice(-4);return e.startsWith("02")?(n=e.substring(0,2),r=e.substring(2,e.length-4)):e.startsWith("0130")?(n=e.substring(0,4),r=e.substring(4,e.length-4)):(n=e.substring(0,3),r=e.substring(3,e.length-4)),{ddd:n,fix:r,dtl:i}},bn=async(t,e={},n="POST")=>{try{const r=`${oV}${t}`,i=await fetch(r,{method:n,headers:{"Content-Type":"application/json"},credentials:"include",body:n==="POST"?JSON.stringify(e):void 0});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const a=await i.json();return Array.isArray(a)?{success:!0,data:a}:a.code==="SUCCESS"||a.resultCode==="0000"||a.success?{success:!0,data:a.data||a.resultData||a,totalCount:a.totalCount||a.resultCount}:{success:!1,message:a.message||a.resultMsg||"  .",errorCode:a.code||a.resultCode||a.errorCode}}catch(r){return console.error("[CustomerAPI] Error:",r),{success:!1,message:r instanceof Error?r.message:"  ."}}},X1=()=>{try{const t=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(t){const e=JSON.parse(t);return e.userId||e.USR_ID||e.LOGIN_ID||"SYSTEM"}}catch{console.log("[CustomerAPI] Failed to get LOGIN_ID from session")}return"SYSTEM"},Eh=t=>{const e=()=>{if(t.ADDR_DTL)return t.ADDR_DTL;if(t.ADDR_FULL){const c=t.ADDR_FULL,u=t.ADDRESS||t.ADDR||"";return u&&c.startsWith(u+" "+u)?c.substring(u.length+1):c}const a=[],o=t.ADDRESS||t.ADDR||"";return o&&a.push(o),t.BUN_NO&&a.push(`${t.BUN_NO}`),t.HO_NM&&a.push(`${t.HO_NM}`),t.BLD_NM&&a.push(t.BLD_NM),a.join(" ")||""},n=()=>{const a=[],o=t.TEL_NO||t.TEL_NO1||"";o&&a.push({type:"tel",typeNm:"",number:o,fieldName:"TEL_NO"});const c=t.HP_NO||t.TEL_NO2||"";c&&a.push({type:"hp",typeNm:"",number:c,fieldName:"HP_NO"});for(let u=3;u<=9;u++){const h=`TEL_NO${u}`,m=t[h];if(m){const _=m.startsWith("010")||m.startsWith("011")||m.startsWith("016")||m.startsWith("017")||m.startsWith("018")||m.startsWith("019");a.push({type:_?"hp":"tel",typeNm:_?`${u-1}`:`${u-1}`,number:m,fieldName:h})}}return a},r=e(),i=n();return{CUST_ID:t.CUST_ID||"",CUST_NM:t.CUST_NM||"",TEL_NO:t.TEL_NO||t.TEL_NO1||"",HP_NO:t.HP_NO||t.TEL_NO2||"",PHONE_LIST:i.length>0?i:void 0,CUST_ADDR:r||t.CUST_ADDR||t.ADDR||t.ADDRESS||"",ROAD_ADDR:t.ROAD_ADDR||r||"",INST_ADDR:t.INST_ADDR||r||"",BILL_ADDR:t.BILL_ADDR||"",UNPAY_AMT:t.UNPAY_AMT||0,CUST_TP_CD:t.CUST_TP_CD||t.CUST_TP||"",CUST_TP_NM:t.CUST_TP_NM||t.CUST_CL_NM||"",GRP_NO:t.GRP_NO||t.GRP_ID||"",GRP_NM:t.GRP_NM||"",REG_DT:t.REG_DT||"",CTRT_ID:t.CTRT_ID||""}},uV=t=>{const e=r=>r==null||r==="None"||r==="null"?"":r,n=r=>r==null||r==="None"||r==="null"?0:r;return{CTRT_ID:e(t.CTRT_ID),CTRT_STAT_CD:e(t.CTRT_STAT_CD)||e(t.CTRT_STAT),CTRT_STAT_NM:e(t.CTRT_STAT_NM),PROD_NM:e(t.PROD_NM)||e(t.BASIC_PROD_CD_NM),PROD_GRP_NM:e(t.PROD_GRP_NM),INST_ADDR:e(t.INST_ADDR)||e(t.ADDR_FULL)||e(t.ADDR),INSTL_LOC:e(t.INSTL_LOC),POST_ID:e(t.POST_ID),OPNG_DT:e(t.OPNG_DT)||e(t.OPEN_DD),TERM_DT:e(t.TERM_DT),AGMT_MON:e(t.AGMT_MON)||(t.PROM_CNT!=null&&t.PROM_CNT!=="None"?String(t.PROM_CNT):""),AGMT_ST_DT:e(t.AGMT_ST_DT)||e(t.RATE_STRT_DT),AGMT_END_DT:e(t.AGMT_END_DT)||e(t.RATE_END_DT),GRP_NO:e(t.GRP_NO)||e(t.GRP_ID),GRP_NM:e(t.GRP_NM),PYM_ACNT_ID:e(t.PYM_ACNT_ID),DPST_AMT:n(t.DPST_AMT)||n(t.ASSR_BAL),PREPAY_AMT:n(t.PREPAY_AMT)||n(t.PREPD_BAL),EQT_NM:e(t.EQT_NM),EQT_MDL_NM:e(t.EQT_MDL_NM)||e(t.VIEW_MOD_NM),EQT_SERNO:e(t.EQT_SERNO)||e(t.SERNO_DTOA),PREV_MON_AMT:n(t.PREV_MON_AMT)||n(t.BILL_AMT_BEFORE),CUR_MON_AMT:n(t.CUR_MON_AMT)||n(t.BILL_AMT_NOW),SO_NM:e(t.SO_NM),SO_ID:e(t.SO_ID),PROD_GRP:e(t.PROD_GRP),STREET_ADDR_FULL:e(t.STREET_ADDR_FULL)||e(t.ROAD_ADDR),ADDR_FULL:e(t.ADDR_FULL)||e(t.JIBUN_ADDR),CTRT_APLY_STRT_DT:e(t.CTRT_APLY_STRT_DT),CTRT_APLY_END_DT:e(t.CTRT_APLY_END_DT),NOTRECEV:e(t.NOTRECEV)||e(t.NOT_RECV),CLOSE_DANGER:e(t.CLOSE_DANGER),ADDR_DTL:e(t.ADDR_DTL),BLD_CL:e(t.BLD_CL)||"0",BLD_NM:e(t.BLD_NM),BLD_ID:e(t.BLD_ID),BUN_CL:e(t.BUN_CL),BUN_NO:e(t.BUN_NO),HO_NM:e(t.HO_NM),APT_DONG_NO:e(t.APT_DONG_NO),APT_HO_CNT:e(t.APT_HO_CNT),STREET_ID:e(t.STREET_ID)}},hV=async t=>{let e="SYSTEM";try{const n=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(n){const r=JSON.parse(n);e=r.userId||r.USR_ID||r.LOGIN_ID||"SYSTEM"}}catch{console.log("[CustomerAPI] Failed to get LOGIN_ID from session")}if(t.searchType==="CUSTOMER_ID"&&t.customerId){const n={CUST_ID:t.customerId,SERCH_GB:"3",LOGIN_ID:e},r=await bn("/customer/common/customercommon/getConditionalCustList2",n);if(r.success&&r.data){const a=(Array.isArray(r.data)?r.data:[r.data]).map(Eh);return{...r,data:a}}return{...r,data:[]}}if(t.searchType==="CONTRACT_ID"&&t.contractId){let n="";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const a=JSON.parse(i),o=a.authSoList||a.AUTH_SO_List||[];o.length>0&&(n=o[0].SO_ID||o[0].soId||""),n||(n=a.soId||a.SO_ID||"")}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session")}if(n)try{console.log("[CustomerAPI] Trying getCtrtIDforSmartPhone for CONTRACT_ID: "+t.contractId);const i=await bn("/customer/phoneNumber/getCtrtIDforSmartPhone",{SO_ID:n,CTRT_ID:t.contractId});if(i.success&&i.data){const a=Array.isArray(i.data)?i.data:[i.data];if(a.length>0){console.log("[CustomerAPI] getCtrtIDforSmartPhone success for CONTRACT_ID");const o=a.map(Eh);return{...i,data:o}}}console.log("[CustomerAPI] getCtrtIDforSmartPhone returned no data for CONTRACT_ID, trying fallback...")}catch(i){console.log("[CustomerAPI] getCtrtIDforSmartPhone failed for CONTRACT_ID, trying fallback...",i)}const r=await bn("/customer/negociation/getCustomerCtrtInfo",{CTRT_ID:t.contractId});if(r.success&&r.data){const i=Array.isArray(r.data)?r.data[0]:r.data,a=i==null?void 0:i.CUST_ID;if(a){const o=await bn("/customer/common/customercommon/getConditionalCustList2",{CUST_ID:a,SERCH_GB:"3",LOGIN_ID:e});if(o.success&&o.data){const u=(Array.isArray(o.data)?o.data:[o.data]).map(Eh);return{...o,data:u}}}}return{success:!1,message:"ID    .",data:[]}}if(t.searchType==="PHONE_NAME"){if(!t.phoneNumber&&!t.customerName)return{success:!1,message:"   .",data:[]};let n="";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const a=JSON.parse(i),o=a.authSoList||a.AUTH_SO_List||[];o.length>0&&(n=o[0].SO_ID||o[0].soId||""),n||(n=a.soId||a.SO_ID||"")}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session")}if(n)try{const i={SO_ID:n};t.phoneNumber&&(i.TEL_NO=t.phoneNumber),t.customerName&&(i.CUST_NM=t.customerName);const a=await bn("/customer/phoneNumber/getCtrtIDforSmartPhone",i);if(a.success&&a.data){const o=Array.isArray(a.data)?a.data:[a.data];if(o.length>0){console.log("[CustomerAPI] getCtrtIDforSmartPhone success:",o.length,"results");const c=o.map(Eh);return{...a,data:c}}}console.log("[CustomerAPI] getCtrtIDforSmartPhone returned no data, trying fallback...")}catch(i){console.log("[CustomerAPI] getCtrtIDforSmartPhone failed, trying fallback...",i)}const r={SERCH_GB:"3",LOGIN_ID:e};t.phoneNumber&&(r.TEL_NO=t.phoneNumber),t.customerName&&(r.CUST_NM=t.customerName);try{const i=await bn("/customer/common/customercommon/getConditionalCustList2",r);if(i.success&&i.data){const o=(Array.isArray(i.data)?i.data:[i.data]).map(Eh);return{...i,data:o}}return{...i,data:[]}}catch{return{success:!1,message:"   . ID .",data:[]}}}if(t.searchType==="EQUIPMENT_NO"&&t.equipmentNo){const n={SERCH_GB:"3",LOGIN_ID:e,EQT_SERNO:t.equipmentNo,MAC_ADDR:""};try{const r=await bn("/customer/common/customercommon/getConditionalCustList2",n);if(r.success&&r.data){const a=(Array.isArray(r.data)?r.data:[r.data]).map(Eh);return{...r,data:a}}return{...r,data:[]}}catch{return{success:!1,message:"   . ID .",data:[]}}}return{success:!1,message:"  .",data:[]}},fV=async t=>{let e="SYSTEM";try{const r=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(r){const i=JSON.parse(r);e=i.userId||i.USR_ID||i.LOGIN_ID||"SYSTEM"}}catch{console.log("[CustomerAPI] Failed to get session info")}const n={SERCH_GB:"3",LOGIN_ID:e};t.custId&&(n.CUST_ID=t.custId),t.contractId&&(n.CTRT_ID=t.contractId),t.phoneNumber&&(n.TEL_NO=t.phoneNumber),t.equipmentNo&&(n.EQT_SERNO=t.equipmentNo),t.customerName&&!t.custId&&!t.contractId&&!t.phoneNumber&&!t.equipmentNo&&(n.CUST_NM=t.customerName);try{const r=await bn("/customer/common/customercommon/getConditionalCustList2",n);if(r.success&&r.data){const a=(Array.isArray(r.data)?r.data:[r.data]).map(Eh);return{...r,data:a}}return{...r,data:[]}}catch(r){return console.error("[CustomerAPI] searchCustomerAll :",r),{success:!1,message:"   .",data:[]}}},J1=async t=>{const e=await bn("/customer/negociation/getCustCtrtAll",{CUST_ID:t});if(e.success&&e.data){const r=(Array.isArray(e.data)?e.data:[e.data]).map(uV);return{...e,data:r}}return e},hS=async t=>{const e=X1(),n=await bn("/customer/negociation/getCustAccountInfo_m",{CUST_ID:t,LOGIN_ID:e});return n.success&&n.data?{success:!0,data:n.data.filter(i=>i.PYM_ACNT_ID&&/^\d{10}$/.test(i.PYM_ACNT_ID)).map(i=>({PYM_ACNT_ID:i.PYM_ACNT_ID,PYM_MTHD_NM:i.PYM_MTHD_NM||"",BANK_CARD_NM:i.BANK_CARD_NM||null,BANK_CARD_NO:i.BANK_CARD_NO||null,BILL_MTHD:i.BILL_MTHD||"",UPYM_AMT_ACNT:i.UPYM_AMT??i.UPYM_AMT_ACNT??0,SO_ID:i.SO_ID||void 0})),code:"SUCCESS",message:"OK"}:n},yR=async(t,e)=>{const n=X1(),r={CUST_ID:t,LOGIN_ID:n};return e&&(r.PYM_ACNT_ID=e),bn("/customer/negociation/getCustBillInfo_m",r)},mV=async t=>bn("/customer/negociation/getHPPayList",{CUST_ID:t}),gV=async t=>bn("/customer/negociation/saveHPPayInfo",t),m1=async(t,e,n=10)=>{const r=X1(),i={CUST_ID:t,PAGE_SIZE:n,LOGIN_ID:r};return e&&(i.CTRT_ID=e),bn("/customer/negociation/getTgtCtrtRcptHist_m",i)},g1=async(t,e,n=10)=>{const r=X1(),i={CUST_ID:t,PAGE_SIZE:n,LOGIN_ID:r};return e&&(i.CTRT_ID=e),bn("/customer/negociation/getTgtCtrtWorkList_m",i)},_V=async t=>{let e=t.CHG_UID||"SYSTEM";try{const n=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(n){const r=JSON.parse(n);e=r.userId||r.USR_ID||e}}catch{console.log("[CustomerAPI] Failed to get CHG_UID from session")}return bn("/customer/negociation/updateCustTelDetailInfo",{...t,CHG_UID:e,TEL_NO_TP:t.TEL_NO_TP||"2",USE_YN:t.USE_YN||"Y",MAIN_TEL_YN:t.MAIN_TEL_YN||"N",CUST_REL:t.CUST_REL||""})},bR=async t=>{let e=t.CHG_UID||"SYSTEM";try{const n=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(n){const r=JSON.parse(n);e=r.userId||r.USR_ID||e}}catch{console.log("[CustomerAPI] Failed to get CHG_UID from session")}return bn("/customer/etc/saveMargeAddrOrdInfo",{CTRT_ID:t.CTRT_ID,POST_ID:t.POST_ID,BLD_ID:t.BLD_ID||"",BUN_NO:t.BUN_NO||"",HO_NM:t.HO_NM||"",BLD_CL:t.BLD_CL||"0",BLD_NM:t.BLD_NM||"",APT_DONG_NO:t.APT_DONG_NO||"",APT_HO_CNT:t.APT_HO_CNT||"",ADDR_DTL:t.ADDR_DTL||"",STREET_ID:(t.STREET_ID||"").substring(0,10),INSTL_LOC:t.INSTL_LOC||"",CUST_FLAG:t.CUST_FLAG||"0",PYM_FLAG:t.PYM_FLAG||"0",CHG_UID:e})},L4=async t=>{let e=t.USR_ID||"MOBILE_USER",n=t.SO_ID||"",r=t.MST_SO_ID||"";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const a=JSON.parse(i);if(e=a.userId||a.USR_ID||e,!n){const o=a.authSoList||a.AUTH_SO_List||[];o.length>0&&(n=o[0].SO_ID||o[0].soId||""),n||(n=a.soId||a.SO_ID||"")}r||(r=a.mstSoId||a.MST_SO_ID||n)}}catch{console.log("[CustomerAPI] Failed to get session info for payment change")}return bn("/customer/customer/general/customerPymChgAddManager",{...t,USR_ID:e,SO_ID:n,MST_SO_ID:r})},xV=async t=>{let e=t.SO_ID||"",n=t.MST_SO_ID||"",r="";try{const i=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(i){const a=JSON.parse(i);if(r=a.userId||a.USR_ID||a.usrId||"",!e){const o=a.authSoList||a.AUTH_SO_List||[];o.length>0&&(e=o[0].SO_ID||o[0].soId||"",n||(n=o[0].MST_SO_ID||"")),e||(e=a.soId||a.SO_ID||"")}n||(n=a.mstSoId||a.MST_SO_ID||e)}}catch{console.log("[CustomerAPI] Failed to get session info for bank verify")}try{const i=await bn("/customer/payment/verifyBankAccount",{CHECK_TYPE:"E",CUST_NM:t.ACNT_OWNER_NM,CUST_TP:t.CUST_TP||"A",RSDT_CRRNO:t.RSDT_CRRNO||"",CARD_ACNT_CD:t.BANK_CD,CARD_ACNT_NO:t.ACNT_NO,SO_ID:e,MST_SO_ID:n,ID_TYPE_CD:t.ID_TYPE_CD||"01",CUST_ID:t.CUST_ID||"",PYM_ACNT_ID:t.PYM_ACNT_ID||"",USR_ID:r});if(i.success&&i.data){const a=i.data,o=a.RSPN_CD||a.RES_MSG_CD||"";if(o==="0000"||a.success==="true"||a.RESP_CD==="0000")return{success:!0,data:{verified:!0,...a},message:a.RES_MSG||"  ."};if(o||a.success==="false")return{success:!1,data:a,message:a.RES_MSG||a.MESSAGE||a.RESP_MSG||"  . ("+o+")"}}return i.success?{success:!0,data:{verified:!0},message:"  ."}:{success:!1,message:i.message||"  ."}}catch(i){return console.error("[BankVerify] Error:",i),{success:!1,message:(i==null?void 0:i.message)||"    ."}}},pV=async t=>{try{const e=await bn("/customer/payment/verifyCreditCard",{SO_ID:t.SO_ID||"",PYM_ACNT_ID:t.PYM_ACNT_ID||"",CUST_ID:t.CUST_ID||"",CUST_NM:t.CUST_NM||t.CARD_OWNER_NM||"",CARD_NO:t.CARD_NO,CARD_EXPYEAR:t.CARD_EXPYEAR||(t.CARD_VALID_YM?t.CARD_VALID_YM.substring(0,2):""),CARD_EXPMON:t.CARD_EXPMON||(t.CARD_VALID_YM?t.CARD_VALID_YM.substring(2,4):""),KOR_ID:t.KOR_ID||""});if(e.success&&e.data){const n=e.data;return n.success==="true"||n.RESP_CD==="0000"?{success:!0,data:{verified:!0,RESP_CD:n.RESP_CD},message:"  ."}:{success:!1,data:n,message:n.RESP_MSG||"  ."}}return{success:!1,message:e.message||"  ."}}catch(e){return console.error("[CardVerify] Error:",e),{success:!1,message:(e==null?void 0:e.message)||"    ."}}},yV=async t=>{var e;return console.warn("[CustomerAPI] savePaymentSignature stub called:",{CUST_ID:t.CUST_ID,PYM_ACNT_ID:t.PYM_ACNT_ID,SIGN_TYPE:t.SIGN_TYPE,DATA_SIZE:((e=t.SIGNATURE_DATA)==null?void 0:e.length)||0}),Promise.resolve({success:!0,data:{saved:!1,stub:!0},message:"  API  (stub)"})},P4=async t=>{let e=t.SO_ID||"",n=t.MST_SO_ID||"",r="",i="";try{const u=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(u){const h=JSON.parse(u);if(r=h.userId||h.USR_ID||h.usrId||"",i=h.crrId||h.CRR_ID||"",!e){const m=h.authSoList||h.AUTH_SO_List||[];m.length>0&&(e=m[0].SO_ID||m[0].soId||""),e||(e=h.soId||h.SO_ID||"")}n||(n=h.mstSoId||h.MST_SO_ID||e)}}catch{console.log("[CustomerAPI] Failed to get user info from session/localStorage")}const a=t.CNSL_MST_CL||"";let o=t.CNSL_MID_CL||"",c=t.CNSL_SLV_CL||"";if(o.startsWith(a)&&o.length>a.length&&(o=o.substring(a.length)),c.startsWith(o.length>0?a+o:"")&&c.length>4)c=c.substring((a+o).length);else if(c.length>4){const u=t.CNSL_MID_CL||"";c.startsWith(u)&&c.length>u.length?c=c.substring(u.length):c=c.substring(c.length-3)}return bn("/customer/negociation/saveCnslRcptInfo",{...t,CNSL_MST_CL:a,CNSL_MID_CL:o,CNSL_SLV_CL:c,SO_ID:e,MST_SO_ID:n,USR_ID:r,CRR_ID:i,CALLER_UID:r,CNSL_RSLT:t.CNSL_RSLT||"5",RCPT_TP:"G1",CUST_REL:"A",PRESS_RCPT_YN:"N",SUBS_TP:"1",CTI_CID:"0"})},bV=async t=>{let e="MOBILE_USER",n="",r="",i="";try{const u=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(u){const h=JSON.parse(u);e=h.userId||h.USR_ID||e,n=h.crrId||h.CRR_ID||"";const m=h.authSoList||h.AUTH_SO_List||[];m.length>0&&(r=m[0].SO_ID||m[0].soId||""),r||(r=h.soId||h.SO_ID||""),i=h.mstSoId||h.MST_SO_ID||r}}catch{console.log("[CustomerAPI] Failed to get user info from session")}const a=t,o="AS_CL_CD"in t,c={PG_GUBUN:o&&a.PG_GUBUN||"1",POST_ID:t.POST_ID||"",CUST_ID:t.CUST_ID,CTRT_ID:t.CTRT_ID||"",WRK_HOPE_DTTM:o?a.SCHD_DT+a.SCHD_TM:t.WRK_HOPE_DTTM,HOPE_DTTM:o?a.SCHD_DT+a.SCHD_TM:t.HOPE_DTTM||t.WRK_HOPE_DTTM,WRK_DTL_TCD:o?a.AS_CL_CD:t.WRK_DTL_TCD,WRK_RCPT_CL:o?a.AS_RESN_L_CD:t.WRK_RCPT_CL,WRK_RCPT_CL_DTL:o?a.AS_RESN_M_CD||"":t.WRK_RCPT_CL_DTL,MEMO:o?a.AS_CNTN:t.MEMO,EMRG_YN:"N",HOLY_YN:"N",TRANS_PROC_YN:"Y",CRR_ID:n,WRKR_ID:e,REG_UID:e,SO_ID:o&&a.SO_ID||r,MST_SO_ID:o&&a.MST_SO_ID||i,BLD_CL:o?a.BLD_CL||"":t.BLD_CL||"",BLD_NM:o?a.BLD_NM||"":t.BLD_NM||"",BLD_ID:o?a.BLD_ID||"":t.BLD_ID||"",BUN_CL:o?a.BUN_CL||"":t.BUN_CL||"",BUN_NO:o?a.BUN_NO||"":t.BUN_NO||"",HO_NM:o?a.HO_NM||"":t.HO_NM||"",APT_DONG_NO:o?a.APT_DONG_NO||"":t.APT_DONG_NO||"",APT_HO_CNT:o?a.APT_HO_CNT||"":t.APT_HO_CNT||"",ADDR_DTL:o?a.ADDR_DTL||"":t.ADDR_DTL||"",ADDR:o?a.ADDR||"":t.ADDR||"",ADDR_ORD:o?a.ADDR_ORD||"1":t.ADDR_ORD||"1",CNSL_RSLT:"3"};return o&&a.AS_CL_DTL_CD&&(c.AS_BIZ_CL=a.AS_CL_DTL_CD),o&&a.TRIP_FEE_CD&&(c.BIZ_EXPNS_GUIDE=a.TRIP_FEE_CD),bn("/customer/work/modAsPdaReceipt",c)},CV=async t=>bn("/customer/customer/general/customerManager",{...t,ACTION:"INSERT"}),NV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCS010"}),SV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCS020"}),vV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCS030"}),EV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMWT001"}),DV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMAS000"}),RV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMAS001"}),TV=async t=>bn("/customer/work/getProd_Grp",{CTRT_ID:t}),MV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CUST_TP"}),IV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCU052"}),jV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"BLPY015"}),OV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"BLPY016"}),wV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCU005"}),LV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCU002"}),PV=async t=>{if(t.SO_ID){const o={SO_ID:t.SO_ID,MST_SO_ID:"200",USE_FLAG:t.USE_FLAG||"Y"};return t.DONGMYONG&&(o.DONGMYONG=t.DONGMYONG),bn("/statistics/customer/getPostList",o)}let e=[];try{const o=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(o){const c=JSON.parse(o),u=c.authSoList||c.AUTH_SO_List||[];if(u.length>0&&(e=u.map(h=>({soId:h.SO_ID||h.soId||"",mstSoId:h.MST_SO_ID||h.mstSoId||""})).filter(h=>h.soId)),e.length===0){const h=c.soId||c.SO_ID||"",m=c.mstSoId||c.MST_SO_ID||"";h&&(e=[{soId:h,mstSoId:m}])}}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session for address search")}if(e.length===0)return console.log("[CustomerAPI] searchPostAddress: SO_ID   "),{success:!1,data:[],message:"SO_ID   ."};const n=e.map(o=>{const c={SO_ID:o.soId,MST_SO_ID:o.mstSoId||"200",USE_FLAG:t.USE_FLAG||"Y"};return t.DONGMYONG&&(c.DONGMYONG=t.DONGMYONG),bn("/statistics/customer/getPostList",c).catch(u=>(console.log(`[CustomerAPI] searchPostAddress SO_ID=${o.soId} :`,u),{success:!1,data:[],message:""}))}),r=await Promise.all(n),i=new Set,a=[];for(const o of r)if(o.success&&o.data)for(const c of o.data){const u=c.POST_ID||`${c.SO_ID}_${c.DONGMYON_NM}_${c.ADDR}`;i.has(u)||(i.add(u),a.push(c))}return{success:!0,data:a,message:""}},AV=async t=>{const e={};t.STREET_NM&&(e.STREET_NM=t.STREET_NM),t.STREET_BUN_M&&(e.STREET_BUN_M=t.STREET_BUN_M),t.STREET_BUN_S&&(e.STREET_BUN_S=t.STREET_BUN_S),t.SO_ID&&(e.SO_ID=t.SO_ID);const n=await bn("/customer/common/customercommon/getStreetAddrList",e);return n.success&&n.data?{success:!0,data:n.data,message:""}:{success:!1,data:[],message:n.message||"  "}},aC=t=>{if(!t)return"";const e=t.replace(/\D/g,"");if(e.startsWith("02")){if(e.length===10)return`${e.slice(0,2)}-${e.slice(2,6)}-${e.slice(6)}`;if(e.length===9)return`${e.slice(0,2)}-${e.slice(2,5)}-${e.slice(5)}`}return e.length===11?`${e.slice(0,3)}-${e.slice(3,7)}-${e.slice(7)}`:e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6)}`:t},M2=t=>{if(!t)return"";const e=t.replace(/\D/g,"");if(e.startsWith("02")){if(e.length===10)return`${e.slice(0,2)}-****-${e.slice(6)}`;if(e.length===9)return`${e.slice(0,2)}-***-${e.slice(5)}`}return e.length===11?`${e.slice(0,3)}-****-${e.slice(7)}`:e.length===10?`${e.slice(0,3)}-***-${e.slice(6)}`:e.length>7?`${e.slice(0,3)}-${"*".repeat(e.length-7)}-${e.slice(-4)}`:t},qo=t=>isNaN(t)?"0":t.toLocaleString("ko-KR"),lC=t=>!t||t.length!==8?t||"":`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6)}`,kV=(t,e=4,n=4)=>{if(!t||t.length<=e+n)return t;const r="*".repeat(t.length-e-n);return t.slice(0,e)+r+t.slice(-n)},UV=()=>{try{const t=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");if(t){const e=JSON.parse(t),n=e.authSoList||e.AUTH_SO_List||[];return n.length>0?n[0].SO_ID||n[0].soId||"":e.soId||e.SO_ID||""}}catch{console.log("[CustomerAPI] Failed to get SO_ID from session")}return""},BV=async t=>{const e=t||UV();return bn("/billing/payment/anony/getCardVendorBySoId",{SO_ID:e})},GV=async t=>{const e={MID:t.master_store_id,OID:t.order_no,ORDER_DT:t.order_dt,SO_ID:t.ctrt_so_id,CUST_ID:t.cust_id,CUST_NM:t.reqr_nm,AMT:t.encrypted_amt,PYM_ACNT_ID:t.pym_acnt_id,USER_ID:t.user_id,RCPT_BILL_EMP_ID:t.rcpt_bill_emp_id,SMRY:t.smry,PYR_REL:t.pyr_rel,PROD_INFO_CD:t.prod_info_cd,CUST_EMAIL:t.cust_email,STAGE:t.stage||""};return t.dtlList&&(e.DTL_LIST=t.dtlList.map(n=>({MID:n.master_store_id,OID:n.order_no,ORDER_DT:n.order_dt,BILL_SEQ_NO:n.BILL_SEQ_NO,SO_ID:n.SO_ID,BILL_AMT:n.BILL_AMT,PRE_RCPT_AMT:n.PRE_RCPT_AMT,RCPT_AMT:n.RCPT_AMT}))),bn("/billing/payment/anony/insertDpstAndDTL",e)},WV=async t=>{const e={MID:t.mid,OID:t.oid,ORDER_DT:t.order_dt,AMT:t.amount,CUST_NM:t.buyer,GOODNAME:t.productinfo,CARD_NO:t.card_no,CARD_EXPIRY:t.card_expyear+t.card_expmon,CARD_EXPYEAR:t.card_expyear,CARD_EXPMON:t.card_expmon,KOR_ID:t.kor_id,INSTALL_PERIOD:t.install,PYM_ACNT_ID:t.pym_acnt_id,ENCRYPTED_AMT:t.encrypted_amt,SO_ID:t.so_id||"",CUST_ID:t.cust_id||"",CTRT_ID:t.ctrt_id||"",STAGE:t.stage||"",CARD_VENDOR:t.card_vendor||""};return bn("/billing/payment/anony/processCardPayment",e)},FV=()=>{const t=new Date,e=(i,a=2)=>String(i).padStart(a,"0"),n=e(t.getHours())+e(t.getMinutes())+e(t.getSeconds()),r=String(Math.floor(Math.random()*1e4)).padStart(4,"0");return n+r},KV=()=>{const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}${n}${r}`},QV=async t=>bn("/customer/etc/getPromOfContract",{CTRT_ID:t}),YV=async t=>{const e=sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo");let n="SYSTEM";if(e)try{const r=JSON.parse(e);n=r.USR_ID||r.userId||"SYSTEM"}catch{}return bn("/customer/etc/saveCtrtAgreeInfo",{...t,AGREE_YN:t.AGREE_YN||"Y",WRKR_ID:t.WRKR_ID||n})},VV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCU064"}),$V=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCU072"}),zV=async()=>bn("/common/getCommonCodes",{CODE_GROUP:"CMCU252"}),HV=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},qV=t=>{switch(t){case"10":case"Y":return"bg-green-100 text-green-700";case"20":return"bg-yellow-100 text-yellow-700";case"30":case"90":case"N":return"bg-gray-100 text-gray-600";case"82":return"bg-sky-100 text-sky-700";default:return"bg-blue-100 text-blue-700"}},XV=({contracts:t,isLoading:e,expanded:n,onToggle:r,onContractSelect:i,showToast:a,onNavigateToConsultation:o,onNavigateToAS:c,onNavigateToAddressChange:u,onNavigateToReContract:h,initialSearchKeyword:m})=>{const[_,p]=b.useState("active"),[g,C]=b.useState(m||"");b.useEffect(()=>{C(m||"")},[m]);const[y,S]=b.useState(null),[v,k]=b.useState(null),L=I=>{const E=I.CTRT_STAT_CD||"";return!["10","50","90"].includes(E)},M=I=>{const E=I.CTRT_STAT_CD||"",A=I.CTRT_STAT_NM||"",Y=["20","30","82"].includes(E),ee=I.CLOSE_DANGER==="Y"&&A.includes("");return Y?{consultation:!0,as:!0,addressChange:!0,reContract:ee}:{consultation:!1,as:!1,addressChange:!1,reContract:!1}},P=t.filter(I=>{var E,A,Y,ee;if(_==="active"&&!L(I)||_==="recommit"&&(!L(I)||I.CLOSE_DANGER!=="Y"||!(I.CTRT_STAT_NM||"").includes("")))return!1;if(g){const J=g.toLowerCase(),H=(E=I.CTRT_ID)==null?void 0:E.toLowerCase().includes(J),V=(A=I.PROD_NM)==null?void 0:A.toLowerCase().includes(J),K=(Y=I.EQT_SERNO)==null?void 0:Y.toLowerCase().includes(J),j=(ee=I.NOTRECEV)==null?void 0:ee.toLowerCase().includes(J);return H||V||K||j}return!0}),F={all:t.length,active:t.filter(I=>L(I)).length,recommit:t.filter(I=>L(I)&&I.CLOSE_DANGER==="Y"&&(I.CTRT_STAT_NM||"").includes("")).length},G=I=>{S(I.CTRT_ID),i(I)},B=I=>{const E=I.CTRT_ID;k(v===E?null:E),G(I)};return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:r,className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($h,{className:"w-5 h-5 text-purple-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:" "}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",t.length,")"]})]}),n?s.jsx(kr,{className:"w-5 h-5 text-gray-400"}):s.jsx(ir,{className:"w-5 h-5 text-gray-400"})]}),n&&s.jsx("div",{className:"px-4 pb-4",children:e?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(On,{className:"w-6 h-6 animate-spin text-gray-400"})}):t.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"  ."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4 space-y-3",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>p("all"),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${_==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",F.all,")"]}),s.jsxs("button",{onClick:()=>p("active"),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${_==="active"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",F.active,")"]}),s.jsxs("button",{onClick:()=>p("recommit"),className:`px-3 py-1.5 text-sm rounded-full transition-colors ${_==="recommit"?"bg-purple-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" (",F.recommit,")"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(CM,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:g,onChange:I=>C(I.target.value),placeholder:"ID, ,  ",className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g&&s.jsx("button",{onClick:()=>C(""),className:"flex-shrink-0 px-3 py-2 text-xs font-medium text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors",children:""})]})]}),s.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[P.map((I,E)=>s.jsxs("div",{className:`p-3 rounded-lg border transition-colors ${y===I.CTRT_ID?"bg-blue-50 border-blue-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"cursor-pointer",onClick:()=>B(I),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsx("div",{className:"flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full bg-blue-500 text-white text-sm font-bold",children:E+1}),s.jsx("span",{className:"text-sm text-gray-600 truncate",children:I.PROD_NM})]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded whitespace-nowrap ${I.CLOSE_DANGER==="Y"&&(I.CTRT_STAT_NM||"").includes("")?"bg-orange-100 text-orange-700":qV(I.CTRT_STAT_CD)}`,children:(()=>{const A=I.CTRT_STAT_NM||(I.CTRT_STAT_CD==="90"?"":I.CTRT_STAT_CD==="20"?"":"");return I.CLOSE_DANGER==="Y"&&A.includes("")?"()":A})()}),s.jsx(ir,{className:`w-4 h-4 text-gray-400 transition-transform flex-shrink-0 ${v===I.CTRT_ID?"rotate-180":""}`})]})]}),s.jsxs("div",{className:"flex items-center justify-between mb-1 ml-9 gap-2 flex-nowrap overflow-hidden",children:[s.jsxs("span",{className:"text-sm text-gray-600 flex-shrink-0 whitespace-nowrap",children:[" ID: ",HV(I.CTRT_ID)]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-indigo-50 text-indigo-600 rounded whitespace-nowrap",children:I.INSTL_LOC||"N/A"}),I.SO_NM&&s.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-purple-50 text-purple-600 rounded whitespace-nowrap",children:I.SO_NM})]})]}),(I.STREET_ADDR_FULL||I.ADDR_FULL||I.INST_ADDR)&&s.jsxs("div",{className:"flex items-start gap-1 text-sm text-gray-600 mt-1",children:[s.jsx(Ed,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),s.jsx("div",{className:"min-w-0",children:I.STREET_ADDR_FULL?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-blue-600 mr-1",children:"[]"}),s.jsx("span",{children:I.STREET_ADDR_FULL})]}):s.jsx("span",{children:I.ADDR_FULL||I.INST_ADDR})})]})]}),v===I.CTRT_ID&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-2",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",I.AGMT_MON?`${I.AGMT_MON} (${lC(I.CTRT_APLY_STRT_DT)||"-"} ~ ${lC(I.CTRT_APLY_END_DT)||"-"})`:"-"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",I.OPNG_DT?lC(I.OPNG_DT):"-"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",I.NOTRECEV||"-"]}),I.GRP_NM&&s.jsxs("div",{className:"text-sm text-gray-600",children:[": ",I.GRP_NM]}),(()=>{const A=M(I);return s.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t border-gray-200",children:[s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.consultation&&(G(I),o&&o(I))},disabled:!A.consultation,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.consultation?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:""}),s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.as&&(G(I),c&&c(I))},disabled:!A.as,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.as?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:"AS"}),s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.addressChange&&(G(I),u&&u(I))},disabled:!A.addressChange,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.addressChange?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:""}),s.jsx("button",{onClick:Y=>{Y.stopPropagation(),A.reContract&&(G(I),h&&h(I))},disabled:!A.reContract,className:`flex-1 flex items-center justify-center gap-1 px-2 py-2 text-xs font-medium rounded-lg transition-colors ${A.reContract?"bg-purple-500 hover:bg-purple-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:""})]})})()]})]},I.CTRT_ID)),P.length===0&&s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"   ."})]})]})})]})},_1="pendingPayment_";function JV(t,e){sessionStorage.setItem(_1+t,JSON.stringify(e))}function CR(t){try{const e=sessionStorage.getItem(_1+t);if(!e)return null;const n=JSON.parse(e);return Date.now()-n.timestamp>1440*60*1e3?(sessionStorage.removeItem(_1+t),null):n}catch{return null}}function NR(t){sessionStorage.removeItem(_1+t)}const SR=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},ZV=t=>!t||t.length<2?t||"-":t.length===2?t[0]+"*":t[0]+"*".repeat(t.length-2)+t[t.length-1],e$=t=>(t==null?void 0:t.replace(/\d*/g,"").trim())||"",t$=t=>!t||t.length<6?t||"-":`${t.slice(0,4)}-${t.slice(4,6)}`,A4=t=>{const e=t.replace(/\D/g,"").slice(0,16),n=[];for(let r=0;r<e.length;r+=4)n.push(e.slice(r,r+4));return n.join("-")},s$=t=>{const e=t.replace(/\D/g,"");if(e.length<10)return A4(t);const n=e.slice(0,4),r=e.slice(-4),i=e.length-8,a=n+"*".repeat(i>0?i:4)+r,o=[];for(let c=0;c<a.length;c+=4)o.push(a.slice(c,c+4));return o.join("-")},n$=({isOpen:t,onClose:e,custId:n,custNm:r,pymAcntId:i,soId:a,unpaymentList:o,showToast:c,onSuccess:u,pendingPayment:h})=>{const m=!!h,[_,p]=b.useState(new Set),[g,C]=b.useState(!1),[y,S]=b.useState(!1),[v,k]=b.useState(""),[L,M]=b.useState(""),[P,F]=b.useState(""),[G,B]=b.useState("00"),[I,E]=b.useState(""),[A,Y]=b.useState(null);if(b.useEffect(()=>{t&&(p(new Set(o.map((U,Q)=>Q))),S(!1),h?(k(h.cardNo),M(h.expMonth),F(h.expYear),B(h.installment),E(h.korId),Y({mid:h.mid,orderNo:h.orderNo,orderDt:h.orderDt})):(k(""),M(""),F(""),B("00"),E(""),Y(null)))},[t,o,h]),b.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),!t)return null;const ee=U=>{const Q=new Set(_);Q.has(U)?Q.delete(U):Q.add(U),p(Q)},J=()=>{_.size===o.length?p(new Set):p(new Set(o.map((U,Q)=>Q)))},H=o.filter((U,Q)=>_.has(Q)).reduce((U,Q)=>U+(Q.UNPAY_AMT||0),0),V=o.reduce((U,Q)=>U+(Q.UNPAY_AMT||0),0),K=U=>{const Q=U.target.value.replace(/\D/g,"").slice(0,16);k(Q)},j=U=>{const Q=U.target.value.replace(/\D/g,"").slice(0,10);E(Q)},te=()=>_.size===0?"  .":v.length<15?"  .":!L||!P?" .":I.length<6?"(6)  (10) .":null,ce=new Date().getFullYear(),R=Array.from({length:11},(U,Q)=>{const q=ce+Q;return{value:String(q).slice(2),label:String(q)}}),O=async()=>{var Q,q,$;const U=te();if(U){c==null||c(U,"warning");return}C(!0);try{const de=String(H),ae=sessionStorage.getItem("userInfo")&&JSON.parse(sessionStorage.getItem("userInfo")||"{}").userId||"SYSTEM";console.log("[Payment] Step 1: getCardVendorBySoId");let _e="dlivecon";const ie=await BV(a);if(ie.success&&ie.data){const me=Array.isArray(ie.data)?ie.data[0]:ie.data;me!=null&&me.CARD_VENDOR&&(_e=me.CARD_VENDOR)}const Ne=KV(),X=FV();console.log("[Payment] Fallback MID:",_e,"OrderNo:",X);const xe=o.filter((me,ve)=>_.has(ve)),fe=[];xe.forEach(me=>{const ve=(me.BILL_SEQ_NO||"").split(",").map(et=>et.trim()).filter(Boolean);ve.length>0?ve.forEach(et=>{fe.push({master_store_id:_e,order_dt:Ne,order_no:X,BILL_SEQ_NO:et,SO_ID:me.SO_ID||a||"",BILL_AMT:me.BILL_AMT||me.UNPAY_AMT,PRE_RCPT_AMT:(me.BILL_AMT||0)-(me.UNPAY_AMT||0),RCPT_AMT:me.UNPAY_AMT})}):fe.push({master_store_id:_e,order_dt:Ne,order_no:X,BILL_SEQ_NO:"",SO_ID:me.SO_ID||a||"",BILL_AMT:me.BILL_AMT||me.UNPAY_AMT,PRE_RCPT_AMT:(me.BILL_AMT||0)-(me.UNPAY_AMT||0),RCPT_AMT:me.UNPAY_AMT})}),console.log("[Payment] Step 2: insertDpstAndDTL");const le=await GV({master_store_id:_e,order_dt:Ne,order_no:X,ctrt_so_id:a||"",pym_acnt_id:i||"",cust_id:n,prod_info_cd:"01",encrypted_amt:de,reqr_nm:r||"",pyr_rel:"A",user_id:ae,rcpt_bill_emp_id:ae,smry:"  ",cust_email:"",stage:"01",dtlList:fe});if(console.log("[Payment] insertDpstAndDTL result:",le),!le.success){c==null||c(le.message||"  .","error");return}const se=((Q=le.data)==null?void 0:Q.ORDER_NO)||X,Re=((q=le.data)==null?void 0:q.ORDER_DT)||Ne,be=(($=le.data)==null?void 0:$.MID)||_e,De=be+Re+se;console.log("[Payment] Final values - ORDER_NO:",se,"ORDER_DT:",Re,"MID:",be),i&&JV(i,{cardNo:v,expMonth:L,expYear:P,installment:G,korId:I,mid:be,orderNo:se,orderDt:Re,selectedTotal:H,timestamp:Date.now()}),console.log("[Payment] Step 3: processCardPayment");const re=await WV({mid:be,order_dt:Re,oid:se,amount:de,buyer:r||"",productinfo:"01",card_no:v,card_expyear:P,card_expmon:L,kor_id:I,install:G,pym_acnt_id:i||"",encrypted_amt:de,so_id:a||"",cust_id:n,stage:"02",card_vendor:be});re.success?(i&&NR(i),S(!0),Y({mid:be,orderNo:De,orderDt:Re}),u==null||u()):c==null||c(re.message||"  .","error")}catch(de){console.error("[Payment] Error:",de),c==null||c((de==null?void 0:de.message)||"    .","error")}finally{C(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4 max-h-[85vh] flex flex-col",onClick:U=>U.stopPropagation(),children:[s.jsxs("div",{className:`flex items-center justify-between p-4 border-b border-gray-200 rounded-t-xl ${m?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-red-500 to-red-600"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 text-white",children:[m?s.jsx(wp,{className:"w-5 h-5"}):s.jsx(Lp,{className:"w-5 h-5"}),s.jsx("h3",{className:"font-semibold",children:m?"  ()":" "})]}),s.jsx("button",{onClick:e,className:"text-white/80 hover:text-white transition-colors",disabled:g,children:s.jsx(Mi,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-medium text-gray-900",children:ZV(r)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"ID: "}),s.jsx("span",{className:"font-mono text-blue-600",children:SR(n)})]}),i&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:": "}),s.jsx("span",{className:"font-mono text-purple-600",children:SR(i)})]})]})}),y?s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8",children:[s.jsx(ea,{className:"w-16 h-16 text-green-500 mb-4"}),s.jsxs("p",{className:"text-gray-700 text-center mb-6 text-sm leading-relaxed",children:[qo(H),"",s.jsx("br",{}),"   ."]}),s.jsx("button",{onClick:e,className:"w-full max-w-xs py-3 text-sm font-medium text-white bg-green-500 rounded-lg hover:bg-green-600 transition-colors",children:""})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-0",children:o.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-400",children:[s.jsx(Vr,{className:"w-12 h-12 mb-2"}),s.jsx("span",{children:"  ."})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg cursor-pointer border border-blue-200",children:[s.jsx("input",{type:"checkbox",checked:_.size===o.length,onChange:J,className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:g}),s.jsxs("span",{className:"flex-1 font-medium text-blue-700",children:["  (",o.length,")"]}),s.jsxs("span",{className:"font-bold text-blue-700",children:[qo(V),""]})]}),o.map((U,Q)=>s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer border transition-colors ${_.has(Q)?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[s.jsx("input",{type:"checkbox",checked:_.has(Q),onChange:()=>ee(Q),className:"w-5 h-5 rounded border-gray-300 text-red-600 focus:ring-red-500",disabled:g}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:t$(U.BILL_YM)}),s.jsxs("span",{className:`text-sm font-bold ${_.has(Q)?"text-red-600":"text-gray-700"}`,children:[qo(U.UNPAY_AMT),""]})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-0.5 truncate",children:[e$(U.PROD_NM),U.UNPAY_DAYS?` |  ${U.UNPAY_DAYS}`:""]})]})]},Q))]})}),s.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 p-3 bg-white rounded-lg border border-gray-200",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["  (",_.size,")"]}),s.jsxs("span",{className:"text-xl font-bold text-red-600",children:[qo(H),""]})]}),s.jsxs("div",{className:`mb-3 p-3 rounded-lg border ${m?"bg-amber-50 border-amber-200":"bg-white border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[s.jsx(Lp,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:" "}),m&&s.jsxs("span",{className:"ml-auto px-2 py-0.5 text-xs bg-amber-500 text-white rounded-full flex items-center gap-1",children:[s.jsx(wp,{className:"w-3 h-3"})," "]})]}),m&&s.jsxs("div",{className:"mb-3 p-2 bg-amber-100 rounded-lg text-xs text-amber-800 flex items-start gap-2",children:[s.jsx(Vr,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),s.jsxs("span",{children:[" .     .",s.jsx("br",{}),"   ."]})]}),s.jsxs("div",{className:"mb-2.5",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("input",{type:"text",inputMode:"numeric",value:m?s$(v):A4(v),onChange:K,placeholder:"0000-0000-0000-0000",disabled:g||m,readOnly:m,className:`w-full px-3 py-2 text-sm border rounded-lg outline-none font-mono tracking-wider ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100"}`,maxLength:19})]}),s.jsxs("div",{className:"flex gap-2 mb-2.5",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsxs("div",{className:"flex gap-1",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsxs("select",{value:L,onChange:U=>M(U.target.value),disabled:g||m,className:`w-full px-2 py-2 text-sm border rounded-lg outline-none appearance-none pr-7 ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white disabled:bg-gray-100"}`,children:[s.jsx("option",{value:"",children:""}),Array.from({length:12},(U,Q)=>{const q=String(Q+1).padStart(2,"0");return s.jsx("option",{value:q,children:q},q)})]}),s.jsx(ir,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),s.jsx("span",{className:"self-center text-gray-400 text-sm",children:"/"}),s.jsxs("div",{className:"relative flex-1",children:[s.jsxs("select",{value:P,onChange:U=>F(U.target.value),disabled:g||m,className:`w-full px-2 py-2 text-sm border rounded-lg outline-none appearance-none pr-7 ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white disabled:bg-gray-100"}`,children:[s.jsx("option",{value:"",children:""}),R.map(U=>s.jsx("option",{value:U.value,children:U.label},U.value))]}),s.jsx(ir,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]})]})]}),s.jsxs("div",{className:"w-24",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:G,onChange:U=>B(U.target.value),disabled:g||m,className:`w-full px-2 py-2 text-sm border rounded-lg outline-none appearance-none pr-7 ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white disabled:bg-gray-100"}`,children:[s.jsx("option",{value:"00",children:""}),[2,3,4,5,6,7,8,9,10,11,12].map(U=>s.jsxs("option",{value:String(U).padStart(2,"0"),children:[U,""]},U))]}),s.jsx(ir,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"(6) / (10)"}),s.jsx("input",{type:"text",inputMode:"numeric",value:m?I.replace(/./g,"*"):I,onChange:j,placeholder:") 900101",disabled:g||m,readOnly:m,className:`w-full px-3 py-2 text-sm border rounded-lg outline-none ${m?"border-amber-300 bg-amber-50 text-gray-700 cursor-not-allowed":"border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 disabled:bg-gray-100"}`,maxLength:10})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{m&&i&&NR(i),e()},disabled:g,className:`py-3 text-sm font-medium rounded-lg transition-colors ${m?"flex-1 text-white bg-amber-500 hover:bg-amber-600":"flex-1 text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 disabled:opacity-50"}`,children:m?" ( )":""}),!m&&s.jsx("button",{onClick:O,disabled:g||_.size===0,className:"flex-1 py-3 text-sm font-medium text-white bg-red-500 rounded-lg hover:bg-red-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:g?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-4 h-4 animate-spin"}),"  ..."]}):s.jsxs(s.Fragment,{children:[" ",H>0?qo(H)+"":""]})})]}),s.jsx("p",{className:"mt-3 text-xs text-gray-400 text-center",children:m?"*   .   .":"*     ."})]})]})]})})},k4=({onSave:t,onCancel:e,width:n=340,height:r=200,penColor:i="#000000",backgroundColor:a="#ffffff",title:o=""})=>{const c=b.useRef(null),[u,h]=b.useState(!1),[m,_]=b.useState(!1),p=b.useRef(null),[g,C]=b.useState({isOpen:!1,type:"warning",message:"",onConfirm:()=>{}});b.useEffect(()=>{const F=c.current;if(!F)return;const G=F.getContext("2d");G&&(G.fillStyle=a,G.fillRect(0,0,F.width,F.height),G.strokeStyle=i,G.lineWidth=2,G.lineCap="round",G.lineJoin="round")},[a,i]);const y=b.useCallback(F=>{const G=c.current;if(!G)return null;const B=G.getBoundingClientRect(),I=G.width/B.width,E=G.height/B.height;if("touches"in F){const A=F.touches[0];return{x:(A.clientX-B.left)*I,y:(A.clientY-B.top)*E}}else return{x:(F.clientX-B.left)*I,y:(F.clientY-B.top)*E}},[]),S=b.useCallback(F=>{F.preventDefault();const G=y(F);if(!G)return;h(!0),p.current=G;const B=c.current,I=B==null?void 0:B.getContext("2d");I&&(I.beginPath(),I.moveTo(G.x,G.y))},[y]),v=b.useCallback(F=>{if(!u)return;F.preventDefault();const G=y(F);if(!G||!p.current)return;const B=c.current,I=B==null?void 0:B.getContext("2d");I&&(I.beginPath(),I.moveTo(p.current.x,p.current.y),I.lineTo(G.x,G.y),I.stroke(),p.current=G,_(!0))},[u,y]),k=b.useCallback(()=>{h(!1),p.current=null},[]),L=b.useCallback(()=>{const F=c.current,G=F==null?void 0:F.getContext("2d");!G||!F||(G.fillStyle=a,G.fillRect(0,0,F.width,F.height),_(!1))},[a]),M=b.useCallback(()=>{const F=c.current;if(!F||!m)return;let G=F.toDataURL("image/png");if(G=G.replace(/\+/g,"%2B"),G.length<5e3){C({isOpen:!0,type:"error",message:`    .
  .`,onConfirm:()=>L()});return}if(G.length<1e4){C({isOpen:!0,type:"warning",message:`      .
  .`,onConfirm:()=>L()});return}t(G)},[m,t,L]),P=b.useCallback(()=>{C(F=>({...F,isOpen:!1}))},[]);return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[s.jsx(Ba,{isOpen:g.isOpen,onClose:P,onConfirm:g.onConfirm,title:" ",message:g.message,type:g.type,showCancel:!1,confirmText:""}),s.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[s.jsx("h3",{className:"font-medium",children:o}),s.jsx("p",{className:"text-xs text-blue-100 mt-0.5",children:"  "})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg overflow-hidden bg-gray-50",children:s.jsx("canvas",{ref:c,width:n,height:r,className:"touch-none w-full",style:{maxWidth:"100%",height:"auto",aspectRatio:`${n}/${r}`},onMouseDown:S,onMouseMove:v,onMouseUp:k,onMouseLeave:k,onTouchStart:S,onTouchMove:v,onTouchEnd:k})}),!m&&s.jsx("div",{className:"text-center mt-2 text-sm text-gray-400",children:"   "})]}),s.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[s.jsxs("button",{onClick:L,className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(Ai,{className:"w-4 h-4"})," "]}),e&&s.jsxs("button",{onClick:e,className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(CP,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:M,disabled:!m,className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:[s.jsx(jc,{className:"w-4 h-4"}),""]})]})]})};function Nr(t){"@babel/helpers - typeof";return Nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(t)}var ec=Uint8Array,Fl=Uint16Array,fS=Int32Array,mS=new ec([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gS=new ec([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vR=new ec([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),U4=function(t,e){for(var n=new Fl(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new fS(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},B4=U4(mS,2),r$=B4.b,I2=B4.r;r$[28]=258,I2[258]=28;var i$=U4(gS,0),ER=i$.r,j2=new Fl(32768);for(var Yr=0;Yr<32768;++Yr){var xu=(Yr&43690)>>1|(Yr&21845)<<1;xu=(xu&52428)>>2|(xu&13107)<<2,xu=(xu&61680)>>4|(xu&3855)<<4,j2[Yr]=((xu&65280)>>8|(xu&255)<<8)>>1}var Qg=(function(t,e,n){for(var r=t.length,i=0,a=new Fl(e);i<r;++i)t[i]&&++a[t[i]-1];var o=new Fl(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var c;if(n){c=new Fl(1<<e);var u=15-e;for(i=0;i<r;++i)if(t[i])for(var h=i<<4|t[i],m=e-t[i],_=o[t[i]-1]++<<m,p=_|(1<<m)-1;_<=p;++_)c[j2[_]>>u]=h}else for(c=new Fl(r),i=0;i<r;++i)t[i]&&(c[i]=j2[o[t[i]-1]++]>>15-t[i]);return c}),t0=new ec(288);for(var Yr=0;Yr<144;++Yr)t0[Yr]=8;for(var Yr=144;Yr<256;++Yr)t0[Yr]=9;for(var Yr=256;Yr<280;++Yr)t0[Yr]=7;for(var Yr=280;Yr<288;++Yr)t0[Yr]=8;var x1=new ec(32);for(var Yr=0;Yr<32;++Yr)x1[Yr]=5;var a$=Qg(t0,9,0),l$=Qg(x1,5,0),G4=function(t){return(t+7)/8|0},o$=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new ec(t.subarray(e,n))},od=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},xg=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},oC=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,a=n.slice();if(!i)return{t:F4,l:0};if(i==1){var o=new ec(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(P,F){return P.f-F.f}),n.push({s:-1,f:25001});var c=n[0],u=n[1],h=0,m=1,_=2;for(n[0]={s:-1,f:c.f+u.f,l:c,r:u};m!=i-1;)c=n[n[h].f<n[_].f?h++:_++],u=n[h!=m&&n[h].f<n[_].f?h++:_++],n[m++]={s:-1,f:c.f+u.f,l:c,r:u};for(var p=a[0].s,r=1;r<i;++r)a[r].s>p&&(p=a[r].s);var g=new Fl(p+1),C=O2(n[m-1],g,0);if(C>e){var r=0,y=0,S=C-e,v=1<<S;for(a.sort(function(F,G){return g[G.s]-g[F.s]||F.f-G.f});r<i;++r){var k=a[r].s;if(g[k]>e)y+=v-(1<<C-g[k]),g[k]=e;else break}for(y>>=S;y>0;){var L=a[r].s;g[L]<e?y-=1<<e-g[L]++-1:++r}for(;r>=0&&y;--r){var M=a[r].s;g[M]==e&&(--g[M],++y)}C=e}return{t:new ec(g),l:C}},O2=function(t,e,n){return t.s==-1?Math.max(O2(t.l,e,n+1),O2(t.r,e,n+1)):e[t.s]=n},DR=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Fl(++e),r=0,i=t[0],a=1,o=function(u){n[r++]=u},c=1;c<=e;++c)if(t[c]==i&&c!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[c]}return{c:n.subarray(0,r),n:e}},pg=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},W4=function(t,e,n){var r=n.length,i=G4(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<r;++a)t[i+a+4]=n[a];return(i+4+r)*8},RR=function(t,e,n,r,i,a,o,c,u,h,m){od(e,m++,n),++i[256];for(var _=oC(i,15),p=_.t,g=_.l,C=oC(a,15),y=C.t,S=C.l,v=DR(p),k=v.c,L=v.n,M=DR(y),P=M.c,F=M.n,G=new Fl(19),B=0;B<k.length;++B)++G[k[B]&31];for(var B=0;B<P.length;++B)++G[P[B]&31];for(var I=oC(G,7),E=I.t,A=I.l,Y=19;Y>4&&!E[vR[Y-1]];--Y);var ee=h+5<<3,J=pg(i,t0)+pg(a,x1)+o,H=pg(i,p)+pg(a,y)+o+14+3*Y+pg(G,E)+2*G[16]+3*G[17]+7*G[18];if(u>=0&&ee<=J&&ee<=H)return W4(e,m,t.subarray(u,u+h));var V,K,j,te;if(od(e,m,1+(H<J)),m+=2,H<J){V=Qg(p,g,0),K=p,j=Qg(y,S,0),te=y;var ce=Qg(E,A,0);od(e,m,L-257),od(e,m+5,F-1),od(e,m+10,Y-4),m+=14;for(var B=0;B<Y;++B)od(e,m+3*B,E[vR[B]]);m+=3*Y;for(var R=[k,P],O=0;O<2;++O)for(var U=R[O],B=0;B<U.length;++B){var Q=U[B]&31;od(e,m,ce[Q]),m+=E[Q],Q>15&&(od(e,m,U[B]>>5&127),m+=U[B]>>12)}}else V=a$,K=t0,j=l$,te=x1;for(var B=0;B<c;++B){var q=r[B];if(q>255){var Q=q>>18&31;xg(e,m,V[Q+257]),m+=K[Q+257],Q>7&&(od(e,m,q>>23&31),m+=mS[Q]);var $=q&31;xg(e,m,j[$]),m+=te[$],$>3&&(xg(e,m,q>>5&8191),m+=gS[$])}else xg(e,m,V[q]),m+=K[q]}return xg(e,m,V[256]),m+K[256]},c$=new fS([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F4=new ec(0),d$=function(t,e,n,r,i,a){var o=a.z||t.length,c=new ec(r+o+5*(1+Math.ceil(o/7e3))+i),u=c.subarray(r,c.length-i),h=a.l,m=(a.r||0)&7;if(e){m&&(u[0]=a.r>>3);for(var _=c$[e-1],p=_>>13,g=_&8191,C=(1<<n)-1,y=a.p||new Fl(32768),S=a.h||new Fl(C+1),v=Math.ceil(n/3),k=2*v,L=function(fe){return(t[fe]^t[fe+1]<<v^t[fe+2]<<k)&C},M=new fS(25e3),P=new Fl(288),F=new Fl(32),G=0,B=0,I=a.i||0,E=0,A=a.w||0,Y=0;I+2<o;++I){var ee=L(I),J=I&32767,H=S[ee];if(y[J]=H,S[ee]=J,A<=I){var V=o-I;if((G>7e3||E>24576)&&(V>423||!h)){m=RR(t,u,0,M,P,F,B,E,Y,I-Y,m),E=G=B=0,Y=I;for(var K=0;K<286;++K)P[K]=0;for(var K=0;K<30;++K)F[K]=0}var j=2,te=0,ce=g,R=J-H&32767;if(V>2&&ee==L(I-R))for(var O=Math.min(p,V)-1,U=Math.min(32767,I),Q=Math.min(258,V);R<=U&&--ce&&J!=H;){if(t[I+j]==t[I+j-R]){for(var q=0;q<Q&&t[I+q]==t[I+q-R];++q);if(q>j){if(j=q,te=R,q>O)break;for(var $=Math.min(R,q-2),de=0,K=0;K<$;++K){var ae=I-R+K&32767,_e=y[ae],ie=ae-_e&32767;ie>de&&(de=ie,H=ae)}}}J=H,H=y[J],R+=J-H&32767}if(te){M[E++]=268435456|I2[j]<<18|ER[te];var Ne=I2[j]&31,X=ER[te]&31;B+=mS[Ne]+gS[X],++P[257+Ne],++F[X],A=I+j,++G}else M[E++]=t[I],++P[t[I]]}}for(I=Math.max(I,A);I<o;++I)M[E++]=t[I],++P[t[I]];m=RR(t,u,h,M,P,F,B,E,Y,I-Y,m),h||(a.r=m&7|u[m/8|0]<<3,m-=7,a.h=S,a.p=y,a.i=I,a.w=A)}else{for(var I=a.w||0;I<o+h;I+=65535){var xe=I+65535;xe>=o&&(u[m/8|0]=h,xe=o),m=W4(u,m+1,t.subarray(I,xe))}a.i=o}return o$(c,0,r+G4(m)+i)},K4=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,a=n.length|0,o=0;o!=a;){for(var c=Math.min(o+2655,a);o<c;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},u$=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new ec(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return d$(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},Q4=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},h$=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=K4();i.p(e.dictionary),Q4(t,2,i.d())}};function w2(t,e){e||(e={});var n=K4();n.p(t);var r=u$(t,e,e.dictionary?6:2,4);return h$(r,e),Q4(r,r.length-4,n.d()),r}var f$=typeof TextDecoder<"u"&&new TextDecoder,m$=0;try{f$.decode(F4,{stream:!0}),m$=1}catch{}function g$(t){if(Array.isArray(t))return t}function _$(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,c=[],u=!0,h=!1;try{if(a=(n=n.call(t)).next,e!==0)for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(m){h=!0,i=m}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(h)throw i}}return c}}function TR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function x$(t,e){if(t){if(typeof t=="string")return TR(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?TR(t,e):void 0}}function p$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MR(t,e){return g$(t)||_$(t,e)||x$(t,e)||p$()}function IR(t,e="utf8"){return new TextDecoder(e).decode(t)}const y$=new TextEncoder;function b$(t){return y$.encode(t)}const C$=1024*8,N$=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),cC={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class _S{constructor(e=C$,n={}){dr(this,"buffer");dr(this,"byteLength");dr(this,"byteOffset");dr(this,"length");dr(this,"offset");dr(this,"lastWrittenByte");dr(this,"littleEndian");dr(this,"_data");dr(this,"_mark");dr(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=n.offset?n.offset>>>0:0,a=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof _S)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=cC[n].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+r);if(this.littleEndian===N$&&n!=="uint8"&&n!=="int8"){const c=new Uint8Array(this.buffer.slice(i,i+r));c.reverse();const u=new cC[n](c.buffer);return this.offset+=r,u.reverse(),u}const o=new cC[n](a);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return IR(this.readBytes(e))}decodeText(e=1,n="utf8"){return IR(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(b$(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Sm(t){let e=t.length;for(;--e>=0;)t[e]=0}const S$=3,v$=258,Y4=29,E$=256,D$=E$+1+Y4,V4=30,R$=512,T$=new Array((D$+2)*2);Sm(T$);const M$=new Array(V4*2);Sm(M$);const I$=new Array(R$);Sm(I$);const j$=new Array(v$-S$+1);Sm(j$);const O$=new Array(Y4);Sm(O$);const w$=new Array(V4);Sm(w$);const L$=(t,e,n,r)=>{let i=t&65535|0,a=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+e[r++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var L2=L$;const P$=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},A$=new Uint32Array(P$()),k$=(t,e,n,r)=>{const i=A$,a=r+n;t^=-1;for(let o=r;o<a;o++)t=t>>>8^i[(t^e[o])&255];return t^-1};var Nc=k$,P2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$4={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const U$=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var B$=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)U$(n,r)&&(t[r]=n[r])}}return t},G$=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,a=t.length;r<a;r++){let o=t[r];n.set(o,i),i+=o.length}return n},z4={assign:B$,flattenChunks:G$};let H4=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{H4=!1}const d_=new Uint8Array(256);for(let t=0;t<256;t++)d_[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;d_[254]=d_[254]=1;var W$=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,a,o=t.length,c=0;for(i=0;i<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),c+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(c),a=0,i=0;a<c;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|n&63):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|n&63):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|n&63);return e};const F$=(t,e)=>{if(e<65534&&t.subarray&&H4)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var K$=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const a=new Array(n*2);for(i=0,r=0;r<n;){let o=t[r++];if(o<128){a[i++]=o;continue}let c=d_[o];if(c>4){a[i++]=65533,r+=c-1;continue}for(o&=c===2?31:c===3?15:7;c>1&&r<n;)o=o<<6|t[r++]&63,c--;if(c>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return F$(a,i)},Q$=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+d_[t[n]]>e?n:e},A2={string2buf:W$,buf2string:K$,utf8border:Q$};function Y$(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var V$=Y$;const ep=16209,$$=16191;var z$=function(e,n){let r,i,a,o,c,u,h,m,_,p,g,C,y,S,v,k,L,M,P,F,G,B,I,E;const A=e.state;r=e.next_in,I=e.input,i=r+(e.avail_in-5),a=e.next_out,E=e.output,o=a-(n-e.avail_out),c=a+(e.avail_out-257),u=A.dmax,h=A.wsize,m=A.whave,_=A.wnext,p=A.window,g=A.hold,C=A.bits,y=A.lencode,S=A.distcode,v=(1<<A.lenbits)-1,k=(1<<A.distbits)-1;e:do{C<15&&(g+=I[r++]<<C,C+=8,g+=I[r++]<<C,C+=8),L=y[g&v];t:for(;;){if(M=L>>>24,g>>>=M,C-=M,M=L>>>16&255,M===0)E[a++]=L&65535;else if(M&16){P=L&65535,M&=15,M&&(C<M&&(g+=I[r++]<<C,C+=8),P+=g&(1<<M)-1,g>>>=M,C-=M),C<15&&(g+=I[r++]<<C,C+=8,g+=I[r++]<<C,C+=8),L=S[g&k];s:for(;;){if(M=L>>>24,g>>>=M,C-=M,M=L>>>16&255,M&16){if(F=L&65535,M&=15,C<M&&(g+=I[r++]<<C,C+=8,C<M&&(g+=I[r++]<<C,C+=8)),F+=g&(1<<M)-1,F>u){e.msg="invalid distance too far back",A.mode=ep;break e}if(g>>>=M,C-=M,M=a-o,F>M){if(M=F-M,M>m&&A.sane){e.msg="invalid distance too far back",A.mode=ep;break e}if(G=0,B=p,_===0){if(G+=h-M,M<P){P-=M;do E[a++]=p[G++];while(--M);G=a-F,B=E}}else if(_<M){if(G+=h+_-M,M-=_,M<P){P-=M;do E[a++]=p[G++];while(--M);if(G=0,_<P){M=_,P-=M;do E[a++]=p[G++];while(--M);G=a-F,B=E}}}else if(G+=_-M,M<P){P-=M;do E[a++]=p[G++];while(--M);G=a-F,B=E}for(;P>2;)E[a++]=B[G++],E[a++]=B[G++],E[a++]=B[G++],P-=3;P&&(E[a++]=B[G++],P>1&&(E[a++]=B[G++]))}else{G=a-F;do E[a++]=E[G++],E[a++]=E[G++],E[a++]=E[G++],P-=3;while(P>2);P&&(E[a++]=E[G++],P>1&&(E[a++]=E[G++]))}}else if((M&64)===0){L=S[(L&65535)+(g&(1<<M)-1)];continue s}else{e.msg="invalid distance code",A.mode=ep;break e}break}}else if((M&64)===0){L=y[(L&65535)+(g&(1<<M)-1)];continue t}else if(M&32){A.mode=$$;break e}else{e.msg="invalid literal/length code",A.mode=ep;break e}break}}while(r<i&&a<c);P=C>>3,r-=P,C-=P<<3,g&=(1<<C)-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=a<c?257+(c-a):257-(a-c),A.hold=g,A.bits=C};const uf=15,jR=852,OR=592,wR=0,dC=1,LR=2,H$=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),q$=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),X$=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),J$=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Z$=(t,e,n,r,i,a,o,c)=>{const u=c.bits;let h=0,m=0,_=0,p=0,g=0,C=0,y=0,S=0,v=0,k=0,L,M,P,F,G,B=null,I;const E=new Uint16Array(uf+1),A=new Uint16Array(uf+1);let Y=null,ee,J,H;for(h=0;h<=uf;h++)E[h]=0;for(m=0;m<r;m++)E[e[n+m]]++;for(g=u,p=uf;p>=1&&E[p]===0;p--);if(g>p&&(g=p),p===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,c.bits=1,0;for(_=1;_<p&&E[_]===0;_++);for(g<_&&(g=_),S=1,h=1;h<=uf;h++)if(S<<=1,S-=E[h],S<0)return-1;if(S>0&&(t===wR||p!==1))return-1;for(A[1]=0,h=1;h<uf;h++)A[h+1]=A[h]+E[h];for(m=0;m<r;m++)e[n+m]!==0&&(o[A[e[n+m]]++]=m);if(t===wR?(B=Y=o,I=20):t===dC?(B=H$,Y=q$,I=257):(B=X$,Y=J$,I=0),k=0,m=0,h=_,G=a,C=g,y=0,P=-1,v=1<<g,F=v-1,t===dC&&v>jR||t===LR&&v>OR)return 1;for(;;){ee=h-y,o[m]+1<I?(J=0,H=o[m]):o[m]>=I?(J=Y[o[m]-I],H=B[o[m]-I]):(J=96,H=0),L=1<<h-y,M=1<<C,_=M;do M-=L,i[G+(k>>y)+M]=ee<<24|J<<16|H|0;while(M!==0);for(L=1<<h-1;k&L;)L>>=1;if(L!==0?(k&=L-1,k+=L):k=0,m++,--E[h]===0){if(h===p)break;h=e[n+o[m]]}if(h>g&&(k&F)!==P){for(y===0&&(y=g),G+=_,C=h-y,S=1<<C;C+y<p&&(S-=E[C+y],!(S<=0));)C++,S<<=1;if(v+=1<<C,t===dC&&v>jR||t===LR&&v>OR)return 1;P=k&F,i[P]=g<<24|C<<16|G-a|0}}return k!==0&&(i[G+k]=h-y<<24|64<<16|0),c.bits=g,0};var Yg=Z$;const ez=0,q4=1,X4=2,{Z_FINISH:PR,Z_BLOCK:tz,Z_TREES:tp,Z_OK:s0,Z_STREAM_END:sz,Z_NEED_DICT:nz,Z_STREAM_ERROR:bo,Z_DATA_ERROR:J4,Z_MEM_ERROR:Z4,Z_BUF_ERROR:rz,Z_DEFLATED:AR}=$4,Z1=16180,kR=16181,UR=16182,BR=16183,GR=16184,WR=16185,FR=16186,KR=16187,QR=16188,YR=16189,p1=16190,cd=16191,uC=16192,VR=16193,hC=16194,$R=16195,zR=16196,HR=16197,qR=16198,sp=16199,np=16200,XR=16201,JR=16202,ZR=16203,eT=16204,tT=16205,fC=16206,sT=16207,nT=16208,Zr=16209,eO=16210,tO=16211,iz=852,az=592,lz=15,oz=lz,rT=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function cz(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _0=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Z1||e.mode>tO?1:0},sO=t=>{if(_0(t))return bo;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Z1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(iz),e.distcode=e.distdyn=new Int32Array(az),e.sane=1,e.back=-1,s0},nO=t=>{if(_0(t))return bo;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,sO(t)},rO=(t,e)=>{let n;if(_0(t))return bo;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?bo:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,nO(t))},iO=(t,e)=>{if(!t)return bo;const n=new cz;t.state=n,n.strm=t,n.window=null,n.mode=Z1;const r=rO(t,e);return r!==s0&&(t.state=null),r},dz=t=>iO(t,oz);let iT=!0,mC,gC;const uz=t=>{if(iT){mC=new Int32Array(512),gC=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Yg(q4,t.lens,0,288,mC,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Yg(X4,t.lens,0,32,gC,0,t.work,{bits:5}),iT=!1}t.lencode=mC,t.lenbits=9,t.distcode=gC,t.distbits=5},aO=(t,e,n,r)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(e.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(e.subarray(n-r,n-r+i),a.wnext),r-=i,r?(a.window.set(e.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},hz=(t,e)=>{let n,r,i,a,o,c,u,h,m,_,p,g,C,y,S=0,v,k,L,M,P,F,G,B;const I=new Uint8Array(4);let E,A;const Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_0(t)||!t.output||!t.input&&t.avail_in!==0)return bo;n=t.state,n.mode===cd&&(n.mode=uC),o=t.next_out,i=t.output,u=t.avail_out,a=t.next_in,r=t.input,c=t.avail_in,h=n.hold,m=n.bits,_=c,p=u,B=s0;e:for(;;)switch(n.mode){case Z1:if(n.wrap===0){n.mode=uC;break}for(;m<16;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(n.wrap&2&&h===35615){n.wbits===0&&(n.wbits=15),n.check=0,I[0]=h&255,I[1]=h>>>8&255,n.check=Nc(n.check,I,2,0),h=0,m=0,n.mode=kR;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",n.mode=Zr;break}if((h&15)!==AR){t.msg="unknown compression method",n.mode=Zr;break}if(h>>>=4,m-=4,G=(h&15)+8,n.wbits===0&&(n.wbits=G),G>15||G>n.wbits){t.msg="invalid window size",n.mode=Zr;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=h&512?YR:cd,h=0,m=0;break;case kR:for(;m<16;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(n.flags=h,(n.flags&255)!==AR){t.msg="unknown compression method",n.mode=Zr;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=Zr;break}n.head&&(n.head.text=h>>8&1),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,n.check=Nc(n.check,I,2,0)),h=0,m=0,n.mode=UR;case UR:for(;m<32;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}n.head&&(n.head.time=h),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,I[2]=h>>>16&255,I[3]=h>>>24&255,n.check=Nc(n.check,I,4,0)),h=0,m=0,n.mode=BR;case BR:for(;m<16;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}n.head&&(n.head.xflags=h&255,n.head.os=h>>8),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,n.check=Nc(n.check,I,2,0)),h=0,m=0,n.mode=GR;case GR:if(n.flags&1024){for(;m<16;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}n.length=h,n.head&&(n.head.extra_len=h),n.flags&512&&n.wrap&4&&(I[0]=h&255,I[1]=h>>>8&255,n.check=Nc(n.check,I,2,0)),h=0,m=0}else n.head&&(n.head.extra=null);n.mode=WR;case WR:if(n.flags&1024&&(g=n.length,g>c&&(g=c),g&&(n.head&&(G=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+g),G)),n.flags&512&&n.wrap&4&&(n.check=Nc(n.check,r,g,a)),c-=g,a+=g,n.length-=g),n.length))break e;n.length=0,n.mode=FR;case FR:if(n.flags&2048){if(c===0)break e;g=0;do G=r[a+g++],n.head&&G&&n.length<65536&&(n.head.name+=String.fromCharCode(G));while(G&&g<c);if(n.flags&512&&n.wrap&4&&(n.check=Nc(n.check,r,g,a)),c-=g,a+=g,G)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=KR;case KR:if(n.flags&4096){if(c===0)break e;g=0;do G=r[a+g++],n.head&&G&&n.length<65536&&(n.head.comment+=String.fromCharCode(G));while(G&&g<c);if(n.flags&512&&n.wrap&4&&(n.check=Nc(n.check,r,g,a)),c-=g,a+=g,G)break e}else n.head&&(n.head.comment=null);n.mode=QR;case QR:if(n.flags&512){for(;m<16;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(n.wrap&4&&h!==(n.check&65535)){t.msg="header crc mismatch",n.mode=Zr;break}h=0,m=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=cd;break;case YR:for(;m<32;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}t.adler=n.check=rT(h),h=0,m=0,n.mode=p1;case p1:if(n.havedict===0)return t.next_out=o,t.avail_out=u,t.next_in=a,t.avail_in=c,n.hold=h,n.bits=m,nz;t.adler=n.check=1,n.mode=cd;case cd:if(e===tz||e===tp)break e;case uC:if(n.last){h>>>=m&7,m-=m&7,n.mode=fC;break}for(;m<3;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}switch(n.last=h&1,h>>>=1,m-=1,h&3){case 0:n.mode=VR;break;case 1:if(uz(n),n.mode=sp,e===tp){h>>>=2,m-=2;break e}break;case 2:n.mode=zR;break;case 3:t.msg="invalid block type",n.mode=Zr}h>>>=2,m-=2;break;case VR:for(h>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Zr;break}if(n.length=h&65535,h=0,m=0,n.mode=hC,e===tp)break e;case hC:n.mode=$R;case $R:if(g=n.length,g){if(g>c&&(g=c),g>u&&(g=u),g===0)break e;i.set(r.subarray(a,a+g),o),c-=g,a+=g,u-=g,o+=g,n.length-=g;break}n.mode=cd;break;case zR:for(;m<14;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(n.nlen=(h&31)+257,h>>>=5,m-=5,n.ndist=(h&31)+1,h>>>=5,m-=5,n.ncode=(h&15)+4,h>>>=4,m-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Zr;break}n.have=0,n.mode=HR;case HR:for(;n.have<n.ncode;){for(;m<3;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}n.lens[Y[n.have++]]=h&7,h>>>=3,m-=3}for(;n.have<19;)n.lens[Y[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},B=Yg(ez,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,B){t.msg="invalid code lengths set",n.mode=Zr;break}n.have=0,n.mode=qR;case qR:for(;n.have<n.nlen+n.ndist;){for(;S=n.lencode[h&(1<<n.lenbits)-1],v=S>>>24,k=S>>>16&255,L=S&65535,!(v<=m);){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(L<16)h>>>=v,m-=v,n.lens[n.have++]=L;else{if(L===16){for(A=v+2;m<A;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(h>>>=v,m-=v,n.have===0){t.msg="invalid bit length repeat",n.mode=Zr;break}G=n.lens[n.have-1],g=3+(h&3),h>>>=2,m-=2}else if(L===17){for(A=v+3;m<A;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}h>>>=v,m-=v,G=0,g=3+(h&7),h>>>=3,m-=3}else{for(A=v+7;m<A;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}h>>>=v,m-=v,G=0,g=11+(h&127),h>>>=7,m-=7}if(n.have+g>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Zr;break}for(;g--;)n.lens[n.have++]=G}}if(n.mode===Zr)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=Zr;break}if(n.lenbits=9,E={bits:n.lenbits},B=Yg(q4,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,B){t.msg="invalid literal/lengths set",n.mode=Zr;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},B=Yg(X4,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,B){t.msg="invalid distances set",n.mode=Zr;break}if(n.mode=sp,e===tp)break e;case sp:n.mode=np;case np:if(c>=6&&u>=258){t.next_out=o,t.avail_out=u,t.next_in=a,t.avail_in=c,n.hold=h,n.bits=m,z$(t,p),o=t.next_out,i=t.output,u=t.avail_out,a=t.next_in,r=t.input,c=t.avail_in,h=n.hold,m=n.bits,n.mode===cd&&(n.back=-1);break}for(n.back=0;S=n.lencode[h&(1<<n.lenbits)-1],v=S>>>24,k=S>>>16&255,L=S&65535,!(v<=m);){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(k&&(k&240)===0){for(M=v,P=k,F=L;S=n.lencode[F+((h&(1<<M+P)-1)>>M)],v=S>>>24,k=S>>>16&255,L=S&65535,!(M+v<=m);){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}h>>>=M,m-=M,n.back+=M}if(h>>>=v,m-=v,n.back+=v,n.length=L,k===0){n.mode=tT;break}if(k&32){n.back=-1,n.mode=cd;break}if(k&64){t.msg="invalid literal/length code",n.mode=Zr;break}n.extra=k&15,n.mode=XR;case XR:if(n.extra){for(A=n.extra;m<A;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,m-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=JR;case JR:for(;S=n.distcode[h&(1<<n.distbits)-1],v=S>>>24,k=S>>>16&255,L=S&65535,!(v<=m);){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if((k&240)===0){for(M=v,P=k,F=L;S=n.distcode[F+((h&(1<<M+P)-1)>>M)],v=S>>>24,k=S>>>16&255,L=S&65535,!(M+v<=m);){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}h>>>=M,m-=M,n.back+=M}if(h>>>=v,m-=v,n.back+=v,k&64){t.msg="invalid distance code",n.mode=Zr;break}n.offset=L,n.extra=k&15,n.mode=ZR;case ZR:if(n.extra){for(A=n.extra;m<A;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,m-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Zr;break}n.mode=eT;case eT:if(u===0)break e;if(g=p-u,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Zr;break}g>n.wnext?(g-=n.wnext,C=n.wsize-g):C=n.wnext-g,g>n.length&&(g=n.length),y=n.window}else y=i,C=o-n.offset,g=n.length;g>u&&(g=u),u-=g,n.length-=g;do i[o++]=y[C++];while(--g);n.length===0&&(n.mode=np);break;case tT:if(u===0)break e;i[o++]=n.length,u--,n.mode=np;break;case fC:if(n.wrap){for(;m<32;){if(c===0)break e;c--,h|=r[a++]<<m,m+=8}if(p-=u,t.total_out+=p,n.total+=p,n.wrap&4&&p&&(t.adler=n.check=n.flags?Nc(n.check,i,p,o-p):L2(n.check,i,p,o-p)),p=u,n.wrap&4&&(n.flags?h:rT(h))!==n.check){t.msg="incorrect data check",n.mode=Zr;break}h=0,m=0}n.mode=sT;case sT:if(n.wrap&&n.flags){for(;m<32;){if(c===0)break e;c--,h+=r[a++]<<m,m+=8}if(n.wrap&4&&h!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=Zr;break}h=0,m=0}n.mode=nT;case nT:B=sz;break e;case Zr:B=J4;break e;case eO:return Z4;case tO:default:return bo}return t.next_out=o,t.avail_out=u,t.next_in=a,t.avail_in=c,n.hold=h,n.bits=m,(n.wsize||p!==t.avail_out&&n.mode<Zr&&(n.mode<fC||e!==PR))&&aO(t,t.output,t.next_out,p-t.avail_out),_-=t.avail_in,p-=t.avail_out,t.total_in+=_,t.total_out+=p,n.total+=p,n.wrap&4&&p&&(t.adler=n.check=n.flags?Nc(n.check,i,p,t.next_out-p):L2(n.check,i,p,t.next_out-p)),t.data_type=n.bits+(n.last?64:0)+(n.mode===cd?128:0)+(n.mode===sp||n.mode===hC?256:0),(_===0&&p===0||e===PR)&&B===s0&&(B=rz),B},fz=t=>{if(_0(t))return bo;let e=t.state;return e.window&&(e.window=null),t.state=null,s0},mz=(t,e)=>{if(_0(t))return bo;const n=t.state;return(n.wrap&2)===0?bo:(n.head=e,e.done=!1,s0)},gz=(t,e)=>{const n=e.length;let r,i,a;return _0(t)||(r=t.state,r.wrap!==0&&r.mode!==p1)?bo:r.mode===p1&&(i=1,i=L2(i,e,n,0),i!==r.check)?J4:(a=aO(t,e,n,n),a?(r.mode=eO,Z4):(r.havedict=1,s0))};var _z=nO,xz=rO,pz=sO,yz=dz,bz=iO,Cz=hz,Nz=fz,Sz=mz,vz=gz,Ez="pako inflate (from Nodeca project)",md={inflateReset:_z,inflateReset2:xz,inflateResetKeep:pz,inflateInit:yz,inflateInit2:bz,inflate:Cz,inflateEnd:Nz,inflateGetHeader:Sz,inflateSetDictionary:vz,inflateInfo:Ez};function Dz(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Rz=Dz;const lO=Object.prototype.toString,{Z_NO_FLUSH:Tz,Z_FINISH:Mz,Z_OK:u_,Z_STREAM_END:_C,Z_NEED_DICT:xC,Z_STREAM_ERROR:Iz,Z_DATA_ERROR:aT,Z_MEM_ERROR:jz}=$4;function A_(t){this.options=z4.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new V$,this.strm.avail_out=0;let n=md.inflateInit2(this.strm,e.windowBits);if(n!==u_)throw new Error(P2[n]);if(this.header=new Rz,md.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=A2.string2buf(e.dictionary):lO.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=md.inflateSetDictionary(this.strm,e.dictionary),n!==u_)))throw new Error(P2[n])}A_.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,c;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?Mz:Tz,lO.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=md.inflate(n,o),a===xC&&i&&(a=md.inflateSetDictionary(n,i),a===u_?a=md.inflate(n,o):a===aT&&(a=xC));n.avail_in>0&&a===_C&&n.state.wrap>0&&t[n.next_in]!==0;)md.inflateReset(n),a=md.inflate(n,o);switch(a){case Iz:case aT:case xC:case jz:return this.onEnd(a),this.ended=!0,!1}if(c=n.avail_out,n.next_out&&(n.avail_out===0||a===_C))if(this.options.to==="string"){let u=A2.utf8border(n.output,n.next_out),h=n.next_out-u,m=A2.buf2string(n.output,u);n.next_out=h,n.avail_out=r-h,h&&n.output.set(n.output.subarray(u,u+h),0),this.onData(m)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===u_&&c===0)){if(a===_C)return a=md.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};A_.prototype.onData=function(t){this.chunks.push(t)};A_.prototype.onEnd=function(t){t===u_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=z4.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Oz(t,e){const n=new A_(e);if(n.push(t),n.err)throw n.msg||P2[n.err];return n.result}var wz=A_,Lz=Oz,Pz={Inflate:wz,inflate:Lz};const{Inflate:Az,inflate:kz}=Pz;var lT=Az,Uz=kz;const oO=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;oO[t]=e}const oT=4294967295;function Bz(t,e,n){let r=t;for(let i=0;i<n;i++)r=oO[(r^e[i])&255]^r>>>8;return r}function Gz(t,e){return(Bz(oT,t,e)^oT)>>>0}function cT(t,e,n){const r=t.readUint32(),i=Gz(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${i}`)}function cO(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function dO(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function uO(t,e,n,r){let i=0;if(n.length===0)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function hO(t,e,n,r,i){let a=0;if(n.length===0){for(;a<i;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(n[a]>>1)&255;for(;a<r;a++)e[a]=t[a]+(e[a-i]+n[a]>>1)&255}}function fO(t,e,n,r,i){let a=0;if(n.length===0){for(;a<i;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+n[a]&255;for(;a<r;a++)e[a]=t[a]+Wz(e[a-i],n[a],n[a-i])&255}}function Wz(t,e,n){const r=t+e-n,i=Math.abs(r-t),a=Math.abs(r-e),o=Math.abs(r-n);return i<=a&&i<=o?t:a<=o?e:n}function Fz(t,e,n,r,i,a){switch(t){case 0:cO(e,n,i);break;case 1:dO(e,n,i,a);break;case 2:uO(e,n,r,i);break;case 3:hO(e,n,r,i,a);break;case 4:fO(e,n,r,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Kz=new Uint16Array([255]),Qz=new Uint8Array(Kz.buffer),Yz=Qz[0]===255;function Vz(t){const{data:e,width:n,height:r,channels:i,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(a/8)*i,u=new Uint8Array(r*n*c);let h=0;for(let m=0;m<7;m++){const _=o[m],p=Math.ceil((n-_.x)/_.xStep),g=Math.ceil((r-_.y)/_.yStep);if(p<=0||g<=0)continue;const C=p*c,y=new Uint8Array(C);for(let S=0;S<g;S++){const v=e[h++],k=e.subarray(h,h+C);h+=C;const L=new Uint8Array(C);Fz(v,k,L,y,C,c),y.set(L);for(let M=0;M<p;M++){const P=_.x+M*_.xStep,F=_.y+S*_.yStep;if(!(P>=n||F>=r))for(let G=0;G<c;G++)u[(F*n+P)*c+G]=L[M*c+G]}}}if(a===16){const m=new Uint16Array(u.buffer);if(Yz)for(let _=0;_<m.length;_++)m[_]=$z(m[_]);return m}else return u}function $z(t){return(t&255)<<8|t>>8&255}const zz=new Uint16Array([255]),Hz=new Uint8Array(zz.buffer),qz=Hz[0]===255,Xz=new Uint8Array(0);function dT(t){const{data:e,width:n,height:r,channels:i,depth:a}=t,o=Math.ceil(a/8)*i,c=Math.ceil(a/8*i*n),u=new Uint8Array(r*c);let h=Xz,m=0,_,p;for(let g=0;g<r;g++){switch(_=e.subarray(m+1,m+1+c),p=u.subarray(g*c,(g+1)*c),e[m]){case 0:cO(_,p,c);break;case 1:dO(_,p,c,o);break;case 2:uO(_,p,h,c);break;case 3:hO(_,p,h,c,o);break;case 4:fO(_,p,h,c,o);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}h=p,m+=c+1}if(a===16){const g=new Uint16Array(u.buffer);if(qz)for(let C=0;C<g.length;C++)g[C]=Jz(g[C]);return g}else return u}function Jz(t){return(t&255)<<8|t>>8&255}const Ep=Uint8Array.of(137,80,78,71,13,10,26,10);function uT(t){if(!Zz(t.readBytes(Ep.length)))throw new Error("wrong PNG signature")}function Zz(t){if(t.length<Ep.length)return!1;for(let e=0;e<Ep.length;e++)if(t[e]!==Ep[e])return!1;return!0}const eH="tEXt",tH=0,mO=new TextDecoder("latin1");function sH(t){if(rH(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const nH=/^[\u0000-\u00FF]*$/;function rH(t){if(!nH.test(t))throw new Error("invalid latin1 text")}function iH(t,e,n){const r=gO(e);t[r]=aH(e,n-r.length-1)}function gO(t){for(t.mark();t.readByte()!==tH;);const e=t.offset;t.reset();const n=mO.decode(t.readBytes(e-t.offset-1));return t.skip(1),sH(n),n}function aH(t,e){return mO.decode(t.readBytes(e))}const Gl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},pC={UNKNOWN:-1,DEFLATE:0},hT={UNKNOWN:-1,ADAPTIVE:0},yC={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},rp={NONE:0,BACKGROUND:1,PREVIOUS:2},bC={SOURCE:0,OVER:1};class lH extends _S{constructor(n,r={}){super(n);dr(this,"_checkCrc");dr(this,"_inflator");dr(this,"_png");dr(this,"_apng");dr(this,"_end");dr(this,"_hasPalette");dr(this,"_palette");dr(this,"_hasTransparency");dr(this,"_transparency");dr(this,"_compressionMethod");dr(this,"_filterMethod");dr(this,"_interlaceMethod");dr(this,"_colorType");dr(this,"_isAnimated");dr(this,"_numberOfFrames");dr(this,"_numberOfPlays");dr(this,"_frames");dr(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new lT,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=pC.UNKNOWN,this._filterMethod=hT.UNKNOWN,this._interlaceMethod=yC.UNKNOWN,this._colorType=Gl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(uT(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(uT(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case eH:iH(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?cT(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=i+n;break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?cT(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=oH(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case Gl.GREYSCALE:i=1;break;case Gl.TRUECOLOUR:i=3;break;case Gl.INDEXED_COLOUR:i=1;break;case Gl.GREYSCALE_ALPHA:i=2;break;case Gl.TRUECOLOUR_ALPHA:i=4;break;case Gl.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==pC.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const i=[];this._palette=i;for(let a=0;a<r;a++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case Gl.GREYSCALE:case Gl.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case Gl.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Gl.UNKNOWN:case Gl.GREYSCALE_ALPHA:case Gl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=gO(this),i=this.readUint8();if(i!==pC.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const a=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Uz(a)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:n,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(n);if(i){if(i.data=dT({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const a=this._apng.frames.at(n-1);this.disposeFrame(i,a,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,i){switch(n.disposeOp){case rp.NONE:break;case rp.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let o=0;o<this._png.width;o++){const c=(a*n.width+o)*this._png.channels;for(let u=0;u<this._png.channels;u++)i.data[c+u]=0}break;case rp.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const i=1<<this._png.depth,a=(o,c)=>{const u=((o+r.yOffset)*this._png.width+r.xOffset+c)*this._png.channels,h=(o*r.width+c)*this._png.channels;return{index:u,frameIndex:h}};switch(r.blendOp){case bC.SOURCE:for(let o=0;o<r.height;o++)for(let c=0;c<r.width;c++){const{index:u,frameIndex:h}=a(o,c);for(let m=0;m<this._png.channels;m++)n.data[u+m]=r.data[h+m]}break;case bC.OVER:for(let o=0;o<r.height;o++)for(let c=0;c<r.width;c++){const{index:u,frameIndex:h}=a(o,c);for(let m=0;m<this._png.channels;m++){const _=r.data[h+this._png.channels-1]/i,p=m%(this._png.channels-1)===0?1:r.data[h+m],g=Math.floor(_*p+(1-_)*n.data[u+m]);n.data[u+m]+=g}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==hT.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===yC.NO_INTERLACE)this._png.data=dT({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===yC.ADAM7)this._png.data=Vz({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:rp.NONE,blendOp:bC.SOURCE,data:n}),this._inflator=new lT,this._writingDataChunks=!1}}function oH(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var fT;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(fT||(fT={}));function cH(t,e){return new lH(t,e).decode()}var yn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function CC(){yn.console&&typeof yn.console.log=="function"&&yn.console.log.apply(yn.console,arguments)}var Lr={log:CC,warn:function(t){yn.console&&(typeof yn.console.warn=="function"?yn.console.warn.apply(yn.console,arguments):CC.call(null,arguments))},error:function(t){yn.console&&(typeof yn.console.error=="function"?yn.console.error.apply(yn.console,arguments):CC(t))}};function NC(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Dh(r.response,e,n)},r.onerror=function(){Lr.error("could not download file")},r.send()}function mT(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function ip(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Dh=yn.saveAs||((typeof window>"u"?"undefined":Nr(window))!=="object"||window!==yn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=yn.URL||yn.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?mT(i.href)?NC(t,e,n):ip(i,i.target="_blank"):ip(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){ip(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(mT(t))NC(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){ip(r)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:Nr(a)!=="object"&&(Lr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return NC(t,e,n);var i=t.type==="application/octet-stream",a=/constructor/i.test(yn.HTMLElement)||yn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":Nr(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=o?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=m:location=m,r=null},c.readAsDataURL(t)}else{var u=yn.URL||yn.webkitURL,h=u.createObjectURL(t);r?r.location=h:location.href=h,r=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function _O(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,a=n[r].process,o=i.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+c+u+h}}var Dp=yn.atob.bind(yn),gT=yn.btoa.bind(yn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function SC(t,e){var n=t[0],r=t[1],i=t[2],a=t[3];n=Oa(n,r,i,a,e[0],7,-680876936),a=Oa(a,n,r,i,e[1],12,-389564586),i=Oa(i,a,n,r,e[2],17,606105819),r=Oa(r,i,a,n,e[3],22,-1044525330),n=Oa(n,r,i,a,e[4],7,-176418897),a=Oa(a,n,r,i,e[5],12,1200080426),i=Oa(i,a,n,r,e[6],17,-1473231341),r=Oa(r,i,a,n,e[7],22,-45705983),n=Oa(n,r,i,a,e[8],7,1770035416),a=Oa(a,n,r,i,e[9],12,-1958414417),i=Oa(i,a,n,r,e[10],17,-42063),r=Oa(r,i,a,n,e[11],22,-1990404162),n=Oa(n,r,i,a,e[12],7,1804603682),a=Oa(a,n,r,i,e[13],12,-40341101),i=Oa(i,a,n,r,e[14],17,-1502002290),n=wa(n,r=Oa(r,i,a,n,e[15],22,1236535329),i,a,e[1],5,-165796510),a=wa(a,n,r,i,e[6],9,-1069501632),i=wa(i,a,n,r,e[11],14,643717713),r=wa(r,i,a,n,e[0],20,-373897302),n=wa(n,r,i,a,e[5],5,-701558691),a=wa(a,n,r,i,e[10],9,38016083),i=wa(i,a,n,r,e[15],14,-660478335),r=wa(r,i,a,n,e[4],20,-405537848),n=wa(n,r,i,a,e[9],5,568446438),a=wa(a,n,r,i,e[14],9,-1019803690),i=wa(i,a,n,r,e[3],14,-187363961),r=wa(r,i,a,n,e[8],20,1163531501),n=wa(n,r,i,a,e[13],5,-1444681467),a=wa(a,n,r,i,e[2],9,-51403784),i=wa(i,a,n,r,e[7],14,1735328473),n=La(n,r=wa(r,i,a,n,e[12],20,-1926607734),i,a,e[5],4,-378558),a=La(a,n,r,i,e[8],11,-2022574463),i=La(i,a,n,r,e[11],16,1839030562),r=La(r,i,a,n,e[14],23,-35309556),n=La(n,r,i,a,e[1],4,-1530992060),a=La(a,n,r,i,e[4],11,1272893353),i=La(i,a,n,r,e[7],16,-155497632),r=La(r,i,a,n,e[10],23,-1094730640),n=La(n,r,i,a,e[13],4,681279174),a=La(a,n,r,i,e[0],11,-358537222),i=La(i,a,n,r,e[3],16,-722521979),r=La(r,i,a,n,e[6],23,76029189),n=La(n,r,i,a,e[9],4,-640364487),a=La(a,n,r,i,e[12],11,-421815835),i=La(i,a,n,r,e[15],16,530742520),n=Pa(n,r=La(r,i,a,n,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Pa(a,n,r,i,e[7],10,1126891415),i=Pa(i,a,n,r,e[14],15,-1416354905),r=Pa(r,i,a,n,e[5],21,-57434055),n=Pa(n,r,i,a,e[12],6,1700485571),a=Pa(a,n,r,i,e[3],10,-1894986606),i=Pa(i,a,n,r,e[10],15,-1051523),r=Pa(r,i,a,n,e[1],21,-2054922799),n=Pa(n,r,i,a,e[8],6,1873313359),a=Pa(a,n,r,i,e[15],10,-30611744),i=Pa(i,a,n,r,e[6],15,-1560198380),r=Pa(r,i,a,n,e[13],21,1309151649),n=Pa(n,r,i,a,e[4],6,-145523070),a=Pa(a,n,r,i,e[11],10,-1120210379),i=Pa(i,a,n,r,e[2],15,718787259),r=Pa(r,i,a,n,e[9],21,-343485551),t[0]=Uu(n,t[0]),t[1]=Uu(r,t[1]),t[2]=Uu(i,t[2]),t[3]=Uu(a,t[3])}function ey(t,e,n,r,i,a){return e=Uu(Uu(e,t),Uu(r,a)),Uu(e<<i|e>>>32-i,n)}function Oa(t,e,n,r,i,a,o){return ey(e&n|~e&r,t,e,i,a,o)}function wa(t,e,n,r,i,a,o){return ey(e&r|n&~r,t,e,i,a,o)}function La(t,e,n,r,i,a,o){return ey(e^n^r,t,e,i,a,o)}function Pa(t,e,n,r,i,a,o){return ey(n^(e|~r),t,e,i,a,o)}function xO(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)SC(r,dH(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(SC(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,SC(r,i),r}function dH(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var _T="0123456789abcdef".split("");function uH(t){for(var e="",n=0;n<4;n++)e+=_T[t>>8*n+4&15]+_T[t>>8*n&15];return e}function hH(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function k2(t){return xO(t).map(hH).join("")}var fH=(function(t){for(var e=0;e<t.length;e++)t[e]=uH(t[e]);return t.join("")})(xO("hello"))!="5d41402abc4b2a76b9719d911017c592";function Uu(t,e){if(fH){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function U2(t,e){var n,r,i,a;if(t!==n){for(var o=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),c=[],u=0;u<256;u++)c[u]=u;var h=0;for(u=0;u<256;u++){var m=c[u];h=(h+m+o.charCodeAt(u))%256,c[u]=c[h],c[h]=m}n=t,r=c}else c=r;var _=e.length,p=0,g=0,C="";for(u=0;u<_;u++)g=(g+(m=c[p=(p+1)%256]))%256,c[p]=c[g],c[g]=m,o=c[(c[p]+c[g])%256],C+=String.fromCharCode(e.charCodeAt(u)^o);return C}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var xT={print:4,modify:8,copy:16,"annot-forms":32};function Nf(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(c){if(xT.perm!==void 0)throw new Error("Invalid permission: "+c);i+=xT[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=k2(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=U2(this.encryptionKey,this.padding)}function Sf(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function pT(t){if(Nr(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var a=Math.random().toString(35);return e[n][a]=[r,!!i],a},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[n]){var o=e[n][a];try{o[0].apply(t,r)}catch(c){yn.console&&Lr.error("jsPDF PubSub Error",c.message,c)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function y1(t){if(!(this instanceof y1))return new y1(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function pO(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Th(t,e,n,r,i){if(!(this instanceof Th))return new Th(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,pO.call(this,r,i)}function If(t,e,n,r,i){if(!(this instanceof If))return new If(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,pO.call(this,r,i)}function nn(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],a=arguments[3],o=[],c=1,u=16,h="S",m=null;Nr(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,a=t.compress||t.compressPdf||a,(m=t.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),h=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var _=t.putOnlyUsedFonts||!1,p={},g={internal:{},__private__:{}};g.__private__.PubSub=pT;var C="1.3",y=g.__private__.getPdfVersion=function(){return C};g.__private__.setPdfVersion=function(W){C=W};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return S};var v=g.__private__.getPageFormat=function(W){return S[W]};i=i||"a4";var k="compat",L="advanced",M=k;function P(){this.saveGraphicsState(),Z(new Pe(at,0,0,-at,0,So()*at).toString()+" cm"),this.setFontSize(this.getFontSize()/at),h="n",M=L}function F(){this.restoreGraphicsState(),h="S",M=k}var G=g.__private__.combineFontStyleAndFontWeight=function(W,Ce){if(W=="bold"&&Ce=="normal"||W=="bold"&&Ce==400||W=="normal"&&Ce=="italic"||W=="bold"&&Ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ce&&(W=Ce==400||Ce==="normal"?W==="italic"?"italic":"normal":Ce!=700&&Ce!=="bold"||W!=="normal"?(Ce==700?"bold":Ce)+""+W:"bold"),W};g.advancedAPI=function(W){var Ce=M===k;return Ce&&P.call(this),typeof W!="function"||(W(this),Ce&&F.call(this)),this},g.compatAPI=function(W){var Ce=M===L;return Ce&&F.call(this),typeof W!="function"||(W(this),Ce&&P.call(this)),this},g.isAdvancedAPI=function(){return M===L};var B,I=function(W){if(M!==L)throw new Error(W+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},E=g.roundToPrecision=g.__private__.roundToPrecision=function(W,Ce){var Ze=e||Ce;if(isNaN(W)||isNaN(Ze))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return W.toFixed(Ze).replace(/0+$/,"")};B=g.hpf=g.__private__.hpf=typeof u=="number"?function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return E(W,u)}:u==="smart"?function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return E(W,W>-1&&W<1?16:5)}:function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return E(W,16)};var A=g.f2=g.__private__.f2=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.f2");return E(W,2)},Y=g.__private__.f3=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.f3");return E(W,3)},ee=g.scale=g.__private__.scale=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.scale");return M===k?W*at:M===L?W:void 0},J=function(W){return ee((function(Ce){return M===k?So()-Ce:M===L?Ce:void 0})(W))};g.__private__.setPrecision=g.setPrecision=function(W){typeof parseInt(W,10)=="number"&&(e=parseInt(W,10))};var H,V="00000000000000000000000000000000",K=g.__private__.getFileId=function(){return V},j=g.__private__.setFileId=function(W){return V=W!==void 0&&/^[a-fA-F0-9]{32}$/.test(W)?W.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Us=new Nf(m.userPermissions,m.userPassword,m.ownerPassword,V)),V};g.setFileId=function(W){return j(W),this},g.getFileId=function(){return K()};var te=g.__private__.convertDateToPDFDate=function(W){var Ce=W.getTimezoneOffset(),Ze=Ce<0?"+":"-",Ct=Math.floor(Math.abs(Ce/60)),Ot=Math.abs(Ce%60),rs=[Ze,Q(Ct),"'",Q(Ot),"'"].join("");return["D:",W.getFullYear(),Q(W.getMonth()+1),Q(W.getDate()),Q(W.getHours()),Q(W.getMinutes()),Q(W.getSeconds()),rs].join("")},ce=g.__private__.convertPDFDateToDate=function(W){var Ce=parseInt(W.substr(2,4),10),Ze=parseInt(W.substr(6,2),10)-1,Ct=parseInt(W.substr(8,2),10),Ot=parseInt(W.substr(10,2),10),rs=parseInt(W.substr(12,2),10),gs=parseInt(W.substr(14,2),10);return new Date(Ce,Ze,Ct,Ot,rs,gs,0)},R=g.__private__.setCreationDate=function(W){var Ce;if(W===void 0&&(W=new Date),W instanceof Date)Ce=te(W);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(W))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ce=W}return H=Ce},O=g.__private__.getCreationDate=function(W){var Ce=H;return W==="jsDate"&&(Ce=ce(H)),Ce};g.setCreationDate=function(W){return R(W),this},g.getCreationDate=function(W){return O(W)};var U,Q=g.__private__.padd2=function(W){return("0"+parseInt(W)).slice(-2)},q=g.__private__.padd2Hex=function(W){return("00"+(W=W.toString())).substr(W.length)},$=0,de=[],ae=[],_e=0,ie=[],Ne=[],X=!1,xe=ae;g.__private__.setCustomOutputDestination=function(W){X=!0,xe=W};var fe=function(W){X||(xe=W)};g.__private__.resetCustomOutputDestination=function(){X=!1,xe=ae};var Z=g.__private__.out=function(W){return W=W.toString(),_e+=W.length+1,xe.push(W),xe},le=g.__private__.write=function(W){return Z(arguments.length===1?W.toString():Array.prototype.join.call(arguments," "))},se=g.__private__.getArrayBuffer=function(W){for(var Ce=W.length,Ze=new ArrayBuffer(Ce),Ct=new Uint8Array(Ze);Ce--;)Ct[Ce]=W.charCodeAt(Ce);return Ze},Re=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return Re};var be=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(W){return be=M===L?W/at:W,this};var De,re=g.__private__.getFontSize=g.getFontSize=function(){return M===k?be:be*at},me=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(W){return me=W,this},g.__private__.getR2L=g.getR2L=function(){return me};var ve,et=g.__private__.setZoomMode=function(W){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(W))De=W;else if(isNaN(W)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(W)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+W+'" is not recognized.');De=W}else De=parseInt(W,10)};g.__private__.getZoomMode=function(){return De};var Dt,ot=g.__private__.setPageMode=function(W){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(W)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+W+'" is not recognized.');ve=W};g.__private__.getPageMode=function(){return ve};var At=g.__private__.setLayoutMode=function(W){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(W)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+W+'" is not recognized.');Dt=W};g.__private__.getLayoutMode=function(){return Dt},g.__private__.setDisplayMode=g.setDisplayMode=function(W,Ce,Ze){return et(W),At(Ce),ot(Ze),this};var ct={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(W){if(Object.keys(ct).indexOf(W)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ct[W]},g.__private__.getDocumentProperties=function(){return ct},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(W){for(var Ce in ct)ct.hasOwnProperty(Ce)&&W[Ce]&&(ct[Ce]=W[Ce]);return this},g.__private__.setDocumentProperty=function(W,Ce){if(Object.keys(ct).indexOf(W)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ct[W]=Ce};var Ge,at,xt,mt,Ve,it={},Fe={},nt=[],lt={},Mt={},ut={},qe={},Ee=null,Ye=0,pe=[],ge=new pT(g),Be=t.hotfixes||[],ue={},we={},Je=[],Pe=function W(Ce,Ze,Ct,Ot,rs,gs){if(!(this instanceof W))return new W(Ce,Ze,Ct,Ot,rs,gs);isNaN(Ce)&&(Ce=1),isNaN(Ze)&&(Ze=0),isNaN(Ct)&&(Ct=0),isNaN(Ot)&&(Ot=1),isNaN(rs)&&(rs=0),isNaN(gs)&&(gs=0),this._matrix=[Ce,Ze,Ct,Ot,rs,gs]};Object.defineProperty(Pe.prototype,"sx",{get:function(){return this._matrix[0]},set:function(W){this._matrix[0]=W}}),Object.defineProperty(Pe.prototype,"shy",{get:function(){return this._matrix[1]},set:function(W){this._matrix[1]=W}}),Object.defineProperty(Pe.prototype,"shx",{get:function(){return this._matrix[2]},set:function(W){this._matrix[2]=W}}),Object.defineProperty(Pe.prototype,"sy",{get:function(){return this._matrix[3]},set:function(W){this._matrix[3]=W}}),Object.defineProperty(Pe.prototype,"tx",{get:function(){return this._matrix[4]},set:function(W){this._matrix[4]=W}}),Object.defineProperty(Pe.prototype,"ty",{get:function(){return this._matrix[5]},set:function(W){this._matrix[5]=W}}),Object.defineProperty(Pe.prototype,"a",{get:function(){return this._matrix[0]},set:function(W){this._matrix[0]=W}}),Object.defineProperty(Pe.prototype,"b",{get:function(){return this._matrix[1]},set:function(W){this._matrix[1]=W}}),Object.defineProperty(Pe.prototype,"c",{get:function(){return this._matrix[2]},set:function(W){this._matrix[2]=W}}),Object.defineProperty(Pe.prototype,"d",{get:function(){return this._matrix[3]},set:function(W){this._matrix[3]=W}}),Object.defineProperty(Pe.prototype,"e",{get:function(){return this._matrix[4]},set:function(W){this._matrix[4]=W}}),Object.defineProperty(Pe.prototype,"f",{get:function(){return this._matrix[5]},set:function(W){this._matrix[5]=W}}),Object.defineProperty(Pe.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Pe.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Pe.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Pe.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Pe.prototype.join=function(W){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(W)},Pe.prototype.multiply=function(W){var Ce=W.sx*this.sx+W.shy*this.shx,Ze=W.sx*this.shy+W.shy*this.sy,Ct=W.shx*this.sx+W.sy*this.shx,Ot=W.shx*this.shy+W.sy*this.sy,rs=W.tx*this.sx+W.ty*this.shx+this.tx,gs=W.tx*this.shy+W.ty*this.sy+this.ty;return new Pe(Ce,Ze,Ct,Ot,rs,gs)},Pe.prototype.decompose=function(){var W=this.sx,Ce=this.shy,Ze=this.shx,Ct=this.sy,Ot=this.tx,rs=this.ty,gs=Math.sqrt(W*W+Ce*Ce),zs=(W/=gs)*Ze+(Ce/=gs)*Ct;Ze-=W*zs,Ct-=Ce*zs;var en=Math.sqrt(Ze*Ze+Ct*Ct);return zs/=en,W*(Ct/=en)<Ce*(Ze/=en)&&(W=-W,Ce=-Ce,zs=-zs,gs=-gs),{scale:new Pe(gs,0,0,en,0,0),translate:new Pe(1,0,0,1,Ot,rs),rotate:new Pe(W,Ce,-Ce,W,0,0),skew:new Pe(1,0,zs,1,0,0)}},Pe.prototype.toString=function(W){return this.join(" ")},Pe.prototype.inversed=function(){var W=this.sx,Ce=this.shy,Ze=this.shx,Ct=this.sy,Ot=this.tx,rs=this.ty,gs=1/(W*Ct-Ce*Ze),zs=Ct*gs,en=-Ce*gs,mn=-Ze*gs,Cn=W*gs;return new Pe(zs,en,mn,Cn,-zs*Ot-mn*rs,-en*Ot-Cn*rs)},Pe.prototype.applyToPoint=function(W){var Ce=W.x*this.sx+W.y*this.shx+this.tx,Ze=W.x*this.shy+W.y*this.sy+this.ty;return new Vn(Ce,Ze)},Pe.prototype.applyToRectangle=function(W){var Ce=this.applyToPoint(W),Ze=this.applyToPoint(new Vn(W.x+W.w,W.y+W.h));return new si(Ce.x,Ce.y,Ze.x-Ce.x,Ze.y-Ce.y)},Pe.prototype.clone=function(){var W=this.sx,Ce=this.shy,Ze=this.shx,Ct=this.sy,Ot=this.tx,rs=this.ty;return new Pe(W,Ce,Ze,Ct,Ot,rs)},g.Matrix=Pe;var Nt=g.matrixMult=function(W,Ce){return Ce.multiply(W)},Oe=new Pe(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Oe;var dt=function(W,Ce){if(!Mt[W]){var Ze=(Ce instanceof Th?"Sh":"P")+(Object.keys(lt).length+1).toString(10);Ce.id=Ze,Mt[W]=Ze,lt[Ze]=Ce,ge.publish("addPattern",Ce)}};g.ShadingPattern=Th,g.TilingPattern=If,g.addShadingPattern=function(W,Ce){return I("addShadingPattern()"),dt(W,Ce),this},g.beginTilingPattern=function(W){I("beginTilingPattern()"),No(W.boundingBox[0],W.boundingBox[1],W.boundingBox[2]-W.boundingBox[0],W.boundingBox[3]-W.boundingBox[1],W.matrix)},g.endTilingPattern=function(W,Ce){I("endTilingPattern()"),Ce.stream=Ne[U].join(`
`),dt(W,Ce),ge.publish("endTilingPattern",Ce),Je.pop().restore()};var gt,It=g.__private__.newObject=function(){var W=$e();return $t(W,!0),W},$e=g.__private__.newObjectDeferred=function(){return $++,de[$]=function(){return _e},$},$t=function(W,Ce){return Ce=typeof Ce=="boolean"&&Ce,de[W]=_e,Ce&&Z(W+" 0 obj"),W},Ue=g.__private__.newAdditionalObject=function(){var W={objId:$e(),content:""};return ie.push(W),W},ss=$e(),ls=$e(),ds=g.__private__.decodeColorString=function(W){var Ce=W.split(" ");if(Ce.length!==2||Ce[1]!=="g"&&Ce[1]!=="G")Ce.length!==5||Ce[4]!=="k"&&Ce[4]!=="K"||(Ce=[(1-Ce[0])*(1-Ce[3]),(1-Ce[1])*(1-Ce[3]),(1-Ce[2])*(1-Ce[3]),"r"]);else{var Ze=parseFloat(Ce[0]);Ce=[Ze,Ze,Ze,"r"]}for(var Ct="#",Ot=0;Ot<3;Ot++)Ct+=("0"+Math.floor(255*parseFloat(Ce[Ot])).toString(16)).slice(-2);return Ct},vs=g.__private__.encodeColorString=function(W){var Ce;typeof W=="string"&&(W={ch1:W});var Ze=W.ch1,Ct=W.ch2,Ot=W.ch3,rs=W.ch4,gs=W.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ze=="string"&&Ze.charAt(0)!=="#"){var zs=new _O(Ze);if(zs.ok)Ze=zs.toHex();else if(!/^\d*\.?\d*$/.test(Ze))throw new Error('Invalid color "'+Ze+'" passed to jsPDF.encodeColorString.')}if(typeof Ze=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ze)&&(Ze="#"+Ze[1]+Ze[1]+Ze[2]+Ze[2]+Ze[3]+Ze[3]),typeof Ze=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ze)){var en=parseInt(Ze.substr(1),16);Ze=en>>16&255,Ct=en>>8&255,Ot=255&en}if(Ct===void 0||rs===void 0&&Ze===Ct&&Ct===Ot)Ce=typeof Ze=="string"?Ze+" "+gs[0]:W.precision===2?A(Ze/255)+" "+gs[0]:Y(Ze/255)+" "+gs[0];else if(rs===void 0||Nr(rs)==="object"){if(rs&&!isNaN(rs.a)&&rs.a===0)return["1.","1.","1.",gs[1]].join(" ");Ce=typeof Ze=="string"?[Ze,Ct,Ot,gs[1]].join(" "):W.precision===2?[A(Ze/255),A(Ct/255),A(Ot/255),gs[1]].join(" "):[Y(Ze/255),Y(Ct/255),Y(Ot/255),gs[1]].join(" ")}else Ce=typeof Ze=="string"?[Ze,Ct,Ot,rs,gs[2]].join(" "):W.precision===2?[A(Ze),A(Ct),A(Ot),A(rs),gs[2]].join(" "):[Y(Ze),Y(Ct),Y(Ot),Y(rs),gs[2]].join(" ");return Ce},Ss=g.__private__.getFilters=function(){return o},ke=g.__private__.putStream=function(W){var Ce=(W=W||{}).data||"",Ze=W.filters||Ss(),Ct=W.alreadyAppliedFilters||[],Ot=W.addLength1||!1,rs=Ce.length,gs=W.objectId,zs=function(Ci){return Ci};if(m!==null&&gs===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(zs=Us.encryptor(gs,0));var en={};Ze===!0&&(Ze=["FlateEncode"]);var mn=W.additionalKeyValues||[],Cn=(en=nn.API.processDataByFilters!==void 0?nn.API.processDataByFilters(Ce,Ze):{data:Ce,reverseChain:[]}).reverseChain+(Array.isArray(Ct)?Ct.join(" "):Ct.toString());if(en.data.length!==0&&(mn.push({key:"Length",value:en.data.length}),Ot===!0&&mn.push({key:"Length1",value:rs})),Cn.length!=0)if(Cn.split("/").length-1==1)mn.push({key:"Filter",value:Cn});else{mn.push({key:"Filter",value:"["+Cn+"]"});for(var Fn=0;Fn<mn.length;Fn+=1)if(mn[Fn].key==="DecodeParms"){for(var Gr=[],ni=0;ni<en.reverseChain.split("/").length-1;ni+=1)Gr.push("null");Gr.push(mn[Fn].value),mn[Fn].value="["+Gr.join(" ")+"]"}}Z("<<");for(var Sr=0;Sr<mn.length;Sr++)Z("/"+mn[Sr].key+" "+mn[Sr].value);Z(">>"),en.data.length!==0&&(Z("stream"),Z(zs(en.data)),Z("endstream"))},ft=g.__private__.putPage=function(W){var Ce=W.number,Ze=W.data,Ct=W.objId,Ot=W.contentsObjId;$t(Ct,!0),Z("<</Type /Page"),Z("/Parent "+W.rootDictionaryObjId+" 0 R"),Z("/Resources "+W.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(B(W.mediaBox.bottomLeftX))+" "+parseFloat(B(W.mediaBox.bottomLeftY))+" "+B(W.mediaBox.topRightX)+" "+B(W.mediaBox.topRightY)+"]"),W.cropBox!==null&&Z("/CropBox ["+B(W.cropBox.bottomLeftX)+" "+B(W.cropBox.bottomLeftY)+" "+B(W.cropBox.topRightX)+" "+B(W.cropBox.topRightY)+"]"),W.bleedBox!==null&&Z("/BleedBox ["+B(W.bleedBox.bottomLeftX)+" "+B(W.bleedBox.bottomLeftY)+" "+B(W.bleedBox.topRightX)+" "+B(W.bleedBox.topRightY)+"]"),W.trimBox!==null&&Z("/TrimBox ["+B(W.trimBox.bottomLeftX)+" "+B(W.trimBox.bottomLeftY)+" "+B(W.trimBox.topRightX)+" "+B(W.trimBox.topRightY)+"]"),W.artBox!==null&&Z("/ArtBox ["+B(W.artBox.bottomLeftX)+" "+B(W.artBox.bottomLeftY)+" "+B(W.artBox.topRightX)+" "+B(W.artBox.topRightY)+"]"),typeof W.userUnit=="number"&&W.userUnit!==1&&Z("/UserUnit "+W.userUnit),ge.publish("putPage",{objId:Ct,pageContext:pe[Ce],pageNumber:Ce,page:Ze}),Z("/Contents "+Ot+" 0 R"),Z(">>"),Z("endobj");var rs=Ze.join(`
`);return M===L&&(rs+=`
Q`),$t(Ot,!0),ke({data:rs,filters:Ss(),objectId:Ot}),Z("endobj"),Ct},st=g.__private__.putPages=function(){var W,Ce,Ze=[];for(W=1;W<=Ye;W++)pe[W].objId=$e(),pe[W].contentsObjId=$e();for(W=1;W<=Ye;W++)Ze.push(ft({number:W,data:Ne[W],objId:pe[W].objId,contentsObjId:pe[W].contentsObjId,mediaBox:pe[W].mediaBox,cropBox:pe[W].cropBox,bleedBox:pe[W].bleedBox,trimBox:pe[W].trimBox,artBox:pe[W].artBox,userUnit:pe[W].userUnit,rootDictionaryObjId:ss,resourceDictionaryObjId:ls}));$t(ss,!0),Z("<</Type /Pages");var Ct="/Kids [";for(Ce=0;Ce<Ye;Ce++)Ct+=Ze[Ce]+" 0 R ";Z(Ct+"]"),Z("/Count "+Ye),Z(">>"),Z("endobj"),ge.publish("postPutPages")},Ft=function(W){ge.publish("putFont",{font:W,out:Z,newObject:It,putStream:ke}),W.isAlreadyPutted!==!0&&(W.objectNumber=It(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Sf(W.postScriptName)),Z("/Subtype /Type1"),typeof W.encoding=="string"&&Z("/Encoding /"+W.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},_t=function(W){W.objectNumber=It();var Ce=[];Ce.push({key:"Type",value:"/XObject"}),Ce.push({key:"Subtype",value:"/Form"}),Ce.push({key:"BBox",value:"["+[B(W.x),B(W.y),B(W.x+W.width),B(W.y+W.height)].join(" ")+"]"}),Ce.push({key:"Matrix",value:"["+W.matrix.toString()+"]"});var Ze=W.pages[1].join(`
`);ke({data:Ze,additionalKeyValues:Ce,objectId:W.objectNumber}),Z("endobj")},qt=function(W,Ce){Ce||(Ce=21);var Ze=It(),Ct=(function(gs,zs){var en,mn=[],Cn=1/(zs-1);for(en=0;en<1;en+=Cn)mn.push(en);if(mn.push(1),gs[0].offset!=0){var Fn={offset:0,color:gs[0].color};gs.unshift(Fn)}if(gs[gs.length-1].offset!=1){var Gr={offset:1,color:gs[gs.length-1].color};gs.push(Gr)}for(var ni="",Sr=0,Ci=0;Ci<mn.length;Ci++){for(en=mn[Ci];en>gs[Sr+1].offset;)Sr++;var di=gs[Sr].offset,Gi=(en-di)/(gs[Sr+1].offset-di),vo=gs[Sr].color,jl=gs[Sr+1].color;ni+=q(Math.round((1-Gi)*vo[0]+Gi*jl[0]).toString(16))+q(Math.round((1-Gi)*vo[1]+Gi*jl[1]).toString(16))+q(Math.round((1-Gi)*vo[2]+Gi*jl[2]).toString(16))}return ni.trim()})(W.colors,Ce),Ot=[];Ot.push({key:"FunctionType",value:"0"}),Ot.push({key:"Domain",value:"[0.0 1.0]"}),Ot.push({key:"Size",value:"["+Ce+"]"}),Ot.push({key:"BitsPerSample",value:"8"}),Ot.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ot.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ke({data:Ct,additionalKeyValues:Ot,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ze}),Z("endobj"),W.objectNumber=It(),Z("<< /ShadingType "+W.type),Z("/ColorSpace /DeviceRGB");var rs="/Coords ["+B(parseFloat(W.coords[0]))+" "+B(parseFloat(W.coords[1]))+" ";W.type===2?rs+=B(parseFloat(W.coords[2]))+" "+B(parseFloat(W.coords[3])):rs+=B(parseFloat(W.coords[2]))+" "+B(parseFloat(W.coords[3]))+" "+B(parseFloat(W.coords[4]))+" "+B(parseFloat(W.coords[5])),Z(rs+="]"),W.matrix&&Z("/Matrix ["+W.matrix.toString()+"]"),Z("/Function "+Ze+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},jt=function(W,Ce){var Ze=$e(),Ct=It();Ce.push({resourcesOid:Ze,objectOid:Ct}),W.objectNumber=Ct;var Ot=[];Ot.push({key:"Type",value:"/Pattern"}),Ot.push({key:"PatternType",value:"1"}),Ot.push({key:"PaintType",value:"1"}),Ot.push({key:"TilingType",value:"1"}),Ot.push({key:"BBox",value:"["+W.boundingBox.map(B).join(" ")+"]"}),Ot.push({key:"XStep",value:B(W.xStep)}),Ot.push({key:"YStep",value:B(W.yStep)}),Ot.push({key:"Resources",value:Ze+" 0 R"}),W.matrix&&Ot.push({key:"Matrix",value:"["+W.matrix.toString()+"]"}),ke({data:W.stream,additionalKeyValues:Ot,objectId:W.objectNumber}),Z("endobj")},he=function(W){for(var Ce in W.objectNumber=It(),Z("<<"),W)switch(Ce){case"opacity":Z("/ca "+A(W[Ce]));break;case"stroke-opacity":Z("/CA "+A(W[Ce]))}Z(">>"),Z("endobj")},ye=function(W){$t(W.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Ce in Z("/Font <<"),it)it.hasOwnProperty(Ce)&&(_===!1||_===!0&&p.hasOwnProperty(Ce))&&Z("/"+Ce+" "+it[Ce].objectNumber+" 0 R");Z(">>")})(),(function(){if(Object.keys(lt).length>0){for(var Ce in Z("/Shading <<"),lt)lt.hasOwnProperty(Ce)&&lt[Ce]instanceof Th&&lt[Ce].objectNumber>=0&&Z("/"+Ce+" "+lt[Ce].objectNumber+" 0 R");ge.publish("putShadingPatternDict"),Z(">>")}})(),(function(Ce){if(Object.keys(lt).length>0){for(var Ze in Z("/Pattern <<"),lt)lt.hasOwnProperty(Ze)&&lt[Ze]instanceof g.TilingPattern&&lt[Ze].objectNumber>=0&&lt[Ze].objectNumber<Ce&&Z("/"+Ze+" "+lt[Ze].objectNumber+" 0 R");ge.publish("putTilingPatternDict"),Z(">>")}})(W.objectOid),(function(){if(Object.keys(ut).length>0){var Ce;for(Ce in Z("/ExtGState <<"),ut)ut.hasOwnProperty(Ce)&&ut[Ce].objectNumber>=0&&Z("/"+Ce+" "+ut[Ce].objectNumber+" 0 R");ge.publish("putGStateDict"),Z(">>")}})(),(function(){for(var Ce in Z("/XObject <<"),ue)ue.hasOwnProperty(Ce)&&ue[Ce].objectNumber>=0&&Z("/"+Ce+" "+ue[Ce].objectNumber+" 0 R");ge.publish("putXobjectDict"),Z(">>")})(),Z(">>"),Z("endobj")},je=function(W){Fe[W.fontName]=Fe[W.fontName]||{},Fe[W.fontName][W.fontStyle]=W.id},Me=function(W,Ce,Ze,Ct,Ot){var rs={id:"F"+(Object.keys(it).length+1).toString(10),postScriptName:W,fontName:Ce,fontStyle:Ze,encoding:Ct,isStandardFont:Ot||!1,metadata:{}};return ge.publish("addFont",{font:rs,instance:this}),it[rs.id]=rs,je(rs),rs.id},tt=g.__private__.pdfEscape=g.pdfEscape=function(W,Ce){return(function(Ze,Ct){var Ot,rs,gs,zs,en,mn,Cn,Fn,Gr;if(gs=(Ct=Ct||{}).sourceEncoding||"Unicode",en=Ct.outputEncoding,(Ct.autoencode||en)&&it[Ge].metadata&&it[Ge].metadata[gs]&&it[Ge].metadata[gs].encoding&&(zs=it[Ge].metadata[gs].encoding,!en&&it[Ge].encoding&&(en=it[Ge].encoding),!en&&zs.codePages&&(en=zs.codePages[0]),typeof en=="string"&&(en=zs[en]),en)){for(Cn=!1,mn=[],Ot=0,rs=Ze.length;Ot<rs;Ot++)(Fn=en[Ze.charCodeAt(Ot)])?mn.push(String.fromCharCode(Fn)):mn.push(Ze[Ot]),mn[Ot].charCodeAt(0)>>8&&(Cn=!0);Ze=mn.join("")}for(Ot=Ze.length;Cn===void 0&&Ot!==0;)Ze.charCodeAt(Ot-1)>>8&&(Cn=!0),Ot--;if(!Cn)return Ze;for(mn=Ct.noBOM?[]:[254,255],Ot=0,rs=Ze.length;Ot<rs;Ot++){if((Gr=(Fn=Ze.charCodeAt(Ot))>>8)>>8)throw new Error("Character at position "+Ot+" of string '"+Ze+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");mn.push(Gr),mn.push(Fn-(Gr<<8))}return String.fromCharCode.apply(void 0,mn)})(W,Ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Te=g.__private__.beginPage=function(W){Ne[++Ye]=[],pe[Ye]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(W[0]),topRightY:Number(W[1])}},St(Ye),fe(Ne[U])},bt=function(W,Ce){var Ze,Ct,Ot;switch(n=Ce||n,typeof W=="string"&&(Ze=v(W.toLowerCase()),Array.isArray(Ze)&&(Ct=Ze[0],Ot=Ze[1])),Array.isArray(W)&&(Ct=W[0]*at,Ot=W[1]*at),isNaN(Ct)&&(Ct=i[0],Ot=i[1]),(Ct>14400||Ot>14400)&&(Lr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ct=Math.min(14400,Ct),Ot=Math.min(14400,Ot)),i=[Ct,Ot],n.substr(0,1)){case"l":Ot>Ct&&(i=[Ot,Ct]);break;case"p":Ct>Ot&&(i=[Ot,Ct])}Te(i),xs(Vs),Z($r),tl!==0&&Z(tl+" J"),Rs!==0&&Z(Rs+" j"),ge.publish("addPage",{pageNumber:Ye})},Ke=function(W){W>0&&W<=Ye&&(Ne.splice(W,1),pe.splice(W,1),Ye--,U>Ye&&(U=Ye),this.setPage(U))},St=function(W){W>0&&W<=Ye&&(U=W)},Et=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Ne.length-1},ze=function(W,Ce,Ze){var Ct,Ot=void 0;return Ze=Ze||{},W=W!==void 0?W:it[Ge].fontName,Ce=Ce!==void 0?Ce:it[Ge].fontStyle,Ct=W.toLowerCase(),Fe[Ct]!==void 0&&Fe[Ct][Ce]!==void 0?Ot=Fe[Ct][Ce]:Fe[W]!==void 0&&Fe[W][Ce]!==void 0?Ot=Fe[W][Ce]:Ze.disableWarning===!1&&Lr.warn("Unable to look up font label for font '"+W+"', '"+Ce+"'. Refer to getFontList() for available fonts."),Ot||Ze.noFallback||(Ot=Fe.times[Ce])==null&&(Ot=Fe.times.normal),Ot},ht=g.__private__.putInfo=function(){var W=It(),Ce=function(Ct){return Ct};for(var Ze in m!==null&&(Ce=Us.encryptor(W,0)),Z("<<"),Z("/Producer ("+tt(Ce("jsPDF "+nn.version))+")"),ct)ct.hasOwnProperty(Ze)&&ct[Ze]&&Z("/"+Ze.substr(0,1).toUpperCase()+Ze.substr(1)+" ("+tt(Ce(ct[Ze]))+")");Z("/CreationDate ("+tt(Ce(H))+")"),Z(">>"),Z("endobj")},Lt=g.__private__.putCatalog=function(W){var Ce=(W=W||{}).rootDictionaryObjId||ss;switch(It(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+Ce+" 0 R"),De||(De="fullwidth"),De){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ze=""+De;Ze.substr(Ze.length-1)==="%"&&(De=parseInt(De)/100),typeof De=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+A(De)+"]")}switch(Dt||(Dt="continuous"),Dt){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}ve&&Z("/PageMode /"+ve),ge.publish("putCatalog"),Z(">>"),Z("endobj")},Bt=g.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+($+1)),Z("/Root "+$+" 0 R"),Z("/Info "+($-1)+" 0 R"),m!==null&&Z("/Encrypt "+Us.oid+" 0 R"),Z("/ID [ <"+V+"> <"+V+"> ]"),Z(">>")},Yt=g.__private__.putHeader=function(){Z("%PDF-"+C),Z("%")},Xt=g.__private__.putXRef=function(){var W="0000000000";Z("xref"),Z("0 "+($+1)),Z("0000000000 65535 f ");for(var Ce=1;Ce<=$;Ce++)typeof de[Ce]=="function"?Z((W+de[Ce]()).slice(-10)+" 00000 n "):de[Ce]!==void 0?Z((W+de[Ce]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},ts=g.__private__.buildDocument=function(){var W;$=0,_e=0,ae=[],de=[],ie=[],ss=$e(),ls=$e(),fe(ae),ge.publish("buildDocument"),Yt(),st(),(function(){ge.publish("putAdditionalObjects");for(var Ze=0;Ze<ie.length;Ze++){var Ct=ie[Ze];$t(Ct.objId,!0),Z(Ct.content),Z("endobj")}ge.publish("postPutAdditionalObjects")})(),W=[],(function(){for(var Ze in it)it.hasOwnProperty(Ze)&&(_===!1||_===!0&&p.hasOwnProperty(Ze))&&Ft(it[Ze])})(),(function(){var Ze;for(Ze in ut)ut.hasOwnProperty(Ze)&&he(ut[Ze])})(),(function(){for(var Ze in ue)ue.hasOwnProperty(Ze)&&_t(ue[Ze])})(),(function(Ze){var Ct;for(Ct in lt)lt.hasOwnProperty(Ct)&&(lt[Ct]instanceof Th?qt(lt[Ct]):lt[Ct]instanceof If&&jt(lt[Ct],Ze))})(W),ge.publish("putResources"),W.forEach(ye),ye({resourcesOid:ls,objectOid:Number.MAX_SAFE_INTEGER}),ge.publish("postPutResources"),m!==null&&(Us.oid=It(),Z("<<"),Z("/Filter /Standard"),Z("/V "+Us.v),Z("/R "+Us.r),Z("/U <"+Us.toHexString(Us.U)+">"),Z("/O <"+Us.toHexString(Us.O)+">"),Z("/P "+Us.P),Z(">>"),Z("endobj")),ht(),Lt();var Ce=_e;return Xt(),Bt(),Z("startxref"),Z(""+Ce),Z("%%EOF"),fe(Ne[U]),ae.join(`
`)},Ut=g.__private__.getBlob=function(W){return new Blob([se(W)],{type:"application/pdf"})},Is=g.output=g.__private__.output=(gt=function(W,Ce){switch(typeof(Ce=Ce||{})=="string"?Ce={filename:Ce}:Ce.filename=Ce.filename||"generated.pdf",W){case void 0:return ts();case"save":g.save(Ce.filename);break;case"arraybuffer":return se(ts());case"blob":return Ut(ts());case"bloburi":case"bloburl":if(yn.URL!==void 0&&typeof yn.URL.createObjectURL=="function")return yn.URL&&yn.URL.createObjectURL(Ut(ts()))||void 0;Lr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ze="",Ct=ts();try{Ze=gT(Ct)}catch{Ze=gT(unescape(encodeURIComponent(Ct)))}return"data:application/pdf;filename="+Ce.filename+";base64,"+Ze;case"pdfobjectnewwindow":if(Object.prototype.toString.call(yn)==="[object Window]"){var Ot="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",rs=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ce.pdfObjectUrl&&(Ot=Ce.pdfObjectUrl,rs="");var gs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ot+'"'+rs+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ce)+");<\/script></body></html>",zs=yn.open();return zs!==null&&zs.document.write(gs),zs}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(yn)==="[object Window]"){var en='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ce.filename+'" width="500px" height="400px" /></body></html>',mn=yn.open();if(mn!==null){mn.document.write(en);var Cn=this;mn.document.documentElement.querySelector("#pdfViewer").onload=function(){mn.document.title=Ce.filename,mn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Cn.output("bloburl"))}}return mn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(yn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Fn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ce)+'"></iframe></body></html>',Gr=yn.open();if(Gr!==null&&(Gr.document.write(Fn),Gr.document.title=Ce.filename),Gr||typeof safari>"u")return Gr;break;case"datauri":case"dataurl":return yn.document.location.href=this.output("datauristring",Ce);default:return null}},gt.foo=function(){try{return gt.apply(this,arguments)}catch(Ze){var W=Ze.stack||"";~W.indexOf(" at ")&&(W=W.split(" at ")[1]);var Ce="Error in function "+W.split(`
`)[0].split("<")[0]+": "+Ze.message;if(!yn.console)throw new Error(Ce);yn.console.error(Ce,Ze),yn.alert&&alert(Ce)}},gt.foo.bar=gt,gt.foo),Cs=function(W){return Array.isArray(Be)===!0&&Be.indexOf(W)>-1};switch(r){case"pt":at=1;break;case"mm":at=72/25.4;break;case"cm":at=72/2.54;break;case"in":at=72;break;case"px":at=Cs("px_scaling")==1?.75:96/72;break;case"pc":case"em":at=12;break;case"ex":at=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);at=r}var Us=null;R(),j();var _s=g.__private__.getPageInfo=g.getPageInfo=function(W){if(isNaN(W)||W%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:pe[W].objId,pageNumber:W,pageContext:pe[W]}},Es=g.__private__.getPageInfoByObjId=function(W){if(isNaN(W)||W%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ce in pe)if(pe[Ce].objId===W)break;return _s(Ce)},Ls=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:pe[U].objId,pageNumber:U,pageContext:pe[U]}};g.addPage=function(){return bt.apply(this,arguments),this},g.setPage=function(){return St.apply(this,arguments),fe.call(this,Ne[U]),this},g.insertPage=function(W){return this.addPage(),this.movePage(U,W),this},g.movePage=function(W,Ce){var Ze,Ct;if(W>Ce){Ze=Ne[W],Ct=pe[W];for(var Ot=W;Ot>Ce;Ot--)Ne[Ot]=Ne[Ot-1],pe[Ot]=pe[Ot-1];Ne[Ce]=Ze,pe[Ce]=Ct,this.setPage(Ce)}else if(W<Ce){Ze=Ne[W],Ct=pe[W];for(var rs=W;rs<Ce;rs++)Ne[rs]=Ne[rs+1],pe[rs]=pe[rs+1];Ne[Ce]=Ze,pe[Ce]=Ct,this.setPage(Ce)}return this},g.deletePage=function(){return Ke.apply(this,arguments),this},g.__private__.text=g.text=function(W,Ce,Ze,Ct,Ot){var rs,gs,zs,en,mn,Cn,Fn,Gr,ni,Sr=(Ct=Ct||{}).scope||this;if(typeof W=="number"&&typeof Ce=="number"&&(typeof Ze=="string"||Array.isArray(Ze))){var Ci=Ze;Ze=Ce,Ce=W,W=Ci}if(arguments[3]instanceof Pe==0?(zs=arguments[4],en=arguments[5],Nr(Fn=arguments[3])==="object"&&Fn!==null||(typeof zs=="string"&&(en=zs,zs=null),typeof Fn=="string"&&(en=Fn,Fn=null),typeof Fn=="number"&&(zs=Fn,Fn=null),Ct={flags:Fn,angle:zs,align:en})):(I("The transform parameter of text() with a Matrix value"),ni=Ot),isNaN(Ce)||isNaN(Ze)||W==null)throw new Error("Invalid arguments passed to jsPDF.text");if(W.length===0)return Sr;var di,Gi="",vo=typeof Ct.lineHeightFactor=="number"?Ct.lineHeightFactor:Ws,jl=Sr.internal.scaleFactor;function Eo(Jn){return Jn=Jn.split("	").join(Array(Ct.TabLen||9).join(" ")),tt(Jn,Fn)}function eh(Jn){for(var Kn,vr=Jn.concat(),ii=[],ql=vr.length;ql--;)typeof(Kn=vr.shift())=="string"?ii.push(Kn):Array.isArray(Jn)&&(Kn.length===1||Kn[1]===void 0&&Kn[2]===void 0)?ii.push(Kn[0]):ii.push([Kn[0],Kn[1],Kn[2]]);return ii}function wd(Jn,Kn){var vr;if(typeof Jn=="string")vr=Kn(Jn)[0];else if(Array.isArray(Jn)){for(var ii,ql,Pl=Jn.concat(),Wc=[],nh=Pl.length;nh--;)typeof(ii=Pl.shift())=="string"?Wc.push(Kn(ii)[0]):Array.isArray(ii)&&typeof ii[0]=="string"&&(ql=Kn(ii[0],ii[1],ii[2]),Wc.push([ql[0],ql[1],ql[2]]));vr=Wc}return vr}var Kl=!1,Ol=!0;if(typeof W=="string")Kl=!0;else if(Array.isArray(W)){var Bc=W.concat();gs=[];for(var Do,Oi=Bc.length;Oi--;)(typeof(Do=Bc.shift())!="string"||Array.isArray(Do)&&typeof Do[0]!="string")&&(Ol=!1);Kl=Ol}if(Kl===!1)throw new Error('Type of text must be string or Array. "'+W+'" is not recognized.');typeof W=="string"&&(W=W.match(/[\r?\n]/)?W.split(/\r\n|\r|\n/g):[W]);var rc=be/Sr.internal.scaleFactor,ic=rc*(vo-1);switch(Ct.baseline){case"bottom":Ze-=ic;break;case"top":Ze+=rc-ic;break;case"hanging":Ze+=rc-2*ic;break;case"middle":Ze+=rc/2-ic}if((Cn=Ct.maxWidth||0)>0&&(typeof W=="string"?W=Sr.splitTextToSize(W,Cn):Object.prototype.toString.call(W)==="[object Array]"&&(W=W.reduce(function(Jn,Kn){return Jn.concat(Sr.splitTextToSize(Kn,Cn))},[]))),rs={text:W,x:Ce,y:Ze,options:Ct,mutex:{pdfEscape:tt,activeFontKey:Ge,fonts:it,activeFontSize:be}},ge.publish("preProcessText",rs),W=rs.text,zs=(Ct=rs.options).angle,ni instanceof Pe==0&&zs&&typeof zs=="number"){zs*=Math.PI/180,Ct.rotationDirection===0&&(zs=-zs),M===L&&(zs=-zs);var Ld=Math.cos(zs),Ql=Math.sin(zs);ni=new Pe(Ld,Ql,-Ql,Ld,0,0)}else zs&&zs instanceof Pe&&(ni=zs);M!==L||ni||(ni=Oe),(mn=Ct.charSpace||Ir)!==void 0&&(Gi+=B(ee(mn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Gr=Ct.horizontalScale)!==void 0&&(Gi+=B(100*Gr)+` Tz
`),Ct.lang;var pa=-1,Ro=Ct.renderingMode!==void 0?Ct.renderingMode:Ct.stroke,Pd=Sr.internal.getCurrentPageInfo().pageContext;switch(Ro){case 0:case!1:case"fill":pa=0;break;case 1:case!0:case"stroke":pa=1;break;case 2:case"fillThenStroke":pa=2;break;case 3:case"invisible":pa=3;break;case 4:case"fillAndAddForClipping":pa=4;break;case 5:case"strokeAndAddPathForClipping":pa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":pa=6;break;case 7:case"addToPathForClipping":pa=7}var th=Pd.usedRenderingMode!==void 0?Pd.usedRenderingMode:-1;pa!==-1?Gi+=pa+` Tr
`:th!==-1&&(Gi+=`0 Tr
`),pa!==-1&&(Pd.usedRenderingMode=pa),en=Ct.align||"left";var Wa,wl=be*vo,To=Sr.internal.pageSize.getWidth(),sh=it[Ge];mn=Ct.charSpace||Ir,Cn=Ct.maxWidth||0,Fn=Object.assign({autoencode:!0,noBOM:!0},Ct.flags);var Ll=[],ac=function(Jn){return Sr.getStringUnitWidth(Jn,{font:sh,charSpace:mn,fontSize:be,doKerning:!1})*be/jl};if(Object.prototype.toString.call(W)==="[object Array]"){var Ma;gs=eh(W),en!=="left"&&(Wa=gs.map(ac));var ya,Yl=0;if(en==="right"){Ce-=Wa[0],W=[],Oi=gs.length;for(var Vl=0;Vl<Oi;Vl++)Vl===0?(ya=Mr(Ce),Ma=hn(Ze)):(ya=ee(Yl-Wa[Vl]),Ma=-wl),W.push([gs[Vl],ya,Ma]),Yl=Wa[Vl]}else if(en==="center"){Ce-=Wa[0]/2,W=[],Oi=gs.length;for(var Mo=0;Mo<Oi;Mo++)Mo===0?(ya=Mr(Ce),Ma=hn(Ze)):(ya=ee((Yl-Wa[Mo])/2),Ma=-wl),W.push([gs[Mo],ya,Ma]),Yl=Wa[Mo]}else if(en==="left"){W=[],Oi=gs.length;for(var Ad=0;Ad<Oi;Ad++)W.push(gs[Ad])}else if(en==="justify"&&sh.encoding==="Identity-H"){W=[],Oi=gs.length,Cn=Cn!==0?Cn:To;for(var kd=0,ri=0;ri<Oi;ri++)if(Ma=ri===0?hn(Ze):-wl,ya=ri===0?Mr(Ce):kd,ri<Oi-1){var b0=ee((Cn-Wa[ri])/(gs[ri].split(" ").length-1)),$l=gs[ri].split(" ");W.push([$l[0]+" ",ya,Ma]),kd=0;for(var zl=1;zl<$l.length;zl++){var Wi=(ac($l[zl-1]+" "+$l[zl])-ac($l[zl]))*jl+b0;zl==$l.length-1?W.push([$l[zl],Wi,0]):W.push([$l[zl]+" ",Wi,0]),kd-=Wi}}else W.push([gs[ri],ya,Ma]);W.push(["",kd,0])}else{if(en!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(W=[],Oi=gs.length,Cn=Cn!==0?Cn:To,ri=0;ri<Oi;ri++){Ma=ri===0?hn(Ze):-wl,ya=ri===0?Mr(Ce):0;var Io=gs[ri].split(" ").length-1,Ud=Io>0?(Cn-Wa[ri])/Io:0;ri<Oi-1?Ll.push(B(ee(Ud))):Ll.push(0),W.push([gs[ri],ya,Ma])}}}(typeof Ct.R2L=="boolean"?Ct.R2L:me)===!0&&(W=wd(W,function(Jn,Kn,vr){return[Jn.split("").reverse().join(""),Kn,vr]})),rs={text:W,x:Ce,y:Ze,options:Ct,mutex:{pdfEscape:tt,activeFontKey:Ge,fonts:it,activeFontSize:be}},ge.publish("postProcessText",rs),W=rs.text,di=rs.mutex.isHex||!1;var Bd=it[Ge].encoding;Bd!=="WinAnsiEncoding"&&Bd!=="StandardEncoding"||(W=wd(W,function(Jn,Kn,vr){return[Eo(Jn),Kn,vr]})),gs=eh(W),W=[];for(var jo,Oo,Hl,Gc=Array.isArray(gs[0])?1:0,Fa="",wo=function(Jn,Kn,vr){var ii="";return vr instanceof Pe?(vr=typeof Ct.angle=="number"?Nt(vr,new Pe(1,0,0,1,Jn,Kn)):Nt(new Pe(1,0,0,1,Jn,Kn),vr),M===L&&(vr=Nt(new Pe(1,0,0,-1,0,0),vr)),ii=vr.join(" ")+` Tm
`):ii=B(Jn)+" "+B(Kn)+` Td
`,ii},ra=0;ra<gs.length;ra++){switch(Fa="",Gc){case 1:Hl=(di?"<":"(")+gs[ra][0]+(di?">":")"),jo=parseFloat(gs[ra][1]),Oo=parseFloat(gs[ra][2]);break;case 0:Hl=(di?"<":"(")+gs[ra]+(di?">":")"),jo=Mr(Ce),Oo=hn(Ze)}Ll!==void 0&&Ll[ra]!==void 0&&(Fa=Ll[ra]+` Tw
`),ra===0?W.push(Fa+wo(jo,Oo,ni)+Hl):Gc===0?W.push(Fa+Hl):Gc===1&&W.push(Fa+wo(jo,Oo,ni)+Hl)}W=Gc===0?W.join(` Tj
T* `):W.join(` Tj
`),W+=` Tj
`;var sl=`BT
/`;return sl+=Ge+" "+be+` Tf
`,sl+=B(be*vo)+` TL
`,sl+=Ar+`
`,sl+=Gi,sl+=W,Z(sl+="ET"),p[Ge]=!0,Sr};var cs=g.__private__.clip=g.clip=function(W){return Z(W==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return cs("evenodd")},g.__private__.discardPath=g.discardPath=function(){return Z("n"),this};var ms=g.__private__.isValidStyle=function(W){var Ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(W)!==-1&&(Ce=!0),Ce};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(W){return ms(W)&&(h=W),this};var Ys=g.__private__.getStyle=g.getStyle=function(W){var Ce=h;switch(W){case"D":case"S":Ce="S";break;case"F":Ce="f";break;case"FD":case"DF":Ce="B";break;case"f":case"f*":case"B":case"B*":Ce=W}return Ce},Ps=g.close=function(){return Z("h"),this};g.stroke=function(){return Z("S"),this},g.fill=function(W){return rt("f",W),this},g.fillEvenOdd=function(W){return rt("f*",W),this},g.fillStroke=function(W){return rt("B",W),this},g.fillStrokeEvenOdd=function(W){return rt("B*",W),this};var rt=function(W,Ce){Nr(Ce)==="object"?zt(Ce,W):Z(W)},Wt=function(W){W===null||M===L&&W===void 0||(W=Ys(W),Z(W))};function bs(W,Ce,Ze,Ct,Ot){var rs=new If(Ce||this.boundingBox,Ze||this.xStep,Ct||this.yStep,this.gState,Ot||this.matrix);rs.stream=this.stream;var gs=W+"$$"+this.cloneIndex+++"$$";return dt(gs,rs),rs}var zt=function(W,Ce){var Ze=Mt[W.key],Ct=lt[Ze];if(Ct instanceof Th)Z("q"),Z(ws(Ce)),Ct.gState&&g.setGState(Ct.gState),Z(W.matrix.toString()+" cm"),Z("/"+Ze+" sh"),Z("Q");else if(Ct instanceof If){var Ot=new Pe(1,0,0,-1,0,So());W.matrix&&(Ot=Ot.multiply(W.matrix||Oe),Ze=bs.call(Ct,W.key,W.boundingBox,W.xStep,W.yStep,Ot).id),Z("q"),Z("/Pattern cs"),Z("/"+Ze+" scn"),Ct.gState&&g.setGState(Ct.gState),Z(Ce),Z("Q")}},ws=function(W){switch(W){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Zt=g.moveTo=function(W,Ce){return Z(B(ee(W))+" "+B(J(Ce))+" m"),this},Ds=g.lineTo=function(W,Ce){return Z(B(ee(W))+" "+B(J(Ce))+" l"),this},js=g.curveTo=function(W,Ce,Ze,Ct,Ot,rs){return Z([B(ee(W)),B(J(Ce)),B(ee(Ze)),B(J(Ct)),B(ee(Ot)),B(J(rs)),"c"].join(" ")),this};g.__private__.line=g.line=function(W,Ce,Ze,Ct,Ot){if(isNaN(W)||isNaN(Ce)||isNaN(Ze)||isNaN(Ct)||!ms(Ot))throw new Error("Invalid arguments passed to jsPDF.line");return M===k?this.lines([[Ze-W,Ct-Ce]],W,Ce,[1,1],Ot||"S"):this.lines([[Ze-W,Ct-Ce]],W,Ce,[1,1]).stroke()},g.__private__.lines=g.lines=function(W,Ce,Ze,Ct,Ot,rs){var gs,zs,en,mn,Cn,Fn,Gr,ni,Sr,Ci,di,Gi;if(typeof W=="number"&&(Gi=Ze,Ze=Ce,Ce=W,W=Gi),Ct=Ct||[1,1],rs=rs||!1,isNaN(Ce)||isNaN(Ze)||!Array.isArray(W)||!Array.isArray(Ct)||!ms(Ot)||typeof rs!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Zt(Ce,Ze),gs=Ct[0],zs=Ct[1],mn=W.length,Ci=Ce,di=Ze,en=0;en<mn;en++)(Cn=W[en]).length===2?(Ci=Cn[0]*gs+Ci,di=Cn[1]*zs+di,Ds(Ci,di)):(Fn=Cn[0]*gs+Ci,Gr=Cn[1]*zs+di,ni=Cn[2]*gs+Ci,Sr=Cn[3]*zs+di,Ci=Cn[4]*gs+Ci,di=Cn[5]*zs+di,js(Fn,Gr,ni,Sr,Ci,di));return rs&&Ps(),Wt(Ot),this},g.path=function(W){for(var Ce=0;Ce<W.length;Ce++){var Ze=W[Ce],Ct=Ze.c;switch(Ze.op){case"m":Zt(Ct[0],Ct[1]);break;case"l":Ds(Ct[0],Ct[1]);break;case"c":js.apply(this,Ct);break;case"h":Ps()}}return this},g.__private__.rect=g.rect=function(W,Ce,Ze,Ct,Ot){if(isNaN(W)||isNaN(Ce)||isNaN(Ze)||isNaN(Ct)||!ms(Ot))throw new Error("Invalid arguments passed to jsPDF.rect");return M===k&&(Ct=-Ct),Z([B(ee(W)),B(J(Ce)),B(ee(Ze)),B(ee(Ct)),"re"].join(" ")),Wt(Ot),this},g.__private__.triangle=g.triangle=function(W,Ce,Ze,Ct,Ot,rs,gs){if(isNaN(W)||isNaN(Ce)||isNaN(Ze)||isNaN(Ct)||isNaN(Ot)||isNaN(rs)||!ms(gs))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ze-W,Ct-Ce],[Ot-Ze,rs-Ct],[W-Ot,Ce-rs]],W,Ce,[1,1],gs,!0),this},g.__private__.roundedRect=g.roundedRect=function(W,Ce,Ze,Ct,Ot,rs,gs){if(isNaN(W)||isNaN(Ce)||isNaN(Ze)||isNaN(Ct)||isNaN(Ot)||isNaN(rs)||!ms(gs))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var zs=4/3*(Math.SQRT2-1);return Ot=Math.min(Ot,.5*Ze),rs=Math.min(rs,.5*Ct),this.lines([[Ze-2*Ot,0],[Ot*zs,0,Ot,rs-rs*zs,Ot,rs],[0,Ct-2*rs],[0,rs*zs,-Ot*zs,rs,-Ot,rs],[2*Ot-Ze,0],[-Ot*zs,0,-Ot,-rs*zs,-Ot,-rs],[0,2*rs-Ct],[0,-rs*zs,Ot*zs,-rs,Ot,-rs]],W+Ot,Ce,[1,1],gs,!0),this},g.__private__.ellipse=g.ellipse=function(W,Ce,Ze,Ct,Ot){if(isNaN(W)||isNaN(Ce)||isNaN(Ze)||isNaN(Ct)||!ms(Ot))throw new Error("Invalid arguments passed to jsPDF.ellipse");var rs=4/3*(Math.SQRT2-1)*Ze,gs=4/3*(Math.SQRT2-1)*Ct;return Zt(W+Ze,Ce),js(W+Ze,Ce-gs,W+rs,Ce-Ct,W,Ce-Ct),js(W-rs,Ce-Ct,W-Ze,Ce-gs,W-Ze,Ce),js(W-Ze,Ce+gs,W-rs,Ce+Ct,W,Ce+Ct),js(W+rs,Ce+Ct,W+Ze,Ce+gs,W+Ze,Ce),Wt(Ot),this},g.__private__.circle=g.circle=function(W,Ce,Ze,Ct){if(isNaN(W)||isNaN(Ce)||isNaN(Ze)||!ms(Ct))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(W,Ce,Ze,Ze,Ct)},g.setFont=function(W,Ce,Ze){return Ze&&(Ce=G(Ce,Ze)),Ge=ze(W,Ce,{disableWarning:!1}),this};var hs=g.__private__.getFont=g.getFont=function(){return it[ze.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var W,Ce,Ze={};for(W in Fe)if(Fe.hasOwnProperty(W))for(Ce in Ze[W]=[],Fe[W])Fe[W].hasOwnProperty(Ce)&&Ze[W].push(Ce);return Ze},g.addFont=function(W,Ce,Ze,Ct,Ot){var rs=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&rs.indexOf(arguments[3])!==-1?Ot=arguments[3]:arguments[3]&&rs.indexOf(arguments[3])==-1&&(Ze=G(Ze,Ct)),Me.call(this,W,Ce,Ze,Ot=Ot||"Identity-H")};var Ws,Vs=t.lineWidth||.200025,Os=g.__private__.getLineWidth=g.getLineWidth=function(){return Vs},xs=g.__private__.setLineWidth=g.setLineWidth=function(W){return Vs=W,Z(B(ee(W))+" w"),this};g.__private__.setLineDash=nn.API.setLineDash=nn.API.setLineDashPattern=function(W,Ce){if(W=W||[],Ce=Ce||0,isNaN(Ce)||!Array.isArray(W))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return W=W.map(function(Ze){return B(ee(Ze))}).join(" "),Ce=B(ee(Ce)),Z("["+W+"] "+Ce+" d"),this};var Br=g.__private__.getLineHeight=g.getLineHeight=function(){return be*Ws};g.__private__.getLineHeight=g.getLineHeight=function(){return be*Ws};var Pr=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(W){return typeof(W=W||1.15)=="number"&&(Ws=W),this},ti=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return Ws};Pr(t.lineHeight);var Mr=g.__private__.getHorizontalCoordinate=function(W){return ee(W)},hn=g.__private__.getVerticalCoordinate=function(W){return M===L?W:pe[U].mediaBox.topRightY-pe[U].mediaBox.bottomLeftY-ee(W)},fr=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(W){return B(Mr(W))},ci=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(W){return B(hn(W))},$r=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return ds($r)},g.__private__.setStrokeColor=g.setDrawColor=function(W,Ce,Ze,Ct){return $r=vs({ch1:W,ch2:Ce,ch3:Ze,ch4:Ct,pdfColorType:"draw",precision:2}),Z($r),this};var sa=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return ds(sa)},g.__private__.setFillColor=g.setFillColor=function(W,Ce,Ze,Ct){return sa=vs({ch1:W,ch2:Ce,ch3:Ze,ch4:Ct,pdfColorType:"fill",precision:2}),Z(sa),this};var Ar=t.textColor||"0 g",na=g.__private__.getTextColor=g.getTextColor=function(){return ds(Ar)};g.__private__.setTextColor=g.setTextColor=function(W,Ce,Ze,Ct){return Ar=vs({ch1:W,ch2:Ce,ch3:Ze,ch4:Ct,pdfColorType:"text",precision:3}),this};var Ir=t.charSpace,Ga=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Ir||0)};g.__private__.setCharSpace=g.setCharSpace=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ir=W,this};var tl=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(W){var Ce=g.CapJoinStyles[W];if(Ce===void 0)throw new Error("Line cap style of '"+W+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return tl=Ce,Z(Ce+" J"),this};var Rs=0;g.__private__.setLineJoin=g.setLineJoin=function(W){var Ce=g.CapJoinStyles[W];if(Ce===void 0)throw new Error("Line join style of '"+W+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Rs=Ce,Z(Ce+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(W){if(W=W||0,isNaN(W))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(B(ee(W))+" M"),this},g.GState=y1,g.setGState=function(W){(W=typeof W=="string"?ut[qe[W]]:Un(null,W)).equals(Ee)||(Z("/"+W.id+" gs"),Ee=W)};var Un=function(W,Ce){if(!W||!qe[W]){var Ze=!1;for(var Ct in ut)if(ut.hasOwnProperty(Ct)&&ut[Ct].equals(Ce)){Ze=!0;break}if(Ze)Ce=ut[Ct];else{var Ot="GS"+(Object.keys(ut).length+1).toString(10);ut[Ot]=Ce,Ce.id=Ot}return W&&(qe[W]=Ce.id),ge.publish("addGState",Ce),Ce}};g.addGState=function(W,Ce){return Un(W,Ce),this},g.saveGraphicsState=function(){return Z("q"),nt.push({key:Ge,size:be,color:Ar}),this},g.restoreGraphicsState=function(){Z("Q");var W=nt.pop();return Ge=W.key,be=W.size,Ar=W.color,Ee=null,this},g.setCurrentTransformationMatrix=function(W){return Z(W.toString()+" cm"),this},g.comment=function(W){return Z("#"+W),this};var Vn=function(W,Ce){var Ze=W||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ze},set:function(rs){isNaN(rs)||(Ze=parseFloat(rs))}});var Ct=Ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ct},set:function(rs){isNaN(rs)||(Ct=parseFloat(rs))}});var Ot="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ot},set:function(rs){Ot=rs.toString()}}),this},si=function(W,Ce,Ze,Ct){Vn.call(this,W,Ce),this.type="rect";var Ot=Ze||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ot},set:function(gs){isNaN(gs)||(Ot=parseFloat(gs))}});var rs=Ct||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return rs},set:function(gs){isNaN(gs)||(rs=parseFloat(gs))}}),this},Ii=function(){this.page=Ye,this.currentPage=U,this.pages=Ne.slice(0),this.pagesContext=pe.slice(0),this.x=xt,this.y=mt,this.matrix=Ve,this.width=ks(U),this.height=zr(U),this.outputDestination=xe,this.id="",this.objectNumber=-1};Ii.prototype.restore=function(){Ye=this.page,U=this.currentPage,pe=this.pagesContext,Ne=this.pages,xt=this.x,mt=this.y,Ve=this.matrix,Xn(U,this.width),ji(U,this.height),xe=this.outputDestination};var No=function(W,Ce,Ze,Ct,Ot){Je.push(new Ii),Ye=U=0,Ne=[],xt=W,mt=Ce,Ve=Ot,Te([Ze,Ct])};for(var Il in g.beginFormObject=function(W,Ce,Ze,Ct,Ot){return No(W,Ce,Ze,Ct,Ot),this},g.endFormObject=function(W){return(function(Ce){if(we[Ce])Je.pop().restore();else{var Ze=new Ii,Ct="Xo"+(Object.keys(ue).length+1).toString(10);Ze.id=Ct,we[Ce]=Ct,ue[Ct]=Ze,ge.publish("addFormObject",Ze),Je.pop().restore()}})(W),this},g.doFormObject=function(W,Ce){var Ze=ue[we[W]];return Z("q"),Z(Ce.toString()+" cm"),Z("/"+Ze.id+" Do"),Z("Q"),this},g.getFormObject=function(W){var Ce=ue[we[W]];return{x:Ce.x,y:Ce.y,width:Ce.width,height:Ce.height,matrix:Ce.matrix}},g.save=function(W,Ce){return W=W||"generated.pdf",(Ce=Ce||{}).returnPromise=Ce.returnPromise||!1,Ce.returnPromise===!1?(Dh(Ut(ts()),W),typeof Dh.unload=="function"&&yn.setTimeout&&setTimeout(Dh.unload,911),this):new Promise(function(Ze,Ct){try{var Ot=Dh(Ut(ts()),W);typeof Dh.unload=="function"&&yn.setTimeout&&setTimeout(Dh.unload,911),Ze(Ot)}catch(rs){Ct(rs.message)}})},nn.API)nn.API.hasOwnProperty(Il)&&(Il==="events"&&nn.API.events.length?(function(W,Ce){var Ze,Ct,Ot;for(Ot=Ce.length-1;Ot!==-1;Ot--)Ze=Ce[Ot][0],Ct=Ce[Ot][1],W.subscribe.apply(W,[Ze].concat(typeof Ct=="function"?[Ct]:Ct))})(ge,nn.API.events):g[Il]=nn.API[Il]);function ks(W){return pe[W].mediaBox.topRightX-pe[W].mediaBox.bottomLeftX}function Xn(W,Ce){pe[W].mediaBox.topRightX=Ce+pe[W].mediaBox.bottomLeftX}function zr(W){return pe[W].mediaBox.topRightY-pe[W].mediaBox.bottomLeftY}function ji(W,Ce){pe[W].mediaBox.topRightY=Ce+pe[W].mediaBox.bottomLeftY}var Bi=g.getPageWidth=function(W){return ks(W=W||U)/at},p0=g.setPageWidth=function(W,Ce){Xn(W,Ce*at)},So=g.getPageHeight=function(W){return zr(W=W||U)/at},y0=g.setPageHeight=function(W,Ce){ji(W,Ce*at)};return g.internal={pdfEscape:tt,getStyle:Ys,getFont:hs,getFontSize:re,getCharSpace:Ga,getTextColor:na,getLineHeight:Br,getLineHeightFactor:ti,getLineWidth:Os,write:le,getHorizontalCoordinate:Mr,getVerticalCoordinate:hn,getCoordinateString:fr,getVerticalCoordinateString:ci,collections:{},newObject:It,newAdditionalObject:Ue,newObjectDeferred:$e,newObjectDeferredBegin:$t,getFilters:Ss,putStream:ke,events:ge,scaleFactor:at,pageSize:{getWidth:function(){return Bi(U)},setWidth:function(W){p0(U,W)},getHeight:function(){return So(U)},setHeight:function(W){y0(U,W)}},encryptionOptions:m,encryption:Us,getEncryptor:function(W){return m!==null?Us.encryptor(W,0):function(Ce){return Ce}},output:Is,getNumberOfPages:Et,get pages(){return Ne},out:Z,f2:A,f3:Y,getPageInfo:_s,getPageInfoByObjId:Es,getCurrentPageInfo:Ls,getPDFVersion:y,Point:Vn,Rectangle:si,Matrix:Pe,hasHotfix:Cs},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return Bi(U)},set:function(W){p0(U,W)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return So(U)},set:function(W){y0(U,W)},enumerable:!0,configurable:!0}),(function(W){for(var Ce=0,Ze=Re.length;Ce<Ze;Ce++){var Ct=Me.call(this,W[Ce][0],W[Ce][1],W[Ce][2],Re[Ce][3],!0);_===!1&&(p[Ct]=!0);var Ot=W[Ce][0].split("-");je({id:Ct,fontName:Ot[0],fontStyle:Ot[1]||""})}ge.publish("addFonts",{fonts:it,dictionary:Fe})}).call(g,Re),Ge="F1",bt(i,n),ge.publish("initialized"),g}Nf.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Nf.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Nf.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},Nf.prototype.processOwnerPassword=function(t,e){return U2(k2(e).substr(0,5),t)},Nf.prototype.encryptor=function(t,e){var n=k2(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return U2(n,r)}},y1.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||Nr(t)!==Nr(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},nn.API={events:[]},nn.version="4.2.0";var bi=nn.API,xS=1,x0=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hf=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},n0=function(t){return t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},vn=function(t){return t.toFixed(2)},pu=function(t){return t.toFixed(5)};bi.__acroform__={};var Ml=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},yT=function(t){return t*xS},Sc=function(t){var e=new bO,n=Zs.internal.getHeight(t)||0,r=Zs.internal.getWidth(t)||0;return e.BBox=[0,0,Number(vn(r)),Number(vn(n))],e},mH=bi.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},gH=bi.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},_H=bi.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Di=bi.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _H(t,e-1)},Ri=bi.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return mH(t,e-1)},Ti=bi.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return gH(t,e-1)},xH=bi.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],c=t[3],u={};return u.lowerLeft_X=n(i)||0,u.lowerLeft_Y=r(a+c)||0,u.upperRight_X=n(i+o)||0,u.upperRight_Y=r(a)||0,[Number(vn(u.lowerLeft_X)),Number(vn(u.lowerLeft_Y)),Number(vn(u.upperRight_X)),Number(vn(u.upperRight_Y))]},pH=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=B2(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+vn(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Sc(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},B2=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(A){return A.split(`
`)}):i.map(function(A){return[A]});var a=n,o=Zs.internal.getHeight(t)||0;o=o<0?-o:o;var c=Zs.internal.getWidth(t)||0;c=c<0?-c:c;var u=function(A,Y,ee){if(A+1<i.length){var J=Y+" "+i[A+1][0];return ap(J,t,ee).width<=c-4}return!1};a++;e:for(;a>0;){e="",a--;var h,m,_=ap("3",t,a).height,p=t.multiline?o-a:(o-_)/2,g=p+=2,C=0,y=0,S=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+ap(e,t,a=12).width+", FieldWidth:"+c+`
`;break}for(var v="",k=0,L=0;L<i.length;L++)if(i.hasOwnProperty(L)){var M=!1;if(i[L].length!==1&&S!==i[L].length-1){if((_+2)*(k+2)+2>o)continue e;v+=i[L][S],M=!0,y=L,L--}else{v=(v+=i[L][S]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var P=parseInt(L),F=u(P,v,a),G=L>=i.length-1;if(F&&!G){v+=" ",S=0;continue}if(F||G){if(G)y=P;else if(t.multiline&&(_+2)*(k+2)+2>o)continue e}else{if(!t.multiline||(_+2)*(k+2)+2>o)continue e;y=P}}for(var B="",I=C;I<=y;I++){var E=i[I];if(t.multiline){if(I===y){B+=E[S]+" ",S=(S+1)%E.length;continue}if(I===C){B+=E[E.length-1]+" ";continue}}B+=E[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,m=ap(B,t,a).width,t.textAlign){case"right":h=c-m-2;break;case"center":h=(c-m)/2;break;default:h=2}e+=vn(h)+" "+vn(g)+` Td
`,e+="("+x0(B)+`) Tj
`,e+=-vn(h)+` 0 Td
`,g=-(a+2),m=0,C=M?y:y+1,k++,v=""}break}return r.text=e,r.fontSize=a,r},ap=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},yH={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},bH=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},CH=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(sc.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(yH)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");xS=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new CO,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];a.objId=void 0,a.hasAnnotation&&bH(a,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var a=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var c=r[o],u=[],h=c.Rect;if(c.Rect&&(c.Rect=xH(c.Rect,i)),i.internal.newObjectDeferredBegin(c.objId,!0),c.DA=Zs.createDefaultAppearanceStream(c),Nr(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=h,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=pH(c);u.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var _="";for(var p in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(p)){var g=c.appearanceStreamContent[p];if(_+="/"+p+" ",_+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var C=g[o];typeof C=="function"&&(C=C.call(i,c)),_+="/"+o+" "+C+" ",i.internal.acroformPlugin.xForms.indexOf(C)>=0||i.internal.acroformPlugin.xForms.push(C)}}else typeof(C=g)=="function"&&(C=C.call(i,c)),_+="/"+o+" "+C,i.internal.acroformPlugin.xForms.indexOf(C)>=0||i.internal.acroformPlugin.xForms.push(C);_+=">>"}u.push({key:"AP",value:`<<
`+_+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:c.objId}),i.internal.out("endobj")}a&&(function(y,S){for(var v in y)if(y.hasOwnProperty(v)){var k=v,L=y[v];S.internal.newObjectDeferredBegin(L.objId,!0),Nr(L)==="object"&&typeof L.putStream=="function"&&L.putStream(),delete y[k]}})(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},yO=bi.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),Nr(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)==="/"?i+="/"+n0(t[a].substr(1)):(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+x0(r(t[a].toString()))+")")}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},vC=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+x0(r(t))+")"},Ic=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ic.prototype.toString=function(){return this.objId+" 0 R"},Ic.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Ic.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:yO(i,this.objId,this.scope)}):i instanceof Ic?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var bO=function(){Ic.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Ml(bO,Ic);var CO=function(){Ic.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+x0(n(t))+")"}},set:function(n){t=n}})};Ml(CO,Ic);var sc=function t(){Ic.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Di(e,3)},set:function(v){v?this.F=Ri(e,3):this.F=Ti(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');n=v}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(v){r=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(v){r[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(v){r[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(v){r[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(v){r[3]=v}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof b1)return;a="FieldObject"+t.FieldNum++}var v=function(k){return k};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+x0(v(a))+")"},set:function(v){a=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(v){a=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/xS:h},set:function(v){h=v}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(v){m=v}});var _="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!_||this instanceof b1||this instanceof Qh))return vC(_,this.objId,this.scope)},set:function(v){v=v.toString(),_=v}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ma==0?vC(p,this.objId,this.scope):p},set:function(v){v=v.toString(),p=this instanceof ma==0?v.substr(0,1)==="("?hf(v.substr(1,v.length-2)):hf(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ma==1?hf(p.substr(1,p.length-1)):p},set:function(v){v=v.toString(),p=this instanceof ma==1?"/"+n0(v):v}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ma==0?vC(g,this.objId,this.scope):g},set:function(v){v=v.toString(),g=this instanceof ma==0?v.substr(0,1)==="("?hf(v.substr(1,v.length-2)):hf(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ma==1?hf(g.substr(1,g.length-1)):g},set:function(v){v=v.toString(),g=this instanceof ma==1?"/"+n0(v):v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var C,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(v){v=!!v,y=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(C)return C},set:function(v){C=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,1)},set:function(v){v?this.Ff=Ri(this.Ff,1):this.Ff=Ti(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,2)},set:function(v){v?this.Ff=Ri(this.Ff,2):this.Ff=Ti(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,3)},set:function(v){v?this.Ff=Ri(this.Ff,3):this.Ff=Ti(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');S=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(S){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:S=2;break;case"center":case 1:S=1;break;default:S=0}}})};Ml(sc,Ic);var Wf=function(){sc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return yO(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=(function(a,o,c){c||(c=1);for(var u,h=[];u=o.exec(a);)h.push(u[c]);return h})(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,18)},set:function(n){n?this.Ff=Ri(this.Ff,18):this.Ff=Ti(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Ri(this.Ff,19):this.Ff=Ti(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,20)},set:function(n){n?(this.Ff=Ri(this.Ff,20),e.sort()):this.Ff=Ti(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,22)},set:function(n){n?this.Ff=Ri(this.Ff,22):this.Ff=Ti(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,23)},set:function(n){n?this.Ff=Ri(this.Ff,23):this.Ff=Ti(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,27)},set:function(n){n?this.Ff=Ri(this.Ff,27):this.Ff=Ti(this.Ff,27)}}),this.hasAppearanceStream=!1};Ml(Wf,sc);var Ff=function(){Wf.call(this),this.fontName="helvetica",this.combo=!1};Ml(Ff,Wf);var Kf=function(){Ff.call(this),this.combo=!0};Ml(Kf,Ff);var Rp=function(){Kf.call(this),this.edit=!0};Ml(Rp,Kf);var ma=function(){sc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,15)},set:function(n){n?this.Ff=Ri(this.Ff,15):this.Ff=Ti(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,16)},set:function(n){n?this.Ff=Ri(this.Ff,16):this.Ff=Ti(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,17)},set:function(n){n?this.Ff=Ri(this.Ff,17):this.Ff=Ti(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,26)},set:function(n){n?this.Ff=Ri(this.Ff,26):this.Ff=Ti(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+x0(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){Nr(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){var r=n==null?"":n.toString();r.substr(0,1)==="/"&&(r=r.substr(1)),t="/"+n0(r)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n0(n)}})};Ml(ma,sc);var Tp=function(){ma.call(this),this.pushButton=!0};Ml(Tp,ma);var Qf=function(){ma.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ml(Qf,ma);var b1=function(){var t,e;sc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(c){return c};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),r)o.push("/"+a+" ("+x0(i(r[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Nr(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){var a=i==null?"":i.toString();a.substr(0,1)==="/"&&(a=a.substr(1)),n="/"+n0(a)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){var a=i==null?"":i.toString();a.substr(0,1)==="/"&&(a=a.substr(1)),n="/"+n0(a)}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Zs.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ml(b1,sc),Qf.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},Qf.prototype.createOption=function(t){var e=new b1;return e.Parent=this,e.optionName=t,this.Kids.push(e),NH.call(this.scope,e),e};var Mp=function(){ma.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Zs.CheckBox.createAppearanceStream()};Ml(Mp,ma);var Qh=function(){sc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,13)},set:function(e){e?this.Ff=Ri(this.Ff,13):this.Ff=Ti(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,21)},set:function(e){e?this.Ff=Ri(this.Ff,21):this.Ff=Ti(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,23)},set:function(e){e?this.Ff=Ri(this.Ff,23):this.Ff=Ti(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,24)},set:function(e){e?this.Ff=Ri(this.Ff,24):this.Ff=Ti(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,25)},set:function(e){e?this.Ff=Ri(this.Ff,25):this.Ff=Ti(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,26)},set:function(e){e?this.Ff=Ri(this.Ff,26):this.Ff=Ti(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ml(Qh,sc);var Ip=function(){Qh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Di(this.Ff,14)},set:function(t){t?this.Ff=Ri(this.Ff,14):this.Ff=Ti(this.Ff,14)}}),this.password=!0};Ml(Ip,Qh);var Zs={CheckBox:{createAppearanceStream:function(){return{N:{On:Zs.CheckBox.YesNormal},D:{On:Zs.CheckBox.YesPushDown,Off:Zs.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Sc(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=B2(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+vn(Zs.internal.getWidth(t))+" "+vn(Zs.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+vn(a.fontSize)+" Tf "+i),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Sc(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],a=Zs.internal.getHeight(t),o=Zs.internal.getWidth(t),c=B2(t,t.caption);return i.push("1 g"),i.push("0 0 "+vn(o)+" "+vn(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+vn(o-1)+" "+vn(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+vn(c.fontSize)+" Tf "+r),i.push(c.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Sc(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+vn(Zs.internal.getWidth(t))+" "+vn(Zs.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Zs.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Zs.RadioButton.Circle.YesNormal,e.D[t]=Zs.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Sc(t);e.scope=t.scope;var n=[],r=Zs.internal.getWidth(t)<=Zs.internal.getHeight(t)?Zs.internal.getWidth(t)/4:Zs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Zs.internal.Bezier_C,a=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+pu(Zs.internal.getWidth(t)/2)+" "+pu(Zs.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Sc(t);e.scope=t.scope;var n=[],r=Zs.internal.getWidth(t)<=Zs.internal.getHeight(t)?Zs.internal.getWidth(t)/4:Zs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),a=Number((i*Zs.internal.Bezier_C).toFixed(5)),o=Number((r*Zs.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+pu(Zs.internal.getWidth(t)/2)+" "+pu(Zs.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+pu(Zs.internal.getWidth(t)/2)+" "+pu(Zs.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Sc(t);e.scope=t.scope;var n=[],r=Zs.internal.getWidth(t)<=Zs.internal.getHeight(t)?Zs.internal.getWidth(t)/4:Zs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),a=Number((i*Zs.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+pu(Zs.internal.getWidth(t)/2)+" "+pu(Zs.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Zs.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Zs.RadioButton.Cross.YesNormal,e.D[t]=Zs.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Sc(t);e.scope=t.scope;var n=[],r=Zs.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+vn(Zs.internal.getWidth(t)-2)+" "+vn(Zs.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(vn(r.x1.x)+" "+vn(r.x1.y)+" m"),n.push(vn(r.x2.x)+" "+vn(r.x2.y)+" l"),n.push(vn(r.x4.x)+" "+vn(r.x4.y)+" m"),n.push(vn(r.x3.x)+" "+vn(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Sc(t);e.scope=t.scope;var n=Zs.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+vn(Zs.internal.getWidth(t))+" "+vn(Zs.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+vn(Zs.internal.getWidth(t)-2)+" "+vn(Zs.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(vn(n.x1.x)+" "+vn(n.x1.y)+" m"),r.push(vn(n.x2.x)+" "+vn(n.x2.y)+" l"),r.push(vn(n.x4.x)+" "+vn(n.x4.y)+" m"),r.push(vn(n.x3.x)+" "+vn(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Sc(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+vn(Zs.internal.getWidth(t))+" "+vn(Zs.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Zs.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Zs.internal.getWidth(t),n=Zs.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Zs.internal.getWidth=function(t){var e=0;return Nr(t)==="object"&&(e=yT(t.Rect[2])),e},Zs.internal.getHeight=function(t){var e=0;return Nr(t)==="object"&&(e=yT(t.Rect[3])),e};var NH=bi.addField=function(t){if(CH(this,t),!(t instanceof sc))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};bi.AcroFormChoiceField=Wf,bi.AcroFormListBox=Ff,bi.AcroFormComboBox=Kf,bi.AcroFormEditBox=Rp,bi.AcroFormButton=ma,bi.AcroFormPushButton=Tp,bi.AcroFormRadioButton=Qf,bi.AcroFormCheckBox=Mp,bi.AcroFormTextField=Qh,bi.AcroFormPasswordField=Ip,bi.AcroFormAppearance=Zs,bi.AcroForm={ChoiceField:Wf,ListBox:Ff,ComboBox:Kf,EditBox:Rp,Button:ma,PushButton:Tp,RadioButton:Qf,CheckBox:Mp,TextField:Qh,PasswordField:Ip,Appearance:Zs},nn.AcroForm={ChoiceField:Wf,ListBox:Ff,ComboBox:Kf,EditBox:Rp,Button:ma,PushButton:Tp,RadioButton:Qf,CheckBox:Mp,TextField:Qh,PasswordField:Ip,Appearance:Zs};nn.AcroForm;function NO(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(A,Y){var ee,J,H,V,K,j=n;if((Y=Y||n)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(F(A))for(K in r)for(H=r[K],ee=0;ee<H.length;ee+=1){for(V=!0,J=0;J<H[ee].length;J+=1)if(H[ee][J]!==void 0&&H[ee][J]!==A[J]){V=!1;break}if(V===!0){j=K;break}}else for(K in r)for(H=r[K],ee=0;ee<H.length;ee+=1){for(V=!0,J=0;J<H[ee].length;J+=1)if(H[ee][J]!==void 0&&H[ee][J]!==A.charCodeAt(J)){V=!1;break}if(V===!0){j=K;break}}return j===n&&Y!==n&&(j=Y),j},a=function A(Y){for(var ee=this.internal.write,J=this.internal.putStream,H=(0,this.internal.getFilters)();H.indexOf("FlateEncode")!==-1;)H.splice(H.indexOf("FlateEncode"),1);Y.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:Y.width}),V.push({key:"Height",value:Y.height}),Y.colorSpace===v.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(Y.palette.length/3-1)+" "+("sMask"in Y&&Y.sMask!==void 0?Y.objectId+2:Y.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+Y.colorSpace}),Y.colorSpace===v.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:Y.bitsPerComponent}),"decodeParameters"in Y&&Y.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+Y.decodeParameters+">>"}),"transparency"in Y&&Array.isArray(Y.transparency)&&Y.transparency.length>0){for(var K="",j=0,te=Y.transparency.length;j<te;j++)K+=Y.transparency[j]+" "+Y.transparency[j]+" ";V.push({key:"Mask",value:"["+K+"]"})}Y.sMask!==void 0&&V.push({key:"SMask",value:Y.objectId+1+" 0 R"});var ce=Y.filter!==void 0?["/"+Y.filter]:void 0;if(J({data:Y.data,additionalKeyValues:V,alreadyAppliedFilters:ce,objectId:Y.objectId}),ee("endobj"),"sMask"in Y&&Y.sMask!==void 0){var R,O=(R=Y.sMaskBitsPerComponent)!==null&&R!==void 0?R:Y.bitsPerComponent,U={width:Y.width,height:Y.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:Y.sMask};"filter"in Y&&(U.decodeParameters="/Predictor ".concat(Y.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(Y.width),U.filter=Y.filter),A.call(this,U)}if(Y.colorSpace===v.INDEXED){var Q=this.internal.newObject();J({data:B(new Uint8Array(Y.palette)),objectId:Q}),ee("endobj")}},o=function(){var A=this.internal.collections[e+"images"];for(var Y in A)a.call(this,A[Y])},c=function(){var A,Y=this.internal.collections[e+"images"],ee=this.internal.write;for(var J in Y)ee("/I"+(A=Y[J]).index,A.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",c))},h=function(){var A=this.internal.collections[e+"images"];return u.call(this),A},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},_=function(A){return typeof t["process"+A.toUpperCase()]=="function"},p=function(A){return Nr(A)==="object"&&A.nodeType===1},g=function(A,Y){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var ee=""+A.getAttribute("src");if(ee.indexOf("data:image/")===0)return Dp(unescape(ee).split("base64,").pop());var J=t.loadFile(ee,!0);if(J!==void 0)return J}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var H;switch(Y){case"PNG":H="image/png";break;case"WEBP":H="image/webp";break;default:H="image/jpeg"}return Dp(A.toDataURL(H,1).split("base64,").pop())}},C=function(A){var Y=this.internal.collections[e+"images"];if(Y){for(var ee in Y)if(A===Y[ee].alias)return Y[ee]}},y=function(A,Y,ee){return A||Y||(A=-96,Y=-96),A<0&&(A=-1*ee.width*72/A/this.internal.scaleFactor),Y<0&&(Y=-1*ee.height*72/Y/this.internal.scaleFactor),A===0&&(A=Y*ee.width/ee.height),Y===0&&(Y=A*ee.height/ee.width),[A,Y]},S=function(A,Y,ee,J,H,V){var K=y.call(this,ee,J,H),j=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,ce=h.call(this);if(ee=K[0],J=K[1],ce[H.index]=H,V){V*=Math.PI/180;var R=Math.cos(V),O=Math.sin(V),U=function(q){return q.toFixed(4)},Q=[U(R),U(O),U(-1*O),U(R),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,j(A),te(Y+J),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([j(ee),"0","0",j(J),"0","0","cm"].join(" "))):this.internal.write([j(ee),"0","0",j(J),j(A),te(Y+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+H.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},L=t.__addimage__.sHashCode=function(A){var Y,ee,J=0;if(typeof A=="string")for(ee=A.length,Y=0;Y<ee;Y++)J=(J<<5)-J+A.charCodeAt(Y),J|=0;else if(F(A))for(ee=A.byteLength/2,Y=0;Y<ee;Y++)J=(J<<5)-J+A[Y],J|=0;return J},M=t.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var Y=!0;return A.length===0&&(Y=!1),A.length%4!=0&&(Y=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(Y=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(Y=!1),Y},P=t.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var Y=A.indexOf(",");return Y<0?null:A.substring(0,Y).trim().endsWith("base64")?A.substring(Y+1):null};t.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var F=t.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},G=t.__addimage__.binaryStringToUint8Array=function(A){for(var Y=A.length,ee=new Uint8Array(Y),J=0;J<Y;J++)ee[J]=A.charCodeAt(J);return ee},B=t.__addimage__.arrayBufferToBinaryString=function(A){for(var Y="",ee=F(A)?A:new Uint8Array(A),J=0;J<ee.length;J+=8192)Y+=String.fromCharCode.apply(null,ee.subarray(J,J+8192));return Y};t.addImage=function(){var A,Y,ee,J,H,V,K,j,te;if(typeof arguments[1]=="number"?(Y=n,ee=arguments[1],J=arguments[2],H=arguments[3],V=arguments[4],K=arguments[5],j=arguments[6],te=arguments[7]):(Y=arguments[1],ee=arguments[2],J=arguments[3],H=arguments[4],V=arguments[5],K=arguments[6],j=arguments[7],te=arguments[8]),Nr(A=arguments[0])==="object"&&!p(A)&&"imageData"in A){var ce=A;A=ce.imageData,Y=ce.format||Y||n,ee=ce.x||ee||0,J=ce.y||J||0,H=ce.w||ce.width||H,V=ce.h||ce.height||V,K=ce.alias||K,j=ce.compression||j,te=ce.rotation||ce.angle||te}var R=this.internal.getFilters();if(j===void 0&&R.indexOf("FlateEncode")!==-1&&(j="SLOW"),isNaN(ee)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var O=I.call(this,A,Y,K,j);return S.call(this,ee,J,H,V,O,te),this};var I=function(A,Y,ee,J){var H,V,K;if(typeof A=="string"&&i(A)===n){A=unescape(A);var j=E(A,!1);(j!==""||(j=t.loadFile(A,!0))!==void 0)&&(A=j)}if(p(A)&&(A=g(A,Y)),Y=i(A,Y),!_(Y))throw new Error("addImage does not support files of type '"+Y+"', please ensure that a plugin for '"+Y+"' support is added.");if(((K=ee)==null||K.length===0)&&(ee=(function(te){return typeof te=="string"||F(te)?L(te):F(te.data)?L(te.data):null})(A)),(H=C.call(this,ee))||(A instanceof Uint8Array||Y==="RGBA"||(V=A,A=G(A)),H=this["process"+Y.toUpperCase()](A,m.call(this),ee,(function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in t.image_compression?te:k.NONE})(J),V)),!H)throw new Error("An unknown error occurred whilst processing the image.");return H},E=t.__addimage__.convertBase64ToBinaryString=function(A,Y){Y=typeof Y!="boolean"||Y;var ee,J="";if(typeof A=="string"){var H;ee=(H=P(A))!==null&&H!==void 0?H:A;try{J=Dp(ee)}catch(V){if(Y)throw M(ee)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return J};t.getImageProperties=function(A){var Y,ee,J="";if(p(A)&&(A=g(A)),typeof A=="string"&&i(A)===n&&((J=E(A,!1))===""&&(J=t.loadFile(A)||""),A=J),ee=i(A),!_(ee))throw new Error("addImage does not support files of type '"+ee+"', please ensure that a plugin for '"+ee+"' support is added.");if(A instanceof Uint8Array||(A=G(A)),!(Y=this["process"+ee.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return Y.fileType=ee,Y}})(nn.API),(function(t){var e=function(n){if(n!==void 0&&n!="")return!0};nn.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,a,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(n.objId),h=n.pageContext.annotations,m=!1,_=0;_<h.length&&!m;_++)switch((r=h[_]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var p=0;p<h.length;p++){r=h[p];var g=this.internal.pdfEscape,C=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(y.objId),k=r.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+c(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+c(r.bounds.y)+"] ")+"/Contents ("+g(v(r.contents))+")",a+=" /Popup "+S.objId+" 0 R",a+=" /P "+u.objId+" 0 R",a+=" /T ("+g(v(k))+") >>",y.content=a;var L=y.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+c(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+c(r.bounds.y)+"] ")+" /Parent "+L,r.open&&(a+=" /Open true"),a+=" >>",S.content=a,this.internal.write(y.objId,"0 R",S.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+c(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+c(r.bounds.y+r.bounds.h)+"] ";var M=r.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+g(C(r.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(r.options.name){var P=this.annotations._nameMap[r.options.name];r.options.pageNumber=P.page,r.options.top=P.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",a="",r.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+g(C(r.options.url))+") >>";else if(r.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,a+=" /FitV "+r.options.left+"]";break;default:var F=c(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),a+=" /XYZ "+r.options.left+" "+F+" "+r.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,a,o){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(n),y:h(r),w:u(n+i),h:h(r+a)},options:o,type:"link"})},t.textWithLink=function(n,r,i,a){var o,c,u=this.getTextWidth(n),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){c=a.maxWidth;var m=this.splitTextToSize(n,c).length;o=Math.ceil(h*m)}else c=u,o=h;return this.text(n,r,i,a),i+=.2*h,a.align==="center"&&(r-=u/2),a.align==="right"&&(r-=u),this.link(r,i-h,c,o,a),u},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}})(nn.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(y){return e[y.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},c=t.__arabicParser__.isArabicEndLetter=function(y){return o(y)&&a(y)&&e[y.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(y){return o(y)&&i.indexOf(y.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return o(y)&&a(y)&&e[y.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(y){return o(y)&&a(y)&&e[y.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(y){return o(y)&&a(y)&&e[y.charCodeAt(0)].length>=3};var m=t.__arabicParser__.arabicLetterHasMedialForm=function(y){return o(y)&&a(y)&&e[y.charCodeAt(0)].length==4},_=t.__arabicParser__.resolveLigatures=function(y){var S=0,v=n,k="",L=0;for(S=0;S<y.length;S+=1)v[y.charCodeAt(S)]!==void 0?(L++,typeof(v=v[y.charCodeAt(S)])=="number"&&(k+=String.fromCharCode(v),v=n,L=0),S===y.length-1&&(v=n,k+=y.charAt(S-(L-1)),S-=L-1,L=0)):(v=n,k+=y.charAt(S-L),S-=L,L=0);return k};t.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&r[y.charCodeAt(0)]!==void 0};var p=t.__arabicParser__.getCorrectForm=function(y,S,v){return o(y)?a(y)===!1?-1:!h(y)||!o(S)&&!o(v)||!o(v)&&c(S)||c(y)&&!o(S)||c(y)&&u(S)||c(y)&&c(S)?0:m(y)&&o(S)&&!c(S)&&o(v)&&h(v)?3:c(y)||!o(v)?1:2:-1},g=function(y){var S=0,v=0,k=0,L="",M="",P="",F=(y=y||"").split("\\s+"),G=[];for(S=0;S<F.length;S+=1){for(G.push(""),v=0;v<F[S].length;v+=1)L=F[S][v],M=F[S][v-1],P=F[S][v+1],o(L)?(k=p(L,M,P),G[S]+=k!==-1?String.fromCharCode(e[L.charCodeAt(0)][k]):L):G[S]+=L;G[S]=_(G[S])}return G.join(" ")},C=t.__arabicParser__.processArabic=t.processArabic=function(){var y,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(S)){var k=0;for(v=[],k=0;k<S.length;k+=1)Array.isArray(S[k])?v.push([g(S[k][0]),S[k][1],S[k][2]]):v.push([g(S[k])]);y=v}else y=g(S);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};t.events.push(["preProcessText",C])})(nn.API),nn.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(c){n=c}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(c){r=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(c){i=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(c){a=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(nn.API),(function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(y){u=y}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var _=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return _},set:function(y){_=y}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(y){g=y}});var C=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return C},set:function(y){C=y}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,h){r.call(this);var m=(h=h||{}).fontSize||this.getFontSize(),_=h.font||this.getFont(),p=h.scaleFactor||this.internal.scaleFactor,g=0,C=0,y=0,S=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var v=h.maxWidth;v>0?typeof u=="string"?u=this.splitTextToSize(u,v):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(L,M){return L.concat(S.splitTextToSize(M,v))},[])):u=Array.isArray(u)?u:[u];for(var k=0;k<u.length;k++)g<(y=this.getStringUnitWidth(u[k],{font:_})*m)&&(g=y);return g!==0&&(C=u.length),{w:g/=p,h:Math.max((C*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/p,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var u;u=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var h=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,_=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+_.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=_.top,g&&p&&(this.printHeaderRow(u.lineNumber,!0),u.y+=p[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,n===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-m,u.y+m,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+m,{align:"center",baseline:"top",maxWidth:u.width-m-m}):this.text(u.text,u.x+m,u.y+m,{align:"left",baseline:"top",maxWidth:u.width-m-m})),this.internal.__cell__.lastCell=u,this};t.table=function(u,h,m,_,p){if(r.call(this),!m)throw new Error("No data for PDF table.");var g,C,y,S,v=[],k=[],L=[],M={},P={},F=[],G=[],B=(p=p||{}).autoSize||!1,I=p.printHeaders!==!1,E=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,A=p.margins||Object.assign({width:this.getPageWidth()},e),Y=typeof p.padding=="number"?p.padding:3,ee=p.headerBackgroundColor||"#c8c8c8",J=p.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=I,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=E,this.internal.__cell__.padding=Y,this.internal.__cell__.headerBackgroundColor=ee,this.internal.__cell__.headerTextColor=J,this.setFontSize(E),_==null)k=v=Object.keys(m[0]),L=v.map(function(){return"left"});else if(Array.isArray(_)&&Nr(_[0])==="object")for(v=_.map(function(ce){return ce.name}),k=_.map(function(ce){return ce.prompt||ce.name||""}),L=_.map(function(ce){return ce.align||"left"}),g=0;g<_.length;g+=1)P[_[g].name]=.7499990551181103*_[g].width;else Array.isArray(_)&&typeof _[0]=="string"&&(k=v=_,L=v.map(function(){return"left"}));if(B||Array.isArray(_)&&typeof _[0]=="string")for(g=0;g<v.length;g+=1){for(M[S=v[g]]=m.map(function(ce){return ce[S]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(k[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),C=M[S],this.setFont(void 0,"normal"),y=0;y<C.length;y+=1)F.push(this.getTextDimensions(C[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[S]=Math.max.apply(null,F)+Y+Y,F=[]}if(I){var H={};for(g=0;g<v.length;g+=1)H[v[g]]={},H[v[g]].text=k[g],H[v[g]].align=L[g];var V=c.call(this,H,P);G=v.map(function(ce){return new a(u,h,P[ce],V,H[ce].text,void 0,H[ce].align)}),this.setTableHeaderRow(G),this.printHeaderRow(1,!1)}var K=_.reduce(function(ce,R){return ce[R.name]=R.align,ce},{});for(g=0;g<m.length;g+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:g,data:m[g]},this);var j=c.call(this,m[g],P);for(y=0;y<v.length;y+=1){var te=m[g][v[y]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:g,col:y,data:te},this),o.call(this,new a(u,h,P[v[y]],j,te,g+2,K[v[y]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var c=function(u,h){var m=this.internal.__cell__.padding,_=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(u).map(function(g){var C=u[g];return this.splitTextToSize(C.hasOwnProperty("text")?C.text:C,h[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*_/p+m+m},this).reduce(function(g,C){return Math.max(g,C)},0)};t.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,h){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var _=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(_[0],_[1],_[2],_[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),h&&(m.y=this.internal.__cell__.margins.top||0,p.push(m)),m.lineNumber=u;var C=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,m),this.setTextColor(C)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),n=!1}})(nn.API);var SO={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},vO=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],G2=NO(vO),EO=[100,200,300,400,500,600,700,800,900],SH=NO(EO);function EC(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(a){return SO[a=a||"normal"]?a:"normal"})(t.style),r=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof G2[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function bT(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var vH={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},CT={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function NT(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function ST(t){return t.trimLeft()}function EH(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function DH(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var ff,lp,vT,ET,DT,DC=["times"];function RT(t,e,n,r,i){var a=4,o=MT;switch(i){case nn.API.image_compression.FAST:a=1,o=TT;break;case nn.API.image_compression.MEDIUM:a=6,o=IT;break;case nn.API.image_compression.SLOW:a=9,o=jT}t=(function(u,h,m,_){for(var p,g=u.length/h,C=new Uint8Array(u.length+g),y=[RH,TT,MT,IT,jT],S=0;S<g;S+=1){var v=S*h,k=u.subarray(v,v+h);if(_)C.set(_(k,m,p),v+S);else{for(var L=y.length,M=[],P=0;P<L;P+=1)M[P]=y[P](k,m,p);var F=MH(M.concat());C.set(M[F],v+S)}p=k}return C})(t,e,Math.ceil(n*r/8),o);var c=w2(t,{level:a});return nn.API.__addimage__.arrayBufferToBinaryString(c)}function RH(t){var e=Array.apply([],t);return e.unshift(0),e}function TT(t,e){var n=t.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var a=t[i-e]||0;r[i+1]=t[i]-a+256&255}return r}function MT(t,e,n){var r=t.length,i=[];i[0]=2;for(var a=0;a<r;a+=1){var o=n&&n[a]||0;i[a+1]=t[a]-o+256&255}return i}function IT(t,e,n){var r=t.length,i=[];i[0]=3;for(var a=0;a<r;a+=1){var o=t[a-e]||0,c=n&&n[a]||0;i[a+1]=t[a]+256-(o+c>>>1)&255}return i}function jT(t,e,n){var r=t.length,i=[];i[0]=4;for(var a=0;a<r;a+=1){var o=TH(t[a-e]||0,n&&n[a]||0,n&&n[a-e]||0);i[a+1]=t[a]-o+256&255}return i}function TH(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),a=Math.abs(t+e-n-n);return r<=i&&r<=a?t:i<=a?e:n}function MH(t){var e=t.map(function(n){return n.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function RC(t,e,n){var r=e*n,i=Math.floor(r/8),a=16-(r-8*i+n),o=(1<<n)-1;return DO(t,i)>>a&o}function OT(t,e,n,r){var i=n*r,a=Math.floor(i/8),o=16-(i-8*a+r),c=(1<<r)-1,u=(e&c)<<o;(function(h,m,_){if(m+1<h.byteLength)h.setUint16(m,_,!1);else{var p=_>>8&255;h.setUint8(m,p)}})(t,a,DO(t,a)&~(c<<o)&65535|u)}function DO(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function IH(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,o=1<<1+(7&i);t[e++],t[e++];var c=null,u=null;a&&(c=e,u=o,e+=3*o);var h=!0,m=[],_=0,p=null,g=0,C=null;for(this.width=n,this.height=r;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,C=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var y=t[e++];_=t[e++]|t[e++]<<8,p=t[e++],1&y||(p=null),g=y>>2&7,e++;break;case 254:for(;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var S=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,L=t[e++]|t[e++]<<8,M=t[e++],P=M>>6&1,F=1<<1+(7&M),G=c,B=u,I=!1;M>>7&&(I=!0,G=e,B=F,e+=3*F);var E=e;for(e++;;){var A;if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}m.push({x:S,y:v,width:k,height:L,has_local_palette:I,palette_offset:G,palette_size:B,data_offset:E,data_length:e-E,transparent_index:p,interlaced:!!P,delay:_,disposal:g});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return C},this.frameInfo=function(Y){if(Y<0||Y>=m.length)throw new Error("Frame index out of range.");return m[Y]},this.decodeAndBlitFrameBGRA=function(Y,ee){var J=this.frameInfo(Y),H=J.width*J.height;if(H>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var V=new Uint8Array(H);wT(t,J.data_offset,V,H);var K=J.palette_offset,j=J.transparent_index;j===null&&(j=256);var te=J.width,ce=n-te,R=te,O=4*(J.y*n+J.x),U=4*((J.y+J.height)*n+J.x),Q=O,q=4*ce;J.interlaced===!0&&(q+=4*n*7);for(var $=8,de=0,ae=V.length;de<ae;++de){var _e=V[de];if(R===0&&(R=te,(Q+=q)>=U&&(q=4*ce+4*n*($-1),Q=O+(te+ce)*($<<1),$>>=1)),_e===j)Q+=4;else{var ie=t[K+3*_e],Ne=t[K+3*_e+1],X=t[K+3*_e+2];ee[Q++]=X,ee[Q++]=Ne,ee[Q++]=ie,ee[Q++]=255}--R}},this.decodeAndBlitFrameRGBA=function(Y,ee){var J=this.frameInfo(Y),H=J.width*J.height;if(H>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var V=new Uint8Array(H);wT(t,J.data_offset,V,H);var K=J.palette_offset,j=J.transparent_index;j===null&&(j=256);var te=J.width,ce=n-te,R=te,O=4*(J.y*n+J.x),U=4*((J.y+J.height)*n+J.x),Q=O,q=4*ce;J.interlaced===!0&&(q+=4*n*7);for(var $=8,de=0,ae=V.length;de<ae;++de){var _e=V[de];if(R===0&&(R=te,(Q+=q)>=U&&(q=4*ce+4*n*($-1),Q=O+(te+ce)*($<<1),$>>=1)),_e===j)Q+=4;else{var ie=t[K+3*_e],Ne=t[K+3*_e+1],X=t[K+3*_e+2];ee[Q++]=ie,ee[Q++]=Ne,ee[Q++]=X,ee[Q++]=255}--R}}}function wT(t,e,n,r){for(var i=t[e++],a=1<<i,o=a+1,c=o+1,u=i+1,h=(1<<u)-1,m=0,_=0,p=0,g=t[e++],C=new Int32Array(4096),y=null;;){for(;m<16&&g!==0;)_|=t[e++]<<m,m+=8,g===1?g=t[e++]:--g;if(m<u)break;var S=_&h;if(_>>=u,m-=u,S!==a){if(S===o)break;for(var v=S<c?S:y,k=0,L=v;L>a;)L=C[L]>>8,++k;var M=L;if(p+k+(v!==S?1:0)>r)return void Lr.log("Warning, gif stream longer than expected.");n[p++]=M;var P=p+=k;for(v!==S&&(n[p++]=M),L=v;k--;)L=C[L],n[--P]=255&L,L>>=8;y!==null&&c<4096&&(C[c++]=y<<8|M,c>=h+1&&u<12&&(++u,h=h<<1|1)),y=S}else c=o+1,h=(1<<(u=i+1))-1,y=null}return p!==r&&Lr.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function TC(t){var e,n,r,i,a,o=Math.floor,c=new Array(64),u=new Array(64),h=new Array(64),m=new Array(64),_=new Array(65535),p=new Array(65535),g=new Array(64),C=new Array(64),y=[],S=0,v=7,k=new Array(64),L=new Array(64),M=new Array(64),P=new Array(256),F=new Array(2048),G=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Y=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ee=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],H=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(O,U){for(var Q=0,q=0,$=new Array,de=1;de<=16;de++){for(var ae=1;ae<=O[de];ae++)$[U[q]]=[],$[U[q]][0]=Q,$[U[q]][1]=de,q++,Q++;Q*=2}return $}function K(O){for(var U=O[0],Q=O[1]-1;Q>=0;)U&1<<Q&&(S|=1<<v),Q--,--v<0&&(S==255?(j(255),j(0)):j(S),v=7,S=0)}function j(O){y.push(O)}function te(O){j(O>>8&255),j(255&O)}function ce(O,U,Q,q,$){for(var de,ae=$[0],_e=$[240],ie=(function(be,De){var re,me,ve,et,Dt,ot,At,ct,Ge,at,xt=0;for(Ge=0;Ge<8;++Ge){re=be[xt],me=be[xt+1],ve=be[xt+2],et=be[xt+3],Dt=be[xt+4],ot=be[xt+5],At=be[xt+6];var mt=re+(ct=be[xt+7]),Ve=re-ct,it=me+At,Fe=me-At,nt=ve+ot,lt=ve-ot,Mt=et+Dt,ut=et-Dt,qe=mt+Mt,Ee=mt-Mt,Ye=it+nt,pe=it-nt;be[xt]=qe+Ye,be[xt+4]=qe-Ye;var ge=.707106781*(pe+Ee);be[xt+2]=Ee+ge,be[xt+6]=Ee-ge;var Be=.382683433*((qe=ut+lt)-(pe=Fe+Ve)),ue=.5411961*qe+Be,we=1.306562965*pe+Be,Je=.707106781*(Ye=lt+Fe),Pe=Ve+Je,Nt=Ve-Je;be[xt+5]=Nt+ue,be[xt+3]=Nt-ue,be[xt+1]=Pe+we,be[xt+7]=Pe-we,xt+=8}for(xt=0,Ge=0;Ge<8;++Ge){re=be[xt],me=be[xt+8],ve=be[xt+16],et=be[xt+24],Dt=be[xt+32],ot=be[xt+40],At=be[xt+48];var Oe=re+(ct=be[xt+56]),dt=re-ct,gt=me+At,It=me-At,$e=ve+ot,$t=ve-ot,Ue=et+Dt,ss=et-Dt,ls=Oe+Ue,ds=Oe-Ue,vs=gt+$e,Ss=gt-$e;be[xt]=ls+vs,be[xt+32]=ls-vs;var ke=.707106781*(Ss+ds);be[xt+16]=ds+ke,be[xt+48]=ds-ke;var ft=.382683433*((ls=ss+$t)-(Ss=It+dt)),st=.5411961*ls+ft,Ft=1.306562965*Ss+ft,_t=.707106781*(vs=$t+It),qt=dt+_t,jt=dt-_t;be[xt+40]=jt+st,be[xt+24]=jt-st,be[xt+8]=qt+Ft,be[xt+56]=qt-Ft,xt++}for(Ge=0;Ge<64;++Ge)at=be[Ge]*De[Ge],g[Ge]=at>0?at+.5|0:at-.5|0;return g})(O,U),Ne=0;Ne<64;++Ne)C[G[Ne]]=ie[Ne];var X=C[0]-Q;Q=C[0],X==0?K(q[0]):(K(q[p[de=32767+X]]),K(_[de]));for(var xe=63;xe>0&&C[xe]==0;)xe--;if(xe==0)return K(ae),Q;for(var fe,Z=1;Z<=xe;){for(var le=Z;C[Z]==0&&Z<=xe;)++Z;var se=Z-le;if(se>=16){fe=se>>4;for(var Re=1;Re<=fe;++Re)K(_e);se&=15}de=32767+C[Z],K($[(se<<4)+p[de]]),K(_[de]),Z++}return xe!=63&&K(ae),Q}function R(O){O=Math.min(Math.max(O,1),100),a!=O&&((function(U){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var $=o((Q[q]*U+50)/100);$=Math.min(Math.max($,1),255),c[G[q]]=$}for(var de=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ae=0;ae<64;ae++){var _e=o((de[ae]*U+50)/100);_e=Math.min(Math.max(_e,1),255),u[G[ae]]=_e}for(var ie=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ne=0,X=0;X<8;X++)for(var xe=0;xe<8;xe++)h[Ne]=1/(c[G[Ne]]*ie[X]*ie[xe]*8),m[Ne]=1/(u[G[Ne]]*ie[X]*ie[xe]*8),Ne++})(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),a=O)}this.encode=function(O,U){U&&R(U),y=new Array,S=0,v=7,te(65496),te(65504),te(16),j(74),j(70),j(73),j(70),j(0),j(1),j(1),j(0),te(1),te(1),j(0),j(0),(function(){te(65499),te(132),j(0);for(var me=0;me<64;me++)j(c[me]);j(1);for(var ve=0;ve<64;ve++)j(u[ve])})(),(function(me,ve){te(65472),te(17),j(8),te(ve),te(me),j(3),j(1),j(17),j(0),j(2),j(17),j(1),j(3),j(17),j(1)})(O.width,O.height),(function(){te(65476),te(418),j(0);for(var me=0;me<16;me++)j(B[me+1]);for(var ve=0;ve<=11;ve++)j(I[ve]);j(16);for(var et=0;et<16;et++)j(E[et+1]);for(var Dt=0;Dt<=161;Dt++)j(A[Dt]);j(1);for(var ot=0;ot<16;ot++)j(Y[ot+1]);for(var At=0;At<=11;At++)j(ee[At]);j(17);for(var ct=0;ct<16;ct++)j(J[ct+1]);for(var Ge=0;Ge<=161;Ge++)j(H[Ge])})(),te(65498),te(12),j(3),j(1),j(0),j(2),j(17),j(3),j(17),j(0),j(63),j(0);var Q=0,q=0,$=0;S=0,v=7,this.encode.displayName="_encode_";for(var de,ae,_e,ie,Ne,X,xe,fe,Z,le=O.data,se=O.width,Re=O.height,be=4*se,De=0;De<Re;){for(de=0;de<be;){for(Ne=be*De+de,xe=-1,fe=0,Z=0;Z<64;Z++)X=Ne+(fe=Z>>3)*be+(xe=4*(7&Z)),De+fe>=Re&&(X-=be*(De+1+fe-Re)),de+xe>=be&&(X-=de+xe-be+4),ae=le[X++],_e=le[X++],ie=le[X++],k[Z]=(F[ae]+F[_e+256|0]+F[ie+512|0]>>16)-128,L[Z]=(F[ae+768|0]+F[_e+1024|0]+F[ie+1280|0]>>16)-128,M[Z]=(F[ae+1280|0]+F[_e+1536|0]+F[ie+1792|0]>>16)-128;Q=ce(k,h,Q,e,r),q=ce(L,m,q,n,i),$=ce(M,m,$,n,i),de+=32}De+=8}if(v>=0){var re=[];re[1]=v+1,re[0]=(1<<v+1)-1,K(re)}return te(65497),new Uint8Array(y)},t=t||50,(function(){for(var O=String.fromCharCode,U=0;U<256;U++)P[U]=O(U)})(),e=V(B,I),n=V(Y,ee),r=V(E,A),i=V(J,H),(function(){for(var O=1,U=2,Q=1;Q<=15;Q++){for(var q=O;q<U;q++)p[32767+q]=Q,_[32767+q]=[],_[32767+q][1]=Q,_[32767+q][0]=q;for(var $=-(U-1);$<=-O;$++)p[32767+$]=Q,_[32767+$]=[],_[32767+$][1]=Q,_[32767+$][0]=U-1+$;O<<=1,U<<=1}})(),(function(){for(var O=0;O<256;O++)F[O]=19595*O,F[O+256|0]=38470*O,F[O+512|0]=7471*O+32768,F[O+768|0]=-11059*O,F[O+1024|0]=-21709*O,F[O+1280|0]=32768*O+8421375,F[O+1536|0]=-27439*O,F[O+1792|0]=-5329*O})(),R(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ko(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function LT(t){function e(I){if(!I)throw Error("assert :P")}function n(I,E,A){for(var Y=0;4>Y;Y++)if(I[E+Y]!=A.charCodeAt(Y))return!0;return!1}function r(I,E,A,Y,ee){for(var J=0;J<ee;J++)I[E+J]=A[Y+J]}function i(I,E,A,Y){for(var ee=0;ee<Y;ee++)I[E+ee]=A}function a(I){return new Int32Array(I)}function o(I,E){for(var A=[],Y=0;Y<I;Y++)A.push(new E);return A}function c(I,E){var A=[];return(function Y(ee,J,H){for(var V=H[J],K=0;K<V&&(ee.push(H.length>J+1?[]:new E),!(H.length<J+1));K++)Y(ee[K],J+1,H)})(A,0,I),A}var u=function(){var I=this;function E(N,T){for(var z=1<<T-1>>>0;N&z;)z>>>=1;return z?(N&z-1)+z:N}function A(N,T,z,ne,Se){e(!(ne%z));do N[T+(ne-=z)]=Se;while(0<ne)}function Y(N,T,z,ne,Se){if(e(2328>=Se),512>=Se)var Ie=a(512);else if((Ie=a(Se))==null)return 0;return(function(Le,We,Qe,Xe,vt,Gt){var He,Tt,Pt=We,es=1<<Qe,kt=a(16),Jt=a(16);for(e(vt!=0),e(Xe!=null),e(Le!=null),e(0<Qe),Tt=0;Tt<vt;++Tt){if(15<Xe[Tt])return 0;++kt[Xe[Tt]]}if(kt[0]==vt)return 0;for(Jt[1]=0,He=1;15>He;++He){if(kt[He]>1<<He)return 0;Jt[He+1]=Jt[He]+kt[He]}for(Tt=0;Tt<vt;++Tt)He=Xe[Tt],0<Xe[Tt]&&(Gt[Jt[He]++]=Tt);if(Jt[15]==1)return(Xe=new ee).g=0,Xe.value=Gt[0],A(Le,Pt,1,es,Xe),es;var is,ys=-1,fs=es-1,qs=0,Fs=1,xn=1,$s=1<<Qe;for(Tt=0,He=1,vt=2;He<=Qe;++He,vt<<=1){if(Fs+=xn<<=1,0>(xn-=kt[He]))return 0;for(;0<kt[He];--kt[He])(Xe=new ee).g=He,Xe.value=Gt[Tt++],A(Le,Pt+qs,vt,$s,Xe),qs=E(qs,He)}for(He=Qe+1,vt=2;15>=He;++He,vt<<=1){if(Fs+=xn<<=1,0>(xn-=kt[He]))return 0;for(;0<kt[He];--kt[He]){if(Xe=new ee,(qs&fs)!=ys){for(Pt+=$s,is=1<<(ys=He)-Qe;15>ys&&!(0>=(is-=kt[ys]));)++ys,is<<=1;es+=$s=1<<(is=ys-Qe),Le[We+(ys=qs&fs)].g=is+Qe,Le[We+ys].value=Pt-We-ys}Xe.g=He-Qe,Xe.value=Gt[Tt++],A(Le,Pt+(qs>>Qe),vt,$s,Xe),qs=E(qs,He)}}return Fs!=2*Jt[15]-1?0:es})(N,T,z,ne,Se,Ie)}function ee(){this.value=this.g=0}function J(){this.value=this.g=0}function H(){this.G=o(5,ee),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ac,J)}function V(N,T,z,ne){e(N!=null),e(T!=null),e(2147483648>ne),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=T,N.pa=z,N.Jd=T,N.Yc=z+ne,N.Zc=4<=ne?z+ne-4+1:z,ae(N)}function K(N,T){for(var z=0;0<T--;)z|=ie(N,128)<<T;return z}function j(N,T){var z=K(N,T);return _e(N)?-z:z}function te(N,T,z,ne){var Se,Ie=0;for(e(N!=null),e(T!=null),e(4294967288>ne),N.Sb=ne,N.Ra=0,N.u=0,N.h=0,4<ne&&(ne=4),Se=0;Se<ne;++Se)Ie+=T[z+Se]<<8*Se;N.Ra=Ie,N.bb=ne,N.oa=T,N.pa=z}function ce(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<Yl-8>>>0,++N.bb,N.u-=8;q(N)&&(N.h=1,N.u=0)}function R(N,T){if(e(0<=T),!N.h&&T<=ya){var z=Q(N)&Ma[T];return N.u+=T,ce(N),z}return N.h=1,N.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function U(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Q(N){return N.Ra>>>(N.u&Yl-1)>>>0}function q(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>Yl}function $(N,T){N.u=T,N.h=q(N)}function de(N){N.u>=Vl&&(e(N.u>=Vl),ce(N))}function ae(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function _e(N){return K(N,1)}function ie(N,T){var z=N.Ca;0>N.b&&ae(N);var ne=N.b,Se=z*T>>>8,Ie=(N.I>>>ne>Se)+0;for(Ie?(z-=Se,N.I-=Se+1<<ne>>>0):z=Se+1,ne=z,Se=0;256<=ne;)Se+=8,ne>>=8;return ne=7^Se+Mo[ne],N.b-=ne,N.Ca=(z<<ne)-1,Ie}function Ne(N,T,z){N[T+0]=z>>24&255,N[T+1]=z>>16&255,N[T+2]=z>>8&255,N[T+3]=255&z}function X(N,T){return N[T+0]|N[T+1]<<8}function xe(N,T){return X(N,T)|N[T+2]<<16}function fe(N,T){return X(N,T)|X(N,T+2)<<16}function Z(N,T){var z=1<<T;return e(N!=null),e(0<T),N.X=a(z),N.X==null?0:(N.Mb=32-T,N.Xa=T,1)}function le(N,T){e(N!=null),e(T!=null),e(N.Xa==T.Xa),r(T.X,0,N.X,0,1<<T.Xa)}function se(){this.X=[],this.Xa=this.Mb=0}function Re(N,T,z,ne){e(z!=null),e(ne!=null);var Se=z[0],Ie=ne[0];return Se==0&&(Se=(N*Ie+T/2)/T),Ie==0&&(Ie=(T*Se+N/2)/N),0>=Se||0>=Ie?0:(z[0]=Se,ne[0]=Ie,1)}function be(N,T){return N+(1<<T)-1>>>T}function De(N,T){return((4278255360&N)+(4278255360&T)>>>0&4278255360)+((16711935&N)+(16711935&T)>>>0&16711935)>>>0}function re(N,T){I[T]=function(z,ne,Se,Ie,Le,We,Qe){var Xe;for(Xe=0;Xe<Le;++Xe){var vt=I[N](We[Qe+Xe-1],Se,Ie+Xe);We[Qe+Xe]=De(z[ne+Xe],vt)}}}function me(){this.ud=this.hd=this.jd=0}function ve(N,T){return((4278124286&(N^T))>>>1)+(N&T)>>>0}function et(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function Dt(N,T){return et(N+(N-T+.5>>1))}function ot(N,T,z){return Math.abs(T-z)-Math.abs(N-z)}function At(N,T,z,ne,Se,Ie,Le){for(ne=Ie[Le-1],z=0;z<Se;++z)Ie[Le+z]=ne=De(N[T+z],ne)}function ct(N,T,z,ne,Se){var Ie;for(Ie=0;Ie<z;++Ie){var Le=N[T+Ie],We=Le>>8&255,Qe=16711935&(Qe=(Qe=16711935&Le)+((We<<16)+We));ne[Se+Ie]=(4278255360&Le)+Qe>>>0}}function Ge(N,T){T.jd=255&N,T.hd=N>>8&255,T.ud=N>>16&255}function at(N,T,z,ne,Se,Ie){var Le;for(Le=0;Le<ne;++Le){var We=T[z+Le],Qe=We>>>8,Xe=We,vt=255&(vt=(vt=We>>>16)+((N.jd<<24>>24)*(Qe<<24>>24)>>>5));Xe=255&(Xe=(Xe+=(N.hd<<24>>24)*(Qe<<24>>24)>>>5)+((N.ud<<24>>24)*(vt<<24>>24)>>>5)),Se[Ie+Le]=(4278255360&We)+(vt<<16)+Xe}}function xt(N,T,z,ne,Se){I[T]=function(Ie,Le,We,Qe,Xe,vt,Gt,He,Tt){for(Qe=Gt;Qe<He;++Qe)for(Gt=0;Gt<Tt;++Gt)Xe[vt++]=Se(We[ne(Ie[Le++])])},I[N]=function(Ie,Le,We,Qe,Xe,vt,Gt){var He=8>>Ie.b,Tt=Ie.Ea,Pt=Ie.K[0],es=Ie.w;if(8>He)for(Ie=(1<<Ie.b)-1,es=(1<<He)-1;Le<We;++Le){var kt,Jt=0;for(kt=0;kt<Tt;++kt)kt&Ie||(Jt=ne(Qe[Xe++])),vt[Gt++]=Se(Pt[Jt&es]),Jt>>=He}else I["VP8LMapColor"+z](Qe,Xe,Pt,es,vt,Gt,Le,We,Tt)}}function mt(N,T,z,ne,Se){for(z=T+z;T<z;){var Ie=N[T++];ne[Se++]=Ie>>16&255,ne[Se++]=Ie>>8&255,ne[Se++]=255&Ie}}function Ve(N,T,z,ne,Se){for(z=T+z;T<z;){var Ie=N[T++];ne[Se++]=Ie>>16&255,ne[Se++]=Ie>>8&255,ne[Se++]=255&Ie,ne[Se++]=Ie>>24&255}}function it(N,T,z,ne,Se){for(z=T+z;T<z;){var Ie=(Le=N[T++])>>16&240|Le>>12&15,Le=240&Le|Le>>28&15;ne[Se++]=Ie,ne[Se++]=Le}}function Fe(N,T,z,ne,Se){for(z=T+z;T<z;){var Ie=(Le=N[T++])>>16&248|Le>>13&7,Le=Le>>5&224|Le>>3&31;ne[Se++]=Ie,ne[Se++]=Le}}function nt(N,T,z,ne,Se){for(z=T+z;T<z;){var Ie=N[T++];ne[Se++]=255&Ie,ne[Se++]=Ie>>8&255,ne[Se++]=Ie>>16&255}}function lt(N,T,z,ne,Se,Ie){if(Ie==0)for(z=T+z;T<z;)Ne(ne,((Ie=N[T++])[0]>>24|Ie[1]>>8&65280|Ie[2]<<8&16711680|Ie[3]<<24)>>>0),Se+=32;else r(ne,Se,N,T,z)}function Mt(N,T){I[T][0]=I[N+"0"],I[T][1]=I[N+"1"],I[T][2]=I[N+"2"],I[T][3]=I[N+"3"],I[T][4]=I[N+"4"],I[T][5]=I[N+"5"],I[T][6]=I[N+"6"],I[T][7]=I[N+"7"],I[T][8]=I[N+"8"],I[T][9]=I[N+"9"],I[T][10]=I[N+"10"],I[T][11]=I[N+"11"],I[T][12]=I[N+"12"],I[T][13]=I[N+"13"],I[T][14]=I[N+"0"],I[T][15]=I[N+"0"]}function ut(N){return N==ch||N==E0||N==Wd||N==D0}function qe(){this.eb=[],this.size=this.A=this.fb=0}function Ee(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ye(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new qe,this.f.kb=new Ee,this.sd=null}function pe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ge(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Be(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function ue(N,T){var z=N.T,ne=T.ba.f.RGBA,Se=ne.eb,Ie=ne.fb+N.ka*ne.A,Le=Qi[T.ba.S],We=N.y,Qe=N.O,Xe=N.f,vt=N.N,Gt=N.ea,He=N.W,Tt=T.cc,Pt=T.dc,es=T.Mc,kt=T.Nc,Jt=N.ka,is=N.ka+N.T,ys=N.U,fs=ys+1>>1;for(Jt==0?Le(We,Qe,null,null,Xe,vt,Gt,He,Xe,vt,Gt,He,Se,Ie,null,null,ys):(Le(T.ec,T.fc,We,Qe,Tt,Pt,es,kt,Xe,vt,Gt,He,Se,Ie-ne.A,Se,Ie,ys),++z);Jt+2<is;Jt+=2)Tt=Xe,Pt=vt,es=Gt,kt=He,vt+=N.Rc,He+=N.Rc,Ie+=2*ne.A,Le(We,(Qe+=2*N.fa)-N.fa,We,Qe,Tt,Pt,es,kt,Xe,vt,Gt,He,Se,Ie-ne.A,Se,Ie,ys);return Qe+=N.fa,N.j+is<N.o?(r(T.ec,T.fc,We,Qe,ys),r(T.cc,T.dc,Xe,vt,fs),r(T.Mc,T.Nc,Gt,He,fs),z--):1&is||Le(We,Qe,null,null,Xe,vt,Gt,He,Xe,vt,Gt,He,Se,Ie+ne.A,null,null,ys),z}function we(N,T,z){var ne=N.F,Se=[N.J];if(ne!=null){var Ie=N.U,Le=T.ba.S,We=Le==oh||Le==Wd;T=T.ba.f.RGBA;var Qe=[0],Xe=N.ka;Qe[0]=N.T,N.Kb&&(Xe==0?--Qe[0]:(--Xe,Se[0]-=N.width),N.j+N.ka+N.T==N.o&&(Qe[0]=N.o-N.j-Xe));var vt=T.eb;Xe=T.fb+Xe*T.A,N=rh(ne,Se[0],N.width,Ie,Qe,vt,Xe+(We?0:3),T.A),e(z==Qe),N&&ut(Le)&&Fc(vt,Xe,We,Ie,Qe,T.A)}return 0}function Je(N){var T=N.ma,z=T.ba.S,ne=11>z,Se=z==aa||z==rl||z==oh||z==Gd||z==12||ut(z);if(T.memory=null,T.Ib=null,T.Jb=null,T.Nd=null,!To(T.Oa,N,Se?11:12))return 0;if(Se&&ut(z)&&eh(),N.da)alert("todo:use_scaling");else{if(ne){if(T.Ib=Be,N.Kb){if(z=N.U+1>>1,T.memory=a(N.U+2*z),T.memory==null)return 0;T.ec=T.memory,T.fc=0,T.cc=T.ec,T.dc=T.fc+N.U,T.Mc=T.cc,T.Nc=T.dc+z,T.Ib=ue,eh()}}else alert("todo:EmitYUV");Se&&(T.Jb=we,ne&&jl())}if(ne&&!fc){for(N=0;256>N;++N)Yi[N]=89858*(N-128)+Qd>>dl,ny[N]=-22014*(N-128)+Qd,F_[N]=-45773*(N-128),j0[N]=113618*(N-128)+Qd>>dl;for(N=Vc;N<hc;++N)T=76283*(N-16)+Qd>>dl,ry[N-Vc]=ht(T,255),iy[N-Vc]=ht(T+8>>4,15);fc=1}return 1}function Pe(N){var T=N.ma,z=N.U,ne=N.T;return e(!(1&N.ka)),0>=z||0>=ne?0:(z=T.Ib(N,T),T.Jb!=null&&T.Jb(N,T,z),T.Dc+=z,1)}function Nt(N){N.ma.memory=null}function Oe(N,T,z,ne){return R(N,8)!=47?0:(T[0]=R(N,14)+1,z[0]=R(N,14)+1,ne[0]=R(N,1),R(N,3)!=0?0:!N.h)}function dt(N,T){if(4>N)return N+1;var z=N-2>>1;return(2+(1&N)<<z)+R(T,z)+1}function gt(N,T){return 120<T?T-120:1<=(z=((z=al[T-1])>>4)*N+(8-(15&z)))?z:1;var z}function It(N,T,z){var ne=Q(z),Se=N[T+=255&ne].g-8;return 0<Se&&($(z,z.u+8),ne=Q(z),T+=N[T].value,T+=ne&(1<<Se)-1),$(z,z.u+N[T].g),N[T].value}function $e(N,T,z){return z.g+=N.g,z.value+=N.value<<T>>>0,e(8>=z.g),N.g}function $t(N,T,z){var ne=N.xc;return e((T=ne==0?0:N.vc[N.md*(z>>ne)+(T>>ne)])<N.Wb),N.Ya[T]}function Ue(N,T,z,ne){var Se=N.ab,Ie=N.c*T,Le=N.C;T=Le+T;var We=z,Qe=ne;for(ne=N.Ta,z=N.Ua;0<Se--;){var Xe=N.gc[Se],vt=Le,Gt=T,He=We,Tt=Qe,Pt=(Qe=ne,We=z,Xe.Ea);switch(e(vt<Gt),e(Gt<=Xe.nc),Xe.hc){case 2:ri(He,Tt,(Gt-vt)*Pt,Qe,We);break;case 0:var es=vt,kt=Gt,Jt=Qe,is=We,ys=($s=Xe).Ea;es==0&&(Ad(He,Tt,null,null,1,Jt,is),At(He,Tt+1,0,0,ys-1,Jt,is+1),Tt+=ys,is+=ys,++es);for(var fs=1<<$s.b,qs=fs-1,Fs=be(ys,$s.b),xn=$s.K,$s=$s.w+(es>>$s.b)*Fs;es<kt;){var Ln=xn,Or=$s,Nn=1;for(kd(He,Tt,Jt,is-ys,1,Jt,is);Nn<ys;){var Ks=(Nn&~qs)+fs;Ks>ys&&(Ks=ys),(0,Io[Ln[Or++]>>8&15])(He,Tt+ +Nn,Jt,is+Nn-ys,Ks-Nn,Jt,is+Nn),Nn=Ks}Tt+=ys,is+=ys,++es&qs||($s+=Fs)}Gt!=Xe.nc&&r(Qe,We-Pt,Qe,We+(Gt-vt-1)*Pt,Pt);break;case 1:for(Pt=He,kt=Tt,ys=(He=Xe.Ea)-(is=He&~(Jt=(Tt=1<<Xe.b)-1)),es=be(He,Xe.b),fs=Xe.K,Xe=Xe.w+(vt>>Xe.b)*es;vt<Gt;){for(qs=fs,Fs=Xe,xn=new me,$s=kt+is,Ln=kt+He;kt<$s;)Ge(qs[Fs++],xn),Ud(xn,Pt,kt,Tt,Qe,We),kt+=Tt,We+=Tt;kt<Ln&&(Ge(qs[Fs++],xn),Ud(xn,Pt,kt,ys,Qe,We),kt+=ys,We+=ys),++vt&Jt||(Xe+=es)}break;case 3:if(He==Qe&&Tt==We&&0<Xe.b){for(kt=Qe,He=Pt=We+(Gt-vt)*Pt-(is=(Gt-vt)*be(Xe.Ea,Xe.b)),Tt=Qe,Jt=We,es=[],is=(ys=is)-1;0<=is;--is)es[is]=Tt[Jt+is];for(is=ys-1;0<=is;--is)kt[He+is]=es[is];b0(Xe,vt,Gt,Qe,Pt,Qe,We)}else b0(Xe,vt,Gt,He,Tt,Qe,We)}We=ne,Qe=z}Qe!=z&&r(ne,z,We,Qe,Ie)}function ss(N,T){var z=N.V,ne=N.Ba+N.c*N.C,Se=T-N.C;if(e(T<=N.l.o),e(16>=Se),0<Se){var Ie=N.l,Le=N.Ta,We=N.Ua,Qe=Ie.width;if(Ue(N,Se,z,ne),Se=We=[We],e((z=N.C)<(ne=T)),e(Ie.v<Ie.va),ne>Ie.o&&(ne=Ie.o),z<Ie.j){var Xe=Ie.j-z;z=Ie.j,Se[0]+=Xe*Qe}if(z>=ne?z=0:(Se[0]+=4*Ie.v,Ie.ka=z-Ie.j,Ie.U=Ie.va-Ie.v,Ie.T=ne-z,z=1),z){if(We=We[0],11>(z=N.ca).S){var vt=z.f.RGBA,Gt=(ne=z.S,Se=Ie.U,Ie=Ie.T,Xe=vt.eb,vt.A),He=Ie;for(vt=vt.fb+N.Ma*vt.A;0<He--;){var Tt=Le,Pt=We,es=Se,kt=Xe,Jt=vt;switch(ne){case S0:Bd(Tt,Pt,es,kt,Jt);break;case aa:jo(Tt,Pt,es,kt,Jt);break;case ch:jo(Tt,Pt,es,kt,Jt),Fc(kt,Jt,0,es,1,0);break;case v0:Gc(Tt,Pt,es,kt,Jt);break;case rl:lt(Tt,Pt,es,kt,Jt,1);break;case E0:lt(Tt,Pt,es,kt,Jt,1),Fc(kt,Jt,0,es,1,0);break;case oh:lt(Tt,Pt,es,kt,Jt,0);break;case Wd:lt(Tt,Pt,es,kt,Jt,0),Fc(kt,Jt,1,es,1,0);break;case Gd:Oo(Tt,Pt,es,kt,Jt);break;case D0:Oo(Tt,Pt,es,kt,Jt),nl(kt,Jt,es,1,0);break;case lc:Hl(Tt,Pt,es,kt,Jt);break;default:e(0)}We+=Qe,vt+=Gt}N.Ma+=Ie}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=z.height)}}N.C=T,e(N.C<=N.i)}function ls(N){var T;if(0<N.ua)return 0;for(T=0;T<N.Wb;++T){var z=N.Ya[T].G,ne=N.Ya[T].H;if(0<z[1][ne[1]+0].g||0<z[2][ne[2]+0].g||0<z[3][ne[3]+0].g)return 0}return 1}function ds(N,T,z,ne,Se,Ie){if(N.Z!=0){var Le=N.qd,We=N.rd;for(e(Po[N.Z]!=null);T<z;++T)Po[N.Z](Le,We,ne,Se,ne,Se,Ie),Le=ne,We=Se,Se+=Ie;N.qd=Le,N.rd=We}}function vs(N,T){var z=N.l.ma,ne=z.Z==0||z.Z==1?N.l.j:N.C;if(ne=N.C<ne?ne:N.C,e(T<=N.l.o),T>ne){var Se=N.l.width,Ie=z.ca,Le=z.tb+Se*ne,We=N.V,Qe=N.Ba+N.c*ne,Xe=N.gc;e(N.ab==1),e(Xe[0].hc==3),zl(Xe[0],ne,T,We,Qe,Ie,Le),ds(z,ne,T,Ie,Le,Se)}N.C=N.Ma=T}function Ss(N,T,z,ne,Se,Ie,Le){var We=N.$/ne,Qe=N.$%ne,Xe=N.m,vt=N.s,Gt=z+N.$,He=Gt;Se=z+ne*Se;var Tt=z+ne*Ie,Pt=280+vt.ua,es=N.Pb?We:16777216,kt=0<vt.ua?vt.Wa:null,Jt=vt.wc,is=Gt<Tt?$t(vt,Qe,We):null;e(N.C<Ie),e(Tt<=Se);var ys=!1;e:for(;;){for(;ys||Gt<Tt;){var fs=0;if(We>=es){var qs=Gt-z;e((es=N).Pb),es.wd=es.m,es.xd=qs,0<es.s.ua&&le(es.s.Wa,es.s.vb),es=We+oc}if(Qe&Jt||(is=$t(vt,Qe,We)),e(is!=null),is.Qb&&(T[Gt]=is.qb,ys=!0),!ys)if(de(Xe),is.jc){fs=Xe,qs=T;var Fs=Gt,xn=is.pd[Q(fs)&ac-1];e(is.jc),256>xn.g?($(fs,fs.u+xn.g),qs[Fs]=xn.value,fs=0):($(fs,fs.u+xn.g-256),e(256<=xn.value),fs=xn.value),fs==0&&(ys=!0)}else fs=It(is.G[0],is.H[0],Xe);if(Xe.h)break;if(ys||256>fs){if(!ys)if(is.nd)T[Gt]=(is.qb|fs<<8)>>>0;else{if(de(Xe),ys=It(is.G[1],is.H[1],Xe),de(Xe),qs=It(is.G[2],is.H[2],Xe),Fs=It(is.G[3],is.H[3],Xe),Xe.h)break;T[Gt]=(Fs<<24|ys<<16|fs<<8|qs)>>>0}if(ys=!1,++Gt,++Qe>=ne&&(Qe=0,++We,Le!=null&&We<=Ie&&!(We%16)&&Le(N,We),kt!=null))for(;He<Gt;)fs=T[He++],kt.X[(506832829*fs&4294967295)>>>kt.Mb]=fs}else if(280>fs){if(fs=dt(fs-256,Xe),qs=It(is.G[4],is.H[4],Xe),de(Xe),qs=gt(ne,qs=dt(qs,Xe)),Xe.h)break;if(Gt-z<qs||Se-Gt<fs)break e;for(Fs=0;Fs<fs;++Fs)T[Gt+Fs]=T[Gt+Fs-qs];for(Gt+=fs,Qe+=fs;Qe>=ne;)Qe-=ne,++We,Le!=null&&We<=Ie&&!(We%16)&&Le(N,We);if(e(Gt<=Se),Qe&Jt&&(is=$t(vt,Qe,We)),kt!=null)for(;He<Gt;)fs=T[He++],kt.X[(506832829*fs&4294967295)>>>kt.Mb]=fs}else{if(!(fs<Pt))break e;for(ys=fs-280,e(kt!=null);He<Gt;)fs=T[He++],kt.X[(506832829*fs&4294967295)>>>kt.Mb]=fs;fs=Gt,e(!(ys>>>(qs=kt).Xa)),T[fs]=qs.X[ys],ys=!0}ys||e(Xe.h==q(Xe))}if(N.Pb&&Xe.h&&Gt<Se)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&le(N.s.vb,N.s.Wa);else{if(Xe.h)break e;Le!=null&&Le(N,We>Ie?Ie:We),N.a=0,N.$=Gt-z}return 1}return N.a=3,0}function ke(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var T=N.Wa;T!=null&&(T.X=null),N.vb=null,e(N!=null)}function ft(){var N=new mn;return N==null?null:(N.a=0,N.xb=Mm,Mt("Predictor","VP8LPredictors"),Mt("Predictor","VP8LPredictors_C"),Mt("PredictorAdd","VP8LPredictorsAdd"),Mt("PredictorAdd","VP8LPredictorsAdd_C"),ri=ct,Ud=at,Bd=mt,jo=Ve,Oo=it,Hl=Fe,Gc=nt,I.VP8LMapColor32b=$l,I.VP8LMapColor8b=Wi,N)}function st(N,T,z,ne,Se){var Ie=1,Le=[N],We=[T],Qe=ne.m,Xe=ne.s,vt=null,Gt=0;e:for(;;){if(z)for(;Ie&&R(Qe,1);){var He=Le,Tt=We,Pt=ne,es=1,kt=Pt.m,Jt=Pt.gc[Pt.ab],is=R(kt,2);if(Pt.Oc&1<<is)Ie=0;else{switch(Pt.Oc|=1<<is,Jt.hc=is,Jt.Ea=He[0],Jt.nc=Tt[0],Jt.K=[null],++Pt.ab,e(4>=Pt.ab),is){case 0:case 1:Jt.b=R(kt,3)+2,es=st(be(Jt.Ea,Jt.b),be(Jt.nc,Jt.b),0,Pt,Jt.K),Jt.K=Jt.K[0];break;case 3:var ys,fs=R(kt,8)+1,qs=16<fs?0:4<fs?1:2<fs?2:3;if(He[0]=be(Jt.Ea,qs),Jt.b=qs,ys=es=st(fs,1,0,Pt,Jt.K)){var Fs,xn=fs,$s=Jt,Ln=1<<(8>>$s.b),Or=a(Ln);if(Or==null)ys=0;else{var Nn=$s.K[0],Ks=$s.w;for(Or[0]=$s.K[0][0],Fs=1;Fs<1*xn;++Fs)Or[Fs]=De(Nn[Ks+Fs],Or[Fs-1]);for(;Fs<4*Ln;++Fs)Or[Fs]=0;$s.K[0]=null,$s.K[0]=Or,ys=1}}es=ys;break;case 2:break;default:e(0)}Ie=es}}if(Le=Le[0],We=We[0],Ie&&R(Qe,1)&&!(Ie=1<=(Gt=R(Qe,4))&&11>=Gt)){ne.a=3;break e}var Ts;if(Ts=Ie)t:{var Wr,un,En,lr=ne,Ni=Le,Vi=We,Er=Gt,ui=z,la=lr.m,hi=lr.s,In=[null],$n=1,Fr=0,Zn=ll[Er];s:for(;;){if(ui&&R(la,1)){var Si=R(la,3)+2,Kr=be(Ni,Si),zn=be(Vi,Si),li=Kr*zn;if(!st(Kr,zn,0,lr,In))break s;for(In=In[0],hi.xc=Si,Wr=0;Wr<li;++Wr){var or=In[Wr]>>8&65535;In[Wr]=or,or>=$n&&($n=or+1)}}if(la.h)break s;for(un=0;5>un;++un){var fi=Qc[un];!un&&0<Er&&(fi+=1<<Er),Fr<fi&&(Fr=fi)}var mi=o($n*Zn,ee),pr=$n,Qn=o(pr,H);if(Qn==null)var oa=null;else e(65536>=pr),oa=Qn;var qr=a(Fr);if(oa==null||qr==null||mi==null){lr.a=1;break s}var rn=mi;for(Wr=En=0;Wr<$n;++Wr){var ln=oa[Wr],Hn=ln.G,Ia=ln.H,ul=0,Ca=1,gi=0;for(un=0;5>un;++un){fi=Qc[un],Hn[un]=rn,Ia[un]=En,!un&&0<Er&&(fi+=1<<Er);r:{var mc,gc=fi,w0=lr,Dr=qr,jm=rn,Om=En,L0=0,Ao=w0.m,ay=R(Ao,1);if(i(Dr,0,0,gc),ay){var wm=R(Ao,1)+1,Lm=R(Ao,1),P0=R(Ao,Lm==0?1:8);Dr[P0]=1,wm==2&&(Dr[P0=R(Ao,8)]=1);var wi=1}else{var Xr=a(19),fh=R(Ao,4)+4;if(19<fh){w0.a=3;var _c=0;break r}for(mc=0;mc<fh;++mc)Xr[dh[mc]]=R(Ao,3);var Vd=void 0,$c=void 0,Jl=w0,A0=Xr,$d=gc,k0=Dr,U0=0,ko=Jl.m,Pm=8,Am=o(128,ee);n:for(;Y(Am,0,7,A0,19);){if(R(ko,1)){var K_=2+2*R(ko,3);if((Vd=2+R(ko,K_))>$d)break n}else Vd=$d;for($c=0;$c<$d&&Vd--;){de(ko);var km=Am[0+(127&Q(ko))];$(ko,ko.u+km.g);var xc=km.value;if(16>xc)k0[$c++]=xc,xc!=0&&(Pm=xc);else{var Q_=xc==16,Y_=xc-16,V_=Fd[Y_],Um=R(ko,il[Y_])+V_;if($c+Um>$d)break n;for(var $_=Q_?Pm:0;0<Um--;)k0[$c++]=$_}}U0=1;break n}U0||(Jl.a=3),wi=U0}(wi=wi&&!Ao.h)&&(L0=Y(jm,Om,8,Dr,gc)),wi&&L0!=0?_c=L0:(w0.a=3,_c=0)}if(_c==0)break s;if(Ca&&R0[un]==1&&(Ca=rn[En].g==0),ul+=rn[En].g,En+=_c,3>=un){var zc,B0=qr[0];for(zc=1;zc<fi;++zc)qr[zc]>B0&&(B0=qr[zc]);gi+=B0}}if(ln.nd=Ca,ln.Qb=0,Ca&&(ln.qb=(Hn[3][Ia[3]+0].value<<24|Hn[1][Ia[1]+0].value<<16|Hn[2][Ia[2]+0].value)>>>0,ul==0&&256>Hn[0][Ia[0]+0].value&&(ln.Qb=1,ln.qb+=Hn[0][Ia[0]+0].value<<8)),ln.jc=!ln.Qb&&6>gi,ln.jc){var mh,Zl=ln;for(mh=0;mh<ac;++mh){var Uo=mh,Bo=Zl.pd[Uo],G0=Zl.G[0][Zl.H[0]+Uo];256<=G0.value?(Bo.g=G0.g+256,Bo.value=G0.value):(Bo.g=0,Bo.value=0,Uo>>=$e(G0,8,Bo),Uo>>=$e(Zl.G[1][Zl.H[1]+Uo],16,Bo),Uo>>=$e(Zl.G[2][Zl.H[2]+Uo],0,Bo),$e(Zl.G[3][Zl.H[3]+Uo],24,Bo))}}}hi.vc=In,hi.Wb=$n,hi.Ya=oa,hi.yc=mi,Ts=1;break t}Ts=0}if(!(Ie=Ts)){ne.a=3;break e}if(0<Gt){if(Xe.ua=1<<Gt,!Z(Xe.Wa,Gt)){ne.a=1,Ie=0;break e}}else Xe.ua=0;var W0=ne,Hc=Le,z_=We,zd=W0.s,Hd=zd.xc;if(W0.c=Hc,W0.i=z_,zd.md=be(Hc,Hd),zd.wc=Hd==0?-1:(1<<Hd)-1,z){ne.xb=cc;break e}if((vt=a(Le*We))==null){ne.a=1,Ie=0;break e}Ie=(Ie=Ss(ne,vt,0,Le,We,We,null))&&!Qe.h;break e}return Ie?(Se!=null?Se[0]=vt:(e(vt==null),e(z)),ne.$=0,z||ke(Xe)):ke(Xe),Ie}function Ft(N,T){var z=N.c*N.i,ne=z+T+16*T;return e(N.c<=T),N.V=a(ne),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+z+T,1)}function _t(N,T){var z=N.C,ne=T-z,Se=N.V,Ie=N.Ba+N.c*z;for(e(T<=N.l.o);0<ne;){var Le=16<ne?16:ne,We=N.l.ma,Qe=N.l.width,Xe=Qe*Le,vt=We.ca,Gt=We.tb+Qe*z,He=N.Ta,Tt=N.Ua;Ue(N,Le,Se,Ie),Ka(He,Tt,vt,Gt,Xe),ds(We,z,z+Le,vt,Gt,Qe),ne-=Le,Se+=Le*N.c,z+=Le}e(z==T),N.C=N.Ma=T}function qt(){this.ub=this.yd=this.td=this.Rb=0}function jt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function he(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function ye(){this.Yb=(function(){var N=[];return(function T(z,ne,Se){for(var Ie=Se[ne],Le=0;Le<Ie&&(z.push(Se.length>ne+1?[]:0),!(Se.length<ne+1));Le++)T(z[Le],ne+1,Se)})(N,0,[3,11]),N})()}function je(){this.jb=a(3),this.Wc=c([4,8],ye),this.Xc=c([4,17],ye)}function Me(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function tt(){this.ld=this.La=this.dd=this.tc=0}function Te(){this.Na=this.la=0}function bt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ke(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function St(){this.uc=this.M=this.Nb=0,this.wa=Array(new tt),this.Y=0,this.ya=Array(new Ke),this.aa=0,this.l=new Lt}function Et(){this.y=a(16),this.f=a(8),this.ea=a(8)}function ze(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new qt,this.Kc=new jt,this.ed=new Me,this.Qa=new he,this.Ic=this.$c=this.Aa=0,this.D=new St,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,bt),this.Pa=new je,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Et),this.Hd=0,this.rb=Array(new Te),this.sb=0,this.wa=Array(new tt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ke),this.L=this.aa=0,this.gd=c([4,2],tt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ht(N,T){return 0>N?0:N>T?T:N}function Lt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bt(){var N=new ze;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,Qa||(Qa=Ut)),N}function Yt(N,T,z){return N.a==0&&(N.a=T,N.sc=z,N.cb=0),0}function Xt(N,T,z){return 3<=z&&N[T+0]==157&&N[T+1]==1&&N[T+2]==42}function ts(N,T){if(N==null)return 0;if(N.a=0,N.sc="OK",T==null)return Yt(N,2,"null VP8Io passed to VP8GetHeaders()");var z=T.data,ne=T.w,Se=T.ha;if(4>Se)return Yt(N,7,"Truncated header.");var Ie=z[ne+0]|z[ne+1]<<8|z[ne+2]<<16,Le=N.Od;if(Le.Rb=!(1&Ie),Le.td=Ie>>1&7,Le.yd=Ie>>4&1,Le.ub=Ie>>5,3<Le.td)return Yt(N,3,"Incorrect keyframe parameters.");if(!Le.yd)return Yt(N,4,"Frame not displayable.");ne+=3,Se-=3;var We=N.Kc;if(Le.Rb){if(7>Se)return Yt(N,7,"cannot parse picture header");if(!Xt(z,ne,Se))return Yt(N,3,"Bad code word");We.c=16383&(z[ne+4]<<8|z[ne+3]),We.Td=z[ne+4]>>6,We.i=16383&(z[ne+6]<<8|z[ne+5]),We.Ud=z[ne+6]>>6,ne+=7,Se-=7,N.za=We.c+15>>4,N.Ub=We.i+15>>4,T.width=We.c,T.height=We.i,T.Da=0,T.j=0,T.v=0,T.va=T.width,T.o=T.height,T.da=0,T.ib=T.width,T.hb=T.height,T.U=T.width,T.T=T.height,i((Ie=N.Pa).jb,0,255,Ie.jb.length),e((Ie=N.Qa)!=null),Ie.Cb=0,Ie.Bb=0,Ie.Fb=1,i(Ie.Zb,0,0,Ie.Zb.length),i(Ie.Lb,0,0,Ie.Lb)}if(Le.ub>Se)return Yt(N,7,"bad partition length");V(Ie=N.m,z,ne,Le.ub),ne+=Le.ub,Se-=Le.ub,Le.Rb&&(We.Ld=_e(Ie),We.Kd=_e(Ie)),We=N.Qa;var Qe,Xe=N.Pa;if(e(Ie!=null),e(We!=null),We.Cb=_e(Ie),We.Cb){if(We.Bb=_e(Ie),_e(Ie)){for(We.Fb=_e(Ie),Qe=0;4>Qe;++Qe)We.Zb[Qe]=_e(Ie)?j(Ie,7):0;for(Qe=0;4>Qe;++Qe)We.Lb[Qe]=_e(Ie)?j(Ie,6):0}if(We.Bb)for(Qe=0;3>Qe;++Qe)Xe.jb[Qe]=_e(Ie)?K(Ie,8):255}else We.Bb=0;if(Ie.Ka)return Yt(N,3,"cannot parse segment header");if((We=N.ed).zd=_e(Ie),We.Tb=K(Ie,6),We.wb=K(Ie,3),We.Pc=_e(Ie),We.Pc&&_e(Ie)){for(Xe=0;4>Xe;++Xe)_e(Ie)&&(We.vd[Xe]=j(Ie,6));for(Xe=0;4>Xe;++Xe)_e(Ie)&&(We.od[Xe]=j(Ie,6))}if(N.L=We.Tb==0?0:We.zd?1:2,Ie.Ka)return Yt(N,3,"cannot parse filter header");var vt=Se;if(Se=Qe=ne,ne=Qe+vt,We=vt,N.Xb=(1<<K(N.m,2))-1,vt<3*(Xe=N.Xb))z=7;else{for(Qe+=3*Xe,We-=3*Xe,vt=0;vt<Xe;++vt){var Gt=z[Se+0]|z[Se+1]<<8|z[Se+2]<<16;Gt>We&&(Gt=We),V(N.Jc[+vt],z,Qe,Gt),Qe+=Gt,We-=Gt,Se+=3}V(N.Jc[+Xe],z,Qe,We),z=Qe<ne?0:5}if(z!=0)return Yt(N,z,"cannot parse partitions");for(z=K(Qe=N.m,7),Se=_e(Qe)?j(Qe,4):0,ne=_e(Qe)?j(Qe,4):0,We=_e(Qe)?j(Qe,4):0,Xe=_e(Qe)?j(Qe,4):0,Qe=_e(Qe)?j(Qe,4):0,vt=N.Qa,Gt=0;4>Gt;++Gt){if(vt.Cb){var He=vt.Zb[Gt];vt.Fb||(He+=z)}else{if(0<Gt){N.pb[Gt]=N.pb[0];continue}He=z}var Tt=N.pb[Gt];Tt.Sc[0]=ol[ht(He+Se,127)],Tt.Sc[1]=cl[ht(He+0,127)],Tt.Eb[0]=2*ol[ht(He+ne,127)],Tt.Eb[1]=101581*cl[ht(He+We,127)]>>16,8>Tt.Eb[1]&&(Tt.Eb[1]=8),Tt.Qc[0]=ol[ht(He+Xe,117)],Tt.Qc[1]=cl[ht(He+Qe,127)],Tt.lc=He+Qe}if(!Le.Rb)return Yt(N,4,"Not a key frame.");for(_e(Ie),Le=N.Pa,z=0;4>z;++z){for(Se=0;8>Se;++Se)for(ne=0;3>ne;++ne)for(We=0;11>We;++We)Xe=ie(Ie,jr[z][Se][ne][We])?K(Ie,8):W_[z][Se][ne][We],Le.Wc[z][Se].Yb[ne][We]=Xe;for(Se=0;17>Se;++Se)Le.Xc[z][Se]=Le.Wc[z][Pn[Se]]}return N.kc=_e(Ie),N.kc&&(N.Bd=K(Ie,8)),N.cb=1}function Ut(N,T,z,ne,Se,Ie,Le){var We=T[Se].Yb[z];for(z=0;16>Se;++Se){if(!ie(N,We[z+0]))return Se;for(;!ie(N,We[z+1]);)if(We=T[++Se].Yb[0],z=0,Se==16)return 16;var Qe=T[Se+1].Yb;if(ie(N,We[z+2])){var Xe=N,vt=0;if(ie(Xe,(He=We)[(Gt=z)+3]))if(ie(Xe,He[Gt+6])){for(We=0,Gt=2*(vt=ie(Xe,He[Gt+8]))+(He=ie(Xe,He[Gt+9+vt])),vt=0,He=G_[Gt];He[We];++We)vt+=vt+ie(Xe,He[We]);vt+=3+(8<<Gt)}else ie(Xe,He[Gt+7])?(vt=7+2*ie(Xe,165),vt+=ie(Xe,145)):vt=5+ie(Xe,159);else vt=ie(Xe,He[Gt+4])?3+ie(Xe,He[Gt+5]):2;We=Qe[2]}else vt=1,We=Qe[1];Qe=Le+Tm[Se],0>(Xe=N).b&&ae(Xe);var Gt,He=Xe.b,Tt=(Gt=Xe.Ca>>1)-(Xe.I>>He)>>31;--Xe.b,Xe.Ca+=Tt,Xe.Ca|=1,Xe.I-=(Gt+1&Tt)<<He,Ie[Qe]=((vt^Tt)-Tt)*ne[(0<Se)+0]}return 16}function Is(N){var T=N.rb[N.sb-1];T.la=0,T.Na=0,i(N.zc,0,0,N.zc.length),N.ja=0}function Cs(N,T,z,ne,Se){Se=N[T+z+32*ne]+(Se>>3),N[T+z+32*ne]=-256&Se?0>Se?0:255:Se}function Us(N,T,z,ne,Se,Ie){Cs(N,T,0,z,ne+Se),Cs(N,T,1,z,ne+Ie),Cs(N,T,2,z,ne-Ie),Cs(N,T,3,z,ne-Se)}function _s(N){return(20091*N>>16)+N}function Es(N,T,z,ne){var Se,Ie=0,Le=a(16);for(Se=0;4>Se;++Se){var We=N[T+0]+N[T+8],Qe=N[T+0]-N[T+8],Xe=(35468*N[T+4]>>16)-_s(N[T+12]),vt=_s(N[T+4])+(35468*N[T+12]>>16);Le[Ie+0]=We+vt,Le[Ie+1]=Qe+Xe,Le[Ie+2]=Qe-Xe,Le[Ie+3]=We-vt,Ie+=4,T++}for(Se=Ie=0;4>Se;++Se)We=(N=Le[Ie+0]+4)+Le[Ie+8],Qe=N-Le[Ie+8],Xe=(35468*Le[Ie+4]>>16)-_s(Le[Ie+12]),Cs(z,ne,0,0,We+(vt=_s(Le[Ie+4])+(35468*Le[Ie+12]>>16))),Cs(z,ne,1,0,Qe+Xe),Cs(z,ne,2,0,Qe-Xe),Cs(z,ne,3,0,We-vt),Ie++,ne+=32}function Ls(N,T,z,ne){var Se=N[T+0]+4,Ie=35468*N[T+4]>>16,Le=_s(N[T+4]),We=35468*N[T+1]>>16;Us(z,ne,0,Se+Le,N=_s(N[T+1]),We),Us(z,ne,1,Se+Ie,N,We),Us(z,ne,2,Se-Ie,N,We),Us(z,ne,3,Se-Le,N,We)}function cs(N,T,z,ne,Se){Es(N,T,z,ne),Se&&Es(N,T+16,z,ne+4)}function ms(N,T,z,ne){wo(N,T+0,z,ne,1),wo(N,T+32,z,ne+128,1)}function Ys(N,T,z,ne){var Se;for(N=N[T+0]+4,Se=0;4>Se;++Se)for(T=0;4>T;++T)Cs(z,ne,T,Se,N)}function Ps(N,T,z,ne){N[T+0]&&Jn(N,T+0,z,ne),N[T+16]&&Jn(N,T+16,z,ne+4),N[T+32]&&Jn(N,T+32,z,ne+128),N[T+48]&&Jn(N,T+48,z,ne+128+4)}function rt(N,T,z,ne){var Se,Ie=a(16);for(Se=0;4>Se;++Se){var Le=N[T+0+Se]+N[T+12+Se],We=N[T+4+Se]+N[T+8+Se],Qe=N[T+4+Se]-N[T+8+Se],Xe=N[T+0+Se]-N[T+12+Se];Ie[0+Se]=Le+We,Ie[8+Se]=Le-We,Ie[4+Se]=Xe+Qe,Ie[12+Se]=Xe-Qe}for(Se=0;4>Se;++Se)Le=(N=Ie[0+4*Se]+3)+Ie[3+4*Se],We=Ie[1+4*Se]+Ie[2+4*Se],Qe=Ie[1+4*Se]-Ie[2+4*Se],Xe=N-Ie[3+4*Se],z[ne+0]=Le+We>>3,z[ne+16]=Xe+Qe>>3,z[ne+32]=Le-We>>3,z[ne+48]=Xe-Qe>>3,ne+=64}function Wt(N,T,z){var ne,Se=T-32,Ie=ia,Le=255-N[Se-1];for(ne=0;ne<z;++ne){var We,Qe=Ie,Xe=Le+N[T-1];for(We=0;We<z;++We)N[T+We]=Qe[Xe+N[Se+We]];T+=32}}function bs(N,T){Wt(N,T,4)}function zt(N,T){Wt(N,T,8)}function ws(N,T){Wt(N,T,16)}function Zt(N,T){var z;for(z=0;16>z;++z)r(N,T+32*z,N,T-32,16)}function Ds(N,T){var z;for(z=16;0<z;--z)i(N,T,N[T-1],16),T+=32}function js(N,T,z){var ne;for(ne=0;16>ne;++ne)i(T,z+32*ne,N,16)}function hs(N,T){var z,ne=16;for(z=0;16>z;++z)ne+=N[T-1+32*z]+N[T+z-32];js(ne>>5,N,T)}function Ws(N,T){var z,ne=8;for(z=0;16>z;++z)ne+=N[T-1+32*z];js(ne>>4,N,T)}function Vs(N,T){var z,ne=8;for(z=0;16>z;++z)ne+=N[T+z-32];js(ne>>4,N,T)}function Os(N,T){js(128,N,T)}function xs(N,T,z){return N+2*T+z+2>>2}function Br(N,T){var z,ne=T-32;for(ne=new Uint8Array([xs(N[ne-1],N[ne+0],N[ne+1]),xs(N[ne+0],N[ne+1],N[ne+2]),xs(N[ne+1],N[ne+2],N[ne+3]),xs(N[ne+2],N[ne+3],N[ne+4])]),z=0;4>z;++z)r(N,T+32*z,ne,0,ne.length)}function Pr(N,T){var z=N[T-1],ne=N[T-1+32],Se=N[T-1+64],Ie=N[T-1+96];Ne(N,T+0,16843009*xs(N[T-1-32],z,ne)),Ne(N,T+32,16843009*xs(z,ne,Se)),Ne(N,T+64,16843009*xs(ne,Se,Ie)),Ne(N,T+96,16843009*xs(Se,Ie,Ie))}function ti(N,T){var z,ne=4;for(z=0;4>z;++z)ne+=N[T+z-32]+N[T-1+32*z];for(ne>>=3,z=0;4>z;++z)i(N,T+32*z,ne,4)}function Mr(N,T){var z=N[T-1+0],ne=N[T-1+32],Se=N[T-1+64],Ie=N[T-1-32],Le=N[T+0-32],We=N[T+1-32],Qe=N[T+2-32],Xe=N[T+3-32];N[T+0+96]=xs(ne,Se,N[T-1+96]),N[T+1+96]=N[T+0+64]=xs(z,ne,Se),N[T+2+96]=N[T+1+64]=N[T+0+32]=xs(Ie,z,ne),N[T+3+96]=N[T+2+64]=N[T+1+32]=N[T+0+0]=xs(Le,Ie,z),N[T+3+64]=N[T+2+32]=N[T+1+0]=xs(We,Le,Ie),N[T+3+32]=N[T+2+0]=xs(Qe,We,Le),N[T+3+0]=xs(Xe,Qe,We)}function hn(N,T){var z=N[T+1-32],ne=N[T+2-32],Se=N[T+3-32],Ie=N[T+4-32],Le=N[T+5-32],We=N[T+6-32],Qe=N[T+7-32];N[T+0+0]=xs(N[T+0-32],z,ne),N[T+1+0]=N[T+0+32]=xs(z,ne,Se),N[T+2+0]=N[T+1+32]=N[T+0+64]=xs(ne,Se,Ie),N[T+3+0]=N[T+2+32]=N[T+1+64]=N[T+0+96]=xs(Se,Ie,Le),N[T+3+32]=N[T+2+64]=N[T+1+96]=xs(Ie,Le,We),N[T+3+64]=N[T+2+96]=xs(Le,We,Qe),N[T+3+96]=xs(We,Qe,Qe)}function fr(N,T){var z=N[T-1+0],ne=N[T-1+32],Se=N[T-1+64],Ie=N[T-1-32],Le=N[T+0-32],We=N[T+1-32],Qe=N[T+2-32],Xe=N[T+3-32];N[T+0+0]=N[T+1+64]=Ie+Le+1>>1,N[T+1+0]=N[T+2+64]=Le+We+1>>1,N[T+2+0]=N[T+3+64]=We+Qe+1>>1,N[T+3+0]=Qe+Xe+1>>1,N[T+0+96]=xs(Se,ne,z),N[T+0+64]=xs(ne,z,Ie),N[T+0+32]=N[T+1+96]=xs(z,Ie,Le),N[T+1+32]=N[T+2+96]=xs(Ie,Le,We),N[T+2+32]=N[T+3+96]=xs(Le,We,Qe),N[T+3+32]=xs(We,Qe,Xe)}function ci(N,T){var z=N[T+0-32],ne=N[T+1-32],Se=N[T+2-32],Ie=N[T+3-32],Le=N[T+4-32],We=N[T+5-32],Qe=N[T+6-32],Xe=N[T+7-32];N[T+0+0]=z+ne+1>>1,N[T+1+0]=N[T+0+64]=ne+Se+1>>1,N[T+2+0]=N[T+1+64]=Se+Ie+1>>1,N[T+3+0]=N[T+2+64]=Ie+Le+1>>1,N[T+0+32]=xs(z,ne,Se),N[T+1+32]=N[T+0+96]=xs(ne,Se,Ie),N[T+2+32]=N[T+1+96]=xs(Se,Ie,Le),N[T+3+32]=N[T+2+96]=xs(Ie,Le,We),N[T+3+64]=xs(Le,We,Qe),N[T+3+96]=xs(We,Qe,Xe)}function $r(N,T){var z=N[T-1+0],ne=N[T-1+32],Se=N[T-1+64],Ie=N[T-1+96];N[T+0+0]=z+ne+1>>1,N[T+2+0]=N[T+0+32]=ne+Se+1>>1,N[T+2+32]=N[T+0+64]=Se+Ie+1>>1,N[T+1+0]=xs(z,ne,Se),N[T+3+0]=N[T+1+32]=xs(ne,Se,Ie),N[T+3+32]=N[T+1+64]=xs(Se,Ie,Ie),N[T+3+64]=N[T+2+64]=N[T+0+96]=N[T+1+96]=N[T+2+96]=N[T+3+96]=Ie}function sa(N,T){var z=N[T-1+0],ne=N[T-1+32],Se=N[T-1+64],Ie=N[T-1+96],Le=N[T-1-32],We=N[T+0-32],Qe=N[T+1-32],Xe=N[T+2-32];N[T+0+0]=N[T+2+32]=z+Le+1>>1,N[T+0+32]=N[T+2+64]=ne+z+1>>1,N[T+0+64]=N[T+2+96]=Se+ne+1>>1,N[T+0+96]=Ie+Se+1>>1,N[T+3+0]=xs(We,Qe,Xe),N[T+2+0]=xs(Le,We,Qe),N[T+1+0]=N[T+3+32]=xs(z,Le,We),N[T+1+32]=N[T+3+64]=xs(ne,z,Le),N[T+1+64]=N[T+3+96]=xs(Se,ne,z),N[T+1+96]=xs(Ie,Se,ne)}function Ar(N,T){var z;for(z=0;8>z;++z)r(N,T+32*z,N,T-32,8)}function na(N,T){var z;for(z=0;8>z;++z)i(N,T,N[T-1],8),T+=32}function Ir(N,T,z){var ne;for(ne=0;8>ne;++ne)i(T,z+32*ne,N,8)}function Ga(N,T){var z,ne=8;for(z=0;8>z;++z)ne+=N[T+z-32]+N[T-1+32*z];Ir(ne>>4,N,T)}function tl(N,T){var z,ne=4;for(z=0;8>z;++z)ne+=N[T+z-32];Ir(ne>>3,N,T)}function Rs(N,T){var z,ne=4;for(z=0;8>z;++z)ne+=N[T-1+32*z];Ir(ne>>3,N,T)}function Un(N,T){Ir(128,N,T)}function Vn(N,T,z){var ne=N[T-z],Se=N[T+0],Ie=3*(Se-ne)+Lo[1020+N[T-2*z]-N[T+z]],Le=lh[112+(Ie+4>>3)];N[T-z]=ia[255+ne+lh[112+(Ie+3>>3)]],N[T+0]=ia[255+Se-Le]}function si(N,T,z,ne){var Se=N[T+0],Ie=N[T+z];return Fi[255+N[T-2*z]-N[T-z]]>ne||Fi[255+Ie-Se]>ne}function Ii(N,T,z,ne){return 4*Fi[255+N[T-z]-N[T+0]]+Fi[255+N[T-2*z]-N[T+z]]<=ne}function No(N,T,z,ne,Se){var Ie=N[T-3*z],Le=N[T-2*z],We=N[T-z],Qe=N[T+0],Xe=N[T+z],vt=N[T+2*z],Gt=N[T+3*z];return 4*Fi[255+We-Qe]+Fi[255+Le-Xe]>ne?0:Fi[255+N[T-4*z]-Ie]<=Se&&Fi[255+Ie-Le]<=Se&&Fi[255+Le-We]<=Se&&Fi[255+Gt-vt]<=Se&&Fi[255+vt-Xe]<=Se&&Fi[255+Xe-Qe]<=Se}function Il(N,T,z,ne){var Se=2*ne+1;for(ne=0;16>ne;++ne)Ii(N,T+ne,z,Se)&&Vn(N,T+ne,z)}function ks(N,T,z,ne){var Se=2*ne+1;for(ne=0;16>ne;++ne)Ii(N,T+ne*z,1,Se)&&Vn(N,T+ne*z,1)}function Xn(N,T,z,ne){var Se;for(Se=3;0<Se;--Se)Il(N,T+=4*z,z,ne)}function zr(N,T,z,ne){var Se;for(Se=3;0<Se;--Se)ks(N,T+=4,z,ne)}function ji(N,T,z,ne,Se,Ie,Le,We){for(Ie=2*Ie+1;0<Se--;){if(No(N,T,z,Ie,Le))if(si(N,T,z,We))Vn(N,T,z);else{var Qe=N,Xe=T,vt=z,Gt=Qe[Xe-2*vt],He=Qe[Xe-vt],Tt=Qe[Xe+0],Pt=Qe[Xe+vt],es=Qe[Xe+2*vt],kt=27*(is=Lo[1020+3*(Tt-He)+Lo[1020+Gt-Pt]])+63>>7,Jt=18*is+63>>7,is=9*is+63>>7;Qe[Xe-3*vt]=ia[255+Qe[Xe-3*vt]+is],Qe[Xe-2*vt]=ia[255+Gt+Jt],Qe[Xe-vt]=ia[255+He+kt],Qe[Xe+0]=ia[255+Tt-kt],Qe[Xe+vt]=ia[255+Pt-Jt],Qe[Xe+2*vt]=ia[255+es-is]}T+=ne}}function Bi(N,T,z,ne,Se,Ie,Le,We){for(Ie=2*Ie+1;0<Se--;){if(No(N,T,z,Ie,Le))if(si(N,T,z,We))Vn(N,T,z);else{var Qe=N,Xe=T,vt=z,Gt=Qe[Xe-vt],He=Qe[Xe+0],Tt=Qe[Xe+vt],Pt=lh[112+(4+(es=3*(He-Gt))>>3)],es=lh[112+(es+3>>3)],kt=Pt+1>>1;Qe[Xe-2*vt]=ia[255+Qe[Xe-2*vt]+kt],Qe[Xe-vt]=ia[255+Gt+es],Qe[Xe+0]=ia[255+He-Pt],Qe[Xe+vt]=ia[255+Tt-kt]}T+=ne}}function p0(N,T,z,ne,Se,Ie){ji(N,T,z,1,16,ne,Se,Ie)}function So(N,T,z,ne,Se,Ie){ji(N,T,1,z,16,ne,Se,Ie)}function y0(N,T,z,ne,Se,Ie){var Le;for(Le=3;0<Le;--Le)Bi(N,T+=4*z,z,1,16,ne,Se,Ie)}function W(N,T,z,ne,Se,Ie){var Le;for(Le=3;0<Le;--Le)Bi(N,T+=4,1,z,16,ne,Se,Ie)}function Ce(N,T,z,ne,Se,Ie,Le,We){ji(N,T,Se,1,8,Ie,Le,We),ji(z,ne,Se,1,8,Ie,Le,We)}function Ze(N,T,z,ne,Se,Ie,Le,We){ji(N,T,1,Se,8,Ie,Le,We),ji(z,ne,1,Se,8,Ie,Le,We)}function Ct(N,T,z,ne,Se,Ie,Le,We){Bi(N,T+4*Se,Se,1,8,Ie,Le,We),Bi(z,ne+4*Se,Se,1,8,Ie,Le,We)}function Ot(N,T,z,ne,Se,Ie,Le,We){Bi(N,T+4,1,Se,8,Ie,Le,We),Bi(z,ne+4,1,Se,8,Ie,Le,We)}function rs(){this.ba=new Ye,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ge,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function zs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function en(){this.ua=0,this.Wa=new se,this.vb=new se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new ee}function mn(){this.xb=this.a=0,this.l=new Lt,this.ca=new Ye,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new U,this.Pb=0,this.wd=new U,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new en,this.ab=0,this.gc=o(4,zs),this.Oc=0}function Cn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Lt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Fn(N,T,z,ne,Se,Ie,Le){for(N=N==null?0:N[T+0],T=0;T<Le;++T)Se[Ie+T]=N+z[ne+T]&255,N=Se[Ie+T]}function Gr(N,T,z,ne,Se,Ie,Le){var We;if(N==null)Fn(null,null,z,ne,Se,Ie,Le);else for(We=0;We<Le;++We)Se[Ie+We]=N[T+We]+z[ne+We]&255}function ni(N,T,z,ne,Se,Ie,Le){if(N==null)Fn(null,null,z,ne,Se,Ie,Le);else{var We,Qe=N[T+0],Xe=Qe,vt=Qe;for(We=0;We<Le;++We)Xe=vt+(Qe=N[T+We])-Xe,vt=z[ne+We]+(-256&Xe?0>Xe?0:255:Xe)&255,Xe=Qe,Se[Ie+We]=vt}}function Sr(N,T,z,ne){var Se=T.width,Ie=T.o;if(e(N!=null&&T!=null),0>z||0>=ne||z+ne>Ie)return null;if(!N.Cc){if(N.ga==null){var Le;if(N.ga=new Cn,(Le=N.ga==null)||(Le=T.width*T.o,e(N.Gb.length==0),N.Gb=a(Le),N.Uc=0,N.Gb==null?Le=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Le=1),Le=!Le),!Le){Le=N.ga;var We=N.Fa,Qe=N.P,Xe=N.qc,vt=N.mb,Gt=N.nb,He=Qe+1,Tt=Xe-1,Pt=Le.l;if(e(We!=null&&vt!=null&&T!=null),Po[0]=null,Po[1]=Fn,Po[2]=Gr,Po[3]=ni,Le.ca=vt,Le.tb=Gt,Le.c=T.width,Le.i=T.height,e(0<Le.c&&0<Le.i),1>=Xe)T=0;else if(Le.$a=3&We[Qe+0],Le.Z=We[Qe+0]>>2&3,Le.Lc=We[Qe+0]>>4&3,Qe=We[Qe+0]>>6&3,0>Le.$a||1<Le.$a||4<=Le.Z||1<Le.Lc||Qe)T=0;else if(Pt.put=Pe,Pt.ac=Je,Pt.bc=Nt,Pt.ma=Le,Pt.width=T.width,Pt.height=T.height,Pt.Da=T.Da,Pt.v=T.v,Pt.va=T.va,Pt.j=T.j,Pt.o=T.o,Le.$a)e:{e(Le.$a==1),T=ft();t:for(;;){if(T==null){T=0;break e}if(e(Le!=null),Le.mc=T,T.c=Le.c,T.i=Le.i,T.l=Le.l,T.l.ma=Le,T.l.width=Le.c,T.l.height=Le.i,T.a=0,te(T.m,We,He,Tt),!st(Le.c,Le.i,1,T,null)||(T.ab==1&&T.gc[0].hc==3&&ls(T.s)?(Le.ic=1,We=T.c*T.i,T.Ta=null,T.Ua=0,T.V=a(We),T.Ba=0,T.V==null?(T.a=1,T=0):T=1):(Le.ic=0,T=Ft(T,Le.c)),!T))break t;T=1;break e}Le.mc=null,T=0}else T=Tt>=Le.c*Le.i;Le=!T}if(Le)return null;N.ga.Lc!=1?N.Ga=0:ne=Ie-z}e(N.ga!=null),e(z+ne<=Ie);e:{if(T=(We=N.ga).c,Ie=We.l.o,We.$a==0){if(He=N.rc,Tt=N.Vc,Pt=N.Fa,Qe=N.P+1+z*T,Xe=N.mb,vt=N.nb+z*T,e(Qe<=N.P+N.qc),We.Z!=0)for(e(Po[We.Z]!=null),Le=0;Le<ne;++Le)Po[We.Z](He,Tt,Pt,Qe,Xe,vt,T),He=Xe,Tt=vt,vt+=T,Qe+=T;else for(Le=0;Le<ne;++Le)r(Xe,vt,Pt,Qe,T),He=Xe,Tt=vt,vt+=T,Qe+=T;N.rc=He,N.Vc=Tt}else{if(e(We.mc!=null),T=z+ne,e((Le=We.mc)!=null),e(T<=Le.i),Le.C>=T)T=1;else if(We.ic||jl(),We.ic){We=Le.V,He=Le.Ba,Tt=Le.c;var es=Le.i,kt=(Pt=1,Qe=Le.$/Tt,Xe=Le.$%Tt,vt=Le.m,Gt=Le.s,Le.$),Jt=Tt*es,is=Tt*T,ys=Gt.wc,fs=kt<is?$t(Gt,Xe,Qe):null;e(kt<=Jt),e(T<=es),e(ls(Gt));t:for(;;){for(;!vt.h&&kt<is;){if(Xe&ys||(fs=$t(Gt,Xe,Qe)),e(fs!=null),de(vt),256>(es=It(fs.G[0],fs.H[0],vt)))We[He+kt]=es,++kt,++Xe>=Tt&&(Xe=0,++Qe<=T&&!(Qe%16)&&vs(Le,Qe));else{if(!(280>es)){Pt=0;break t}es=dt(es-256,vt);var qs,Fs=It(fs.G[4],fs.H[4],vt);if(de(vt),!(kt>=(Fs=gt(Tt,Fs=dt(Fs,vt)))&&Jt-kt>=es)){Pt=0;break t}for(qs=0;qs<es;++qs)We[He+kt+qs]=We[He+kt+qs-Fs];for(kt+=es,Xe+=es;Xe>=Tt;)Xe-=Tt,++Qe<=T&&!(Qe%16)&&vs(Le,Qe);kt<is&&Xe&ys&&(fs=$t(Gt,Xe,Qe))}e(vt.h==q(vt))}vs(Le,Qe>T?T:Qe);break t}!Pt||vt.h&&kt<Jt?(Pt=0,Le.a=vt.h?5:3):Le.$=kt,T=Pt}else T=Ss(Le,Le.V,Le.Ba,Le.c,Le.i,T,_t);if(!T){ne=0;break e}}z+ne>=Ie&&(N.Cc=1),ne=1}if(!ne)return null;if(N.Cc&&((ne=N.ga)!=null&&(ne.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+z*Se}function Ci(N,T,z,ne,Se,Ie){for(;0<Se--;){var Le,We=N,Qe=T+(z?1:0),Xe=N,vt=T+(z?0:3);for(Le=0;Le<ne;++Le){var Gt=Xe[vt+4*Le];Gt!=255&&(Gt*=32897,We[Qe+4*Le+0]=We[Qe+4*Le+0]*Gt>>23,We[Qe+4*Le+1]=We[Qe+4*Le+1]*Gt>>23,We[Qe+4*Le+2]=We[Qe+4*Le+2]*Gt>>23)}T+=Ie}}function di(N,T,z,ne,Se){for(;0<ne--;){var Ie;for(Ie=0;Ie<z;++Ie){var Le=N[T+2*Ie+0],We=15&(Xe=N[T+2*Ie+1]),Qe=4369*We,Xe=(240&Xe|Xe>>4)*Qe>>16;N[T+2*Ie+0]=(240&Le|Le>>4)*Qe>>16&240|(15&Le|Le<<4)*Qe>>16>>4&15,N[T+2*Ie+1]=240&Xe|We}T+=Se}}function Gi(N,T,z,ne,Se,Ie,Le,We){var Qe,Xe,vt=255;for(Xe=0;Xe<Se;++Xe){for(Qe=0;Qe<ne;++Qe){var Gt=N[T+Qe];Ie[Le+4*Qe]=Gt,vt&=Gt}T+=z,Le+=We}return vt!=255}function vo(N,T,z,ne,Se){var Ie;for(Ie=0;Ie<Se;++Ie)z[ne+Ie]=N[T+Ie]>>8}function jl(){Fc=Ci,nl=di,rh=Gi,Ka=vo}function Eo(N,T,z){I[N]=function(ne,Se,Ie,Le,We,Qe,Xe,vt,Gt,He,Tt,Pt,es,kt,Jt,is,ys){var fs,qs=ys-1>>1,Fs=We[Qe+0]|Xe[vt+0]<<16,xn=Gt[He+0]|Tt[Pt+0]<<16;e(ne!=null);var $s=3*Fs+xn+131074>>2;for(T(ne[Se+0],255&$s,$s>>16,es,kt),Ie!=null&&($s=3*xn+Fs+131074>>2,T(Ie[Le+0],255&$s,$s>>16,Jt,is)),fs=1;fs<=qs;++fs){var Ln=We[Qe+fs]|Xe[vt+fs]<<16,Or=Gt[He+fs]|Tt[Pt+fs]<<16,Nn=Fs+Ln+xn+Or+524296,Ks=Nn+2*(Ln+xn)>>3;$s=Ks+Fs>>1,Fs=(Nn=Nn+2*(Fs+Or)>>3)+Ln>>1,T(ne[Se+2*fs-1],255&$s,$s>>16,es,kt+(2*fs-1)*z),T(ne[Se+2*fs-0],255&Fs,Fs>>16,es,kt+(2*fs-0)*z),Ie!=null&&($s=Nn+xn>>1,Fs=Ks+Or>>1,T(Ie[Le+2*fs-1],255&$s,$s>>16,Jt,is+(2*fs-1)*z),T(Ie[Le+2*fs+0],255&Fs,Fs>>16,Jt,is+(2*fs+0)*z)),Fs=Ln,xn=Or}1&ys||($s=3*Fs+xn+131074>>2,T(ne[Se+ys-1],255&$s,$s>>16,es,kt+(ys-1)*z),Ie!=null&&($s=3*xn+Fs+131074>>2,T(Ie[Le+ys-1],255&$s,$s>>16,Jt,is+(ys-1)*z)))}}function eh(){Qi[S0]=Yc,Qi[aa]=Kd,Qi[v0]=Im,Qi[rl]=M0,Qi[oh]=dc,Qi[Gd]=Xl,Qi[lc]=uc,Qi[ch]=Kd,Qi[E0]=M0,Qi[Wd]=dc,Qi[D0]=Xl}function wd(N){return N&-16384?0>N?0:255:N>>I0}function Kl(N,T){return wd((19077*N>>8)+(26149*T>>8)-14234)}function Ol(N,T,z){return wd((19077*N>>8)-(6419*T>>8)-(13320*z>>8)+8708)}function Bc(N,T){return wd((19077*N>>8)+(33050*T>>8)-17685)}function Do(N,T,z,ne,Se){ne[Se+0]=Kl(N,z),ne[Se+1]=Ol(N,T,z),ne[Se+2]=Bc(N,T)}function Oi(N,T,z,ne,Se){ne[Se+0]=Bc(N,T),ne[Se+1]=Ol(N,T,z),ne[Se+2]=Kl(N,z)}function rc(N,T,z,ne,Se){var Ie=Ol(N,T,z);T=Ie<<3&224|Bc(N,T)>>3,ne[Se+0]=248&Kl(N,z)|Ie>>5,ne[Se+1]=T}function ic(N,T,z,ne,Se){var Ie=240&Bc(N,T)|15;ne[Se+0]=240&Kl(N,z)|Ol(N,T,z)>>4,ne[Se+1]=Ie}function Ld(N,T,z,ne,Se){ne[Se+0]=255,Do(N,T,z,ne,Se+1)}function Ql(N,T,z,ne,Se){Oi(N,T,z,ne,Se),ne[Se+3]=255}function pa(N,T,z,ne,Se){Do(N,T,z,ne,Se),ne[Se+3]=255}function Ro(N,T,z){I[N]=function(ne,Se,Ie,Le,We,Qe,Xe,vt,Gt){for(var He=vt+(-2&Gt)*z;vt!=He;)T(ne[Se+0],Ie[Le+0],We[Qe+0],Xe,vt),T(ne[Se+1],Ie[Le+0],We[Qe+0],Xe,vt+z),Se+=2,++Le,++Qe,vt+=2*z;1&Gt&&T(ne[Se+0],Ie[Le+0],We[Qe+0],Xe,vt)}}function Pd(N,T,z){return z==0?N==0?T==0?6:5:T==0?4:0:z}function th(N,T,z,ne,Se){switch(N>>>30){case 3:wo(T,z,ne,Se,0);break;case 2:ra(T,z,ne,Se);break;case 1:Jn(T,z,ne,Se)}}function Wa(N,T){var z,ne,Se=T.M,Ie=T.Nb,Le=N.oc,We=N.pc+40,Qe=N.oc,Xe=N.pc+584,vt=N.oc,Gt=N.pc+600;for(z=0;16>z;++z)Le[We+32*z-1]=129;for(z=0;8>z;++z)Qe[Xe+32*z-1]=129,vt[Gt+32*z-1]=129;for(0<Se?Le[We-1-32]=Qe[Xe-1-32]=vt[Gt-1-32]=129:(i(Le,We-32-1,127,21),i(Qe,Xe-32-1,127,9),i(vt,Gt-32-1,127,9)),ne=0;ne<N.za;++ne){var He=T.ya[T.aa+ne];if(0<ne){for(z=-1;16>z;++z)r(Le,We+32*z-4,Le,We+32*z+12,4);for(z=-1;8>z;++z)r(Qe,Xe+32*z-4,Qe,Xe+32*z+4,4),r(vt,Gt+32*z-4,vt,Gt+32*z+4,4)}var Tt=N.Gd,Pt=N.Hd+ne,es=He.ad,kt=He.Hc;if(0<Se&&(r(Le,We-32,Tt[Pt].y,0,16),r(Qe,Xe-32,Tt[Pt].f,0,8),r(vt,Gt-32,Tt[Pt].ea,0,8)),He.Za){var Jt=Le,is=We-32+16;for(0<Se&&(ne>=N.za-1?i(Jt,is,Tt[Pt].y[15],4):r(Jt,is,Tt[Pt+1].y,0,4)),z=0;4>z;z++)Jt[is+128+z]=Jt[is+256+z]=Jt[is+384+z]=Jt[is+0+z];for(z=0;16>z;++z,kt<<=2)Jt=Le,is=We+ai[z],Hr[He.Ob[z]](Jt,is),th(kt,es,16*+z,Jt,is)}else if(Jt=Pd(ne,Se,He.Ob[0]),ba[Jt](Le,We),kt!=0)for(z=0;16>z;++z,kt<<=2)th(kt,es,16*+z,Le,We+ai[z]);for(z=He.Gc,Jt=Pd(ne,Se,He.Dd),Al[Jt](Qe,Xe),Al[Jt](vt,Gt),kt=es,Jt=Qe,is=Xe,255&(He=0|z)&&(170&He?sl(kt,256,Jt,is):Kn(kt,256,Jt,is)),He=vt,kt=Gt,255&(z>>=8)&&(170&z?sl(es,320,He,kt):Kn(es,320,He,kt)),Se<N.Ub-1&&(r(Tt[Pt].y,0,Le,We+480,16),r(Tt[Pt].f,0,Qe,Xe+224,8),r(Tt[Pt].ea,0,vt,Gt+224,8)),z=8*Ie*N.B,Tt=N.sa,Pt=N.ta+16*ne+16*Ie*N.R,es=N.qa,He=N.ra+8*ne+z,kt=N.Ha,Jt=N.Ia+8*ne+z,z=0;16>z;++z)r(Tt,Pt+z*N.R,Le,We+32*z,16);for(z=0;8>z;++z)r(es,He+z*N.B,Qe,Xe+32*z,8),r(kt,Jt+z*N.B,vt,Gt+32*z,8)}}function wl(N,T,z,ne,Se,Ie,Le,We,Qe){var Xe=[0],vt=[0],Gt=0,He=Qe!=null?Qe.kd:0,Tt=Qe??new gs;if(N==null||12>z)return 7;Tt.data=N,Tt.w=T,Tt.ha=z,T=[T],z=[z],Tt.gb=[Tt.gb];e:{var Pt=T,es=z,kt=Tt.gb;if(e(N!=null),e(es!=null),e(kt!=null),kt[0]=0,12<=es[0]&&!n(N,Pt[0],"RIFF")){if(n(N,Pt[0]+8,"WEBP")){kt=3;break e}var Jt=fe(N,Pt[0]+4);if(12>Jt||4294967286<Jt){kt=3;break e}if(He&&Jt>es[0]-8){kt=7;break e}kt[0]=Jt,Pt[0]+=12,es[0]-=12}kt=0}if(kt!=0)return kt;for(Jt=0<Tt.gb[0],z=z[0];;){e:{var is=N;es=T,kt=z;var ys=Xe,fs=vt,qs=Pt=[0];if(($s=Gt=[Gt])[0]=0,8>kt[0])kt=7;else{if(!n(is,es[0],"VP8X")){if(fe(is,es[0]+4)!=10){kt=3;break e}if(18>kt[0]){kt=7;break e}var Fs=fe(is,es[0]+8),xn=1+xe(is,es[0]+12);if(2147483648<=xn*(is=1+xe(is,es[0]+15))){kt=3;break e}qs!=null&&(qs[0]=Fs),ys!=null&&(ys[0]=xn),fs!=null&&(fs[0]=is),es[0]+=18,kt[0]-=18,$s[0]=1}kt=0}}if(Gt=Gt[0],Pt=Pt[0],kt!=0)return kt;if(es=!!(2&Pt),!Jt&&Gt)return 3;if(Ie!=null&&(Ie[0]=!!(16&Pt)),Le!=null&&(Le[0]=es),We!=null&&(We[0]=0),Le=Xe[0],Pt=vt[0],Gt&&es&&Qe==null){kt=0;break}if(4>z){kt=7;break}if(Jt&&Gt||!Jt&&!Gt&&!n(N,T[0],"ALPH")){z=[z],Tt.na=[Tt.na],Tt.P=[Tt.P],Tt.Sa=[Tt.Sa];e:{Fs=N,kt=T,Jt=z;var $s=Tt.gb;ys=Tt.na,fs=Tt.P,qs=Tt.Sa,xn=22,e(Fs!=null),e(Jt!=null),is=kt[0];var Ln=Jt[0];for(e(ys!=null),e(qs!=null),ys[0]=null,fs[0]=null,qs[0]=0;;){if(kt[0]=is,Jt[0]=Ln,8>Ln){kt=7;break e}var Or=fe(Fs,is+4);if(4294967286<Or){kt=3;break e}var Nn=8+Or+1&-2;if(xn+=Nn,0<$s&&xn>$s){kt=3;break e}if(!n(Fs,is,"VP8 ")||!n(Fs,is,"VP8L")){kt=0;break e}if(Ln[0]<Nn){kt=7;break e}n(Fs,is,"ALPH")||(ys[0]=Fs,fs[0]=is+8,qs[0]=Or),is+=Nn,Ln-=Nn}}if(z=z[0],Tt.na=Tt.na[0],Tt.P=Tt.P[0],Tt.Sa=Tt.Sa[0],kt!=0)break}z=[z],Tt.Ja=[Tt.Ja],Tt.xa=[Tt.xa];e:if($s=N,kt=T,Jt=z,ys=Tt.gb[0],fs=Tt.Ja,qs=Tt.xa,Fs=kt[0],is=!n($s,Fs,"VP8 "),xn=!n($s,Fs,"VP8L"),e($s!=null),e(Jt!=null),e(fs!=null),e(qs!=null),8>Jt[0])kt=7;else{if(is||xn){if($s=fe($s,Fs+4),12<=ys&&$s>ys-12){kt=3;break e}if(He&&$s>Jt[0]-8){kt=7;break e}fs[0]=$s,kt[0]+=8,Jt[0]-=8,qs[0]=xn}else qs[0]=5<=Jt[0]&&$s[Fs+0]==47&&!($s[Fs+4]>>5),fs[0]=Jt[0];kt=0}if(z=z[0],Tt.Ja=Tt.Ja[0],Tt.xa=Tt.xa[0],T=T[0],kt!=0)break;if(4294967286<Tt.Ja)return 3;if(We==null||es||(We[0]=Tt.xa?2:1),Le=[Le],Pt=[Pt],Tt.xa){if(5>z){kt=7;break}We=Le,He=Pt,es=Ie,N==null||5>z?N=0:5<=z&&N[T+0]==47&&!(N[T+4]>>5)?(Jt=[0],$s=[0],ys=[0],te(fs=new U,N,T,z),Oe(fs,Jt,$s,ys)?(We!=null&&(We[0]=Jt[0]),He!=null&&(He[0]=$s[0]),es!=null&&(es[0]=ys[0]),N=1):N=0):N=0}else{if(10>z){kt=7;break}We=Pt,N==null||10>z||!Xt(N,T+3,z-3)?N=0:(He=N[T+0]|N[T+1]<<8|N[T+2]<<16,es=16383&(N[T+7]<<8|N[T+6]),N=16383&(N[T+9]<<8|N[T+8]),1&He||3<(He>>1&7)||!(He>>4&1)||He>>5>=Tt.Ja||!es||!N?N=0:(Le&&(Le[0]=es),We&&(We[0]=N),N=1))}if(!N||(Le=Le[0],Pt=Pt[0],Gt&&(Xe[0]!=Le||vt[0]!=Pt)))return 3;Qe!=null&&(Qe[0]=Tt,Qe.offset=T-Qe.w,e(4294967286>T-Qe.w),e(Qe.offset==Qe.ha-z));break}return kt==0||kt==7&&Gt&&Qe==null?(Ie!=null&&(Ie[0]|=Tt.na!=null&&0<Tt.na.length),ne!=null&&(ne[0]=Le),Se!=null&&(Se[0]=Pt),0):kt}function To(N,T,z){var ne=T.width,Se=T.height,Ie=0,Le=0,We=ne,Qe=Se;if(T.Da=N!=null&&0<N.Da,T.Da&&(We=N.cd,Qe=N.bd,Ie=N.v,Le=N.j,11>z||(Ie&=-2,Le&=-2),0>Ie||0>Le||0>=We||0>=Qe||Ie+We>ne||Le+Qe>Se))return 0;if(T.v=Ie,T.j=Le,T.va=Ie+We,T.o=Le+Qe,T.U=We,T.T=Qe,T.da=N!=null&&0<N.da,T.da){if(!Re(We,Qe,z=[N.ib],Ie=[N.hb]))return 0;T.ib=z[0],T.hb=Ie[0]}return T.ob=N!=null&&N.ob,T.Kb=N==null||!N.Sd,T.da&&(T.ob=T.ib<3*ne/4&&T.hb<3*Se/4,T.Kb=0),1}function sh(N){if(N==null)return 2;if(11>N.S){var T=N.f.RGBA;T.fb+=(N.height-1)*T.A,T.A=-T.A}else T=N.f.kb,N=N.height,T.O+=(N-1)*T.fa,T.fa=-T.fa,T.N+=(N-1>>1)*T.Ab,T.Ab=-T.Ab,T.W+=(N-1>>1)*T.Db,T.Db=-T.Db,T.F!=null&&(T.J+=(N-1)*T.lb,T.lb=-T.lb);return 0}function Ll(N,T,z,ne){if(ne==null||0>=N||0>=T)return 2;if(z!=null){if(z.Da){var Se=z.cd,Ie=z.bd,Le=-2&z.v,We=-2&z.j;if(0>Le||0>We||0>=Se||0>=Ie||Le+Se>N||We+Ie>T)return 2;N=Se,T=Ie}if(z.da){if(!Re(N,T,Se=[z.ib],Ie=[z.hb]))return 2;N=Se[0],T=Ie[0]}}ne.width=N,ne.height=T;e:{var Qe=ne.width,Xe=ne.height;if(N=ne.S,0>=Qe||0>=Xe||!(N>=S0&&13>N))N=2;else{if(0>=ne.Rd&&ne.sd==null){Le=Ie=Se=T=0;var vt=(We=Qe*O0[N])*Xe;if(11>N||(Ie=(Xe+1)/2*(T=(Qe+1)/2),N==12&&(Le=(Se=Qe)*Xe)),(Xe=a(vt+2*Ie+Le))==null){N=1;break e}ne.sd=Xe,11>N?((Qe=ne.f.RGBA).eb=Xe,Qe.fb=0,Qe.A=We,Qe.size=vt):((Qe=ne.f.kb).y=Xe,Qe.O=0,Qe.fa=We,Qe.Fd=vt,Qe.f=Xe,Qe.N=0+vt,Qe.Ab=T,Qe.Cd=Ie,Qe.ea=Xe,Qe.W=0+vt+Ie,Qe.Db=T,Qe.Ed=Ie,N==12&&(Qe.F=Xe,Qe.J=0+vt+2*Ie),Qe.Tc=Le,Qe.lb=Se)}if(T=1,Se=ne.S,Ie=ne.width,Le=ne.height,Se>=S0&&13>Se)if(11>Se)N=ne.f.RGBA,T&=(We=Math.abs(N.A))*(Le-1)+Ie<=N.size,T&=We>=Ie*O0[Se],T&=N.eb!=null;else{N=ne.f.kb,We=(Ie+1)/2,vt=(Le+1)/2,Qe=Math.abs(N.fa),Xe=Math.abs(N.Ab);var Gt=Math.abs(N.Db),He=Math.abs(N.lb),Tt=He*(Le-1)+Ie;T&=Qe*(Le-1)+Ie<=N.Fd,T&=Xe*(vt-1)+We<=N.Cd,T=(T&=Gt*(vt-1)+We<=N.Ed)&Qe>=Ie&Xe>=We&Gt>=We,T&=N.y!=null,T&=N.f!=null,T&=N.ea!=null,Se==12&&(T&=He>=Ie,T&=Tt<=N.Tc,T&=N.F!=null)}else T=0;N=T?0:2}}return N!=0||z!=null&&z.fd&&(N=sh(ne)),N}var ac=64,Ma=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ya=24,Yl=32,Vl=8,Mo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];re("Predictor0","PredictorAdd0"),I.Predictor0=function(){return 4278190080},I.Predictor1=function(N){return N},I.Predictor2=function(N,T,z){return T[z+0]},I.Predictor3=function(N,T,z){return T[z+1]},I.Predictor4=function(N,T,z){return T[z-1]},I.Predictor5=function(N,T,z){return ve(ve(N,T[z+1]),T[z+0])},I.Predictor6=function(N,T,z){return ve(N,T[z-1])},I.Predictor7=function(N,T,z){return ve(N,T[z+0])},I.Predictor8=function(N,T,z){return ve(T[z-1],T[z+0])},I.Predictor9=function(N,T,z){return ve(T[z+0],T[z+1])},I.Predictor10=function(N,T,z){return ve(ve(N,T[z-1]),ve(T[z+0],T[z+1]))},I.Predictor11=function(N,T,z){var ne=T[z+0];return 0>=ot(ne>>24&255,N>>24&255,(T=T[z-1])>>24&255)+ot(ne>>16&255,N>>16&255,T>>16&255)+ot(ne>>8&255,N>>8&255,T>>8&255)+ot(255&ne,255&N,255&T)?ne:N},I.Predictor12=function(N,T,z){var ne=T[z+0];return(et((N>>24&255)+(ne>>24&255)-((T=T[z-1])>>24&255))<<24|et((N>>16&255)+(ne>>16&255)-(T>>16&255))<<16|et((N>>8&255)+(ne>>8&255)-(T>>8&255))<<8|et((255&N)+(255&ne)-(255&T)))>>>0},I.Predictor13=function(N,T,z){var ne=T[z-1];return(Dt((N=ve(N,T[z+0]))>>24&255,ne>>24&255)<<24|Dt(N>>16&255,ne>>16&255)<<16|Dt(N>>8&255,ne>>8&255)<<8|Dt(255&N,255&ne))>>>0};var Ad=I.PredictorAdd0;I.PredictorAdd1=At,re("Predictor2","PredictorAdd2"),re("Predictor3","PredictorAdd3"),re("Predictor4","PredictorAdd4"),re("Predictor5","PredictorAdd5"),re("Predictor6","PredictorAdd6"),re("Predictor7","PredictorAdd7"),re("Predictor8","PredictorAdd8"),re("Predictor9","PredictorAdd9"),re("Predictor10","PredictorAdd10"),re("Predictor11","PredictorAdd11"),re("Predictor12","PredictorAdd12"),re("Predictor13","PredictorAdd13");var kd=I.PredictorAdd2;xt("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),xt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var ri,b0=I.ColorIndexInverseTransform,$l=I.MapARGB,zl=I.VP8LColorIndexInverseTransformAlpha,Wi=I.MapAlpha,Io=I.VP8LPredictorsAdd=[];Io.length=16,(I.VP8LPredictors=[]).length=16,(I.VP8LPredictorsAdd_C=[]).length=16,(I.VP8LPredictors_C=[]).length=16;var Ud,Bd,jo,Oo,Hl,Gc,Fa,wo,ra,sl,Jn,Kn,vr,ii,ql,Pl,Wc,nh,Em,k_,U_,B_,Dm,Rm,Fc,nl,rh,Ka,Kc=a(511),C0=a(2041),ih=a(225),ah=a(767),N0=0,Lo=C0,lh=ih,ia=ah,Fi=Kc,S0=0,aa=1,v0=2,rl=3,oh=4,Gd=5,lc=6,ch=7,E0=8,Wd=9,D0=10,il=[2,3,7],Fd=[3,3,11],Qc=[280,256,256,256,40],R0=[0,1,1,1,0],dh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],al=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ll=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],oc=8,ol=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],cl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Qa=null,G_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Tm=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],T0=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],W_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ki=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],jr=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Pn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ba=[],Hr=[],Al=[],cc=1,Mm=2,Po=[],Qi=[];Eo("UpsampleRgbLinePair",Do,3),Eo("UpsampleBgrLinePair",Oi,3),Eo("UpsampleRgbaLinePair",pa,4),Eo("UpsampleBgraLinePair",Ql,4),Eo("UpsampleArgbLinePair",Ld,4),Eo("UpsampleRgba4444LinePair",ic,2),Eo("UpsampleRgb565LinePair",rc,2);var Yc=I.UpsampleRgbLinePair,Im=I.UpsampleBgrLinePair,Kd=I.UpsampleRgbaLinePair,M0=I.UpsampleBgraLinePair,dc=I.UpsampleArgbLinePair,Xl=I.UpsampleRgba4444LinePair,uc=I.UpsampleRgb565LinePair,dl=16,Qd=1<<dl-1,Vc=-227,hc=482,I0=6,fc=0,Yi=a(256),j0=a(256),F_=a(256),ny=a(256),ry=a(hc-Vc),iy=a(hc-Vc);Ro("YuvToRgbRow",Do,3),Ro("YuvToBgrRow",Oi,3),Ro("YuvToRgbaRow",pa,4),Ro("YuvToBgraRow",Ql,4),Ro("YuvToArgbRow",Ld,4),Ro("YuvToRgba4444Row",ic,2),Ro("YuvToRgb565Row",rc,2);var ai=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Yd=[0,2,8],uh=[8,7,6,4,4,2,2,2,1,1,1,1],hh=1;this.WebPDecodeRGBA=function(N,T,z,ne,Se){var Ie=aa,Le=new rs,We=new Ye;Le.ba=We,We.S=Ie,We.width=[We.width],We.height=[We.height];var Qe=We.width,Xe=We.height,vt=new pe;if(vt==null||N==null)var Gt=2;else e(vt!=null),Gt=wl(N,T,z,vt.width,vt.height,vt.Pd,vt.Qd,vt.format,null);if(Gt!=0?Qe=0:(Qe!=null&&(Qe[0]=vt.width[0]),Xe!=null&&(Xe[0]=vt.height[0]),Qe=1),Qe){We.width=We.width[0],We.height=We.height[0],ne!=null&&(ne[0]=We.width),Se!=null&&(Se[0]=We.height);e:{if(ne=new Lt,(Se=new gs).data=N,Se.w=T,Se.ha=z,Se.kd=1,T=[0],e(Se!=null),((N=wl(Se.data,Se.w,Se.ha,null,null,null,T,null,Se))==0||N==7)&&T[0]&&(N=4),(T=N)==0){if(e(Le!=null),ne.data=Se.data,ne.w=Se.w+Se.offset,ne.ha=Se.ha-Se.offset,ne.put=Pe,ne.ac=Je,ne.bc=Nt,ne.ma=Le,Se.xa){if((N=ft())==null){Le=1;break e}if((function(He,Tt){var Pt=[0],es=[0],kt=[0];t:for(;;){if(He==null)return 0;if(Tt==null)return He.a=2,0;if(He.l=Tt,He.a=0,te(He.m,Tt.data,Tt.w,Tt.ha),!Oe(He.m,Pt,es,kt)){He.a=3;break t}if(He.xb=Mm,Tt.width=Pt[0],Tt.height=es[0],!st(Pt[0],es[0],1,He,null))break t;return 1}return e(He.a!=0),0})(N,ne)){if(ne=(T=Ll(ne.width,ne.height,Le.Oa,Le.ba))==0){t:{ne=N;s:for(;;){if(ne==null){ne=0;break t}if(e(ne.s.yc!=null),e(ne.s.Ya!=null),e(0<ne.s.Wb),e((z=ne.l)!=null),e((Se=z.ma)!=null),ne.xb!=0){if(ne.ca=Se.ba,ne.tb=Se.tb,e(ne.ca!=null),!To(Se.Oa,z,rl)){ne.a=2;break s}if(!Ft(ne,z.width)||z.da)break s;if((z.da||ut(ne.ca.S))&&jl(),11>ne.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ne.ca.f.kb.F!=null&&jl()),ne.Pb&&0<ne.s.ua&&ne.s.vb.X==null&&!Z(ne.s.vb,ne.s.Wa.Xa)){ne.a=1;break s}ne.xb=0}if(!Ss(ne,ne.V,ne.Ba,ne.c,ne.i,z.o,ss))break s;Se.Dc=ne.Ma,ne=1;break t}e(ne.a!=0),ne=0}ne=!ne}ne&&(T=N.a)}else T=N.a}else{if((N=new Bt)==null){Le=1;break e}if(N.Fa=Se.na,N.P=Se.P,N.qc=Se.Sa,ts(N,ne)){if((T=Ll(ne.width,ne.height,Le.Oa,Le.ba))==0){if(N.Aa=0,z=Le.Oa,e((Se=N)!=null),z!=null){if(0<(Qe=0>(Qe=z.Md)?0:100<Qe?255:255*Qe/100)){for(Xe=vt=0;4>Xe;++Xe)12>(Gt=Se.pb[Xe]).lc&&(Gt.ia=Qe*uh[0>Gt.lc?0:Gt.lc]>>3),vt|=Gt.ia;vt&&(alert("todo:VP8InitRandom"),Se.ia=1)}Se.Ga=z.Id,100<Se.Ga?Se.Ga=100:0>Se.Ga&&(Se.Ga=0)}(function(He,Tt){if(He==null)return 0;if(Tt==null)return Yt(He,2,"NULL VP8Io parameter in VP8Decode().");if(!He.cb&&!ts(He,Tt))return 0;if(e(He.cb),Tt.ac==null||Tt.ac(Tt)){Tt.ob&&(He.L=0);var Pt=Yd[He.L];if(He.L==2?(He.yb=0,He.zb=0):(He.yb=Tt.v-Pt>>4,He.zb=Tt.j-Pt>>4,0>He.yb&&(He.yb=0),0>He.zb&&(He.zb=0)),He.Va=Tt.o+15+Pt>>4,He.Hb=Tt.va+15+Pt>>4,He.Hb>He.za&&(He.Hb=He.za),He.Va>He.Ub&&(He.Va=He.Ub),0<He.L){var es=He.ed;for(Pt=0;4>Pt;++Pt){var kt;if(He.Qa.Cb){var Jt=He.Qa.Lb[Pt];He.Qa.Fb||(Jt+=es.Tb)}else Jt=es.Tb;for(kt=0;1>=kt;++kt){var is=He.gd[Pt][kt],ys=Jt;if(es.Pc&&(ys+=es.vd[0],kt&&(ys+=es.od[0])),0<(ys=0>ys?0:63<ys?63:ys)){var fs=ys;0<es.wb&&(fs=4<es.wb?fs>>2:fs>>1)>9-es.wb&&(fs=9-es.wb),1>fs&&(fs=1),is.dd=fs,is.tc=2*ys+fs,is.ld=40<=ys?2:15<=ys?1:0}else is.tc=0;is.La=kt}}}Pt=0}else Yt(He,6,"Frame setup failed"),Pt=He.a;if(Pt=Pt==0){if(Pt){He.$c=0,0<He.Aa||(He.Ic=hh);t:{Pt=He.Ic,es=4*(fs=He.za);var qs=32*fs,Fs=fs+1,xn=0<He.L?fs*(0<He.Aa?2:1):0,$s=(He.Aa==2?2:1)*fs;if((is=es+832+(kt=3*(16*Pt+Yd[He.L])/2*qs)+(Jt=He.Fa!=null&&0<He.Fa.length?He.Kc.c*He.Kc.i:0))!=is)Pt=0;else{if(is>He.Vb){if(He.Vb=0,He.Ec=a(is),He.Fc=0,He.Ec==null){Pt=Yt(He,1,"no memory during frame initialization.");break t}He.Vb=is}is=He.Ec,ys=He.Fc,He.Ac=is,He.Bc=ys,ys+=es,He.Gd=o(qs,Et),He.Hd=0,He.rb=o(Fs+1,Te),He.sb=1,He.wa=xn?o(xn,tt):null,He.Y=0,He.D.Nb=0,He.D.wa=He.wa,He.D.Y=He.Y,0<He.Aa&&(He.D.Y+=fs),e(!0),He.oc=is,He.pc=ys,ys+=832,He.ya=o($s,Ke),He.aa=0,He.D.ya=He.ya,He.D.aa=He.aa,He.Aa==2&&(He.D.aa+=fs),He.R=16*fs,He.B=8*fs,fs=(qs=Yd[He.L])*He.R,qs=qs/2*He.B,He.sa=is,He.ta=ys+fs,He.qa=He.sa,He.ra=He.ta+16*Pt*He.R+qs,He.Ha=He.qa,He.Ia=He.ra+8*Pt*He.B+qs,He.$c=0,ys+=kt,He.mb=Jt?is:null,He.nb=Jt?ys:null,e(ys+Jt<=He.Fc+He.Vb),Is(He),i(He.Ac,He.Bc,0,es),Pt=1}}if(Pt){if(Tt.ka=0,Tt.y=He.sa,Tt.O=He.ta,Tt.f=He.qa,Tt.N=He.ra,Tt.ea=He.Ha,Tt.Vd=He.Ia,Tt.fa=He.R,Tt.Rc=He.B,Tt.F=null,Tt.J=0,!N0){for(Pt=-255;255>=Pt;++Pt)Kc[255+Pt]=0>Pt?-Pt:Pt;for(Pt=-1020;1020>=Pt;++Pt)C0[1020+Pt]=-128>Pt?-128:127<Pt?127:Pt;for(Pt=-112;112>=Pt;++Pt)ih[112+Pt]=-16>Pt?-16:15<Pt?15:Pt;for(Pt=-255;510>=Pt;++Pt)ah[255+Pt]=0>Pt?0:255<Pt?255:Pt;N0=1}Fa=rt,wo=cs,sl=ms,Jn=Ys,Kn=Ps,ra=Ls,vr=p0,ii=So,ql=Ce,Pl=Ze,Wc=y0,nh=W,Em=Ct,k_=Ot,U_=Il,B_=ks,Dm=Xn,Rm=zr,Hr[0]=ti,Hr[1]=bs,Hr[2]=Br,Hr[3]=Pr,Hr[4]=Mr,Hr[5]=fr,Hr[6]=hn,Hr[7]=ci,Hr[8]=sa,Hr[9]=$r,ba[0]=hs,ba[1]=ws,ba[2]=Zt,ba[3]=Ds,ba[4]=Ws,ba[5]=Vs,ba[6]=Os,Al[0]=Ga,Al[1]=zt,Al[2]=Ar,Al[3]=na,Al[4]=Rs,Al[5]=tl,Al[6]=Un,Pt=1}else Pt=0}Pt&&(Pt=(function(Ln,Or){for(Ln.M=0;Ln.M<Ln.Va;++Ln.M){var Nn,Ks=Ln.Jc[Ln.M&Ln.Xb],Ts=Ln.m,Wr=Ln;for(Nn=0;Nn<Wr.za;++Nn){var un=Ts,En=Wr,lr=En.Ac,Ni=En.Bc+4*Nn,Vi=En.zc,Er=En.ya[En.aa+Nn];if(En.Qa.Bb?Er.$b=ie(un,En.Pa.jb[0])?2+ie(un,En.Pa.jb[2]):ie(un,En.Pa.jb[1]):Er.$b=0,En.kc&&(Er.Ad=ie(un,En.Bd)),Er.Za=!ie(un,145)+0,Er.Za){var ui=Er.Ob,la=0;for(En=0;4>En;++En){var hi,In=Vi[0+En];for(hi=0;4>hi;++hi){In=Ki[lr[Ni+hi]][In];for(var $n=T0[ie(un,In[0])];0<$n;)$n=T0[2*$n+ie(un,In[$n])];In=-$n,lr[Ni+hi]=In}r(ui,la,lr,Ni,4),la+=4,Vi[0+En]=In}}else In=ie(un,156)?ie(un,128)?1:3:ie(un,163)?2:0,Er.Ob[0]=In,i(lr,Ni,In,4),i(Vi,0,In,4);Er.Dd=ie(un,142)?ie(un,114)?ie(un,183)?1:3:2:0}if(Wr.m.Ka)return Yt(Ln,7,"Premature end-of-partition0 encountered.");for(;Ln.ja<Ln.za;++Ln.ja){if(Wr=Ks,un=(Ts=Ln).rb[Ts.sb-1],lr=Ts.rb[Ts.sb+Ts.ja],Nn=Ts.ya[Ts.aa+Ts.ja],Ni=Ts.kc?Nn.Ad:0)un.la=lr.la=0,Nn.Za||(un.Na=lr.Na=0),Nn.Hc=0,Nn.Gc=0,Nn.ia=0;else{var Fr,Zn;if(un=lr,lr=Wr,Ni=Ts.Pa.Xc,Vi=Ts.ya[Ts.aa+Ts.ja],Er=Ts.pb[Vi.$b],En=Vi.ad,ui=0,la=Ts.rb[Ts.sb-1],In=hi=0,i(En,ui,0,384),Vi.Za)var Si=0,Kr=Ni[3];else{$n=a(16);var zn=un.Na+la.Na;if(zn=Qa(lr,Ni[1],zn,Er.Eb,0,$n,0),un.Na=la.Na=(0<zn)+0,1<zn)Fa($n,0,En,ui);else{var li=$n[0]+3>>3;for($n=0;256>$n;$n+=16)En[ui+$n]=li}Si=1,Kr=Ni[0]}var or=15&un.la,fi=15&la.la;for($n=0;4>$n;++$n){var mi=1&fi;for(li=Zn=0;4>li;++li)or=or>>1|(mi=(zn=Qa(lr,Kr,zn=mi+(1&or),Er.Sc,Si,En,ui))>Si)<<7,Zn=Zn<<2|(3<zn?3:1<zn?2:En[ui+0]!=0),ui+=16;or>>=4,fi=fi>>1|mi<<7,hi=(hi<<8|Zn)>>>0}for(Kr=or,Si=fi>>4,Fr=0;4>Fr;Fr+=2){for(Zn=0,or=un.la>>4+Fr,fi=la.la>>4+Fr,$n=0;2>$n;++$n){for(mi=1&fi,li=0;2>li;++li)zn=mi+(1&or),or=or>>1|(mi=0<(zn=Qa(lr,Ni[2],zn,Er.Qc,0,En,ui)))<<3,Zn=Zn<<2|(3<zn?3:1<zn?2:En[ui+0]!=0),ui+=16;or>>=2,fi=fi>>1|mi<<5}In|=Zn<<4*Fr,Kr|=or<<4<<Fr,Si|=(240&fi)<<Fr}un.la=Kr,la.la=Si,Vi.Hc=hi,Vi.Gc=In,Vi.ia=43690&In?0:Er.ia,Ni=!(hi|In)}if(0<Ts.L&&(Ts.wa[Ts.Y+Ts.ja]=Ts.gd[Nn.$b][Nn.Za],Ts.wa[Ts.Y+Ts.ja].La|=!Ni),Wr.Ka)return Yt(Ln,7,"Premature end-of-file encountered.")}if(Is(Ln),Ts=Or,Wr=1,Nn=(Ks=Ln).D,un=0<Ks.L&&Ks.M>=Ks.zb&&Ks.M<=Ks.Va,Ks.Aa==0)t:{if(Nn.M=Ks.M,Nn.uc=un,Wa(Ks,Nn),Wr=1,Nn=(Zn=Ks.D).Nb,un=(In=Yd[Ks.L])*Ks.R,lr=In/2*Ks.B,$n=16*Nn*Ks.R,li=8*Nn*Ks.B,Ni=Ks.sa,Vi=Ks.ta-un+$n,Er=Ks.qa,En=Ks.ra-lr+li,ui=Ks.Ha,la=Ks.Ia-lr+li,fi=(or=Zn.M)==0,hi=or>=Ks.Va-1,Ks.Aa==2&&Wa(Ks,Zn),Zn.uc)for(mi=(zn=Ks).D.M,e(zn.D.uc),Zn=zn.yb;Zn<zn.Hb;++Zn){Si=Zn,Kr=mi;var pr=(Qn=(gi=zn).D).Nb;Fr=gi.R;var Qn=Qn.wa[Qn.Y+Si],oa=gi.sa,qr=gi.ta+16*pr*Fr+16*Si,rn=Qn.dd,ln=Qn.tc;if(ln!=0)if(e(3<=ln),gi.L==1)0<Si&&B_(oa,qr,Fr,ln+4),Qn.La&&Rm(oa,qr,Fr,ln),0<Kr&&U_(oa,qr,Fr,ln+4),Qn.La&&Dm(oa,qr,Fr,ln);else{var Hn=gi.B,Ia=gi.qa,ul=gi.ra+8*pr*Hn+8*Si,Ca=gi.Ha,gi=gi.Ia+8*pr*Hn+8*Si;pr=Qn.ld,0<Si&&(ii(oa,qr,Fr,ln+4,rn,pr),Pl(Ia,ul,Ca,gi,Hn,ln+4,rn,pr)),Qn.La&&(nh(oa,qr,Fr,ln,rn,pr),k_(Ia,ul,Ca,gi,Hn,ln,rn,pr)),0<Kr&&(vr(oa,qr,Fr,ln+4,rn,pr),ql(Ia,ul,Ca,gi,Hn,ln+4,rn,pr)),Qn.La&&(Wc(oa,qr,Fr,ln,rn,pr),Em(Ia,ul,Ca,gi,Hn,ln,rn,pr))}}if(Ks.ia&&alert("todo:DitherRow"),Ts.put!=null){if(Zn=16*or,or=16*(or+1),fi?(Ts.y=Ks.sa,Ts.O=Ks.ta+$n,Ts.f=Ks.qa,Ts.N=Ks.ra+li,Ts.ea=Ks.Ha,Ts.W=Ks.Ia+li):(Zn-=In,Ts.y=Ni,Ts.O=Vi,Ts.f=Er,Ts.N=En,Ts.ea=ui,Ts.W=la),hi||(or-=In),or>Ts.o&&(or=Ts.o),Ts.F=null,Ts.J=null,Ks.Fa!=null&&0<Ks.Fa.length&&Zn<or&&(Ts.J=Sr(Ks,Ts,Zn,or-Zn),Ts.F=Ks.mb,Ts.F==null&&Ts.F.length==0)){Wr=Yt(Ks,3,"Could not decode alpha data.");break t}Zn<Ts.j&&(In=Ts.j-Zn,Zn=Ts.j,e(!(1&In)),Ts.O+=Ks.R*In,Ts.N+=Ks.B*(In>>1),Ts.W+=Ks.B*(In>>1),Ts.F!=null&&(Ts.J+=Ts.width*In)),Zn<or&&(Ts.O+=Ts.v,Ts.N+=Ts.v>>1,Ts.W+=Ts.v>>1,Ts.F!=null&&(Ts.J+=Ts.v),Ts.ka=Zn-Ts.j,Ts.U=Ts.va-Ts.v,Ts.T=or-Zn,Wr=Ts.put(Ts))}Nn+1!=Ks.Ic||hi||(r(Ks.sa,Ks.ta-un,Ni,Vi+16*Ks.R,un),r(Ks.qa,Ks.ra-lr,Er,En+8*Ks.B,lr),r(Ks.Ha,Ks.Ia-lr,ui,la+8*Ks.B,lr))}if(!Wr)return Yt(Ln,6,"Output aborted.")}return 1})(He,Tt)),Tt.bc!=null&&Tt.bc(Tt),Pt&=1}return Pt?(He.cb=0,Pt):0})(N,ne)||(T=N.a)}}else T=N.a}T==0&&Le.Oa!=null&&Le.Oa.fd&&(T=sh(Le.ba))}Le=T}Ie=Le!=0?null:11>Ie?We.f.RGBA.eb:We.f.kb.y}else Ie=null;return Ie};var O0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(I,E){for(var A="",Y=0;Y<4;Y++)A+=String.fromCharCode(I[E++]);return A}function m(I,E){return I[E+0]|I[E+1]<<8}function _(I,E){return(I[E+0]|I[E+1]<<8|I[E+2]<<16)>>>0}function p(I,E){return(I[E+0]|I[E+1]<<8|I[E+2]<<16|I[E+3]<<24)>>>0}new u;var g=[0],C=[0],y=[],S=new u,v=t,k=(function(I,E){var A={},Y=0,ee=!1,J=0,H=0;if(A.frames=[],!(function(O,U){for(var Q=0;Q<4;Q++)if(O[U+Q]!="RIFF".charCodeAt(Q))return!0;return!1})(I,E)){for(p(I,E+=4),E+=8;E<I.length;){var V=h(I,E),K=p(I,E+=4);E+=4;var j=K+(1&K);switch(V){case"VP8 ":case"VP8L":A.frames[Y]===void 0&&(A.frames[Y]={}),(R=A.frames[Y]).src_off=ee?H:E-8,R.src_size=J+K+8,Y++,ee&&(ee=!1,J=0,H=0);break;case"VP8X":(R=A.header={}).feature_flags=I[E];var te=E+4;R.canvas_width=1+_(I,te),te+=3,R.canvas_height=1+_(I,te),te+=3;break;case"ALPH":ee=!0,J=j+8,H=E-8;break;case"ANIM":(R=A.header).bgcolor=p(I,E),te=E+4,R.loop_count=m(I,te),te+=2;break;case"ANMF":var ce,R;(R=A.frames[Y]={}).offset_x=2*_(I,E),E+=3,R.offset_y=2*_(I,E),E+=3,R.width=1+_(I,E),E+=3,R.height=1+_(I,E),E+=3,R.duration=_(I,E),E+=3,ce=I[E++],R.dispose=1&ce,R.blend=ce>>1&1}V!="ANMF"&&(E+=j)}return A}})(v,0);k.response=v,k.rgbaoutput=!0,k.dataurl=!1;var L=k.header?k.header:null,M=k.frames?k.frames:null;if(L){L.loop_counter=L.loop_count,g=[L.canvas_height],C=[L.canvas_width];for(var P=0;P<M.length&&M[P].blend!=0;P++);}var F=M[0],G=S.WebPDecodeRGBA(v,F.src_off,F.src_size,C,g);F.rgba=G,F.imgwidth=C[0],F.imgheight=g[0];for(var B=0;B<C[0]*g[0]*4;B++)y[B]=G[B];return this.width=C,this.height=g,this.data=y,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function jH(){var t,e=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(e));t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t.length+" >>"),this.internal.write("stream"),this.internal.write(t),this.internal.write("endstream"),this.internal.write("endobj")}function OH(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(t){var e,n,r,i,a,o,c,u,h,m=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new u,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new _(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,h=new m}]);var _=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=O;Object.defineProperty(this,"pdf",{get:function(){return U}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(Z){Q=!!Z}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(Z){q=!!Z}});var $=0;Object.defineProperty(this,"posX",{get:function(){return $},set:function(Z){isNaN(Z)||($=Z)}});var de=0;Object.defineProperty(this,"posY",{get:function(){return de},set:function(Z){isNaN(Z)||(de=Z)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(Z){var le;typeof Z=="number"?le=[Z,Z,Z,Z]:((le=new Array(4))[0]=Z[0],le[1]=Z.length>=2?Z[1]:le[0],le[2]=Z.length>=3?Z[2]:le[0],le[3]=Z.length>=4?Z[3]:le[1]),h.margin=le}});var ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ae},set:function(Z){ae=Z}});var _e=0;Object.defineProperty(this,"lastBreak",{get:function(){return _e},set:function(Z){_e=Z}});var ie=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ie},set:function(Z){ie=Z}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(Z){Z instanceof m&&(h=Z)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(Z){h.path=Z}});var Ne=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ne},set:function(Z){Ne=Z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Z){var le;le=p(Z),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Z){var le=p(Z);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Z){["butt","round","square"].indexOf(Z)!==-1&&(this.ctx.lineCap=Z,this.pdf.setLineCap(Z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Z){isNaN(Z)||(this.ctx.lineWidth=Z,this.pdf.setLineWidth(Z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Z){["bevel","round","miter"].indexOf(Z)!==-1&&(this.ctx.lineJoin=Z,this.pdf.setLineJoin(Z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Z){isNaN(Z)||(this.ctx.miterLimit=Z,this.pdf.setMiterLimit(Z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Z){this.ctx.textBaseline=Z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Z){["right","end","center","left","start"].indexOf(Z)!==-1&&(this.ctx.textAlign=Z)}});var X=null,xe=null,fe=null;Object.defineProperty(this,"fontFaces",{get:function(){return fe},set:function(Z){X=null,xe=null,fe=Z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Z){var le;if(this.ctx.font=Z,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Z))!==null){var se=le[1];le[2];var Re=le[3],be=le[4];le[5];var De=le[6],re=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(be)[2];be=Math.floor(re==="px"?parseFloat(be)*this.pdf.internal.scaleFactor:re==="em"?parseFloat(be)*this.pdf.getFontSize():parseFloat(be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(be);var me=(function(xt){var mt,Ve,it=[],Fe=xt.trim();if(Fe==="")return DC;if(Fe in CT)return[CT[Fe]];for(;Fe!=="";){switch(Ve=null,mt=(Fe=ST(Fe)).charAt(0)){case'"':case"'":Ve=EH(Fe.substring(1),mt);break;default:Ve=DH(Fe)}if(Ve===null||(it.push(Ve[0]),(Fe=ST(Ve[1]))!==""&&Fe.charAt(0)!==","))return DC;Fe=Fe.replace(/^,/,"")}return it})(De);if(this.fontFaces){var ve=(function(xt,mt){var Ve=xt.getFontList(),it=JSON.stringify(Ve);if(X===null||xe!==it){var Fe=(function(nt){var lt=[];return Object.keys(nt).forEach(function(Mt){nt[Mt].forEach(function(ut){var qe=null;switch(ut){case"bold":qe={family:Mt,weight:"bold"};break;case"italic":qe={family:Mt,style:"italic"};break;case"bolditalic":qe={family:Mt,weight:"bold",style:"italic"};break;case"":case"normal":qe={family:Mt}}qe!==null&&(qe.ref={name:Mt,style:ut},lt.push(qe))})}),lt})(Ve);X=(function(nt){for(var lt={},Mt=0;Mt<nt.length;++Mt){var ut=EC(nt[Mt]),qe=ut.family,Ee=ut.stretch,Ye=ut.style,pe=ut.weight;lt[qe]=lt[qe]||{},lt[qe][Ee]=lt[qe][Ee]||{},lt[qe][Ee][Ye]=lt[qe][Ee][Ye]||{},lt[qe][Ee][Ye][pe]=ut}return lt})(Fe.concat(mt)),xe=it}return X})(this.pdf,this.fontFaces),et=me.map(function(xt){return{family:xt,stretch:"normal",weight:Re,style:se}}),Dt=(function(xt,mt,Ve){for(var it=(Ve=Ve||{}).defaultFontFamily||"times",Fe=Object.assign({},vH,Ve.genericFontFamilies||{}),nt=null,lt=null,Mt=0;Mt<mt.length;++Mt)if(Fe[(nt=EC(mt[Mt])).family]&&(nt.family=Fe[nt.family]),xt.hasOwnProperty(nt.family)){lt=xt[nt.family];break}if(!(lt=lt||xt[it]))throw new Error("Could not find a font-family for the rule '"+NT(nt)+"' and default family '"+it+"'.");if(lt=(function(ut,qe){if(qe[ut])return qe[ut];var Ee=G2[ut],Ye=Ee<=G2.normal?-1:1,pe=bT(qe,vO,Ee,Ye);if(!pe)throw new Error("Could not find a matching font-stretch value for "+ut);return pe})(nt.stretch,lt),lt=(function(ut,qe){if(qe[ut])return qe[ut];for(var Ee=SO[ut],Ye=0;Ye<Ee.length;++Ye)if(qe[Ee[Ye]])return qe[Ee[Ye]];throw new Error("Could not find a matching font-style for "+ut)})(nt.style,lt),!(lt=(function(ut,qe){if(qe[ut])return qe[ut];if(ut===400&&qe[500])return qe[500];if(ut===500&&qe[400])return qe[400];var Ee=SH[ut],Ye=bT(qe,EO,Ee,ut<400?-1:1);if(!Ye)throw new Error("Could not find a matching font-weight for value "+ut);return Ye})(nt.weight,lt)))throw new Error("Failed to resolve a font for the rule '"+NT(nt)+"'.");return lt})(ve,et);this.pdf.setFont(Dt.ref.name,Dt.ref.style)}else{var ot="";(Re==="bold"||parseInt(Re,10)>=700||se==="bold")&&(ot="bold"),se==="italic"&&(ot+="italic"),ot.length===0&&(ot="normal");for(var At="",ct={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ge=0;Ge<me.length;Ge++){if(this.pdf.internal.getFont(me[Ge],ot,{noFallback:!0,disableWarning:!0})!==void 0){At=me[Ge];break}if(ot==="bolditalic"&&this.pdf.internal.getFont(me[Ge],"bold",{noFallback:!0,disableWarning:!0})!==void 0)At=me[Ge],ot="bold";else if(this.pdf.internal.getFont(me[Ge],"normal",{noFallback:!0,disableWarning:!0})!==void 0){At=me[Ge],ot="normal";break}}if(At===""){for(var at=0;at<me.length;at++)if(ct[me[at]]){At=ct[me[at]];break}}At=At===""?"Times":At,this.pdf.setFont(At,ot)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Z){this.ctx.globalCompositeOperation=Z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Z){this.ctx.globalAlpha=Z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Z){this.ctx.lineDashOffset=Z,R.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Z){this.ctx.lineDash=Z,R.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Z){this.ctx.ignoreClearRect=!!Z}})};_.prototype.setLineDash=function(O){this.lineDash=O},_.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},_.prototype.fill=function(){M.call(this,"fill",!1)},_.prototype.stroke=function(){M.call(this,"stroke",!1)},_.prototype.beginPath=function(){this.path=[{type:"begin"}]},_.prototype.moveTo=function(O,U){if(isNaN(O)||isNaN(U))throw Lr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new o(O,U));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(O,U)},_.prototype.closePath=function(){var O=new o(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&Nr(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){O=new o(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},_.prototype.lineTo=function(O,U){if(isNaN(O)||isNaN(U))throw Lr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new o(O,U));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},_.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},_.prototype.quadraticCurveTo=function(O,U,Q,q){if(isNaN(Q)||isNaN(q)||isNaN(O)||isNaN(U))throw Lr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var $=this.ctx.transform.applyToPoint(new o(Q,q)),de=this.ctx.transform.applyToPoint(new o(O,U));this.path.push({type:"qct",x1:de.x,y1:de.y,x:$.x,y:$.y}),this.ctx.lastPoint=new o($.x,$.y)},_.prototype.bezierCurveTo=function(O,U,Q,q,$,de){if(isNaN($)||isNaN(de)||isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q))throw Lr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ae=this.ctx.transform.applyToPoint(new o($,de)),_e=this.ctx.transform.applyToPoint(new o(O,U)),ie=this.ctx.transform.applyToPoint(new o(Q,q));this.path.push({type:"bct",x1:_e.x,y1:_e.y,x2:ie.x,y2:ie.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new o(ae.x,ae.y)},_.prototype.arc=function(O,U,Q,q,$,de){if(isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q)||isNaN($))throw Lr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(de=!!de,!this.ctx.transform.isIdentity){var ae=this.ctx.transform.applyToPoint(new o(O,U));O=ae.x,U=ae.y;var _e=this.ctx.transform.applyToPoint(new o(0,Q)),ie=this.ctx.transform.applyToPoint(new o(0,0));Q=Math.sqrt(Math.pow(_e.x-ie.x,2)+Math.pow(_e.y-ie.y,2))}Math.abs($-q)>=2*Math.PI&&(q=0,$=2*Math.PI),this.path.push({type:"arc",x:O,y:U,radius:Q,startAngle:q,endAngle:$,counterclockwise:de})},_.prototype.arcTo=function(O,U,Q,q,$){throw new Error("arcTo not implemented.")},_.prototype.rect=function(O,U,Q,q){if(isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q))throw Lr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,U),this.lineTo(O+Q,U),this.lineTo(O+Q,U+q),this.lineTo(O,U+q),this.lineTo(O,U),this.lineTo(O+Q,U),this.lineTo(O,U)},_.prototype.fillRect=function(O,U,Q,q){if(isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q))throw Lr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var $={};this.lineCap!=="butt"&&($.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&($.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,U,Q,q),this.fill(),$.hasOwnProperty("lineCap")&&(this.lineCap=$.lineCap),$.hasOwnProperty("lineJoin")&&(this.lineJoin=$.lineJoin)}},_.prototype.strokeRect=function(O,U,Q,q){if(isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q))throw Lr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");C.call(this)||(this.beginPath(),this.rect(O,U,Q,q),this.stroke())},_.prototype.clearRect=function(O,U,Q,q){if(isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q))throw Lr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,U,Q,q))},_.prototype.save=function(O){O=typeof O!="boolean"||O;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},_.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(U),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},_.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(O){var U,Q,q,$;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))U=0,Q=0,q=0,$=0;else{var de=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(de!==null)U=parseInt(de[1]),Q=parseInt(de[2]),q=parseInt(de[3]),$=1;else if((de=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)U=parseInt(de[1]),Q=parseInt(de[2]),q=parseInt(de[3]),$=parseFloat(de[4]);else{if($=1,typeof O=="string"&&O.charAt(0)!=="#"){var ae=new _O(O);O=ae.ok?ae.toHex():"#000000"}O.length===4?(U=O.substring(1,2),U+=U,Q=O.substring(2,3),Q+=Q,q=O.substring(3,4),q+=q):(U=O.substring(1,3),Q=O.substring(3,5),q=O.substring(5,7)),U=parseInt(U,16),Q=parseInt(Q,16),q=parseInt(q,16)}}return{r:U,g:Q,b:q,a:$,style:O}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},C=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};_.prototype.fillText=function(O,U,Q,q){if(isNaN(U)||isNaN(Q)||typeof O!="string")throw Lr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!g.call(this)){var $=j(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;Y.call(this,{text:O,x:U,y:Q,scale:de,angle:$,align:this.textAlign,maxWidth:q})}},_.prototype.strokeText=function(O,U,Q,q){if(isNaN(U)||isNaN(Q)||typeof O!="string")throw Lr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!C.call(this)){q=isNaN(q)?void 0:q;var $=j(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;Y.call(this,{text:O,x:U,y:Q,scale:de,renderingMode:"stroke",angle:$,align:this.textAlign,maxWidth:q})}},_.prototype.measureText=function(O){if(typeof O!="string")throw Lr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,Q=this.pdf.internal.scaleFactor,q=U.internal.getFontSize(),$=U.getStringUnitWidth(O)*q/U.internal.scaleFactor;return new function(de){var ae=(de=de||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ae}}),this}({width:$*=Math.round(96*Q/72*1e4)/1e4})},_.prototype.scale=function(O,U){if(isNaN(O)||isNaN(U))throw Lr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new u(O,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},_.prototype.rotate=function(O){if(isNaN(O))throw Lr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new u(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},_.prototype.translate=function(O,U){if(isNaN(O)||isNaN(U))throw Lr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new u(1,0,0,1,O,U);this.ctx.transform=this.ctx.transform.multiply(Q)},_.prototype.transform=function(O,U,Q,q,$,de){if(isNaN(O)||isNaN(U)||isNaN(Q)||isNaN(q)||isNaN($)||isNaN(de))throw Lr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ae=new u(O,U,Q,q,$,de);this.ctx.transform=this.ctx.transform.multiply(ae)},_.prototype.setTransform=function(O,U,Q,q,$,de){O=isNaN(O)?1:O,U=isNaN(U)?0:U,Q=isNaN(Q)?0:Q,q=isNaN(q)?1:q,$=isNaN($)?0:$,de=isNaN(de)?0:de,this.ctx.transform=new u(O,U,Q,q,$,de)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};_.prototype.drawImage=function(O,U,Q,q,$,de,ae,_e,ie){var Ne=this.pdf.getImageProperties(O),X=1,xe=1,fe=1,Z=1;q!==void 0&&_e!==void 0&&(fe=_e/q,Z=ie/$,X=Ne.width/q*_e/q,xe=Ne.height/$*ie/$),de===void 0&&(de=U,ae=Q,U=0,Q=0),q!==void 0&&_e===void 0&&(_e=q,ie=$),q===void 0&&_e===void 0&&(_e=Ne.width,ie=Ne.height);var le=this.ctx.transform.decompose(),se=j(le.rotate.shx),Re=new u,be=(Re=(Re=(Re=Re.multiply(le.translate)).multiply(le.skew)).multiply(le.scale)).applyToRectangle(new c(de-U*fe,ae-Q*Z,q*X,$*xe));if(this.autoPaging){for(var De,re=S.call(this,be),me=[],ve=0;ve<re.length;ve+=1)me.indexOf(re[ve])===-1&&me.push(re[ve]);L(me);for(var et=me[0],Dt=me[me.length-1],ot=et;ot<Dt+1;ot++){this.pdf.setPage(ot);var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=ot===1?this.posY+this.margin[0]:this.margin[0],Ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],at=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],xt=ot===1?0:Ge+(ot-2)*at;if(this.ctx.clip_path.length!==0){var mt=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(De,this.posX+this.margin[3],-xt+ct+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=mt}var Ve=JSON.parse(JSON.stringify(be));Ve=k([Ve],this.posX+this.margin[3],-xt+ct+this.ctx.prevPageLastElemOffset)[0];var it=(ot>et||ot<Dt)&&y.call(this);it&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,at,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",Ve.x,Ve.y,Ve.w,Ve.h,null,null,se),it&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",be.x,be.y,be.w,be.h,null,null,se)};var S=function(O,U,Q){var q=[];U=U||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var $=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":q.push(Math.floor((O.y+$)/Q)+1);break;case"arc":q.push(Math.floor((O.y+$-O.radius)/Q)+1),q.push(Math.floor((O.y+$+O.radius)/Q)+1);break;case"qct":var de=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);q.push(Math.floor((de.y+$)/Q)+1),q.push(Math.floor((de.y+de.h+$)/Q)+1);break;case"bct":var ae=ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);q.push(Math.floor((ae.y+$)/Q)+1),q.push(Math.floor((ae.y+ae.h+$)/Q)+1);break;case"rect":q.push(Math.floor((O.y+$)/Q)+1),q.push(Math.floor((O.y+O.h+$)/Q)+1)}for(var _e=0;_e<q.length;_e+=1)for(;this.pdf.internal.getNumberOfPages()<q[_e];)v.call(this);return q},v=function(){var O=this.fillStyle,U=this.strokeStyle,Q=this.font,q=this.lineCap,$=this.lineWidth,de=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=U,this.font=Q,this.lineCap=q,this.lineWidth=$,this.lineJoin=de},k=function(O,U,Q){for(var q=0;q<O.length;q++)switch(O[q].type){case"bct":O[q].x2+=U,O[q].y2+=Q;case"qct":O[q].x1+=U,O[q].y1+=Q;default:O[q].x+=U,O[q].y+=Q}return O},L=function(O){return O.sort(function(U,Q){return U-Q})},M=function(O,U){var Q=this.fillStyle,q=this.strokeStyle,$=this.lineCap,de=this.lineWidth,ae=Math.abs(de*this.ctx.transform.scaleX),_e=this.lineJoin;if(this.autoPaging){for(var ie,Ne,X=JSON.parse(JSON.stringify(this.path)),xe=JSON.parse(JSON.stringify(this.path)),fe=[],Z=0;Z<xe.length;Z++)if(xe[Z].x!==void 0)for(var le=S.call(this,xe[Z]),se=0;se<le.length;se+=1)fe.indexOf(le[se])===-1&&fe.push(le[se]);for(var Re=0;Re<fe.length;Re++)for(;this.pdf.internal.getNumberOfPages()<fe[Re];)v.call(this);L(fe);for(var be=fe[0],De=fe[fe.length-1],re=be;re<De+1;re++){this.pdf.setPage(re),this.fillStyle=Q,this.strokeStyle=q,this.lineCap=$,this.lineWidth=ae,this.lineJoin=_e;var me=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ve=re===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ot=re===1?0:et+(re-2)*Dt;if(this.ctx.clip_path.length!==0){var At=this.path;ie=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(ie,this.posX+this.margin[3],-ot+ve+this.ctx.prevPageLastElemOffset),P.call(this,O,!0),this.path=At}if(Ne=JSON.parse(JSON.stringify(X)),this.path=k(Ne,this.posX+this.margin[3],-ot+ve+this.ctx.prevPageLastElemOffset),U===!1||re===0){var ct=(re>be||re<De)&&y.call(this);ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],me,Dt,null).clip().discardPath()),P.call(this,O,U),ct&&this.pdf.restoreGraphicsState()}this.lineWidth=de}this.path=X}else this.lineWidth=ae,P.call(this,O,U),this.lineWidth=de},P=function(O,U){if((O!=="stroke"||U||!C.call(this))&&(O==="stroke"||U||!g.call(this))){for(var Q,q,$=[],de=this.path,ae=0;ae<de.length;ae++){var _e=de[ae];switch(_e.type){case"begin":$.push({begin:!0});break;case"close":$.push({close:!0});break;case"mt":$.push({start:_e,deltas:[],abs:[]});break;case"lt":var ie=$.length;if(de[ae-1]&&!isNaN(de[ae-1].x)&&(Q=[_e.x-de[ae-1].x,_e.y-de[ae-1].y],ie>0)){for(;ie>=0;ie--)if($[ie-1].close!==!0&&$[ie-1].begin!==!0){$[ie-1].deltas.push(Q),$[ie-1].abs.push(_e);break}}break;case"bct":Q=[_e.x1-de[ae-1].x,_e.y1-de[ae-1].y,_e.x2-de[ae-1].x,_e.y2-de[ae-1].y,_e.x-de[ae-1].x,_e.y-de[ae-1].y],$[$.length-1].deltas.push(Q);break;case"qct":var Ne=de[ae-1].x+2/3*(_e.x1-de[ae-1].x),X=de[ae-1].y+2/3*(_e.y1-de[ae-1].y),xe=_e.x+2/3*(_e.x1-_e.x),fe=_e.y+2/3*(_e.y1-_e.y),Z=_e.x,le=_e.y;Q=[Ne-de[ae-1].x,X-de[ae-1].y,xe-de[ae-1].x,fe-de[ae-1].y,Z-de[ae-1].x,le-de[ae-1].y],$[$.length-1].deltas.push(Q);break;case"arc":$.push({deltas:[],abs:[],arc:!0}),Array.isArray($[$.length-1].abs)&&$[$.length-1].abs.push(_e)}}q=U?null:O==="stroke"?"stroke":"fill";for(var se=!1,Re=0;Re<$.length;Re++)if($[Re].arc)for(var be=$[Re].abs,De=0;De<be.length;De++){var re=be[De];re.type==="arc"?B.call(this,re.x,re.y,re.radius,re.startAngle,re.endAngle,re.counterclockwise,void 0,U,!se):ee.call(this,re.x,re.y),se=!0}else if($[Re].close===!0)this.pdf.internal.out("h"),se=!1;else if($[Re].begin!==!0){var me=$[Re].start.x,ve=$[Re].start.y;J.call(this,$[Re].deltas,me,ve),se=!0}q&&I.call(this,q),U&&E.call(this)}},F=function(O){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-Q;case"top":return O+U-Q;case"hanging":return O+U-2*Q;case"middle":return O+U/2-Q;default:return O}},G=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};_.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(U,Q){this.colorStops.push([U,Q])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},_.prototype.createPattern=function(){return this.createLinearGradient()},_.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function(O,U,Q,q,$,de,ae,_e,ie){for(var Ne=V.call(this,Q,q,$,de),X=0;X<Ne.length;X++){var xe=Ne[X];X===0&&(ie?A.call(this,xe.x1+O,xe.y1+U):ee.call(this,xe.x1+O,xe.y1+U)),H.call(this,O,U,xe.x2,xe.y2,xe.x3,xe.y3,xe.x4,xe.y4)}_e?E.call(this):I.call(this,ae)},I=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},E=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(O,U){this.pdf.internal.out(n(O)+" "+r(U)+" m")},Y=function(O){var U;switch(O.align){case"right":case"end":U="right";break;case"center":U="center";break;default:U="left"}var Q,q,$,de=this.pdf.getTextDimensions(O.text),ae=F.call(this,O.y),_e=G.call(this,ae)-de.h,ie=this.ctx.transform.applyToPoint(new o(O.x,ae));if(this.autoPaging){var Ne=this.ctx.transform.decompose(),X=new u;X=(X=(X=X.multiply(Ne.translate)).multiply(Ne.skew)).multiply(Ne.scale);for(var xe=this.ctx.transform.applyToRectangle(new c(O.x,ae,de.w,de.h)),fe=X.applyToRectangle(new c(O.x,_e,de.w,de.h)),Z=S.call(this,fe),le=[],se=0;se<Z.length;se+=1)le.indexOf(Z[se])===-1&&le.push(Z[se]);L(le);for(var Re=le[0],be=le[le.length-1],De=Re;De<be+1;De++){this.pdf.setPage(De);var re=De===1?this.posY+this.margin[0]:this.margin[0],me=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ve=this.pdf.internal.pageSize.height-this.margin[2],et=ve-this.margin[0],Dt=this.pdf.internal.pageSize.width-this.margin[1],ot=Dt-this.margin[3],At=De===1?0:me+(De-2)*et;if(this.ctx.clip_path.length!==0){var ct=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Q,this.posX+this.margin[3],-1*At+re),P.call(this,"fill",!0),this.path=ct}var Ge=k([JSON.parse(JSON.stringify(fe))],this.posX+this.margin[3],-At+re+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*O.scale),$=this.lineWidth,this.lineWidth=$*O.scale);var at=this.autoPaging!=="text";if(at||Ge.y+Ge.h<=ve){if(at||Ge.y>=re&&Ge.x<=Dt){var xt=at?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Dt-Ge.x)[0],mt=k([JSON.parse(JSON.stringify(xe))],this.posX+this.margin[3],-At+re+this.ctx.prevPageLastElemOffset)[0],Ve=at&&(De>Re||De<be)&&y.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ot,et,null).clip().discardPath()),this.pdf.text(xt,mt.x,mt.y,{angle:O.angle,align:U,renderingMode:O.renderingMode}),Ve&&this.pdf.restoreGraphicsState()}}else Ge.y<ve&&(this.ctx.prevPageLastElemOffset+=ve-Ge.y);O.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=$)}}else O.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*O.scale),$=this.lineWidth,this.lineWidth=$*O.scale),this.pdf.text(O.text,ie.x+this.posX,ie.y+this.posY,{angle:O.angle,align:U,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=$)},ee=function(O,U,Q,q){Q=Q||0,q=q||0,this.pdf.internal.out(n(O+Q)+" "+r(U+q)+" l")},J=function(O,U,Q){return this.pdf.lines(O,U,Q,null,null)},H=function(O,U,Q,q,$,de,ae,_e){this.pdf.internal.out([e(i(Q+O)),e(a(q+U)),e(i($+O)),e(a(de+U)),e(i(ae+O)),e(a(_e+U)),"c"].join(" "))},V=function(O,U,Q,q){for(var $=2*Math.PI,de=Math.PI/2;U>Q;)U-=$;var ae=Math.abs(Q-U);ae<$&&q&&(ae=$-ae);for(var _e=[],ie=q?-1:1,Ne=U;ae>1e-5;){var X=Ne+ie*Math.min(ae,de);_e.push(K.call(this,O,Ne,X)),ae-=Math.abs(X-Ne),Ne=X}return _e},K=function(O,U,Q){var q=(Q-U)/2,$=O*Math.cos(q),de=O*Math.sin(q),ae=$,_e=-de,ie=ae*ae+_e*_e,Ne=ie+ae*$+_e*de,X=4/3*(Math.sqrt(2*ie*Ne)-Ne)/(ae*de-_e*$),xe=ae-X*_e,fe=_e+X*ae,Z=xe,le=-fe,se=q+U,Re=Math.cos(se),be=Math.sin(se);return{x1:O*Math.cos(U),y1:O*Math.sin(U),x2:xe*Re-fe*be,y2:xe*be+fe*Re,x3:Z*Re-le*be,y3:Z*be+le*Re,x4:O*Math.cos(Q),y4:O*Math.sin(Q)}},j=function(O){return 180*O/Math.PI},te=function(O,U,Q,q,$,de){var ae=O+.5*(Q-O),_e=U+.5*(q-U),ie=$+.5*(Q-$),Ne=de+.5*(q-de),X=Math.min(O,$,ae,ie),xe=Math.max(O,$,ae,ie),fe=Math.min(U,de,_e,Ne),Z=Math.max(U,de,_e,Ne);return new c(X,fe,xe-X,Z-fe)},ce=function(O,U,Q,q,$,de,ae,_e){var ie,Ne,X,xe,fe,Z,le,se,Re,be,De,re,me,ve,et=Q-O,Dt=q-U,ot=$-Q,At=de-q,ct=ae-$,Ge=_e-de;for(Ne=0;Ne<41;Ne++)Re=(le=(X=O+(ie=Ne/40)*et)+ie*((fe=Q+ie*ot)-X))+ie*(fe+ie*($+ie*ct-fe)-le),be=(se=(xe=U+ie*Dt)+ie*((Z=q+ie*At)-xe))+ie*(Z+ie*(de+ie*Ge-Z)-se),Ne==0?(De=Re,re=be,me=Re,ve=be):(De=Math.min(De,Re),re=Math.min(re,be),me=Math.max(me,Re),ve=Math.max(ve,be));return new c(Math.round(De),Math.round(re),Math.round(me-De),Math.round(ve-re))},R=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,U,Q=(O=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:U}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(nn.API),(function(t){var e=function(o){var c,u,h,m,_,p,g,C,y,S;for(u=[],h=0,m=(o+=c="\0\0\0\0".slice(o.length%4||4)).length;m>h;h+=4)(_=(o.charCodeAt(h)<<24)+(o.charCodeAt(h+1)<<16)+(o.charCodeAt(h+2)<<8)+o.charCodeAt(h+3))!==0?(p=(_=((_=((_=((_=(_-(S=_%85))/85)-(y=_%85))/85)-(C=_%85))/85)-(g=_%85))/85)%85,u.push(p+33,g+33,C+33,y+33,S+33)):u.push(122);return(function(v,k){for(var L=k;L>0;L--)v.pop()})(u,c.length),String.fromCharCode.apply(String,u)+"~>"},n=function(o){var c,u,h,m,_,p=String,g="length",C=255,y="charCodeAt",S="slice",v="replace";for(o[S](-2),o=o[S](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),h=[],m=0,_=(o+=c="uuuuu"[S](o[g]%5||5))[g];_>m;m+=5)u=52200625*(o[y](m)-33)+614125*(o[y](m+1)-33)+7225*(o[y](m+2)-33)+85*(o[y](m+3)-33)+(o[y](m+4)-33),h.push(C&u>>24,C&u>>16,C&u>>8,C&u);return(function(k,L){for(var M=L;M>0;M--)k.pop()})(h,c[g]),p.fromCharCode.apply(p,h)},r=function(o){return o.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),c.test(o)===!1)return"";for(var u="",h=0;h<o.length;h+=2)u+=String.fromCharCode("0x"+(o[h]+o[h+1]));return u},a=function(o){for(var c=new Uint8Array(o.length),u=o.length;u--;)c[u]=o.charCodeAt(u);return(c=w2(c)).reduce(function(h,m){return h+String.fromCharCode(m)},"")};t.processDataByFilters=function(o,c){var u=0,h=o||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),u=0;u<c.length;u+=1)switch(c[u]){case"ASCII85Decode":case"/ASCII85Decode":h=n(h),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=i(h),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=r(h),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=a(h),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[u]+'" is not implemented')}return{data:h,reverseChain:m.reverse().join(" ")}}})(nn.API),(function(t){t.loadFile=function(e,n,r){return(function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=(function(u,h,m){var _=new XMLHttpRequest,p=0,g=function(C){var y=C.length,S=[],v=String.fromCharCode;for(p=0;p<y;p+=1)S.push(v(255&C.charCodeAt(p)));return S.join("")};if(_.open("GET",u,!h),_.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(_.onload=function(){_.status===200?m(g(this.responseText)):m(void 0)}),_.send(null),h&&_.status===200)return g(_.responseText)})(i,a,o)}catch{}return c})(e,n,r)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(nn.API),(function(t){function e(){return(yn.html2canvas?Promise.resolve(yn.html2canvas):Cb(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function n(){return(yn.DOMPurify?Promise.resolve(yn.DOMPurify):Cb(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var r=function(c){var u=Nr(c);return u==="undefined"?"undefined":u==="string"||c instanceof String?"string":u==="number"||c instanceof Number?"number":u==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(c,u){var h=document.createElement(c);for(var m in u.className&&(h.className=u.className),u.innerHTML&&u.dompurify&&(h.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)h.style[m]=u.style[m];return h},a=function c(u,h){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),_=u.firstChild;_;_=_.nextSibling)h!==!0&&_.nodeType===1&&_.nodeName==="SCRIPT"||m.appendChild(c(_,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m},o=function c(u){var h=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),h);return(m=m.setProgress(1,c,1,[c])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(c,u){return c.__proto__=u||o.prototype,c},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(c,u){return this.then(function(){switch(u=u||(function(h){switch(r(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),u){case"string":return this.then(n).then(function(h){return this.set({src:i("div",{innerHTML:c,dompurify:h})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},o.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(u){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,u(this.prop.container,h)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(u){var h=this.opt.jsPDF,m=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=m,m)for(var g=0;g<m.length;++g){var C=m[g],y=C.src.find(function(S){return S.format==="truetype"});y&&h.addFont(y.url,C.ref.name,C.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,h.context2d.save(!0),u(this.prop.container,p)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(c,u,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(c,u):this.outputPdf(c,u)},o.prototype.outputPdf=function(c,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,u)})},o.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},o.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(c){if(r(c)!=="object")return this;var u=Object.keys(c||{}).map(function(h){if(h in o.template.prop)return function(){this.prop[h]=c[h]};switch(h){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[h]=c[h]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(c,u){return this.then(function(){var h=c in o.template.prop?this.prop[c]:this.opt[c];return u?u(h):h})},o.prototype.setMargin=function(c){return this.then(function(){switch(r(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},o.prototype.setPageSize=function(c){function u(h,m){return Math.floor(h*m/72*96)}return this.then(function(){(c=c||nn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:u(c.inner.width,c.k),height:u(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},o.prototype.setProgress=function(c,u,h,m){return c!=null&&(this.progress.val=c),u!=null&&(this.progress.state=u),h!=null&&(this.progress.n=h),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(c,u,h,m){return this.setProgress(c?this.progress.val+c:null,u||null,h?this.progress.n+h:null,m?this.progress.stack.concat(m):null)},o.prototype.then=function(c,u){var h=this;return this.thenCore(c,u,function(m,_){return h.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(p){return h.updateProgress(null,m),p}).then(m,_).then(function(p){return h.updateProgress(1),p})})},o.prototype.thenCore=function(c,u,h){h=h||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),u&&(u=u.bind(m));var _=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:o.convert(Object.assign({},m),Promise.prototype),p=h.call(_,c,u);return o.convert(p,m.__proto__)},o.prototype.thenExternal=function(c,u){return Promise.prototype.then.call(this,c,u)},o.prototype.thenList=function(c){var u=this;return c.forEach(function(h){u=u.thenCore(h)}),u},o.prototype.catch=function(c){c&&(c=c.bind(this));var u=Promise.prototype.catch.call(this,c);return o.convert(u,this)},o.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},o.prototype.error=function(c){return this.then(function(){throw new Error(c)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,nn.getPageSize=function(c,u,h){if(Nr(c)==="object"){var m=c;c=m.orientation,u=m.unit||u,h=m.format||h}u=u||"mm",h=h||"a4",c=(""+(c||"P")).toLowerCase();var _,p=(""+h).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+u}var C,y=0,S=0;if(g.hasOwnProperty(p))y=g[p][1]/_,S=g[p][0]/_;else try{y=h[1],S=h[0]}catch{throw new Error("Invalid format: "+h)}if(c==="p"||c==="portrait")c="p",S>y&&(C=S,S=y,y=C);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",y>S&&(C=S,S=y,y=C)}return{width:S,height:y,unit:u,k:_,orientation:c}},t.html=function(c,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(EC):null;var h=new o(u);return u.worker?h:h.from(c).doCallback()}})(nn.API),nn.API.addJS=function(t){var e,n,r=(function(i){for(var a="",o=0;o<i.length;o++){var c=i[o];if(c==="("||c===")"){for(var u=0,h=o-1;h>=0&&i[h]==="\\";h--)u++;a+=u%2==0?"\\"+c:c}else a+=c}return a})(t);return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+r+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],c=r.exec(o);if(c!=null){var u=c[1];n.internal.newObjectDeferredBegin(u,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,m=[];for(a=0;a<h;a++){var _=n.internal.newObject();m.push(_);var p=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var g=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<m.length;a++)n.internal.write("(page_"+(a+1)+")"+m[a]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+g+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,a){var o={title:i,options:a,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<r.children.length;a++){var o=r.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),a>0&&this.line("/Prev "+this.makeRef(r.children[a-1])),a<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var u=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var h=0;h<r.children.length;h++)this.renderItems(r.children[h])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var a=0;a<i.children.length;a++)r.count++,this.count_r(r,i.children[a]);return r.count}}])})(nn.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,a,o,c){var u,h=this.decode.DCT_DECODE,m=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,u=(function(_){for(var p,g=256*_.charCodeAt(4)+_.charCodeAt(5),C=_.length,y={width:0,height:0,numcomponents:1},S=4;S<C;S+=2){if(S+=g,e.indexOf(_.charCodeAt(S+1))!==-1){p=256*_.charCodeAt(S+5)+_.charCodeAt(S+6),y={width:256*_.charCodeAt(S+7)+_.charCodeAt(S+8),height:p,numcomponents:_.charCodeAt(S+9)};break}g=256*_.charCodeAt(S+2)+_.charCodeAt(S+3)}return y})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),u.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:n,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:h,index:r,alias:i}}return m}})(nn.API),nn.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=cH(t,{checkCrc:!0}),o=a.width,c=a.height,u=a.channels,h=a.palette,m=a.depth;i=h&&u===1?(function(B){for(var I=B.width,E=B.height,A=B.data,Y=B.palette,ee=B.depth,J=!1,H=[],V=[],K=void 0,j=!1,te=0,ce=0;ce<Y.length;ce++){var R=MR(Y[ce],4),O=R[0],U=R[1],Q=R[2],q=R[3];H.push(O,U,Q),q!=null&&(q===0?(te++,V.length<1&&V.push(ce)):q<255&&(j=!0))}if(j||te>1){J=!0,V=void 0;var $=I*E;K=new Uint8Array($);for(var de=new DataView(A.buffer),ae=0;ae<$;ae++){var _e=RC(de,ae,ee),ie=MR(Y[_e],4)[3];K[ae]=ie}}else te===0&&(V=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:J?8:void 0,colorBytes:A,alphaBytes:K,needSMask:J,palette:H,mask:V}})(a):u===2||u===4?(function(B){for(var I=B.data,E=B.width,A=B.height,Y=B.channels,ee=B.depth,J=Y===2?"DeviceGray":"DeviceRGB",H=Y-1,V=E*A,K=H,j=V*K,te=1*V,ce=Math.ceil(j*ee/8),R=Math.ceil(te*ee/8),O=new Uint8Array(ce),U=new Uint8Array(R),Q=new DataView(I.buffer),q=new DataView(O.buffer),$=new DataView(U.buffer),de=!1,ae=0;ae<V;ae++){for(var _e=ae*Y,ie=0;ie<K;ie++)OT(q,RC(Q,_e+ie,ee),ae*K+ie,ee);var Ne=RC(Q,_e+K,ee);Ne<(1<<ee)-1&&(de=!0),OT($,Ne,1*ae,ee)}return{colorSpace:J,colorsPerPixel:H,sMaskBitsPerComponent:de?ee:void 0,colorBytes:O,alphaBytes:U,needSMask:de}})(a):(function(B){var I=B.data,E=B.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:E,colorsPerPixel:E==="DeviceGray"?1:3,colorBytes:I instanceof Uint16Array?(function(A){for(var Y=A.length,ee=new Uint8Array(2*Y),J=new DataView(ee.buffer,ee.byteOffset,ee.byteLength),H=0;H<Y;H++)J.setUint16(2*H,A[H],!1);return ee})(I):I,needSMask:!1}})(a);var _,p,g,C=i,y=C.colorSpace,S=C.colorsPerPixel,v=C.sMaskBitsPerComponent,k=C.colorBytes,L=C.alphaBytes,M=C.needSMask,P=C.palette,F=C.mask,G=null;return r!==nn.API.image_compression.NONE&&typeof w2=="function"?(G=(function(B){var I;switch(B){case nn.API.image_compression.FAST:I=11;break;case nn.API.image_compression.MEDIUM:I=13;break;case nn.API.image_compression.SLOW:I=14;break;default:I=12}return I})(r),_=this.decode.FLATE_DECODE,p="/Predictor ".concat(G," /Colors ").concat(S," /BitsPerComponent ").concat(m," /Columns ").concat(o),t=RT(k,Math.ceil(o*S*m/8),S,m,r),M&&(g=RT(L,Math.ceil(o*v/8),1,v,r))):(_=void 0,p=void 0,t=k,M&&(g=L)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:n,data:t,index:e,filter:_,decodeParameters:p,transparency:F,palette:P,sMask:g,predictor:G,width:o,height:c,bitsPerComponent:m,sMaskBitsPerComponent:v,colorSpace:y}}},(function(t){t.processGIF89A=function(e,n,r,i){var a=new IH(e),o=a.width,c=a.height,u=[];a.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:o,height:c},m=new TC(100).encode(h,100);return t.processJPEG.call(this,m,n,r,i)},t.processGIF87A=t.processGIF89A})(nn.API),Ko.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ko.prototype.parseBGR=function(){this.pos=this.offset;var t="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[t]()}catch(n){Lr.log("bit decode error:"+n)}},Ko.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,c=0;c<8&&8*i+c<this.width;c++){var u=this.palette[a>>7-c&1];this.data[o+4*c]=u.blue,this.data[o+4*c+1]=u.green,this.data[o+4*c+2]=u.red,this.data[o+4*c+3]=255}n!==0&&(this.pos+=4-n)}},Ko.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,c=a>>4,u=15&a,h=this.palette[c];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*i+1>=this.width)break;h=this.palette[u],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Ko.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Ko.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,c=(a>>5&e)/e*255|0,u=(a>>10&e)/e*255|0,h=a>>15?255:0,m=r*this.width*4+4*i;this.data[m]=u,this.data[m+1]=c,this.data[m+2]=o,this.data[m+3]=h}this.pos+=t}},Ko.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&e)/e*255|0,u=(o>>5&n)/n*255|0,h=(o>>11)/e*255|0,m=i*this.width*4+4*a;this.data[m]=h,this.data[m+1]=u,this.data[m+2]=c,this.data[m+3]=255}this.pos+=t}},Ko.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Ko.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*n;this.data[c]=a,this.data[c+1]=i,this.data[c+2]=r,this.data[c+3]=o}},Ko.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,n,r,i){var a=new Ko(e,!1),o=a.width,c=a.height,u={data:a.getData(),width:o,height:c},h=new TC(100).encode(u,100);return t.processJPEG.call(this,h,n,r,i)}})(nn.API),LT.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,n,r,i){var a=new LT(e),o=a.width,c=a.height,u={data:a.getData(),width:o,height:c},h=new TC(100).encode(u,100);return t.processJPEG.call(this,h,n,r,i)}})(nn.API),nn.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),c=0,u=0,h=0;h<i;h+=4){var m=r[h],_=r[h+1],p=r[h+2],g=r[h+3];a[c++]=m,a[c++]=_,a[c++]=p,o[u++]=g}var C=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:C,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},nn.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ff=nn.API,lp=ff.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:i.metadata.Unicode.widths,u=c.fof?c.fof:1,h=e.kerning?e.kerning:i.metadata.Unicode.kerning,m=h.fof?h.fof:1,_=e.doKerning!==!1,p=0,g=t.length,C=0,y=c[0]||u,S=[];for(n=0;n<g;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?S.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/a)||0)/1e3):(p=_&&Nr(h[r])==="object"&&!isNaN(parseInt(h[r][C],10))?h[r][C]/m:0,S.push((c[r]||y)/u+p)),C=r;return S},vT=ff.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return ff.processArabic&&(t=ff.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:lp.apply(this,arguments).reduce(function(a,o){return a+o},0)},ET=function(t,e,n,r){for(var i=[],a=0,o=t.length,c=0;a!==o&&c+e[a]<n;)c+=e[a],a++;i.push(t.slice(0,a));var u=a;for(c=0;a!==o;)c+e[a]>r&&(i.push(t.slice(u,a)),c=0,u=a),c+=e[a],a++;return u!==a&&i.push(t.slice(u,a)),i},DT=function(t,e,n){n||(n={});var r,i,a,o,c,u,h,m=[],_=[m],p=n.textIndent||0,g=0,C=0,y=t.split(" "),S=lp.apply(this,[" ",n])[0];if(u=n.lineIndent===-1?y[0].length+2:n.lineIndent||0){var v=Array(u).join(" "),k=[];y.map(function(M){(M=M.split(/\s*\n/)).length>1?k=k.concat(M.map(function(P,F){return(F&&P.length?`
`:"")+P})):k.push(M[0])}),y=k,u=vT.apply(this,[v,n])}for(a=0,o=y.length;a<o;a++){var L=0;if(r=y[a],u&&r[0]==`
`&&(r=r.substr(1),L=1),p+g+(C=(i=lp.apply(this,[r,n])).reduce(function(M,P){return M+P},0))>e||L){if(C>e){for(c=ET.apply(this,[r,i,e-(p+g),e]),m.push(c.shift()),m=[c.pop()];c.length;)_.push([c.shift()]);C=i.slice(r.length-(m[0]?m[0].length:0)).reduce(function(M,P){return M+P},0)}else m=[r];_.push(m),p=C+u,g=S}else m.push(r),p+=g+C,g=S}return h=u?function(M,P){return(P?v:"")+M.join(" ")}:function(M){return M.join(" ")},_.map(h)},ff.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var _=this.internal.getFont(m.fontName,m.fontStyle),p="Unicode";return _.metadata[p]?{widths:_.metadata[p].widths||{0:1},kerning:_.metadata[p].kerning||{}}:{font:_.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=n.lineIndent;var c,u,h=[];for(c=0,u=r.length;c<u;c++)h=h.concat(DT.apply(this,[r[c],o,a]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},a=0;a<16;a++)r[n[a]]=e[a],i[e[a]]=n[a];var o=function(p){return"0x"+parseInt(p,10).toString(16)},c=t.__fontmetrics__.compress=function(p){var g,C,y,S,v=["{"];for(var k in p){if(g=p[k],isNaN(parseInt(k,10))?C="'"+k+"'":(k=parseInt(k,10),C=(C=o(k).slice(2)).slice(0,-1)+i[C.slice(-1)]),typeof g=="number")g<0?(y=o(g).slice(3),S="-"):(y=o(g).slice(2),S=""),y=S+y.slice(0,-1)+i[y.slice(-1)];else{if(Nr(g)!=="object")throw new Error("Don't know what to do with value type "+Nr(g)+".");y=c(g)}v.push(C+y)}return v.push("}"),v.join("")},u=t.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,C,y,S,v={},k=1,L=v,M=[],P="",F="",G=p.length-1,B=1;B<G;B+=1)(S=p[B])=="'"?g?(y=g.join(""),g=void 0):g=[]:g?g.push(S):S=="{"?(M.push([L,y]),L={},y=void 0):S=="}"?((C=M.pop())[0][C[1]]=L,y=void 0,L=C[0]):S=="-"?k=-1:y===void 0?r.hasOwnProperty(S)?(P+=r[S],y=parseInt(P,16)*k,k=1,P=""):P+=S:r.hasOwnProperty(S)?(F+=r[S],L[y]=parseInt(F,16)*k,k=1,y=void 0,F=""):F+=S;return v},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},_={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(p){var g=p.font,C=_.Unicode[g.postScriptName];C&&(g.metadata.Unicode={},g.metadata.Unicode.widths=C.widths,g.metadata.Unicode.kerning=C.kerning);var y=m.Unicode[g.postScriptName];y&&(g.metadata.Unicode.encoding=y,g.encoding=y.codePages[0])}])})(nn.API),(function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),a=0;a<r;a++)i[a]=n.charCodeAt(a);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,a=n.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Dp(c)),o.metadata=t.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])})(nn),nn.API.addSvgAsImage=function(t,e,n,r,i,a,o,c){if(isNaN(e)||isNaN(n))throw Lr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw Lr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=r,u.height=i;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},_=this;return(yn.canvg?Promise.resolve(yn.canvg):Cb(()=>import("./index.es-CMlmD2Da.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(h,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(m)}).then(function(){_.addImage(u.toDataURL("image/jpeg",1),e,n,r,i,o,c)})},nn.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},nn.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),u=[],h=0,m=0,_=0;function p(C,y){var S,v=!1;for(S=0;S<C.length;S+=1)C[S]===y&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=c.length;for(_=0;_<g;_+=1)n[c[_]].value=n[c[_]].defaultValue,n[c[_]].explicitSet=!1}if(Nr(t)==="object"){for(i in t)if(a=t[i],p(c,i)&&a!==void 0){if(n[i].type==="boolean"&&typeof a=="boolean")n[i].value=a;else if(n[i].type==="name"&&p(n[i].valueSet,a))n[i].value=a;else if(n[i].type==="integer"&&Number.isInteger(a))n[i].value=a;else if(n[i].type==="array"){for(h=0;h<a.length;h+=1)if(r=!0,a[h].length===1&&typeof a[h][0]=="number")u.push(String(a[h]-1));else if(a[h].length>1){for(m=0;m<a[h].length;m+=1)typeof a[h][m]!="number"&&(r=!1);r===!0&&u.push([a[h][0]-1,a[h][1]-1].join(" "))}n[i].value="["+u.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var C,y=[];for(C in n)n[C].explicitSet===!0&&(n[C].type==="name"?y.push("/"+C+" /"+n[C].value):y.push("/"+C+" "+n[C].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},nn.API.addMetadata=function(t,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",OH),this.internal.events.subscribe("postPutResources",jH)),this},(function(t){var e=t.API,n=e.pdfEscape16=function(a,o){for(var c,u=o.metadata.Unicode.widths,h=["","0","00","000","0000"],m=[""],_=0,p=a.length;_<p;++_){if(c=o.metadata.characterToGlyph(a.charCodeAt(_)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=a.charCodeAt(_),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(h[4-c.length],c)}return m.join("")},r=function(a){var o,c,u,h,m,_,p;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],_=0,p=(c=Object.keys(a).sort(function(g,C){return g-C})).length;_<p;_++)o=c[_],u.length>=100&&(m+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(h=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+h+">"));return u.length&&(m+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var c=o.font,u=o.out,h=o.newObject,m=o.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="Identity-H"){for(var _=c.metadata.Unicode.widths,p=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",C=0;C<p.length;C++)g+=String.fromCharCode(p[C]);var y=h();m({data:g,addLength1:!0,objectId:y}),u("endobj");var S=h();m({data:r(c.metadata.toUnicode),addLength1:!0,objectId:S}),u("endobj");var v=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Sf(c.fontName)),u("/FontFile2 "+y+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var k=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+Sf(c.fontName)),u("/FontDescriptor "+v+" 0 R"),u("/W "+t.API.PDFObject.convert(_)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+S+" 0 R"),u("/BaseFont /"+Sf(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+k+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var c=o.font,u=o.out,h=o.newObject,m=o.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var _=c.metadata.rawData,p="",g=0;g<_.length;g++)p+=String.fromCharCode(_[g]);var C=h();m({data:p,addLength1:!0,objectId:C}),u("endobj");var y=h();m({data:r(c.metadata.toUnicode),addLength1:!0,objectId:y}),u("endobj");var S=h();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+C+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+Sf(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=h();for(var v=0;v<c.metadata.hmtx.widths.length;v++)c.metadata.hmtx.widths[v]=parseInt(c.metadata.hmtx.widths[v]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+Sf(c.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,c=a.text||"",u=a.x,h=a.y,m=a.options||{},_=a.mutex||{},p=_.pdfEscape,g=_.activeFontKey,C=_.fonts,y=g,S="",v=0,k="",L=C[y].encoding;if(C[y].encoding!=="Identity-H")return{text:c,x:u,y:h,options:m,mutex:_};for(k=c,y=g,Array.isArray(c)&&(k=c[0]),v=0;v<k.length;v+=1)C[y].metadata.hasOwnProperty("cmap")&&(o=C[y].metadata.cmap.unicode.codeMap[k[v].charCodeAt(0)]),o||k[v].charCodeAt(0)<256&&C[y].metadata.hasOwnProperty("Unicode")?S+=k[v]:S+="";var M="";return parseInt(y.slice(1))<14||L==="WinAnsiEncoding"?M=p(S,y).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):L==="Identity-H"&&(M=n(S,C[y])),_.isHex=!0,{text:M,x:u,y:h,options:m,mutex:_}};e.events.push(["postProcessText",function(a){var o=a.text||"",c=[],u={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?c.push([i(Object.assign({},u,{text:o[h][0]})).text,o[h][1],o[h][2]]):c.push(i(Object.assign({},u,{text:o[h]})).text);a.text=c}else a.text=i(Object.assign({},u,{text:o})).text}])})(nn),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(nn.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,a,o,c,u,h,m,_=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],C={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,L=0;this.__bidiEngine__={};var M=function(A){var Y=A.charCodeAt(),ee=Y>>8,J=y[ee];return J!==void 0?_[256*J+(255&Y)]:ee===252||ee===253?"AL":v.test(ee)?"L":ee===8?"R":"N"},P=function(A){for(var Y,ee=0;ee<A.length;ee++){if((Y=M(A.charAt(ee)))==="L")return!1;if(Y==="R")return!0}return!1},F=function(A,Y,ee,J){var H,V,K,j,te=Y[J];switch(te){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(te="AN");break;case"AL":k=!0,te="R";break;case"WS":case"BN":te="N";break;case"CS":J<1||J+1>=Y.length||(H=ee[J-1])!=="EN"&&H!=="AN"||(V=Y[J+1])!=="EN"&&V!=="AN"?te="N":k&&(V="AN"),te=V===H?V:"N";break;case"ES":te=(H=J>0?ee[J-1]:"B")==="EN"&&J+1<Y.length&&Y[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&ee[J-1]==="EN"){te="EN";break}if(k){te="N";break}for(K=J+1,j=Y.length;K<j&&Y[K]==="ET";)K++;te=K<j&&Y[K]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(j=Y.length,K=J+1;K<j&&Y[K]==="NSM";)K++;if(K<j){var ce=A[J],R=ce>=1425&&ce<=2303||ce===64286;if(H=Y[K],R&&(H==="R"||H==="AL")){te="R";break}}}te=J<1||(H=Y[J-1])==="B"?"N":ee[J-1];break;case"B":k=!1,i=!0,te=L;break;case"S":a=!0,te="N"}return te},G=function(A,Y,ee){var J=A.split("");return ee&&B(J,ee,{hiLevel:L}),J.reverse(),Y&&Y.reverse(),J.join("")},B=function(A,Y,ee){var J,H,V,K,j,te=-1,ce=A.length,R=0,O=[],U=L?g:p,Q=[];for(k=!1,i=!1,a=!1,H=0;H<ce;H++)Q[H]=M(A[H]);for(V=0;V<ce;V++){if(j=R,O[V]=F(A,Q,O,V),J=240&(R=U[j][C[O[V]]]),R&=15,Y[V]=K=U[R][5],J>0)if(J===16){for(H=te;H<V;H++)Y[H]=1;te=-1}else te=-1;if(U[R][6])te===-1&&(te=V);else if(te>-1){for(H=te;H<V;H++)Y[H]=K;te=-1}Q[V]==="B"&&(Y[V]=0),ee.hiLevel|=K}a&&(function(q,$,de){for(var ae=0;ae<de;ae++)if(q[ae]==="S"){$[ae]=L;for(var _e=ae-1;_e>=0&&q[_e]==="WS";_e--)$[_e]=L}})(Q,Y,ce)},I=function(A,Y,ee,J,H){if(!(H.hiLevel<A)){if(A===1&&L===1&&!i)return Y.reverse(),void(ee&&ee.reverse());for(var V,K,j,te,ce=Y.length,R=0;R<ce;){if(J[R]>=A){for(j=R+1;j<ce&&J[j]>=A;)j++;for(te=R,K=j-1;te<K;te++,K--)V=Y[te],Y[te]=Y[K],Y[K]=V,ee&&(V=ee[te],ee[te]=ee[K],ee[K]=V);R=j}R++}}},E=function(A,Y,ee){var J=A.split(""),H={hiLevel:L};return ee||(ee=[]),B(J,ee,H),(function(V,K,j){if(j.hiLevel!==0&&m)for(var te,ce=0;ce<V.length;ce++)K[ce]===1&&(te=S.indexOf(V[ce]))>=0&&(V[ce]=S[te+1])})(J,ee,H),I(2,J,Y,ee,H),I(1,J,Y,ee,H),J.join("")};return this.__bidiEngine__.doBidiReorder=function(A,Y,ee){if((function(H,V){if(V)for(var K=0;K<H.length;K++)V[K]=K;c===void 0&&(c=P(H)),h===void 0&&(h=P(H))})(A,Y),o||!u||h)if(o&&u&&c^h)L=c?1:0,A=G(A,Y,ee);else if(!o&&u&&h)L=c?1:0,A=E(A,Y,ee),A=G(A,Y);else if(!o||c||u||h){if(o&&!u&&c^h)A=G(A,Y),c?(L=0,A=E(A,Y,ee)):(L=1,A=E(A,Y,ee),A=G(A,Y));else if(o&&c&&!u&&h)L=1,A=E(A,Y,ee),A=G(A,Y);else if(!o&&!u&&c^h){var J=m;c?(L=1,A=E(A,Y,ee),L=0,m=!1,A=E(A,Y,ee),m=J):(L=0,A=E(A,Y,ee),A=G(A,Y),L=1,m=!1,A=E(A,Y,ee),m=J,A=G(A,Y))}}else L=0,A=E(A,Y,ee);else L=c?1:0,A=E(A,Y,ee);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,u=A.isOutputVisual,c=A.isInputRtl,h=A.isOutputRtl,m=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var a=r.options||{};r.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var c=0;for(o=[],c=0;c<i.length;c+=1)Object.prototype.toString.call(i[c])==="[object Array]"?o.push([n.doBidiReorder(i[c][0]),i[c][1],i[c][2]]):o.push([n.doBidiReorder(i[c])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])})(nn),nn.API.TTFFont=(function(){function t(e){var n;if(this.rawData=e,n=this.contents=new Hu(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new $H(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new wH(this.contents),this.head=new PH(this),this.name=new GH(this),this.cmap=new RO(this),this.toUnicode={},this.hhea=new AH(this),this.maxp=new WH(this),this.hmtx=new FH(this),this.post=new UH(this),this.os2=new kH(this),this.loca=new VH(this),this.glyf=new KH(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,u,h;for(h=[],o=0,c=(u=this.bbox).length;o<c;o++)e=u[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,a,o,c;for(o=0,a=0,c=(e=""+e).length;0<=c?a<c:a>c;a=0<=c?++a:--a)i=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t})();var nc,Hu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,a,o,c,u;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^c)+(255^u)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*a+65536*o+256*c+u},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,a;for(a=[],r=0,i=e.length;r<i;r++)n=e[r],a.push(this.writeByte(n));return a},t})(),wH=(function(){var t;function e(n){var r,i,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,a,o,c,u,h,m,_,p,g,C,y;for(y in g=Object.keys(n).length,u=Math.log(2),_=16*Math.floor(Math.log(g)/u),o=Math.floor(_/u),m=16*g-_,(i=new Hu).writeInt(this.scalarType),i.writeShort(g),i.writeShort(_),i.writeShort(o),i.writeShort(m),a=16*g,h=i.pos+a,c=null,C=[],n)for(p=n[y],i.writeString(y),i.writeInt(t(p)),i.writeInt(h),i.writeInt(p.length),C=C.concat(p),y==="head"&&(c=h),h+=p.length;h%4;)C.push(0),h++;return i.write(C),r=2981146554-t(i.data),i.pos=c+8,i.writeUInt32(r),i.data},t=function(n){var r,i,a,o;for(n=TO.call(n);n.length%4;)n.push(0);for(a=new Hu(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=a.readUInt32();return 4294967295&i},e})(),LH={}.hasOwnProperty,Uc=function(t,e){for(var n in e)LH.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};nc=(function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var PH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new Hu).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t})(),PT=(function(){function t(e,n){var r,i,a,o,c,u,h,m,_,p,g,C,y,S,v,k,L;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),_=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(g=e.readUInt16(),p=g/2,e.pos+=6,a=(function(){var M,P;for(P=[],u=M=0;0<=p?M<p:M>p;u=0<=p?++M:--M)P.push(e.readUInt16());return P})(),e.pos+=2,y=(function(){var M,P;for(P=[],u=M=0;0<=p?M<p:M>p;u=0<=p?++M:--M)P.push(e.readUInt16());return P})(),h=(function(){var M,P;for(P=[],u=M=0;0<=p?M<p:M>p;u=0<=p?++M:--M)P.push(e.readUInt16());return P})(),m=(function(){var M,P;for(P=[],u=M=0;0<=p?M<p:M>p;u=0<=p?++M:--M)P.push(e.readUInt16());return P})(),i=(this.length-e.pos+this.offset)/2,c=(function(){var M,P;for(P=[],u=M=0;0<=i?M<i:M>i;u=0<=i?++M:--M)P.push(e.readUInt16());return P})(),u=v=0,L=a.length;v<L;u=++v)for(S=a[u],r=k=C=y[u];C<=S?k<=S:k>=S;r=C<=S?++k:--k)m[u]===0?o=r+h[u]:(o=c[m[u]/2+(r-C)-(p-u)]||0)!==0&&(o+=h[u]),this.codeMap[r]=65535&o}e.pos=_}return t.encode=function(e,n){var r,i,a,o,c,u,h,m,_,p,g,C,y,S,v,k,L,M,P,F,G,B,I,E,A,Y,ee,J,H,V,K,j,te,ce,R,O,U,Q,q,$,de,ae,_e,ie,Ne,X;switch(J=new Hu,o=Object.keys(e).sort(function(xe,fe){return xe-fe}),n){case"macroman":for(y=0,S=(function(){var xe=[];for(C=0;C<256;++C)xe.push(0);return xe})(),k={0:0},a={},H=0,te=o.length;H<te;H++)k[_e=e[i=o[H]]]==null&&(k[_e]=++y),a[i]={old:e[i],new:k[e[i]]},S[i]=k[e[i]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(S),{charMap:a,subtable:J.data,maxGlyphID:y+1};case"unicode":for(Y=[],_=[],L=0,k={},r={},v=h=null,V=0,ce=o.length;V<ce;V++)k[P=e[i=o[V]]]==null&&(k[P]=++L),r[i]={old:P,new:k[P]},c=k[P]-i,v!=null&&c===h||(v&&_.push(v),Y.push(i),h=c),v=i;for(v&&_.push(v),_.push(65535),Y.push(65535),E=2*(I=Y.length),B=2*Math.pow(Math.log(I)/Math.LN2,2),p=Math.log(B/2)/Math.LN2,G=2*I-B,u=[],F=[],g=[],C=K=0,R=Y.length;K<R;C=++K){if(A=Y[C],m=_[C],A===65535){u.push(0),F.push(0);break}if(A-(ee=r[A].new)>=32768)for(u.push(0),F.push(2*(g.length+I-C)),i=j=A;A<=m?j<=m:j>=m;i=A<=m?++j:--j)g.push(r[i].new);else u.push(ee-A),F.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*I+2*g.length),J.writeUInt16(0),J.writeUInt16(E),J.writeUInt16(B),J.writeUInt16(p),J.writeUInt16(G),de=0,O=_.length;de<O;de++)i=_[de],J.writeUInt16(i);for(J.writeUInt16(0),ae=0,U=Y.length;ae<U;ae++)i=Y[ae],J.writeUInt16(i);for(ie=0,Q=u.length;ie<Q;ie++)c=u[ie],J.writeUInt16(c);for(Ne=0,q=F.length;Ne<q;Ne++)M=F[Ne],J.writeUInt16(M);for(X=0,$=g.length;X<$;X++)y=g[X],J.writeUInt16(y);return{charMap:r,subtable:J.data,maxGlyphID:L+1}}},t})(),RO=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new PT(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,i;return n==null&&(n="macroman"),r=PT.encode(e,n),(i=new Hu).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t})(),AH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),kH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r})(),this.charRange=(function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),UH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(r=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,c,u;for(u=[],a=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;a=0<=c?++o:--o)u.push(e.readUInt32());return u}).call(this)}},t})(),BH=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},GH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,i,a,o,c,u,h,m,_,p;for(e.pos=this.offset,e.readShort(),n=e.readShort(),c=e.readShort(),r=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(u={},a=m=0,_=r.length;m<_;a=++m)i=r[a],e.pos=i.offset,h=e.readString(i.length),o=new BH(h,i),u[p=i.nameID]==null&&(u[p]=[]),u[i.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),WH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),FH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,i,a,o,c,u;for(e.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,m;for(m=[],n=h=0;0<=i?h<i:h>i;n=0<=i?++h:--h)m.push(e.readInt16());return m})(),this.widths=(function(){var h,m,_,p;for(p=[],h=0,m=(_=this.metrics).length;h<m;h++)a=_[h],p.push(a.advance);return p}).call(this),r=this.widths[this.widths.length-1],u=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)u.push(this.widths.push(r));return u},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),TO=[].slice,KH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,i,a,o,c,u,h,m,_;return e in this.cache?this.cache[e]:(a=this.file.loca,n=this.file.contents,r=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(c=new Hu(n.read(i))).readShort(),h=c.readShort(),_=c.readShort(),u=c.readShort(),m=c.readShort(),this.cache[e]=o===-1?new YH(c,h,_,u,m):new QH(c,o,h,_,u,m),this.cache[e]))},t.prototype.encode=function(e,n,r){var i,a,o,c,u;for(o=[],a=[],c=0,u=n.length;c<u;c++)i=e[n[c]],a.push(o.length),i&&(o=o.concat(i.encode(r)));return a.push(o.length),{table:o,offsets:a}},t})(),QH=(function(){function t(e,n,r,i,a,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),YH=(function(){function t(e,n,r,i,a){var o,c;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new Hu(TO.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t})(),VH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Uc(t,nc),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,a;for(a=[],r=0,i=this.length;r<i;r+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],r=0,i=this.length;r<i;r+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),i=0,a=0,o=0;o<r.length;++o)if(r[o]=i,a<n.length&&n[a]==o){++a,r[o]=i;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(i+=u)}for(var h=new Array(4*r.length),m=0;m<r.length;++m)h[4*m+3]=255&r[m],h[4*m+2]=(65280&r[m])>>8,h[4*m+1]=(16711680&r[m])>>16,h[4*m]=(4278190080&r[m])>>24;return h},t})(),$H=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,a;for(n in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)r=a[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,a,o,c,u;for(i={},o=0,c=e.length;o<c;o++)i[a=e[o]]=this.font.glyf.glyphFor(a);for(a in n=[],i)(r=i[a])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(a in u=this.glyphsFor(n))r=u[a],i[a]=r;return i},t.prototype.encode=function(e,n){var r,i,a,o,c,u,h,m,_,p,g,C,y,S,v;for(i in r=RO.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),g={0:0},v=r.charMap)g[(u=v[i]).old]=u.new;for(C in p=r.maxGlyphID,o)C in g||(g[C]=p++);return m=(function(k){var L,M;for(L in M={},k)M[k[L]]=L;return M})(g),_=Object.keys(m).sort(function(k,L){return k-L}),y=(function(){var k,L,M;for(M=[],k=0,L=_.length;k<L;k++)c=_[k],M.push(m[c]);return M})(),a=this.font.glyf.encode(o,y,g),h=this.font.loca.encode(a.offsets,y),S={cmap:this.font.cmap.raw(),glyf:a.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},t})();nn.API.PDFObject=(function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,a,o;if(Array.isArray(n))return"["+(function(){var c,u,h;for(h=[],c=0,u=n.length;c<u;c++)r=n[c],h.push(e.convert(r));return h})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in a=["<<"],n)o=n[i],a.push("/"+i+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+n},e})();async function zH(t){const e=new nn("p","mm","a4"),n=210,r=20,i=n-r*2,a=(y,S=12,v="normal",k="#000000",L=i*3)=>{const M=document.createElement("canvas"),P=M.getContext("2d"),F=3,G=`${v} ${S*F}px "Malgun Gothic", " ", sans-serif`;P.font=G;const B=P.measureText(y);return M.width=Math.min(Math.ceil(B.width)+10,L*F),M.height=Math.ceil(S*F*1.5),P.fillStyle="#ffffff",P.fillRect(0,0,M.width,M.height),P.font=G,P.fillStyle=k,P.textBaseline="middle",P.fillText(y,2,M.height/2),M.toDataURL("image/png")},o=(y,S,v)=>{const k=a(y,10,"bold","#555555"),L=a(S||"-",10,"normal","#000000"),M=6;return e.addImage(k,"PNG",r,v,35,M-1),e.addImage(L,"PNG",r+38,v,i-40,M-1),e.setDrawColor(220,220,220),e.line(r,v+M,r+i,v+M),v+M+1};let c=r;const u=a("   ",16,"bold","#1a1a1a");e.addImage(u,"PNG",r,c,i,8),c+=12,e.setDrawColor(0,0,0),e.setLineWidth(.5),e.line(r,c,r+i,c),c+=6;const h=a(" ",12,"bold","#2563eb");e.addImage(h,"PNG",r,c,40,5),c+=8,c=o("ID",t.custId,c),c=o("",t.custNm,c),c=o("ID",t.pymAcntId,c),c+=4;const m=a(" ",12,"bold","#2563eb");e.addImage(m,"PNG",r,c,40,5),c+=8,c=o("",t.pymMthNm,c),c=o("",t.changeReasonNm,c),c=o("",t.acntHolderNm,c),c=o("",t.idTypeNm,c),c=o("",t.birthDt,c),c=o("",t.bankNm,c),c=o("",HH(t.acntNo),c),c=o("",t.pyrRelNm,c),c+=4;const _=a(" ",12,"bold","#2563eb");if(e.addImage(_,"PNG",r,c,40,5),c+=8,t.signatureData){e.setDrawColor(180,180,180),e.setLineWidth(.3),e.rect(r,c,60,25);try{e.addImage(t.signatureData,"PNG",r+2,c+2,56,21)}catch(y){console.warn("Signature image insert failed:",y)}c+=28}else c=o("","( )",c);c+=6,e.setDrawColor(0,0,0),e.setLineWidth(.3),e.line(r,c,r+i,c),c+=4;const p=t.createdAt||new Date().toLocaleString("ko-KR"),g=a(`: ${p}`,8,"normal","#999999");e.addImage(g,"PNG",r,c,i,3),c+=5;const C=a("  D'Live     .",8,"normal","#999999");return e.addImage(C,"PNG",r,c,i,3),e.output("blob")}function HH(t){if(!t||t.length<6)return t;const e=t.slice(0,3),n=t.slice(-3),r="*".repeat(t.length-6);return e+r+n}function qH(t,e){const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(n)},100)}const XH=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},AT={pymMthCd:"01",changeReasonL:"",acntHolderNm:"",idType:"01",idNumber:"",bankCd:"",acntNo:"",cardExpMm:"",cardExpYy:"",joinCardYn:"N",pyrRel:"01",pymDay:""},JH=({isOpen:t,onClose:e,custId:n,custNm:r,custTpCd:i,soId:a,initialPymAcntId:o,showToast:c,onSuccess:u})=>{const[h,m]=b.useState([]),[_,p]=b.useState(o||""),[g,C]=b.useState(!1),[y,S]=b.useState({...AT}),[v,k]=b.useState(!1),[L,M]=b.useState(!1),[P,F]=b.useState(""),[G,B]=b.useState(!1),[I,E]=b.useState(!1),[A,Y]=b.useState(""),[ee,J]=b.useState({show:!1,title:"",message:"",type:"info"}),H=[{CODE:"003",CODE_NM:"IBK"},{CODE:"004",CODE_NM:"KB"},{CODE:"011",CODE_NM:"NH"},{CODE:"020",CODE_NM:""},{CODE:"023",CODE_NM:"SC"},{CODE:"031",CODE_NM:""},{CODE:"032",CODE_NM:""},{CODE:"039",CODE_NM:""},{CODE:"045",CODE_NM:""},{CODE:"048",CODE_NM:""},{CODE:"071",CODE_NM:""},{CODE:"081",CODE_NM:""},{CODE:"088",CODE_NM:""},{CODE:"089",CODE_NM:"K"},{CODE:"090",CODE_NM:""},{CODE:"092",CODE_NM:""}],V=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:"KB"},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""},{CODE:"06",CODE_NM:""},{CODE:"07",CODE_NM:""},{CODE:"08",CODE_NM:"BC"},{CODE:"09",CODE_NM:"NH"}],K=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""}],j=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""}],te=[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""}];b.useEffect(()=>{t&&n&&ce()},[t,n]),b.useEffect(()=>{t&&(S({...AT}),k(!1),Y(""),o&&p(o))},[t,o]),b.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]);const ce=async()=>{C(!0);try{const Ne=await hS(n);Ne.success&&Ne.data&&(m(Ne.data),Ne.data.length>0&&!_&&p(Ne.data[0].PYM_ACNT_ID))}catch(Ne){console.error("Load payment accounts error:",Ne)}finally{C(!1)}},R=(Ne,X="info")=>{J({show:!0,title:X==="success"?"":X==="error"?"":X==="warning"?"":"",message:Ne,type:X})},O=async()=>{if(!y.acntHolderNm){R("/  .","warning");return}if(!y.bankCd){R("/ .","warning");return}if(!y.acntNo){R("/ .","warning");return}if(!y.idNumber){const X=y.idType==="01"?"":y.idType==="02"?"":"";R(`${X} .`,"warning");return}if(y.pymMthCd==="02"&&(!y.cardExpMm||!y.cardExpYy)){R("  .","warning");return}M(!0),F("  ...");const Ne=async()=>{if(y.pymMthCd==="01"){const X=await xV({BANK_CD:y.bankCd,ACNT_NO:y.acntNo,ACNT_OWNER_NM:y.acntHolderNm,RSDT_CRRNO:y.idNumber,SO_ID:a||"",CUST_TP:i||"A",ID_TYPE_CD:y.idType,CUST_ID:n,PYM_ACNT_ID:_||o||""});return{success:X.success,message:X.message||""}}else{const X=await pV({CARD_NO:y.acntNo,CARD_EXPYEAR:y.cardExpYy,CARD_EXPMON:y.cardExpMm,CARD_OWNER_NM:y.acntHolderNm,KOR_ID:y.birthDt,SO_ID:a||"",PYM_ACNT_ID:o||"",CUST_ID:n,CUST_NM:r||""});return{success:X.success,message:X.message||""}}};try{if(F("  ..."),(await Ne()).success)k(!0),F(""),R(y.pymMthCd==="01"?"  .":"  .","success");else{F(" ...  ."),await new Promise(fe=>setTimeout(fe,5e3));const xe=await Ne();xe.success?(k(!0),F(""),R(y.pymMthCd==="01"?"  .":"  .","success")):(F(""),R(` .
   .

`+(xe.message||""),"error"))}}catch(X){console.error("Verify error:",X),F(""),R(`   .
   .`,"error")}finally{M(!1),F("")}},U=()=>{if(!_){R(" .","warning");return}if(!v){R("   .","warning");return}if(!y.changeReasonL){R(" .","warning");return}E(!0)},Q=Ne=>{E(!1),Y(Ne)},q=()=>{Y("")},$=(Ne,X)=>{var xe;return((xe=Ne.find(fe=>fe.CODE===X))==null?void 0:xe.CODE_NM)||X},de=()=>$(K,y.changeReasonL),ae=async()=>{try{const Ne=await zH({custId:n,custNm:r||"",pymAcntId:_,pymMthNm:"()",changeReasonNm:de(),acntHolderNm:y.acntHolderNm,idTypeNm:$(j,y.idType),birthDt:y.idNumber,bankNm:$(H,y.bankCd),acntNo:y.acntNo,pyrRelNm:$(te,y.pyrRel),signatureData:A}),X=new Date().toISOString().slice(0,10).replace(/-/g,""),xe=`__${n}_${X}.pdf`;qH(Ne,xe),c==null||c("PDF  ","success")}catch(Ne){console.error("PDF generation error:",Ne),R("PDF  .","error")}},_e=async()=>{if(y.pymMthCd==="01"&&!A){R("  .","warning");return}B(!0);try{const Ne=await L4({CUST_ID:n,PYM_ACNT_ID:_,PYM_MTH_CD:y.pymMthCd,BANK_CD:y.bankCd,ACNT_NO:y.acntNo,ACNT_OWNER_NM:y.acntHolderNm,ID_TYPE_CD:y.idType,BIRTH_DT:y.idNumber,PAYER_REL_CD:y.pyrRel,PAY_DAY_CD:y.pymDay,CARD_VALID_YM:y.pymMthCd==="02"?y.cardExpYy+y.cardExpMm:void 0,JOIN_CARD_YN:y.pymMthCd==="02"?y.joinCardYn:void 0,CHG_RESN_L_CD:y.changeReasonL});if(Ne.success){try{await yV({CUST_ID:n,PYM_ACNT_ID:_,SIGN_TYPE:"PYM_CHG",SIGNATURE_DATA:A})}catch(X){console.log("[PaymentChange] Signature save stub (API not connected yet):",X)}if(y.pymMthCd==="01"&&A)try{await ae()}catch(X){console.warn("[PaymentChange] PDF auto-download failed:",X)}c==null||c(" .","success"),u==null||u(),e()}else R(Ne.message||"  .","error")}catch(Ne){console.error("Save payment error:",Ne),R("    .","error")}finally{B(!1)}},ie=h.find(Ne=>Ne.PYM_ACNT_ID===_);return t?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:[L&&P&&s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[85vw] max-w-[280px] p-6 flex flex-col items-center",children:[s.jsx(On,{className:"w-10 h-10 text-blue-500 animate-spin mb-4"}),s.jsx("p",{className:"text-sm text-gray-700 text-center font-medium",children:P})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4 max-h-[90vh] flex flex-col",onClick:Ne=>Ne.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-orange-500 to-orange-600 rounded-t-xl",children:[s.jsxs("div",{className:"flex items-center gap-2 text-white",children:[s.jsx(Lp,{className:"w-5 h-5"}),s.jsx("h3",{className:"font-semibold",children:" "})]}),s.jsx("button",{onClick:e,className:"text-white/80 hover:text-white transition-colors",disabled:G,children:s.jsx(Mi,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-0",children:g?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(On,{className:"w-6 h-6 text-orange-500 animate-spin"})}):ie?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 border border-orange-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-mono text-sm text-blue-600",children:XH(ie.PYM_ACNT_ID)}),s.jsx("span",{className:"text-xs text-gray-500",children:ie.PYM_MTHD_NM||"-"})]}),s.jsxs("div",{className:"text-sm text-gray-700",children:[ie.BANK_CARD_NM||"-"," ",ie.BANK_CARD_NO||""]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("select",{value:y.pymMthCd,onChange:Ne=>{S(X=>({...X,pymMthCd:Ne.target.value,bankCd:"",acntNo:""})),k(!1)},className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"01",children:"()"}),s.jsx("option",{value:"02",children:""})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("select",{value:y.changeReasonL,onChange:Ne=>S(X=>({...X,changeReasonL:Ne.target.value})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"",children:""}),K.map(Ne=>s.jsx("option",{value:Ne.CODE,children:Ne.CODE_NM},Ne.CODE))]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:y.pymMthCd==="01"?"":""}),s.jsx("input",{type:"text",value:y.acntHolderNm,onChange:Ne=>{S(X=>({...X,acntHolderNm:Ne.target.value})),k(!1)},placeholder:" ",className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsx("select",{value:y.idType,onChange:Ne=>{S(X=>({...X,idType:Ne.target.value,idNumber:""})),k(!1)},className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:j.map(Ne=>s.jsx("option",{value:Ne.CODE,children:Ne.CODE_NM},Ne.CODE))})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:y.idType==="01"?"":y.idType==="02"?"":""}),s.jsx("input",{type:"text",value:y.idNumber,onChange:Ne=>{S(X=>({...X,idNumber:Ne.target.value.replace(/[^0-9]/g,"").slice(0,y.idType==="02"?10:13)})),k(!1)},placeholder:y.idType==="01"?" 13 (- )":y.idType==="02"?" 10 (- )":" 13 (- )",maxLength:y.idType==="02"?10:13,className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:y.pymMthCd==="01"?"":""}),s.jsxs("select",{value:y.bankCd,onChange:Ne=>{S(X=>({...X,bankCd:Ne.target.value})),k(!1)},className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"",children:""}),(y.pymMthCd==="01"?H:V).map(Ne=>s.jsx("option",{value:Ne.CODE,children:Ne.CODE_NM},Ne.CODE))]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:y.pymMthCd==="01"?"":""}),s.jsxs("div",{className:"flex-1 flex gap-2",children:[s.jsx("input",{type:"text",value:y.acntNo,onChange:Ne=>{S(X=>({...X,acntNo:Ne.target.value.replace(/[^0-9]/g,"")})),k(!1)},placeholder:y.pymMthCd==="01"?" (- )":" (- )",className:"flex-1 min-w-0 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"}),s.jsx("button",{onClick:O,disabled:L||v,className:`flex-shrink-0 px-3 py-1.5 text-sm rounded font-medium transition-colors whitespace-nowrap ${v?"bg-green-100 text-green-700 border border-green-300":"bg-blue-500 text-white hover:bg-blue-600"}`,children:L?"":v?"":""})]})]}),y.pymMthCd==="02"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"text",value:y.cardExpMm,onChange:Ne=>{S(X=>({...X,cardExpMm:Ne.target.value.replace(/[^0-9]/g,"").slice(0,2)})),k(!1)},placeholder:"MM",maxLength:2,className:"w-14 px-2 py-1.5 text-sm border border-gray-300 rounded text-center focus:ring-1 focus:ring-orange-500"}),s.jsx("span",{className:"text-gray-400",children:"/"}),s.jsx("input",{type:"text",value:y.cardExpYy,onChange:Ne=>{S(X=>({...X,cardExpYy:Ne.target.value.replace(/[^0-9]/g,"").slice(0,2)})),k(!1)},placeholder:"YY",maxLength:2,className:"w-14 px-2 py-1.5 text-sm border border-gray-300 rounded text-center focus:ring-1 focus:ring-orange-500"})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsxs("select",{value:y.joinCardYn,onChange:Ne=>S(X=>({...X,joinCardYn:Ne.target.value})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:[s.jsx("option",{value:"N",children:""}),s.jsx("option",{value:"Y",children:""})]})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{className:"w-20 flex-shrink-0 text-xs text-gray-500",children:""}),s.jsx("select",{value:y.pyrRel,onChange:Ne=>S(X=>({...X,pyrRel:Ne.target.value})),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500",children:te.map(Ne=>s.jsx("option",{value:Ne.CODE,children:Ne.CODE_NM},Ne.CODE))})]})]}),y.pymMthCd==="01"&&s.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700",children:" "}),s.jsx("div",{className:"flex items-center gap-2",children:A&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:ae,className:"text-xs text-blue-500 hover:text-blue-600 flex items-center gap-0.5",children:[s.jsx(vL,{className:"w-3 h-3"}),"PDF"]}),s.jsx("button",{onClick:q,className:"text-xs text-red-500 hover:text-red-600",children:" "})]})})]}),A?s.jsxs("div",{className:"border border-green-300 rounded-lg bg-green-50 p-2 flex flex-col items-center",children:[s.jsx("img",{src:A,alt:"",className:"max-h-24 rounded border border-gray-200 bg-white"}),s.jsxs("div",{className:"flex items-center gap-1 mt-1.5",children:[s.jsx(jc,{className:"w-3.5 h-3.5 text-green-600"}),s.jsx("span",{className:"text-xs text-green-600 font-medium",children:" "})]})]}):s.jsxs("button",{onClick:U,disabled:!v,className:`w-full py-4 border-2 border-dashed rounded-lg flex flex-col items-center gap-1.5 transition-colors ${v?"border-blue-300 bg-blue-50 hover:bg-blue-100 text-blue-600 cursor-pointer":"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[s.jsx(XL,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:v?"  ":"    "})]})]}),s.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vr,{className:"w-4 h-4 text-orange-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-orange-700",children:[s.jsx("p",{children:"     ."}),s.jsx("p",{className:"text-xs mt-1",children:"      ."})]})]})})]}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Lp,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{children:"  ."})]})}),ie&&s.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:_e,disabled:G||!v||y.pymMthCd==="01"&&!A,className:`flex-1 py-2.5 rounded-lg transition-colors text-sm font-medium flex items-center justify-center gap-2 ${v&&(y.pymMthCd==="02"||A)?"bg-orange-500 text-white hover:bg-orange-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:G?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-4 h-4 animate-spin"})," ..."]}):""}),s.jsx("button",{onClick:e,disabled:G,className:"flex-1 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:""})]})})]}),I&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsx(k4,{title:"  ",onSave:Q,onCancel:()=>E(!1)})})}),ee.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70]",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${ee.type==="success"?"bg-green-100":ee.type==="error"?"bg-red-100":ee.type==="warning"?"bg-orange-100":"bg-blue-100"}`,children:ee.type==="success"?s.jsx(jc,{className:"w-5 h-5 text-green-500"}):s.jsx(Vr,{className:`w-5 h-5 ${ee.type==="error"?"text-red-500":ee.type==="warning"?"text-orange-500":"text-blue-500"}`})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:ee.title})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-5 whitespace-pre-line",children:ee.message}),s.jsx("button",{onClick:()=>J({show:!1,title:"",message:"",type:"info"}),className:`w-full px-4 py-2 text-sm text-white rounded-lg transition-colors ${ee.type==="success"?"bg-green-500 hover:bg-green-600":ee.type==="error"?"bg-red-500 hover:bg-red-600":ee.type==="warning"?"bg-orange-500 hover:bg-orange-600":"bg-blue-500 hover:bg-blue-600"}`,children:""})]})})]}):null},op=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},ZH=t=>!t||t.length<6?t||"-":`${t.slice(0,4)}-${t.slice(4,6)}`,eq=({custId:t,custNm:e,custTpCd:n,expanded:r,onToggle:i,showToast:a,onNavigateToPaymentChange:o,paymentChangeInProgress:c,onCancelPaymentChange:u,currentWorkingPymAcntId:h,selectedPymAcntIdFromContract:m,contracts:_=[]})=>{const[p,g]=b.useState([]),[C,y]=b.useState([]),[S,v]=b.useState(!1),[k,L]=b.useState(!1),[M,P]=b.useState(null),[F,G]=b.useState(!0),[B,I]=b.useState(!1),[E,A]=b.useState([]),[Y,ee]=b.useState(!1),[J,H]=b.useState(!1),[V,K]=b.useState(""),[j,te]=b.useState(!1),[ce,R]=b.useState(null);b.useEffect(()=>{r&&t&&O()},[r,t]),b.useEffect(()=>{m&&m!==M&&P(m)},[m]),b.useEffect(()=>{M&&t&&(U(M),R(CR(M)))},[M,t]);const O=async()=>{v(!0);try{const ae=await hS(t);ae.success&&ae.data&&(g(ae.data),ae.data.length>0&&(m&&ae.data.some(_e=>_e.PYM_ACNT_ID===m)?P(m):P(ae.data[0].PYM_ACNT_ID)))}catch(ae){console.error("Load payment accounts error:",ae)}finally{v(!1)}},U=async ae=>{L(!0);try{const _e=await yR(t,ae);_e.success&&_e.data?y(_e.data):y([])}catch(_e){console.error("Load billing details error:",_e),y([])}finally{L(!1)}},Q=ae=>{P(ae)},q=()=>{u&&u(),o&&V&&o(V),H(!1),K("")},$=p.find(ae=>ae.PYM_ACNT_ID===M),de=async()=>{if(!M){a==null||a(" .","warning");return}ee(!0);try{const ae=await yR(t,M);if(ae.success&&ae.data){const _e=ae.data.filter(ie=>ie.UPYM_AMT>0).map(ie=>({BILL_YM:ie.BILL_YYMM,CTRT_ID:"",PROD_NM:ie.BILL_CYCL||"",BILL_AMT:ie.BILL_AMT,UNPAY_AMT:ie.UPYM_AMT,UNPAY_DAYS:0,UNPAY_STAT_NM:"",BILL_SEQ_NO:ie.BILL_SEQ_NO||"",SO_ID:ie.SO_ID||""}));_e.length>0?(A(_e),I(!0)):a==null||a("  .","info")}else a==null||a("   .","error")}catch(ae){console.error("Load unpayment list error:",ae),a==null||a("     .","error")}finally{ee(!1)}};return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:i,className:"w-full px-3 py-2.5 flex items-center justify-between text-left",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"font-medium text-gray-800",children:" / "})}),r?s.jsx(kr,{className:"w-4 h-4 text-gray-400"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400"})]}),r&&s.jsx("div",{className:"px-3 pb-3",children:S?s.jsx("div",{className:"flex items-center justify-center py-6",children:s.jsx(On,{className:"w-5 h-5 animate-spin text-gray-400"})}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:" "}),s.jsxs("span",{className:"text-xs text-gray-500",children:[p.length,""]})]}),p.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-1 mb-3",children:p.map((ae,_e)=>{const ie=h===ae.PYM_ACNT_ID,Ne=M===ae.PYM_ACNT_ID;return s.jsx("div",{onClick:()=>Q(ae.PYM_ACNT_ID),className:`p-2 rounded-lg border cursor-pointer transition-all ${ie?"bg-orange-50 border-orange-300":Ne?"bg-blue-50 border-blue-400":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-medium text-gray-700",children:[_e+1,"."]}),s.jsx("span",{className:"text-gray-800",children:op(ae.PYM_ACNT_ID)}),s.jsx("span",{className:"text-gray-400",children:"|"}),s.jsx("span",{className:"text-gray-600",children:ae.PYM_MTHD_NM||"-"}),ie&&s.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-orange-500 text-white rounded-full animate-pulse",children:""})]}),s.jsxs("span",{className:`font-medium ${ae.UPYM_AMT_ACNT>0?"text-red-600":"text-gray-600"}`,children:[qo(ae.UPYM_AMT_ACNT||0),""]})]})},ae.PYM_ACNT_ID)})}),$&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsx("span",{className:"text-gray-800",children:$.PYM_MTHD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:"/"}),s.jsx("span",{className:"text-gray-800",children:$.BANK_CARD_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:"/"}),s.jsx("span",{className:"text-gray-800",children:kV($.BANK_CARD_NO||"",4,4)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsx("span",{className:"text-gray-800",children:$.BILL_MTHD||"-"})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-blue-200",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:`font-bold ${$.UPYM_AMT_ACNT>0?"text-red-600":"text-gray-800"}`,children:[qo($.UPYM_AMT_ACNT||0),""]})]})]})})]}),p.some(ae=>ae.UPYM_AMT_ACNT>0)&&s.jsx("button",{onClick:de,disabled:Y||!M,className:`w-full mt-3 py-2.5 text-sm text-white rounded-lg disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2 ${ce?"bg-amber-500 hover:bg-amber-600 animate-pulse":"bg-red-500 hover:bg-red-600"}`,children:Y?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-4 h-4 animate-spin"})," ..."]}):ce?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"inline-block w-2 h-2 bg-white rounded-full"}),"   (",op(M||""),")"]}):`  (${op(M||"")})`}),M&&s.jsx("button",{onClick:()=>te(!0),className:"w-full mt-2 py-2 text-sm text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors font-medium",children:" "})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[s.jsxs("button",{onClick:()=>G(!F),className:"w-full flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:""}),$&&s.jsx("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded",children:op($.PYM_ACNT_ID)})]}),s.jsx(ir,{className:`w-4 h-4 text-gray-400 transition-transform ${F?"rotate-180":""}`})]}),F&&s.jsx(s.Fragment,{children:M?k?s.jsx("div",{className:"flex items-center justify-center py-4",children:s.jsx(On,{className:"w-4 h-4 animate-spin text-gray-400"})}):C.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:" 3      ."}):s.jsxs("div",{className:"space-y-2",children:[C.slice(0,10).map((ae,_e)=>s.jsxs("div",{className:`p-3 rounded-lg border ${ae.UPYM_AMT>0?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-200",children:[s.jsx("span",{className:"font-medium text-gray-800",children:ZH(ae.BILL_YYMM)}),s.jsx("span",{className:"text-xs text-gray-500",children:ae.BILL_CYCL||""})]}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:"text-gray-800",children:[qo(ae.BILL_AMT),""]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:"text-green-600",children:[qo(ae.RCPT_AMT),""]})]}),ae.UPYM_AMT>0&&s.jsxs("div",{className:"flex justify-between pt-1 border-t border-gray-200",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:""}),s.jsxs("span",{className:"text-red-600 font-bold",children:[qo(ae.UPYM_AMT),""]})]})]})]},_e)),C.length>10&&s.jsxs("div",{className:"text-center text-sm text-gray-500 py-2",children:["+",C.length-10,"  "]})]}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:" ."})})]})]})}),s.jsx(n$,{isOpen:B,onClose:()=>{I(!1),O(),M&&(U(M),R(CR(M)))},pendingPayment:ce,custId:t,custNm:e,pymAcntId:M||"",unpaymentList:E,showToast:a,onSuccess:()=>{O(),M&&U(M)},soId:(()=>{var ae,_e;if(M){const ie=p.find(Ne=>Ne.PYM_ACNT_ID===M);if(ie!=null&&ie.SO_ID)return ie.SO_ID}if(M&&_.length>0){const ie=_.filter(Ne=>Ne.PYM_ACNT_ID===M&&Ne.SO_ID);if(ie.length>0)return(ie.find(X=>X.CTRT_STAT_CD==="10")||ie[0]).SO_ID}try{const ie=JSON.parse(sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo")||"{}"),Ne=ie.authSoList||ie.AUTH_SO_List||[];return((ae=Ne[0])==null?void 0:ae.SO_ID)||((_e=Ne[0])==null?void 0:_e.soId)||ie.soId||ie.SO_ID||""}catch{return""}})()}),s.jsx(JH,{isOpen:j,onClose:()=>{te(!1),O(),M&&U(M)},custId:t,custNm:e,custTpCd:n,soId:(()=>{var ae,_e;if(M){const ie=p.find(Ne=>Ne.PYM_ACNT_ID===M);if(ie!=null&&ie.SO_ID)return ie.SO_ID}if(M&&_.length>0){const ie=_.filter(Ne=>Ne.PYM_ACNT_ID===M&&Ne.SO_ID);if(ie.length>0)return(ie.find(Ne=>Ne.CTRT_STAT_CD==="10")||ie[0]).SO_ID}try{const ie=JSON.parse(sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo")||"{}"),Ne=ie.authSoList||ie.AUTH_SO_List||[];return((ae=Ne[0])==null?void 0:ae.SO_ID)||((_e=Ne[0])==null?void 0:_e.soId)||ie.soId||ie.SO_ID||""}catch{return""}})(),initialPymAcntId:M||"",showToast:a,onSuccess:()=>{O()}}),J&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:s.jsx(Vr,{className:"w-5 h-5 text-orange-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:"  "})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-5",children:["     .",s.jsx("br",{}),"     ?"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{H(!1),K("")},className:"flex-1 px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:""}),s.jsx("button",{onClick:q,className:"flex-1 px-4 py-2 text-sm text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-colors",children:" "})]})]})})]})},MC=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},tq=({onBack:t,showToast:e,onContractSelect:n,onNavigateToPaymentChange:r,onNavigateToConsultationAS:i,onNavigateToAddressChange:a,onNavigateToReContract:o,selectedCustomer:c,savedContract:u,cachedContracts:h=[],cachedConsultationHistory:m=[],cachedWorkHistory:_=[],cachedDataCustId:p="",onDataLoaded:g,paymentChangeInProgress:C,onCancelPaymentChange:y,currentWorkingPymAcntId:S})=>{const[v,k]=b.useState([]),[L,M]=b.useState([]),[P,F]=b.useState([]),[G,B]=b.useState("byDate"),[I,E]=b.useState([]),[A,Y]=b.useState([]),[ee,J]=b.useState(""),[H,V]=b.useState(!1),[K,j]=b.useState(!1),[te,ce]=b.useState({customerInfo:!0,contracts:!0,payment:!1,consultation:!1,work:!1}),[R,O]=b.useState(new Set),[U,Q]=b.useState(new Set),q=re=>{O(me=>{const ve=new Set(me);return ve.has(re)?ve.delete(re):ve.add(re),ve})},$=re=>{Q(me=>{const ve=new Set(me);return ve.has(re)?ve.delete(re):ve.add(re),ve})},[de,ae]=b.useState(null);b.useEffect(()=>{c&&c.CUST_ID!==de?(ae(c.CUST_ID),J(""),p===c.CUST_ID&&(h.length>0||m.length>0||_.length>0)?(k(h),M(m),F(_),I.length===0&&A.length===0&&Z(c.CUST_ID)):le(c.CUST_ID)):!c&&de&&(ae(null),k([]),M([]),F([]))},[c,p]),b.useEffect(()=>{c&&u&&u.ctrtId&&u.ctrtId!==ie&&(Ne(u.ctrtId),fe(c.CUST_ID,u.ctrtId))},[c,u]),b.useEffect(()=>{if(c!=null&&c.EQT_SERNO&&v.length>0){const re=c.EQT_SERNO.toLowerCase(),me=v.find(ve=>{var et,Dt;return((et=ve.NOTRECEV)==null?void 0:et.toLowerCase().includes(re))||((Dt=ve.EQT_SERNO)==null?void 0:Dt.toLowerCase().includes(re))});J(me?me.CTRT_ID:"")}else J("")},[c==null?void 0:c.EQT_SERNO,v]);const _e=async re=>{V(!0);try{const me=await J1(re);return me.success&&me.data?(k(me.data),me.data):(k([]),[])}catch(me){return console.error("Load contracts error:",me),k([]),[]}finally{V(!1)}},[ie,Ne]=b.useState(""),[X,xe]=b.useState(""),fe=async(re,me)=>{j(!0);try{const[ve,et]=await Promise.all([m1(re,me,10),g1(re,me,10)]),Dt=ve.success&&ve.data?ve.data:[],ot=et.success&&et.data?et.data:[];return M(Dt),F(ot),{consultation:Dt,work:ot}}catch(ve){return console.error("Load history error:",ve),{consultation:[],work:[]}}finally{j(!1)}},Z=async re=>{j(!0);try{const[me,ve]=await Promise.all([m1(re,void 0,10),g1(re,void 0,10)]),et=me.success&&me.data?me.data:[],Dt=ve.success&&ve.data?ve.data:[];E(et),Y(Dt)}catch(me){console.error("Load all history error:",me)}finally{j(!1)}},le=async re=>{M([]),F([]),Ne("");const me=await _e(re);B("byDate"),await Z(re),g&&g(re,me,[],[])},se=re=>{ce(me=>({...me,[re]:!me[re]}))},Re=re=>{n({ctrtId:re.CTRT_ID,prodNm:re.PROD_NM,instAddr:re.INST_ADDR,streetAddr:re.STREET_ADDR_FULL,instlLoc:re.INSTL_LOC,postId:re.POST_ID,notrecev:re.NOTRECEV,soId:re.SO_ID,prodGrp:re.PROD_GRP}),Ne(re.CTRT_ID),B("byContract"),c&&fe(c.CUST_ID,re.CTRT_ID),re.PYM_ACNT_ID&&xe(re.PYM_ACNT_ID)},be=G==="byContract"?ie?L:[]:I,De=G==="byContract"?ie?P:[]:A;return s.jsx("div",{className:"h-full overflow-y-auto bg-gray-50",children:s.jsx("div",{className:"p-4 space-y-4",children:c?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>se("customerInfo"),className:"w-full px-3 py-2.5 flex items-center justify-between text-left",children:[s.jsx("span",{className:"font-medium text-gray-800",children:" "}),te.customerInfo?s.jsx(kr,{className:"w-4 h-4 text-gray-400"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400"})]}),te.customerInfo&&s.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"font-medium text-gray-800 text-right flex-1 break-all",children:MC(c.CUST_ID)})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"font-medium text-gray-800 text-right flex-1 break-all",children:c.CUST_NM})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1",children:M2(c.TEL_NO)||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1",children:M2(c.HP_NO)||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1",children:c.CUST_TP_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-500 flex-shrink-0 w-14",children:""}),s.jsx("span",{className:"text-gray-800 text-right flex-1 break-all",children:c.GRP_NM||"-"})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100 text-sm space-y-1",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("span",{className:"text-gray-500",children:""})}),s.jsx("div",{className:"text-gray-700 break-words",children:c.ROAD_ADDR||c.INST_ADDR||c.CUST_ADDR||"-"})]}),c.UNPAY_AMT>0&&s.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded border border-red-200",children:[s.jsx("span",{className:"text-red-700 text-sm",children:""}),s.jsxs("span",{className:"text-red-600 font-bold",children:[qo(c.UNPAY_AMT),""]})]})]})]}),s.jsx(XV,{contracts:v,isLoading:H,expanded:te.contracts,onToggle:()=>se("contracts"),onContractSelect:Re,showToast:e,initialSearchKeyword:ee||(c==null?void 0:c.CTRT_ID)||"",onNavigateToConsultation:re=>{Re(re),i&&i("consultation")},onNavigateToAS:re=>{Re(re),i&&i("as")},onNavigateToAddressChange:re=>{Re(re),a&&a()},onNavigateToReContract:re=>{Re(re),o&&o()}}),s.jsx(eq,{custId:c.CUST_ID,custNm:c.CUST_NM,custTpCd:c.CUST_TP_CD,expanded:te.payment,onToggle:()=>se("payment"),showToast:e,onNavigateToPaymentChange:r,paymentChangeInProgress:C,onCancelPaymentChange:y,currentWorkingPymAcntId:S,selectedPymAcntIdFromContract:X,contracts:v}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[s.jsxs("button",{onClick:()=>se("consultation"),className:"flex items-center gap-2 flex-1 text-left",children:[s.jsx("span",{className:"font-medium text-gray-800",children:""}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",be.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[s.jsx("button",{onClick:re=>{re.stopPropagation(),B("byDate"),c&&I.length===0&&A.length===0&&Z(c.CUST_ID)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${G==="byDate"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:re=>{re.stopPropagation(),B("byContract"),c&&ie&&fe(c.CUST_ID,ie)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${G==="byContract"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]}),s.jsx("button",{onClick:()=>se("consultation"),children:te.consultation?s.jsx(kr,{className:"w-4 h-4 text-gray-400"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400"})})]}),te.consultation&&s.jsx("div",{className:"px-3 pb-3",children:K?s.jsx("div",{className:"flex items-center justify-center py-3",children:s.jsx(On,{className:"w-4 h-4 animate-spin text-gray-400"})}):G==="byContract"&&!ie?s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:"   "}):be.length>0?s.jsx("div",{className:"space-y-3",children:be.map((re,me)=>{var ve;return s.jsxs("div",{className:"bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"p-3 cursor-pointer flex items-center justify-between",onClick:()=>q(me),children:[s.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs flex-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:re.CTRT_ID?MC(re.CTRT_ID):"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.START_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:re.CNSL_SLV_CL_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(ve=re.CNSL_RSLT)!=null&&ve.includes("")?"text-green-600":"text-yellow-600"}`,children:re.CNSL_RSLT||""})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.RCPT_NM||"-"})]})]}),R.has(me)?s.jsx(kr,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"})]}),R.has(me)&&s.jsxs("div",{className:"px-3 pb-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:re.REQ_CTX||"-"})]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:re.PROC_CT||"-"})]})]})]},me)})}):s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:" "})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[s.jsxs("button",{onClick:()=>se("work"),className:"flex items-center gap-2 flex-1 text-left",children:[s.jsx("span",{className:"font-medium text-gray-800",children:""}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",De.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[s.jsx("button",{onClick:re=>{re.stopPropagation(),B("byDate"),c&&I.length===0&&A.length===0&&Z(c.CUST_ID)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${G==="byDate"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:re=>{re.stopPropagation(),B("byContract"),c&&ie&&fe(c.CUST_ID,ie)},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${G==="byContract"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]}),s.jsx("button",{onClick:()=>se("work"),children:te.work?s.jsx(kr,{className:"w-4 h-4 text-gray-400"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400"})})]}),te.work&&s.jsx("div",{className:"px-3 pb-3",children:K?s.jsx("div",{className:"flex items-center justify-center py-3",children:s.jsx(On,{className:"w-4 h-4 animate-spin text-gray-400"})}):G==="byContract"&&!ie?s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:"   "}):De.length>0?s.jsx("div",{className:"space-y-3",children:De.map((re,me)=>{var ve,et;return s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:re.CTRT_ID?MC(re.CTRT_ID):"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.HOPE_DT||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.WRK_CD_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(ve=re.WRK_STAT_CD_NM)!=null&&ve.includes("")?"text-green-600":(et=re.WRK_STAT_CD_NM)!=null&&et.includes("")?"text-blue-600":"text-gray-800"}`,children:re.WRK_STAT_CD_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-center",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:re.PROD_NM||"-"})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.CMPL_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.WRK_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:re.WRK_CRR_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-start",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800",children:re.CTRT_ADDR||"-"})]}),s.jsxs("div",{className:"mt-3 cursor-pointer",onClick:()=>$(me),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"text-xs text-gray-500",children:""}),U.has(me)?s.jsx(kr,{className:"w-3.5 h-3.5 text-gray-400"}):s.jsx(ir,{className:"w-3.5 h-3.5 text-gray-400"})]}),U.has(me)&&s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:re.MEMO||"-"})]})]},me)})}):s.jsx("div",{className:"text-center py-3 text-gray-500 text-sm",children:" "})})]})]}):s.jsx("div",{className:"flex items-center justify-center h-48 text-gray-400 text-sm",children:"   ."})})})},sq=({onBack:t,showToast:e,selectedCustomer:n,selectedContract:r,initialSection:i="phone",initialPymAcntId:a="",onPaymentChangeStart:o,onPaymentChangeEnd:c,savedPaymentForm:u,savedPymAcntId:h="",savedIsVerified:m=!1,onPaymentFormChange:_,onAddressChanged:p})=>{var Ps;const[g,C]=b.useState({phone:!1,address:i==="address",payment:i==="payment",hpPay:i==="hpPay"}),[y,S]=b.useState({telNoType:"hp",telNo:"",telTpCd:"",disconnYn:"N"}),[v,k]=b.useState([]),[L,M]=b.useState("address"),[P,F]=b.useState({addr:"",instlLoc:""}),[G,B]=b.useState(!1),[I,E]=b.useState({zipCd:"",addr1:"",addr2:"",instlLoc:"",changeBillAddr:!1,postId:"",streetId:"",dongmyonNm:"",bldCl:"0",bldNm:"",bunNo:"",hoNm:""}),[A,Y]=b.useState(!1),[ee,J]=b.useState(!1),[H,V]=b.useState(!1),[K,j]=b.useState([]),[te,ce]=b.useState(!1),[R,O]=b.useState(!1),[U,Q]=b.useState([]),[q,$]=b.useState(h),[de,ae]=b.useState(!1),[_e,ie]=b.useState(!1),Ne={pymMthCd:"01",changeReasonL:"",changeReasonM:"",acntHolderNm:"",idType:"01",birthDt:"",bankCd:"",acntNo:"",cardExpMm:"",cardExpYy:"",joinCardYn:"N",pyrRel:"01",pymDay:""},[X,xe]=b.useState(u||Ne),[fe,Z]=b.useState(!1),[le,se]=b.useState(m),[Re,be]=b.useState(!1),[De,re]=b.useState(!1),[me,ve]=b.useState(null),[et,Dt]=b.useState(!1),[ot,At]=b.useState(""),[ct,Ge]=b.useState(TE),[at,xt]=b.useState({isOpen:!1,message:"",type:"info"}),mt=(rt,Wt="info")=>{xt({isOpen:!0,message:rt,type:Wt})},Ve=rt=>{console.log("[ ] :",rt),console.log("[ ]   :",X.acntHolderNm);const Wt={...Ne};xe(Wt),se(!1),$(rt),o==null||o(),Dt(!1),At(""),console.log("[ ]   ")},[it,Fe]=b.useState(!1),[nt,lt]=b.useState("post"),[Mt,ut]=b.useState(""),[qe,Ee]=b.useState({streetNm:"",streetBunM:"",streetBunS:""}),[Ye,pe]=b.useState([]),[ge,Be]=b.useState([]),[ue,we]=b.useState(!1),[Je,Pe]=b.useState(""),[Nt,Oe]=b.useState([]),[dt,gt]=b.useState([]),[It,$e]=b.useState([]),[$t,Ue]=b.useState({}),[ss,ls]=b.useState([]),[ds,vs]=b.useState([]),[Ss,ke]=b.useState([]);b.useEffect(()=>{st(),Ft()},[]),b.useEffect(()=>{n&&!_e&&qt()},[n]),b.useEffect(()=>{r&&(F({addr:r.streetAddr||r.instAddr||"",instlLoc:r.instlLoc||""}),B(U.length===1))},[r,U.length]),b.useEffect(()=>{_&&_(X,q,le)},[X,q,le]);const ft=rt=>rt.filter(Wt=>Wt.code&&Wt.code!=="[]"&&Wt.name!=="").map(Wt=>({CODE:Wt.code||Wt.CODE,CODE_NM:Wt.name||Wt.CODE_NM,ref_code:Wt.ref_code||""})),st=async()=>{Y(!0);try{const rt=await IV();rt.success&&rt.data&&k(ft(rt.data))}catch(rt){console.error("Load telecom codes error:",rt)}finally{Y(!1)}},Ft=async()=>{try{const[rt,Wt,bs,zt]=await Promise.all([jV(),OV(),wV(),LV()]);rt.success&&rt.data&&Oe(ft(rt.data)),Wt.success&&Wt.data&&gt(ft(Wt.data)),bs.success&&bs.data&&vs(ft(bs.data)),zt.success&&zt.data&&ls(ft(zt.data)),$e([{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""}]),Ue({"01":[{CODE:"0101",CODE_NM:"/ "},{CODE:"0102",CODE_NM:" "},{CODE:"0103",CODE_NM:" "}],"02":[{CODE:"0201",CODE_NM:" "},{CODE:"0202",CODE_NM:" "},{CODE:"0203",CODE_NM:" "}],"03":[{CODE:"0301",CODE_NM:" "},{CODE:"0302",CODE_NM:" "}],"04":[{CODE:"0401",CODE_NM:" "}]}),ke([{CODE:"05",CODE_NM:"5"},{CODE:"10",CODE_NM:"10"},{CODE:"15",CODE_NM:"15"},{CODE:"20",CODE_NM:"20"},{CODE:"25",CODE_NM:"25"},{CODE:"27",CODE_NM:"27"}])}catch(rt){console.error("Load payment codes error:",rt)}},_t=async()=>{if(n){ce(!0);try{const rt=await mV(n.custId);rt.success&&rt.data?j(rt.data):j([]),O(!0)}catch(rt){console.error("Load HP pay list error:",rt),j([])}finally{ce(!1)}}},qt=async()=>{if(n){ae(!0);try{const rt=await hS(n.custId);if(rt.success&&rt.data){if(Q(rt.data),rt.data.length>0){const Wt=a&&rt.data.find(bs=>bs.PYM_ACNT_ID===a)?a:rt.data[0].PYM_ACNT_ID;$(Wt)}}else Q([]);ie(!0)}catch(rt){console.error("Load payment info error:",rt),Q([])}finally{ae(!1)}}};b.useEffect(()=>{i==="payment"&&n&&!_e&&qt()},[i,n]);const jt=async rt=>{re(!1),ve(rt),be(!0);try{const Wt={PYM_ACNT_ID:q,CUST_ID:n.custId,ACNT_NM:X.acntHolderNm,PYM_MTHD:X.pymMthCd==="01"?"02":"04",BANK_CARD:X.bankCd,ACNT_CARD_NO:X.acntNo,CHG_RESN_L:X.changeReasonL,CHG_RESN_M:X.changeReasonM,ID_TP:X.idType,BIRTH_DT:X.birthDt,PYR_REL:X.pyrRel,PYM_DAY:X.pymDay,SIGNATURE:rt};X.pymMthCd==="02"&&X.cardExpYy&&X.cardExpMm&&(Wt.CDTCD_EXP_DT=X.cardExpYy+X.cardExpMm,Wt.REQR_NM=X.acntHolderNm,Wt.JOIN_CARD_YN=X.joinCardYn),X.pymMthCd==="01"&&(Wt.PYM_CUST_NM=X.acntHolderNm);const bs=await L4(Wt);bs.success?(mt(" .","success"),xe({pymMthCd:"01",changeReasonL:"",changeReasonM:"",acntHolderNm:"",idType:"01",birthDt:"",bankCd:"",acntNo:"",cardExpMm:"",cardExpYy:"",joinCardYn:"N",pyrRel:"01",pymDay:""}),se(!1),ve(null),c==null||c(),qt()):mt(bs.message||"  .","error")}catch(Wt){console.error("Save payment error:",Wt),mt("    .","error")}finally{be(!1)}},he=rt=>{const Wt=!g[rt];C(bs=>({...bs,[rt]:Wt})),rt==="hpPay"&&Wt&&!R&&_t(),rt==="payment"&&Wt&&!_e&&qt()},ye=async(rt,Wt)=>{if(!n)return;const bs=Wt==="",zt=JSON.parse(sessionStorage.getItem("userInfo")||localStorage.getItem("userInfo")||"{}");try{const ws={CUST_ID:n.custId,CTRT_ID:rt.CTRT_ID,HP_PAY_STAT:bs?"Y":"N",SO_ID:(r==null?void 0:r.soId)||zt.soId||"",MST_SO_ID:zt.mstSoId||"200",USR_ID:zt.userId||zt.USR_ID||""},Zt=await gV(ws);if(Zt.success){mt(` ${Wt} .`,"success"),_t();return}console.warn("HP Pay direct save failed, falling back to consultation:",Zt.message);const Ds={CUST_ID:n.custId,CTRT_ID:rt.CTRT_ID,CNSL_MST_CL:"04",CNSL_MID_CL:"0401",CNSL_SLV_CL:"040101",REQ_CTX:`[ ${Wt} ]
: ${rt.PROD_NM}
ID: ${rt.CTRT_ID}
: ${rt.HP_STAT||""}
: ${Wt}`},js=await P4(Ds);js.success?(mt(` ${Wt}  .    .`,"info"),_t()):mt(js.message||`${Wt}  .`,"error")}catch(ws){console.error("HP Pay change error:",ws),mt(`${Wt}    .`,"error")}},je=K.filter(rt=>rt.CTRT_STAT_NM===""),Me=je.filter(rt=>rt.HP_STAT!==""),tt=je.filter(rt=>rt.HP_STAT===""),[Te,bt]=b.useState(new Set),[Ke,St]=b.useState(new Set),Et=(rt,Wt)=>{rt==="apply"?bt(Wt?new Set(Me.map(bs=>bs.CTRT_ID)):new Set):St(Wt?new Set(tt.map(bs=>bs.CTRT_ID)):new Set)},ze=(rt,Wt,bs)=>{(rt==="apply"?bt:St)(ws=>{const Zt=new Set(ws);return bs?Zt.add(Wt):Zt.delete(Wt),Zt})},ht=async()=>{if(Te.size===0){mt("  .","warning");return}const rt=Me.filter(Wt=>Te.has(Wt.CTRT_ID));Ge({isOpen:!0,title:"  ",message:`${rt.length} ?`,type:"confirm",onConfirm:async()=>{for(const Wt of rt)await ye(Wt,"");bt(new Set)}})},Lt=async()=>{if(Ke.size===0){mt("  .","warning");return}const rt=tt.filter(Wt=>Ke.has(Wt.CTRT_ID));Ge({isOpen:!0,title:"  ",message:`${rt.length} ?`,type:"confirm",onConfirm:async()=>{for(const Wt of rt)await ye(Wt,"");St(new Set)}})},Bt=async()=>{var Wt,bs;if(!n){mt("  .","warning");return}const rt=y.telNo.replace(/[^0-9]/g,"");if(y.disconnYn!=="Y"){const zt=cV(rt,y.telNoType);if(zt){mt(zt,"warning");return}}else if(!rt){mt(" .","warning");return}J(!0);try{const{ddd:zt,fix:ws,dtl:Zt}=dV(rt),Ds=y.telNoType==="tel"?"1":"2",js=y.telNoType==="tel"?"":"",hs=y.telNoType==="tel"?((Wt=n.telNo)==null?void 0:Wt.replace(/[^0-9]/g,""))||"":((bs=n.hpNo)==null?void 0:bs.replace(/[^0-9]/g,""))||"",Ws={CUST_ID:n.custId,TEL_NO:hs,TEL_DDD:zt,TEL_FIX:ws,TEL_DTL:Zt,MB_CORP_TP:y.telTpCd,NO_SVC_YN:y.disconnYn,TEL_NO_TP:Ds,USE_YN:"Y",CTRT_ID:(r==null?void 0:r.ctrtId)||"",MAIN_TEL_YN:"N",CHG_UID:""},Vs=await _V(Ws);Vs.success?(mt(`${js} .`,"success"),S({telNoType:"hp",telNo:"",telTpCd:"",disconnYn:"N"})):mt(Vs.message||"  .","error")}catch(zt){console.error("Update phone error:",zt),mt("    .","error")}finally{J(!1)}},Yt=async()=>{if(!(r!=null&&r.ctrtId)){mt("     .","warning");return}if(!I.zipCd||!I.addr1){mt("  .","warning");return}if(!I.postId){mt("    .","warning");return}V(!0);try{const rt={CTRT_ID:r.ctrtId,POST_ID:I.postId,BLD_CL:I.bldCl||"0",BLD_NM:I.bldNm||"",BUN_NO:I.bunNo||"",HO_NM:I.hoNm||"",ADDR_DTL:I.addr2||"",STREET_ID:I.streetId||void 0,INSTL_LOC:P.instlLoc||void 0,CUST_FLAG:"0",PYM_FLAG:I.changeBillAddr?"1":"0"},Wt=await bR(rt);if(Wt.success){mt(" .","success");const bs=`${I.addr1}${I.addr2?" "+I.addr2:""}`;F(zt=>({...zt,addr:bs})),E({zipCd:"",addr1:"",addr2:"",instlLoc:"",changeBillAddr:!1,postId:"",streetId:"",dongmyonNm:"",bldCl:"0",bldNm:"",bunNo:"",hoNm:""}),Pe(""),p==null||p()}else mt(Wt.message||"  .","error")}catch(rt){console.error("Update address error:",rt),mt("    .","error")}finally{V(!1)}},[Xt,ts]=b.useState(!1),[Ut,Is]=b.useState(""),Cs=async()=>{if(!(r!=null&&r.ctrtId)){mt("     .","warning");return}if(!Ut){mt("  .","warning");return}ts(!0);try{let rt="",Wt="0",bs="",zt="";try{const Ds=await J1(n.custId);if(Ds.success&&Ds.data){const js=Ds.data.find(hs=>hs.CTRT_ID===r.ctrtId);js&&(rt=js.ADDR_DTL||"",Wt=js.BLD_CL||"0",bs=js.BLD_NM||"",zt=js.STREET_ID||"")}}catch(Ds){console.log("[]    ,  :",Ds)}const ws={CTRT_ID:r.ctrtId,POST_ID:r.postId||"",ADDR_DTL:rt,BLD_CL:Wt,BLD_NM:bs,STREET_ID:zt,INSTL_LOC:Ut,CUST_FLAG:"0",PYM_FLAG:"0"},Zt=await bR(ws);Zt.success?(mt(" .","success"),F(Ds=>({...Ds,instlLoc:Ut})),Is(""),p==null||p()):mt(Zt.message||"  .","error")}catch(rt){console.error("Update location error:",rt),mt("    .","error")}finally{ts(!1)}},Us=()=>{Fe(!0),ut(""),Ee({streetNm:"",streetBunM:"",streetBunS:""}),pe([]),Be([])},_s=()=>{Fe(!1),pe([]),Be([])},Es=(rt,Wt)=>{const bs=Wt.toLowerCase();return rt.filter(zt=>{const ws=(zt.DONGMYON_NM||"").toLowerCase(),Zt=(zt.ADDR||"").toLowerCase(),Ds=(zt.GUGUN_NM||"").toLowerCase(),js=(zt.BLD_NM||"").toLowerCase();return ws.includes(bs)||Zt.includes(bs)||Ds.includes(bs)||js.includes(bs)})},Ls=async()=>{if(!Mt||Mt.length<2){mt("/  2  .","warning");return}we(!0);try{const rt=(r==null?void 0:r.soId)||"",Wt=await PV({DONGMYONG:Mt,...rt?{SO_ID:rt}:{}});if(Wt.success&&Wt.data){let bs=Wt.data;if(bs.length>0){const zt=Es(bs,Mt);console.log(`[AddressSearch] : ${bs.length}  ${zt.length} (: ${Mt})`),bs=zt}pe(bs),bs.length===0&&mt("   .","info")}else mt(Wt.message||"  .","error"),pe([])}catch(rt){console.error("Search post address error:",rt),mt("    .","error"),pe([])}finally{we(!1)}},cs=async()=>{if(!qe.streetNm||qe.streetNm.length<2){mt(" 2  .","warning");return}we(!0);try{const rt=await AV({STREET_NM:qe.streetNm,STREET_BUN_M:qe.streetBunM||"",STREET_BUN_S:qe.streetBunS||"",SO_ID:(r==null?void 0:r.soId)||""});rt.success&&rt.data?(Be(rt.data),rt.data.length===0&&mt("   .","info")):(mt(rt.message||"  .","warning"),Be([]))}catch(rt){console.error("Search street address error:",rt),mt("    .","error"),Be([])}finally{we(!1)}},ms=rt=>{const Wt=rt.BLD_NM?rt.BLD_NM.includes("")||rt.BLD_NM.includes("APT")?"2":"1":"0";E(bs=>({...bs,zipCd:rt.ZIP_CD,addr1:rt.ADDR_FULL||rt.ADDR,addr2:"",postId:rt.POST_ID,streetId:"",dongmyonNm:rt.DONGMYON_NM||"",bldCl:Wt,bldNm:rt.BLD_NM||"",bunNo:rt.STRT_BUNGIHO||"",hoNm:""})),Pe(rt.POST_ID),_s(),mt(" .  .","info")},Ys=rt=>{const Wt=rt.BLD_NM?rt.BLD_NM.includes("")||rt.BLD_NM.includes("APT")?"2":"1":"0";E(bs=>({...bs,zipCd:rt.ZIP_CD,addr1:rt.STREET_ADDR||rt.ADDR_FULL,addr2:"",postId:rt.POST_ID,streetId:rt.STREET_ID,dongmyonNm:rt.DONGMYON_NM||rt.NM_SMALL||"",bldCl:Wt,bldNm:rt.BLD_NM||"",bunNo:rt.BUN_NO||"",hoNm:rt.HO_NM||""})),Pe(rt.POST_ID),_s(),mt(" .  .","info")};return n?s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>he("phone"),className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(VC,{className:"w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:" "})]}),g.phone?s.jsx(kr,{className:"w-5 h-5 text-gray-400"}):s.jsx(ir,{className:"w-5 h-5 text-gray-400"})]}),g.phone&&s.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-2 font-medium",children:"   ()"}),n.phoneList&&n.phoneList.length>2?s.jsx("div",{className:"space-y-2",children:n.phoneList.map((rt,Wt)=>s.jsxs("button",{type:"button",onClick:()=>S(bs=>({...bs,telNoType:rt.type})),className:`w-full p-2 rounded border flex justify-between items-center transition-colors ${y.telNoType===rt.type?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white border-gray-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`text-xs ${y.telNoType===rt.type?"text-blue-600 font-medium":"text-gray-500"}`,children:rt.typeNm}),s.jsx("div",{className:`font-medium text-sm ${y.telNoType===rt.type?"text-blue-700":"text-gray-800"}`,children:aC(rt.number)||"-"})]},Wt))}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>S(rt=>({...rt,telNoType:"tel"})),className:`p-2 rounded border text-left transition-colors ${y.telNoType==="tel"?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white border-gray-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`text-xs ${y.telNoType==="tel"?"text-blue-600 font-medium":"text-gray-500"}`,children:""}),s.jsx("div",{className:`font-medium text-sm ${y.telNoType==="tel"?"text-blue-700":"text-gray-800"}`,children:aC(n.telNo)||"-"})]}),s.jsxs("button",{type:"button",onClick:()=>S(rt=>({...rt,telNoType:"hp"})),className:`p-2 rounded border text-left transition-colors ${y.telNoType==="hp"?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white border-gray-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`text-xs ${y.telNoType==="hp"?"text-blue-600 font-medium":"text-gray-500"}`,children:""}),s.jsx("div",{className:`font-medium text-sm ${y.telNoType==="hp"?"text-blue-700":"text-gray-800"}`,children:aC(n.hpNo)||"-"})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:[" ",y.telNoType==="tel"?"":""]}),s.jsx("input",{type:"tel",value:y.telNo,onChange:rt=>S(Wt=>({...Wt,telNo:rt.target.value.replace(/[^0-9]/g,"")})),placeholder:y.telNoType==="tel"?"0212345678":"01012345678",maxLength:12,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsxs("select",{value:y.telTpCd,onChange:rt=>S(Wt=>({...Wt,telTpCd:rt.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:""}),v.map(rt=>s.jsx("option",{value:rt.CODE,children:rt.CODE_NM},rt.CODE)),v.length===0&&A&&s.jsx("option",{value:"",disabled:!0,children:"..."})]})]}),s.jsx("button",{onClick:Bt,disabled:ee,className:"w-full flex items-center justify-center gap-2 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 transition-colors",children:ee?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[y.telNoType==="tel"?"":""," "]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>he("address"),className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ed,{className:"w-5 h-5 text-green-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:" / "})]}),g.address?s.jsx(kr,{className:"w-5 h-5 text-gray-400"}):s.jsx(ir,{className:"w-5 h-5 text-gray-400"})]}),g.address&&s.jsx("div",{className:"px-4 pb-4 space-y-4",children:r!=null&&r.ctrtId?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-3 bg-gray-100 border border-gray-300 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(eL,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"  "})]}),s.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",r.prodNm]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",P.addr||"-"]}),s.jsxs("p",{children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",P.instlLoc||"-"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:I.zipCd,readOnly:!0,placeholder:"  ",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 cursor-pointer",onClick:Us}),s.jsxs("button",{onClick:Us,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-1",children:[s.jsx(Yu,{className:"w-4 h-4"}),""]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:I.addr1,onChange:rt=>E(Wt=>({...Wt,addr1:rt.target.value})),placeholder:" ",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:I.addr2,onChange:rt=>E(Wt=>({...Wt,addr2:rt.target.value})),placeholder:"  ()",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[s.jsxs("label",{className:`flex items-center gap-2 ${G?"cursor-pointer":"cursor-not-allowed opacity-50"}`,children:[s.jsx("input",{type:"checkbox",checked:I.changeBillAddr,onChange:rt=>E(Wt=>({...Wt,changeBillAddr:rt.target.checked})),disabled:!G,className:"w-4 h-4 text-green-600 rounded"}),s.jsx("span",{className:"text-sm text-gray-700",children:"  "}),!G&&s.jsxs("span",{className:"text-xs text-orange-500",children:["( ",U.length," -   )"]})]}),I.changeBillAddr&&G&&s.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded text-xs",children:[s.jsxs("p",{className:"text-blue-700",children:[s.jsx("strong",{children:" :"})," ",((Ps=U[0])==null?void 0:Ps.BILL_ADDR)||"  "]}),s.jsx("p",{className:"text-blue-600 mt-1",children:"     "})]})]}),s.jsx("button",{onClick:Yt,disabled:H,className:"w-full flex items-center justify-center gap-2 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:H?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-5 h-5 animate-spin"})," ..."]}):" "}),s.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:" "}),s.jsx("div",{children:s.jsx("input",{type:"text",value:Ut,onChange:rt=>Is(rt.target.value),placeholder:P.instlLoc?`: ${P.instlLoc}`:": , ,  ",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),s.jsx("button",{onClick:Cs,disabled:Xt,className:"w-full flex items-center justify-center gap-2 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:Xt?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-5 h-5 animate-spin"})," ..."]}):" "})]})]}):s.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vr,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"  "}),s.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"     /  ."})]})]})})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("button",{onClick:()=>he("hpPay"),className:"w-full p-4 flex items-center justify-between text-left",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($C,{className:"w-5 h-5 text-purple-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:"() "})]}),g.hpPay?s.jsx(kr,{className:"w-5 h-5 text-gray-400"}):s.jsx(ir,{className:"w-5 h-5 text-gray-400"})]}),g.hpPay&&s.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:_t,disabled:te,className:"flex items-center gap-1 px-3 py-1 text-sm text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:s.jsx(Oc,{className:`w-4 h-4 ${te?"animate-spin":""}`})})}),te&&s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(On,{className:"w-6 h-6 text-purple-500 animate-spin"}),s.jsx("span",{className:"ml-2 text-gray-500",children:" ..."})]}),!te&&R&&je.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx($C,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{children:"   ."})]}),!te&&Me.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-purple-700",children:[s.jsx("input",{type:"checkbox",checked:Me.length>0&&Te.size===Me.length,onChange:rt=>Et("apply",rt.target.checked),className:"w-4 h-4 text-purple-600 rounded"}),"  (",Me.length,")"]}),s.jsxs("button",{onClick:ht,disabled:Te.size===0,className:"px-3 py-1 text-xs font-medium bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:bg-gray-300 transition-colors",children:["  (",Te.size,")"]})]}),Me.map((rt,Wt)=>s.jsxs("div",{className:`p-3 rounded-lg border ${Te.has(rt.CTRT_ID)?"bg-purple-50 border-purple-300":"bg-gray-50 border-gray-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",checked:Te.has(rt.CTRT_ID),onChange:bs=>ze("apply",rt.CTRT_ID,bs.target.checked),className:"w-4 h-4 text-purple-600 rounded flex-shrink-0"}),s.jsx("span",{className:"font-medium text-gray-800 text-sm flex-1",children:rt.PROD_NM||" "}),s.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full flex-shrink-0 bg-orange-100 text-orange-700",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-1 ml-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"ID:"}),s.jsx("span",{className:"text-gray-700",children:rt.CTRT_ID})]}),rt.ADDR&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:": "}),s.jsx("span",{className:"text-gray-700 break-all",children:rt.ADDR})]})]})]},rt.CTRT_ID||`apply-${Wt}`))]}),!te&&tt.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-green-700",children:[s.jsx("input",{type:"checkbox",checked:tt.length>0&&Ke.size===tt.length,onChange:rt=>Et("cancel",rt.target.checked),className:"w-4 h-4 text-green-600 rounded"}),"  (",tt.length,")"]}),s.jsxs("button",{onClick:Lt,disabled:Ke.size===0,className:"px-3 py-1 text-xs font-medium bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:bg-gray-300 transition-colors",children:["  (",Ke.size,")"]})]}),tt.map((rt,Wt)=>s.jsxs("div",{className:`p-3 rounded-lg border ${Ke.has(rt.CTRT_ID)?"bg-green-50 border-green-300":"bg-gray-50 border-gray-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",checked:Ke.has(rt.CTRT_ID),onChange:bs=>ze("cancel",rt.CTRT_ID,bs.target.checked),className:"w-4 h-4 text-green-600 rounded flex-shrink-0"}),s.jsx("span",{className:"font-medium text-gray-800 text-sm flex-1",children:rt.PROD_NM||" "}),s.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full flex-shrink-0 bg-green-100 text-green-700",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-1 ml-6",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"ID:"}),s.jsx("span",{className:"text-gray-700",children:rt.CTRT_ID})]}),rt.ADDR&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:": "}),s.jsx("span",{className:"text-gray-700 break-all",children:rt.ADDR})]})]})]},rt.CTRT_ID||`cancel-${Wt}`))]}),s.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vr,{className:"w-4 h-4 text-purple-600 mt-0.5"}),s.jsx("div",{className:"text-sm text-purple-700",children:s.jsx("p",{children:"/     ,    ."})})]})})]})]})]}),it&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden max-h-[85vh] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-100 bg-gradient-to-r from-green-500 to-green-600 flex-shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(Ed,{className:"w-4 h-4"})," "]}),s.jsx("button",{onClick:_s,className:"text-white/80 hover:text-white",children:s.jsx(Mi,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"p-3 border-b border-gray-200 flex-shrink-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{lt("post"),pe([]),Be([])},className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${nt==="post"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:()=>{lt("street"),pe([]),Be([])},className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${nt==="street"?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]})}),s.jsxs("div",{className:"p-3 border-b border-gray-200 flex-shrink-0",children:[nt==="post"?s.jsx("div",{className:"space-y-2",children:s.jsx("input",{type:"text",value:Mt,onChange:rt=>ut(rt.target.value),onKeyPress:rt=>rt.key==="Enter"&&Ls(),placeholder:"//   (: )",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:" *"}),s.jsx("input",{type:"text",value:qe.streetNm,onChange:rt=>Ee(Wt=>({...Wt,streetNm:rt.target.value})),onKeyPress:rt=>rt.key==="Enter"&&cs(),placeholder:": ",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("input",{type:"text",value:qe.streetBunM,onChange:rt=>Ee(Wt=>({...Wt,streetBunM:rt.target.value.replace(/[^0-9]/g,"")})),placeholder:": 123",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),s.jsx("input",{type:"text",value:qe.streetBunS,onChange:rt=>Ee(Wt=>({...Wt,streetBunS:rt.target.value.replace(/[^0-9]/g,"")})),placeholder:": 0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]})]}),s.jsx("button",{onClick:nt==="post"?Ls:cs,disabled:ue,className:"w-full mt-3 flex items-center justify-center gap-2 py-2.5 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:ue?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-4 h-4 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Yu,{className:"w-4 h-4"}),""]})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-3 min-h-0",children:nt==="post"?Ye.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",Ye.length,""]}),Ye.map((rt,Wt)=>s.jsxs("button",{onClick:()=>ms(rt),className:"w-full p-3 bg-gray-50 hover:bg-green-50 rounded-lg border border-gray-200 hover:border-green-300 text-left transition-colors",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:rt.ADDR_FULL||rt.ADDR}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[": ",rt.ZIP_CD," | ",rt.SIDO_NAME," ",rt.GUGUN_NM," ",rt.DONGMYON_NM]})]},rt.POST_ID||Wt))]}):s.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"//   ."}):ge.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",ge.length,""]}),ge.map((rt,Wt)=>s.jsxs("button",{onClick:()=>Ys(rt),className:"w-full p-3 bg-gray-50 hover:bg-green-50 rounded-lg border border-gray-200 hover:border-green-300 text-left transition-colors",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:rt.STREET_ADDR}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[": ",rt.ZIP_CD," | ",rt.ADDR_FULL]}),rt.BLD_NM&&s.jsxs("div",{className:"mt-0.5 text-xs text-green-600",children:[": ",rt.BLD_NM]})]},rt.STREET_ID||Wt))]}):s.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"  ."})}),s.jsx("div",{className:"p-3 border-t border-gray-200 flex-shrink-0",children:s.jsx("button",{onClick:_s,className:"w-full py-2.5 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",children:""})})]})}),De&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsx(k4,{title:"  ",onSave:jt,onCancel:()=>re(!1)})})}),et&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-yellow-500 to-orange-500",children:s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(Vr,{className:"w-5 h-5"}),"  "]})}),s.jsxs("div",{className:"p-4",children:[s.jsxs("p",{className:"text-gray-700 text-sm",children:["      .",s.jsx("br",{}),"     ."]}),s.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"?"})]}),s.jsxs("div",{className:"p-4 bg-gray-50 flex gap-2",children:[s.jsx("button",{onClick:()=>{Dt(!1),At("")},className:"flex-1 py-2.5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:""}),s.jsx("button",{onClick:()=>Ve(ot),className:"flex-1 py-2.5 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium",children:""})]})]})}),s.jsx(Ba,{isOpen:ct.isOpen,onClose:()=>Ge(TE),onConfirm:ct.onConfirm,title:ct.title,message:ct.message,type:ct.type,confirmText:"",cancelText:""}),s.jsx(Ba,{isOpen:at.isOpen,onClose:()=>xt({isOpen:!1,message:"",type:"info"}),onConfirm:()=>{},message:at.message,type:at.type==="success"?"confirm":at.type==="warning"?"warning":at.type==="error"?"error":"info",confirmText:"",showCancel:!1})]}):s.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(Vr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"  "}),s.jsxs("p",{className:"text-gray-500",children:["     ",s.jsx("br",{}),"   ."]})]})})},vm=({isOpen:t,onClose:e,onScan:n,isMultiScanMode:r=!1,scanCount:i=0})=>{const a=b.useRef(null),[o,c]=b.useState(!1),[u,h]=b.useState(null),[m,_]=b.useState(!1);b.useEffect(()=>t?((async()=>{try{screen.orientation&&screen.orientation.lock&&await screen.orientation.lock("portrait")}catch{console.log("Screen orientation lock not supported")}})(),()=>{try{screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock()}catch{}}):void 0,[t]),b.useEffect(()=>t?(h(null),c(!1),(async()=>{if(window.Html5Qrcode){await p();return}const k=document.createElement("script");k.src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js",k.async=!0,k.onload=()=>{p()},k.onerror=()=>{h("    .")},document.body.appendChild(k)})(),()=>{C()}):void 0,[t]);const p=async()=>{var v,k,L;try{if(h(null),!window.Html5Qrcode){h("Html5Qrcode not loaded");return}await g()}catch(M){console.error("Camera init error:",M),M.name==="NotAllowedError"||(v=M.message)!=null&&v.includes("Permission")?h(`   .
   .`):(k=M.message)!=null&&k.includes("secure context")||(L=M.message)!=null&&L.includes("https")?h(` HTTPS  localhost  .

 S/N .`):h(`   :
`+(M.message||M))}},g=async()=>{try{const v=window.Html5Qrcode;if(!v)return;if(a.current){try{await a.current.stop(),a.current.clear()}catch{}a.current=null}await new Promise(L=>setTimeout(L,100)),a.current=new v("barcode-reader");const k={fps:15,qrbox:{width:300,height:180},aspectRatio:1.777778,disableFlip:!1};await a.current.start({facingMode:"environment"},k,L=>{console.log("Barcode scanned:",L),navigator.vibrate&&navigator.vibrate(100),n(L),r||y()},L=>{});try{const L=document.querySelector("#barcode-reader video");if(L&&L.srcObject){const M=L.srcObject.getVideoTracks()[0];if(M){await M.applyConstraints({width:{ideal:4096},height:{ideal:2160}});try{await M.applyConstraints({advanced:[{focusMode:"continuous"}]})}catch{}}}}catch(L){console.log("Camera enhancement not supported:",L)}c(!0),h(null)}catch(v){console.error("Scanner start error:",v),h(`   .
`+(v.message||" ."))}},C=async()=>{if(a.current){try{await a.current.stop(),a.current.clear()}catch{}a.current=null}c(!1)},y=async()=>{await C(),e()},S=async()=>{_(!0),h(null),await C(),await new Promise(v=>setTimeout(v,300)),await p(),_(!1)};return t?s.jsxs("div",{className:"fixed inset-0 bg-black barcode-scanner-container z-[999999]",children:[s.jsxs("button",{onClick:y,className:"absolute top-4 right-4 z-30 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 transition-colors active:scale-95 flex items-center gap-2",style:{marginTop:"env(safe-area-inset-top, 0px)"},children:[s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("span",{className:"text-white font-medium text-sm",children:""})]}),r&&s.jsxs("div",{className:"absolute top-4 left-4 z-30 px-3 py-2 bg-blue-500 text-white text-sm font-bold rounded-full",style:{marginTop:"env(safe-area-inset-top, 0px)"},children:[i,""]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{top:"60px",bottom:"180px"},children:s.jsx("div",{id:"barcode-reader",className:"w-full max-w-md mx-4"})}),o&&s.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:s.jsxs("div",{className:"w-[300px] h-[180px] relative",children:[s.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-green-400 rounded-tl-lg"}),s.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-green-400 rounded-tr-lg"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-green-400 rounded-bl-lg"}),s.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-green-400 rounded-br-lg"}),s.jsx("div",{className:"absolute left-2 right-2 h-0.5 bg-gradient-to-r from-transparent via-green-400 to-transparent animate-scan"})]})}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/80 px-4 pt-3 z-20",style:{paddingBottom:"max(20px, env(safe-area-inset-bottom, 20px))"},children:[u?s.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 mb-3",children:[s.jsx("p",{className:"text-red-200 text-sm text-center whitespace-pre-line",children:u}),s.jsx("button",{onClick:S,disabled:m,className:"w-full mt-3 py-2.5 bg-red-500 hover:bg-red-600 disabled:bg-red-400 text-white rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:m?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"  ..."]}):" "})]}):s.jsxs("div",{className:"text-center mb-3",children:[s.jsx("p",{className:"text-white/80 text-sm mb-1",children:"    "}),s.jsx("p",{className:"text-white/50 text-xs",children:r?"   -    ":"S/N   "})]}),s.jsx("button",{onClick:y,className:"w-full py-3 bg-gray-600 hover:bg-gray-500 text-white rounded-lg font-semibold transition-colors active:scale-[0.98] border border-gray-500",children:"  "})]}),s.jsx("style",{children:`
        @keyframes scan {
          0% { top: 10%; }
          50% { top: 85%; }
          100% { top: 10%; }
        }
        .animate-scan {
          animation: scan 2s ease-in-out infinite;
        }
        #barcode-reader {
          border: none !important;
          background: transparent !important;
          width: 100% !important;
        }
        #barcode-reader video {
          width: 100% !important;
          height: auto !important;
          object-fit: cover !important;
        }
        #barcode-reader__scan_region {
          background: transparent !important;
          min-height: 300px !important;
        }
        #barcode-reader__scan_region img {
          display: none !important;
        }
        #barcode-reader__scan_region br {
          display: none !important;
        }
        /* Hide the qrbox border */
        #barcode-reader__scan_region > div {
          border: none !important;
          box-shadow: none !important;
        }
        #qr-shaded-region {
          border: none !important;
        }
        /* Hide all library UI elements */
        #barcode-reader__dashboard,
        #barcode-reader__dashboard_section,
        #barcode-reader__dashboard_section_swaplink,
        #barcode-reader__dashboard_section_csr,
        #barcode-reader__status_span,
        #barcode-reader__header_message,
        #barcode-reader img[alt="Info icon"],
        #barcode-reader a {
          display: none !important;
        }
        #barcode-reader > div:last-child {
          display: none !important;
        }
        /*       */
        @media screen and (orientation: landscape) {
          .barcode-scanner-container {
            transform: rotate(-90deg);
            transform-origin: left top;
            width: 100vh !important;
            height: 100vw !important;
            position: fixed !important;
            top: 100% !important;
            left: 0 !important;
          }
        }
      `})]}):null},nq=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},Ch=t=>t.replace(/[^0-9]/g,""),rq=({onCustomerSelect:t,onCustomerClear:e,showToast:n,selectedCustomer:r})=>{const[i,a]=b.useState(!1),[o,c]=b.useState(""),[u,h]=b.useState(""),[m,_]=b.useState(""),[p,g]=b.useState(""),[C,y]=b.useState(""),[S,v]=b.useState(!1),[k,L]=b.useState([]),[M,P]=b.useState(!1),[F,G]=b.useState(!1),B=b.useRef({customerId:"",contractId:"",phoneNumber:"",customerName:"",equipmentNo:""}),[I,E]=b.useState({show:!1,title:"",message:""}),A=()=>{c(B.current.customerId),h(B.current.contractId),_(B.current.phoneNumber),g(B.current.customerName),y(B.current.equipmentNo),a(!0)},Y=()=>{a(!1)},ee=()=>{c(""),h(""),_(""),g(""),y(""),L([])},J=async()=>{let j=Ch(o),te=Ch(u);const ce=Ch(m);j.length>0&&j.length<10&&(j=j.padStart(10,"0"),c(j)),te.length>0&&te.length<10&&(te=te.padStart(10,"0"),h(te));const R=j.length>=4,O=te.length>=4,U=ce.length>=4,Q=p.length>=2,q=C.length>=4;if(p.length===1){E({show:!0,title:" ",message:" 2  ."});return}if(!R&&!O&&!U&&!Q&&!q){E({show:!0,title:" ",message:`  .
(ID/ID/S/N 4,  4,  2)`});return}B.current={customerId:j,contractId:te,phoneNumber:m,customerName:p,equipmentNo:C},v(!0),P(!0);try{const $=await fV({custId:R?j:void 0,contractId:O?te:void 0,phoneNumber:U?ce:void 0,customerName:Q?p:void 0,equipmentNo:q?C:void 0});if($.success&&$.data&&$.data.length>0){let de=$.data;if(O&&de.length>0&&(de=de.map(ae=>({...ae,CTRT_ID:te}))),q&&de.length>0)try{const ae=de[0].CUST_ID,_e=await J1(ae);if(_e.success&&_e.data){const ie=C.toLowerCase(),Ne=_e.data.find(X=>{var xe,fe;return((xe=X.NOTRECEV)==null?void 0:xe.toLowerCase().includes(ie))||((fe=X.EQT_SERNO)==null?void 0:fe.toLowerCase().includes(ie))});Ne&&(de=de.map(X=>({...X,CTRT_ID:Ne.CTRT_ID})))}}catch(ae){console.log("[CustomerSearch] S/N  CTRT_ID lookup failed:",ae)}R&&(de=de.filter(ae=>(ae.CUST_ID||"").includes(j))),O&&(de=de.filter(ae=>(ae.CTRT_ID||"").includes(te))),Q&&(de=de.filter(ae=>(ae.CUST_NM||"").includes(p))),U&&(de=de.filter(ae=>[ae.TEL_NO,ae.HP_NO,...(ae.PHONE_LIST||[]).map(ie=>ie.TEL_NO||ie.HP_NO)].filter(Boolean).map(ie=>ie.replace(/[^0-9]/g,"")).some(ie=>ie.includes(ce)||ce.includes(ie)))),q&&(de=de.filter(ae=>(ae.EQT_SERNO||"").toLowerCase().includes(C.toLowerCase())||(ae.NOTRECEV||"").toLowerCase().includes(C.toLowerCase()))),de.length>0?L(de):(L([]),E({show:!0,title:" ",message:` .
  .`}))}else L([]),E({show:!0,title:" ",message:` .
  .`})}catch($){console.error("Customer search error:",$),E({show:!0,title:"",message:"   ."}),L([])}finally{v(!1)}},H=j=>{j.key==="Enter"&&J()},V=j=>{y(j.toUpperCase()),G(!1)},K=j=>{const te=j.CUST_ID||"",ce=Ch(j.TEL_NO||j.HP_NO||""),R=j.CUST_NM||"",O=j.CTRT_ID||u;c(te),_(ce),g(R),j.CTRT_ID&&h(j.CTRT_ID),B.current={customerId:te,contractId:O,phoneNumber:ce,customerName:R,equipmentNo:C};const U={...j,EQT_SERNO:C||j.EQT_SERNO||void 0};t(U),Y()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-white rounded-lg border border-gray-100 shadow-sm p-3",children:s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex gap-2 cursor-pointer min-w-0 overflow-hidden",onClick:A,children:[s.jsx("input",{readOnly:!0,className:"flex-1 min-w-0 px-2 py-2 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer truncate",placeholder:"",type:"text",value:(r==null?void 0:r.CUST_NM)||""}),s.jsx("input",{readOnly:!0,className:"flex-1 min-w-0 px-2 py-2 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer",placeholder:"ID",type:"text",value:r?nq(r.CUST_ID):""})]})]})})}),i&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden max-h-[80vh] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-100 bg-gradient-to-r from-blue-500 to-blue-600 flex-shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(o0,{className:"w-4 h-4"})," "]}),s.jsx("button",{onClick:ee,className:"px-3 py-1 text-xs font-medium text-blue-600 bg-white rounded-lg hover:bg-gray-100 transition-colors",children:""})]})}),s.jsxs("div",{className:"p-4 space-y-3 flex-1 overflow-y-auto min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:o,onChange:j=>c(Ch(j.target.value)),onKeyPress:H,placeholder:"0000000000",maxLength:10,className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:u,onChange:j=>h(Ch(j.target.value)),onKeyPress:H,placeholder:"0000000000",maxLength:10,className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex gap-2 min-w-0",children:[s.jsx("input",{type:"tel",value:m,onChange:j=>_(Ch(j.target.value)),onKeyPress:H,placeholder:"01000000000",maxLength:11,className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",value:p,onChange:j=>g(j.target.value),onKeyPress:H,placeholder:"",className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:C,onChange:j=>y(j.target.value.toUpperCase()),onKeyPress:H,placeholder:"S/N  MAC  ",className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono"}),s.jsxs("button",{onClick:()=>G(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-white flex-shrink-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:J,disabled:S,className:"flex-1 py-2.5 text-sm text-white bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 rounded-lg font-medium flex items-center justify-center",children:S?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-4 h-4 animate-spin mr-2"})," ..."]}):""}),s.jsx("button",{onClick:Y,className:"flex-1 py-2.5 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium",children:""})]})}),s.jsx("div",{className:"px-4 pb-4 flex-shrink-0",children:M?k.length>0?s.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3 bg-gray-50",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",k.length,""]}),k.map((j,te)=>s.jsxs("button",{onClick:()=>K(j),className:"w-full p-3 bg-white hover:bg-blue-50 rounded-lg border border-gray-200 hover:border-blue-300 text-left transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-blue-600 font-mono text-sm",children:j.CUST_ID}),s.jsx("span",{className:"font-semibold text-gray-900",children:j.CUST_NM})]}),j.CTRT_ID&&s.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:[s.jsx("span",{className:"text-gray-400",children:"ID:"})," ",s.jsx("span",{className:"font-mono",children:j.CTRT_ID})]}),s.jsxs("div",{className:"mt-1 text-xs text-gray-500 truncate",children:[M2(j.TEL_NO||j.HP_NO),j.CUST_ADDR&&` | ${j.CUST_ADDR}`]}),j.UNPAY_AMT>0&&s.jsxs("div",{className:"mt-1 text-xs text-red-500 font-medium",children:[": ",j.UNPAY_AMT.toLocaleString(),""]})]},j.CUST_ID||te))]}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm border border-gray-200 rounded-lg bg-gray-50",children:"  ."}):s.jsx("div",{className:"text-center py-4 text-gray-400 text-sm border border-dashed border-gray-200 rounded-lg",children:"     ."})})]})}),s.jsx(vm,{isOpen:F,onClose:()=>G(!1),onScan:V}),I.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:s.jsx(Vr,{className:"w-5 h-5 text-orange-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:I.title})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-5 whitespace-pre-line",children:I.message}),s.jsx("div",{className:"flex gap-3",children:s.jsx("button",{onClick:()=>E({show:!1,title:"",message:""}),className:"flex-1 px-4 py-2 text-sm text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-colors",children:""})})]})})]})},cp=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},iq=({onBack:t,showToast:e,selectedCustomer:n,selectedContract:r,contracts:i=[],onNavigateToBasicInfo:a,initialTab:o="consultation"})=>{var ge,Be;const[c,u]=b.useState(o);b.useEffect(()=>{(o==="consultation"||o==="as")&&u(o)},[o]);const[h,m]=b.useState([]),[_,p]=b.useState([]),[g,C]=b.useState(r?"byContract":"byDate"),[y,S]=b.useState([]),[v,k]=b.useState([]),[L,M]=b.useState([]),[P,F]=b.useState("customer"),[G,B]=b.useState("subscriber"),[I,E]=b.useState(!1),A=ue=>{ue==="contract"?r?F("contract"):E(!0):F("customer")};b.useEffect(()=>{r&&F("contract")},[r]);const[Y,ee]=b.useState({cnslLClCd:"",cnslMClCd:"",cnslSClCd:"",reqCntn:"",transYn:"N",transDeptCd:""}),[J,H]=b.useState(new Set),[V,K]=b.useState(new Set),j=ue=>{H(we=>{const Je=new Set(we);return Je.has(ue)?Je.delete(ue):Je.add(ue),Je})},te=ue=>{K(we=>{const Je=new Set(we);return Je.has(ue)?Je.delete(ue):Je.add(ue),Je})},[ce,R]=b.useState([]),[O,U]=b.useState([]),[Q,q]=b.useState([]),[$,de]=b.useState([]),ae=ue=>{if(!ue){ee(Oe=>({...Oe,cnslLClCd:"",cnslMClCd:"",cnslSClCd:""}));return}const we=$.find(Oe=>Oe.code===ue),Je=(we==null?void 0:we.ref_code)||"",Pe=O.find(Oe=>Oe.code===Je),Nt=(Pe==null?void 0:Pe.ref_code)||"";ee(Oe=>({...Oe,cnslLClCd:Nt,cnslMClCd:Je,cnslSClCd:ue}))},_e=()=>{const ue=new Date().getHours()+1;return ue>=9&&ue<=21?ue.toString().padStart(2,"0"):"09"},[ie,Ne]=b.useState({asClCd:"",asClDtlCd:"",asResnLCd:"",asResnMCd:"",asCntn:"",schdDt:new Date().toISOString().split("T")[0],schdHour:_e(),schdMin:"00"}),[X,xe]=b.useState([]),[fe,Z]=b.useState([]),[le,se]=b.useState([]),[Re,be]=b.useState([]),[De,re]=b.useState([]),me=r!=null&&r.prodGrp?le.filter(ue=>!ue.ref_code||ue.ref_code.includes(r.prodGrp)):le,ve=ue=>{Ne(Je=>({...Je,asResnLCd:ue,asResnMCd:""}));const we=Re.filter(Je=>Je.ref_code===ue);re(we)},et=Array.from({length:13},(ue,we)=>{const Je=(9+we).toString().padStart(2,"0");return{value:Je,label:`${Je}`}}),Dt=Array.from({length:6},(ue,we)=>{const Je=(we*10).toString().padStart(2,"0");return{value:Je,label:`${Je}`}}),[ot,At]=b.useState(!1),[ct,Ge]=b.useState(!1),[at,xt]=b.useState(!1),[mt,Ve]=b.useState({show:!1,type:"success",title:"",message:""}),it=(ue,we,Je)=>{Ve({show:!0,type:ue,title:we,message:Je})},[Fe,nt]=b.useState(!0),lt=g==="byContract"?r!=null&&r.ctrtId?h:[]:y,Mt=g==="byContract"?r!=null&&r.ctrtId?_:[]:v;b.useEffect(()=>{ut(),n&&r?(C("byContract"),Ee()):n&&(C("byDate"),qe())},[n,r]),b.useEffect(()=>{n&&y.length===0&&v.length===0&&qe()},[i]),b.useEffect(()=>{r!=null&&r.ctrtId&&(r==null?void 0:r.prodGrp)==="C"?TV(r.ctrtId).then(ue=>{if(ue.success&&ue.data){const we=(Array.isArray(ue.data)?ue.data:[ue.data]).filter(Je=>Je.biz_cl||Je.BIZ_CL||Je.code).map(Je=>({CODE:Je.biz_cl||Je.BIZ_CL||Je.code||"",CODE_NM:Je.SVC_NM||Je.svc_nm||Je.name||Je.biz_cl||""}));Z(we)}}).catch(()=>Z([])):Z([])},[r]);const ut=async()=>{Ge(!0);try{const[ue,we,Je,Pe,Nt,Oe]=await Promise.all([NV(),SV(),vV(),EV(),DV(),RV()]),dt=gt=>gt.filter(It=>It.code&&It.code!=="[]"&&It.name!=="").map(It=>({code:It.code,name:It.name,ref_code:It.ref_code,ref_code2:It.ref_code2,ref_code12:It.ref_code12}));if(ue.success&&ue.data&&R(dt(ue.data)),we.success&&we.data&&U(dt(we.data)),Je.success&&Je.data){const gt=dt(Je.data);q(gt),de(gt.filter(It=>It.ref_code12==="Y"))}if(Pe.success&&Pe.data){const gt=["0350","0360","0370"],It=Pe.data.filter($e=>$e.code&&$e.code!=="[]"&&$e.ref_code==="03"&&!gt.includes($e.code)).map($e=>({CODE:$e.code,CODE_NM:$e.name}));xe(It)}if(Nt.success&&Nt.data){const gt=Nt.data.filter(It=>It.code&&It.code!=="[]"&&It.name!=="").map(It=>({CODE:It.code,CODE_NM:It.name,ref_code:It.ref_code2||""}));se(gt)}if(Oe.success&&Oe.data){const gt=Oe.data.filter(It=>It.code&&It.code!=="[]"&&It.name!=="").map(It=>({CODE:It.code,CODE_NM:It.name,ref_code:It.ref_code}));be(gt)}}catch(ue){console.error("Load codes error:",ue)}finally{Ge(!1)}},qe=async()=>{if(!n){S([]),k([]);return}At(!0);try{const[ue,we]=await Promise.all([m1(n.custId,void 0,10),g1(n.custId,void 0,10)]),Je=ue.success&&ue.data?ue.data:[],Pe=we.success&&we.data?we.data:[];S(Je),k(Pe)}catch(ue){console.error("Load all history error:",ue)}finally{At(!1)}},Ee=async()=>{if(!n||!r){m([]),p([]);return}At(!0);try{const[ue,we]=await Promise.all([m1(n.custId,r.ctrtId,10),g1(n.custId,r.ctrtId,10)]);ue.success&&ue.data&&m(ue.data),we.success&&we.data&&p(we.data)}catch(ue){console.error("Load history error:",ue)}finally{At(!1)}},Ye=async()=>{if(!n){it("warning","","  .");return}if(!r){it("warning","",`   .
     .`);return}if(!Y.cnslSClCd){it("warning",""," .");return}if(!Y.reqCntn.trim()){it("warning",""," .");return}xt(!0);try{const ue={CUST_ID:n.custId,CTRT_ID:(r==null?void 0:r.ctrtId)||"",CNSL_MST_CL:Y.cnslLClCd,CNSL_MID_CL:Y.cnslMClCd,CNSL_SLV_CL:Y.cnslSClCd,REQ_CTX:Y.reqCntn,POST_ID:(r==null?void 0:r.postId)||"",SAVE_TP:"2",CNSL_RSLT:"5",RCPT_TP:"G1",CUST_REL:"A",PRESS_RCPT_YN:"N",SUBS_TP:"1",CTI_CID:"0",SO_ID:"",MST_SO_ID:""},we=await P4(ue);we.success?(it("success","  ","  ."),ee({cnslLClCd:"",cnslMClCd:"",cnslSClCd:"",reqCntn:"",transYn:"N",transDeptCd:""}),setCnslMCodes([]),setCnslSCodes([]),Ee(),qe()):it("error","  ",we.message||"  .")}catch(ue){console.error("Register consultation error:",ue),it("error","","    .")}finally{xt(!1)}},pe=async()=>{var ue,we,Je,Pe;if(!n){it("warning","","  .");return}if(G==="subscriber"&&!r){it("warning",""," AS    .");return}if(!ie.asClCd){it("warning","","AS .");return}if(!ie.asResnLCd){it("warning","","AS() .");return}if(De.length>0&&!ie.asResnMCd){it("warning","","AS() .");return}if(!ie.asCntn.trim()){it("warning","","AS  .");return}xt(!0);try{const Nt=JSON.parse(localStorage.getItem("userInfo")||"{}"),Oe=G==="subscriber",dt=Oe?null:i.find($t=>$t.CTRT_STAT_CD==="82"||$t.CTRT_STAT_CD==="80")||i[0],gt=Oe?i.find($t=>$t.CTRT_ID===(r==null?void 0:r.ctrtId)):dt,It={CUST_ID:n.custId,CTRT_ID:Oe&&(r==null?void 0:r.ctrtId)||"",POST_ID:Oe?(r==null?void 0:r.postId)||"":(dt==null?void 0:dt.POST_ID)||"",INST_ADDR:Oe&&(r==null?void 0:r.instAddr)||"",AS_CL_CD:ie.asClCd,AS_RESN_L_CD:ie.asResnLCd,AS_RESN_M_CD:ie.asResnMCd,AS_CNTN:ie.asCntn,SCHD_DT:ie.schdDt.replace(/-/g,""),SCHD_TM:ie.schdHour+ie.schdMin,WRKR_ID:Nt.userId||"",PG_GUBUN:"1",SO_ID:Oe?(r==null?void 0:r.soId)||"":(dt==null?void 0:dt.SO_ID)||((we=(ue=Nt.authSoList)==null?void 0:ue[0])==null?void 0:we.SO_ID)||((Pe=(Je=Nt.authSoList)==null?void 0:Je[0])==null?void 0:Pe.soId)||Nt.soId||Nt.SO_ID||"",MST_SO_ID:"",BLD_CL:(gt==null?void 0:gt.BLD_CL)||"",BLD_NM:(gt==null?void 0:gt.BLD_NM)||"",BLD_ID:(gt==null?void 0:gt.BLD_ID)||"",BUN_CL:(gt==null?void 0:gt.BUN_CL)||"",BUN_NO:(gt==null?void 0:gt.BUN_NO)||"",HO_NM:(gt==null?void 0:gt.HO_NM)||"",APT_DONG_NO:(gt==null?void 0:gt.APT_DONG_NO)||"",APT_HO_CNT:(gt==null?void 0:gt.APT_HO_CNT)||"",ADDR_DTL:(gt==null?void 0:gt.ADDR_DTL)||"",ADDR:(gt==null?void 0:gt.INST_ADDR)||(gt==null?void 0:gt.ADDR_FULL)||"",ADDR_ORD:"1"},$e=await bV(It);$e.success?(it("success","AS  ","AS  ."),Ne({asClCd:"",asClDtlCd:"",asResnLCd:"",asResnMCd:"",asCntn:"",schdDt:new Date().toISOString().split("T")[0],schdHour:_e(),schdMin:"00"}),re([]),Ee(),qe()):it("error","AS  ",$e.message||"AS  .")}catch(Nt){console.error("Register AS error:",Nt),it("error","","AS    .")}finally{xt(!1)}};return n?s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-1 flex gap-1",children:[s.jsxs("button",{onClick:()=>u("consultation"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg transition-colors text-sm ${c==="consultation"?"bg-blue-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(iE,{className:"w-4 h-4"}),""]}),s.jsxs("button",{onClick:()=>u("as"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg transition-colors text-sm ${c==="as"?"bg-orange-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(Gu,{className:"w-4 h-4"}),"AS"]})]}),c==="consultation"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[s.jsx(iE,{className:"w-5 h-5 text-blue-500"})," "]}),s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("span",{className:"font-medium",children:n.custNm}),s.jsxs("span",{className:"ml-1 text-blue-600 text-xs",children:["(ID: ",cp(n.custId),")"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"targetUnit",value:"customer",checked:P==="customer",onChange:()=>A("customer"),className:"w-3.5 h-3.5 text-blue-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"targetUnit",value:"contract",checked:P==="contract",onChange:()=>A("contract"),className:"w-3.5 h-3.5 text-blue-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]})]})]}),P==="contract"&&r&&s.jsxs("div",{className:"text-xs text-blue-700 pt-1 border-t border-blue-200 space-y-0.5",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{className:"font-medium",children:r.prodNm})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:"ID"}),s.jsx("span",{children:cp(r.ctrtId)})]}),r.instAddr&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.instAddr})]}),r.notrecev&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-blue-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.notrecev})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:Y.cnslSClCd,onChange:ue=>ae(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:""}),$.map(ue=>s.jsx("option",{value:ue.code,children:ue.name},ue.code))]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",readOnly:!0,value:((ge=ce.find(ue=>ue.code===Y.cnslLClCd))==null?void 0:ge.name)||"",placeholder:" ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-600"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",readOnly:!0,value:((Be=O.find(ue=>ue.code===Y.cnslMClCd))==null?void 0:Be.name)||"",placeholder:" ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-600"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" *"}),s.jsx("textarea",{value:Y.reqCntn,onChange:ue=>ee(we=>({...we,reqCntn:ue.target.value})),placeholder:" .",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"transYn",checked:Y.transYn==="Y",onChange:ue=>ee(we=>({...we,transYn:ue.target.checked?"Y":"N"})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"transYn",className:"text-sm text-gray-600",children:"  (/ )"})]}),s.jsx("button",{onClick:Ye,disabled:at,className:"w-full flex items-center justify-center gap-2 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 transition-colors",children:at?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(X2,{className:"w-5 h-5"})," "]})})]}),c==="as"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[s.jsx(Gu,{className:"w-5 h-5 text-orange-500"}),"AS "]}),s.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"text-sm text-orange-800",children:[s.jsx("span",{className:"font-medium",children:n.custNm}),s.jsxs("span",{className:"ml-1 text-orange-600 text-xs",children:["(ID: ",cp(n.custId),")"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"asSubscriberType",value:"subscriber",checked:G==="subscriber",onChange:()=>B("subscriber"),className:"w-3.5 h-3.5 text-orange-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]}),s.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"asSubscriberType",value:"nonSubscriber",checked:G==="nonSubscriber",onChange:()=>B("nonSubscriber"),className:"w-3.5 h-3.5 text-orange-600"}),s.jsx("span",{className:"text-xs text-gray-700",children:""})]})]})]}),G==="subscriber"&&r&&s.jsxs("div",{className:"text-xs text-orange-700 pt-1 border-t border-orange-200 space-y-0.5",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{className:"font-medium",children:r.prodNm})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:"ID"}),s.jsx("span",{children:cp(r.ctrtId)})]}),r.instAddr&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.instAddr})]}),r.notrecev&&s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-orange-500 w-14 flex-shrink-0",children:""}),s.jsx("span",{children:r.notrecev})]})]}),G==="nonSubscriber"&&s.jsx("div",{className:"text-xs text-orange-600 pt-1 border-t border-orange-200",children:" AS -   ."})]}),G==="subscriber"&&!r?s.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vr,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"AS    "}),s.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"      AS  ."}),s.jsx("button",{onClick:a,className:"mt-2 text-sm text-yellow-700 underline hover:text-yellow-800",children:"   "})]})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"AS *"}),s.jsxs("select",{value:ie.asClCd,onChange:ue=>Ne(we=>({...we,asClCd:ue.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[s.jsx("option",{value:"",children:""}),X.map(ue=>s.jsx("option",{value:ue.CODE,children:ue.CODE_NM},ue.CODE))]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"AS() *"}),s.jsxs("select",{value:ie.asResnLCd,onChange:ue=>ve(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[s.jsx("option",{value:"",children:""}),me.map(ue=>s.jsx("option",{value:ue.CODE,children:ue.CODE_NM},ue.CODE))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["AS() ",De.length>0?"*":""]}),s.jsxs("select",{value:ie.asResnMCd,onChange:ue=>Ne(we=>({...we,asResnMCd:ue.target.value})),disabled:!ie.asResnLCd||De.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 disabled:bg-gray-100",children:[s.jsx("option",{value:"",children:De.length===0?"":""}),De.map(ue=>s.jsx("option",{value:ue.CODE,children:ue.CODE_NM},ue.CODE))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"AS  *"}),s.jsx("textarea",{value:ie.asCntn,onChange:ue=>Ne(we=>({...we,asCntn:ue.target.value})),placeholder:"AS  .",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:" *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",value:ie.schdDt,onChange:ue=>Ne(we=>({...we,schdDt:ue.target.value})),min:new Date().toISOString().split("T")[0],className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),s.jsx("select",{value:ie.schdHour,onChange:ue=>Ne(we=>({...we,schdHour:ue.target.value})),className:"w-20 px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:et.map(ue=>s.jsx("option",{value:ue.value,children:ue.label},ue.value))}),s.jsx("select",{value:ie.schdMin,onChange:ue=>Ne(we=>({...we,schdMin:ue.target.value})),className:"w-20 px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:Dt.map(ue=>s.jsx("option",{value:ue.value,children:ue.label},ue.value))})]})]}),s.jsx("button",{onClick:pe,disabled:at,className:"w-full flex items-center justify-center gap-2 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:bg-gray-400 transition-colors",children:at?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gu,{className:"w-5 h-5"}),"AS "]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between p-4",children:[s.jsxs("button",{onClick:()=>nt(!Fe),className:"flex items-center gap-2 flex-1 text-left",children:[s.jsx($h,{className:"w-5 h-5 text-gray-500"}),s.jsx("span",{className:"font-medium text-gray-800",children:c==="consultation"?" ":" "}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",c==="consultation"?lt.length:Mt.length,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1 mr-1",children:[s.jsx("button",{onClick:ue=>{ue.stopPropagation(),C("byDate"),y.length===0&&v.length===0&&qe()},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${g==="byDate"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""}),s.jsx("button",{onClick:ue=>{ue.stopPropagation(),C("byContract"),r!=null&&r.ctrtId&&Ee()},className:`px-2 py-0.5 text-xs rounded-full transition-colors ${g==="byContract"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:""})]}),s.jsx("button",{onClick:ue=>{ue.stopPropagation(),qe()},className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(Oc,{className:`w-4 h-4 ${ot?"animate-spin":""}`})}),s.jsx("button",{onClick:()=>nt(!Fe),children:Fe?s.jsx(kr,{className:"w-5 h-5 text-gray-400"}):s.jsx(ir,{className:"w-5 h-5 text-gray-400"})})]})]}),Fe&&s.jsx("div",{className:"px-4 pb-4",children:ot?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(On,{className:"w-6 h-6 animate-spin text-gray-400"})}):g==="byContract"&&!r?s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."}):c==="consultation"?lt.length>0?s.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:lt.map((ue,we)=>{var Je;return s.jsxs("div",{className:"bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"p-3 cursor-pointer flex items-center justify-between",onClick:()=>j(we),children:[s.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs flex-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:ue.CTRT_ID||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.START_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:ue.CNSL_SLV_CL_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(Je=ue.CNSL_RSLT)!=null&&Je.includes("")?"text-green-600":"text-yellow-600"}`,children:ue.CNSL_RSLT||""})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.RCPT_NM||"-"})]})]}),J.has(we)?s.jsx(kr,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"})]}),J.has(we)&&s.jsxs("div",{className:"px-3 pb-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ue.REQ_CTX||"-"})]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-1",children:""}),s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ue.PROC_CT||"-"})]})]})]},we)})}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."}):Mt.length>0?s.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:Mt.map((ue,we)=>{var Je,Pe;return s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-sm border border-gray-100",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:"ID"}),s.jsx("span",{className:"text-gray-800 font-medium text-[10px]",children:ue.CTRT_ID||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.HOPE_DT||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.WRK_CD_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:`font-medium ${(Je=ue.WRK_STAT_CD_NM)!=null&&Je.includes("")?"text-green-600":(Pe=ue.WRK_STAT_CD_NM)!=null&&Pe.includes("")?"text-blue-600":"text-gray-800"}`,children:ue.WRK_STAT_CD_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-center",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium truncate",children:ue.PROD_NM||"-"})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.CMPL_DATE||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.WRK_NM||"-"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800 font-medium",children:ue.WRK_CRR_NM||"-"})]})]}),s.jsxs("div",{className:"mt-2 grid grid-cols-[auto_1fr] gap-2 text-xs items-start",children:[s.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:""}),s.jsx("span",{className:"text-gray-800",children:ue.CTRT_ADDR||"-"})]}),s.jsxs("div",{className:"mt-3 cursor-pointer",onClick:()=>te(we),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"text-xs text-gray-500",children:""}),V.has(we)?s.jsx(kr,{className:"w-3.5 h-3.5 text-gray-400"}):s.jsx(ir,{className:"w-3.5 h-3.5 text-gray-400"})]}),V.has(we)&&s.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded min-h-[48px] text-gray-700 text-xs",children:ue.MEMO||"-"})]})]},we)})}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."})})]})]}),mt.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${mt.type==="success"?"bg-green-100":mt.type==="error"?"bg-red-100":"bg-yellow-100"}`,children:mt.type==="success"?s.jsx(ea,{className:"w-5 h-5 text-green-500"}):mt.type==="error"?s.jsx(tc,{className:"w-5 h-5 text-red-500"}):s.jsx(Vr,{className:"w-5 h-5 text-yellow-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:mt.title})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-5",children:mt.message}),s.jsx("button",{onClick:()=>Ve(ue=>({...ue,show:!1})),className:`w-full px-4 py-2 text-sm text-white rounded-lg transition-colors ${mt.type==="success"?"bg-green-500 hover:bg-green-600":mt.type==="error"?"bg-red-500 hover:bg-red-600":"bg-yellow-500 hover:bg-yellow-600"}`,children:""})]})}),I&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-5 max-w-sm mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx($h,{className:"w-5 h-5 text-blue-500"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900",children:"  "})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-5",children:["       .",s.jsx("br",{}),"    ?"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:""}),s.jsx("button",{onClick:()=>{E(!1),a()},className:"flex-1 px-4 py-2 text-sm text-white bg-blue-500 rounded-lg hover:bg-blue-600 transition-colors",children:" "})]})]})})]}):s.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(Vr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"  "}),s.jsxs("p",{className:"text-gray-500 mb-4",children:["     ",s.jsx("br",{}),"/AS   ."]}),s.jsxs("button",{onClick:a,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[s.jsx(H2,{className:"w-4 h-4 inline mr-2"})," "]})]})})},dp=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},yg=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===8?`${e.substring(0,4)}-${e.substring(4,6)}-${e.substring(6,8)}`:t},aq=({onBack:t,showToast:e,selectedCustomer:n,selectedContract:r,contracts:i,onNavigateToBasicInfo:a})=>{const o=i.filter(j=>{const te=!["",""].some(O=>(j.CTRT_STAT_NM||"").includes(O)),ce=j.CLOSE_DANGER==="Y",R=(j.CTRT_STAT_NM||"").includes("");return te&&ce&&R}),[c,u]=b.useState(new Set),[h,m]=b.useState({}),[_,p]=b.useState(new Set),[g,C]=b.useState([]),[y,S]=b.useState([]),[v,k]=b.useState([]),[L,M]=b.useState(!1),[P,F]=b.useState({promChgCd:"05",promChgrsnCd:"",promCnt:"",startDate:"",endDate:""}),[G,B]=b.useState(!1),[I,E]=b.useState(null),[A,Y]=b.useState({show:!1,success:!1,message:""}),ee=b.useCallback(async()=>{if(!L)try{const[j,te,ce]=await Promise.all([VV(),$V(),zV()]),R=(O,U)=>{if(O.success&&O.data){const Q=O.data.map(q=>({CODE:q.code||q.CODE||"",CODE_NM:q.name||q.CODE_NM||""})).filter(q=>q.CODE);return Q.length>0?Q:U}return U};C(R(j,[{CODE:"0",CODE_NM:""},{CODE:"12",CODE_NM:"12"},{CODE:"24",CODE_NM:"24"},{CODE:"36",CODE_NM:"36"},{CODE:"48",CODE_NM:"48"},{CODE:"60",CODE_NM:"60"}])),S(R(te,[{CODE:"A",CODE_NM:""},{CODE:"B",CODE_NM:""},{CODE:"C",CODE_NM:""},{CODE:"D",CODE_NM:""}])),k(R(ce,[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""}])),M(!0)}catch(j){console.error("Code loading failed:",j),C([{CODE:"0",CODE_NM:""},{CODE:"12",CODE_NM:"12"},{CODE:"24",CODE_NM:"24"},{CODE:"36",CODE_NM:"36"},{CODE:"48",CODE_NM:"48"},{CODE:"60",CODE_NM:"60"}]),S([{CODE:"A",CODE_NM:""},{CODE:"B",CODE_NM:""},{CODE:"C",CODE_NM:""},{CODE:"D",CODE_NM:""}]),k([{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""},{CODE:"05",CODE_NM:""}]),M(!0)}},[L]);b.useEffect(()=>{ee()},[ee]),b.useEffect(()=>{r&&o.some(te=>te.CTRT_ID===r.ctrtId)&&(u(new Set([r.ctrtId])),E(r.ctrtId),J(r.ctrtId))},[r==null?void 0:r.ctrtId]);const J=async j=>{if(!(h[j]!==void 0||_.has(j))){p(te=>new Set(te).add(j));try{const te=await QV(j);te.success&&te.data&&te.data.length>0?m(ce=>({...ce,[j]:te.data[0]})):m(ce=>({...ce,[j]:null}))}catch{m(ce=>({...ce,[j]:null}))}finally{p(te=>{const ce=new Set(te);return ce.delete(j),ce})}}},H=()=>{c.size===o.length?u(new Set):u(new Set(o.map(j=>j.CTRT_ID)))},V=j=>{const te=new Set(c);te.has(j)?te.delete(j):(te.add(j),J(j)),u(te)};b.useEffect(()=>{if(P.startDate&&P.promCnt&&P.promCnt!=="0"){const j=parseInt(P.promCnt,10);if(!isNaN(j)&&j>0){const te=P.startDate.replace(/[^0-9]/g,"");if(te.length===8){const ce=parseInt(te.substring(0,4),10),R=parseInt(te.substring(4,6),10)-1,O=parseInt(te.substring(6,8),10),U=new Date(ce,R+j,O-1),Q=`${U.getFullYear()}${String(U.getMonth()+1).padStart(2,"0")}${String(U.getDate()).padStart(2,"0")}`;F(q=>({...q,endDate:Q}))}}}else P.promCnt==="0"&&F(j=>({...j,endDate:""}))},[P.startDate,P.promCnt]);const K=async()=>{if(!n)return;if(c.size===0){e==null||e("  .","warning");return}if(!P.promChgCd||!P.promCnt||!P.promChgrsnCd||!P.startDate){e==null||e("   .","warning");return}B(!0);let j=0,te=0;const ce=[];for(const R of c)try{const O=h[R],U={CUST_ID:n.custId,CTRT_ID:R,RCPT_ID:(O==null?void 0:O.RCPT_ID)||"",WRK_ID:"",AGREE_YN:"Y",AGREE_GB:P.promChgrsnCd,AGREE_SIGN:"",WRK_CD:P.promChgCd},Q=await YV(U);Q.success?j++:(te++,ce.push(`${dp(R)}: ${Q.message||""}`))}catch{te++,ce.push(`${dp(R)}:  `)}B(!1),Y(te===0?{show:!0,success:!0,message:`${j}  .`}:{show:!0,success:!1,message:` ${j},  ${te}

${ce.join(`
`)}`}),u(new Set),F(R=>({...R,promChgrsnCd:"",promCnt:"",endDate:""})),m({})};return n?s.jsxs("div",{className:"h-full overflow-y-auto p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[s.jsx(Oc,{className:"w-5 h-5 text-purple-500"})," "]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[" ",o.length,""]})]}),s.jsx("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:s.jsxs("div",{className:"text-sm text-purple-800",children:[s.jsx("span",{className:"font-medium",children:n.custNm}),s.jsxs("span",{className:"ml-1 text-purple-600 text-xs",children:["(ID: ",dp(n.custId),")"]})]})}),o.length===0?s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 text-center",children:[s.jsx(Vr,{className:"w-10 h-10 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"   ."}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"()     ."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer border border-purple-200",children:[s.jsx("input",{type:"checkbox",checked:c.size===o.length,onChange:H,className:"w-5 h-5 rounded border-gray-300 text-purple-600 focus:ring-purple-500",disabled:G}),s.jsxs("span",{className:"flex-1 font-medium text-purple-700",children:["  (",o.length,")"]}),s.jsxs("span",{className:"text-xs text-purple-500",children:[c.size," "]})]}),s.jsx("div",{className:"space-y-2",children:o.map(j=>{const te=c.has(j.CTRT_ID),ce=I===j.CTRT_ID,R=h[j.CTRT_ID],O=_.has(j.CTRT_ID);return s.jsxs("div",{className:`rounded-lg border transition-all ${te?"bg-purple-50 border-purple-300":"bg-white border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-3 p-3",children:[s.jsx("input",{type:"checkbox",checked:te,onChange:()=>V(j.CTRT_ID),className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500",disabled:G}),s.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>{E(ce?null:j.CTRT_ID),ce||J(j.CTRT_ID)},children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:j.PROD_NM||" "}),s.jsx("span",{className:"text-xs text-orange-600 bg-orange-100 px-1.5 py-0.5 rounded-full flex-shrink-0 ml-1",children:""})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[dp(j.CTRT_ID),j.AGMT_END_DT&&` | : ${yg(j.AGMT_END_DT)}`]})]}),s.jsx("button",{onClick:()=>{E(ce?null:j.CTRT_ID),ce||J(j.CTRT_ID)},className:"flex-shrink-0",children:ce?s.jsx(kr,{className:"w-4 h-4 text-gray-400"}):s.jsx(ir,{className:"w-4 h-4 text-gray-400"})})]}),ce&&s.jsx("div",{className:"px-3 pb-3 pt-1 border-t border-gray-100",children:O?s.jsxs("div",{className:"flex items-center justify-center py-3",children:[s.jsx(On,{className:"w-4 h-4 animate-spin text-purple-500"}),s.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"  ..."})]}):R?s.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{className:R.PROM_YN==="Y"?"text-green-600 font-medium":"text-gray-600",children:R.PROM_YN==="Y"?"":""})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{className:"font-medium",children:R.PROM_CNT_NM||R.PROM_CNT||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:yg(R.CTRT_APLY_STRT_DT)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:yg(R.CTRT_APLY_END_DT)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:R.PROM_CHG_CD_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:":"})," ",s.jsx("span",{children:R.PROM_CHGRSN_CD_NM||"-"})]})]}):s.jsx("div",{className:"text-xs text-gray-400 text-center py-2",children:" "})})]},j.CTRT_ID)})}),c.size>0&&s.jsxs("div",{className:"bg-white rounded-lg border border-purple-300 p-4 space-y-3 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-purple-700",children:[s.jsx($h,{className:"w-4 h-4"}),"  (",c.size,")"]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:P.promChgCd,onChange:j=>F(te=>({...te,promChgCd:j.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:""}),v.map(j=>s.jsx("option",{value:j.CODE,children:j.CODE_NM},j.CODE))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:P.promChgrsnCd,onChange:j=>F(te=>({...te,promChgrsnCd:j.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:""}),y.map(j=>s.jsx("option",{value:j.CODE,children:j.CODE_NM},j.CODE))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsxs("select",{value:P.promCnt,onChange:j=>F(te=>({...te,promCnt:j.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:""}),g.map(j=>s.jsx("option",{value:j.CODE,children:j.CODE_NM},j.CODE))]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:" *"}),s.jsx("input",{type:"date",value:P.startDate?yg(P.startDate):"",onChange:j=>{const te=j.target.value.replace(/-/g,"");F(ce=>({...ce,startDate:te}))},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:P.endDate?yg(P.endDate):"-",readOnly:!0,className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg bg-gray-50 text-gray-600"})]})]}),s.jsx("button",{onClick:K,disabled:G||!P.promChgCd||!P.promCnt||!P.promChgrsnCd||!P.startDate,className:`w-full flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-bold transition-colors ${G||!P.promChgCd||!P.promCnt||!P.promChgrsnCd||!P.startDate?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-500 hover:bg-purple-600 text-white"}`,children:G?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-4 h-4 animate-spin"}),"  ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(X2,{className:"w-4 h-4"}),"   (",c.size,")"]})})]})]}),A.show&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-sm w-full p-6",children:s.jsxs("div",{className:"flex flex-col items-center text-center",children:[A.success?s.jsx(ea,{className:"w-12 h-12 text-green-500 mb-3"}):s.jsx(tc,{className:"w-12 h-12 text-red-500 mb-3"}),s.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:A.success?" ":" "}),s.jsx("p",{className:"text-sm text-gray-600 mb-4 whitespace-pre-line",children:A.message}),s.jsx("button",{onClick:()=>Y({show:!1,success:!1,message:""}),className:`w-full py-2.5 rounded-lg text-sm font-bold text-white ${A.success?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600"}`,children:""})]})})})]}):s.jsx("div",{className:"h-full overflow-y-auto p-4",children:s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vr,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"  ."}),s.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"       ."}),s.jsx("button",{onClick:a,className:"mt-2 text-xs text-blue-600 hover:text-blue-800 underline",children:" "})]})]})})})},lq=({onBack:t,showToast:e})=>{const[n,r]=b.useState({custNm:"",juminNo1:"",juminNo2:"",custTpCd:"01",telNo:"",hpNo:"",addr:""}),[i,a]=b.useState([]),[o,c]=b.useState(!1),[u,h]=b.useState(!1),[m,_]=b.useState(!1),[p,g]=b.useState(!1),[C,y]=b.useState({});b.useEffect(()=>{S()},[]);const S=async()=>{c(!0);try{const F=await MV();F.success&&F.data&&a(F.data)}catch(F){console.error("Load customer type codes error:",F)}finally{c(!1)}},v=(F,G)=>{r(B=>({...B,[F]:G})),C[F]&&y(B=>({...B,[F]:""})),(F==="juminNo1"||F==="juminNo2")&&g(!1)},k=()=>{const F={};return n.custNm.trim()?n.custNm.length<2&&(F.custNm=" 2  ."):F.custNm=" .",n.custTpCd!=="04"&&((!n.juminNo1||n.juminNo1.length!==6)&&(F.juminNo1="  6 ."),(!n.juminNo2||n.juminNo2.length!==7)&&(F.juminNo2="  7 .")),n.hpNo&&n.hpNo.length<10&&(F.hpNo="   ."),y(F),Object.keys(F).length===0},L=async()=>{if(n.custTpCd==="04"){g(!0),e==null||e("    .","info");return}if(!n.custNm||!n.juminNo1||!n.juminNo2){e==null||e("  .","warning");return}_(!0);try{await new Promise(F=>setTimeout(F,1500)),g(!0),e==null||e(" .","success")}catch(F){console.error("Verify error:",F),e==null||e(" .","error"),g(!1)}finally{_(!1)}},M=async()=>{if(!k()){e==null||e("  .","warning");return}if(n.custTpCd!=="04"&&!p){e==null||e("  .","warning");return}h(!0);try{const F={CUST_NM:n.custNm,JUMIN_NO:n.juminNo1+n.juminNo2,CUST_TP_CD:n.custTpCd,TEL_NO:n.telNo||void 0,HP_NO:n.hpNo||void 0,ADDR:n.addr||void 0},G=await CV(F);G.success?(e==null||e(" .","success"),r({custNm:"",juminNo1:"",juminNo2:"",custTpCd:"01",telNo:"",hpNo:"",addr:""}),g(!1)):e==null||e(G.message||"  .","error")}catch(F){console.error("Create customer error:",F),e==null||e("    .","error")}finally{h(!1)}},P=()=>{r({custNm:"",juminNo1:"",juminNo2:"",custTpCd:"01",telNo:"",hpNo:"",addr:""}),y({}),g(!1)};return s.jsx("div",{className:"h-full overflow-y-auto bg-gray-50",children:s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(TP,{className:"w-6 h-6 text-teal-500"}),s.jsx("h2",{className:"text-lg font-medium text-gray-800",children:" "})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"  .     ."})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" *"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:(i.length>0?i:[{CODE:"01",CODE_NM:""},{CODE:"02",CODE_NM:""},{CODE:"03",CODE_NM:""},{CODE:"04",CODE_NM:""}]).map(F=>s.jsx("button",{onClick:()=>{v("custTpCd",F.CODE),g(!1)},className:`py-2 px-3 text-sm rounded-lg border transition-colors ${n.custTpCd===F.CODE?"bg-teal-500 text-white border-teal-500":"bg-white text-gray-600 border-gray-300 hover:border-gray-400"}`,children:F.CODE_NM},F.CODE))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),s.jsxs("div",{className:"relative",children:[s.jsx(o0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:n.custNm,onChange:F=>v("custNm",F.target.value),placeholder:" ",className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${C.custNm?"border-red-300":"border-gray-300"}`})]}),C.custNm&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:C.custNm})]}),n.custTpCd!=="04"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:n.juminNo1,onChange:F=>v("juminNo1",F.target.value.replace(/[^0-9]/g,"")),placeholder:" 6",maxLength:6,className:`flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${C.juminNo1?"border-red-300":"border-gray-300"}`}),s.jsx("span",{className:"text-gray-400",children:"-"}),s.jsx("input",{type:"password",value:n.juminNo2,onChange:F=>v("juminNo2",F.target.value.replace(/[^0-9]/g,"")),placeholder:" 7",maxLength:7,className:`flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${C.juminNo2?"border-red-300":"border-gray-300"}`}),s.jsx("button",{onClick:L,disabled:m||p,className:`px-4 py-2 rounded-lg transition-colors whitespace-nowrap ${p?"bg-green-100 text-green-700":"bg-teal-500 text-white hover:bg-teal-600 disabled:bg-gray-400"}`,children:m?s.jsx(On,{className:"w-5 h-5 animate-spin"}):p?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(jc,{className:"w-4 h-4"}),""]}):""})]}),(C.juminNo1||C.juminNo2)&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:C.juminNo1||C.juminNo2})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(VC,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"tel",value:n.hpNo,onChange:F=>v("hpNo",F.target.value.replace(/[^0-9]/g,"")),placeholder:"01012345678",maxLength:11,className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${C.hpNo?"border-red-300":"border-gray-300"}`})]}),C.hpNo&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:C.hpNo})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(VC,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"tel",value:n.telNo,onChange:F=>v("telNo",F.target.value.replace(/[^0-9]/g,"")),placeholder:"0212345678",maxLength:11,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsxs("div",{className:"relative",children:[s.jsx(Ed,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),s.jsx("textarea",{value:n.addr,onChange:F=>v("addr",F.target.value),placeholder:" ",rows:2,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 resize-none"})]})]}),n.custTpCd!=="04"&&!p&&s.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vr,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-700",children:["    .",s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:"   ."})]})]})}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsxs("button",{onClick:P,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(Mi,{className:"w-5 h-5"}),""]}),s.jsx("button",{onClick:M,disabled:u||n.custTpCd!=="04"&&!p,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-teal-500 text-white rounded-lg hover:bg-teal-600 disabled:bg-gray-400 transition-colors",children:u?s.jsxs(s.Fragment,{children:[s.jsx(On,{className:"w-5 h-5 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(oP,{className:"w-5 h-5"})," "]})})]})]})]})})},oq=({onNavigateToMenu:t,showToast:e})=>{const[n,r]=b.useState("basic-info"),[i,a]=b.useState(null),[o,c]=b.useState(null),[u,h]=b.useState("phone"),[m,_]=b.useState(""),[p,g]=b.useState(!1),[C,y]=b.useState(null),[S,v]=b.useState(""),[k,L]=b.useState(!1),[M,P]=b.useState([]),[F,G]=b.useState([]),[B,I]=b.useState([]),[E,A]=b.useState(""),[Y,ee]=b.useState("consultation"),J=[{id:"basic-info",title:"",description:"    "},{id:"info-change",title:"",description:"/ "},{id:"consultation-as",title:"/AS",description:", AS"},{id:"re-contract",title:"",description:" /"}],H=Q=>{r(Q)},V=Q=>{P([]),G([]),I([]),A(""),a(null),setTimeout(()=>{a(Q),c(null)},0)},K=()=>{a(null),c(null),P([]),G([]),I([]),A("")},j=(Q,q,$,de)=>{A(Q),P(q),G($),I(de)},te=Q=>{c(Q)},ce=async()=>{if(i)try{const Q=await J1(i.CUST_ID);if(Q.success&&Q.data&&(P(Q.data),A(i.CUST_ID),o)){const q=Q.data.find($=>$.CTRT_ID===o.ctrtId);q&&c({ctrtId:q.CTRT_ID,prodNm:q.PROD_NM,instAddr:q.INST_ADDR,streetAddr:q.STREET_ADDR_FULL,instlLoc:q.INSTL_LOC,postId:q.POST_ID,notrecev:q.NOTRECEV,soId:q.SO_ID,prodGrp:q.PROD_GRP})}}catch(Q){console.error("Failed to refresh contracts after address change:",Q)}},R=Q=>{r(Q)},O=Q=>{h("payment"),_(Q),r("info-change")},U=()=>{switch(n){case"info-change":return s.jsx(sq,{onBack:t,showToast:e,selectedCustomer:i?{custId:i.CUST_ID,custNm:i.CUST_NM,telNo:i.TEL_NO||"",hpNo:i.HP_NO||"",phoneList:i.PHONE_LIST}:null,selectedContract:o,initialSection:u,initialPymAcntId:m,onPaymentChangeStart:()=>g(!0),onPaymentChangeEnd:()=>{g(!1),y(null),v(""),L(!1)},savedPaymentForm:C,savedPymAcntId:S,savedIsVerified:k,onPaymentFormChange:(Q,q,$)=>{y(Q),v(q),L($)},onAddressChanged:ce});case"consultation-as":return s.jsx(iq,{onBack:t,showToast:e,selectedCustomer:i?{custId:i.CUST_ID,custNm:i.CUST_NM,telNo:i.TEL_NO||i.HP_NO||""}:null,selectedContract:o,contracts:M,onNavigateToBasicInfo:()=>R("basic-info"),initialTab:Y});case"re-contract":return s.jsx(aq,{onBack:t,showToast:e,selectedCustomer:i?{custId:i.CUST_ID,custNm:i.CUST_NM,telNo:i.TEL_NO||i.HP_NO||""}:null,selectedContract:o,contracts:M,onNavigateToBasicInfo:()=>R("basic-info")});case"customer-create":return s.jsx(lq,{onBack:t,showToast:e});default:return null}};return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 z-40",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-1",children:s.jsx(dS,{tabs:J,activeTab:n,onTabChange:H})}),p&&n!=="info-change"&&s.jsx("button",{onClick:()=>{h("payment"),r("info-change")},className:"flex-shrink-0 mr-2 px-3 py-1.5 text-sm bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-1",children:""})]})}),s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 p-3",children:s.jsx(rq,{onCustomerSelect:V,onCustomerClear:K,showToast:e,selectedCustomer:i})}),s.jsxs("div",{className:"flex-1 overflow-hidden",children:[s.jsx("div",{className:`h-full ${n==="basic-info"?"":"hidden"}`,children:s.jsx(tq,{onBack:t,showToast:e,onContractSelect:te,onNavigateToPaymentChange:O,onNavigateToConsultationAS:Q=>{ee(Q),r("consultation-as")},onNavigateToAddressChange:()=>{h("address"),r("info-change")},onNavigateToReContract:()=>{r("re-contract")},selectedCustomer:i,savedContract:o,cachedContracts:M,cachedConsultationHistory:F,cachedWorkHistory:B,cachedDataCustId:E,onDataLoaded:j,paymentChangeInProgress:p,onCancelPaymentChange:()=>{g(!1),y(null),v(""),L(!1)},currentWorkingPymAcntId:S})}),n!=="basic-info"&&U()]})]})},cq=!0,ty="[EQUIPMENT-MGT-DEBUG]",sy=[],dq=()=>{const t=new Date;return t.toLocaleTimeString("ko-KR",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})+"."+String(t.getMilliseconds()).padStart(3,"0")},IC=(t,e,n)=>{var a;const r={timestamp:dq(),component:t,action:e,...n};sy.push(r);const i=n!=null&&n.error?"color: #ff4444; font-weight: bold;":n!=null&&n.response?"color: #44aa44; font-weight: bold;":"color: #4488ff; font-weight: bold;";if(console.log(`%c${ty} [${r.timestamp}] ${t} - ${e}`,i),n!=null&&n.api&&console.log(`  API: ${n.api}`),n!=null&&n.params&&console.log("  Params:",n.params),(n==null?void 0:n.response)!==void 0){const o=JSON.stringify(n.response);o.length>500?(console.log("  Response (preview):",o.slice(0,500)+"..."),console.log("  Response (full):",n.response)):console.log("  Response:",n.response),Array.isArray(n.response)&&n.response.length===0&&console.warn("  WARNING: Empty array returned!"),(a=n.response)!=null&&a.data&&Array.isArray(n.response.data)&&n.response.data.length===0&&console.warn("  WARNING: response.data is empty array!")}n!=null&&n.error&&console.error("  Error:",n.error),n!=null&&n.duration&&console.log(`  Duration: ${n.duration}ms`)},Ei=async(t,e,n,r)=>{const i=Date.now();IC(t,`API_CALL_START: ${e}`,{api:e,params:r});try{const a=await n(),o=Date.now()-i;return IC(t,`API_CALL_SUCCESS: ${e}`,{api:e,response:a,duration:o}),a}catch(a){const o=Date.now()-i;throw IC(t,`API_CALL_FAILED: ${e}`,{api:e,error:a,duration:o}),a}},uq=()=>[...sy],hq=()=>{sy.length=0,console.log(`${ty} Logs cleared`)},fq=()=>{console.log(`
`+"=".repeat(70)),console.log(`${ty} API CALL SUMMARY`),console.log("=".repeat(70));const t=sy.filter(i=>i.api),e=t.filter(i=>i.response&&!i.error),n=t.filter(i=>i.error),r=t.filter(i=>{var a;return!!(Array.isArray(i.response)&&i.response.length===0||(a=i.response)!=null&&a.data&&Array.isArray(i.response.data)&&i.response.data.length===0)});console.log(`Total API calls: ${t.length}`),console.log(`Success: ${e.length}`),console.log(`Failed: ${n.length}`),console.log(`Empty responses: ${r.length}`),r.length>0&&(console.log(`
APIs returning empty:`),r.forEach(i=>{console.log(`  - ${i.api} (${i.component})`)})),n.length>0&&(console.log(`
Failed APIs:`),n.forEach(i=>{var a;console.log(`  - ${i.api}: ${((a=i.error)==null?void 0:a.message)||i.error}`)})),console.log("=".repeat(70)+`
`)};typeof window<"u"&&(window.eqtDebug={getLogs:uq,clear:hq,summary:fq,enabled:cq},console.log(`${ty} Debug utility loaded. Use window.eqtDebug.summary() to see summary.`));const kT=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}.${t.slice(4,6)}.${t.slice(6,8)}`:t.includes("-")?t.replace(/-/g,"."):t:"",mq=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",gq=typeof window<"u"&&window.location.hostname!=="localhost"?`${window.location.protocol}//${window.location.hostname}:8080/api`:"http://52.63.232.141:8080/api",_q=async()=>{try{const t=localStorage.getItem("branchList");if(t){const r=JSON.parse(t);if(Array.isArray(r)&&r.length>0)return console.log(" [] branchList   :",r.length,""),r}const e=localStorage.getItem("userInfo");if(e){const r=JSON.parse(e);if(r.authSoList&&Array.isArray(r.authSoList)&&r.authSoList.length>0)return console.log(" [] authSoList   :",r.authSoList.length,""),r.authSoList}console.log(" [] API    ...");const n=await fetch(`${gq}/statistics/equipment/getAuthSoList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({USR_ID:e?JSON.parse(e).userId:""})});if(n.ok){const r=await n.json();if(Array.isArray(r)&&r.length>0)return console.log(" [] API   :",r.length,""),localStorage.setItem("branchList",JSON.stringify(r)),r}return console.log(" []    -   "),[]}catch(t){return console.error(" []    :",t),[]}},xq=({onBack:t,showToast:e})=>{const r=(()=>{try{const ie=localStorage.getItem("userInfo");return ie?JSON.parse(ie):null}catch{return null}})(),i=()=>{const ie=new Date;return ie.setDate(ie.getDate()-7),ie.toISOString().slice(0,10).replace(/-/g,"")},[a,o]=b.useState(i()),[c,u]=b.useState(new Date().toISOString().slice(0,10).replace(/-/g,"")),[h,m]=b.useState((r==null?void 0:r.soId)||""),[_,p]=b.useState([]),[g,C]=b.useState(null),[y,S]=b.useState([]),[v,k]=b.useState([]);b.useEffect(()=>{(async()=>{const Ne=await _q();k(Ne)})()},[]),b.useEffect(()=>{p([]),C(null),S([])},[h]);const[L,M]=b.useState(!1),[P,F]=b.useState(!1),[G,B]=b.useState(!1),[I,E]=b.useState(null),[A,Y]=b.useState("simple"),[ee,J]=b.useState(new Set),H=b.useRef(null),V=ie=>ie.length===8?`${ie.slice(0,4)}-${ie.slice(4,6)}-${ie.slice(6,8)}`:ie,K=ie=>ie.replace(/-/g,""),j=async()=>{M(!0);try{let ie=[];if(!h&&v.length>0){console.log("[]     - ",v.length," ");const Ne=v.map(xe=>{const fe={FROM_OUT_REQ_DT:a,TO_OUT_REQ_DT:c,SO_ID:xe.SO_ID,PROC_STAT:"%"};return xE(fe).catch(()=>[])});ie=(await Promise.all(Ne)).flat(),console.log("[]     - ",ie.length,"")}else{const Ne={FROM_OUT_REQ_DT:a,TO_OUT_REQ_DT:c,SO_ID:h||(r==null?void 0:r.soId)||"209",PROC_STAT:"%"};ie=await Ei("EquipmentAssignment","getEquipmentOutList",()=>xE(Ne),Ne)||[]}if(ie.sort((Ne,X)=>(Ne.SO_NM||"").localeCompare(X.SO_NM||"")),ie.length===0)p([]),C(null),S([]),e==null||e("   .","info");else{const Ne=await Promise.all(ie.map(async X=>{try{const xe=await CE({OUT_REQ_NO:X.OUT_REQ_NO}),fe=Array.isArray(xe)?xe:xe.output1||[];if(fe.length===0)return{...X,_receiveStatus:"none",_receivedCount:0,_totalCount:0};const Z=fe.filter(Re=>Re.PROC_YN==="Y").length,le=fe.length;let se="none";return Z===le?se="received":Z>0&&(se="partial"),{...X,_receiveStatus:se,_receivedCount:Z,_totalCount:le}}catch{return{...X,_receiveStatus:"none",_receivedCount:0,_totalCount:0}}}));p(Ne),C(null),S([]),e==null||e(`${Ne.length}   .`,"success")}}catch(ie){console.error(" []  :",ie),e==null||e(ie.message||"  .","error")}finally{M(!1)}},te=ie=>{J(Ne=>{const X=new Set(Array.from(Ne));return X.has(ie)?X.delete(ie):X.add(ie),X})},ce=y.reduce((ie,Ne,X)=>{const xe=Ne.ITEM_MID_CD_NM||"";return ie[xe]||(ie[xe]=[]),ie[xe].push({...Ne,_idx:X}),ie},{});Object.keys(ce).forEach(ie=>{ce[ie].sort((Ne,X)=>{const xe=Ne.EQT_CL_NM||"",fe=X.EQT_CL_NM||"";return xe.localeCompare(fe)})});const R=Object.keys(ce).sort(),O=async ie=>{C(ie),F(!0);try{const Ne={OUT_REQ_NO:ie.OUT_REQ_NO},X=await Ei("EquipmentAssignment","getOutEquipmentTargetList",()=>CE(Ne),Ne),xe=Array.isArray(X)?X:X.output1||[];S(xe.map(fe=>({...fe,CHK:!1}))),xe.length===0&&(e==null||e("   .","info")),setTimeout(()=>{var fe;(fe=H.current)==null||fe.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(Ne){console.error(" []    :",Ne),e==null||e(Ne.message||"   .","error"),S([])}finally{F(!1)}},U=async()=>{if(console.log("[]  "),console.log("[] selectedEqtOut:",g),!g){e==null||e("  .","warning");return}const ie=y.filter(X=>X.CHK&&X.PROC_YN!=="Y");if(console.log("[]  :",ie.length,""),console.log("[]   :",ie),ie.length===0){e==null||e("   .","warning");return}const Ne=ie;console.log("[]  :",Ne.length,"");try{const X={OUT_REQ_NO:g.OUT_REQ_NO,SO_ID:g.SO_ID||(r==null?void 0:r.soId)||"",WRKR_ID:(r==null?void 0:r.userId)||"",CARRIER_ID:g.CRR_ID||(r==null?void 0:r.crrId)||"",CRR_ID:g.CRR_ID||(r==null?void 0:r.crrId)||"",equipmentList:Ne.map(xe=>({EQT_NO:xe.EQT_NO||"",EQT_SERNO:xe.EQT_SERNO||"",OUT_REQ_NO:xe.OUT_REQ_NO||"",PROC_YN:"Y",CHG_UID:(r==null?void 0:r.userId)||""}))};console.log("[] API  :",X),await Ei("EquipmentAssignment","addEquipmentQuota",()=>gA(X),X),e==null||e(`${Ne.length}   .`,"success"),await j()}catch(X){console.error(" []  :",X),e==null||e(X.message||" .","error")}},Q=ie=>{S(y.map(Ne=>{const X=Ne.PROC_YN==="Y",xe=Ne.EQT_SERNO&&Ne.EQT_SERNO.trim()!=="";return!X&&xe?{...Ne,CHK:ie}:Ne}))},q=(ie,Ne)=>{const X=[...y];X[ie].CHK=Ne,S(X)},$=(ie,Ne)=>{S(y.map(X=>{if((X.ITEM_MID_CD_NM||"")!==ie)return X;const fe=X.PROC_YN==="Y",Z=X.EQT_SERNO&&X.EQT_SERNO.trim()!=="";return!fe&&Z?{...X,CHK:Ne}:X}))},de=ie=>ie&&ie.length>=8?`${ie.slice(0,4)}-${ie.slice(4,6)}-${ie.slice(6,8)}`:ie||"-",ae=ie=>{if(!ie._receiveStatus)return{label:"-",color:"bg-gray-400 text-white"};switch(ie._receiveStatus){case"received":return{label:"",color:"bg-green-500 text-white"};case"partial":return{label:`(${ie._receivedCount}/${ie._totalCount})`,color:"bg-yellow-500 text-white"};case"none":return{label:"",color:"bg-red-500 text-white"};default:return{label:"-",color:"bg-gray-400 text-white"}}},_e=ie=>{var Ne;return ie?ie.includes(":")||ie.includes("-")?ie:((Ne=ie.match(/.{1,2}/g))==null?void 0:Ne.join(":"))||ie:"-"};return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex items-center gap-2 min-w-0",children:[s.jsxs("div",{className:"relative flex-1 min-w-0",children:[s.jsx("input",{type:"date",value:V(a),onChange:ie=>o(K(ie.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),s.jsxs("div",{className:"flex items-center px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white pointer-events-none",children:[s.jsx("span",{className:"flex-1",children:kT(a)}),s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]}),s.jsx("span",{className:"text-gray-400 flex-shrink-0",children:"~"}),s.jsxs("div",{className:"relative flex-1 min-w-0",children:[s.jsx("input",{type:"date",value:V(c),onChange:ie=>u(K(ie.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),s.jsxs("div",{className:"flex items-center px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white pointer-events-none",children:[s.jsx("span",{className:"flex-1",children:kT(c)}),s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("select",{value:h,onChange:ie=>m(ie.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[s.jsx("option",{value:"",children:""}),v.map(ie=>s.jsx("option",{value:ie.SO_ID,children:ie.SO_NM},ie.SO_ID))]})]}),s.jsx("button",{onClick:j,disabled:L,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2.5 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation flex items-center justify-center gap-2",style:{WebkitTapHighlightColor:"transparent"},children:L?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," ..."]}):""})]})}),_.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-2",children:s.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:" (  )"})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"bg-gray-50 px-3 py-2 border-b border-gray-200 flex items-center text-[11px] font-semibold text-gray-600",children:[s.jsx("span",{className:"w-16 text-center",children:""}),s.jsx("span",{className:"w-20 text-center",children:""}),s.jsx("span",{className:"flex-1 text-center",children:""}),s.jsx("span",{className:"w-20 text-center flex-shrink-0",children:""})]}),s.jsx("div",{children:(()=>{const ie=_.reduce((X,xe)=>{const fe=xe.SO_NM||"";return X[fe]||(X[fe]=[]),X[fe].push(xe),X},{});return Object.keys(ie).sort().map(X=>s.jsxs("div",{children:[s.jsxs("div",{className:"bg-gray-100 px-3 py-2 border-b border-gray-200 flex items-center justify-between cursor-pointer hover:bg-gray-200 transition-colors",onClick:()=>te(X),children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:X}),s.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",ie[X].length,")"]})]}),ee.has(X)?s.jsx(ir,{className:"w-4 h-4 text-gray-500"}):s.jsx(kr,{className:"w-4 h-4 text-gray-500"})]}),!ee.has(X)&&ie[X].map((xe,fe)=>s.jsx("div",{onClick:()=>O(xe),className:`px-3 py-2 border-b border-gray-50 cursor-pointer transition-colors ${(g==null?void 0:g.OUT_REQ_NO)===xe.OUT_REQ_NO?"bg-blue-50 border-l-4 border-l-blue-500":"hover:bg-blue-50/50"}`,children:s.jsxs("div",{className:"flex items-center text-[11px]",children:[s.jsx("span",{className:"w-16 text-center text-gray-900",children:de(xe.OUT_DTTM||xe.OUT_REQ_DT)}),s.jsx("span",{className:"w-20 text-center text-gray-600 truncate",children:xe.CRR_NM||"-"}),s.jsx("span",{className:"flex-1 text-center text-gray-700 font-mono",children:xe.OUT_REQ_NO}),s.jsx("span",{className:`w-20 text-center px-1.5 py-0.5 rounded text-[10px] font-bold whitespace-nowrap flex-shrink-0 ${ae(xe).color}`,children:ae(xe).label})]})},fe))]},X))})()})]})]}),g&&s.jsxs("div",{ref:H,children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"  "})}),P?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6 flex items-center justify-center",children:[s.jsxs("svg",{className:"animate-spin h-6 w-6 text-blue-500 mr-2",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-sm text-gray-600",children:"   ..."})]}):y.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:ie=>Q(ie.target.checked),checked:y.filter(ie=>ie.PROC_YN!=="Y").length>0&&y.filter(ie=>ie.PROC_YN!=="Y").every(ie=>ie.CHK),disabled:y.filter(ie=>ie.PROC_YN!=="Y").length===0,className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[y.length," (: ",y.filter(ie=>ie.CHK&&ie.PROC_YN!=="Y").length,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>Y("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${A==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>Y("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${A==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:R.map(ie=>{const Ne=ce[ie],X=ee.has(ie),xe=Ne.length,fe=Ne.filter(se=>se.PROC_YN!=="Y"&&se.EQT_SERNO&&se.EQT_SERNO.trim()!==""),Z=fe.filter(se=>se.CHK).length,le=fe.length>0&&Z===fe.length;return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>te(ie),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:le,onClick:se=>se.stopPropagation(),onChange:se=>$(ie,se.target.checked),className:"rounded w-4 h-4",disabled:fe.length===0}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:ie}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[xe," ",Z>0&&`(${Z})`]})]}),X?s.jsx(ir,{className:"w-3 h-3 text-gray-500"}):s.jsx(kr,{className:"w-3 h-3 text-gray-500"})]}),!X&&s.jsx("div",{className:"space-y-2",children:Ne.map(se=>{const Re=se._idx,be=se.PROC_YN==="Y",De=se.EQT_SERNO&&se.EQT_SERNO.trim()!=="",re=!be&&De;return s.jsxs("div",{onClick:()=>re&&q(Re,!se.CHK),className:`p-3 rounded-lg border-2 transition-all ${re?"cursor-pointer":"cursor-not-allowed opacity-70"} ${se.CHK?"bg-blue-50 border-blue-400":be?"bg-green-50/50 border-green-200":De?"bg-gray-50 border-gray-200 hover:border-gray-300":"bg-gray-100/50 border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:be?!0:se.CHK||!1,onChange:me=>{me.stopPropagation(),re&&q(Re,me.target.checked)},disabled:!re,className:`w-5 h-5 rounded focus:ring-blue-500 mt-0.5 ${re?"text-blue-500":"text-gray-300 cursor-not-allowed"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-base font-bold text-gray-900 truncate",children:se.EQT_CL_NM||se.ITEM_MID_CD_NM||"()"}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${be?"bg-green-100 text-green-700":De?"bg-blue-100 text-blue-700":"bg-red-100 text-red-600"}`,children:be?"":De?"":""})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:`text-sm ${De?"text-gray-600":"text-gray-400 italic"}`,children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),se.EQT_SERNO||"( )"]}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${se.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":se.EQT_USE_ARR_YN==="A"?"bg-purple-100 text-purple-700":se.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:se.EQT_USE_ARR_YN==="Y"?"":se.EQT_USE_ARR_YN==="A"?"":se.EQT_USE_ARR_YN==="N"?"":"N/A"})]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),_e(se.MAC_ADDRESS||"")]}),s.jsx("span",{className:"text-sm text-gray-600",children:mq(se.EQT_USE_END_DT||"")})]})]})]}),A==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:se.ITEM_MODEL||se.MODEL_NM||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:(g==null?void 0:g.SO_NM)||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.EQT_STAT_CD_NM||(De?"-":"")})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:se.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.EQT_LOC_NM||se.EQT_LOC_TP_NM||(De?"-":"()")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:se.OLD_EQT_LOC_NM||"-"})]})]})]},Re)})})]},ie)})}),!1]}),s.jsx("div",{className:"h-20"}),s.jsx("div",{className:"fixed bottom-[56px] left-0 right-0 p-3 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsxs("button",{onClick:U,disabled:!y.some(ie=>ie.CHK&&ie.PROC_YN!=="Y"),className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-3 px-6 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation disabled:cursor-not-allowed",style:{WebkitTapHighlightColor:"transparent"},children:["   (",y.filter(ie=>ie.CHK&&ie.PROC_YN!=="Y").length,")"]})})]}):s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"  "})]})})]}),_.length===0&&!L&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     "})]})}),s.jsx(Ra,{isOpen:G,onClose:()=>B(!1),title:"  ",size:"md",children:I&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:" "}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:I.ITEM_MAX_CD_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:I.EQT_CL_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:I.ITEM_MID_CD||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"ml-1 font-medium",children:I.ITEM_MID_CD_NM||"-"})]})]})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-700 mb-2",children:"  "}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"font-mono font-medium",children:I.EQT_NO||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:"font-mono font-medium",children:I.EQT_SERNO||"-"})]}),I.MAC_ADDRESS&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"MAC :"}),s.jsx("span",{className:"font-mono font-medium",children:I.MAC_ADDRESS})]})]})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:" "}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-500",children:""}),s.jsx("div",{className:"text-lg font-bold text-gray-800",children:I.OUT_REQ_QTY||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-500",children:""}),s.jsx("div",{className:"text-lg font-bold text-green-600",children:I.OUT_QTY||0})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-500",children:""}),s.jsx("div",{className:"text-lg font-bold text-blue-600",children:I.IBGO_QTY||0})]})]})]}),s.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-yellow-700 mb-2",children:" "}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("span",{className:`px-2 py-1 rounded font-medium ${I.PROC_YN==="Y"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:I.PROC_YN==="Y"?"":""})]}),I.REMARK&&s.jsxs("div",{className:"mt-2",children:[s.jsx("span",{className:"text-gray-500",children:":"}),s.jsx("p",{className:"mt-1 text-gray-700 bg-white p-2 rounded",children:I.REMARK})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded font-medium text-sm transition-colors",children:""})})]})})]})},pq={10:"",11:"()",20:"",35:"",50:"",60:"",70:"",71:"",72:"",73:"AS",74:"",75:"",80:"",81:"",82:"",83:"",84:"",90:""},yq={1:"SO()",2:"",3:"",4:""},UT=t=>pq[t]||t,BT=t=>yq[t]||t,bq=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",Cq=typeof window<"u"?(()=>{const t=window.location.hostname;return t==="localhost"||t==="127.0.0.1"?"http://52.63.232.141:8080/api":"/api"})():"/api",Nq=async()=>{try{const t=localStorage.getItem("branchList");if(t){const r=JSON.parse(t);if(Array.isArray(r)&&r.length>0)return console.log(" [] branchList   :",r.length,""),r}const e=localStorage.getItem("userInfo");if(e){const r=JSON.parse(e);if(r.authSoList&&Array.isArray(r.authSoList)&&r.authSoList.length>0)return console.log(" [] authSoList   :",r.authSoList.length,""),r.authSoList}console.log(" [] API    ...");const n=await fetch(`${Cq}/statistics/equipment/getAuthSoList`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({USR_ID:e?JSON.parse(e).userId:""})});if(n.ok){const r=await n.json();if(Array.isArray(r)&&r.length>0)return console.log(" [] API   :",r.length,""),localStorage.setItem("branchList",JSON.stringify(r)),r}return console.log(" []    -   "),[]}catch(t){return console.error(" []    :",t),[]}},Sq=[{COMMON_CD:"",COMMON_CD_NM:""},{COMMON_CD:"02",COMMON_CD_NM:""},{COMMON_CD:"03",COMMON_CD_NM:"CVT"},{COMMON_CD:"04",COMMON_CD_NM:"STB"},{COMMON_CD:"05",COMMON_CD_NM:"Smart card"},{COMMON_CD:"06",COMMON_CD_NM:""},{COMMON_CD:"07",COMMON_CD_NM:"Cable Card"},{COMMON_CD:"08",COMMON_CD_NM:"IP"},{COMMON_CD:"10",COMMON_CD_NM:"(AP)"},{COMMON_CD:"23",COMMON_CD_NM:"OTT_STB()"}],vq=({onBack:t,showToast:e})=>{var st,Ft,_t,qt,jt;const r=(()=>{try{const he=localStorage.getItem("userInfo");return he?JSON.parse(he):null}catch{return null}})(),[i,a]=b.useState(""),[o,c]=b.useState(""),[u,h]=b.useState(""),[m,_]=b.useState([]),[p,g]=b.useState(!1),[C,y]=b.useState(""),[S,v]=b.useState(!1),[k,L]=b.useState("OWNED"),[M,P]=b.useState(!1),F=()=>{let he=0;return i&&he++,o&&he++,u&&he++,C&&he++,he},[G,B]=b.useState(!1),[I,E]=b.useState([]),[A,Y]=b.useState([]),[ee,J]=b.useState([]),[H]=b.useState(Sq);b.useEffect(()=>{(async()=>{let ye=await Nq();if(r!=null&&r.soId&&!ye.find(je=>je.SO_ID===r.soId)){const je=r.soNm||(r.soId==="100"?"":`(${r.soId})`);ye=[{SO_ID:r.soId,SO_NM:je},...ye],console.log("[]  soId :",r.soId,je)}J(ye)})()},[r==null?void 0:r.soId]),b.useEffect(()=>{if(!o){_([]),h("");return}(async()=>{g(!0);try{console.log("[]  API :",o);const ye=await AM({ITEM_MID_CD:o});console.log("[]  API :",ye);const je=Array.isArray(ye)?ye:(ye==null?void 0:ye.data)||[];if(Array.isArray(je)&&je.length>0){const Me=je.map(tt=>({code:tt.COMMON_CD||tt.EQT_CL_CD||"",name:tt.COMMON_CD_NM||tt.EQT_CL_NM||""})).filter(tt=>tt.code&&tt.name).sort((tt,Te)=>tt.name.localeCompare(Te.name));console.log("[]  :",Me.length,""),_(Me)}else _([])}catch(ye){console.error("[]   :",ye),_([])}finally{g(!1)}})(),h("")},[o]);const[V,K]=b.useState(!1),[j,te]=b.useState(!1),[ce,R]=b.useState(!1),[O,U]=b.useState({current:0,total:0,item:"",action:""}),[Q,q]=b.useState(!1),[$,de]=b.useState(null),[ae,_e]=b.useState(""),[ie,Ne]=b.useState(""),[X,xe]=b.useState(""),[fe,Z]=b.useState(!1);b.useEffect(()=>{Y([]),de(null)},[k]);const[le,se]=b.useState("simple"),[Re,be]=b.useState(new Set),[De,re]=b.useState(!0),[me,ve]=b.useState(!0),[et,Dt]=b.useState(!0),At=k!=="OWNED"?A:A.filter(he=>{const ye=he._category==="RETURN_REQUESTED"||he._hasReturnRequest,je=he._category==="INSPECTION_WAITING"||he.EQT_USE_ARR_YN==="A",Me=!ye&&!je;return!(ye&&!et||je&&!me||Me&&!De)}),[ct,Ge]=b.useState(null),[at,xt]=b.useState(!1),[mt,Ve]=b.useState(!1),[it,Fe]=b.useState([]),[nt,lt]=b.useState(!1),[Mt,ut]=b.useState([]);b.useEffect(()=>{qe()},[]),b.useEffect(()=>{if(C==="705KVQS022868"&&(r!=null&&r.userId)){console.log(" [] S/N    ...");const he=setTimeout(()=>{Ee()},500);return()=>clearTimeout(he)}},[r==null?void 0:r.userId]);const qe=async()=>{console.log(" []  ")},Ee=async()=>{if(console.log("=====   ====="),console.log("[DEBUG] userInfo:",r),console.log("[DEBUG] userInfo.soId:",r==null?void 0:r.soId),console.log("[DEBUG] selectedSoId (state):",i),console.log("[DEBUG] localStorage userInfo:",localStorage.getItem("userInfo")),!(r!=null&&r.userId)){e==null||e("  .  .","error");return}K(!0),Y([]);try{console.log(" [] :",{selectedCategory:k,SO_ID:i,userInfo_soId:r.soId,WRKR_ID:r.userId,CRR_ID:r.crrId,ITEM_MID_CD:o,EQT_SERNO:C});let he=[];{const Me={WRKR_ID:r.userId,CRR_ID:r.crrId,SO_ID:i||r.soId||void 0,ITEM_MID_CD:o||void 0},tt=[];if(k==="OWNED")try{const Te={WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||""};console.log("[DEBUG]  API  :",Te);const bt=await Ei("EquipmentInquiry","getWrkrHaveEqtListAll ()",()=>Og(Te),Te);console.log("[DEBUG]  API :",{isArray:Array.isArray(bt),length:Array.isArray(bt)?bt.length:"N/A",raw:bt});let Ke=new Set;try{const St=await NE({WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||r.soId||void 0});console.log("[]   :",St),Array.isArray(St)&&(St.forEach(Et=>{Et.EQT_NO&&(Ke.add(Et.EQT_NO),console.log("[] EQT_NO :",Et.EQT_NO))}),console.log("[]    :",Ke.size,"/ EQT_NO Set:",Array.from(Ke)))}catch(St){console.log("[]     ():",St)}if(Array.isArray(bt)){let St=bt;o&&(St=St.filter(ht=>ht.ITEM_MID_CD===o)),u&&(console.log("[1 ]  EQT_CL_CD  :",St.length,""),console.log("[1 ] selectedEqtClCd:",u),console.log("[1 ]  EQT_CL_CD :",St.map(ht=>({serno:ht.EQT_SERNO,eqtClCd:ht.EQT_CL_CD}))),St=St.filter(ht=>ht.EQT_CL_CD===u),console.log("[1 ]  EQT_CL_CD  :",St.length,"")),console.log("[]  ( ):",St.length,""),tt.push(...St.map(ht=>{const Lt=Ke.has(ht.EQT_NO);return Lt&&console.log("[]   :",ht.EQT_NO,ht.EQT_SERNO),{...ht,_category:"OWNED",_hasReturnRequest:Lt}}));const{merged:Et,transferredCount:ze}=BA(tt,r.userId);ze>0&&(console.log("[]   :",ze,""),tt.length=0,tt.push(...Et.map(ht=>({...ht,_category:ht._category||"OWNED",_hasReturnRequest:Ke.has(ht.EQT_NO)}))));try{const ht=await SE({WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||""});if(Array.isArray(ht)){const Lt=new Set(tt.map(Yt=>Yt.EQT_NO)),Bt=ht.filter(Yt=>Yt.EQT_NO&&!Lt.has(Yt.EQT_NO));Bt.length>0?(console.log("[]  API   :",Bt.length,""),tt.push(...Bt.map(Yt=>({...Yt,_category:"OWNED",_hasReturnRequest:Ke.has(Yt.EQT_NO),EQT_USE_ARR_YN:Yt.EQT_USE_ARR_YN||"A"})))):console.log("[]  API -    (  )")}}catch(ht){console.log("[]  API   ():",ht)}}}catch(Te){console.log("   (getCustProdInfo):",Te)}if(k==="RETURN_REQUESTED"){const Te={WRKR_ID:r.userId,SO_ID:i||r.soId||void 0,CRR_ID:r.crrId};try{const bt=await Ei("EquipmentInquiry","getEquipmentReturnRequestListAll ()",()=>NE(Te),Te);if(Array.isArray(bt)){let Ke=bt;o&&(Ke=Ke.filter(ze=>ze.ITEM_MID_CD===o)),u&&(Ke=Ke.filter(ze=>ze.EQT_CL_CD===u));const St=new Map;Ke.forEach(ze=>{ze.EQT_NO&&(St.has(ze.EQT_NO)||St.set(ze.EQT_NO,[]),St.get(ze.EQT_NO).push(ze))});const Et=[];St.forEach((ze,ht)=>{const Lt=ze[0],Bt=ze.map(Yt=>({REQ_DT:Yt.REQ_DT,RETURN_TP:Yt.RETURN_TP||"2",EQT_USE_ARR_YN:Yt.EQT_USE_ARR_YN||"Y"}));Et.push({...Lt,_allReqDts:Bt})}),Ke.length!==Et.length&&console.log("[]  :",Ke.length,"->",Et.length,"(_allReqDts )"),tt.push(...Et.map(ze=>({...ze,_category:"RETURN_REQUESTED"})))}}catch(bt){console.log("  :",bt)}}if(k==="INSPECTION_WAITING"){const Te={WRKR_ID:r.userId,CRR_ID:r.crrId||"",SO_ID:i||""};try{const bt=await Ei("EquipmentInquiry","getEquipmentChkStndByAAll ()",()=>SE(Te),Te);if(Array.isArray(bt)){let Ke=bt.filter(St=>St.ITEM_MID_CD==="04");console.log("[] API :",bt.length,", STB:",Ke.length,""),tt.push(...Ke.map(St=>({...St,_category:"INSPECTION_WAITING"})))}}catch(bt){console.log("  :",bt)}}if(he=tt,C&&C.trim().length>0){const Te=C.trim().toUpperCase();he=he.filter(bt=>{const Ke=(bt.EQT_SERNO||"").toUpperCase(),St=(bt.MAC_ADDRESS||"").toUpperCase();return Ke.includes(Te)||St.includes(Te)}),console.log(" [] S/N  :",he.length," (:",Te,")")}}let je=(Array.isArray(he)?he:[]).map(Me=>({CHK:!1,EQT_NO:Me.EQT_NO||"",EQT_SERNO:Me.EQT_SERNO||Me.SERIAL_NO||"",MAC_ADDRESS:Me.MAC_ADDRESS||Me.MAC||Me.TA_MAC_ADDRESS||"",EQT_CL_CD:Me.EQT_CL_CD||"",EQT_CL_NM:Me.EQT_CL_NM||Me.EQT_TYPE||"",ITEM_MID_CD:Me.ITEM_MID_CD||"",ITEM_MID_NM:Me.ITEM_MID_NM||"",ITEM_NM:Me.ITEM_NM||Me.ITEM_MODEL||"",ITEM_MODEL:Me.ITEM_MODEL||Me.MODEL_NM||"",SO_ID:Me.SO_ID||i,SO_NM:Me.SO_NM||"",EQT_STAT_CD:Me.EQT_STAT_CD||Me.STATUS||"",EQT_STAT_NM:Me.EQT_STAT_NM||Me.EQT_STAT_CD_NM||UT(Me.EQT_STAT_CD||Me.STATUS||"")||"",EQT_LOC_TP_CD:Me.EQT_LOC_TP_CD||"",EQT_LOC_TP_NM:Me.EQT_LOC_TP_NM||Me.EQT_LOC_TP_CD_NM||BT(Me.EQT_LOC_TP_CD||""),EQT_LOC_NM:Me.EQT_LOC_NM||"",OLD_EQT_LOC_NM:Me.OLD_EQT_LOC_NM||Me.BEF_EQT_LOC_NM||Me.BEF_LOC_NM||"",CHG_KND_NM:Me.CHG_KND_NM||Me.CHG_TP_NM||Me.EQT_CHG_TP_NM||"",PROC_STAT:Me.PROC_STAT||"",PROC_STAT_NM:Me.PROC_STAT_NM||"",WRKR_ID:Me.WRKR_ID||r.userId,WRKR_NM:Me.WRKR_NM||r.userName,CUST_ID:Me.CUST_ID||"",CTRT_ID:Me.CTRT_ID||"",CTRT_STAT:Me.CTRT_STAT||"",WRK_ID:Me.WRK_ID||"",EQT_USE_END_DT:Me.EQT_USE_END_DT||Me.USE_END_DT||Me.EXPIRE_DT||"",RETN_RESN_CD:Me.RETN_RESN_CD||"",RETN_RESN_NM:Me.RETN_RESN_NM||Me.RETN_RESN_CD_NM||"",REQ_DT:Me.REQ_DT||"",RETURN_TP:Me.RETURN_TP||"2",EQT_USE_ARR_YN:Me.EQT_USE_ARR_YN||"",_category:Me._category||void 0,_hasReturnRequest:Me._hasReturnRequest||!1}));o&&(je=je.filter(Me=>Me.ITEM_MID_CD===o)),u&&(je=je.filter(Me=>Me.EQT_CL_CD===u)),je.sort((Me,tt)=>{const Te=ze=>ze._category==="RETURN_REQUESTED"||ze._hasReturnRequest?3:ze._category==="INSPECTION_WAITING"||ze.EQT_USE_ARR_YN==="A"?2:1,bt=Te(Me),Ke=Te(tt);if(bt!==Ke)return bt-Ke;const St=Me.ITEM_MID_CD||"",Et=tt.ITEM_MID_CD||"";return St.localeCompare(Et)}),Y(je),je.length===0?e==null||e("  .","info"):e==null||e(`${je.length}  .`,"success")}catch(he){console.error(" [] :",he),e==null||e(he.message||"  .","error")}finally{K(!1)}},Ye=he=>{he.CHK=!0,Y([he]),B(!1),E([]),e==null||e(" .","success")},pe=he=>{Y(A.map(ye=>({...ye,CHK:ye._category==="OWNED"&&ye._hasReturnRequest?!1:he})))},ge=(he,ye)=>{Y(A.map(je=>je.EQT_NO===he?{...je,CHK:ye}:je))},Be=he=>{var ye;return he?he.includes(":")||he.includes("-")?he:((ye=he.match(/.{1,2}/g))==null?void 0:ye.join(":"))||he:"-"},ue=()=>{const he=A.filter(je=>je.CHK);if(he.length===0){e==null||e("  .","warning");return}const ye=he.filter(je=>je._hasReturnRequest);if(ye.length>0){ut(ye),lt(!0);return}te(!0)},we=async he=>{var je,Me;const ye=A.filter(tt=>tt.CHK);if(ye.length===0){e==null||e("  .","warning");return}if(he==="RETURN"){if(!ae){Z(!0);return}if(ae==="03"&&!ie.trim()){Z(!0);return}}try{const tt=he==="RETURN"||ye.length>=3;tt&&(U({current:0,total:ye.length,item:"",action:he==="CANCEL"?"":""}),R(!0));const Te=(bt,Ke,St)=>{tt&&U({current:bt,total:Ke,item:St,action:he==="CANCEL"?"":""})};if(he==="CANCEL"){const bt=[];ye.forEach(Et=>{Et._allReqDts&&Array.isArray(Et._allReqDts)&&Et._allReqDts.length>0?Et._allReqDts.forEach(ze=>{bt.push({EQT_NO:Et.EQT_NO,EQT_SERNO:Et.EQT_SERNO,REQ_DT:ze.REQ_DT,RETURN_TP:ze.RETURN_TP||"2",EQT_USE_ARR_YN:ze.EQT_USE_ARR_YN||"Y"})}):bt.push({EQT_NO:Et.EQT_NO,EQT_SERNO:Et.EQT_SERNO,REQ_DT:Et.REQ_DT,RETURN_TP:Et.RETURN_TP||"2",EQT_USE_ARR_YN:Et.EQT_USE_ARR_YN||""})}),console.log("[]    :",bt.length,"(",ye.length,")");const Ke={WRKR_ID:(r==null?void 0:r.userId)||"",CRR_ID:(r==null?void 0:r.crrId)||"",SO_ID:((je=ye[0])==null?void 0:je.SO_ID)||i||(r==null?void 0:r.soId)||"",equipmentList:bt},St=await Ei("EquipmentInquiry","delEquipmentReturnRequest",()=>wA(Ke,Te),Ke)}else{if(!ae){e==null||e(" .","warning"),R(!1);return}if(ae==="03"&&!ie.trim()){e==null||e("  .","warning"),R(!1);return}const bt={WRKR_ID:(r==null?void 0:r.userId)||"",CRR_ID:(r==null?void 0:r.crrId)||"",SO_ID:((Me=ye[0])==null?void 0:Me.SO_ID)||i||(r==null?void 0:r.soId)||"",MST_SO_ID:(r==null?void 0:r.mstSoId)||(r==null?void 0:r.soId)||"",RETURN_TP:"2",RETN_RESN_TEXT:ae==="03"?ie:void 0,equipmentList:ye.map(St=>({EQT_NO:St.EQT_NO,EQT_SERNO:St.EQT_SERNO,ACTION:he,RETN_RESN_CD:ae,EQT_USE_ARR_YN:St.EQT_USE_ARR_YN}))},Ke=await Ei("EquipmentInquiry","addEquipmentReturnRequest",()=>_A(bt,Te),bt)}R(!1),e==null||e(he==="RETURN"?`${ye.length}    .`:`${ye.length}   .`,"success"),te(!1),_e(""),Ne(""),await Ee()}catch(tt){console.error("   :",tt),e==null||e(tt.message||"  .","error"),R(!1)}},Je=async()=>{if($)try{const he={EQT_NO:$.EQT_NO,EQT_SERNO:$.EQT_SERNO||"",WRKR_ID:(r==null?void 0:r.userId)||"",CRR_ID:(r==null?void 0:r.crrId)||"",SO_ID:$.SO_ID||i||(r==null?void 0:r.soId)||"",EQT_CL_CD:$.EQT_CL_CD||"",LOSS_REASON:X||void 0},ye=await Ei("EquipmentInquiry","processEquipmentLoss",()=>xA(he),he);e==null||e("   .","success"),q(!1),de(null),xe(""),await Ee()}catch(he){console.error("   :",he),e==null||e(he.message||"  .","error")}},Pe=()=>{const he=A.filter(ye=>ye.CHK);if(he.length===0){e==null||e("   .","warning");return}Fe(he),Ve(!0)},[Nt,Oe]=b.useState(!1),dt=b.useRef(!1),gt=async()=>{var Te,bt;if(dt.current){console.log("[]   . (ref check)");return}if(dt.current=!0,Nt){console.log("[]   . (state check)"),dt.current=!1;return}Ve(!1);const he=it;if(he.length===0)return;const ye=he.filter(Ke=>Ke.EQT_USE_ARR_YN!=="Y");if(ye.length===0){e==null||e("    .","info"),Fe([]);return}Oe(!0),U({current:0,total:ye.length,item:"",action:""}),R(!0);const je={success:[],failed:[]},Me=new Set;let tt=0;try{for(const Ke of ye){if(Me.has(Ke.EQT_NO)){console.log("[]   :",Ke.EQT_SERNO);continue}Me.add(Ke.EQT_NO),tt++,U({current:tt,total:ye.length,item:Ke.EQT_SERNO||"",action:""});const St={EQT_NO:Ke.EQT_NO,SO_ID:Ke.SO_ID||(r==null?void 0:r.soId)||"",EQT_SERNO:Ke.EQT_SERNO||"",USER_ID:(r==null?void 0:r.userId)||"",CRR_ID:Ke.CRR_ID||(r==null?void 0:r.crrId)||"",WRKR_ID:(r==null?void 0:r.userId)||"",CUST_ID:Ke.CUST_ID||"",WRK_ID:Ke.WRK_ID||"",CTRT_ID:Ke.CTRT_ID||"",CTRT_STAT:Ke.CTRT_STAT||"",PROG_GB:"M"};let Et=0;const ze=0;let ht=null,Lt=!1;for(;Et<=ze;)try{await Ei("EquipmentInquiry","setEquipmentCheckStandby",()=>pA(St),St),je.success.push({EQT_SERNO:Ke.EQT_SERNO,EQT_NO:Ke.EQT_NO,ITEM_NM:Ke.ITEM_NM||Ke.ITEM_MID_NM||""}),Lt=!0;break}catch(Bt){ht=Bt;const Yt=(Bt==null?void 0:Bt.message)||"";if(Yt.includes("ORA-00001")&&Et<ze){Et++,console.log(`[] ORA-00001 , ${Et}/${ze}  (1 ):`,Ke.EQT_SERNO),await new Promise(Xt=>setTimeout(Xt,1e3));continue}if(Yt.includes("ORA-00001")){console.log("[] ORA-00001 ,    :",Ke.EQT_SERNO);try{const Xt=await im({EQT_SERNO:Ke.EQT_SERNO});console.log("[]   :",Xt);let ts;(Te=Xt==null?void 0:Xt.data)!=null&&Te[0]?ts=Xt.data[0]:(bt=Xt==null?void 0:Xt.resultList)!=null&&bt[0]?ts=Xt.resultList[0]:Array.isArray(Xt)&&Xt.length>0?ts=Xt[0]:ts=Xt,console.log("[]  :",ts);const Ut=ts==null?void 0:ts.EQT_USE_ARR_YN;if(console.log("[]   EQT_USE_ARR_YN:",Ut),Ut==="Y"||Ut&&Ut!=="A"){console.log(`[]     (${Ut}),  :`,Ke.EQT_SERNO),je.success.push({EQT_SERNO:Ke.EQT_SERNO,EQT_NO:Ke.EQT_NO,ITEM_NM:Ke.ITEM_NM||Ke.ITEM_MID_NM||"",note:Ut==="Y"?"  ":`: ${Ut}`}),Lt=!0;break}else console.log("[]    A (),  ")}catch(Xt){console.error("[]    :",Xt)}}console.error("  :",Ke.EQT_SERNO,Bt),je.failed.push({EQT_SERNO:Ke.EQT_SERNO,EQT_NO:Ke.EQT_NO,ITEM_NM:Ke.ITEM_NM||Ke.ITEM_MID_NM||"",error:Et>0?`${Yt} (${Et}   )`:Yt||"    "});break}await new Promise(Bt=>setTimeout(Bt,200))}Ge(je),xt(!0),Fe([]),je.success.length>0&&await Ee()}catch(Ke){console.error("  :",Ke),e==null||e(Ke.message||"  .","error")}finally{R(!1),Oe(!1),dt.current=!1}},It=he=>{console.log("Barcode scanned:",he),y(he.toUpperCase()),v(!1),e==null||e(`  : ${he}`,"success"),setTimeout(()=>{Ee()},300)};A.filter(he=>he.CHK).length;const $e=A.filter(he=>he.CHK&&he._category==="OWNED").length,$t=A.filter(he=>he.CHK&&he._category==="RETURN_REQUESTED").length,Ue=A.filter(he=>he.CHK&&he._category==="INSPECTION_WAITING").length,ss=A.filter(he=>he._category==="OWNED").length,ls=A.filter(he=>he._category==="RETURN_REQUESTED").length,ds=A.filter(he=>he._category==="INSPECTION_WAITING").length,vs=(he,ye,je)=>{Y(A.map(Me=>{const tt=Me.SO_NM||Me.SO_ID||"",Te=Me.ITEM_MID_NM||"";return tt!==he||Te!==ye||Me._category==="OWNED"&&Me._hasReturnRequest?Me:{...Me,CHK:je}}))},Ss=he=>{be(ye=>{const je=new Set(Array.from(ye));return je.has(he)?je.delete(he):je.add(he),je})},ke=At.reduce((he,ye,je)=>{var Et,ze,ht,Lt;let Me="";const tt=(Et=ye.SO_NM)==null?void 0:Et.trim(),Te=(ze=ye.MST_SO_NM)==null?void 0:ze.trim(),bt=(ht=ye.SO_ID)==null?void 0:ht.trim(),Ke=(Lt=ye.MST_SO_ID)==null?void 0:Lt.trim();tt&&tt!=="100"?Me=tt:Te&&Te!=="100"?Me=Te:bt==="100"||Ke==="100"||tt==="100"||Te==="100"?Me="":bt&&(Me=bt);const St=ye.ITEM_MID_NM||"";return he[Me]||(he[Me]={}),he[Me][St]||(he[Me][St]=[]),he[Me][St].push({...ye,_globalIdx:je}),he},{});Object.keys(ke).forEach(he=>{Object.keys(ke[he]).forEach(ye=>{ke[he][ye].sort((je,Me)=>{const tt=je.EQT_CL_NM||je.ITEM_NM||"",Te=Me.EQT_CL_NM||Me.ITEM_NM||"";return tt.localeCompare(Te)})})});const ft=Object.keys(ke).sort();return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-1",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx("button",{type:"button",onClick:()=>L("OWNED"),className:`p-2 rounded-lg border-2 transition-all text-center active:scale-[0.98] touch-manipulation ${k==="OWNED"?"bg-green-50 border-green-500 text-green-700 shadow-sm":"border-gray-200 hover:bg-gray-50 text-gray-400"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${k==="OWNED"?"bg-green-500 border-green-500":"border-gray-300"}`,children:k==="OWNED"&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-sm font-bold",children:""})]})}),s.jsx("button",{type:"button",onClick:()=>L("RETURN_REQUESTED"),className:`p-2 rounded-lg border-2 transition-all text-center active:scale-[0.98] touch-manipulation ${k==="RETURN_REQUESTED"?"bg-amber-50 border-amber-500 text-amber-700 shadow-sm":"border-gray-200 hover:bg-gray-50 text-gray-400"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${k==="RETURN_REQUESTED"?"bg-orange-500 border-amber-500":"border-gray-300"}`,children:k==="RETURN_REQUESTED"&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-sm font-bold",children:""})]})}),s.jsx("button",{type:"button",onClick:()=>L("INSPECTION_WAITING"),className:`p-2 rounded-lg border-2 transition-all text-center active:scale-[0.98] touch-manipulation ${k==="INSPECTION_WAITING"?"bg-purple-50 border-purple-500 text-purple-700 shadow-sm":"border-gray-200 hover:bg-gray-50 text-gray-400"}`,style:{WebkitTapHighlightColor:"transparent"},children:s.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${k==="INSPECTION_WAITING"?"bg-purple-500 border-purple-500":"border-gray-300"}`,children:k==="INSPECTION_WAITING"&&s.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-sm font-bold",children:""})]})})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("button",{onClick:()=>P(!M),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:" "}),(i||o||C)&&s.jsx("span",{className:"px-1.5 py-0.5 bg-blue-500 text-white text-[10px] rounded-full font-medium",children:F()})]}),s.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),M&&s.jsxs("div",{className:"p-4 border-t border-gray-100 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("select",{value:i,onChange:he=>a(he.target.value),className:"flex-1 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[s.jsx("option",{value:"",children:""}),ee.map(he=>s.jsx("option",{value:he.SO_ID,children:he.SO_NM},he.SO_ID))]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsx("select",{value:o,onChange:he=>c(he.target.value),className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent truncate",children:H.map(he=>s.jsx("option",{value:he.COMMON_CD,children:he.COMMON_CD_NM},he.COMMON_CD))}),s.jsxs("select",{value:u,onChange:he=>h(he.target.value),disabled:!o||p||m.length===0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed truncate",children:[s.jsx("option",{value:"",children:o?p?"...":m.length===0?"-":"":"-"}),m.map(he=>s.jsx("option",{value:he.code,children:he.name},he.code))]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:C,onChange:he=>y(he.target.value.toUpperCase()),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg uppercase focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all font-mono",placeholder:"S/N  MAC  "}),s.jsxs("button",{onClick:()=>v(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]})]})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-1",children:s.jsx("button",{onClick:Ee,disabled:V,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2 rounded-xl font-bold text-base shadow-md transition-all flex items-center justify-center gap-2 active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:V?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),""]})})}),A.length>0&&s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:he=>pe(he.target.checked),checked:At.length>0&&At.filter(he=>!(he._category==="OWNED"&&he._hasReturnRequest)).length>0&&At.filter(he=>!(he._category==="OWNED"&&he._hasReturnRequest)).every(he=>he.CHK),className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[At.length," (: ",At.filter(he=>he.CHK).length,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>se("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${le==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>se("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${le==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:ft.map(he=>{const ye=ke[he],je=Object.keys(ye).sort(),Me=je.reduce((Te,bt)=>Te+ye[bt].length,0),tt=Re.has(`so_${he}`);return s.jsxs("div",{className:"border-b border-gray-100 last:border-0",children:[s.jsxs("div",{className:"px-4 py-2 bg-blue-50 flex items-center justify-between cursor-pointer hover:bg-blue-100",onClick:()=>Ss(`so_${he}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-bold text-blue-800",children:he}),s.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[Me,""]})]}),tt?s.jsx(ir,{className:"w-4 h-4 text-blue-600"}):s.jsx(kr,{className:"w-4 h-4 text-blue-600"})]}),!tt&&je.map(Te=>{const bt=ye[Te],Ke=Re.has(`so_${he}_mid_${Te}`),St=bt.filter(ht=>!(ht._category==="OWNED"&&ht._hasReturnRequest)),Et=St.filter(ht=>ht.CHK).length,ze=St.length>0&&Et===St.length;return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>Ss(`so_${he}_mid_${Te}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:ze,onClick:ht=>ht.stopPropagation(),onChange:ht=>vs(he,Te,ht.target.checked),className:"rounded w-4 h-4",disabled:St.length===0}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:Te}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[bt.length," ",Et>0&&`(${Et})`]})]}),Ke?s.jsx(ir,{className:"w-3 h-3 text-gray-500"}):s.jsx(kr,{className:"w-3 h-3 text-gray-500"})]}),!Ke&&s.jsx("div",{className:"space-y-2",children:bt.map((ht,Lt)=>s.jsxs("div",{onClick:()=>{ht._category==="OWNED"&&ht._hasReturnRequest||ge(ht.EQT_NO,!ht.CHK)},className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${ht.CHK?"bg-blue-50 border-blue-400":ht._category==="OWNED"?"bg-green-50/50 border-green-200 hover:border-green-300":ht._category==="RETURN_REQUESTED"?"bg-amber-50/50 border-amber-200 hover:border-amber-300":ht._category==="INSPECTION_WAITING"?"bg-purple-50/50 border-purple-200 hover:border-purple-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:ht.CHK||!1,disabled:ht._category==="OWNED"&&ht._hasReturnRequest,onChange:Bt=>{Bt.stopPropagation(),ge(ht.EQT_NO,Bt.target.checked)},className:`w-5 h-5 rounded focus:ring-blue-500 mt-0.5 ${ht._category==="OWNED"&&ht._hasReturnRequest?"text-gray-300 cursor-not-allowed":"text-blue-500"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-base font-bold text-gray-900 truncate",children:ht.EQT_CL_NM||ht.ITEM_NM||"-"}),s.jsx("div",{className:"flex-shrink-0 ml-2",children:ht._hasReturnRequest||ht._category==="RETURN_REQUESTED"?s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:""}):s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:""})})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),ht.EQT_SERNO||"-"]}),s.jsxs("div",{className:"flex-shrink-0 ml-2",children:[ht.EQT_USE_ARR_YN==="Y"&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:""}),ht.EQT_USE_ARR_YN==="A"&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""}),ht.EQT_USE_ARR_YN==="N"&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",children:""}),!ht.EQT_USE_ARR_YN&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:"N/A"})]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),Be(ht.MAC_ADDRESS)]}),s.jsx("span",{className:"text-sm text-gray-600",children:bq(ht.EQT_USE_END_DT||ht.USE_END_DT||"")})]})]})]}),le==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:ht.ITEM_MODEL||ht.MODEL_NM||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:ht.SO_NM||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ht.EQT_STAT_NM||ht.EQT_STAT_CD_NM||UT(ht.EQT_STAT_CD||"")||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:ht.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ht.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ht.EQT_LOC_NM||ht.EQT_LOC_TP_NM||BT(ht.EQT_LOC_TP_CD||"")||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:ht.OLD_EQT_LOC_NM||"-"})]})]})]},ht.EQT_NO||Lt))})]},Te)})]},he)})}),!1]}),A.length===0&&!V&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     "})]})}),s.jsx("div",{className:"h-20"}),s.jsx("div",{className:"fixed bottom-[56px] left-0 right-0 p-3 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsxs("div",{className:"flex gap-2",children:[ss>0&&s.jsxs("button",{onClick:ue,disabled:$e===0,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation ${$e>0?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:[" ",$e>0&&`(${$e})`]}),ls>0&&s.jsxs("button",{onClick:()=>we("CANCEL"),disabled:$t===0,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation ${$t>0?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:[" ",$t>0&&`(${$t})`]}),ds>0&&s.jsx("button",{onClick:Pe,disabled:Ue===0||Nt,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation ${Ue>0&&!Nt?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:Nt?"...":` ${Ue>0?`(${Ue})`:""}`})]})}),s.jsx(Ra,{isOpen:G,onClose:()=>{B(!1),E([])},title:" ",size:"md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[I.length,"  .   ."]}),s.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg divide-y divide-gray-100",children:I.map((he,ye)=>s.jsx("button",{onClick:()=>Ye(he),className:"w-full p-3 text-left hover:bg-blue-50 transition-colors active:bg-blue-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-gray-900",children:he.EQT_CL_NM||he.ITEM_NM||""}),s.jsx("div",{className:"text-sm text-gray-600 font-mono",children:he.EQT_SERNO}),s.jsxs("div",{className:"text-xs text-gray-500",children:[he.SO_NM," | ",Be(he.MAC_ADDRESS)]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${he.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":he.EQT_USE_ARR_YN==="A"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:he.EQT_USE_ARR_YN==="Y"?"":he.EQT_USE_ARR_YN==="A"?"":"N/A"}),s.jsx("span",{className:"text-xs text-gray-400",children:he.ITEM_MID_NM})]})]})},ye))}),s.jsx("button",{onClick:()=>{B(!1),E([])},className:"w-full py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold text-sm transition-all",children:""})]})}),s.jsx(Ra,{isOpen:j,onClose:()=>te(!1),title:"-",size:"md",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:((st=A.filter(he=>he.CHK)[0])==null?void 0:st.SO_NM)||((Ft=ee.find(he=>he.SO_ID===i))==null?void 0:Ft.SO_NM)||((_t=ee.find(he=>he.SO_ID===(r==null?void 0:r.soId)))==null?void 0:_t.SO_NM)||(r==null?void 0:r.soId)||"-",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:ae,onChange:he=>{_e(he.target.value),he.target.value!=="03"&&Ne("")},className:`w-full px-2 py-1.5 text-sm border rounded ${ae?"border-gray-300":"border-red-300"}`,children:[s.jsx("option",{value:"",children:""}),s.jsx("option",{value:"01",children:"  "}),s.jsx("option",{value:"02",children:"  (  )"}),s.jsx("option",{value:"03",children:""})]})]}),ae==="03"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["  ",s.jsx("span",{className:"text-red-500",children:"*"}),s.jsxs("span",{className:"text-gray-400 ml-1",children:["(",ie.length,"/100 bytes)"]})]}),s.jsx("textarea",{value:ie,onChange:he=>{const ye=he.target.value;new Blob([ye]).size<=100&&Ne(ye)},className:`w-full px-2 py-1.5 text-sm border rounded h-20 resize-none ${ie.trim()?"border-gray-300":"border-red-300"}`,placeholder:"   ( 100)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-left",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:"S/N"}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:""})]})}),s.jsx("tbody",{children:A.filter(he=>he.CHK).map((he,ye)=>s.jsxs("tr",{className:"border-t border-gray-100",children:[s.jsx("td",{className:"px-2 py-1.5",children:he.ITEM_NM||he.EQT_CL_NM}),s.jsx("td",{className:"px-2 py-1.5 font-mono text-[10px]",children:he.EQT_SERNO}),s.jsx("td",{className:"px-2 py-1.5",children:s.jsx("span",{className:`px-1 py-0.5 rounded text-[10px] ${he.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":he.EQT_USE_ARR_YN==="A"?"bg-amber-100 text-amber-700":he.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:he.EQT_STAT_NM||(he.EQT_USE_ARR_YN==="Y"?"":he.EQT_USE_ARR_YN==="A"?"":he.EQT_USE_ARR_YN==="N"?"":"N/A")})})]},ye))})]})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{te(!1),_e(""),Ne("")},className:"flex-1 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""}),s.jsx("button",{onClick:()=>we("RETURN"),className:"flex-1 py-2.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""})]})]})}),fe&&s.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[250]",onClick:()=>Z(!1),children:s.jsxs("div",{className:"bg-white rounded-xl p-5 mx-4 shadow-2xl max-w-sm animate-pulse",onClick:he=>he.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:" "}),s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:ae==="03"?"  .":"   ."})]})]}),s.jsx("button",{onClick:()=>Z(!1),className:"w-full py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all",children:""})]})}),ce&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[200]",children:s.jsx("div",{className:"bg-white rounded-xl p-6 w-80 shadow-2xl",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-semibold text-gray-800 mb-4",children:[O.action,"  ..."]}),s.jsx("div",{className:"mb-3",children:s.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:O.total>0?`${O.current/O.total*100}%`:"0%"}})})}),s.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[O.current," / ",O.total]}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:O.item&&` : ${O.item}`})]})})}),s.jsx(Ra,{isOpen:Q,onClose:()=>{q(!1),de(null)},title:"-",size:"md",children:$&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:$.SO_NM||((qt=ee.find(he=>he.SO_ID===$.SO_ID))==null?void 0:qt.SO_NM)||((jt=ee.find(he=>he.SO_ID===(r==null?void 0:r.soId)))==null?void 0:jt.SO_NM)||"-",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("textarea",{value:X,onChange:he=>xe(he.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded h-20 resize-none",placeholder:"  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1.5 text-left",children:""}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:"S/N"}),s.jsx("th",{className:"px-2 py-1.5 text-left",children:""})]})}),s.jsx("tbody",{children:s.jsxs("tr",{className:"border-t border-gray-100",children:[s.jsx("td",{className:"px-2 py-1.5",children:$.ITEM_NM||$.EQT_CL_NM}),s.jsx("td",{className:"px-2 py-1.5 font-mono text-[10px]",children:$.EQT_SERNO}),s.jsx("td",{className:"px-2 py-1.5",children:s.jsx("span",{className:`px-1 py-0.5 rounded text-[10px] ${$.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":$.EQT_USE_ARR_YN==="A"?"bg-amber-100 text-amber-700":$.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:$.EQT_STAT_NM||($.EQT_USE_ARR_YN==="Y"?"":$.EQT_USE_ARR_YN==="A"?"":$.EQT_USE_ARR_YN==="N"?"":"N/A")})})]})})]})})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-red-600",children:"       ."})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{q(!1),de(null)},className:"flex-1 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""}),s.jsx("button",{onClick:Je,className:"flex-1 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:""})]})]})}),mt&&it.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-blue-600",children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:" "}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[" : ",it.length,""]})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm text-amber-800 font-medium mb-1",children:"  "}),s.jsx("p",{className:"text-xs text-amber-600",children:"         ."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"  "}),s.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:it.map((he,ye)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg text-xs",children:[s.jsx("span",{className:"font-mono text-gray-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-gray-600",children:he.ITEM_NM||he.ITEM_MID_NM})]},ye))})]})]}),s.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex gap-2",children:[s.jsx("button",{onClick:()=>{Ve(!1),Fe([])},className:"flex-1 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors",children:""}),s.jsx("button",{onClick:gt,disabled:Nt,className:`flex-1 py-2.5 rounded-lg font-medium transition-colors ${Nt?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:Nt?"...":""})]})]})}),at&&ct&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:`p-4 ${ct.failed.length===0?"bg-gradient-to-r from-green-500 to-green-600":ct.success.length===0?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-amber-500 to-amber-600"}`,children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:ct.failed.length===0?"  ":ct.success.length===0?" ":"  ( )"}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[": ",ct.success.length," / : ",ct.failed.length,""]})]}),s.jsxs("div",{className:"p-4 max-h-96 overflow-y-auto space-y-4",children:[ct.success.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:[" (",ct.success.length,")"]}),s.jsx("div",{className:"space-y-1",children:ct.success.map((he,ye)=>s.jsxs("div",{className:"p-2 bg-green-50 rounded-lg text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-mono text-green-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-green-600",children:he.ITEM_NM})]}),he.note&&s.jsxs("div",{className:"text-amber-600 mt-1 text-[10px]",children:[" ",he.note]})]},ye))})]}),ct.failed.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-red-700 mb-2",children:[" (",ct.failed.length,")"]}),s.jsx("div",{className:"space-y-1",children:ct.failed.map((he,ye)=>s.jsxs("div",{className:"p-2 bg-red-50 rounded-lg text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-mono text-red-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-red-600",children:he.ITEM_NM})]}),s.jsx("div",{className:"text-red-500 mt-1",children:he.error})]},ye))})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{xt(!1),Ge(null)},className:"w-full py-2.5 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-medium transition-colors",children:""})})]})}),nt&&Mt.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-r from-amber-500 to-amber-600",children:[s.jsxs("h3",{className:"font-semibold text-white text-lg flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"  "]}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[Mt.length,"     "]})]}),s.jsxs("div",{className:"p-4 max-h-60 overflow-y-auto",children:[s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"     .    ."}),s.jsx("div",{className:"space-y-2",children:Mt.map((he,ye)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-amber-50 rounded-lg text-xs",children:[s.jsx("span",{className:"font-mono text-amber-800",children:he.EQT_SERNO}),s.jsx("span",{className:"text-amber-600",children:he.ITEM_NM||he.ITEM_MID_NM||""})]},ye))})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{lt(!1),ut([])},className:"w-full py-2.5 bg-orange-500 hover:bg-amber-600 text-white rounded-lg font-medium transition-colors",children:""})})]})}),s.jsx(vm,{isOpen:S,onClose:()=>v(!1),onScan:It})]})},up=[{code:"",name:""},{code:"02",name:""},{code:"03",name:"CVT"},{code:"04",name:"STB"},{code:"05",name:"Smart card"},{code:"06",name:""},{code:"07",name:"Cable Card"},{code:"08",name:"IP"},{code:"10",name:"(AP)"},{code:"23",name:"OTT_STB()"}],GT=t=>{var n;if(!t)return"-";const e=t.replace(/[^A-Fa-f0-9]/g,"");return e.length!==12?t:((n=e.match(/.{2}/g))==null?void 0:n.join(":"))||t},Eq=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",Dq=({onBack:t,showToast:e})=>{const[n,r]=b.useState({userId:"",userName:"",soId:"",crrId:""}),[i,a]=b.useState({WRKR_ID:"",WRKR_NM:"",SO_ID:"",CRR_ID:""}),[o,c]=b.useState([]),[u,h]=b.useState([]),[m,_]=b.useState([]),[p,g]=b.useState(!1),[C,y]=b.useState(!1),S=b.useRef(!1),v=b.useRef(0),[k,L]=b.useState(null),[M,P]=b.useState([]),[F,G]=b.useState(!1),[B,I]=b.useState(!1),[E,A]=b.useState(!1),[Y,ee]=b.useState([]),[J,H]=b.useState(""),[V,K]=b.useState(null),[j,te]=b.useState(!1),[ce,R]=b.useState(new Set),[O,U]=b.useState("simple"),[Q,q]=b.useState(!1),[$,de]=b.useState(""),[ae,_e]=b.useState(!1),[ie,Ne]=b.useState(null),[X,xe]=b.useState([]),[fe,Z]=b.useState(!1),[le,se]=b.useState(""),[Re,be]=b.useState(""),[De,re]=b.useState([]),[me,ve]=b.useState(""),[et,Dt]=b.useState(!1),[ot,At]=b.useState(""),[ct,Ge]=b.useState(""),[at,xt]=b.useState([]),[mt,Ve]=b.useState(!1),[it,Fe]=b.useState(!1),[nt,lt]=b.useState(null),[Mt,ut]=b.useState("");b.useEffect(()=>{qe()},[]),b.useEffect(()=>{if(!ot){xt([]),Ge("");return}(async()=>{try{console.log("[]  API :",ot);const ft=await AM({ITEM_MID_CD:ot});console.log("[]  API :",ft);const Ft=(Array.isArray(ft)?ft:(ft==null?void 0:ft.data)||[]).map(_t=>({code:_t.COMMON_CD||_t.EQT_CL_CD||"",name:_t.COMMON_CD_NM||_t.EQT_CL_NM||""})).filter(_t=>_t.code&&_t.name).sort((_t,qt)=>_t.name.localeCompare(qt.name));xt(Ft),console.log("[]   :",Ft.length,"",Ft)}catch(ft){console.error("[]  API :",ft);const st=new Map;o.forEach(_t=>{_t.ITEM_MID_CD===ot&&_t.EQT_CL_CD&&_t.EQT_CL_NM&&st.set(_t.EQT_CL_CD,_t.EQT_CL_NM)});const Ft=Array.from(st.entries()).map(([_t,qt])=>({code:_t,name:qt})).sort((_t,qt)=>_t.name.localeCompare(qt.name));xt(Ft),console.log("[]  fallback:",Ft.length,"")}})(),Ge("")},[ot]);const qe=async()=>{try{const ke=localStorage.getItem("userInfo");if(ke){const ft=JSON.parse(ke),st=ft.authSoList&&Array.isArray(ft.authSoList)?ft.authSoList:[];re(st);let Ft=ft.soId||"";!Ft&&st.length>0&&(Ft=st[0].SO_ID||""),r({userId:ft.userId||"",userName:ft.userName||"",soId:Ft,crrId:ft.crrId||""}),st.length>0&&ve(st[0].SO_ID||"")}}catch(ke){console.warn("   :",ke)}await Ee()},Ee=async()=>{const ke=localStorage.getItem("userInfo"),ft=localStorage.getItem("branchList");if(ke)try{const st=JSON.parse(ke);let Ft=[];if(st.authSoList&&Array.isArray(st.authSoList)&&st.authSoList.length>0)Ft=st.authSoList;else if(ft)try{const _t=JSON.parse(ft);Array.isArray(_t)&&_t.length>0&&(Ft=_t)}catch{}Ft.length===0&&st.soId&&(Ft=[{SO_ID:st.soId,SO_NM:st.soNm||`(${st.soId})`}]),Ft.length>0&&(h(Ft),a(_t=>({..._t,SO_ID:Ft[0].SO_ID}))),st.crrId&&(_([{CRR_ID:st.crrId,CORP_NM:st.crrNm||st.corpNm||`(${st.crrId})`}]),a(_t=>({..._t,CRR_ID:st.crrId})))}catch(st){console.warn("   :",st)}},Ye=async ke=>{const ft=ke.toUpperCase().replace(/[:-]/g,"");if(M.includes(ft)){e==null||e("  .","warning");return}P(st=>[...new Set([ft,...st])]),G(!0),A(!1)},pe=async()=>{if(M.length===0){e==null||e("  .","warning");return}L(null),g(!0);try{const ke=M[0],ft=await Ei("EquipmentMovement","getEquipmentHistoryInfo",()=>im({EQT_SERNO:ke}),{EQT_SERNO:ke});if(ft&&ft.length>0){const st=ft[0];let Ft=st.WRKR_ID||st.OWNER_WRKR_ID;if(!Ft&&st.EQT_LOC_NM){const jt=st.EQT_LOC_NM.match(/\(([A-Z]?\d+)\)$/);jt&&(Ft=jt[1])}const _t=st.WRKR_NM||st.OWNER_WRKR_NM||"",qt=st.CRR_ID||"";Ft?(a(jt=>({...jt,WRKR_ID:Ft,WRKR_NM:_t,CRR_ID:qt})),await Be(Ft,_t,qt,ke),q(!0)):L(`(${ke})   .`)}else L(`(${ke})   .`)}catch(ke){console.error("  :",ke),L("  .")}finally{g(!1)}},ge=async()=>{const ke=J.trim().toUpperCase().replace(/[:-]/g,"");if(!ke){e==null||e("(S/N) .","warning");return}L(null),g(!0),G(!1),console.log("========================================"),console.log("[ ] S/N  :",ke),console.log("[ ]  :",n.userId),console.log("[ ]   - 1:",ot||"",", 2:",ct||"");try{const ft=await Ei("EquipmentMovement","getEquipmentHistoryInfo",()=>im({EQT_SERNO:ke}),{EQT_SERNO:ke});console.log("[ ] getEquipmentHistoryInfo :",JSON.stringify(ft).substring(0,500));const st=Array.isArray(ft)?ft[0]:ft;if(console.log("[ ]   :",st?"OK":"NULL"),st&&st.EQT_SERNO){const Ft=st.EQT_LOC_TP_CD||"",_t=st.EQT_LOC_TP_CD_NM||st.EQT_LOC_TP_NM||"";if(console.log("[ ] EQT_LOC_TP_CD:",Ft||""),console.log("[ ] EQT_LOC_TP_CD_NM:",_t||""),console.log("[ ] EQT_LOC_NM:",st.EQT_LOC_NM||""),console.log("[ ] WRKR_ID  :",st.WRKR_ID||""),console.log("[ ] OWNER_WRKR_ID  :",st.OWNER_WRKR_ID||""),Ft==="4"){lt({EQT_SERNO:st.EQT_SERNO,EQT_NO:st.EQT_NO||"",ITEM_NM:st.ITEM_NM||st.EQT_CL_NM||"",ITEM_MID_NM:st.ITEM_MID_NM||"",SO_NM:st.SO_NM||"",EQT_LOC_NM:st.EQT_LOC_NM||"",EQT_LOC_TP_NM:"",MAC_ADDRESS:st.MAC_ADDRESS||"",WRKR_NM:st.WRKR_NM||st.OWNER_WRKR_NM||"-"}),Fe(!0),g(!1),H("");return}let qt=st.WRKR_ID||st.OWNER_WRKR_ID;if(!qt&&st.EQT_LOC_NM){const ye=st.EQT_LOC_NM.match(/\(([A-Z]?\d+)\)$/);ye&&(qt=ye[1]),console.log("[ ]   :",ye?ye[1]:" ")}const jt=st.WRKR_NM||st.OWNER_WRKR_NM||"",he=st.CRR_ID||"";if(console.log("[ ]  ownerWrkrId:",qt||""),console.log("[ ] ownerWrkrNm:",jt),qt)console.log("[ ]  WRKR_ID    searchEquipmentByWorker "),P([ke]),G(!1),a(ye=>({...ye,WRKR_ID:qt,WRKR_NM:jt,CRR_ID:he})),await Be(qt,jt,he,ke),q(!0);else{console.log("[ ]  WRKR_ID     "),console.log("[]   :",ke,":",_t);try{const ye=await OA({EQT_SERNO:ke}),je=Array.isArray(ye)?ye[0]:ye,Me=(je==null?void 0:je.EQT_LOC_TP_NM)||_t||"",tt=Me===""?"":Me;lt({EQT_SERNO:ke,EQT_NO:(je==null?void 0:je.EQT_NO)||st.EQT_NO||"",ITEM_NM:(je==null?void 0:je.ITEM_NM)||st.ITEM_NM||st.EQT_CL_NM||"",ITEM_MID_NM:(je==null?void 0:je.ITEM_MID_NM)||st.ITEM_MID_NM||"",SO_NM:(je==null?void 0:je.SO_NM)||st.SO_NM||"",EQT_LOC_NM:(je==null?void 0:je.EQT_LOC_NM)||st.EQT_LOC_NM||"",EQT_LOC_TP_NM:tt,MAC_ADDRESS:(je==null?void 0:je.MAC_ADDRESS)||st.MAC_ADDRESS||"",WRKR_NM:jt}),Fe(!0)}catch{const je=_t===""?"":_t||" ";lt({EQT_SERNO:ke,EQT_NO:st.EQT_NO||"",ITEM_NM:st.ITEM_NM||st.EQT_CL_NM||"",ITEM_MID_NM:st.ITEM_MID_NM||"",SO_NM:st.SO_NM||"",EQT_LOC_NM:st.EQT_LOC_NM||"",EQT_LOC_TP_NM:je,MAC_ADDRESS:st.MAC_ADDRESS||"",WRKR_NM:jt}),Fe(!0)}}}else ut(`S/N: ${ke}`),q(!0),L(`(${ke})   .`)}catch(ft){console.error("  :",ft),L("  .")}finally{g(!1),H("")}},Be=async(ke,ft,st,Ft)=>{var _t,qt,jt,he;g(!0);try{const ye={WRKR_ID:ke,CRR_ID:"",SO_ID:""};if(Ft){const Me=M.length>0?[...new Set([Ft,...M])]:[Ft];ye.EQT_SERNO=Me.map(tt=>`'${tt}'`).join(",")}else M.length>0&&(ye.EQT_SERNO=M.map(Me=>`'${Me}'`).join(","));Ft||(ot&&(ye.ITEM_MID_CD=ot),ct&&(ye.EQT_CL_CD=ct));const je=await Ei("EquipmentMovement","getWrkrHaveEqtList",()=>Og(ye),ye);if(console.log("[ ] getWrkrHaveEqtList  :",Array.isArray(je)?je.length:"NOT_ARRAY"),Array.isArray(je)&&je.length>0){let Me=je;Ft?console.log("[ ] S/N   -   "):(ot&&(Me=je.filter(Te=>Te.ITEM_MID_CD===ot),console.log("[ ] 1   :",Me.length," (:",ot,")")),ct&&(Me=Me.filter(Te=>Te.EQT_CL_CD===ct),console.log("[ ] 2   :",Me.length," (:",ct,")")));let tt=Me.map(Te=>({CHK:!1,EQT_NO:Te.EQT_NO||"",ITEM_MAX_NM:Te.ITEM_MAX_NM||"",ITEM_MID_CD:Te.ITEM_MID_CD||"",ITEM_MID_NM:Te.ITEM_MID_NM||"",EQT_CL_CD:Te.EQT_CL_CD||"",EQT_CL_NM:Te.EQT_CL_NM||"",ITEM_NM:Te.ITEM_NM||"",ITEM_SPEC:Te.ITEM_SPEC||"",MST_SO_ID:Te.MST_SO_ID||"",MST_SO_NM:Te.MST_SO_NM||"",SO_ID:Te.SO_ID||"",SO_NM:Te.SO_NM||"",EQT_SERNO:Te.EQT_SERNO||"",MAC_ADDRESS:Te.MAC_ADDRESS||"",TA_MAC_ADDRESS:Te.TA_MAC_ADDRESS||"",WRKR_NM:Te.WRKR_NM||ft,CRR_NM:Te.CRR_NM||"",EQT_STAT_CD_NM:Te.EQT_STAT_CD_NM||"",CHG_KND_NM:Te.CHG_KND_NM||"",EQT_LOC_NM:Te.EQT_LOC_NM||"",EQT_LOC_TP_NM:Te.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:Te.OLD_EQT_LOC_NM||"",OLD_EQT_LOC_TP_NM:Te.OLD_EQT_LOC_TP_NM||"",ITEM_MODEL:Te.ITEM_MODEL||"",MODEL_NM:Te.MODEL_NM||"",EQT_USE_ARR_YN:Te.EQT_USE_ARR_YN||"",EQT_USE_END_DT:Te.EQT_USE_END_DT||"",isScanned:Ft&&Te.EQT_SERNO===Ft||M.includes(Te.EQT_SERNO),isTransferable:!0}));if(tt.sort((Te,bt)=>Te.isScanned&&!bt.isScanned?-1:!Te.isScanned&&bt.isScanned?1:0),tt=tt.map(Te=>({...Te,CHK:Te.isScanned||!1})),tt.length>0)console.log("[ ]   :",tt.length," "),c(tt);else{console.log("[ ]     0 -    "),c([]);const Te=ot?(_t=up.find(St=>St.code===ot))==null?void 0:_t.name:"",bt=ct?(qt=at.find(St=>St.code===ct))==null?void 0:qt.name:"";let Ke="";Te&&(Ke+=`, 1: ${Te}`),bt&&(Ke+=`, 2: ${bt}`),ut(`: ${ft}${Ke}`)}}else{console.log("[ ]  API      "),c([]);const Me=ot?(jt=up.find(bt=>bt.code===ot))==null?void 0:jt.name:"",tt=ct?(he=at.find(bt=>bt.code===ct))==null?void 0:he.name:"";let Te="";Me&&(Te+=`, 1: ${Me}`),tt&&(Te+=`, 2: ${tt}`),ut(`: ${ft}${Te}`)}}catch(ye){console.error("  :",ye),L("  ."),c([])}finally{g(!1)}},ue=async()=>{if(L(null),!i.WRKR_ID){e==null||e(" .","warning");return}await Be(i.WRKR_ID,i.WRKR_NM,i.CRR_ID),q(!0)},we=()=>{de(""),ee([]),I(!0)},Je=async()=>{const ke=$.trim();if(!ke){e==null||e("  ID .","warning");return}const st=/[-]/.test(ke);if(st&&ke.length<2){e==null||e(" 2  .","warning");return}_e(!0);try{if(st){console.log("[]  :",ke);let Ft=await mp({USR_NM:ke});if(console.log("[]   :",Ft.length,""),Ft.length===0){const _t=localStorage.getItem("user")||localStorage.getItem("userInfo");if(_t)try{const qt=JSON.parse(_t),jt=qt.AUTH_SO_List||qt.authSoList||[];if(jt.length>0){console.log("[]     -  SO_ID  :",jt.map(Te=>Te.SO_ID).join(", "));const he=jt.map(Te=>mp({SO_ID:Te.SO_ID}).catch(()=>[])),ye=await Promise.all(he),je=new Map;ye.forEach(Te=>{Te.forEach(bt=>{bt.USR_ID&&!je.has(bt.USR_ID)&&je.set(bt.USR_ID,bt)})});const Me=Array.from(je.values());console.log("[]  :",Me.length," ()");const tt=ke.toLowerCase();Ft=Me.filter(Te=>(Te.USR_NM||Te.USR_NAME_EN||"").toLowerCase().includes(tt)),console.log("[]   :",Ft.length,"")}}catch(qt){console.error("[] user  :",qt)}}if(Ft.length>0){const _t=Ft.slice(0,30).map(qt=>({USR_ID:qt.USR_ID||qt.WRKR_ID||"",USR_NM:qt.USR_NM||qt.USR_NAME_EN||qt.WRKR_NM||"-",CRR_ID:qt.CRR_ID||"",SO_ID:qt.SO_ID||"",SO_NM:qt.SO_NM||"",CORP_NM:qt.CORP_NM||""}));ee(_t)}else ee([])}else{console.log("[] ID :",ke.toUpperCase());const Ft=await mp({USR_ID:ke.toUpperCase()});if(Ft&&Ft.length>0){const _t=Ft[0];ee([{USR_ID:_t.USR_ID||ke.toUpperCase(),USR_NM:_t.USR_NM||_t.WRKR_NM||ke.toUpperCase(),CRR_ID:_t.CRR_ID||"",SO_ID:_t.SO_ID||"",SO_NM:_t.SO_NM||"",CORP_NM:_t.CORP_NM||""}])}else ee([])}}catch(Ft){console.error("  :",Ft),e==null||e("  .","error"),ee([])}finally{_e(!1)}},Pe=(ke,ft)=>{const st=[...X];st[ke].CHK=ft,xe(st)},Nt=ke=>{xe(X.map(ft=>!le||(ft.ITEM_MID_NM||ft.EQT_CL_NM||"")===le?{...ft,CHK:ke}:ft))},Oe=()=>{const ke=X.filter(ft=>ft.CHK);if(ke.length===0){e==null||e("  .","warning");return}ie&&a(ft=>({...ft,WRKR_ID:ie.USR_ID,WRKR_NM:ie.USR_NM,CRR_ID:ie.CRR_ID||""})),c(ke),q(!0),Ne(null),xe([]),ee([]),de(""),I(!1)},dt=()=>{Ne(null),xe([])},gt=ke=>{a(ft=>({...ft,WRKR_ID:ke.USR_ID,WRKR_NM:ke.USR_NM,CRR_ID:ke.CRR_ID||""})),I(!1),c([]),P([]),q(!1)},It=()=>{q(!1),c([]),P([]),a(ke=>({...ke,WRKR_ID:"",WRKR_NM:""})),H(""),setSelectionMode("none")},$e=async()=>{if(S.current){console.log("[] transferLockRef  -   ");return}const ke=Date.now();if(ke-v.current<3e3){console.log("[]   - 3   ");return}if(p||C){console.log("[] isLoading/isTransferring  -   ");return}S.current=!0,v.current=ke;const ft=o.filter(qt=>qt.CHK);if(ft.length===0){S.current=!1,e==null||e("  .","warning");return}if(!n.userId){S.current=!1,e==null||e("  .","error");return}if(i.WRKR_ID===n.userId){S.current=!1,e==null||e("    .","warning");return}g(!0),y(!0);const st={success:[],failed:[]},_t=`TRANSFER_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log(""),console.log(""),console.log("                                                "),console.log(""),console.log(` DEBUG_ID: ${_t}`),console.log(` : ${new Date().toISOString()}`),console.log(` : ${ft.length}`),console.log(` : ${i.WRKR_ID} (${i.WRKR_NM})`),console.log(` : ${n.userId} (${n.userName})`),console.log(`  CRR_ID: ${n.crrId}`),console.log(` SO_ID: ${me||"( SO_ID )"}`),console.log(` AUTH_SO_LIST: [${De.map(qt=>qt.SO_ID).join(", ")}]`),console.log(""),console.log(""),console.log("[DEBUG]   :"),ft.forEach((qt,jt)=>{console.log(`  [${jt+1}] EQT_NO=${qt.EQT_NO}, EQT_SERNO=${qt.EQT_SERNO}, SO_ID=${qt.SO_ID}, SO_NM=${qt.SO_NM||"-"}`)}),console.log("");try{for(let qt=0;qt<ft.length;qt++){const jt=ft[qt],he=Date.now();console.log(""),console.log(""),console.log(`  [${qt+1}/${ft.length}]    `),console.log(` EQT_SERNO: ${jt.EQT_SERNO}`),console.log(` EQT_NO: ${jt.EQT_NO}`),console.log(`  SO_ID: ${jt.SO_ID}`),console.log("");try{const ye={SO_ID:jt.SO_ID,EQT_NO:jt.EQT_NO,EQT_SERNO:jt.EQT_SERNO,CHG_UID:n.userId,MV_SO_ID:me||jt.SO_ID,MV_CRR_ID:n.crrId,MV_WRKR_ID:n.userId};console.log("[DEBUG] API  :",JSON.stringify(ye,null,2)),console.log(`[DEBUG] API  : ${new Date().toISOString()}`);const je=await yA(ye),Me=Date.now()-he;console.log(`[DEBUG] API  : ${new Date().toISOString()} (: ${Me}ms)`),console.log("[DEBUG] API :",JSON.stringify(je,null,2)),st.success.push({EQT_SERNO:jt.EQT_SERNO,EQT_NO:jt.EQT_NO,ITEM_NM:jt.ITEM_NM||jt.EQT_CL_NM}),PA({EQT_NO:jt.EQT_NO,EQT_SERNO:jt.EQT_SERNO,ITEM_NM:jt.ITEM_NM||jt.EQT_CL_NM,ITEM_MID_NM:jt.ITEM_MID_NM,ITEM_MAX_NM:jt.ITEM_MAX_NM,EQT_CL_NM:jt.EQT_CL_NM,SO_ID:jt.SO_ID||"",SO_NM:jt.SO_NM||jt.MST_SO_NM||"",FROM_WRKR_ID:i.WRKR_ID,FROM_WRKR_NM:i.WRKR_NM,TO_WRKR_ID:n.userId})}catch(ye){console.error("  :",jt.EQT_SERNO,ye),st.failed.push({EQT_SERNO:jt.EQT_SERNO,EQT_NO:jt.EQT_NO,ITEM_NM:jt.ITEM_NM||jt.EQT_CL_NM,error:(ye==null?void 0:ye.message)||"   "})}}if(K(st),te(!0),st.success.length>0){const qt=new Set(st.success.map(jt=>jt.EQT_NO));c(jt=>jt.filter(he=>!qt.has(he.EQT_NO))),P(jt=>jt.filter(he=>!st.success.some(ye=>ye.EQT_SERNO===he)))}}catch(qt){console.error("  :",qt),e==null||e("  .","error")}finally{g(!1),y(!1),setTimeout(()=>{S.current=!1},1e3)}},$t=ke=>{c(o.map(ft=>({...ft,CHK:ke})))},Ue=(ke,ft)=>{const st=[...o];st[ke].CHK=ft,c(st)},ss=(ke,ft)=>{c(o.map(st=>(st.SO_NM||st.SO_ID||"")===ke?{...st,CHK:ft}:st))},ls=(ke,ft,st)=>{c(o.map(Ft=>{const _t=Ft.SO_NM||Ft.SO_ID||"",qt=Ft.ITEM_MID_NM||"";return _t===ke&&qt===ft?{...Ft,CHK:st}:Ft}))},ds=ke=>{R(ft=>{const st=new Set(Array.from(ft));return st.has(ke)?st.delete(ke):st.add(ke),st})},vs=o.reduce((ke,ft,st)=>{var je,Me,tt,Te;let Ft="";const _t=(je=ft.SO_NM)==null?void 0:je.trim(),qt=(Me=ft.MST_SO_NM)==null?void 0:Me.trim(),jt=(tt=ft.SO_ID)==null?void 0:tt.trim(),he=(Te=ft.MST_SO_ID)==null?void 0:Te.trim();_t&&_t!=="100"?Ft=_t:qt&&qt!=="100"?Ft=qt:jt==="100"||he==="100"||_t==="100"||qt==="100"?Ft="":jt&&(Ft=jt);const ye=ft.ITEM_MID_NM||"";return ke[Ft]||(ke[Ft]={}),ke[Ft][ye]||(ke[Ft][ye]=[]),ke[Ft][ye].push({...ft,_globalIdx:st}),ke},{});Object.keys(vs).forEach(ke=>{Object.keys(vs[ke]).forEach(ft=>{vs[ke][ft].sort((st,Ft)=>{const _t=st.EQT_CL_NM||st.ITEM_NM||"",qt=Ft.EQT_CL_NM||Ft.ITEM_NM||"";return _t.localeCompare(qt)})})});const Ss=Object.keys(vs).sort();return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-1 cursor-pointer",onClick:we,children:[s.jsx("input",{type:"text",value:i.WRKR_NM||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer truncate text-center",placeholder:""}),s.jsx("input",{type:"text",value:i.WRKR_ID||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer font-mono text-center",placeholder:"ID"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("select",{value:ot,onChange:ke=>At(ke.target.value),className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent truncate",children:[s.jsx("option",{value:"",children:""}),up.filter(ke=>ke.code!=="").map(ke=>s.jsx("option",{value:ke.code,children:ke.name},ke.code))]}),s.jsxs("select",{value:ct,onChange:ke=>Ge(ke.target.value),disabled:!ot||mt||at.length===0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed truncate",children:[s.jsx("option",{value:"",children:ot?mt?"...":at.length===0?"-":"":"-"}),at.map(ke=>s.jsx("option",{value:ke.code,children:ke.name},ke.code))]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:J,onChange:ke=>H(ke.target.value.toUpperCase()),onKeyDown:ke=>ke.key==="Enter"&&J.trim()&&ge(),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono",placeholder:"S/N  MAC  "}),s.jsxs("button",{onClick:()=>A(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),M.length>0&&s.jsxs("div",{className:`p-3 border rounded-lg ${F?"bg-purple-50 border-purple-200":"bg-blue-50 border-blue-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:`text-xs font-medium ${F?"text-purple-700":"text-blue-700"}`,children:[F?" ":" "," (",M.length,")"]}),s.jsx("button",{onClick:()=>{P([]),c([])},className:"text-xs text-gray-500 hover:text-gray-700",children:""})]}),s.jsx("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:M.map((ke,ft)=>s.jsxs("div",{className:"flex items-center justify-between text-xs bg-white px-2 py-1 rounded",children:[s.jsx("span",{className:"font-mono text-gray-800",children:ke}),s.jsx("button",{onClick:()=>{const st=M.filter(Ft=>Ft!==ke);P(st),st.length===0&&c([])},className:"text-red-400 hover:text-red-600",children:s.jsx(Mi,{className:"w-3 h-3"})})]},ft))})]}),s.jsx("button",{onClick:()=>{var ft,st;const ke=[];if(i.WRKR_NM&&ke.push(`: ${i.WRKR_NM}`),ot){const Ft=(ft=up.find(_t=>_t.code===ot))==null?void 0:ft.name;Ft&&ke.push(`1: ${Ft}`)}if(ct){const Ft=(st=at.find(_t=>_t.code===ct))==null?void 0:st.name;Ft&&ke.push(`2: ${Ft}`)}J.trim()&&ke.push(`S/N: ${J.trim()}`),ut(ke.join(", ")||""),J.trim()?ge():M.length>0?pe():i.WRKR_ID?ue():e==null||e("   .","warning")},disabled:p||!i.WRKR_ID&&!J.trim()&&M.length===0,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-2.5 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation",children:p?" ...":""})]})}),o.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:It,className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0",title:"",children:s.jsx(Ai,{className:"w-4 h-4"})}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:ke=>$t(ke.target.checked),checked:o.length>0&&o.every(ke=>ke.CHK),className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," (: ",o.filter(ke=>ke.CHK).length,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>U("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${O==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>U("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${O==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:Ss.map(ke=>{const ft=vs[ke],st=Object.keys(ft).sort(),Ft=ce.has(ke),_t=st.reduce((ye,je)=>ye+ft[je].length,0),qt=st.flatMap(ye=>ft[ye]),jt=qt.every(ye=>ye.CHK),he=qt.some(ye=>ye.CHK);return s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 py-2 bg-blue-50 flex items-center justify-between cursor-pointer hover:bg-blue-100",onClick:()=>ds(ke),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:jt,onClick:ye=>ye.stopPropagation(),onChange:ye=>ss(ke,ye.target.checked),className:"rounded"}),s.jsx("span",{className:"text-sm font-bold text-blue-800",children:ke}),s.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[_t," ",he&&!jt&&`(${qt.filter(ye=>ye.CHK).length})`]})]}),Ft?s.jsx(ir,{className:"w-4 h-4 text-blue-600"}):s.jsx(kr,{className:"w-4 h-4 text-blue-600"})]}),!Ft&&st.map(ye=>{const je=ft[ye],Me=`${ke}-${ye}`,tt=ce.has(Me),Te=je.every(Ke=>Ke.CHK),bt=je.some(Ke=>Ke.CHK);return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>ds(Me),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:Te,onClick:Ke=>Ke.stopPropagation(),onChange:Ke=>ls(ke,ye,Ke.target.checked),className:"rounded w-4 h-4"}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:ye}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[je.length," ",bt&&!Te&&`(${je.filter(Ke=>Ke.CHK).length})`]})]}),tt?s.jsx(ir,{className:"w-3 h-3 text-gray-500"}):s.jsx(kr,{className:"w-3 h-3 text-gray-500"})]}),!tt&&s.jsx("div",{className:"space-y-2",children:je.map((Ke,St)=>{const Et=Ke._globalIdx;return s.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${Ke.isScanned?"bg-purple-50 border-purple-200":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:Ke.CHK||!1,onChange:ze=>Ue(Et,ze.target.checked),className:"w-5 h-5 rounded focus:ring-blue-500 mt-0.5 text-blue-500"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-base font-bold truncate text-gray-900",children:Ke.EQT_CL_NM||Ke.ITEM_NM||"-"}),s.jsx("div",{className:"flex items-center gap-1 flex-shrink-0 ml-2",children:Ke.isScanned&&F&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""})})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),Ke.EQT_SERNO||"-"]}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${Ke.EQT_USE_ARR_YN==="Y"?"bg-green-100 text-green-700":Ke.EQT_USE_ARR_YN==="A"?"bg-purple-100 text-purple-700":Ke.EQT_USE_ARR_YN==="N"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:Ke.EQT_USE_ARR_YN==="Y"?"":Ke.EQT_USE_ARR_YN==="A"?"":Ke.EQT_USE_ARR_YN==="N"?"":"N/A"})]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),GT(Ke.MAC_ADDRESS)]}),s.jsx("span",{className:"text-sm text-gray-600",children:Eq(Ke.EQT_USE_END_DT||"")})]})]})]}),O==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:Ke.ITEM_MODEL||Ke.MODEL_NM||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:Ke.SO_NM||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Ke.EQT_STAT_CD_NM||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:Ke.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Ke.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Ke.EQT_LOC_NM||Ke.EQT_LOC_TP_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:Ke.OLD_EQT_LOC_NM||"-"})]})]})]},Ke.EQT_NO||St)})})]},Me)})]},ke)})})]}),s.jsx("div",{className:"h-24"})]}),o.length===0&&!p&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:k?s.jsx(s.Fragment,{children:"   "}):s.jsx(s.Fragment,{children:"  "})}),s.jsx("p",{className:"text-gray-400 text-xs",children:k?s.jsx(s.Fragment,{children:"S/N  MAC  "}):s.jsx(s.Fragment,{children:"     "})})]})}),p&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsx("p",{className:"text-center text-gray-500 text-sm",children:" ..."})}),o.length>0&&s.jsx("div",{className:"fixed bottom-16 left-0 right-0 px-4 pb-2 z-[45]",children:s.jsx("button",{onClick:()=>!C&&Dt(!0),disabled:o.filter(ke=>ke.CHK).length===0||C,className:`w-full py-4 rounded-xl font-bold text-base shadow-lg flex items-center justify-center gap-2 transition-all touch-manipulation ${C?"bg-gray-400 text-gray-200 cursor-not-allowed":o.filter(ke=>ke.CHK).length>0?"bg-gradient-to-r from-blue-500 to-blue-600 text-white active:scale-[0.98]":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:C?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(jc,{className:"w-5 h-5"}),"  (",o.filter(ke=>ke.CHK).length,")"]})})}),s.jsx(Ra,{isOpen:et,onClose:()=>Dt(!1),title:"  ",size:"large",footer:s.jsxs("div",{className:"w-full grid grid-cols-2 gap-4",children:[s.jsx("button",{onClick:()=>Dt(!1),className:"py-4 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-semibold text-base transition-colors touch-manipulation",children:""}),s.jsx("button",{onClick:()=>{C||(Dt(!1),$e())},disabled:C,className:`py-4 rounded-xl font-semibold text-base shadow-lg transition-all touch-manipulation ${C?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-blue-600 text-white active:scale-[0.98]"}`,children:C?"...":""})]}),children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl p-4 bg-blue-50 border border-blue-200",children:[s.jsx("label",{className:"block text-sm font-semibold mb-2 text-blue-800",children:" "}),De.length>1?s.jsxs(s.Fragment,{children:[s.jsx("select",{value:me,onChange:ke=>ve(ke.target.value),className:"w-full px-4 py-3 border border-blue-300 rounded-xl text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:De.map(ke=>s.jsxs("option",{value:ke.SO_ID,children:[ke.SO_NM," (",ke.SO_ID,")"]},ke.SO_ID))}),s.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"   "})]}):De.length===1?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"w-full px-4 py-3 border border-blue-300 rounded-xl text-sm bg-blue-100 text-blue-900 font-semibold",children:[De[0].SO_NM," (",De[0].SO_ID,")"]}),s.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"    "})]}):null]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:" "})}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsxs("span",{className:"font-medium text-gray-900",children:[i.WRKR_NM," (",i.WRKR_ID,")"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsxs("span",{className:"font-medium text-gray-900",children:[n.userName," (",n.userId,")"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsxs("span",{className:"font-bold text-blue-600",children:[o.filter(ke=>ke.CHK).length,""]})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[s.jsx("div",{className:"bg-gray-100 px-4 py-2 border-b border-gray-200",children:s.jsx("span",{className:"text-xs font-semibold text-gray-600",children:" "})}),s.jsx("div",{className:"max-h-48 overflow-y-auto divide-y divide-gray-100",children:o.filter(ke=>ke.CHK).map((ke,ft)=>s.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] rounded font-medium",children:ke.ITEM_MID_NM||ke.EQT_CL_NM||""}),s.jsx("span",{className:"text-xs font-mono text-gray-800",children:ke.EQT_SERNO})]}),s.jsx("span",{className:"text-[10px] text-gray-500",children:ke.SO_NM||ke.SO_ID})]},ke.EQT_NO||ft))})]})]})}),s.jsx(Ra,{isOpen:B,onClose:()=>{I(!1),Ne(null),xe([]),ee([]),de("")},title:ie?`${ie.USR_NM} `:" ",size:"large",subHeader:ie?s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("button",{onClick:dt,className:"flex items-center gap-1 text-sm text-gray-600 hover:text-gray-900",children:[s.jsx(kr,{className:"w-4 h-4 rotate-[-90deg]"}),""]}),s.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[s.jsx("input",{type:"checkbox",onChange:ke=>Nt(ke.target.checked),checked:(()=>{const ke=X.filter(ft=>!le||(ft.ITEM_MID_NM||ft.EQT_CL_NM||"")===le);return ke.length>0&&ke.every(ft=>ft.CHK)})(),className:"rounded"}),le?`${le} `:""]})]}):s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:$,onChange:ke=>de(ke.target.value),onKeyDown:ke=>ke.key==="Enter"&&Je(),className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500",placeholder:"  ID ",autoFocus:!0}),s.jsx("button",{onClick:Je,disabled:ae,className:"px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg font-medium text-sm touch-manipulation",children:ae?"...":""})]})}),footer:ie?s.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:dt,className:"py-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-semibold text-sm transition-colors touch-manipulation",children:""}),s.jsxs("button",{onClick:Oe,disabled:X.filter(ke=>ke.CHK).length===0,className:"py-3 bg-gradient-to-r from-blue-500 to-blue-600 disabled:from-gray-300 disabled:to-gray-400 text-white rounded-xl font-semibold text-sm shadow-lg active:scale-[0.98] transition-all touch-manipulation",children:["  (",X.filter(ke=>ke.CHK).length,")"]})]}):s.jsx("button",{onClick:()=>I(!1),className:"w-full py-2.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg font-medium transition-colors touch-manipulation",children:""}),children:ie?fe?s.jsx("div",{className:"py-8 text-center text-gray-500 text-sm",children:"  ..."}):X.length===0?s.jsx("div",{className:"p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"    "})]})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-4 py-2 border-b border-gray-100 bg-gray-50",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-600 font-medium",children:":"}),s.jsxs("select",{value:le,onChange:ke=>se(ke.target.value),className:"flex-1 text-xs border border-gray-200 rounded-lg px-2 py-1.5 bg-white focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsxs("option",{value:"",children:[" (",X.length,")"]}),Array.from(new Set(X.map(ke=>ke.ITEM_MID_NM||ke.EQT_CL_NM||""))).sort().map(ke=>{const ft=X.filter(st=>(st.ITEM_MID_NM||st.EQT_CL_NM||"")===ke).length;return s.jsxs("option",{value:ke,children:[ke," (",ft,")"]},ke)})]})]})}),s.jsx("div",{className:"divide-y divide-gray-100 max-h-72 overflow-y-auto",children:X.map((ke,ft)=>({item:ke,idx:ft})).filter(({item:ke})=>!le||(ke.ITEM_MID_NM||ke.EQT_CL_NM||"")===le).map(({item:ke,idx:ft})=>s.jsxs("div",{className:`px-4 py-3 flex items-center gap-3 ${ke.CHK?"bg-blue-50":"hover:bg-gray-50"}`,children:[s.jsx("input",{type:"checkbox",checked:ke.CHK||!1,onChange:st=>Pe(ft,st.target.checked),className:"rounded flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"px-1.5 py-0.5 text-[10px] rounded font-medium bg-blue-100 text-blue-700",children:ke.ITEM_MID_NM||ke.EQT_CL_NM||""}),s.jsx("span",{className:"font-mono text-xs truncate text-gray-800",children:ke.EQT_SERNO||"-"})]}),s.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:ke.SO_NM||ke.SO_ID||""})]})]},ke.EQT_NO||ft))})]}):Y.length===0?s.jsx("div",{className:"py-8 text-center text-gray-500 text-sm",children:ae?" ...":"  ID "}):s.jsx("div",{className:"divide-y divide-gray-100",children:Y.map((ke,ft)=>s.jsxs("button",{onClick:()=>gt(ke),className:"w-full px-4 py-3 text-left hover:bg-green-50 flex justify-between items-center transition-colors active:bg-green-100 touch-manipulation",children:[s.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-gray-900",children:ke.USR_NM}),s.jsxs("span",{className:"text-xs text-gray-500 font-mono",children:["(",ke.USR_ID,")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[ke.SO_NM&&s.jsx("span",{className:"text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:ke.SO_NM}),ke.CORP_NM&&s.jsx("span",{className:"text-purple-600 bg-purple-50 px-1.5 py-0.5 rounded",children:ke.CORP_NM}),!ke.SO_NM&&!ke.CORP_NM&&s.jsx("span",{className:"text-gray-400",children:"-"})]})]}),s.jsx("span",{className:"text-xs px-2 py-1 rounded text-blue-600 bg-blue-50 font-medium",children:ke.EQT_COUNT!==void 0?`${ke.EQT_COUNT}`:""})]},ft))})}),s.jsx(vm,{isOpen:E,onClose:()=>A(!1),onScan:Ye,isMultiScanMode:!1,scanCount:M.length}),j&&V&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden",children:[s.jsxs("div",{className:`p-4 ${V.failed.length===0?"bg-gradient-to-r from-green-500 to-green-600":V.success.length===0?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-amber-500 to-amber-600"}`,children:[s.jsx("h3",{className:"font-semibold text-white text-lg",children:V.failed.length===0?" ":V.success.length===0?" ":" "}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[": ",V.success.length," / : ",V.failed.length,""]})]}),s.jsxs("div",{className:"p-4 max-h-96 overflow-y-auto space-y-4",children:[V.success.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-green-700 mb-2 flex items-center gap-2",children:[s.jsx(jc,{className:"w-4 h-4"})," (",V.success.length,")"]}),s.jsx("div",{className:"space-y-1",children:V.success.map((ke,ft)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded-lg text-xs",children:[s.jsx("span",{className:"font-mono text-green-800",children:ke.EQT_SERNO}),s.jsx("span",{className:"text-green-600",children:ke.ITEM_NM})]},ft))})]}),V.failed.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-red-700 mb-2 flex items-center gap-2",children:[s.jsx(Mi,{className:"w-4 h-4"})," (",V.failed.length,")"]}),s.jsx("div",{className:"space-y-1",children:V.failed.map((ke,ft)=>s.jsxs("div",{className:"p-2 bg-red-50 rounded-lg text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-mono text-red-800",children:ke.EQT_SERNO}),s.jsx("span",{className:"text-red-600",children:ke.ITEM_NM})]}),s.jsx("div",{className:"text-red-500 mt-1",children:ke.error})]},ft))})]})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{te(!1),K(null)},className:"w-full py-2.5 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-medium transition-colors",children:""})})]})}),it&&nt&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[s.jsxs("div",{className:`p-4 ${nt.EQT_LOC_TP_NM===""?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-purple-500 to-purple-600"}`,children:[s.jsxs("h3",{className:"font-semibold text-white text-lg flex items-center gap-2",children:[s.jsx(go,{className:"w-5 h-5"}),nt.EQT_LOC_TP_NM===""?" ":" "]}),s.jsxs("p",{className:"text-white/80 text-sm mt-1",children:["  ",nt.EQT_LOC_TP_NM===""?"  ":nt.EQT_LOC_TP_NM===""?" ":" "]})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"S/N"}),s.jsx("span",{className:"font-mono font-medium text-gray-900",children:nt.EQT_SERNO})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"font-medium text-gray-900",children:nt.ITEM_NM||"-"})]}),nt.ITEM_MID_NM&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700",children:nt.ITEM_MID_NM})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700",children:nt.SO_NM||"-"})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:`font-medium ${nt.EQT_LOC_TP_NM===""?"text-amber-600":nt.EQT_LOC_TP_NM===""?"text-purple-600":"text-gray-600"}`,children:nt.EQT_LOC_TP_NM})]}),nt.EQT_LOC_NM&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700 text-right max-w-[200px] truncate",children:nt.EQT_LOC_NM})]}),nt.WRKR_NM&&nt.WRKR_NM!=="-"&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"text-gray-700",children:nt.WRKR_NM})]}),nt.MAC_ADDRESS&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"MAC"}),s.jsx("span",{className:"font-mono text-xs text-gray-600",children:GT(nt.MAC_ADDRESS)})]})]}),nt.EQT_LOC_TP_NM===""&&s.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded-lg",children:"    . /   ."})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:s.jsx("button",{onClick:()=>{Fe(!1),lt(null)},className:"w-full py-2.5 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-medium transition-colors",children:""})})]})})]})},Rq=t=>t?t.length===8&&!t.includes("-")&&!t.includes(".")?`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`:t.includes(".")?t.replace(/\./g,"-"):t:"-",Tq=t=>{var n;if(!t)return"-";const e=t.replace(/[^A-Fa-f0-9]/g,"");return e.length!==12?t:((n=e.match(/.{2}/g))==null?void 0:n.join(":"))||t},Mq=t=>{if(!t)return"-";const e=t.replace(/[^0-9]/g,"");return e.length===10?`${e.slice(0,3)}-${e.slice(3,6)}-${e.slice(6,10)}`:t},Iq=({isOpen:t,onClose:e,selectedItems:n,onProcess:r,isProcessing:i,soList:a,userSoId:o,showToast:c})=>{const[u,h]=b.useState("");if(b.useEffect(()=>{t&&h("")},[t]),!t)return null;const m=()=>{if(!u){c==null||c("      .","warning");return}r("1",u)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-green-500 to-green-600",children:[s.jsx("h3",{className:"font-semibold text-white",children:"  "}),s.jsxs("p",{className:"text-xs text-white/80 mt-1",children:[n.length,"  "]})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 max-h-32 overflow-y-auto",children:n.map((_,p)=>s.jsxs("div",{className:"text-xs text-gray-600 py-1 border-b border-gray-100 last:border-0",children:[s.jsx("span",{className:"font-mono font-medium",children:_.EQT_SERNO}),s.jsx("span",{className:"text-gray-400 ml-2",children:_.CUST_NM})]},p))}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700",children:"  "}),s.jsxs("select",{value:u,onChange:_=>h(_.target.value),className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:i,children:[s.jsx("option",{value:"",children:" "}),a.map(_=>s.jsxs("option",{value:_.SO_ID,children:[_.SO_NM," (",_.SO_ID,")"]},_.SO_ID))]})]}),s.jsxs("button",{onClick:m,disabled:i,className:"w-full py-3 text-sm text-white bg-green-500 hover:bg-green-600 disabled:bg-gray-300 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[s.jsx(jc,{className:"w-4 h-4"}),i?" ...":" "]}),s.jsx("button",{onClick:e,disabled:i,className:"w-full py-2.5 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:""})]})]})})},jq=({isOpen:t,onClose:e,onSelect:n,onSerialSearch:r})=>{const[i,a]=b.useState(""),[o,c]=b.useState(""),[u,h]=b.useState(""),[m,_]=b.useState(""),[p,g]=b.useState(""),[C,y]=b.useState(!1),[S,v]=b.useState([]),[k,L]=b.useState(!1),[M,P]=b.useState(!1),[F,G]=b.useState(null),B=A=>{g(A.toUpperCase()),P(!1)};if(!t)return null;const I=async()=>{G(null);const A=i.length>=4,Y=o.length>=4,ee=u.length>=4,J=m.length>=2,H=ee&&J,V=p.length>=4;if(ee&&!J||!ee&&J){G(`   .
( 4 ,  2 )`);return}if(!A&&!Y&&!H&&!V){G(`    .
 ID (4 )
 ID (4 )
  +  (  )
 S/N (4 )`);return}let K="PHONE_NAME";A?K="CUSTOMER_ID":Y?K="CONTRACT_ID":V&&(K="EQUIPMENT_NO"),y(!0),L(!0);try{const j=await hV({searchType:K,customerId:A?i:void 0,contractId:Y?o:void 0,phoneNumber:H?u:void 0,customerName:H?m:void 0,equipmentNo:V?p:void 0});if(j.success&&j.data&&j.data.length>0)v(j.data);else if(V&&r){r(p),e();return}else v([])}catch(j){if(console.error("Customer search error:",j),V&&r){r(p),e();return}v([])}finally{y(!1)}},E=A=>{A.key==="Enter"&&I()};return s.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden max-h-[80vh] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-100 bg-gradient-to-r from-blue-500 to-blue-600 flex-shrink-0",children:s.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx(o0,{className:"w-4 h-4"})," "]})}),s.jsxs("div",{className:"p-4 space-y-3 flex-1 overflow-y-auto min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:i,onChange:A=>{a(A.target.value),G(null)},onKeyPress:E,placeholder:"ID",className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"ID"}),s.jsx("input",{type:"text",value:o,onChange:A=>{c(A.target.value),G(null)},onKeyPress:E,placeholder:"ID",className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:""}),s.jsxs("div",{className:"flex-1 flex gap-2 min-w-0",children:[s.jsx("input",{type:"tel",value:u,onChange:A=>{h(A.target.value.replace(/[^0-9]/g,"")),G(null)},onKeyPress:E,placeholder:"",className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",value:m,onChange:A=>{_(A.target.value),G(null)},onKeyPress:E,placeholder:"",className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-16 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:p,onChange:A=>{g(A.target.value.toUpperCase()),G(null)},onKeyPress:E,placeholder:"S/N  MAC  ",className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono"}),s.jsxs("button",{onClick:()=>P(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),F&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:s.jsx("p",{className:"text-red-600 text-sm whitespace-pre-line",children:F})}),k&&s.jsx("div",{className:"border-t border-gray-100 pt-3",children:S.length>0?s.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[s.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[" : ",S.length,""]}),S.map((A,Y)=>s.jsxs("button",{onClick:()=>{_(A.CUST_NM),n({CUST_ID:A.CUST_ID,CUST_NM:A.CUST_NM}),e()},className:"w-full p-3 bg-gray-50 hover:bg-blue-50 rounded-lg border border-gray-200 hover:border-blue-300 text-left transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-blue-600 font-mono text-sm",children:A.CUST_ID}),s.jsx("span",{className:"font-semibold text-gray-900",children:A.CUST_NM})]}),(A.INST_ADDR||A.ADDR||A.ADDRESS)&&s.jsx("div",{className:"mt-1 text-xs text-gray-500 truncate",children:A.INST_ADDR||A.ADDR||A.ADDRESS})]},A.CUST_ID||Y))]}):s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"  ."})})]}),s.jsx("div",{className:"p-4 border-t border-gray-100 bg-white flex-shrink-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:I,disabled:C,className:"flex-1 py-2.5 text-sm text-white bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 rounded-lg font-medium flex items-center justify-center",children:C?" ...":""}),s.jsx("button",{onClick:e,className:"flex-1 py-2.5 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium",children:""})]})})]}),s.jsx(vm,{isOpen:M,onClose:()=>P(!1),onScan:B})]})},Oq=({onBack:t,showToast:e})=>{const[n,r]=b.useState({CUST_ID:"",CUST_NM:"",PHONE_NO:"",EQT_CL_CD:"",EQT_SERNO:""}),[i,a]=b.useState(!1),[o,c]=b.useState(null),[u,h]=b.useState([]),[m,_]=b.useState(!1),[p,g]=b.useState(!1),[C,y]=b.useState(!1),[S,v]=b.useState(!1),[k,L]=b.useState([]),[M,P]=b.useState([]),[F,G]=b.useState(""),[B,I]=b.useState("simple"),[E,A]=b.useState("all"),[Y,ee]=b.useState(new Set),J=X=>{if(!X)return"";if(X==="100")return"";const xe=/^\d+$/.test(X);if(!xe&&M.find(le=>le.SO_NM===X))return X;const fe=M.find(Z=>Z.SO_ID===X);return fe&&fe.SO_NM?fe.SO_NM:xe?`(${X})`:X},H=X=>{ee(xe=>{const fe=new Set(Array.from(xe));return fe.has(X)?fe.delete(X):fe.add(X),fe})},V=X=>X.EQT_STAT_CD_NM===""?!0:X.LOSS_AMT!==""&&X.LOSS_AMT!=="0"&&Number(X.LOSS_AMT)>0,j=E==="all"?u:E==="lost"?u.filter(X=>V(X)):u.filter(X=>!V(X)),te=u.filter(X=>V(X)).length;u.length-te;const ce=j.reduce((X,xe,fe)=>{var re,me,ve,et;let Z="";const le=(re=xe.SO_NM)==null?void 0:re.trim(),se=(me=xe.MST_SO_NM)==null?void 0:me.trim(),Re=(ve=xe.SO_ID)==null?void 0:ve.trim(),be=(et=xe.MST_SO_ID)==null?void 0:et.trim();le&&le!=="100"?Z=le:se&&se!=="100"?Z=se:Re==="100"||be==="100"||le==="100"||se==="100"?Z="":Re&&(Z=Re);const De=xe.BIZ_CL_NM||xe.ITEM_MID_NM||xe.EQT_CL_NM||"";return X[Z]||(X[Z]={}),X[Z][De]||(X[Z][De]=[]),X[Z][De].push({...xe,_globalIdx:fe}),X},{});Object.keys(ce).forEach(X=>{Object.keys(ce[X]).forEach(xe=>{ce[X][xe].sort((fe,Z)=>{const le=fe.EQT_CL_NM||fe.ITEM_NM||"",se=Z.EQT_CL_NM||Z.ITEM_NM||"";return le.localeCompare(se)})})});const R=Object.keys(ce).sort(),O=(X,xe)=>{h(u.map(fe=>{const Z=fe.SO_NM||fe.SO_ID||"",le=V(fe);return Z===X&&le?{...fe,CHK:xe}:fe}))},U=(X,xe,fe)=>{h(u.map(Z=>{const le=Z.SO_NM||Z.SO_ID||"",se=Z.BIZ_CL_NM||Z.ITEM_MID_NM||Z.EQT_CL_NM||"",Re=V(Z);return le===X&&se===xe&&Re?{...Z,CHK:fe}:Z}))};b.useEffect(()=>{(()=>{try{const xe=sessionStorage.getItem("userInfo");if(xe){const le=JSON.parse(xe),se=le.soId||le.SO_ID||"";se&&(G(se),console.log("[]   :",se))}const fe=localStorage.getItem("branchList");if(fe){const le=JSON.parse(fe);if(Array.isArray(le)&&le.length>0){console.log("[] branchList   :",le.length,"");const se=le.map(be=>({SO_ID:be.SO_ID||be.soId||"",SO_NM:be.SO_NM||be.soNm||be.SO_ID||""})).filter(be=>be.SO_ID),Re=new Set;le.forEach(be=>{const De=be.MST_SO_ID||be.mstSoId;De&&!se.some(re=>re.SO_ID===De)&&Re.add(De)}),Re.forEach(be=>{se.push({SO_ID:be,SO_NM:""})}),P(se);return}}const Z=localStorage.getItem("userInfo");if(Z){const le=JSON.parse(Z),se=le.authSoList||le.AUTH_SO_List||[];if(Array.isArray(se)&&se.length>0){console.log("[] authSoList   :",se.length,"");const Re=se.map(De=>({SO_ID:De.SO_ID||De.soId||"",SO_NM:De.SO_NM||De.soNm||De.SO_ID||""})).filter(De=>De.SO_ID),be=new Set;se.forEach(De=>{const re=De.MST_SO_ID||De.mstSoId;re&&!Re.some(me=>me.SO_ID===re)&&be.add(re)}),be.forEach(De=>{Re.push({SO_ID:De,SO_NM:""})}),P(Re);return}}if(xe){const le=JSON.parse(xe),se=le.authSoList||le.AUTH_SO_List||[];if(Array.isArray(se)&&se.length>0){console.log("[] sessionStorage authSoList   :",se.length,"");const re=se.map(ve=>({SO_ID:ve.SO_ID||ve.soId||"",SO_NM:ve.SO_NM||ve.soNm||ve.SO_ID||""})).filter(ve=>ve.SO_ID),me=new Set;se.forEach(ve=>{const et=ve.MST_SO_ID||ve.mstSoId;et&&!re.some(Dt=>Dt.SO_ID===et)&&me.add(et)}),me.forEach(ve=>{re.push({SO_ID:ve,SO_NM:""})}),P(re);return}const Re=JSON.parse(xe),be=Re.soId||Re.SO_ID,De=Re.soNm||Re.SO_NM||be;if(be){console.log("[]  SO  :",be,De),P([{SO_ID:be,SO_NM:De}]);return}}console.log("[]   ")}catch(xe){console.error("[] SO list load failed:",xe)}})()},[]);const Q=async X=>{_(!0);try{L(Z=>[...new Set([X,...Z])]);const xe={EQT_SERNO:X},fe=await Ei("EquipmentRecovery","getUnreturnedEquipmentList (barcode)",()=>Db(xe),xe);if(fe&&fe.length>0){const Z=fe.map(le=>{var se,Re;return{CHK:le.EQT_SERNO===X,CUST_ID:le.CUST_ID||"",CUST_NM:le.CUST_NM||"",CTRT_ID:le.CTRT_ID||"",EQT_NO:le.EQT_NO||"",EQT_SERNO:le.EQT_SERNO||"",EQT_CL_CD:le.EQT_CL_CD||le.EQT_CL||"",EQT_CL_NM:le.EQT_CL_NM||le.EQT_NM||"",ITEM_NM:le.ITEM_NM||le.EQT_NM||"",TRML_DT:le.TRML_DT||((Re=(se=le.CMPL_DATE)==null?void 0:se.split(" ")[0])==null?void 0:Re.replace(/-/g,""))||"",WRK_ID:le.WRK_ID||"",WRKR_ID:le.WRKR_ID||"",WRKR_NM:le.WRKR_NM||"",SO_ID:le.SO_ID||"",SO_NM:le.SO_NM||J(le.SO_ID)||"",PHONE_NO:le.PHONE_NO||le.TEL_NO||le.TEL_NO_1||"",ADDRESS:le.ADDRESS||le.WORK_ADDR||le.CTRT_ADDR||"",RETN_REQ_YN:le.RETN_REQ_YN||"",LOSS_AMT:le.LOSS_AMT||"",CRR_ID:le.CRR_ID||"",CMPL_DATE:le.CMPL_DATE||"",EQT_STAT_CD_NM:le.EQT_STAT_NM||le.EQT_STAT_CD_NM||"",isScanned:le.EQT_SERNO===X,MAC_ADDRESS:le.MAC_ADDRESS||le.MAC_ADDR||"",EQT_USE_END_DT:le.EQT_USE_END_DT||"",CHG_KND_NM:le.CHG_KND_NM||"",EQT_LOC_NM:le.EQT_LOC_NM||"",EQT_LOC_TP_NM:le.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:le.OLD_EQT_LOC_NM||"",ITEM_MODEL:le.ITEM_MODEL||le.MODEL_NM||"",EQT_USE_ARR_YN:le.EQT_USE_ARR_YN||"",BIZ_CL_NM:le.BIZ_CL_NM||"",MST_SO_ID:le.MST_SO_ID||"",MST_SO_NM:le.MST_SO_NM||""}});h(Z)}else{const Z=await Ei("EquipmentRecovery","getEquipmentHistoryInfo",()=>im({EQT_SERNO:X}),{EQT_SERNO:X});if(Z&&Z.length>0){const le=Z[0];e==null||e(` (${X})   . : ${le.EQT_STAT_NM||le.EQT_STAT_CD_NM||"  "}`,"warning")}else e==null||e(` (${X})   .`,"error");h([])}}catch(xe){console.error("Barcode scan failed:",xe),e==null||e("  .","error")}finally{_(!1)}},q=X=>{h([]),L([]),c(X),r({...n,CUST_ID:X.CUST_ID,CUST_NM:X.CUST_NM})},$=async()=>{if(!n.EQT_SERNO&&!o){e==null||e("  S/N .","warning");return}_(!0);try{const X={};n.EQT_SERNO&&(X.EQT_SERNO=n.EQT_SERNO),o&&(X.CUST_ID=o.CUST_ID);const xe=await Ei("EquipmentRecovery","getUnreturnedEquipmentList",()=>Db(X),X);if(!o&&n.EQT_SERNO&&xe&&xe.length>0){const Z=xe[0];Z.CUST_ID&&Z.CUST_NM&&c({CUST_ID:Z.CUST_ID,CUST_NM:Z.CUST_NM})}const fe=(xe||[]).map(Z=>{var le,se;return{CHK:k.includes(Z.EQT_SERNO),CUST_ID:Z.CUST_ID||"",CUST_NM:Z.CUST_NM||"",CTRT_ID:Z.CTRT_ID||"",EQT_NO:Z.EQT_NO||"",EQT_SERNO:Z.EQT_SERNO||"",EQT_CL_CD:Z.EQT_CL_CD||Z.EQT_CL||"",EQT_CL_NM:Z.EQT_CL_NM||Z.EQT_NM||"",ITEM_NM:Z.ITEM_NM||Z.EQT_NM||"",TRML_DT:Z.TRML_DT||((se=(le=Z.CMPL_DATE)==null?void 0:le.split(" ")[0])==null?void 0:se.replace(/-/g,""))||"",WRK_ID:Z.WRK_ID||"",WRKR_ID:Z.WRKR_ID||"",WRKR_NM:Z.WRKR_NM||"",SO_ID:Z.SO_ID||"",SO_NM:Z.SO_NM||J(Z.SO_ID)||"",PHONE_NO:Z.PHONE_NO||Z.TEL_NO||Z.TEL_NO_1||"",ADDRESS:Z.ADDRESS||Z.WORK_ADDR||Z.CTRT_ADDR||"",RETN_REQ_YN:Z.RETN_REQ_YN||"",LOSS_AMT:Z.LOSS_AMT||"",CRR_ID:Z.CRR_ID||"",CMPL_DATE:Z.CMPL_DATE||"",EQT_STAT_CD_NM:Z.EQT_STAT_NM||Z.EQT_STAT_CD_NM||"",isScanned:k.includes(Z.EQT_SERNO),MAC_ADDRESS:Z.MAC_ADDRESS||Z.MAC_ADDR||"",EQT_USE_END_DT:Z.EQT_USE_END_DT||"",CHG_KND_NM:Z.CHG_KND_NM||"",EQT_LOC_NM:Z.EQT_LOC_NM||"",EQT_LOC_TP_NM:Z.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:Z.OLD_EQT_LOC_NM||"",ITEM_MODEL:Z.ITEM_MODEL||Z.MODEL_NM||"",EQT_USE_ARR_YN:Z.EQT_USE_ARR_YN||"",BIZ_CL_NM:Z.BIZ_CL_NM||"",MST_SO_ID:Z.MST_SO_ID||"",MST_SO_NM:Z.MST_SO_NM||""}});fe.sort((Z,le)=>Z.isScanned&&!le.isScanned?-1:!Z.isScanned&&le.isScanned?1:0),h(fe)}catch(X){console.error("Unreturned equipment lookup failed:",X),e==null||e("  .","error"),h([])}finally{_(!1)}},de=async(X,xe)=>{const fe=u.filter(Z=>Z.CHK);if(fe.length!==0){v(!0);try{let Z=0,le=0;for(const se of fe)try{if(!se.EQT_NO||se.EQT_NO.length!==20||!/^\d+$/.test(se.EQT_NO)){console.warn("Invalid EQT_NO format:",se.EQT_SERNO,se.EQT_NO),le++;continue}const Re=typeof window<"u"?sessionStorage.getItem("userInfo"):null,be=Re?JSON.parse(Re):{},De=new Date().toISOString().slice(0,10).replace(/-/g,""),re={EQT_NO:se.EQT_NO,EQT_SERNO:se.EQT_SERNO,PROC_CL:X,CUST_ID:se.CUST_ID,CTRT_ID:se.CTRT_ID,WRK_ID:se.WRK_ID,CRR_ID:se.CRR_ID||be.crrId||"",WRKR_ID:se.WRKR_ID||be.userId||"",SO_ID:xe||se.SO_ID||be.soId||"",CHG_UID:be.userId||"",PROC_UID_SO_ID:xe||be.soId||se.SO_ID||"",RTN_DD:De,RTN_TP:"3",STTL_YN:"N",BILL_YN:se.BILL_YN||"N",RCPT_YN:se.RCPT_YN||"0",EQT_PROD_CMPS_ID:se.EQT_PROD_CMPS_ID||"",BASIC_PROD_CMPS_ID:se.BASIC_PROD_CMPS_ID||"",EQT_CL_CD:se.EQT_CL_CD||se.EQT_CL||"",EQT_USE_STAT_CD:se.EQT_USE_STAT_CD||"1",SVC_CD:se.SVC_CD||"",IF_DTL_ID:se.IF_DTL_ID||"0000000000"};await Ei("EquipmentRecovery","processEquipmentRecovery",()=>SA(re),re),Z++}catch(Re){console.error("Recovery process failed:",se.EQT_SERNO,Re);const be=(Re==null?void 0:Re.message)||(Re==null?void 0:Re.toString())||"";if(be.includes("    ")||be.includes("ORA-30926")){console.log("[Workaround] Oracle    ,     ...");try{await new Promise(ve=>setTimeout(ve,500));const De=await im({EQT_SERNO:se.EQT_SERNO}),re=Array.isArray(De)?De[0]:De,me=(re==null?void 0:re.CHG_KND_CD_NM)||(re==null?void 0:re.CHG_KND_NM)||"";console.log("[Workaround]   :",se.EQT_SERNO,"- CHG_KND_NM:",me),me.includes("")||me.includes("")||me==="SO"?(console.log("[Workaround]     :",se.EQT_SERNO),Z++):console.log("[Workaround]    ,  :",me)}catch(De){console.error("[Workaround]  :",De)}}}if(Z>0){let se=Z+"  ";le>0&&(se+=` (${le} )`),e==null||e(se,"success"),y(!1),L([]),$()}else throw new Error(" ")}catch(Z){console.error("Recovery process failed:",Z),e==null||e(" .","error")}finally{v(!1)}}},ae=X=>{h(u.map(xe=>{const fe=V(xe);return{...xe,CHK:fe?X:!1}}))},_e=(X,xe)=>{const fe=[...u],Z=fe[X];V(Z)&&(fe[X].CHK=xe,h(fe))},ie=u.filter(X=>X.CHK).length,Ne=X=>{const xe=V(X),fe=xe,Z=u.findIndex(le=>le.EQT_SERNO===X.EQT_SERNO);return s.jsxs("div",{onClick:()=>fe&&_e(Z,!X.CHK),className:`p-3 rounded-lg border-2 transition-all ${fe?"cursor-pointer":"cursor-not-allowed opacity-70"} ${X.CHK?"bg-blue-50 border-blue-400":X.isScanned?"bg-orange-50 border-orange-200":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:X.CHK||!1,onChange:le=>{le.stopPropagation(),_e(Z,le.target.checked)},disabled:!fe,className:`w-5 h-5 rounded focus:ring-blue-500 mt-0.5 ${fe?"text-blue-500":"text-gray-300 cursor-not-allowed"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("span",{className:"text-base font-bold text-gray-900 truncate",children:X.EQT_CL_NM||X.ITEM_NM||"-"}),X.isScanned&&s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700 flex-shrink-0",children:""})]}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${xe?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:xe?"":X.EQT_STAT_CD_NM||""})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"S/N : "}),X.EQT_SERNO||"-"]}),(()=>{const le=X.EQT_USE_ARR_YN;if(!le)return null;let se="bg-gray-100 text-gray-700",Re=le;return le==="Y"?(se="bg-green-100 text-green-700",Re=""):le==="A"?(se="bg-purple-100 text-purple-700",Re=""):le==="N"?(se="bg-red-100 text-red-700",Re=""):le==="W"?(se="bg-blue-100 text-blue-700",Re=""):le==="R"?(se="bg-yellow-100 text-yellow-700",Re=""):le==="D"&&(se="bg-orange-100 text-orange-700",Re=""),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium flex-shrink-0 ml-2 ${se}`,children:Re})})()]}),s.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:"MAC : "}),Tq(X.MAC_ADDRESS)||"-"]}),s.jsx("span",{className:"text-sm text-gray-600",children:Rq(X.EQT_USE_END_DT||"")})]})]})]}),B==="detail"&&s.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 mt-2 text-xs space-y-1 ml-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:" : "}),s.jsx("span",{className:"text-gray-800",children:X.ITEM_MODEL||"-"})]}),s.jsx("span",{className:"font-medium text-gray-800",children:J(X.SO_NM||X.SO_ID)||"-"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.EQT_STAT_CD_NM||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs",children:X.EQT_NO||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.CHG_KND_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.EQT_LOC_NM||X.EQT_LOC_TP_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"  : "}),s.jsx("span",{className:"text-gray-800",children:X.OLD_EQT_LOC_NM||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"ID    : "}),s.jsx("span",{className:"text-gray-800 font-mono",children:Mq(X.CTRT_ID)})]})]})]},X._globalIdx)};return s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[k.length>0&&s.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-xs font-medium text-orange-700",children:["  (",k.length,")"]}),s.jsx("button",{onClick:()=>L([]),className:"text-xs text-orange-600 hover:text-orange-800",children:""})]}),s.jsx("div",{className:"flex flex-wrap gap-1",children:k.map((X,xe)=>s.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-md font-mono",children:X},xe))})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:""}),s.jsxs("div",{onClick:()=>a(!0),className:"flex-1 flex gap-2 cursor-pointer min-w-0 overflow-hidden",children:[s.jsx("input",{type:"text",value:(o==null?void 0:o.CUST_NM)||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer truncate",placeholder:""}),s.jsx("input",{type:"text",value:(o==null?void 0:o.CUST_ID)||"",readOnly:!0,className:"flex-1 min-w-0 px-2 py-2.5 text-sm border border-gray-200 rounded-lg bg-gray-50 cursor-pointer",placeholder:"ID"})]}),o&&s.jsx("button",{onClick:X=>{X.stopPropagation(),c(null),r({...n,CUST_ID:"",CUST_NM:""}),h([])},className:"w-9 h-9 flex items-center justify-center text-red-500 bg-red-50 hover:bg-red-100 rounded-lg transition-all flex-shrink-0",title:" ",children:s.jsx(Mi,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{type:"text",value:n.EQT_SERNO,onChange:X=>r({...n,EQT_SERNO:X.target.value.toUpperCase()}),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono",placeholder:"S/N  MAC  "}),s.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),s.jsx("button",{onClick:$,disabled:m||!o&&!n.EQT_SERNO,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-3 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:m?" ...":""})]})}),u.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",onChange:X=>ae(X.target.checked),checked:j.length>0&&j.filter(X=>V(X)).every(X=>X.CHK),className:"w-4 h-4 text-blue-500 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:""})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[j.length," (: ",ie,")"]})]}),s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>I("simple"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${B==="simple"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""}),s.jsx("button",{onClick:()=>I("detail"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${B==="detail"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:""})]})]}),s.jsx("div",{className:"px-4 py-2 border-b border-gray-100",children:s.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[s.jsxs("button",{onClick:()=>A("all"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${E==="all"?"bg-white text-orange-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[" (",u.length,")"]}),s.jsxs("button",{onClick:()=>A("lost"),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-md transition-all ${E==="lost"?"bg-white text-red-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[" (",te,")"]})]})}),s.jsx("div",{className:"divide-y divide-gray-100",children:R.map(X=>{const xe=ce[X],fe=Object.keys(xe).sort(),Z=fe.reduce((be,De)=>be+xe[De].length,0),le=fe.reduce((be,De)=>be+xe[De].filter(re=>re.CHK).length,0),se=fe.reduce((be,De)=>be+xe[De].filter(re=>V(re)).length,0),Re=Y.has(`so_${X}`);return s.jsxs("div",{className:"border-b border-gray-100 last:border-0",children:[s.jsxs("div",{className:"px-4 py-2 bg-blue-50 flex items-center justify-between cursor-pointer hover:bg-blue-100",onClick:()=>H(`so_${X}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:se>0&&le===se,onChange:be=>{be.stopPropagation(),O(X,be.target.checked)},onClick:be=>be.stopPropagation(),className:"rounded",disabled:se===0}),s.jsx("span",{className:"text-sm font-bold text-blue-800",children:J(X)}),s.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[Z,""]})]}),Re?s.jsx(ir,{className:"w-4 h-4 text-blue-600"}):s.jsx(kr,{className:"w-4 h-4 text-blue-600"})]}),!Re&&fe.map(be=>{const De=xe[be],re=De.filter(et=>V(et)).length,me=De.filter(et=>et.CHK).length,ve=Y.has(`so_${X}_type_${be}`);return s.jsxs("div",{children:[s.jsxs("div",{className:"px-6 py-1.5 bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100",onClick:()=>H(`so_${X}_type_${be}`),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:re>0&&me===re,onChange:et=>{et.stopPropagation(),U(X,be,et.target.checked)},onClick:et=>et.stopPropagation(),className:"rounded",disabled:re===0}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:be}),s.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded",children:[De.length,""]})]}),ve?s.jsx(ir,{className:"w-3 h-3 text-gray-500"}):s.jsx(kr,{className:"w-3 h-3 text-gray-500"})]}),!ve&&s.jsx("div",{className:"space-y-2",children:De.map(et=>Ne(et))})]},be)})]},X)})})]}),s.jsx("div",{className:"h-20"})]}):s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:m?" ...":"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"     "})]})}),u.length>0&&s.jsx("div",{className:"fixed bottom-[56px] left-0 right-0 p-3 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:s.jsxs("button",{onClick:()=>y(!0),disabled:ie===0,className:`w-full py-3 px-4 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation flex items-center justify-center gap-2 ${ie>0?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-300 text-white cursor-not-allowed"}`,style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx(jc,{className:"w-4 h-4"}),"  ",ie>0&&`(${ie})`]})}),s.jsx(vm,{isOpen:p,onClose:()=>g(!1),onScan:Q}),s.jsx(Iq,{isOpen:C,onClose:()=>y(!1),selectedItems:u.filter(X=>X.CHK),onProcess:de,isProcessing:S,soList:M,userSoId:F,showToast:e}),s.jsx(jq,{isOpen:i,onClose:()=>a(!1),onSelect:q,onSerialSearch:X=>{r({...n,EQT_SERNO:X}),a(!1),setTimeout(()=>{const xe={EQT_SERNO:X};_(!0),Db(xe).then(fe=>{if(fe&&fe.length>0){const Z=fe[0];Z.CUST_ID&&Z.CUST_NM&&c({CUST_ID:Z.CUST_ID,CUST_NM:Z.CUST_NM}),h(fe.map(le=>{var se,Re;return{CHK:!1,CUST_ID:le.CUST_ID||"",CUST_NM:le.CUST_NM||"",CTRT_ID:le.CTRT_ID||"",EQT_NO:le.EQT_NO||"",EQT_SERNO:le.EQT_SERNO||"",EQT_CL_CD:le.EQT_CL_CD||le.EQT_CL||"",EQT_CL_NM:le.EQT_CL_NM||le.EQT_NM||"",ITEM_NM:le.ITEM_NM||le.EQT_NM||"",TRML_DT:le.TRML_DT||((Re=(se=le.CMPL_DATE)==null?void 0:se.split(" ")[0])==null?void 0:Re.replace(/-/g,""))||"",WRK_ID:le.WRK_ID||"",WRKR_ID:le.WRKR_ID||"",WRKR_NM:le.WRKR_NM||"",SO_ID:le.SO_ID||"",SO_NM:le.SO_NM||J(le.SO_ID)||"",PHONE_NO:le.PHONE_NO||le.TEL_NO||le.TEL_NO_1||"",ADDRESS:le.ADDRESS||le.WORK_ADDR||le.CTRT_ADDR||"",RETN_REQ_YN:le.RETN_REQ_YN||"",LOSS_AMT:le.LOSS_AMT||"",CRR_ID:le.CRR_ID||"",CMPL_DATE:le.CMPL_DATE||"",EQT_STAT_CD_NM:le.EQT_STAT_NM||le.EQT_STAT_CD_NM||"",isScanned:!1,MAC_ADDRESS:le.MAC_ADDRESS||le.MAC_ADDR||"",EQT_USE_END_DT:le.EQT_USE_END_DT||"",CHG_KND_NM:le.CHG_KND_NM||"",EQT_LOC_NM:le.EQT_LOC_NM||"",EQT_LOC_TP_NM:le.EQT_LOC_TP_NM||"",OLD_EQT_LOC_NM:le.OLD_EQT_LOC_NM||"",ITEM_MODEL:le.ITEM_MODEL||le.MODEL_NM||"",EQT_USE_ARR_YN:le.EQT_USE_ARR_YN||"",BIZ_CL_NM:le.BIZ_CL_NM||"",MST_SO_ID:le.MST_SO_ID||"",MST_SO_NM:le.MST_SO_NM||""}})),e==null||e(`${fe.length}   .`,"success")}else e==null||e(` (${X})   .`,"error"),h([])}).catch(()=>{e==null||e("  .","error")}).finally(()=>_(!1))},100)}})]})},wq={10:"",11:"()",20:"",35:"",50:"",60:"",70:"",71:"",72:"",73:"AS",74:"",75:"",80:"",81:"",82:"",83:"",84:"",90:""},Lq={1:"SO()",2:"",3:"",4:""},Pq=t=>wq[t]||t,WT=t=>Lq[t]||t,mf=t=>{const e={...t};return e.EQT_STAT_CD&&!e.EQT_STAT_CD_NM&&(e.EQT_STAT_CD_NM=Pq(e.EQT_STAT_CD)),e.EQT_LOC_TP_CD&&!e.EQT_LOC_TP_CD_NM&&(e.EQT_LOC_TP_CD_NM=WT(e.EQT_LOC_TP_CD)),e.OLD_EQT_LOC_TP_CD&&!e.OLD_EQT_LOC_TP_CD_NM&&(e.OLD_EQT_LOC_TP_CD_NM=WT(e.OLD_EQT_LOC_TP_CD)),e},jC=t=>{if(!t)return{name:"-",id:""};const e=t.match(/^(.+?)\(([A-Za-z0-9]+)\)$/);return e?{name:e[1],id:e[2]}:{name:t,id:""}},Aq=({onBack:t,showToast:e})=>{const[n,r]=b.useState(""),[i,a]=b.useState(!1),[o,c]=b.useState(null),[u,h]=b.useState(null),[m,_]=b.useState(null),[p,g]=b.useState([]),[C,y]=b.useState(!1),[S,v]=b.useState("manual"),[k,L]=b.useState(!1),[M,P]=b.useState([]),[F,G]=b.useState([]),B=S==="multi",I=Ji.useRef(new Set),[E,A]=b.useState(0),[Y,ee]=b.useState([]),J="1644-1100",[H,V]=b.useState(!1),[K,j]=b.useState(!1),te=Ji.useRef(null),ce=()=>{try{const X=localStorage.getItem("user");if(X){const xe=JSON.parse(X),fe=xe.USR_ID||xe.WRKR_ID||xe.userId||null,Z=xe.soId||xe.SO_ID||null,le=xe.AUTH_SO_List||null;return console.log("[]  :",{userId:fe,soId:Z||"()",authSoListCount:(le==null?void 0:le.length)||0}),fe?{userId:fe,soId:Z,authSoList:le}:null}}catch(X){console.warn("   :",X)}return null};b.useEffect(()=>{(async()=>{const xe=ce();if(xe){y(!0);try{let fe=[];if(xe.soId){const Z={WRKR_ID:xe.userId,SO_ID:xe.soId};console.log("[]  - SO_ID :",Z);const le=await Ei("EquipmentList","getWrkrHaveEqtList",()=>Og(Z),Z);fe=Array.isArray(le)?le:(le==null?void 0:le.data)||[]}else if(xe.authSoList&&xe.authSoList.length>0){console.log("[]  - AUTH_SO_List :",xe.authSoList);for(const le of xe.authSoList)try{const se={WRKR_ID:xe.userId,SO_ID:le.SO_ID},Re=await Ei("EquipmentList",`getWrkrHaveEqtList(SO_ID=${le.SO_ID})`,()=>Og(se),se),De=(Array.isArray(Re)?Re:(Re==null?void 0:Re.data)||[]).filter(re=>re.WRKR_ID===xe.userId||re.ID===xe.userId);fe=[...fe,...De]}catch(se){console.warn(`SO_ID ${le.SO_ID}  :`,se)}const Z=new Map;fe.forEach(le=>{le.EQT_SERNO&&!Z.has(le.EQT_SERNO)&&Z.set(le.EQT_SERNO,le)}),fe=Array.from(Z.values()),console.log("[]   :",fe.length,"")}else{const Z={WRKR_ID:xe.userId};console.log("[]   (SO_ID ):",Z);const le=await Ei("EquipmentList","getWrkrHaveEqtList",()=>Og(Z),Z);fe=Array.isArray(le)?le:(le==null?void 0:le.data)||[]}g(fe)}catch(fe){console.warn("    :",fe)}finally{y(!1)}}})()},[]);const R=X=>{const xe=X.toUpperCase().replace(/[:-]/g,"");for(const fe of p){const Z=(fe.EQT_SERNO||fe.SERIAL_NO||fe.SN||"").toUpperCase().replace(/[:-]/g,"");if(Z&&Z.includes(xe))return fe;const le=(fe.MAC_ADDRESS||fe.MAC||fe.MAC_ADDR||"").toUpperCase().replace(/[:-]/g,"");if(le&&le.includes(xe))return fe;const se=(fe.EQT_NO||"").toUpperCase();if(se&&se.includes(xe))return fe}return null},O=async X=>{console.log("Barcode scanned:",X);const xe=X.toUpperCase().replace(/[:-]/g,"");if(B){if(I.current.has(xe)){e==null||e("  .","warning");return}I.current.add(xe),A(I.current.size)}r(X.toUpperCase()),B||j(!1),e==null||e(` : ${X}`,"success");const fe=X.toUpperCase();setTimeout(()=>{U(fe)},100)},U=async X=>{const xe=X||n.trim();if(!xe){e==null||e(" .","warning");return}a(!0),_(null),B||c(null),h(null);const fe=String(xe||""),Z=typeof fe=="string"&&fe.includes(",")?[...new Set(fe.split(",").map(be=>be.trim().toUpperCase().replace(/[\s:-]/g,"")).filter(be=>be.length>0))]:[fe.toUpperCase().replace(/[\s:-]/g,"")].filter(be=>be.length>0);if(Z.length===0){e==null||e(" S/N .","warning"),a(!1);return}const le=async be=>{if(p.length>0){const De=R(be);if(De)return{found:!0,equipment:De,source:"myEquipments"}}try{const De=ce(),re={EQT_SERNO:be,SO_ID:(De==null?void 0:De.soId)||void 0,WRKR_ID:De==null?void 0:De.userId},me=await Ei("EquipmentList","getEquipmentHistoryInfo",()=>im(re),re);if(me){const ve=Array.isArray(me)?me:[me];if(ve.length>1)return{found:!0,equipments:ve,source:"getEquipmentHistoryInfo",isMultiple:!0};if(ve.length===1)return{found:!0,equipment:ve[0],source:"getEquipmentHistoryInfo"}}}catch(De){console.error("[]  :",be,De)}return{found:!1}};if(console.log("[]  :",{searchValues:Z,count:Z.length,isMultiScanMode:B}),Z.length>1){const be=await Promise.all(Z.map(async me=>({searchVal:me,...await le(me)}))),De=[],re=[];if(be.forEach(({searchVal:me,found:ve,equipment:et})=>{ve&&et?De.push(et):re.push(me)}),console.log("[]   :",{found:De.length,notFound:re.length}),De.length>0){const me=[];De.forEach(ve=>{F.some(Dt=>Dt.EQT_SERNO===ve.EQT_SERNO||Dt.EQT_NO===ve.EQT_NO||Dt.MAC_ADDRESS&&ve.MAC_ADDRESS&&Dt.MAC_ADDRESS===ve.MAC_ADDRESS)||me.push(ve)}),me.length>0&&(G(ve=>[...ve,...me]),me.forEach(ve=>{const et=(ve.EQT_SERNO||"").toUpperCase().replace(/[:-]/g,"");et&&I.current.add(et)}),A(I.current.size)),re.length>0&&ee(ve=>{const et=Array.isArray(ve)?ve:[];return[...et,...re.filter(Dt=>!et.includes(Dt))]}),V(!0),c(null),r(""),e==null||e(`${me.length}  ${re.length>0?`, ${re.length} `:""}`,"success")}else ee(me=>{const ve=Array.isArray(me)?me:[];return[...ve,...re.filter(et=>!ve.includes(et))]}),_("     ."),e==null||e("   .","error");a(!1);return}const se=Z[0],Re=await le(se);if(Re.found){if(Re.isMultiple&&Re.equipments&&Re.equipments.length>1){P(Re.equipments),L(!0),r(""),e==null||e(`${Re.equipments.length}  . .`,"info"),a(!1);return}const be=Re.equipment;if(be)if(B)if(_e(be)){const re=Array.from(I.current).join(", ");r(re),e==null||e(` . (${F.length+1})`,"success")}else{const re=se.toUpperCase().replace(/[\s:-]/g,"");I.current.delete(re),A(I.current.size);const me=Array.from(I.current).join(", ");r(me||"")}else c(mf(be)),h({successApi:Re.source,data:be,source:Re.source}),e==null||e("  .","success")}else if(B){I.current.delete(se),A(I.current.size),ee(De=>{const re=Array.isArray(De)?De:[];return re.includes(se)?re:[...re,se]});const be=Array.from(I.current).join(", ");r(be),e==null||e("   .","error")}else _("   . S/N  MAC  ."),e==null||e("   .","error");a(!1)},Q=({label:X,value:xe})=>s.jsxs("div",{className:"flex border-b border-gray-100 py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-gray-500",children:X}),s.jsx("span",{className:"flex-1 text-xs text-gray-900 font-medium break-all",children:xe||"-"})]}),q=({title:X})=>s.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white px-3 py-2 -mx-4 mt-4 mb-2 first:mt-0 border-y border-gray-100",children:s.jsx("h4",{className:"text-xs font-bold text-gray-600",children:X})}),$=X=>{const xe=F[X];if(xe){const fe=(xe.EQT_SERNO||xe.MAC_ADDRESS||"").toUpperCase().replace(/[:-]/g,"");I.current.delete(fe)}G(fe=>fe.filter((Z,le)=>le!==X))},de=()=>{j(!1),B&&(F.length>0||Y.length>0||E>0)&&(V(!0),c(null))},ae=()=>{window.location.href=`tel:${J}`},_e=X=>F.some(fe=>fe.EQT_SERNO===X.EQT_SERNO||fe.EQT_NO===X.EQT_NO||fe.MAC_ADDRESS&&X.MAC_ADDRESS&&fe.MAC_ADDRESS===X.MAC_ADDRESS)?(e==null||e("  . ( )","warning"),!1):(G(fe=>[...fe,X]),!0),[ie,Ne]=b.useState(null);return b.useEffect(()=>()=>{ie&&clearTimeout(ie)},[ie]),s.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50 px-4 py-4 space-y-3",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600 w-14 flex-shrink-0",children:"S/N"}),s.jsx("input",{ref:te,type:"text",value:n,onChange:X=>r(X.target.value.toUpperCase()),onKeyDown:X=>X.key==="Enter"&&U(),className:"flex-1 min-w-0 px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase transition-all font-mono",placeholder:"S/N  MAC  ",autoFocus:!0}),s.jsxs("button",{onClick:()=>j(!0),className:"px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] touch-manipulation flex items-center gap-1.5 flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),""]})]}),s.jsx("button",{onClick:()=>U(),disabled:i||!n.trim(),className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white py-3 rounded-lg font-semibold text-sm shadow-sm transition-all active:scale-[0.98] touch-manipulation flex items-center justify-center gap-2",style:{WebkitTapHighlightColor:"transparent"},children:i?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," ..."]}):""})]})}),B&&F.length>0&&s.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-sm font-bold text-blue-700 flex items-center gap-2",children:[s.jsx("span",{children:"  "}),s.jsxs("span",{className:"bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full text-xs",children:[F.length,""]})]}),s.jsx("button",{onClick:()=>V(!H),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${H?"bg-blue-500 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:H?" ":" "})]}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:F.map((X,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100",children:[s.jsxs("div",{className:"flex-1 cursor-pointer active:bg-gray-100 rounded-lg -m-1 p-1",onClick:()=>c(mf(X)),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:X.EQT_CL_NM||X.ITEM_NM||""}),s.jsx("span",{className:"text-xs text-gray-500 font-mono",children:X.EQT_SERNO||"-"})]}),s.jsxs("div",{className:"text-[10px] text-gray-400 mt-0.5",children:[X.EQT_STAT_CD_NM||X.EQT_USE_STAT_CD_NM||"",(()=>{const fe=jC(X.EQT_LOC_NM);return fe.id?`  ${fe.name}(${fe.id})`:X.WRKR_NM?`  ${X.WRKR_NM}`:""})()]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>c(mf(X)),className:"text-blue-500 hover:text-blue-700 p-1.5 hover:bg-blue-50 rounded-lg transition-colors",title:" ",children:s.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),s.jsx("button",{onClick:()=>$(xe),className:"text-red-400 hover:text-red-600 p-1.5 hover:bg-red-50 rounded-lg transition-colors",title:"",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},xe))})]}),B&&H&&F.length>0&&s.jsxs("div",{className:"bg-white rounded-xl border border-green-200 shadow-sm p-4",children:[s.jsxs("h3",{className:"text-sm font-bold text-green-700 mb-4 flex items-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"  "}),s.jsxs("span",{className:"bg-green-100 text-green-600 px-2 py-0.5 rounded-full text-xs",children:[F.length,""]})]}),s.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:F.map((X,xe)=>{const fe=mf(X);return s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-all active:scale-[0.99]",onClick:()=>{c(fe),V(!1)},children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s.jsxs("span",{className:"bg-blue-500 text-white text-xs font-bold px-1.5 py-0.5 rounded flex-shrink-0",children:["#",xe+1]}),s.jsx("span",{className:"font-bold text-gray-800 text-sm truncate",children:fe.EQT_CL_NM||fe.ITEM_NM||""})]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[s.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-semibold whitespace-nowrap ${fe.EQT_STAT_CD==="10"?"bg-green-100 text-green-700":fe.EQT_STAT_CD==="20"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:fe.EQT_STAT_CD_NM||"-"}),s.jsx("span",{className:"text-[10px] text-blue-500 whitespace-nowrap",children:""})]})]}),s.jsxs("div",{className:"space-y-1 text-xs",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:"S/N"}),s.jsx("span",{className:"font-mono text-gray-800 truncate",children:fe.EQT_SERNO||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:"MAC"}),s.jsx("span",{className:"font-mono text-gray-700 truncate",children:fe.MAC_ADDRESS||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:"No."}),s.jsx("span",{className:"font-mono text-gray-700 truncate",children:fe.EQT_NO||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-8 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:fe.EQT_LOC_TP_CD_NM||"-"}),fe.EQT_LOC_NM&&s.jsxs("span",{className:"text-gray-500 ml-1 truncate",children:[" ",fe.EQT_LOC_NM]})]})]})]},xe)})})]}),m&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"   "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"S/N  MAC  "})]})}),o&&!H&&s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-100",children:s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("h3",{className:"text-sm font-bold text-gray-800 flex items-center gap-2",children:[s.jsx("span",{className:"text-blue-500",children:""}),"   "]})})}),s.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[s.jsx(q,{title:" "}),s.jsx(Q,{label:"",value:o.EQT_NO}),s.jsx(Q,{label:"(S/N)",value:o.EQT_SERNO}),s.jsx(Q,{label:"MAC ",value:o.MAC_ADDRESS}),s.jsx(q,{title:" "}),s.jsx(Q,{label:"",value:o.EQT_CL_NM||o.EQT_CL_CD}),s.jsx(Q,{label:"",value:o.EQT_TP_CD_NM||o.EQT_TP_CD}),s.jsx(Q,{label:"",value:o.ITEM_CD}),s.jsx(Q,{label:"",value:o.ITEM_NM}),s.jsx(Q,{label:"",value:o.MAKER}),s.jsx(Q,{label:"",value:o.MNFCT_DT}),s.jsxs("div",{className:"bg-amber-50 border-2 border-amber-400 rounded-lg p-3 -mx-4 my-3",children:[s.jsx("div",{className:"bg-gradient-to-r from-amber-100 to-amber-50 px-3 py-2 -mx-3 -mt-3 mb-2 border-b border-amber-200",children:s.jsxs("h4",{className:"text-xs font-bold text-amber-700 flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})," "]})}),s.jsxs("div",{className:"flex border-b border-amber-200 py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-amber-700 font-medium",children:""}),s.jsx("span",{className:"flex-1 text-xs text-gray-900 font-medium break-all",children:o.EQT_STAT_CD_NM||o.EQT_STAT_CD||"-"})]}),s.jsxs("div",{className:"flex border-b border-amber-200 py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-amber-700 font-medium",children:""}),s.jsx("span",{className:`flex-1 text-xs font-bold break-all ${o.EQT_USE_ARR_YN==="Y"?"text-green-600":o.EQT_USE_ARR_YN==="A"?"text-purple-600":o.EQT_USE_ARR_YN==="N"?"text-red-600":"text-gray-900"}`,children:o.EQT_USE_ARR_YN_NM||o.EQT_USE_ARR_YN||"-"})]}),s.jsxs("div",{className:"flex py-1.5",children:[s.jsx("span",{className:"w-28 flex-shrink-0 text-xs text-amber-700 font-medium",children:""}),s.jsx("span",{className:"flex-1 text-xs text-gray-900 font-medium break-all",children:o.EQT_USE_END_DT||"-"})]})]}),s.jsx(q,{title:" "}),s.jsx(Q,{label:"",value:o.EQT_LOC_NM||o.EQT_LOC_TP_CD_NM}),s.jsx(Q,{label:"",value:o.OLD_EQT_LOC_NM||o.OLD_EQT_LOC_TP_CD_NM}),s.jsx(q,{title:"/"}),s.jsx(Q,{label:"",value:o.SO_NM||o.SO_ID}),s.jsx(Q,{label:"",value:o.CRR_NM||o.CRR_ID}),s.jsx(Q,{label:"",value:o.OLD_SO_NM||o.OLD_SO_ID}),s.jsx(Q,{label:"",value:o.OLD_CRR_NM||o.OLD_CRR_ID}),s.jsx(q,{title:" "}),s.jsx(Q,{label:"",value:(()=>{const X=jC(o.EQT_LOC_NM);return X.id?`${X.name} (${X.id})`:o.WRKR_NM?`${o.WRKR_NM} (${o.WRKR_ID})`:o.WRKR_ID||"-"})()}),s.jsx(Q,{label:"",value:(()=>{const X=jC(o.OLD_EQT_LOC_NM);return X.id?`${X.name} (${X.id})`:o.OLD_WRKR_NM?`${o.OLD_WRKR_NM} (${o.OLD_WRKR_ID})`:o.OLD_WRKR_ID||"-"})()}),s.jsx(q,{title:"/ "}),s.jsx(Q,{label:"ID",value:o.CUST_ID}),s.jsx(Q,{label:"",value:o.CUST_NM}),s.jsx(Q,{label:"ID",value:o.CTRT_ID}),s.jsx(q,{title:" "}),s.jsx(Q,{label:"",value:o.FIRST_IN_DT}),s.jsx(q,{title:"STB  "}),s.jsx(Q,{label:"CM MAC",value:o.STB_CM_MAC_ADDR}),s.jsx(Q,{label:"RTCA ID",value:o.STB_RTCA_ID}),s.jsx(q,{title:" "}),s.jsx(Q,{label:"",value:o.CHG_KND_CD_NM||o.CHG_KND_CD}),s.jsx(Q,{label:"",value:o.CHG_DATE}),s.jsx(Q,{label:"",value:o.CHG_UID_NM||o.CHG_UID})]})]}),u&&s.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 p-4",children:s.jsxs("details",{children:[s.jsx("summary",{className:"text-xs font-medium text-gray-600 cursor-pointer",children:"API   ()"}),s.jsx("pre",{className:"mt-2 text-xs text-gray-700 overflow-x-auto whitespace-pre-wrap bg-white p-3 rounded-lg border border-gray-100 max-h-48 overflow-y-auto",children:JSON.stringify(u,null,2)})]})}),!i&&!o&&!m&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),s.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"  "}),s.jsx("p",{className:"text-gray-400 text-xs",children:"S/N  MAC   "})]})}),!o&&p.length>0&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-4",children:s.jsxs("details",{children:[s.jsxs("summary",{className:"text-xs font-medium text-gray-700 cursor-pointer",children:["    (",p.length,")"]}),s.jsxs("div",{className:"mt-3 space-y-2 max-h-48 overflow-y-auto",children:[p.slice(0,20).map((X,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg text-xs cursor-pointer hover:bg-blue-50 transition-colors active:scale-[0.99] touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},onClick:()=>{r(X.EQT_SERNO||X.SERIAL_NO||X.MAC_ADDRESS||X.MAC||""),c(mf(X)),h({source:"    ",data:X})},children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-800",children:X.EQT_CL_NM||X.EQT_TP_CD||""}),s.jsx("span",{className:"ml-2 text-gray-500 font-mono",children:X.EQT_SERNO||X.SERIAL_NO||"-"})]}),s.jsx("span",{className:"text-gray-400 text-xs bg-gray-100 px-2 py-0.5 rounded",children:X.EQT_STAT_CD_NM||X.EQT_USE_STAT_CD||""})]},xe)),p.length>20&&s.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["...  ",p.length-20,""]})]})]})}),Y.length>0&&s.jsxs("div",{className:"bg-red-50 rounded-xl border border-red-200 shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-sm font-bold text-red-700 flex items-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"  "}),s.jsxs("span",{className:"bg-red-100 text-red-600 px-2 py-0.5 rounded-full text-xs",children:[Y.length,""]})]}),s.jsx("button",{onClick:()=>ee([]),className:"text-xs text-red-500 hover:text-red-700",children:" "})]}),s.jsx("div",{className:"space-y-2 mb-4",children:Y.map((X,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded-lg border border-red-100",children:[s.jsx("span",{className:"text-xs font-mono text-red-800",children:X}),s.jsx("span",{className:"text-xs text-red-500",children:""})]},xe))}),s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-100",children:[s.jsxs("p",{className:"text-xs text-gray-600 mb-3 text-center",children:["  .",s.jsx("br",{}),"     ."]}),s.jsxs("button",{onClick:ae,className:"w-full py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold text-sm transition-all active:scale-[0.98] flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),J," "]})]})]}),s.jsx(vm,{isOpen:K,onClose:de,onScan:O,isMultiScanMode:B,scanCount:E}),k&&M.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"px-5 py-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-white rounded-t-2xl flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"text-base font-bold text-gray-800 flex items-center gap-2",children:[s.jsx("span",{className:"text-blue-500",children:""})," "]}),s.jsx("button",{onClick:()=>{L(!1),P([])},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[M.length,"  .  ."]})]}),s.jsx("div",{className:"p-4 space-y-3 overflow-y-auto flex-1",children:M.map((X,xe)=>{const fe=mf(X),Z=(fe.EQT_STAT_CD_NM||"").includes("")||(fe.CHG_KND_CD_NM||"").includes(""),le=fe.EQT_USE_ARR_YN==="Y"||(fe.EQT_USE_ARR_YN_NM||"").includes("");return s.jsxs("div",{className:`p-4 rounded-xl border-2 cursor-pointer transition-all active:scale-[0.98] ${Z?"bg-red-50 border-red-200 hover:bg-red-100 hover:border-red-300":"bg-green-50 border-green-200 hover:bg-green-100 hover:border-green-300"}`,onClick:()=>{c(fe),L(!1),P([]),h({source:"multiple_result_selection",data:fe}),e==null||e(" .","success")},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${Z?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:Z?" ":" "}),s.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${le?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-600"}`,children:fe.EQT_USE_ARR_YN_NM||(le?"":"")})]}),s.jsxs("span",{className:"text-xs text-gray-400",children:[xe+1,"/",M.length]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"font-bold text-gray-800 text-sm mb-1",children:fe.EQT_CL_NM||fe.ITEM_NM||""}),s.jsxs("div",{className:"text-xs text-gray-500",children:[fe.ITEM_MODEL&&`: ${fe.ITEM_MODEL}`,fe.MAKER&&`  ${fe.MAKER}`]})]}),s.jsxs("div",{className:"space-y-1.5 text-xs bg-white/60 rounded-lg p-2.5",children:[s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:"S/N"}),s.jsx("span",{className:"font-mono text-gray-800 font-medium",children:fe.EQT_SERNO||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:`font-medium ${Z?"text-red-600":"text-green-600"}`,children:fe.EQT_STAT_CD_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:`${fe.EQT_TP_CD_NM===""?"text-orange-600":"text-gray-700"}`,children:fe.EQT_TP_CD_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-700",children:fe.EQT_LOC_NM||fe.SO_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:`${Z?"text-red-600 font-medium":"text-gray-700"}`,children:fe.CHG_KND_CD_NM||"-"})]}),s.jsxs("div",{className:"flex",children:[s.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0",children:""}),s.jsx("span",{className:"text-gray-600",children:fe.CHG_DATE?fe.CHG_DATE.split(" ")[0]:"-"})]})]}),s.jsx("div",{className:"flex justify-end mt-3",children:s.jsxs("span",{className:`text-xs flex items-center gap-1 px-3 py-1.5 rounded-lg ${Z?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:["  ",s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]},xe)})}),s.jsx("div",{className:"px-5 py-3 border-t border-gray-100 bg-gray-50 rounded-b-2xl flex-shrink-0",children:s.jsx("button",{onClick:()=>{L(!1),P([])},className:"w-full py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium text-sm transition-all",children:""})})]})})]})},kq=({onNavigateToMenu:t,showToast:e})=>{const[n,r]=b.useState("equipment-assignment"),i=[{id:"equipment-assignment",title:"",description:"    "},{id:"equipment-inquiry",title:"",description:"    /  / "},{id:"equipment-list",title:"",description:"S/N     "},{id:"equipment-movement",title:"",description:"    "},{id:"equipment-recovery",title:"",description:"   "}],a=o=>{r(o)};return s.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-gray-50 overflow-hidden",children:[s.jsx("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 z-40",children:s.jsx(dS,{tabs:i,activeTab:n,onTabChange:a})}),s.jsxs("div",{className:"flex-1 overflow-hidden",children:[s.jsx("div",{style:{display:n==="equipment-assignment"?"contents":"none"},children:s.jsx(xq,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-inquiry"?"contents":"none"},children:s.jsx(vq,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-list"?"contents":"none"},children:s.jsx(Aq,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-movement"?"contents":"none"},children:s.jsx(Dq,{onBack:t,showToast:e})}),s.jsx("div",{style:{display:n==="equipment-recovery"?"contents":"none"},children:s.jsx(Oq,{onBack:t,showToast:e})})]})]})},FT=[{id:"getEquipmentInfo",category:"-",name:"[]    ",path:"/work/equipment-info",description:"GET -     (workmanAssignManagement.getCustProdInfo)",params:[{name:"CTRT_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1},{name:"WRKR_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"BLD_ID",type:"string",required:!1},{name:"QUERY_TYPE",type:"string",required:!1}]},{id:"getCustProdInfo",category:"-",name:"[] /  ",path:"/customer/work/getCustProdInfo",description:"POST - /    (workmanAssignManagement.getCustProdInfo)",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"SO_ID",type:"string",required:!1},{name:"WORK_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"CRR_TSK_CL",type:"string",required:!1},{name:"WRK_DTL_TCD",type:"string",required:!1},{name:"CTRT_ID",type:"string",required:!1},{name:"requestType",type:"string",required:!1}]},{id:"equipmentWorkerTransfer",category:"-",name:"[]   ",path:"/equipment/worker-transfer",description:"POST -     (equipmentManager.changeEqtWrkr_3)",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1},{name:"EQT_NO",type:"string",required:!1},{name:"CRR_ID",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"eqtCmpsInfoChg",category:"-",name:"[]   ",path:"/customer/work/eqtCmpsInfoChg",description:"POST -     (workmanAssignManagement.eqtCmpsInfoChg)",params:[{name:"WRK_ID",type:"string",required:!1},{name:"RCPT_ID",type:"string",required:!1},{name:"CTRT_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"CRR_ID",type:"string",required:!1},{name:"WRKR_ID",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1},{name:"equipments",type:"array",required:!0,default:"[]"}]},{id:"signalCheck",category:"-",name:"[]   (Stub)",path:"/customer/work/signalCheck",description:"POST -   ( stub )",params:[{name:"CUST_ID",type:"string",required:!1},{name:"WRK_ID",type:"string",required:!1},{name:"CHECK_TYPE",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1}]},{id:"ensHistory",category:"-",name:"[] ENS  ",path:"/signal/ens-history",description:"GET - ENS    (sigtransManagement.getENSSendHist)",params:[{name:"CUST_ID",type:"string",required:!1},{name:"DEST_INFO",type:"string",required:!1},{name:"REG_DATE1",type:"string",required:!1},{name:"REG_DATE2",type:"string",required:!1},{name:"RSLT_DATE1",type:"string",required:!1},{name:"RSLT_DATE2",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1}]},{id:"checkStbServerConnection",category:"-",name:"[] STB   ",path:"/customer/work/checkStbServerConnection",description:"POST - STB     (workmanAssignManagement.checkStbServerConnection)",params:[{name:"REG_UID",type:"string",required:!1},{name:"CTRT_ID",type:"string",required:!1},{name:"WRK_ID",type:"string",required:!1},{name:"MSG_ID",type:"string",required:!1},{name:"STB_EQT_NO",type:"string",required:!1},{name:"MODEM_EQT_NO",type:"string",required:!1}]},{id:"getEquipmentNmListOfProd",category:"-",name:"[]   ",path:"/customer/receipt/contract/getEquipmentNmListOfProd",description:"POST -     (contract.getEquipmentNmListOfProd)",params:[{name:"CTRT_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1}]},{id:"getContractEqtList",category:"-",name:"[]   ",path:"/customer/receipt/contract/getContractEqtList",description:"POST -     (contract.getContractEqtList)",params:[{name:"CTRT_ID",type:"string",required:!1},{name:"PROD_CD",type:"string",required:!1}]},{id:"getCustomerCtrtInfo",category:"-",name:"[]   ",path:"/customer/negociation/getCustomerCtrtInfo",description:"POST -     (commonCodeManagement.getCustomerCtrtInfo)",params:[{name:"CTRT_ID",type:"string",required:!0}]},{id:"getWorkReceiptList",category:"-",name:"[]   ",path:"/work/receipts",description:"GET -     (workmanAssignManagement.getWorkReceiptList)",params:[{name:"WRKR_ID",type:"string",required:!1},{name:"WORK_DT",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1}]},{id:"getWorkdrctnList",category:"-",name:"[]   ",path:"/work/directions",description:"GET -     (workmanAssignManagement.getWorkdrctnList)",params:[{name:"WRKR_ID",type:"string",required:!1},{name:"WORK_DT",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1}]},{id:"modWorkCancel",category:"-",name:"[]  ",path:"/work/cancel",description:"POST -    (workmanAssignManagement.modWorkCancel)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"CANCEL_REASON",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"modWorkComplete",category:"-",name:"[]  ",path:"/work/complete",description:"POST -    (workmanAssignManagement.modWorkComplete)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"COMPLETE_MEMO",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"modWorkDivision",category:"-",name:"[]  ",path:"/work/worker-adjustment",description:"POST -  / (workmanAssignManagement.modWorkDivision)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"FROM_WRKR_ID",type:"string",required:!0},{name:"TO_WRKR_ID",type:"string",required:!0},{name:"REG_UID",type:"string",required:!1}]},{id:"workCompleteWithParams",category:"-",name:"[]   ()",path:"/customer/work/workComplete",description:"POST -    with 7 parameters (workmanAssignManagement.modWorkComplete)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"COMPLETE_DT",type:"string",required:!1},{name:"COMPLETE_MEMO",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"getRsltSinho4Wrk",category:"-",name:"[]   ",path:"/work/result-signals",description:"POST -     (equipmentManager.getRsltSinho4Wrk_2)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1}]},{id:"saveInstallInfo",category:"-",name:"[]   ",path:"/customer/work/saveInstallInfo",description:"POST -    (workmanAssignManagement.modNetInfo)",params:[{name:"WRK_ID",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"INSTALL_ADDR",type:"string",required:!1},{name:"INSTALL_MEMO",type:"string",required:!1},{name:"REG_UID",type:"string",required:!1}]},{id:"getEquipmentHistoryInfo",category:"-",name:"[]    (S/N, MAC)",path:"/statistics/equipment/getEquipmentHistoryInfo",description:"POST - S/N  MAC     (  )",params:[{name:"EQT_SERNO",type:"string",required:!1},{name:"MAC_ADDRESS",type:"string",required:!1}]},{id:"getEquipmentOutList",category:"-",name:"[]   ",path:"/customer/equipment/getEquipmentOutList",description:"POST - /    (  )",params:[{name:"FROM_OUT_REQ_DT",type:"string",required:!0,default:"20250101"},{name:"TO_OUT_REQ_DT",type:"string",required:!0,default:"20250131"},{name:"SO_ID",type:"string",required:!1},{name:"OUT_REQ_NO",type:"string",required:!1},{name:"PROC_STAT",type:"string",required:!1}]},{id:"checkEquipmentProc",category:"-",name:"[]     ",path:"/customer/equipment/getEquipmentProcYnCheck",description:"POST -       (  )",params:[{name:"OUT_REQ_NO",type:"string",required:!0}]},{id:"addEquipmentQuota",category:"-",name:"[]    ()",path:"/customer/equipment/addCorporationEquipmentQuota",description:"POST -     (  )",params:[{name:"OUT_REQ_NO",type:"string",required:!0},{name:"equipmentList",type:"array",required:!0,default:"[]"}]},{id:"getEquipmentReturnRequestList",category:"-",name:"[]     ()",path:"/customer/equipment/getEquipmentReturnRequestList",description:"POST -      (  )",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"SO_ID",type:"string",required:!1}]},{id:"checkEquipmentReturn",category:"-",name:"[]   ",path:"/customer/equipment/getEquipmentReturnRequestCheck",description:"POST -     (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0}]},{id:"addEquipmentReturnRequest",category:"-",name:"[]   ",path:"/customer/equipment/addEquipmentReturnRequest",description:"POST -     (  )",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"equipmentList",type:"array",required:!0,default:"[]"}]},{id:"getWorkerEquipmentList",category:"-",name:"[]    ",path:"/customer/equipment/getWrkrHaveEqtList",description:"POST -      (  )",params:[{name:"WRKR_ID",type:"string",required:!0},{name:"SO_ID",type:"string",required:!1},{name:"ITEM_MID_CD",type:"string",required:!1},{name:"EQT_SERNO",type:"string",required:!1}]},{id:"changeEquipmentWorker",category:"-",name:"[]    ()",path:"/customer/equipment/changeEqtWrkr_3",description:"POST -     (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"FROM_WRKR_ID",type:"string",required:!0},{name:"TO_WRKR_ID",type:"string",required:!0}]},{id:"processEquipmentLoss",category:"-",name:"[]   ",path:"/customer/equipment/cmplEqtCustLossIndem",description:"POST -    (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"WRKR_ID",type:"string",required:!0},{name:"LOSS_REASON",type:"string",required:!1}]},{id:"setEquipmentCheckStandby",category:"-",name:"[]    ()",path:"/customer/equipment/setEquipmentChkStndByY",description:"POST -      (  )",params:[{name:"EQT_NO",type:"string",required:!0}]},{id:"getUnreturnedEquipmentList",category:"-",name:"[]   ",path:"/customer/work/getEquipLossInfo",description:"POST -     (  )",params:[{name:"FROM_DT",type:"string",required:!1},{name:"TO_DT",type:"string",required:!1},{name:"CUST_ID",type:"string",required:!1},{name:"CUST_NM",type:"string",required:!1},{name:"EQT_SERNO",type:"string",required:!1}]},{id:"processEquipmentRecovery",category:"-",name:"[]    ",path:"/customer/work/modEquipLoss",description:"POST -      (  )",params:[{name:"EQT_NO",type:"string",required:!0},{name:"CTRT_ID",type:"string",required:!0},{name:"WRK_ID",type:"string",required:!1}]},{id:"findUserList",category:"-",name:"[] () ",path:"/system/cm/getFindUsrList3",description:"POST - /ID   (  )",params:[{name:"USR_NM",type:"string",required:!1},{name:"USR_ID",type:"string",required:!1},{name:"SO_ID",type:"string",required:!1}]},{id:"sendSmsNotification",category:"-",name:"[]   (ENS)",path:"/customer/sigtrans/saveENSSendHist",description:"POST -   (   ) (  )",params:[{name:"RECV_PHONE_NO",type:"string",required:!0},{name:"MSG_CONTENT",type:"string",required:!0},{name:"SEND_UID",type:"string",required:!0}]},{id:"changeEqtWrkrBatch",category:"-",name:"[]    ()",path:"/customer/equipment/changeEqtWrkr_3",description:"POST -       (  )",params:[{name:"FROM_WRKR_ID",type:"string",required:!0},{name:"TO_WRKR_ID",type:"string",required:!0},{name:"equipmentList",type:"array",required:!0,default:"[]"}]},{id:"getCodeDetail",category:"-",name:"[]  ",path:"/system/cm/getCodeDetail",description:"POST -      (  )",params:[{name:"GRP_CD",type:"string",required:!0,default:"EQT_STS"}]},{id:"getTodayWorkList",category:"-",name:"[]   ",path:"/customer/work/getTodayWorkList",description:"POST -      (  )",params:[{name:"WORK_DT",type:"string",required:!1},{name:"WRKR_ID",type:"string",required:!1}]}],Uq=()=>{const[t,e]=b.useState(null),[n,r]=b.useState({}),[i,a]=b.useState([]),[o,c]=b.useState(null),[u,h]=b.useState(!1),[m,_]=b.useState(""),[p,g]=b.useState("");b.useEffect(()=>{const G=localStorage.getItem("apiExplorer_calls");if(G)try{a(JSON.parse(G))}catch(B){console.error("Failed to restore API calls",B)}},[]),b.useEffect(()=>{localStorage.setItem("apiExplorer_calls",JSON.stringify(i))},[i]),b.useEffect(()=>{if(t){const G={},B=localStorage.getItem("userInfo");let I=null;if(B)try{I=JSON.parse(B)}catch(E){console.error("Failed to parse userInfo",E)}t.params.forEach(E=>{if(E.default!==void 0&&(G[E.name]=E.default),I)switch(E.name){case"WRKR_ID":G[E.name]=I.workerId||"A20130708";break;case"SO_ID":case"MST_SO_ID":G[E.name]=I.soId||"";break;case"CRR_ID":G[E.name]=I.crrId||"";break;case"REG_UID":case"SEND_UID":G[E.name]=I.userId||I.workerId||"";break;case"USR_ID":G[E.name]=I.userId||"";break}}),r(G)}},[t]);const C=(G,B)=>{r(I=>({...I,[G]:B}))},y=async()=>{if(!t)return;const G=`${Date.now()}-${Math.random()}`,B=performance.now(),I={id:G,timestamp:new Date().toISOString(),method:"POST",url:t.path,params:{...n},response:null,error:null,duration:0,status:"pending"};a(E=>[I,...E]),c(I),h(!0);try{const E=await fetch(`/api${t.path}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),Y=performance.now()-B;if(!E.ok)throw new Error(`HTTP ${E.status}: ${E.statusText}`);const ee=await E.json();a(J=>J.map(H=>H.id===G?{...H,response:ee,duration:Math.round(Y),status:"success"}:H)),c({...I,response:ee,duration:Math.round(Y),status:"success"})}catch(E){const Y=performance.now()-B;a(ee=>ee.map(J=>J.id===G?{...J,error:E.message,duration:Math.round(Y),status:"error"}:J)),c({...I,error:E.message,duration:Math.round(Y),status:"error"})}finally{h(!1)}},S=()=>{confirm(" API   ?")&&(a([]),c(null),localStorage.removeItem("apiExplorer_calls"))},v=()=>{if(!t)return;const G=localStorage.getItem("userInfo");let B=null;if(G)try{B=JSON.parse(G)}catch(E){console.error("Failed to parse userInfo",E)}const I={...n};t.params.forEach(E=>{if(!(I[E.name]&&I[E.name]!==""))switch(E.name){case"WORK_ID":case"WRK_ID":I[E.name]="W202501020001";break;case"RCPT_ID":I[E.name]="R202501020001";break;case"CTRT_ID":I[E.name]="C202501020001";break;case"WRK_DRCTN_ID":I[E.name]="D202501020001";break;case"EQT_NO":I[E.name]="EQ20250102001";break;case"EQT_SERNO":I[E.name]="SN20250102001";break;case"ITEM_MID_CD":I[E.name]="05";break;case"EQT_CL_CD":case"EQT_CL":I[E.name]="090401";break;case"MAC_ADDRESS":I[E.name]="00:11:22:33:44:55";break;case"CUST_ID":I[E.name]="CUST20250102001";break;case"CUST_NM":I[E.name]="";break;case"PHONE_NO":case"RECV_PHONE_NO":I[E.name]="010-1234-5678";break;case"WORK_DT":case"FROM_DT":case"TO_DT":const A=new Date().toISOString().slice(0,10).replace(/-/g,"");I[E.name]=A;break;case"WRK_STAT_CD":I[E.name]="2";break;case"EQT_USE_STAT_CD":I[E.name]="1";break;case"PROD_CD":I[E.name]="PROD001";break;case"SVC_CD":I[E.name]="SVC001";break;case"BLD_ID":I[E.name]="BLD20250102001";break;case"ADDR_ORD":I[E.name]="1";break;case"GRP_CD":I[E.name]="EQT_STS";break;case"USR_NM":I[E.name]="";break;case"MSG_CONTENT":I[E.name]=" .";break;case"LOSS_REASON":I[E.name]="";break}}),r(I)},k=()=>{const G=JSON.stringify(i,null,2),B="data:application/json;charset=utf-8,"+encodeURIComponent(G),I=`api-calls-${new Date().toISOString().slice(0,10)}.json`,E=document.createElement("a");E.setAttribute("href",B),E.setAttribute("download",I),E.click()},L=()=>{const G=["Timestamp","Method","URL","Status","Duration (ms)","Error"],B=i.map(ee=>[ee.timestamp,ee.method,ee.url,ee.status,ee.duration,ee.error||""]),I=[G.join(","),...B.map(ee=>ee.map(J=>`"${J}"`).join(","))].join(`
`),E="data:text/csv;charset=utf-8,"+encodeURIComponent(I),A=`api-calls-${new Date().toISOString().slice(0,10)}.csv`,Y=document.createElement("a");Y.setAttribute("href",E),Y.setAttribute("download",A),Y.click()},M=FT.filter(G=>{const B=m===""||G.name.toLowerCase().includes(m.toLowerCase())||G.path.toLowerCase().includes(m.toLowerCase()),I=p===""||G.category===p;return B&&I}),P=["",...Array.from(new Set(FT.map(G=>G.category)))],F=i.filter(G=>m===""?!0:G.url.toLowerCase().includes(m.toLowerCase())||JSON.stringify(G.params).toLowerCase().includes(m.toLowerCase()));return s.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"API Explorer"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"D-Live   API  "})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"API "}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),s.jsx("select",{value:p,onChange:G=>g(G.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",children:P.map(G=>s.jsx("option",{value:G,children:G},G))})]}),s.jsx("div",{className:"mb-4",children:s.jsx("input",{type:"text",placeholder:"...",value:m,onChange:G=>_(G.target.value),className:"w-full border border-gray-300 rounded px-3 py-2"})}),s.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:M.map(G=>s.jsxs("button",{onClick:()=>e(G),className:`w-full text-left p-3 rounded border ${(t==null?void 0:t.id)===G.id?"bg-blue-50 border-blue-500":"bg-white border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("div",{className:"font-medium text-sm",children:G.name}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:G.path}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:G.category})]},G.id))})]})}),s.jsxs("div",{className:"lg:col-span-1",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:" "}),t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-medium text-lg",children:t.name}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description}),s.jsxs("code",{className:"block bg-gray-100 p-2 rounded mt-2 text-sm",children:["POST ",t.path]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-medium",children:""}),t.params.length>0&&s.jsx("button",{onClick:v,className:"text-xs bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200",children:"  "})]}),t.params.length>0?s.jsx("div",{className:"space-y-3",children:t.params.map(G=>{var B;return s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[G.name,G.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"}),s.jsxs("span",{className:"text-gray-400 ml-2 text-xs",children:["(",G.type,")"]})]}),s.jsx("input",{type:"text",value:n[G.name]||"",onChange:I=>C(G.name,I.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:((B=G.default)==null?void 0:B.toString())||""})]},G.name)})}):s.jsx("p",{className:"text-sm text-gray-500",children:" "})]}),s.jsx("button",{onClick:y,disabled:u,className:"w-full bg-blue-600 text-white py-3 rounded font-medium hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:u?" ...":"API "})]}):s.jsx("p",{className:"text-gray-500 text-center py-8",children:" API  "})]}),o&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mt-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"font-medium",children:""}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o.status==="success"?"bg-green-100 text-green-800":o.status==="error"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:o.status}),s.jsxs("span",{className:"text-xs text-gray-500",children:[o.duration,"ms"]})]})]}),o.error?s.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-3 text-red-700 text-sm",children:o.error}):o.response?s.jsx("div",{className:"bg-gray-50 rounded p-3 max-h-[400px] overflow-y-auto",children:s.jsx("pre",{className:"text-xs",children:JSON.stringify(o.response,null,2)})}):s.jsx("p",{className:"text-gray-500 text-sm",children:"  ..."})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:k,className:"text-xs bg-gray-200 px-2 py-1 rounded hover:bg-gray-300",disabled:i.length===0,children:"JSON"}),s.jsx("button",{onClick:L,className:"text-xs bg-gray-200 px-2 py-1 rounded hover:bg-gray-300",disabled:i.length===0,children:"CSV"}),s.jsx("button",{onClick:S,className:"text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",disabled:i.length===0,children:""})]})]}),s.jsx("div",{className:"space-y-2 max-h-[800px] overflow-y-auto",children:F.length>0?F.map(G=>s.jsxs("button",{onClick:()=>c(G),className:`w-full text-left p-3 rounded border ${(o==null?void 0:o.id)===G.id?"bg-blue-50 border-blue-500":"bg-white border-gray-300 hover:bg-gray-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:new Date(G.timestamp).toLocaleTimeString("ko-KR")}),s.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${G.status==="success"?"bg-green-100 text-green-800":G.status==="error"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:[G.duration,"ms"]})]}),s.jsx("div",{className:"text-sm font-medium truncate",children:G.url}),G.error&&s.jsx("div",{className:"text-xs text-red-600 truncate mt-1",children:G.error})]},G.id)):s.jsx("p",{className:"text-gray-500 text-center py-8 text-sm",children:"  "})})]})})]})]})})},Bq=({onBack:t,userInfo:e,showToast:n})=>{const[r,i]=b.useState([]),[a,o]=b.useState(null),[c,u]=b.useState(!1),[h,m]=b.useState(null);b.useEffect(()=>{_()},[]);const _=async()=>{try{u(!0),m(null);const S=new Date,v=new Date;v.setMonth(S.getMonth()-1);const k={ENTR_NO:"",CTRT_ID:"",WORK_DT_FROM:v.toISOString().slice(0,10).replace(/-/g,""),WORK_DT_TO:S.toISOString().slice(0,10).replace(/-/g,""),WRKR_ID:(e==null?void 0:e.userId)||""},L=await YP(k);i(L),L.length>0&&o(L[0]),console.log(" LGU    :",L.length)}catch(S){console.error(" LGU    :",S),m("   .")}finally{u(!1)}},p=S=>{o(S)},g=()=>{n&&n("   .","info")},C=()=>{if(!a||!a.CONSREQNO){n&&n("     .","warning");return}n&&n("   .","info")},y=()=>{if(!a||!a.CONSREQNO){n&&n("     .","warning");return}n&&n("   .","info")};return s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 sm:mb-3 flex items-center justify-between gap-2",children:[s.jsx("div",{children:s.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-900",children:"(LGU) "})}),s.jsxs("button",{onClick:_,disabled:c,className:"flex items-center gap-1 px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-xs sm:text-sm text-gray-700 disabled:opacity-50",children:[s.jsx(Oc,{className:`w-3.5 h-3.5 sm:w-4 sm:h-4 ${c?"animate-spin":""}`}),""]})]}),c?s.jsxs("div",{className:"text-center p-6 sm:p-10",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 sm:h-8 sm:w-8 border-4 border-orange-500 border-t-transparent"}),s.jsx("p",{className:"mt-2 text-gray-600 text-sm sm:text-base",children:" ..."})]}):h?s.jsxs("div",{className:"text-center p-6 sm:p-10 bg-white rounded-lg shadow-sm border border-red-200",children:[s.jsx("p",{className:"text-red-500 text-sm sm:text-base",children:h}),s.jsx("button",{onClick:_,className:"mt-3 sm:mt-4 px-3 sm:px-4 py-1.5 sm:py-2 bg-orange-500 text-white text-sm rounded-lg hover:bg-orange-600",children:" "})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden mb-2 sm:mb-3",children:r.length>0?s.jsx("div",{className:"max-h-40 sm:max-h-48 overflow-y-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:"ID"}),s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""}),s.jsx("th",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-left text-xs font-semibold text-gray-700 border-b",children:""})]})}),s.jsx("tbody",{children:r.map((S,v)=>s.jsxs("tr",{onClick:()=>p(S),className:`cursor-pointer hover:bg-orange-50 transition-colors ${a===S?"bg-orange-100":""}`,children:[s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:S.CONSREQNO||"-"}),s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:S.CTRT_ID||"-"}),s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:S.CONSCHRRNM||"-"}),s.jsx("td",{className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs text-gray-900 border-b",children:S.CONSFNSHSCDLDT||"-"})]},v))})]})}):s.jsx("div",{className:"p-4 sm:p-6 text-center text-gray-500 text-xs sm:text-sm",children:"   "})}),a&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 space-y-2 sm:space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSREQNO||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSCHRRNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSCHRRTLNO||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("textarea",{value:a.CONSCHRRMAKRMKS||"",readOnly:!0,rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50 resize-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSFNSHSCDLDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSFNSHDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSNEEDDIVSNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSDLYRSNNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSIPSBPRSSDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSIPSBRSNNM||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{type:"text",value:a.CONSNREQPRSSDT||"",readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("textarea",{value:a.CONSNREQRSNNM||"",readOnly:!0,rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50 resize-none"})]})]}),s.jsxs("div",{className:"mt-3 sm:mt-4 grid grid-cols-3 gap-1.5 sm:gap-2",children:[s.jsx("button",{onClick:g,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""}),s.jsx("button",{onClick:C,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""}),s.jsx("button",{onClick:y,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""})]})]})]})},jf={WORK_FILTERS:"dlive_work_filters",WORK_SELECTED_ORDER:"dlive_work_selected_order",WORK_SELECTED_DIRECTION:"dlive_work_selected_direction",WORK_FORM_DATA:"dlive_work_form_data",ACTIVE_TAB:"dlive_active_tab",ACTIVE_VIEW:"dlive_active_view",LGU_CONSTRUCTION_FORM:"dlive_lgu_construction_form",LGU_NETWORK_FAULT_FORM:"dlive_lgu_network_fault_form",SIGNAL_HISTORY_FILTERS:"dlive_signal_history_filters",WORK_RESULT_SIGNAL_FILTERS:"dlive_work_result_signal_filters",WORK_PROCESS_STEP:"dlive_work_process_step",WORK_PROCESS_EQUIPMENT:"dlive_work_process_equipment"},Gq=(t,e)=>{try{typeof window<"u"&&localStorage.setItem(t,JSON.stringify(e))}catch(n){console.error("  :",n)}},Wq=t=>{try{if(typeof window<"u"){const e=localStorage.getItem(t);return e?JSON.parse(e):null}return null}catch(e){return console.error("  :",e),null}},KT=t=>{try{typeof window<"u"&&localStorage.removeItem(t)}catch(e){console.error("  :",e)}},Fq=()=>{try{if(typeof window<"u"){Object.values(jf).forEach(n=>{localStorage.removeItem(n)});const t=["dlive-work-equipment-storage","dlive-work-process-storage","dlive-equipment-storage","dlive-ui-storage"];t.forEach(n=>{localStorage.removeItem(n)});const e=[];for(let n=0;n<localStorage.length;n++){const r=localStorage.key(n);r&&(r.startsWith("work_complete_draft_")||r.startsWith("equipment_draft_"))&&e.push(r)}e.forEach(n=>{localStorage.removeItem(n)}),console.log("[clearAllSessions]  :",{sessionKeys:Object.values(jf).length,zustandKeys:t.length,draftKeys:e.length})}}catch(t){console.error("   :",t)}},Kq=({onBack:t,userInfo:e,showToast:n})=>{const r=Wq(jf.LGU_NETWORK_FAULT_FORM),[i,a]=b.useState({CTRT_ID:(r==null?void 0:r.CTRT_ID)||"",CUST_ID:(r==null?void 0:r.CUST_ID)||"",WRK_ID:(r==null?void 0:r.WRK_ID)||"",CANCEL_TYPE:(r==null?void 0:r.CANCEL_TYPE)||""}),[o,c]=b.useState(!1),[u,h]=b.useState(null);b.useEffect(()=>{Gq(jf.LGU_NETWORK_FAULT_FORM,i)},[i]);const m=(p,g)=>{a(C=>({...C,[p]:g}))},_=async p=>{if(p.preventDefault(),!i.CTRT_ID||!i.CUST_ID||!i.WRK_ID){n&&n("   .","warning");return}c(!0),h(null);try{const g={...i,CRR_ID:(e==null?void 0:e.crrId)||"01",SO_ID:(e==null?void 0:e.soId)||"",REG_UID:(e==null?void 0:e.userId)||"mobile_user"},C=await EM(g);console.log(" LGU   :",C),h({success:!0,data:C}),n&&n("LGU   .","success"),a({CTRT_ID:"",CUST_ID:"",WRK_ID:"",CANCEL_TYPE:""}),KT(jf.LGU_NETWORK_FAULT_FORM)}catch(g){console.error(" LGU   :",g),h({success:!1,error:g.message}),n&&n(`LGU   : ${g.message}`,"error")}finally{c(!1)}};return s.jsxs("div",{children:[s.jsx("div",{className:"mb-2 sm:mb-3",children:s.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-900",children:"(LGU) "})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4",children:s.jsxs("form",{onSubmit:_,className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:[" ID ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i.CTRT_ID,onChange:p=>m("CTRT_ID",p.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:" ID ",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:[" ID ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i.CUST_ID,onChange:p=>m("CUST_ID",p.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:" ID ",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:[" ID ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i.WRK_ID,onChange:p=>m("WRK_ID",p.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:" ID ",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" "}),s.jsx("input",{type:"text",value:i.CANCEL_TYPE,onChange:p=>m("CANCEL_TYPE",p.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"  ()"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2 mt-3 sm:mt-4",children:[s.jsx("button",{type:"submit",disabled:o,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:o?" ...":" "}),s.jsx("button",{type:"button",onClick:()=>{a({CTRT_ID:"",CUST_ID:"",WRK_ID:"",CANCEL_TYPE:""}),h(null),KT(jf.LGU_NETWORK_FAULT_FORM)},className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium text-xs sm:text-sm shadow-md transition-all",children:""})]})]})}),u&&s.jsxs("div",{className:"mt-2 sm:mt-3 bg-white rounded-lg shadow-sm border border-gray-200 p-2.5 sm:p-3",children:[s.jsx("div",{className:"mb-1.5 sm:mb-2",children:s.jsx("span",{className:`text-xs sm:text-sm font-semibold flex items-center gap-1 ${u.success?"text-green-600":"text-red-600"}`,children:u.success?s.jsxs(s.Fragment,{children:[s.jsx(ea,{size:14,className:"sm:w-4 sm:h-4"}),"  "]}):s.jsxs(s.Fragment,{children:[s.jsx(Vr,{size:14,className:"sm:w-4 sm:h-4"}),"  "]})})}),s.jsx("div",{className:"bg-gray-50 rounded p-1.5 sm:p-2",children:s.jsx("pre",{className:"text-xs text-gray-700 overflow-x-auto whitespace-pre-wrap break-words",children:JSON.stringify(u.success?u.data:u.error,null,2)})})]})]})},Qq=({onNavigateToMenu:t,userInfo:e,showToast:n})=>{const[r,i]=b.useState("time-request"),a=Ji.useRef(null),o=Ji.useRef([]),c=[{id:"time-request",title:""},{id:"time-record",title:""},{id:"notice",title:""},{id:"signal-interlock",title:""},{id:"lgu-construction",title:"(LGU)"},{id:"lgu-network-fault",title:"(LGU)"},{id:"auto-confirm",title:""}],u=h=>{i(h),setTimeout(()=>{const _=a.current,p=o.current[c.findIndex(g=>g.id===h)];if(_&&p){const g=_.getBoundingClientRect(),C=p.getBoundingClientRect(),y=C.left-g.left-g.width/2+C.width/2;_.scrollTo({left:_.scrollLeft+y,behavior:"smooth"})}},0)};return s.jsx("div",{className:"w-full",children:s.jsxs(O4,{value:r,onValueChange:u,className:"w-full",children:[s.jsx("div",{className:"bg-white border-b border-gray-200",children:s.jsx("div",{ref:a,className:"w-full overflow-x-auto scrollbar-hide",children:s.jsx(oS,{className:"inline-flex justify-start bg-white rounded-none h-auto py-2 px-3 border-none min-w-max overflow-visible",children:c.map((h,m)=>s.jsx(cS,{value:h.id,ref:_=>o.current[m]=_,className:"data-[state=active]:bg-blue-500 data-[state=active]:text-white data-[state=inactive]:text-gray-600 rounded-full px-4 py-2 text-sm font-medium flex-shrink-0 mx-1 transition-colors whitespace-nowrap",children:h.title},h.id))})})}),s.jsx(lo,{value:"time-request",className:"px-3 pt-1",children:s.jsx(jg,{onNavigateToMenu:t,title:"",description:"    ."})}),s.jsx(lo,{value:"time-record",className:"px-3 pt-1",children:s.jsx(jg,{onNavigateToMenu:t,title:"",description:"     ."})}),s.jsx(lo,{value:"notice",className:"px-3 pt-1",children:s.jsx(jg,{onNavigateToMenu:t,title:"",description:"   ."})}),s.jsx(lo,{value:"signal-interlock",className:"px-3 pt-1",children:s.jsx(ZM,{onBack:t,userInfo:e,showToast:n})}),s.jsx(lo,{value:"lgu-construction",className:"px-3 pt-1",children:s.jsx(Bq,{onBack:t,userInfo:e,showToast:n})}),s.jsx(lo,{value:"lgu-network-fault",className:"px-3 pt-1",children:s.jsx(Kq,{onBack:t,userInfo:e,showToast:n})}),s.jsx(lo,{value:"auto-confirm",className:"px-3 pt-1",children:s.jsx(jg,{onNavigateToMenu:t,title:"",description:"   ."})})]})})},Yq=[{key:"small",label:"",size:"14px",preview:"text-xs"},{key:"medium",label:"",size:"16px",preview:"text-sm"},{key:"large",label:"",size:"18px",preview:"text-base"},{key:"xlarge",label:" ",size:"20px",preview:"text-lg"}],Vq=({onBack:t})=>{const{fontScale:e,setFontScale:n}=co();return s.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[s.jsxs("div",{className:"bg-white border-b px-4 py-3 flex items-center gap-3",children:[s.jsx("button",{onClick:t,className:"p-1 -ml-1",children:s.jsx(pM,{className:"w-5 h-5 text-gray-600"})}),s.jsx("h1",{className:"font-bold text-base",children:""})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[s.jsx("h2",{className:"font-semibold text-sm text-gray-800 mb-3",children:" "}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:Yq.map(r=>s.jsxs("button",{onClick:()=>n(r.key),className:`flex flex-col items-center justify-center py-3 px-2 rounded-lg border-2 transition-all ${e===r.key?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("span",{className:`font-bold mb-1 ${e===r.key?"text-blue-600":"text-gray-700"}`,style:{fontSize:r.size},children:""}),s.jsx("span",{className:`text-xs ${e===r.key?"text-blue-600 font-semibold":"text-gray-500"}`,children:r.label})]},r.key))}),s.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"  .     ."})]})})]})},$q="/shuild.png",MO="notice_popup_dismissed",zq=()=>{try{return localStorage.getItem(MO)}catch{return null}},Hq=()=>{try{const t=new Date().toISOString().split("T")[0];localStorage.setItem(MO,t)}catch{}},qq=()=>{const t=zq();if(!t)return!0;const e=new Date().toISOString().split("T")[0];return t!==e},Xq=({isOpen:t,onClose:e})=>{const[n,r]=b.useState(!1);if(b.useEffect(()=>{t&&r(!1)},[t]),!t)return null;const i=()=>{n&&Hq(),e()},a=o=>{o.target===o.currentTarget&&i()};return s.jsx("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.75)"},onClick:a,children:s.jsxs("div",{className:"relative w-full max-w-md",children:[s.jsx("button",{onClick:i,className:"absolute -top-12 right-0 p-2 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-sm transition-all z-10",children:s.jsx(Mi,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"relative rounded-2xl overflow-hidden shadow-2xl bg-white",children:s.jsx("img",{src:$q,alt:"  ",className:"w-full h-auto"})}),s.jsxs("div",{className:"mt-4 flex items-center justify-between px-1",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:n,onChange:o=>r(o.target.checked),className:"w-4 h-4 rounded border-white/50 bg-white/20 text-blue-500 focus:ring-0"}),s.jsx("span",{className:"text-sm text-white/90",children:"   "})]}),s.jsx("button",{onClick:i,className:"px-5 py-2 bg-white/20 hover:bg-white/30 text-white text-sm font-semibold rounded-full transition-all backdrop-blur-sm",children:""})]})]})})},Jq={"today-work":null,menu:"today-work","work-management":"today-work","work-item-list":"work-management","work-order-detail":"work-item-list","work-process-flow":"work-item-list","work-complete-form":"work-order-detail","work-complete-detail":"work-item-list","customer-management":"today-work","equipment-management":"today-work","other-management":"today-work","api-explorer":"today-work","coming-soon":"today-work",settings:"today-work"},Zq=()=>{const[t,e]=b.useState(!1),[n,r]=b.useState(null),[i,a]=b.useState(null),[o,c]=b.useState(""),[u,h]=b.useState(!1),[m,_]=b.useState({todayInProgress:0,todayCompleted:0,weekTotal:0,monthTotal:0}),{isDrawerOpen:p,openDrawer:g,closeDrawer:C,currentView:y,setCurrentView:S,setWorkFilters:v,selectedWorkItem:k,setSelectedWorkItem:L,selectedWorkDirection:M,setSelectedWorkDirection:P,fontScale:F}=co();b.useEffect(()=>{const V={small:"14px",medium:"16px",large:"18px",xlarge:"20px"};document.documentElement.style.fontSize=V[F]||"16px"},[F]),b.useEffect(()=>{const V=j=>{console.error("Unhandled Promise Rejection:",j.reason),A("   .","error")},K=j=>{console.error("Global Error:",j.error)};return window.addEventListener("unhandledrejection",V),window.addEventListener("error",K),()=>{window.removeEventListener("unhandledrejection",V),window.removeEventListener("error",K)}},[]);const G=(V,K,j,te,ce,R,O,U,Q)=>{if(e(!0),S("today-work"),V){const $={userId:V,userName:K||"",userNameEn:j||K||"",userRole:te||"",crrId:ce,soId:R,mstSoId:O,telNo2:U,authSoList:Q||[]};r($),localStorage.setItem("userInfo",JSON.stringify($)),sessionStorage.setItem("userInfo",JSON.stringify($)),localStorage.setItem("user",JSON.stringify({USR_ID:V,WRKR_ID:V,userId:V,soId:R,SO_ID:R,AUTH_SO_List:Q||[]})),Q&&Q.length>0&&localStorage.setItem("branchList",JSON.stringify(Q))}const q=new Date().toISOString().split("T")[0];v({startDate:q,endDate:q,filter:""}),qq()&&h(!0)},B=()=>{e(!1),r(null),localStorage.removeItem("userInfo"),localStorage.removeItem("user"),localStorage.removeItem("branchList"),Fq(),L(null),P(null),S("today-work"),sE.clear()},I=()=>{S("today-work")},E=V=>{c(V),S("coming-soon")},A=b.useCallback((V,K="info",j=!1)=>{a({message:V,type:K,persistent:j})},[]),Y=(V,K)=>{if(S(V),K)switch(V){case"work-order-detail":case"work-process-flow":case"work-complete-form":case"work-complete-detail":L(K);break;case"work-item-list":P(K);break}},ee=()=>{const V=Jq[y];V&&S(V)};if(!t)return s.jsx(EY,{onLogin:G});const J=()=>{switch(y){case"today-work":return s.jsx(jY,{onNavigateToView:Y,onNavigateToComingSoon:E,userInfo:n,showToast:A});case"menu":return s.jsx(fR,{onSelectMenu:Y});case"work-management":return s.jsx(bY,{onNavigateToMenu:I,onNavigateToView:Y,userInfo:n,showToast:A});case"work-order-detail":return k?s.jsx(BM,{order:k,onBack:ee,onStartWorkProcess:V=>{L(V),S("work-process-flow")},onComplete:V=>{L(V),S("work-process-flow")},showToast:A},k.id):s.jsx("div",{children:"     ."});case"work-process-flow":return k?s.jsx(rV,{workItem:k,onComplete:()=>{A("  .","success"),S("work-item-list")},onBack:ee,showToast:A}):s.jsx("div",{children:"    ."});case"work-complete-form":return k?s.jsx(Fp,{order:k,onBack:ee,onSuccess:()=>{A("  .","success"),S("work-item-list")},showToast:A}):s.jsx("div",{children:"    ."});case"work-complete-detail":return k?s.jsx(IY,{order:k,onBack:()=>{L(null),S("work-item-list")}}):s.jsx("div",{children:"    ."});case"work-item-list":return M?s.jsx(qM,{direction:M,onBack:ee,onNavigateToView:Y,userId:n==null?void 0:n.userId,showToast:A}):s.jsx("div",{children:"    ."});case"customer-management":return null;case"equipment-management":return null;case"api-explorer":return s.jsx(Uq,{});case"other-management":return s.jsx(Qq,{onNavigateToMenu:I,userInfo:n,showToast:A});case"settings":return s.jsx(Vq,{onBack:ee});case"coming-soon":return s.jsx(jg,{onNavigateToMenu:I,title:o});default:return s.jsx(fR,{onSelectMenu:Y})}},H=V=>{switch(V){case"today-work":Y("today-work");break;case"work-management":Y("work-management");break;case"customer-management":Y("customer-management");break;case"equipment-management":Y("equipment-management");break;case"other-management":Y("other-management");break;default:Y("today-work")}};return s.jsxs(Nw,{client:sE,children:[s.jsx(lV,{children:s.jsxs("div",{className:"h-[100dvh] bg-white font-sans overflow-hidden flex flex-col",children:[s.jsx(aV,{isOpen:p,onClose:C,userName:n==null?void 0:n.userName,userId:n==null?void 0:n.userId,stats:m,onLogout:B,onNavigate:H}),s.jsx(AP,{onLogout:B,onNavigateHome:I,onNavigateBack:ee,onMenuClick:g,currentView:y,userInfo:n,selectedWorkItem:k}),s.jsxs("main",{className:"flex-1 w-full max-w-7xl mx-auto pt-12 pb-[calc(52px+env(safe-area-inset-bottom,0px))] flex flex-col overflow-hidden",children:[J(),s.jsx("div",{style:{display:y==="customer-management"?"contents":"none"},children:s.jsx(oq,{onNavigateToMenu:I,showToast:A})}),s.jsx("div",{style:{display:y==="equipment-management"?"contents":"none"},children:s.jsx(kq,{onNavigateToMenu:I,showToast:A})})]}),s.jsx(RY,{currentView:y,onSelectMenu:Y}),i&&s.jsx(iV,{message:i.message,type:i.type,persistent:i.persistent,onClose:()=>a(null)}),s.jsx(Xq,{isOpen:u,onClose:()=>h(!1)})]})}),s.jsx(Uw,{initialIsOpen:!1})]})},QT=500;let Of=[],IO=!0;const eX=t=>{const e={...t,id:`log_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString()};return Of.unshift(e),Of.length>QT&&(Of=Of.slice(0,QT)),IO&&rX(e),typeof window<"u"&&window.dispatchEvent(new CustomEvent("api-log-added",{detail:e})),e},tX=()=>[...Of],sX=()=>{Of=[]},nX=t=>{IO=t},rX=t=>{const e={success:"",error:"",timeout:""}[t.status],n={success:"color: #10B981",error:"color: #EF4444",timeout:"color: #F59E0B"}[t.status];console.group(`%c${e} [${t.method}] ${t.api} (${t.duration}ms)`,`font-weight: bold; ${n}`),console.log("%c Request:","color: #3B82F6; font-weight: bold"),console.table(t.request),t.status==="success"?(console.log("%c Response:","color: #10B981; font-weight: bold"),Array.isArray(t.response)?(console.log(`Array[${t.response.length}]`),t.response.length>0&&(console.log("First item fields:",Object.keys(t.response[0])),console.table(t.response.slice(0,3)))):typeof t.response=="object"?console.table(t.response):console.log(t.response)):console.log("%c Error:","color: #EF4444; font-weight: bold",t.error),console.groupEnd()},jO=[{name:"",api:"/customer/equipment/getEquipmentOutList",method:"POST",params:{WRKR_ID:"20230019"},expectedFields:["EQT_NO","EQT_TYPE","SERIAL_NO","WRKR_ID"],description:"   "},{name:"",api:"/customer/equipment/getEquipmentProcYnCheck",method:"POST",params:{WRKR_ID:"20230019",SO_ID:"SO001",EQT_NO:"EQT001"},expectedFields:["PROC_YN","EQT_NO"],description:"    "},{name:"",api:"/customer/equipment/addCorporationEquipmentQuota",method:"POST",params:{SO_ID:"SO001",EQT_NO:"EQT001",CARRIER_ID:"CRR001",WRKR_ID:"20230019"},expectedFields:["RESULT","MESSAGE"],description:"    ()"},{name:"",api:"/customer/equipment/getEquipmentReturnRequestList",method:"POST",params:{WRKR_ID:"20230019"},expectedFields:["REQUEST_ID","EQT_NO","STATUS"],description:"  "},{name:"",api:"/customer/equipment/getEquipmentReturnRequestCheck",method:"POST",params:{WRKR_ID:"20230019",SO_ID:"SO001",EQT_NO:"EQT001"},expectedFields:["RETURN_YN"],description:"     "},{name:"",api:"/customer/equipment/addEquipmentReturnRequest",method:"POST",params:{EQT_NO:"EQT001",WRKR_ID:"20230019"},expectedFields:["RESULT","REQUEST_ID"],description:"   "},{name:"",api:"/customer/equipment/getWrkrHaveEqtList",method:"POST",params:{WRKR_ID:"20230019"},expectedFields:["EQT_NO","EQT_TYPE","SERIAL_NO","STATUS"],description:"   "},{name:"",api:"/customer/equipment/cmplEqtCustLossIndem",method:"POST",params:{EQT_NO:"EQT001"},expectedFields:["RESULT","INDEM_AMOUNT"],description:"   "},{name:"()",api:"/customer/equipment/setEquipmentChkStndByY",method:"POST",params:{EQT_NO:"EQT001",WRKR_ID:"20230019"},expectedFields:["RESULT","NEW_STATUS"],description:"  "},{name:"",api:"/statistics/equipment/getEquipmentHistoryInfo",method:"POST",params:{EQT_NO:"EQT001"},expectedFields:["HIST_ID","HIST_TYPE","HIST_DATE"],description:"  "},{name:"",api:"/customer/equipment/changeEqtWrkr_3_ForM",method:"POST",params:{EQT_NO:"EQT001",TO_WRKR_ID:"20230020"},expectedFields:["MSGCODE","MESSAGE","MV_WRKR_ID"],description:"    (Map  )"},{name:"",api:"/system/cm/getFindUsrList3",method:"POST",params:{USR_NM:""},expectedFields:["USR_ID","USR_NM","MOBILE"],description:" "},{name:"",api:"/customer/sigtrans/saveENSSendHist",method:"POST",params:{EQT_NO:"EQT001",TO_WRKR_ID:"20230020",FROM_WRKR_ID:"20230019"},expectedFields:["RESULT","ENS_ID"],description:"   "},{name:"",api:"/customer/work/getEquipLossInfo",method:"POST",params:{},expectedFields:["LOSS_ID","EQT_NO","STATE"],description:"/  "},{name:"",api:"/customer/work/modEquipLoss",method:"POST",params:{EQT_NO:"EQT001",STATE:"Recovered"},expectedFields:["RESULT","NEW_STATE"],description:"   "},{name:"",api:"/customer/work/getCustProdInfo",method:"POST",params:{WRKR_ID:"20230019",EQT_SEL:"0",EQT_CL:"ALL"},expectedFields:["output1","output2","output3"],description:" 3  "},{name:"",api:"/customer/work/eqtCmpsInfoChg",method:"POST",params:{WRK_ID:"WRK001",parameters:[]},expectedFields:["RESULT"],description:"    "},{name:"",api:"/customer/work/signalCheck",method:"POST",params:{serialNo:"TEST001",equipmentType:"modem"},expectedFields:["status","message"],description:"/STB  "},{name:"",api:"/customer/receipt/contract/getEquipmentNmListOfProd",method:"POST",params:{PROD_CD:"PROD001"},expectedFields:["EQT_CL_CD","EQT_CL_NM"],description:"    "},{name:"",api:"/customer/receipt/contract/getContractEqtList",method:"POST",params:{CTRT_ID:"CTRT001",PROD_CD:"PROD001"},expectedFields:["SVC_CMPS_ID","EQT_NO"],description:"  "}],iX={"/customer/equipment/getWrkrHaveEqtList":[{param:"EQT_STAT_CD",values:["10","3","20","30","Assigned","Available","Lost"],description:"   ( vs )"},{param:"ITEM_MID_CD",values:["04","05","07","03","4","5","MODEM","STB"],description:"  (04:, 05:STB)"},{param:"EQT_SEL",values:["0","1","Y","N","ALL"],description:"  "},{param:"EQT_CL",values:["ALL","MODEM","STB","04","05"],description:" "}],"/customer/equipment/getEquipmentOutList":[{param:"OUT_STAT",values:["Y","N","1","0","OUT","IN"],description:" "},{param:"SEARCH_TYPE",values:["1","2","3","A","B","ALL"],description:" "}],"/customer/work/getCustProdInfo":[{param:"EQT_SEL",values:["0","1","2","Y","N"],description:"  "},{param:"EQT_CL",values:["ALL","04","05","MODEM","STB","1","2"],description:"  "},{param:"CRR_TSK_CL",values:["01","05","07","09","11","1","5","7","9"],description:"  (01:, 05:, 07:, 09:AS)"}],"/system/cm/getFindUsrList3":[{param:"SEARCH_TYPE",values:["1","2","3","NM","ID","ALL"],description:" "},{param:"USR_TYPE",values:["W","M","A","Worker","Manager","1","2"],description:" "}]},aX=async(t,e,n,r)=>{const i={api:t,workingParams:[],failedParams:[],discoveredFields:[],notes:[]};console.group(`%c  : ${t}`,"font-weight: bold; color: #8B5CF6"),console.log(" :",e),console.log(" :",n.length," ");try{const a=await YT(r+t,"POST",e);a.success&&(i.workingParams.push({...e,_note:" "}),i.discoveredFields=a.fields,i.notes.push("    "))}catch{i.notes.push("   ")}for(const a of n){console.log(`
: ${a.param} - ${a.description}`);for(const o of a.values){const c={...e,[a.param]:o};try{const u=await YT(r+t,"POST",c);u.success?(console.log(`   ${a.param}=${o}   (${u.fields.length} fields)`),i.workingParams.push({...c,_note:`${a.param}=${o} `}),u.fields.forEach(h=>{i.discoveredFields.includes(h)||(i.discoveredFields.push(h),i.notes.push(`   : ${h} (${a.param}=${o})`))})):(console.log(`   ${a.param}=${o}  `),i.failedParams.push({...c,_error:u.error}))}catch{console.log(`   ${a.param}=${o}  `)}await new Promise(u=>setTimeout(u,100))}}return console.groupEnd(),i},YT=async(t,e,n)=>{try{const r=await fetch(t,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!r.ok)return{success:!1,fields:[],error:`HTTP ${r.status}`};const i=await r.json();let a=[];return Array.isArray(i)&&i.length>0?a=Object.keys(i[0]):typeof i=="object"&&i!==null&&(a=Object.keys(i)),i.code==="ERROR"||i.error||i.RESULT==="FAIL"?{success:!1,fields:a,error:i.message||i.error}:{success:!0,fields:a}}catch(r){return{success:!1,fields:[],error:r.message}}},lX=async(t,e=jO,n=1e4)=>{const r=Date.now();console.clear(),console.log("%c D'Live  API   ","font-size: 20px; font-weight: bold; color: #3B82F6"),console.log(` : ${new Date().toLocaleString()}`),console.log(`API Base: ${t}`),console.log(` : ${e.length}`),console.log("".repeat(60));const i=[];for(let m=0;m<e.length;m++){const _=e[m],p=`[${m+1}/${e.length}]`;console.log(`
${p} : ${_.name}`),console.log(`  API: ${_.api}`),console.log("  Params:",_.params);const g=Date.now();try{const C=new AbortController,y=setTimeout(()=>C.abort(),n),S=await fetch(t+_.api,{method:_.method,headers:{"Content-Type":"application/json"},body:_.method==="POST"?JSON.stringify(_.params):void 0,credentials:"include",signal:C.signal});clearTimeout(y);const v=Date.now()-g;if(!S.ok){console.log(`   HTTP Error: ${S.status}`),i.push({name:_.name,api:_.api,status:"error",duration:v,error:`HTTP ${S.status}`});continue}const k=await S.json();let L=[];if(Array.isArray(k)&&k.length>0?(L=Object.keys(k[0]),console.log(`    (${v}ms) - Array[${k.length}]`),console.log(`   : ${L.join(", ")}`)):k.output1||k.output2?(L=Object.keys(k),console.log(`    (${v}ms) - Multi-output`),Object.keys(k).forEach(M=>{Array.isArray(k[M])&&console.log(`    ${M}: Array[${k[M].length}]`)})):typeof k=="object"&&(L=Object.keys(k),console.log(`    (${v}ms)`),console.log(`   : ${L.join(", ")}`)),_.expectedFields){const M=_.expectedFields.filter(P=>!L.includes(P));M.length>0&&console.log(`     : ${M.join(", ")}`)}i.push({name:_.name,api:_.api,status:"success",duration:v,responseFields:L})}catch(C){const y=Date.now()-g;C.name==="AbortError"?(console.log(`    (${n}ms)`),i.push({name:_.name,api:_.api,status:"timeout",duration:y,error:"Timeout"})):(console.log(`   : ${C.message}`),i.push({name:_.name,api:_.api,status:"error",duration:y,error:C.message}))}await new Promise(C=>setTimeout(C,200))}const a=i.filter(m=>m.status==="success").length,o=i.filter(m=>m.status==="error").length,c=i.filter(m=>m.status==="timeout").length,u=Date.now()-r;console.log(`
`+"".repeat(60)),console.log("%c   ","font-size: 16px; font-weight: bold"),console.log("".repeat(60)),console.log(` API: ${e.length}`),console.log(`%c : ${a}`,"color: #10B981"),console.log(`%c : ${o}`,"color: #EF4444"),console.log(`%c : ${c}`,"color: #F59E0B"),console.log(` : ${(u/1e3).toFixed(1)}`),console.log("".repeat(60)),(o>0||c>0)&&(console.log(`
%c   API:`,"font-weight: bold; color: #F59E0B"),i.filter(m=>m.status!=="success").forEach(m=>{console.log(`  - ${m.name}: ${m.error||m.status}`)})),console.log(`
%c   :`,"font-weight: bold; color: #3B82F6"),i.filter(m=>m.status==="success"&&m.responseFields).forEach(m=>{var _;console.log(`  ${m.name}: ${(_=m.responseFields)==null?void 0:_.join(", ")}`)});const h={timestamp:new Date().toISOString(),totalApis:e.length,successCount:a,failCount:o,timeoutCount:c,results:i,summary:`${a}/${e.length} APIs working (${o} failed, ${c} timeout)`};return typeof window<"u"&&(window.__lastApiCheck=h,console.log(`
  : window.__lastApiCheck`)),h},oX=t=>{const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`api-check-${new Date().toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(n)};typeof window<"u"&&(window.dliveDebug={runFullCheck:t=>lX(t||"/api"),getLogs:tX,clearLogs:sX,setDebugMode:nX,testCases:jO,paramVariations:iX,discoverParams:aX,downloadResult:oX},window.addEventListener("api-call-complete",(t=>{const e=t.detail;e&&e.api&&eX(e)})),console.log("%c D'Live API  ","font-weight: bold; color: #8B5CF6"),console.log("".repeat(50)),console.log("%c  :","font-weight: bold"),console.log("  dliveDebug.runFullCheck()     -    API "),console.log("  dliveDebug.getLogs()          -  API  "),console.log("  dliveDebug.clearLogs()        -   "),console.log("  dliveDebug.setDebugMode(true) -    ON/OFF"),console.log("".repeat(50)),console.log("%c :  > API   UI  ","color: #6366F1"));const OO=document.getElementById("root");if(!OO)throw new Error("Could not find root element to mount to");const cX=J3.createRoot(OO);cX.render(s.jsx(Ji.StrictMode,{children:s.jsx(Zq,{})}));export{Nr as _,uX as c,F2 as g};
